var S=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var sp=S((Ej,op)=>{var{setIcon:ou}=require("obsidian"),su=class{constructor(r){this.containerEl=r,this.editor=null,this.el=null,this.paragraphOptions=[],this.listOptions=[],this.update=this.update.bind(this)}create(){this.el=this.containerEl.createDiv("colophon-toolbar");let r=this.el.createDiv("colophon-toolbar-row");this.paragraphSelect=this.createDropdown(r,"Paragraph",[]),this.listSelect=this.createDropdown(r,"List",[]);let t=r.createDiv("colophon-btn-group");this.createButton(t,null,"Bold",()=>this.toggleMark("bold"),"isActive","bold","<strong>B</strong>"),this.createButton(t,null,"Italic",()=>this.toggleMark("italic"),"isActive","italic","<em>I</em>"),this.createButton(t,null,"Underline",()=>this.toggleMark("underline"),"isActive","underline","<u>U</u>"),this.createButton(t,null,"Strikethrough",()=>this.toggleMark("strike"),"isActive","strike","<s>S</s>"),this.createButton(t,"superscript","Superscript",()=>this.toggleMark("superscript"),"isActive","superscript"),this.createButton(t,"subscript","Subscript",()=>this.toggleMark("subscript"),"isActive","subscript"),this.createButton(t,"type","Small Caps",()=>this.toggleMark("smallCaps"),"isActive","smallCaps")}createDropdown(r,t,n){let i=r.createDiv({cls:"colophon-dropdown-wrapper",style:"position: relative;"}),o=i.createEl("button",{cls:"colophon-ui-btn colophon-dropdown-trigger"}),s=o.createSpan({text:t}),a=o.createSpan();ou(a,"chevron-down");let l=i.createDiv("colophon-dropdown-menu");return l.style.display="none",l.style.top="100%",l.style.left="0",l.style.marginTop="4px",o.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),this.closeAllDropdowns(),l.style.display="block"}),document.addEventListener("click",u=>{!o.contains(u.target)&&!l.contains(u.target)&&(l.style.display="none")}),{trigger:o,labelSpan:s,dropdown:l,options:n}}closeAllDropdowns(){this.el.querySelectorAll(".colophon-dropdown-menu").forEach(r=>r.style.display="none"),this.el.querySelectorAll(".colophon-context-menu").forEach(r=>r.style.display="none")}createButton(r,t,n,i,o,s,a){let l=r.createEl("button",{cls:"colophon-ui-btn colophon-icon-only"});if(l.setAttribute("aria-label",n),a)l.innerHTML=a;else if(t){let u=l.createSpan();ou(u,t)}return l.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),this.editor&&(i(),this.editor.commands.focus())}),l._checkState=()=>{this.editor&&o==="isActive"&&s&&(this.editor.isActive(s)?l.addClass("colophon-active"):l.removeClass("colophon-active"))},l}createContextMenu(r,t){let n=r.createDiv("colophon-context-menu");n.style.display="none",n.style.top="100%",n.style.left="0",n.style.marginTop="4px",this.createMenuItem(n,"table","Table",()=>{}),this.createMenuItem(n,"minus","Divider",()=>{this.editor&&this.editor.chain().focus().setHorizontalRule().run()}),this.createMenuItem(n,"image","Image",()=>{}),t.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation();let o=n.style.display==="block";this.closeAllDropdowns(),o||(n.style.display="block")})}createMenuItem(r,t,n,i){let o=r.createDiv("colophon-menu-item");o.createSpan({cls:"colophon-drag-handle",text:"\u22EE\u22EE"});let s=o.createSpan({cls:"colophon-icon"});ou(s,t),o.createSpan({cls:"colophon-label",text:n}),o.addEventListener("click",a=>{a.preventDefault(),a.stopPropagation(),i(),r.style.display="none"})}setActiveEditor(r,t=!1){this.editor=r,this.isFootnote=t,this.update()}updateStyleOptions(r,t){this.paragraphOptions=r,this.listOptions=t,this.rebuildDropdowns()}rebuildDropdowns(){this.paragraphSelect.dropdown.empty(),this.paragraphOptions.forEach(r=>{let t=this.paragraphSelect.dropdown.createDiv("colophon-menu-item");t.createSpan({cls:"colophon-label",text:r.label}),t.addEventListener("click",()=>{this.applyStyle(r.value,r.type,r.listType),this.paragraphSelect.dropdown.style.display="none"})}),this.listSelect.dropdown.empty(),this.listOptions.forEach(r=>{let t=this.listSelect.dropdown.createDiv("colophon-menu-item");t.createSpan({cls:"colophon-label",text:r.label}),t.addEventListener("click",()=>{this.applyStyle(r.value,r.type,r.listType),this.listSelect.dropdown.style.display="none"})})}applyStyle(r,t,n){if(!this.editor)return;if(t==="list"){if(r==="none"){this.editor.chain().focus().liftListItem("listItem").run();return}n==="ordered"?this.editor.chain().focus().toggleOrderedList().updateAttributes("orderedList",{class:r}).run():this.editor.chain().focus().toggleBulletList().updateAttributes("bulletList",{class:r}).run();return}let i=!1,o=1;r&&(r.startsWith("heading-")||r==="title")&&(i=!0,r.startsWith("heading-")&&(o=parseInt(r.split("-")[1],10))),i?this.editor.chain().focus().toggleHeading({level:o}).updateAttributes("heading",{class:r}).run():this.editor.chain().focus().setParagraph().updateAttributes("paragraph",{class:r}).run()}toggleMark(r){this.editor&&(r==="bold"&&this.editor.chain().focus().toggleBold().run(),r==="italic"&&this.editor.chain().focus().toggleItalic().run(),r==="underline"&&this.editor.chain().focus().toggleUnderline().run(),r==="strike"&&this.editor.chain().focus().toggleStrike().run(),r==="superscript"&&this.editor.chain().focus().toggleSuperscript().run(),r==="subscript"&&this.editor.chain().focus().toggleSubscript().run(),r==="smallCaps"&&this.editor.chain().focus().toggleSmallCaps().run())}update(){if(!this.el)return;this.el.querySelectorAll(".colophon-ui-btn").forEach(t=>{t._checkState&&t._checkState()}),this.isFootnote?this.paragraphSelect&&(this.paragraphSelect.trigger.setAttribute("disabled","true"),this.paragraphSelect.trigger.addClass("colophon-disabled"),this.paragraphSelect.labelSpan.innerText="Footnote"):this.paragraphSelect&&(this.paragraphSelect.trigger.removeAttribute("disabled"),this.paragraphSelect.trigger.removeClass("colophon-disabled"),this.updateParagraphLabel()),this.updateListLabel()}updateParagraphLabel(){if(!this.editor||!this.paragraphSelect)return;let r="Paragraph";for(let t of this.paragraphOptions){let n=t.value;if(!n)continue;let i=!1;if(n.startsWith("heading-")||n==="title"?this.editor.isActive("heading",{class:n})&&(i=!0):this.editor.isActive("paragraph",{class:n})&&(i=!0),i){r=t.label;break}}this.paragraphSelect.labelSpan.innerText=r}updateListLabel(){if(!this.editor||!this.listSelect)return;let r="List";for(let t of this.listOptions){let n=t.value;if(n==="none")continue;let o=(t.listType||"unordered")==="ordered"?"orderedList":"bulletList";if(this.editor.isActive(o,{class:n})){r=t.label;break}}this.listSelect.labelSpan.innerText=r}destroy(){this.el&&this.el.remove()}};op.exports=su});var lp=S((Cj,ap)=>{"use strict";function _e(e){this.content=e}_e.prototype={constructor:_e,find:function(e){for(var r=0;r<this.content.length;r+=2)if(this.content[r]===e)return r;return-1},get:function(e){var r=this.find(e);return r==-1?void 0:this.content[r+1]},update:function(e,r,t){var n=t&&t!=e?this.remove(t):this,i=n.find(e),o=n.content.slice();return i==-1?o.push(t||e,r):(o[i+1]=r,t&&(o[i]=t)),new _e(o)},remove:function(e){var r=this.find(e);if(r==-1)return this;var t=this.content.slice();return t.splice(r,2),new _e(t)},addToStart:function(e,r){return new _e([e,r].concat(this.remove(e).content))},addToEnd:function(e,r){var t=this.remove(e).content.slice();return t.push(e,r),new _e(t)},addBefore:function(e,r,t){var n=this.remove(r),i=n.content.slice(),o=n.find(e);return i.splice(o==-1?i.length:o,0,r,t),new _e(i)},forEach:function(e){for(var r=0;r<this.content.length;r+=2)e(this.content[r],this.content[r+1])},prepend:function(e){return e=_e.from(e),e.size?new _e(e.content.concat(this.subtract(e).content)):this},append:function(e){return e=_e.from(e),e.size?new _e(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var r=this;e=_e.from(e);for(var t=0;t<e.content.length;t+=2)r=r.remove(e.content[t]);return r},toObject:function(){var e={};return this.forEach(function(r,t){e[r]=t}),e},get size(){return this.content.length>>1}};_e.from=function(e){if(e instanceof _e)return e;var r=[];if(e)for(var t in e)r.push(t,e[t]);return new _e(r)};ap.exports=_e});var lr=S(He=>{"use strict";function z_(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=q_(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(u){throw u},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,s=!1,a;return{s:function(){t=t.call(e)},n:function(){var u=t.next();return o=u.done,u},e:function(u){s=!0,a=u},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(s)throw a}}}}function q_(e,r){if(e){if(typeof e=="string")return up(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return up(e,r)}}function up(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function fs(){return typeof Reflect<"u"&&Reflect.get?fs=Reflect.get.bind():fs=function(r,t,n){var i=j_(r,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?r:n):o.value}},fs.apply(this,arguments)}function j_(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=qr(e),e!==null););return e}function Sp(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&Ci(e,r)}function xp(e){var r=_p();return function(){var n=qr(e),i;if(r){var o=qr(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return H_(this,i)}}function H_(e,r){if(r&&(st(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $_(e)}function $_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uu(e){var r=typeof Map=="function"?new Map:void 0;return uu=function(n){if(n===null||!W_(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r<"u"){if(r.has(n))return r.get(n);r.set(n,i)}function i(){return ds(n,arguments,qr(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Ci(i,n)},uu(e)}function ds(e,r,t){return _p()?ds=Reflect.construct.bind():ds=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&Ci(u,s.prototype),u},ds.apply(null,arguments)}function _p(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function W_(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function Ci(e,r){return Ci=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ci(e,r)}function qr(e){return qr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qr(e)}function st(e){"@babel/helpers - typeof";return st=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},st(e)}function de(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function cp(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V_(n.key),n)}}function he(e,r,t){return r&&cp(e.prototype,r),t&&cp(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function V_(e){var r=U_(e,"string");return st(r)==="symbol"?r:String(r)}function U_(e,r){if(st(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(st(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var fp=lp();function Tp(e,r,t){for(var n=0;;n++){if(n==e.childCount||n==r.childCount)return e.childCount==r.childCount?null:t;var i=e.child(n),o=r.child(n);if(i==o){t+=i.nodeSize;continue}if(!i.sameMarkup(o))return t;if(i.isText&&i.text!=o.text){for(var s=0;i.text[s]==o.text[s];s++)t++;return t}if(i.content.size||o.content.size){var a=Tp(i.content,o.content,t+1);if(a!=null)return a}t+=i.nodeSize}}function Ep(e,r,t,n){for(var i=e.childCount,o=r.childCount;;){if(i==0||o==0)return i==o?null:{a:t,b:n};var s=e.child(--i),a=r.child(--o),l=s.nodeSize;if(s==a){t-=l,n-=l;continue}if(!s.sameMarkup(a))return{a:t,b:n};if(s.isText&&s.text!=a.text){for(var u=0,c=Math.min(s.text.length,a.text.length);u<c&&s.text[s.text.length-u-1]==a.text[a.text.length-u-1];)u++,t--,n--;return{a:t,b:n}}if(s.content.size||a.content.size){var f=Ep(s.content,a.content,t-1,n-1);if(f)return f}t-=l,n-=l}}var fe=(function(){function e(r,t){if(de(this,e),this.content=r,this.size=t||0,t==null)for(var n=0;n<r.length;n++)this.size+=r[n].nodeSize}return he(e,[{key:"nodesBetween",value:function(t,n,i){for(var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0,a=0,l=0;l<n;a++){var u=this.content[a],c=l+u.nodeSize;if(c>t&&i(u,o+l,s||null,a)!==!1&&u.content.size){var f=l+1;u.nodesBetween(Math.max(0,t-f),Math.min(u.content.size,n-f),i,o+f)}l=c}}},{key:"descendants",value:function(t){this.nodesBetween(0,this.size,t)}},{key:"textBetween",value:function(t,n,i,o){var s="",a=!0;return this.nodesBetween(t,n,function(l,u){var c=l.isText?l.text.slice(Math.max(t,u)-u,n-u):l.isLeaf?o?typeof o=="function"?o(l):o:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&c||l.isTextblock)&&i&&(a?a=!1:s+=i),s+=c},0),s}},{key:"append",value:function(t){if(!t.size)return this;if(!this.size)return t;var n=this.lastChild,i=t.firstChild,o=this.content.slice(),s=0;for(n.isText&&n.sameMarkup(i)&&(o[o.length-1]=n.withText(n.text+i.text),s=1);s<t.content.length;s++)o.push(t.content[s]);return new e(o,this.size+t.size)}},{key:"cut",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.size;if(t==0&&n==this.size)return this;var i=[],o=0;if(n>t)for(var s=0,a=0;a<n;s++){var l=this.content[s],u=a+l.nodeSize;u>t&&((a<t||u>n)&&(l.isText?l=l.cut(Math.max(0,t-a),Math.min(l.text.length,n-a)):l=l.cut(Math.max(0,t-a-1),Math.min(l.content.size,n-a-1))),i.push(l),o+=l.nodeSize),a=u}return new e(i,o)}},{key:"cutByIndex",value:function(t,n){return t==n?e.empty:t==0&&n==this.content.length?this:new e(this.content.slice(t,n))}},{key:"replaceChild",value:function(t,n){var i=this.content[t];if(i==n)return this;var o=this.content.slice(),s=this.size+n.nodeSize-i.nodeSize;return o[t]=n,new e(o,s)}},{key:"addToStart",value:function(t){return new e([t].concat(this.content),this.size+t.nodeSize)}},{key:"addToEnd",value:function(t){return new e(this.content.concat(t),this.size+t.nodeSize)}},{key:"eq",value:function(t){if(this.content.length!=t.content.length)return!1;for(var n=0;n<this.content.length;n++)if(!this.content[n].eq(t.content[n]))return!1;return!0}},{key:"firstChild",get:function(){return this.content.length?this.content[0]:null}},{key:"lastChild",get:function(){return this.content.length?this.content[this.content.length-1]:null}},{key:"childCount",get:function(){return this.content.length}},{key:"child",value:function(t){var n=this.content[t];if(!n)throw new RangeError("Index "+t+" out of range for "+this);return n}},{key:"maybeChild",value:function(t){return this.content[t]||null}},{key:"forEach",value:function(t){for(var n=0,i=0;n<this.content.length;n++){var o=this.content[n];t(o,i,n),i+=o.nodeSize}}},{key:"findDiffStart",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Tp(this,t,n)}},{key:"findDiffEnd",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.size,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.size;return Ep(this,t,n,i)}},{key:"findIndex",value:function(t){if(t==0)return us(0,t);if(t==this.size)return us(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position ".concat(t," outside of fragment (").concat(this,")"));for(var n=0,i=0;;n++){var o=this.child(n),s=i+o.nodeSize;if(s>=t)return s==t?us(n+1,s):us(n,i);i=s}}},{key:"toString",value:function(){return"<"+this.toStringInner()+">"}},{key:"toStringInner",value:function(){return this.content.join(", ")}},{key:"toJSON",value:function(){return this.content.length?this.content.map(function(t){return t.toJSON()}):null}}],[{key:"fromJSON",value:function(t,n){if(!n)return e.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new e(n.map(t.nodeFromJSON))}},{key:"fromArray",value:function(t){if(!t.length)return e.empty;for(var n,i=0,o=0;o<t.length;o++){var s=t[o];i+=s.nodeSize,o&&s.isText&&t[o-1].sameMarkup(s)?(n||(n=t.slice(0,o)),n[n.length-1]=s.withText(n[n.length-1].text+s.text)):n&&n.push(s)}return new e(n||t,i)}},{key:"from",value:function(t){if(!t)return e.empty;if(t instanceof e)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new e([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}]),e})();fe.empty=new fe([],0);var au={index:0,offset:0};function us(e,r){return au.index=e,au.offset=r,au}function ps(e,r){if(e===r)return!0;if(!(e&&st(e)=="object")||!(r&&st(r)=="object"))return!1;var t=Array.isArray(e);if(Array.isArray(r)!=t)return!1;if(t){if(e.length!=r.length)return!1;for(var n=0;n<e.length;n++)if(!ps(e[n],r[n]))return!1}else{for(var i in e)if(!(i in r)||!ps(e[i],r[i]))return!1;for(var o in r)if(!(o in e))return!1}return!0}var Y=(function(){function e(r,t){de(this,e),this.type=r,this.attrs=t}return he(e,[{key:"addToSet",value:function(t){for(var n,i=!1,o=0;o<t.length;o++){var s=t[o];if(this.eq(s))return t;if(this.type.excludes(s.type))n||(n=t.slice(0,o));else{if(s.type.excludes(this.type))return t;!i&&s.type.rank>this.type.rank&&(n||(n=t.slice(0,o)),n.push(this),i=!0),n&&n.push(s)}}return n||(n=t.slice()),i||n.push(this),n}},{key:"removeFromSet",value:function(t){for(var n=0;n<t.length;n++)if(this.eq(t[n]))return t.slice(0,n).concat(t.slice(n+1));return t}},{key:"isInSet",value:function(t){for(var n=0;n<t.length;n++)if(this.eq(t[n]))return!0;return!1}},{key:"eq",value:function(t){return this==t||this.type==t.type&&ps(this.attrs,t.attrs)}},{key:"toJSON",value:function(){var t={type:this.type.name};for(var n in this.attrs){t.attrs=this.attrs;break}return t}}],[{key:"fromJSON",value:function(t,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");var i=t.marks[n.type];if(!i)throw new RangeError("There is no mark type ".concat(n.type," in this schema"));var o=i.create(n.attrs);return i.checkAttrs(o.attrs),o}},{key:"sameSet",value:function(t,n){if(t==n)return!0;if(t.length!=n.length)return!1;for(var i=0;i<t.length;i++)if(!t[i].eq(n[i]))return!1;return!0}},{key:"setFrom",value:function(t){if(!t||Array.isArray(t)&&t.length==0)return e.none;if(t instanceof e)return[t];var n=t.slice();return n.sort(function(i,o){return i.type.rank-o.type.rank}),n}}]),e})();Y.none=[];var ms=(function(e){Sp(t,e);var r=xp(t);function t(){return de(this,t),r.apply(this,arguments)}return he(t)})(uu(Error)),bn=(function(){function e(r,t,n){de(this,e),this.content=r,this.openStart=t,this.openEnd=n}return he(e,[{key:"size",get:function(){return this.content.size-this.openStart-this.openEnd}},{key:"insertAt",value:function(t,n){var i=Op(this.content,t+this.openStart,n);return i&&new e(i,this.openStart,this.openEnd)}},{key:"removeBetween",value:function(t,n){return new e(Cp(this.content,t+this.openStart,n+this.openStart),this.openStart,this.openEnd)}},{key:"eq",value:function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}},{key:"toString",value:function(){return this.content+"("+this.openStart+","+this.openEnd+")"}},{key:"toJSON",value:function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}}],[{key:"fromJSON",value:function(t,n){if(!n)return e.empty;var i=n.openStart||0,o=n.openEnd||0;if(typeof i!="number"||typeof o!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new e(fe.fromJSON(t,n.content),i,o)}},{key:"maxOpen",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=0,o=0,s=t.firstChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.firstChild)i++;for(var a=t.lastChild;a&&!a.isLeaf&&(n||!a.type.spec.isolating);a=a.lastChild)o++;return new e(t,i,o)}}]),e})();bn.empty=new bn(fe.empty,0,0);function Cp(e,r,t){var n=e.findIndex(r),i=n.index,o=n.offset,s=e.maybeChild(i),a=e.findIndex(t),l=a.index,u=a.offset;if(o==r||s.isText){if(u!=t&&!e.child(l).isText)throw new RangeError("Removing non-flat range");return e.cut(0,r).append(e.cut(t))}if(i!=l)throw new RangeError("Removing non-flat range");return e.replaceChild(i,s.copy(Cp(s.content,r-o-1,t-o-1)))}function Op(e,r,t,n){var i=e.findIndex(r),o=i.index,s=i.offset,a=e.maybeChild(o);if(s==r||a.isText)return n&&!n.canReplace(o,o,t)?null:e.cut(0,r).append(t).append(e.cut(r));var l=Op(a.content,r-s-1,t,a);return l&&e.replaceChild(o,a.copy(l))}function K_(e,r,t){if(t.openStart>e.depth)throw new ms("Inserted content deeper than insertion position");if(e.depth-t.openStart!=r.depth-t.openEnd)throw new ms("Inconsistent open depths");return Mp(e,r,t,0)}function Mp(e,r,t,n){var i=e.index(n),o=e.node(n);if(i==r.index(n)&&n<e.depth-t.openStart){var s=Mp(e,r,t,n+1);return o.copy(o.content.replaceChild(i,s))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&e.depth==n&&r.depth==n){var a=e.parent,l=a.content;return Br(a,l.cut(0,e.parentOffset).append(t.content).append(l.cut(r.parentOffset)))}else{var u=J_(t,e),c=u.start,f=u.end;return Br(o,Np(e,c,f,r,n))}else return Br(o,gs(e,r,n))}function Ap(e,r){if(!r.type.compatibleContent(e.type))throw new ms("Cannot join "+r.type.name+" onto "+e.type.name)}function cu(e,r,t){var n=e.node(t);return Ap(n,r.node(t)),n}function Fr(e,r){var t=r.length-1;t>=0&&e.isText&&e.sameMarkup(r[t])?r[t]=e.withText(r[t].text+e.text):r.push(e)}function Ti(e,r,t,n){var i=(r||e).node(t),o=0,s=r?r.index(t):i.childCount;e&&(o=e.index(t),e.depth>t?o++:e.textOffset&&(Fr(e.nodeAfter,n),o++));for(var a=o;a<s;a++)Fr(i.child(a),n);r&&r.depth==t&&r.textOffset&&Fr(r.nodeBefore,n)}function Br(e,r){return e.type.checkContent(r),e.copy(r)}function Np(e,r,t,n,i){var o=e.depth>i&&cu(e,r,i+1),s=n.depth>i&&cu(t,n,i+1),a=[];return Ti(null,e,i,a),o&&s&&r.index(i)==t.index(i)?(Ap(o,s),Fr(Br(o,Np(e,r,t,n,i+1)),a)):(o&&Fr(Br(o,gs(e,r,i+1)),a),Ti(r,t,i,a),s&&Fr(Br(s,gs(t,n,i+1)),a)),Ti(n,null,i,a),new fe(a)}function gs(e,r,t){var n=[];if(Ti(null,e,t,n),e.depth>t){var i=cu(e,r,t+1);Fr(Br(i,gs(e,r,t+1)),n)}return Ti(r,null,t,n),new fe(n)}function J_(e,r){for(var t=r.depth-e.openStart,n=r.node(t),i=n.copy(e.content),o=t-1;o>=0;o--)i=r.node(o).copy(fe.from(i));return{start:i.resolveNoCache(e.openStart+t),end:i.resolveNoCache(i.content.size-e.openEnd-t)}}var fu=(function(){function e(r,t,n){de(this,e),this.pos=r,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}return he(e,[{key:"resolveDepth",value:function(t){return t==null?this.depth:t<0?this.depth+t:t}},{key:"parent",get:function(){return this.node(this.depth)}},{key:"doc",get:function(){return this.node(0)}},{key:"node",value:function(t){return this.path[this.resolveDepth(t)*3]}},{key:"index",value:function(t){return this.path[this.resolveDepth(t)*3+1]}},{key:"indexAfter",value:function(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}},{key:"start",value:function(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}},{key:"end",value:function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}},{key:"before",value:function(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}},{key:"after",value:function(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}},{key:"textOffset",get:function(){return this.pos-this.path[this.path.length-1]}},{key:"nodeAfter",get:function(){var t=this.parent,n=this.index(this.depth);if(n==t.childCount)return null;var i=this.pos-this.path[this.path.length-1],o=t.child(n);return i?t.child(n).cut(i):o}},{key:"nodeBefore",get:function(){var t=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(t).cut(0,n):t==0?null:this.parent.child(t-1)}},{key:"posAtIndex",value:function(t,n){n=this.resolveDepth(n);for(var i=this.path[n*3],o=n==0?0:this.path[n*3-1]+1,s=0;s<t;s++)o+=i.child(s).nodeSize;return o}},{key:"marks",value:function(){var t=this.parent,n=this.index();if(t.content.size==0)return Y.none;if(this.textOffset)return t.child(n).marks;var i=t.maybeChild(n-1),o=t.maybeChild(n);if(!i){var s=i;i=o,o=s}for(var a=i.marks,l=0;l<a.length;l++)a[l].type.spec.inclusive===!1&&(!o||!a[l].isInSet(o.marks))&&(a=a[l--].removeFromSet(a));return a}},{key:"marksAcross",value:function(t){var n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;for(var i=n.marks,o=t.parent.maybeChild(t.index()),s=0;s<i.length;s++)i[s].type.spec.inclusive===!1&&(!o||!i[s].isInSet(o.marks))&&(i=i[s--].removeFromSet(i));return i}},{key:"sharedDepth",value:function(t){for(var n=this.depth;n>0;n--)if(this.start(n)<=t&&this.end(n)>=t)return n;return 0}},{key:"blockRange",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=arguments.length>1?arguments[1]:void 0;if(t.pos<this.pos)return t.blockRange(this);for(var i=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);i>=0;i--)if(t.pos<=this.end(i)&&(!n||n(this.node(i))))return new Pp(this,t,i);return null}},{key:"sameParent",value:function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}},{key:"max",value:function(t){return t.pos>this.pos?t:this}},{key:"min",value:function(t){return t.pos<this.pos?t:this}},{key:"toString",value:function(){for(var t="",n=1;n<=this.depth;n++)t+=(t?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return t+":"+this.parentOffset}}],[{key:"resolve",value:function(t,n){if(!(n>=0&&n<=t.content.size))throw new RangeError("Position "+n+" out of range");for(var i=[],o=0,s=n,a=t;;){var l=a.content.findIndex(s),u=l.index,c=l.offset,f=s-c;if(i.push(a,u,o+c),!f||(a=a.child(u),a.isText))break;s=f-1,o+=c+1}return new e(n,i,s)}},{key:"resolveCached",value:function(t,n){var i=dp.get(t);if(i)for(var o=0;o<i.elts.length;o++){var s=i.elts[o];if(s.pos==n)return s}else dp.set(t,i=new Z_);var a=i.elts[i.i]=e.resolve(t,n);return i.i=(i.i+1)%G_,a}}]),e})(),Z_=he(function e(){de(this,e),this.elts=[],this.i=0}),G_=12,dp=new WeakMap,Pp=(function(){function e(r,t,n){de(this,e),this.$from=r,this.$to=t,this.depth=n}return he(e,[{key:"start",get:function(){return this.$from.before(this.depth+1)}},{key:"end",get:function(){return this.$to.after(this.depth+1)}},{key:"parent",get:function(){return this.$from.node(this.depth)}},{key:"startIndex",get:function(){return this.$from.index(this.depth)}},{key:"endIndex",get:function(){return this.$to.indexAfter(this.depth)}}]),e})(),X_=Object.create(null),zr=(function(){function e(r,t,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Y.none;de(this,e),this.type=r,this.attrs=t,this.marks=i,this.content=n||fe.empty}return he(e,[{key:"children",get:function(){return this.content.content}},{key:"nodeSize",get:function(){return this.isLeaf?1:2+this.content.size}},{key:"childCount",get:function(){return this.content.childCount}},{key:"child",value:function(t){return this.content.child(t)}},{key:"maybeChild",value:function(t){return this.content.maybeChild(t)}},{key:"forEach",value:function(t){this.content.forEach(t)}},{key:"nodesBetween",value:function(t,n,i){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;this.content.nodesBetween(t,n,i,o,this)}},{key:"descendants",value:function(t){this.nodesBetween(0,this.content.size,t)}},{key:"textContent",get:function(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}},{key:"textBetween",value:function(t,n,i,o){return this.content.textBetween(t,n,i,o)}},{key:"firstChild",get:function(){return this.content.firstChild}},{key:"lastChild",get:function(){return this.content.lastChild}},{key:"eq",value:function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}},{key:"sameMarkup",value:function(t){return this.hasMarkup(t.type,t.attrs,t.marks)}},{key:"hasMarkup",value:function(t,n,i){return this.type==t&&ps(this.attrs,n||t.defaultAttrs||X_)&&Y.sameSet(this.marks,i||Y.none)}},{key:"copy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return t==this.content?this:new e(this.type,this.attrs,t,this.marks)}},{key:"mark",value:function(t){return t==this.marks?this:new e(this.type,this.attrs,this.content,t)}},{key:"cut",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.content.size;return t==0&&n==this.content.size?this:this.copy(this.content.cut(t,n))}},{key:"slice",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.content.size,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(t==n)return bn.empty;var o=this.resolve(t),s=this.resolve(n),a=i?0:o.sharedDepth(n),l=o.start(a),u=o.node(a),c=u.content.cut(o.pos-l,s.pos-l);return new bn(c,o.depth-a,s.depth-a)}},{key:"replace",value:function(t,n,i){return K_(this.resolve(t),this.resolve(n),i)}},{key:"nodeAt",value:function(t){for(var n=this;;){var i=n.content.findIndex(t),o=i.index,s=i.offset;if(n=n.maybeChild(o),!n)return null;if(s==t||n.isText)return n;t-=s+1}}},{key:"childAfter",value:function(t){var n=this.content.findIndex(t),i=n.index,o=n.offset;return{node:this.content.maybeChild(i),index:i,offset:o}}},{key:"childBefore",value:function(t){if(t==0)return{node:null,index:0,offset:0};var n=this.content.findIndex(t),i=n.index,o=n.offset;if(o<t)return{node:this.content.child(i),index:i,offset:o};var s=this.content.child(i-1);return{node:s,index:i-1,offset:o-s.nodeSize}}},{key:"resolve",value:function(t){return fu.resolveCached(this,t)}},{key:"resolveNoCache",value:function(t){return fu.resolve(this,t)}},{key:"rangeHasMark",value:function(t,n,i){var o=!1;return n>t&&this.nodesBetween(t,n,function(s){return i.isInSet(s.marks)&&(o=!0),!o}),o}},{key:"isBlock",get:function(){return this.type.isBlock}},{key:"isTextblock",get:function(){return this.type.isTextblock}},{key:"inlineContent",get:function(){return this.type.inlineContent}},{key:"isInline",get:function(){return this.type.isInline}},{key:"isText",get:function(){return this.type.isText}},{key:"isLeaf",get:function(){return this.type.isLeaf}},{key:"isAtom",get:function(){return this.type.isAtom}},{key:"toString",value:function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Rp(this.marks,t)}},{key:"contentMatchAt",value:function(t){var n=this.type.contentMatch.matchFragment(this.content,0,t);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}},{key:"canReplace",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:fe.empty,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:i.childCount,a=this.contentMatchAt(t).matchFragment(i,o,s),l=a&&a.matchFragment(this.content,n);if(!l||!l.validEnd)return!1;for(var u=o;u<s;u++)if(!this.type.allowsMarks(i.child(u).marks))return!1;return!0}},{key:"canReplaceWith",value:function(t,n,i,o){if(o&&!this.type.allowsMarks(o))return!1;var s=this.contentMatchAt(t).matchType(i),a=s&&s.matchFragment(this.content,n);return a?a.validEnd:!1}},{key:"canAppend",value:function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}},{key:"check",value:function(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);for(var t=Y.none,n=0;n<this.marks.length;n++){var i=this.marks[n];i.type.checkAttrs(i.attrs),t=i.addToSet(t)}if(!Y.sameSet(t,this.marks))throw new RangeError("Invalid collection of marks for node ".concat(this.type.name,": ").concat(this.marks.map(function(o){return o.type.name})));this.content.forEach(function(o){return o.check()})}},{key:"toJSON",value:function(){var t={type:this.type.name};for(var n in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(function(i){return i.toJSON()})),t}}],[{key:"fromJSON",value:function(t,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");var i=void 0;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");i=n.marks.map(t.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(n.text,i)}var o=fe.fromJSON(t,n.content),s=t.nodeType(n.type).create(n.attrs,o,i);return s.type.checkAttrs(s.attrs),s}}]),e})();zr.prototype.text=void 0;var Y_=(function(e){Sp(t,e);var r=xp(t);function t(n,i,o,s){var a;if(de(this,t),a=r.call(this,n,i,null,s),!o)throw new RangeError("Empty text nodes are not allowed");return a.text=o,a}return he(t,[{key:"toString",value:function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Rp(this.marks,JSON.stringify(this.text))}},{key:"textContent",get:function(){return this.text}},{key:"textBetween",value:function(i,o){return this.text.slice(i,o)}},{key:"nodeSize",get:function(){return this.text.length}},{key:"mark",value:function(i){return i==this.marks?this:new t(this.type,this.attrs,this.text,i)}},{key:"withText",value:function(i){return i==this.text?this:new t(this.type,this.attrs,i,this.marks)}},{key:"cut",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.text.length;return i==0&&o==this.text.length?this:this.withText(this.text.slice(i,o))}},{key:"eq",value:function(i){return this.sameMarkup(i)&&this.text==i.text}},{key:"toJSON",value:function(){var i=fs(qr(t.prototype),"toJSON",this).call(this);return i.text=this.text,i}}]),t})(zr);function Rp(e,r){for(var t=e.length-1;t>=0;t--)r=e[t].type.name+"("+r+")";return r}var kn=(function(){function e(r){de(this,e),this.validEnd=r,this.next=[],this.wrapCache=[]}return he(e,[{key:"matchType",value:function(t){for(var n=0;n<this.next.length;n++)if(this.next[n].type==t)return this.next[n].next;return null}},{key:"matchFragment",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.childCount,o=this,s=n;o&&s<i;s++)o=o.matchType(t.child(s).type);return o}},{key:"inlineContent",get:function(){return this.next.length!=0&&this.next[0].type.isInline}},{key:"defaultType",get:function(){for(var t=0;t<this.next.length;t++){var n=this.next[t].type;if(!(n.isText||n.hasRequiredAttrs()))return n}return null}},{key:"compatible",value:function(t){for(var n=0;n<this.next.length;n++)for(var i=0;i<t.next.length;i++)if(this.next[n].type==t.next[i].type)return!0;return!1}},{key:"fillBefore",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=[this];function s(a,l){var u=a.matchFragment(t,i);if(u&&(!n||u.validEnd))return fe.from(l.map(function(m){return m.createAndFill()}));for(var c=0;c<a.next.length;c++){var f=a.next[c],d=f.type,h=f.next;if(!(d.isText||d.hasRequiredAttrs())&&o.indexOf(h)==-1){o.push(h);var p=s(h,l.concat(d));if(p)return p}}return null}return s(this,[])}},{key:"findWrapping",value:function(t){for(var n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==t)return this.wrapCache[n+1];var i=this.computeWrapping(t);return this.wrapCache.push(t,i),i}},{key:"computeWrapping",value:function(t){for(var n=Object.create(null),i=[{match:this,type:null,via:null}];i.length;){var o=i.shift(),s=o.match;if(s.matchType(t)){for(var a=[],l=o;l.type;l=l.via)a.push(l.type);return a.reverse()}for(var u=0;u<s.next.length;u++){var c=s.next[u],f=c.type,d=c.next;!f.isLeaf&&!f.hasRequiredAttrs()&&!(f.name in n)&&(!o.type||d.validEnd)&&(i.push({match:f.contentMatch,type:f,via:o}),n[f.name]=!0)}}return null}},{key:"edgeCount",get:function(){return this.next.length}},{key:"edge",value:function(t){if(t>=this.next.length)throw new RangeError("There's no ".concat(t,"th edge in this content match"));return this.next[t]}},{key:"toString",value:function(){var t=[];function n(i){t.push(i);for(var o=0;o<i.next.length;o++)t.indexOf(i.next[o].next)==-1&&n(i.next[o].next)}return n(this),t.map(function(i,o){for(var s=o+(i.validEnd?"*":" ")+" ",a=0;a<i.next.length;a++)s+=(a?", ":"")+i.next[a].type.name+"->"+t.indexOf(i.next[a].next);return s}).join(`
`)}}],[{key:"parse",value:function(t,n){var i=new Q_(t,n);if(i.next==null)return e.empty;var o=Dp(i);i.next&&i.err("Unexpected trailing text");var s=sT(oT(o));return aT(s,i),s}}]),e})();kn.empty=new kn(!0);var Q_=(function(){function e(r,t){de(this,e),this.string=r,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=r.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}return he(e,[{key:"next",get:function(){return this.tokens[this.pos]}},{key:"eat",value:function(t){return this.next==t&&(this.pos++||!0)}},{key:"err",value:function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}]),e})();function Dp(e){var r=[];do r.push(eT(e));while(e.eat("|"));return r.length==1?r[0]:{type:"choice",exprs:r}}function eT(e){var r=[];do r.push(tT(e));while(e.next&&e.next!=")"&&e.next!="|");return r.length==1?r[0]:{type:"seq",exprs:r}}function tT(e){for(var r=iT(e);;)if(e.eat("+"))r={type:"plus",expr:r};else if(e.eat("*"))r={type:"star",expr:r};else if(e.eat("?"))r={type:"opt",expr:r};else if(e.eat("{"))r=rT(e,r);else break;return r}function hp(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");var r=Number(e.next);return e.pos++,r}function rT(e,r){var t=hp(e),n=t;return e.eat(",")&&(e.next!="}"?n=hp(e):n=-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:t,max:n,expr:r}}function nT(e,r){var t=e.nodeTypes,n=t[r];if(n)return[n];var i=[];for(var o in t){var s=t[o];s.isInGroup(r)&&i.push(s)}return i.length==0&&e.err("No node type or group '"+r+"' found"),i}function iT(e){if(e.eat("(")){var r=Dp(e);return e.eat(")")||e.err("Missing closing paren"),r}else if(/\W/.test(e.next))e.err("Unexpected token '"+e.next+"'");else{var t=nT(e,e.next).map(function(n){return e.inline==null?e.inline=n.isInline:e.inline!=n.isInline&&e.err("Mixing inline and block content"),{type:"name",value:n}});return e.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function oT(e){var r=[[]];return i(o(e,0),t()),r;function t(){return r.push([])-1}function n(s,a,l){var u={term:l,to:a};return r[s].push(u),u}function i(s,a){s.forEach(function(l){return l.to=a})}function o(s,a){if(s.type=="choice")return s.exprs.reduce(function(g,y){return g.concat(o(y,a))},[]);if(s.type=="seq")for(var l=0;;l++){var u=o(s.exprs[l],a);if(l==s.exprs.length-1)return u;i(u,a=t())}else if(s.type=="star"){var c=t();return n(a,c),i(o(s.expr,c),c),[n(c)]}else if(s.type=="plus"){var f=t();return i(o(s.expr,a),f),i(o(s.expr,f),f),[n(f)]}else{if(s.type=="opt")return[n(a)].concat(o(s.expr,a));if(s.type=="range"){for(var d=a,h=0;h<s.min;h++){var p=t();i(o(s.expr,d),p),d=p}if(s.max==-1)i(o(s.expr,d),d);else for(var m=s.min;m<s.max;m++){var v=t();n(d,v),i(o(s.expr,d),v),d=v}return[n(d)]}else{if(s.type=="name")return[n(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function Ip(e,r){return r-e}function pp(e,r){var t=[];return n(r),t.sort(Ip);function n(i){var o=e[i];if(o.length==1&&!o[0].term)return n(o[0].to);t.push(i);for(var s=0;s<o.length;s++){var a=o[s],l=a.term,u=a.to;!l&&t.indexOf(u)==-1&&n(u)}}}function sT(e){var r=Object.create(null);return t(pp(e,0));function t(n){var i=[];n.forEach(function(l){e[l].forEach(function(u){var c=u.term,f=u.to;if(c){for(var d,h=0;h<i.length;h++)i[h][0]==c&&(d=i[h][1]);pp(e,f).forEach(function(p){d||i.push([c,d=[]]),d.indexOf(p)==-1&&d.push(p)})}})});for(var o=r[n.join(",")]=new kn(n.indexOf(e.length-1)>-1),s=0;s<i.length;s++){var a=i[s][1].sort(Ip);o.next.push({type:i[s][0],next:r[a.join(",")]||t(a)})}return o}}function aT(e,r){for(var t=0,n=[e];t<n.length;t++){for(var i=n[t],o=!i.validEnd,s=[],a=0;a<i.next.length;a++){var l=i.next[a],u=l.type,c=l.next;s.push(u.name),o&&!(u.isText||u.hasRequiredAttrs())&&(o=!1),n.indexOf(c)==-1&&n.push(c)}o&&r.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Lp(e){var r=Object.create(null);for(var t in e){var n=e[t];if(!n.hasDefault)return null;r[t]=n.default}return r}function Fp(e,r){var t=Object.create(null);for(var n in e){var i=r&&r[n];if(i===void 0){var o=e[n];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+n)}t[n]=i}return t}function Bp(e,r,t,n){for(var i in r)if(!(i in e))throw new RangeError("Unsupported attribute ".concat(i," for ").concat(t," of type ").concat(i));for(var o in e){var s=e[o];s.validate&&s.validate(r[o])}}function zp(e,r){var t=Object.create(null);if(r)for(var n in r)t[n]=new uT(e,n,r[n]);return t}var du=(function(){function e(r,t,n){de(this,e),this.name=r,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=zp(r,n.attrs),this.defaultAttrs=Lp(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||r=="text"),this.isText=r=="text"}return he(e,[{key:"isInline",get:function(){return!this.isBlock}},{key:"isTextblock",get:function(){return this.isBlock&&this.inlineContent}},{key:"isLeaf",get:function(){return this.contentMatch==kn.empty}},{key:"isAtom",get:function(){return this.isLeaf||!!this.spec.atom}},{key:"isInGroup",value:function(t){return this.groups.indexOf(t)>-1}},{key:"whitespace",get:function(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}},{key:"hasRequiredAttrs",value:function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}},{key:"compatibleContent",value:function(t){return this==t||this.contentMatch.compatible(t.contentMatch)}},{key:"computeAttrs",value:function(t){return!t&&this.defaultAttrs?this.defaultAttrs:Fp(this.attrs,t)}},{key:"create",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new zr(this,this.computeAttrs(t),fe.from(n),Y.setFrom(i))}},{key:"createChecked",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return n=fe.from(n),this.checkContent(n),new zr(this,this.computeAttrs(t),n,Y.setFrom(i))}},{key:"createAndFill",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;if(t=this.computeAttrs(t),n=fe.from(n),n.size){var o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}var s=this.contentMatch.matchFragment(n),a=s&&s.fillBefore(fe.empty,!0);return a?new zr(this,t,n.append(a),Y.setFrom(i)):null}},{key:"validContent",value:function(t){var n=this.contentMatch.matchFragment(t);if(!n||!n.validEnd)return!1;for(var i=0;i<t.childCount;i++)if(!this.allowsMarks(t.child(i).marks))return!1;return!0}},{key:"checkContent",value:function(t){if(!this.validContent(t))throw new RangeError("Invalid content for node ".concat(this.name,": ").concat(t.toString().slice(0,50)))}},{key:"checkAttrs",value:function(t){Bp(this.attrs,t,"node",this.name)}},{key:"allowsMarkType",value:function(t){return this.markSet==null||this.markSet.indexOf(t)>-1}},{key:"allowsMarks",value:function(t){if(this.markSet==null)return!0;for(var n=0;n<t.length;n++)if(!this.allowsMarkType(t[n].type))return!1;return!0}},{key:"allowedMarks",value:function(t){if(this.markSet==null)return t;for(var n,i=0;i<t.length;i++)this.allowsMarkType(t[i].type)?n&&n.push(t[i]):n||(n=t.slice(0,i));return n?n.length?n:Y.none:t}}],[{key:"compile",value:function(t,n){var i=Object.create(null);t.forEach(function(a,l){return i[a]=new e(a,n,l)});var o=n.spec.topNode||"doc";if(!i[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!i.text)throw new RangeError("Every schema needs a 'text' type");for(var s in i.text.attrs)throw new RangeError("The text node type should not have attributes");return i}}]),e})();function lT(e,r,t){var n=t.split("|");return function(i){var o=i===null?"null":st(i);if(n.indexOf(o)<0)throw new RangeError("Expected value of type ".concat(n," for attribute ").concat(r," on type ").concat(e,", got ").concat(o))}}var uT=(function(){function e(r,t,n){de(this,e),this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?lT(r,t,n.validate):n.validate}return he(e,[{key:"isRequired",get:function(){return!this.hasDefault}}]),e})(),qp=(function(){function e(r,t,n,i){de(this,e),this.name=r,this.rank=t,this.schema=n,this.spec=i,this.attrs=zp(r,i.attrs),this.excluded=null;var o=Lp(this.attrs);this.instance=o?new Y(this,o):null}return he(e,[{key:"create",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return!t&&this.instance?this.instance:new Y(this,Fp(this.attrs,t))}},{key:"removeFromSet",value:function(t){for(var n=0;n<t.length;n++)t[n].type==this&&(t=t.slice(0,n).concat(t.slice(n+1)),n--);return t}},{key:"isInSet",value:function(t){for(var n=0;n<t.length;n++)if(t[n].type==this)return t[n]}},{key:"checkAttrs",value:function(t){Bp(this.attrs,t,"mark",this.name)}},{key:"excludes",value:function(t){return this.excluded.indexOf(t)>-1}}],[{key:"compile",value:function(t,n){var i=Object.create(null),o=0;return t.forEach(function(s,a){return i[s]=new e(s,o++,n,a)}),i}}]),e})(),cT=(function(){function e(r){var t=this;de(this,e),this.linebreakReplacement=null,this.cached=Object.create(null);var n=this.spec={};for(var i in r)n[i]=r[i];n.nodes=fp.from(r.nodes),n.marks=fp.from(r.marks||{}),this.nodes=du.compile(this.spec.nodes,this),this.marks=qp.compile(this.spec.marks,this);var o=Object.create(null);for(var s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");var a=this.nodes[s],l=a.spec.content||"",u=a.spec.marks;if(a.contentMatch=o[l]||(o[l]=kn.parse(l,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!a.isInline||!a.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=a}a.markSet=u=="_"?null:u?mp(this,u.split(" ")):u==""||!a.inlineContent?[]:null}for(var c in this.marks){var f=this.marks[c],d=f.spec.excludes;f.excluded=d==null?[f]:d==""?[]:mp(this,d.split(" "))}this.nodeFromJSON=function(h){return zr.fromJSON(t,h)},this.markFromJSON=function(h){return Y.fromJSON(t,h)},this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}return he(e,[{key:"node",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;if(typeof t=="string")t=this.nodeType(t);else if(t instanceof du){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(n,i,o)}},{key:"text",value:function(t,n){var i=this.nodes.text;return new Y_(i,i.defaultAttrs,t,Y.setFrom(n))}},{key:"mark",value:function(t,n){return typeof t=="string"&&(t=this.marks[t]),t.create(n)}},{key:"nodeType",value:function(t){var n=this.nodes[t];if(!n)throw new RangeError("Unknown node type: "+t);return n}}]),e})();function mp(e,r){for(var t=[],n=0;n<r.length;n++){var i=r[n],o=e.marks[i],s=o;if(o)t.push(o);else for(var a in e.marks){var l=e.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&t.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+r[n]+"'")}return t}function fT(e){return e.tag!=null}function dT(e){return e.style!=null}var hT=(function(){function e(r,t){var n=this;de(this,e),this.schema=r,this.rules=t,this.tags=[],this.styles=[];var i=this.matchedStyles=[];t.forEach(function(o){if(fT(o))n.tags.push(o);else if(dT(o)){var s=/[^=]*/.exec(o.style)[0];i.indexOf(s)<0&&i.push(s),n.styles.push(o)}}),this.normalizeLists=!this.tags.some(function(o){if(!/^(ul|ol)\b/.test(o.tag)||!o.node)return!1;var s=r.nodes[o.node];return s.contentMatch.matchType(s)})}return he(e,[{key:"parse",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=new vp(this,n,!1);return i.addAll(t,Y.none,n.from,n.to),i.finish()}},{key:"parseSlice",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=new vp(this,n,!0);return i.addAll(t,Y.none,n.from,n.to),bn.maxOpen(i.finish())}},{key:"matchTag",value:function(t,n,i){for(var o=i?this.tags.indexOf(i)+1:0;o<this.tags.length;o++){var s=this.tags[o];if(gT(t,s.tag)&&(s.namespace===void 0||t.namespaceURI==s.namespace)&&(!s.context||n.matchesContext(s.context))){if(s.getAttrs){var a=s.getAttrs(t);if(a===!1)continue;s.attrs=a||void 0}return s}}}},{key:"matchStyle",value:function(t,n,i,o){for(var s=o?this.styles.indexOf(o)+1:0;s<this.styles.length;s++){var a=this.styles[s],l=a.style;if(!(l.indexOf(t)!=0||a.context&&!i.matchesContext(a.context)||l.length>t.length&&(l.charCodeAt(t.length)!=61||l.slice(t.length+1)!=n))){if(a.getAttrs){var u=a.getAttrs(n);if(u===!1)continue;a.attrs=u||void 0}return a}}}}],[{key:"schemaRules",value:function(t){var n=[];function i(u){for(var c=u.priority==null?50:u.priority,f=0;f<n.length;f++){var d=n[f],h=d.priority==null?50:d.priority;if(h<c)break}n.splice(f,0,u)}var o=function(c){var f=t.marks[c].spec.parseDOM;f&&f.forEach(function(d){i(d=yp(d)),d.mark||d.ignore||d.clearMark||(d.mark=c)})};for(var s in t.marks)o(s);var a=function(c){var f=t.nodes[c].spec.parseDOM;f&&f.forEach(function(d){i(d=yp(d)),d.node||d.ignore||d.mark||(d.node=c)})};for(var l in t.nodes)a(l);return n}},{key:"fromSchema",value:function(t){return t.cached.domParser||(t.cached.domParser=new e(t,e.schemaRules(t)))}}]),e})(),jp={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},pT={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Hp={ol:!0,ul:!0},Oi=1,hu=2,Ei=4;function gp(e,r,t){return r!=null?(r?Oi:0)|(r==="full"?hu:0):e&&e.whitespace=="pre"?Oi|hu:t&~Ei}var cs=(function(){function e(r,t,n,i,o,s){de(this,e),this.type=r,this.attrs=t,this.marks=n,this.solid=i,this.options=s,this.content=[],this.activeMarks=Y.none,this.match=o||(s&Ei?null:r.contentMatch)}return he(e,[{key:"findWrapping",value:function(t){if(!this.match){if(!this.type)return[];var n=this.type.contentMatch.fillBefore(fe.from(t));if(n)this.match=this.type.contentMatch.matchFragment(n);else{var i=this.type.contentMatch,o;return(o=i.findWrapping(t.type))?(this.match=i,o):null}}return this.match.findWrapping(t.type)}},{key:"finish",value:function(t){if(!(this.options&Oi)){var n=this.content[this.content.length-1],i;if(n&&n.isText&&(i=/[ \t\r\n\u000c]+$/.exec(n.text))){var o=n;n.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}var s=fe.from(this.content);return!t&&this.match&&(s=s.append(this.match.fillBefore(fe.empty,!0))),this.type?this.type.create(this.attrs,s,this.marks):s}},{key:"inlineContext",value:function(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!jp.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}]),e})(),vp=(function(){function e(r,t,n){de(this,e),this.parser=r,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;var i=t.topNode,o,s=gp(null,t.preserveWhitespace,0)|(n?Ei:0);i?o=new cs(i.type,i.attrs,Y.none,!0,t.topMatch||i.type.contentMatch,s):n?o=new cs(null,null,Y.none,!0,null,s):o=new cs(r.schema.topNodeType,null,Y.none,!0,null,s),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}return he(e,[{key:"top",get:function(){return this.nodes[this.open]}},{key:"addDOM",value:function(t,n){t.nodeType==3?this.addTextNode(t,n):t.nodeType==1&&this.addElement(t,n)}},{key:"addTextNode",value:function(t,n){var i=t.nodeValue,o=this.top,s=o.options&hu?"full":this.localPreserveWS||(o.options&Oi)>0,a=this.parser.schema;if(s==="full"||o.inlineContext(t)||/[^ \t\r\n\u000c]/.test(i)){if(s)if(s==="full")i=i.replace(/\r\n?/g,`
`);else if(a.linebreakReplacement&&/[\r\n]/.test(i)&&this.top.findWrapping(a.linebreakReplacement.create())){for(var c=i.split(/\r?\n|\r/),f=0;f<c.length;f++)f&&this.insertNode(a.linebreakReplacement.create(),n,!0),c[f]&&this.insertNode(a.text(c[f]),n,!/\S/.test(c[f]));i=""}else i=i.replace(/\r?\n|\r/g," ");else if(i=i.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(i)&&this.open==this.nodes.length-1){var l=o.content[o.content.length-1],u=t.previousSibling;(!l||u&&u.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(i=i.slice(1))}i&&this.insertNode(a.text(i),n,!/\S/.test(i)),this.findInText(t)}else this.findInside(t)}},{key:"addElement",value:function(t,n,i){var o=this.localPreserveWS,s=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);var a=t.nodeName.toLowerCase(),l;Hp.hasOwnProperty(a)&&this.parser.normalizeLists&&mT(t);var u=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(l=this.parser.matchTag(t,this,i));e:if(u?u.ignore:pT.hasOwnProperty(a))this.findInside(t),this.ignoreFallback(t,n);else if(!u||u.skip||u.closeParent){u&&u.closeParent?this.open=Math.max(0,this.open-1):u&&u.skip.nodeType&&(t=u.skip);var c,f=this.needsBlock;if(jp.hasOwnProperty(a))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),c=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,n);break e}var d=u&&u.skip?n:this.readStyles(t,n);d&&this.addAll(t,d),c&&this.sync(s),this.needsBlock=f}else{var h=this.readStyles(t,n);h&&this.addElementByRule(t,u,h,u.consuming===!1?l:void 0)}this.localPreserveWS=o}},{key:"leafFallback",value:function(t,n){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),n)}},{key:"ignoreFallback",value:function(t,n){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}},{key:"readStyles",value:function(t,n){var i=this,o=t.style;if(o&&o.length)for(var s=0;s<this.parser.matchedStyles.length;s++){var a=this.parser.matchedStyles[s],l=o.getPropertyValue(a);if(l){for(var u=function(h){var p=i.parser.matchStyle(a,l,i,h);if(!p)return f=h,0;if(p.ignore)return{v:null};if(p.clearMark?n=n.filter(function(m){return!p.clearMark(m)}):n=n.concat(i.parser.schema.marks[p.mark].create(p.attrs)),p.consuming===!1)h=p;else return f=h,0;f=h},c,f=void 0;c=u(f),c!==0;)if(c)return c.v}}return n}},{key:"addElementByRule",value:function(t,n,i,o){var s=this,a,l;if(n.node)if(l=this.parser.schema.nodes[n.node],l.isLeaf)this.insertNode(l.create(n.attrs),i,t.nodeName=="BR")||this.leafFallback(t,i);else{var u=this.enter(l,n.attrs||null,i,n.preserveWhitespace);u&&(a=!0,i=u)}else{var c=this.parser.schema.marks[n.mark];i=i.concat(c.create(n.attrs))}var f=this.top;if(l&&l.isLeaf)this.findInside(t);else if(o)this.addElement(t,i,o);else if(n.getContent)this.findInside(t),n.getContent(t,this.parser.schema).forEach(function(h){return s.insertNode(h,i,!1)});else{var d=t;typeof n.contentElement=="string"?d=t.querySelector(n.contentElement):typeof n.contentElement=="function"?d=n.contentElement(t):n.contentElement&&(d=n.contentElement),this.findAround(t,d,!0),this.addAll(d,i),this.findAround(t,d,!1)}a&&this.sync(f)&&this.open--}},{key:"addAll",value:function(t,n,i,o){for(var s=i||0,a=i?t.childNodes[i]:t.firstChild,l=o==null?null:t.childNodes[o];a!=l;a=a.nextSibling,++s)this.findAtPoint(t,s),this.addDOM(a,n);this.findAtPoint(t,s)}},{key:"findPlace",value:function(t,n,i){for(var o,s,a=this.open,l=0;a>=0;a--){var u=this.nodes[a],c=u.findWrapping(t);if(c&&(!o||o.length>c.length+l)&&(o=c,s=u,!c.length))break;if(u.solid){if(i)break;l+=2}}if(!o)return null;this.sync(s);for(var f=0;f<o.length;f++)n=this.enterInner(o[f],null,n,!1);return n}},{key:"insertNode",value:function(t,n,i){if(t.isInline&&this.needsBlock&&!this.top.type){var o=this.textblockFromContext();o&&(n=this.enterInner(o,null,n))}var s=this.findPlace(t,n,i);if(s){this.closeExtra();var a=this.top;a.match&&(a.match=a.match.matchType(t.type));var l=Y.none,u=z_(s.concat(t.marks)),c;try{for(u.s();!(c=u.n()).done;){var f=c.value;(a.type?a.type.allowsMarkType(f.type):bp(f.type,t.type))&&(l=f.addToSet(l))}}catch(d){u.e(d)}finally{u.f()}return a.content.push(t.mark(l)),!0}return!1}},{key:"enter",value:function(t,n,i,o){var s=this.findPlace(t.create(n),i,!1);return s&&(s=this.enterInner(t,n,i,!0,o)),s}},{key:"enterInner",value:function(t,n,i){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4?arguments[4]:void 0;this.closeExtra();var a=this.top;a.match=a.match&&a.match.matchType(t);var l=gp(t,s,a.options);a.options&Ei&&a.content.length==0&&(l|=Ei);var u=Y.none;return i=i.filter(function(c){return(a.type?a.type.allowsMarkType(c.type):bp(c.type,t))?(u=c.addToSet(u),!1):!0}),this.nodes.push(new cs(t,n,u,o,null,l)),this.open++,i}},{key:"closeExtra",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(t));this.nodes.length=this.open+1}}},{key:"finish",value:function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}},{key:"sync",value:function(t){for(var n=this.open;n>=0;n--){if(this.nodes[n]==t)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Oi)}return!1}},{key:"currentPos",get:function(){this.closeExtra();for(var t=0,n=this.open;n>=0;n--){for(var i=this.nodes[n].content,o=i.length-1;o>=0;o--)t+=i[o].nodeSize;n&&t++}return t}},{key:"findAtPoint",value:function(t,n){if(this.find)for(var i=0;i<this.find.length;i++)this.find[i].node==t&&this.find[i].offset==n&&(this.find[i].pos=this.currentPos)}},{key:"findInside",value:function(t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].pos==null&&t.nodeType==1&&t.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}},{key:"findAround",value:function(t,n,i){if(t!=n&&this.find){for(var o=0;o<this.find.length;o++)if(this.find[o].pos==null&&t.nodeType==1&&t.contains(this.find[o].node)){var s=n.compareDocumentPosition(this.find[o].node);s&(i?2:4)&&(this.find[o].pos=this.currentPos)}}}},{key:"findInText",value:function(t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&(this.find[n].pos=this.currentPos-(t.nodeValue.length-this.find[n].offset))}},{key:"matchesContext",value:function(t){var n=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var i=t.split("/"),o=this.options.context,s=!this.isOpen&&(!o||o.parent.type==this.nodes[0].type),a=-(o?o.depth+1:0)+(s?0:1),l=function u(c,f){for(;c>=0;c--){var d=i[c];if(d==""){if(c==i.length-1||c==0)continue;for(;f>=a;f--)if(u(c-1,f))return!0;return!1}else{var h=f>0||f==0&&s?n.nodes[f].type:o&&f>=a?o.node(f-a).type:null;if(!h||h.name!=d&&!h.isInGroup(d))return!1;f--}}return!0};return l(i.length-1,this.open)}},{key:"textblockFromContext",value:function(){var t=this.options.context;if(t)for(var n=t.depth;n>=0;n--){var i=t.node(n).contentMatchAt(t.indexAfter(n)).defaultType;if(i&&i.isTextblock&&i.defaultAttrs)return i}for(var o in this.parser.schema.nodes){var s=this.parser.schema.nodes[o];if(s.isTextblock&&s.defaultAttrs)return s}}}]),e})();function mT(e){for(var r=e.firstChild,t=null;r;r=r.nextSibling){var n=r.nodeType==1?r.nodeName.toLowerCase():null;n&&Hp.hasOwnProperty(n)&&t?(t.appendChild(r),r=t):n=="li"?t=r:n&&(t=null)}}function gT(e,r){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,r)}function yp(e){var r={};for(var t in e)r[t]=e[t];return r}function bp(e,r){var t=r.schema.nodes,n=function(){var a=t[o];if(!a.allowsMarkType(e))return 0;var l=[],u=function c(f){l.push(f);for(var d=0;d<f.edgeCount;d++){var h=f.edge(d),p=h.type,m=h.next;if(p==r||l.indexOf(m)<0&&c(m))return!0}};if(u(a.contentMatch))return{v:!0}},i;for(var o in t)if(i=n(),i!==0&&i)return i.v}var vT=(function(){function e(r,t){de(this,e),this.nodes=r,this.marks=t}return he(e,[{key:"serializeFragment",value:function(t){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;o||(o=lu(i).createDocumentFragment());var s=o,a=[];return t.forEach(function(l){if(a.length||l.marks.length){for(var u=0,c=0;u<a.length&&c<l.marks.length;){var f=l.marks[c];if(!n.marks[f.type.name]){c++;continue}if(!f.eq(a[u][0])||f.type.spec.spanning===!1)break;u++,c++}for(;u<a.length;)s=a.pop()[1];for(;c<l.marks.length;){var d=l.marks[c++],h=n.serializeMark(d,l.isInline,i);h&&(a.push([d,s]),s.appendChild(h.dom),s=h.contentDOM||h.dom)}}s.appendChild(n.serializeNodeInner(l,i))}),o}},{key:"serializeNodeInner",value:function(t,n){var i=hs(lu(n),this.nodes[t.type.name](t),null,t.attrs),o=i.dom,s=i.contentDOM;if(s){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,n,s)}return o}},{key:"serializeNode",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=this.serializeNodeInner(t,n),o=t.marks.length-1;o>=0;o--){var s=this.serializeMark(t.marks[o],t.isInline,n);s&&((s.contentDOM||s.dom).appendChild(i),i=s.dom)}return i}},{key:"serializeMark",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=this.marks[t.type.name];return o&&hs(lu(i),o(t,n),null,t.attrs)}}],[{key:"renderSpec",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0;return hs(t,n,i,o)}},{key:"fromSchema",value:function(t){return t.cached.domSerializer||(t.cached.domSerializer=new e(this.nodesFromSchema(t),this.marksFromSchema(t)))}},{key:"nodesFromSchema",value:function(t){var n=kp(t.nodes);return n.text||(n.text=function(i){return i.text}),n}},{key:"marksFromSchema",value:function(t){return kp(t.marks)}}]),e})();function kp(e){var r={};for(var t in e){var n=e[t].spec.toDOM;n&&(r[t]=n)}return r}function lu(e){return e.document||window.document}var wp=new WeakMap;function yT(e){var r=wp.get(e);return r===void 0&&wp.set(e,r=bT(e)),r}function bT(e){var r=null;function t(n){if(n&&st(n)=="object")if(Array.isArray(n))if(typeof n[0]=="string")r||(r=[]),r.push(n);else for(var i=0;i<n.length;i++)t(n[i]);else for(var o in n)t(n[o])}return t(e),r}function hs(e,r,t,n){if(typeof r=="string")return{dom:e.createTextNode(r)};if(r.nodeType!=null)return{dom:r};if(r.dom&&r.dom.nodeType!=null)return r;var i=r[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(o=yT(n))&&o.indexOf(r)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");var s=i.indexOf(" ");s>0&&(t=i.slice(0,s),i=i.slice(s+1));var a,l=t?e.createElementNS(t,i):e.createElement(i),u=r[1],c=1;if(u&&st(u)=="object"&&u.nodeType==null&&!Array.isArray(u)){c=2;for(var f in u)if(u[f]!=null){var d=f.indexOf(" ");d>0?l.setAttributeNS(f.slice(0,d),f.slice(d+1),u[f]):f=="style"&&l.style?l.style.cssText=u[f]:l.setAttribute(f,u[f])}}for(var h=c;h<r.length;h++){var p=r[h];if(p===0){if(h<r.length-1||h>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{var m=hs(e,p,t,n),v=m.dom,g=m.contentDOM;if(l.appendChild(v),g){if(a)throw new RangeError("Multiple content holes");a=g}}}return{dom:l,contentDOM:a}}He.ContentMatch=kn;He.DOMParser=hT;He.DOMSerializer=vT;He.Fragment=fe;He.Mark=Y;He.MarkType=qp;He.Node=zr;He.NodeRange=Pp;He.NodeType=du;He.ReplaceError=ms;He.ResolvedPos=fu;He.Schema=cT;He.Slice=bn});var cr=S($=>{"use strict";function vu(e){var r=typeof Map=="function"?new Map:void 0;return vu=function(n){if(n===null||!kT(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r<"u"){if(r.has(n))return r.get(n);r.set(n,i)}function i(){return vs(n,arguments,Pi(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Ni(i,n)},vu(e)}function vs(e,r,t){return Up()?vs=Reflect.construct.bind():vs=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&Ni(u,s.prototype),u},vs.apply(null,arguments)}function kT(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function jt(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&Ni(e,r)}function Ni(e,r){return Ni=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ni(e,r)}function Ht(e){var r=Up();return function(){var n=Pi(e),i;if(r){var o=Pi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return wT(this,i)}}function wT(e,r){if(r&&(wn(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ST(e)}function ST(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Up(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pi(e){return Pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pi(e)}function wn(e){"@babel/helpers - typeof";return wn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},wn(e)}function Ee(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function $p(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xT(n.key),n)}}function Ce(e,r,t){return r&&$p(e.prototype,r),t&&$p(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function xT(e){var r=_T(e,"string");return wn(r)==="symbol"?r:String(r)}function _T(e,r){if(wn(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(wn(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var M=lr(),Kp=65535,Jp=Math.pow(2,16);function TT(e,r){return e+r*Jp}function Wp(e){return e&Kp}function ET(e){return(e-(e&Kp))/Jp}var Zp=1,Gp=2,ys=4,Xp=8,bs=(function(){function e(r,t,n){Ee(this,e),this.pos=r,this.delInfo=t,this.recover=n}return Ce(e,[{key:"deleted",get:function(){return(this.delInfo&Xp)>0}},{key:"deletedBefore",get:function(){return(this.delInfo&(Zp|ys))>0}},{key:"deletedAfter",get:function(){return(this.delInfo&(Gp|ys))>0}},{key:"deletedAcross",get:function(){return(this.delInfo&ys)>0}}]),e})(),ur=(function(){function e(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Ee(this,e),this.ranges=r,this.inverted=t,!r.length&&e.empty)return e.empty}return Ce(e,[{key:"recover",value:function(t){var n=0,i=Wp(t);if(!this.inverted)for(var o=0;o<i;o++)n+=this.ranges[o*3+2]-this.ranges[o*3+1];return this.ranges[i*3]+n+ET(t)}},{key:"mapResult",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._map(t,n,!1)}},{key:"map",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._map(t,n,!0)}},{key:"_map",value:function(t,n,i){for(var o=0,s=this.inverted?2:1,a=this.inverted?1:2,l=0;l<this.ranges.length;l+=3){var u=this.ranges[l]-(this.inverted?o:0);if(u>t)break;var c=this.ranges[l+s],f=this.ranges[l+a],d=u+c;if(t<=d){var h=c?t==u?-1:t==d?1:n:n,p=u+o+(h<0?0:f);if(i)return p;var m=t==(n<0?u:d)?null:TT(l/3,t-u),v=t==u?Gp:t==d?Zp:ys;return(n<0?t!=u:t!=d)&&(v|=Xp),new bs(p,v,m)}o+=f-c}return i?t+o:new bs(t+o,0,null)}},{key:"touches",value:function(t,n){for(var i=0,o=Wp(n),s=this.inverted?2:1,a=this.inverted?1:2,l=0;l<this.ranges.length;l+=3){var u=this.ranges[l]-(this.inverted?i:0);if(u>t)break;var c=this.ranges[l+s],f=u+c;if(t<=f&&l==o*3)return!0;i+=this.ranges[l+a]-c}return!1}},{key:"forEach",value:function(t){for(var n=this.inverted?2:1,i=this.inverted?1:2,o=0,s=0;o<this.ranges.length;o+=3){var a=this.ranges[o],l=a-(this.inverted?s:0),u=a+(this.inverted?0:s),c=this.ranges[o+n],f=this.ranges[o+i];t(l,l+c,u,u+f),s+=f-c}}},{key:"invert",value:function(){return new e(this.ranges,!this.inverted)}},{key:"toString",value:function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}}],[{key:"offset",value:function(t){return t==0?e.empty:new e(t<0?[0,-t,0]:[0,0,t])}}]),e})();ur.empty=new ur([]);var Yp=(function(){function e(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r?r.length:0;Ee(this,e),this.mirror=t,this.from=n,this.to=i,this._maps=r||[],this.ownData=!(r||t)}return Ce(e,[{key:"maps",get:function(){return this._maps}},{key:"slice",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.maps.length;return new e(this._maps,this.mirror,t,n)}},{key:"appendMap",value:function(t,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),n!=null&&this.setMirror(this._maps.length-1,n)}},{key:"appendMapping",value:function(t){for(var n=0,i=this._maps.length;n<t._maps.length;n++){var o=t.getMirror(n);this.appendMap(t._maps[n],o!=null&&o<n?i+o:void 0)}}},{key:"getMirror",value:function(t){if(this.mirror){for(var n=0;n<this.mirror.length;n++)if(this.mirror[n]==t)return this.mirror[n+(n%2?-1:1)]}}},{key:"setMirror",value:function(t,n){this.mirror||(this.mirror=[]),this.mirror.push(t,n)}},{key:"appendMappingInverted",value:function(t){for(var n=t.maps.length-1,i=this._maps.length+t._maps.length;n>=0;n--){var o=t.getMirror(n);this.appendMap(t._maps[n].invert(),o!=null&&o>n?i-o-1:void 0)}}},{key:"invert",value:function(){var t=new e;return t.appendMappingInverted(this),t}},{key:"map",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(this.mirror)return this._map(t,n,!0);for(var i=this.from;i<this.to;i++)t=this._maps[i].map(t,n);return t}},{key:"mapResult",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._map(t,n,!1)}},{key:"_map",value:function(t,n,i){for(var o=0,s=this.from;s<this.to;s++){var a=this._maps[s],l=a.mapResult(t,n);if(l.recover!=null){var u=this.getMirror(s);if(u!=null&&u>s&&u<this.to){s=u,t=this._maps[u].recover(l.recover);continue}}o|=l.delInfo,t=l.pos}return i?t:new bs(t,o,null)}}]),e})(),pu=Object.create(null),ve=(function(){function e(){Ee(this,e)}return Ce(e,[{key:"getMap",value:function(){return ur.empty}},{key:"merge",value:function(t){return null}}],[{key:"fromJSON",value:function(t,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");var i=pu[n.stepType];if(!i)throw new RangeError("No step type ".concat(n.stepType," defined"));return i.fromJSON(t,n)}},{key:"jsonID",value:function(t,n){if(t in pu)throw new RangeError("Duplicate use of step JSON ID "+t);return pu[t]=n,n.prototype.jsonID=t,n}}]),e})(),Te=(function(){function e(r,t){Ee(this,e),this.doc=r,this.failed=t}return Ce(e,null,[{key:"ok",value:function(t){return new e(t,null)}},{key:"fail",value:function(t){return new e(null,t)}},{key:"fromReplace",value:function(t,n,i,o){try{return e.ok(t.replace(n,i,o))}catch(s){if(s instanceof M.ReplaceError)return e.fail(s.message);throw s}}}]),e})();function bu(e,r,t){for(var n=[],i=0;i<e.childCount;i++){var o=e.child(i);o.content.size&&(o=o.copy(bu(o.content,r,o))),o.isInline&&(o=r(o,t,i)),n.push(o)}return M.Fragment.fromArray(n)}var ks=(function(e){jt(t,e);var r=Ht(t);function t(n,i,o){var s;return Ee(this,t),s=r.call(this),s.from=n,s.to=i,s.mark=o,s}return Ce(t,[{key:"apply",value:function(i){var o=this,s=i.slice(this.from,this.to),a=i.resolve(this.from),l=a.node(a.sharedDepth(this.to)),u=new M.Slice(bu(s.content,function(c,f){return!c.isAtom||!f.type.allowsMarkType(o.mark.type)?c:c.mark(o.mark.addToSet(c.marks))},l),s.openStart,s.openEnd);return Te.fromReplace(i,this.from,this.to,u)}},{key:"invert",value:function(){return new Sn(this.from,this.to,this.mark)}},{key:"map",value:function(i){var o=i.mapResult(this.from,1),s=i.mapResult(this.to,-1);return o.deleted&&s.deleted||o.pos>=s.pos?null:new t(o.pos,s.pos,this.mark)}},{key:"merge",value:function(i){return i instanceof t&&i.mark.eq(this.mark)&&this.from<=i.to&&this.to>=i.from?new t(Math.min(this.from,i.from),Math.max(this.to,i.to),this.mark):null}},{key:"toJSON",value:function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}}],[{key:"fromJSON",value:function(i,o){if(typeof o.from!="number"||typeof o.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new t(o.from,o.to,i.markFromJSON(o.mark))}}]),t})(ve);ve.jsonID("addMark",ks);var Sn=(function(e){jt(t,e);var r=Ht(t);function t(n,i,o){var s;return Ee(this,t),s=r.call(this),s.from=n,s.to=i,s.mark=o,s}return Ce(t,[{key:"apply",value:function(i){var o=this,s=i.slice(this.from,this.to),a=new M.Slice(bu(s.content,function(l){return l.mark(o.mark.removeFromSet(l.marks))},i),s.openStart,s.openEnd);return Te.fromReplace(i,this.from,this.to,a)}},{key:"invert",value:function(){return new ks(this.from,this.to,this.mark)}},{key:"map",value:function(i){var o=i.mapResult(this.from,1),s=i.mapResult(this.to,-1);return o.deleted&&s.deleted||o.pos>=s.pos?null:new t(o.pos,s.pos,this.mark)}},{key:"merge",value:function(i){return i instanceof t&&i.mark.eq(this.mark)&&this.from<=i.to&&this.to>=i.from?new t(Math.min(this.from,i.from),Math.max(this.to,i.to),this.mark):null}},{key:"toJSON",value:function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}}],[{key:"fromJSON",value:function(i,o){if(typeof o.from!="number"||typeof o.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new t(o.from,o.to,i.markFromJSON(o.mark))}}]),t})(ve);ve.jsonID("removeMark",Sn);var ws=(function(e){jt(t,e);var r=Ht(t);function t(n,i){var o;return Ee(this,t),o=r.call(this),o.pos=n,o.mark=i,o}return Ce(t,[{key:"apply",value:function(i){var o=i.nodeAt(this.pos);if(!o)return Te.fail("No node at mark step's position");var s=o.type.create(o.attrs,null,this.mark.addToSet(o.marks));return Te.fromReplace(i,this.pos,this.pos+1,new M.Slice(M.Fragment.from(s),0,o.isLeaf?0:1))}},{key:"invert",value:function(i){var o=i.nodeAt(this.pos);if(o){var s=this.mark.addToSet(o.marks);if(s.length==o.marks.length){for(var a=0;a<o.marks.length;a++)if(!o.marks[a].isInSet(s))return new t(this.pos,o.marks[a]);return new t(this.pos,this.mark)}}return new Ri(this.pos,this.mark)}},{key:"map",value:function(i){var o=i.mapResult(this.pos,1);return o.deletedAfter?null:new t(o.pos,this.mark)}},{key:"toJSON",value:function(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}}],[{key:"fromJSON",value:function(i,o){if(typeof o.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new t(o.pos,i.markFromJSON(o.mark))}}]),t})(ve);ve.jsonID("addNodeMark",ws);var Ri=(function(e){jt(t,e);var r=Ht(t);function t(n,i){var o;return Ee(this,t),o=r.call(this),o.pos=n,o.mark=i,o}return Ce(t,[{key:"apply",value:function(i){var o=i.nodeAt(this.pos);if(!o)return Te.fail("No node at mark step's position");var s=o.type.create(o.attrs,null,this.mark.removeFromSet(o.marks));return Te.fromReplace(i,this.pos,this.pos+1,new M.Slice(M.Fragment.from(s),0,o.isLeaf?0:1))}},{key:"invert",value:function(i){var o=i.nodeAt(this.pos);return!o||!this.mark.isInSet(o.marks)?this:new ws(this.pos,this.mark)}},{key:"map",value:function(i){var o=i.mapResult(this.pos,1);return o.deletedAfter?null:new t(o.pos,this.mark)}},{key:"toJSON",value:function(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}}],[{key:"fromJSON",value:function(i,o){if(typeof o.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new t(o.pos,i.markFromJSON(o.mark))}}]),t})(ve);ve.jsonID("removeNodeMark",Ri);var qt=(function(e){jt(t,e);var r=Ht(t);function t(n,i,o){var s,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return Ee(this,t),s=r.call(this),s.from=n,s.to=i,s.slice=o,s.structure=a,s}return Ce(t,[{key:"apply",value:function(i){return this.structure&&yu(i,this.from,this.to)?Te.fail("Structure replace would overwrite content"):Te.fromReplace(i,this.from,this.to,this.slice)}},{key:"getMap",value:function(){return new ur([this.from,this.to-this.from,this.slice.size])}},{key:"invert",value:function(i){return new t(this.from,this.from+this.slice.size,i.slice(this.from,this.to))}},{key:"map",value:function(i){var o=i.mapResult(this.from,1),s=i.mapResult(this.to,-1);return o.deletedAcross&&s.deletedAcross?null:new t(o.pos,Math.max(o.pos,s.pos),this.slice,this.structure)}},{key:"merge",value:function(i){if(!(i instanceof t)||i.structure||this.structure)return null;if(this.from+this.slice.size==i.from&&!this.slice.openEnd&&!i.slice.openStart){var o=this.slice.size+i.slice.size==0?M.Slice.empty:new M.Slice(this.slice.content.append(i.slice.content),this.slice.openStart,i.slice.openEnd);return new t(this.from,this.to+(i.to-i.from),o,this.structure)}else if(i.to==this.from&&!this.slice.openStart&&!i.slice.openEnd){var s=this.slice.size+i.slice.size==0?M.Slice.empty:new M.Slice(i.slice.content.append(this.slice.content),i.slice.openStart,this.slice.openEnd);return new t(i.from,this.to,s,this.structure)}else return null}},{key:"toJSON",value:function(){var i={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(i.slice=this.slice.toJSON()),this.structure&&(i.structure=!0),i}}],[{key:"fromJSON",value:function(i,o){if(typeof o.from!="number"||typeof o.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new t(o.from,o.to,M.Slice.fromJSON(i,o.slice),!!o.structure)}}]),t})(ve);ve.jsonID("replace",qt);var jr=(function(e){jt(t,e);var r=Ht(t);function t(n,i,o,s,a,l){var u,c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1;return Ee(this,t),u=r.call(this),u.from=n,u.to=i,u.gapFrom=o,u.gapTo=s,u.slice=a,u.insert=l,u.structure=c,u}return Ce(t,[{key:"apply",value:function(i){if(this.structure&&(yu(i,this.from,this.gapFrom)||yu(i,this.gapTo,this.to)))return Te.fail("Structure gap-replace would overwrite content");var o=i.slice(this.gapFrom,this.gapTo);if(o.openStart||o.openEnd)return Te.fail("Gap is not a flat range");var s=this.slice.insertAt(this.insert,o.content);return s?Te.fromReplace(i,this.from,this.to,s):Te.fail("Content does not fit in gap")}},{key:"getMap",value:function(){return new ur([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}},{key:"invert",value:function(i){var o=this.gapTo-this.gapFrom;return new t(this.from,this.from+this.slice.size+o,this.from+this.insert,this.from+this.insert+o,i.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}},{key:"map",value:function(i){var o=i.mapResult(this.from,1),s=i.mapResult(this.to,-1),a=this.from==this.gapFrom?o.pos:i.map(this.gapFrom,-1),l=this.to==this.gapTo?s.pos:i.map(this.gapTo,1);return o.deletedAcross&&s.deletedAcross||a<o.pos||l>s.pos?null:new t(o.pos,s.pos,a,l,this.slice,this.insert,this.structure)}},{key:"toJSON",value:function(){var i={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(i.slice=this.slice.toJSON()),this.structure&&(i.structure=!0),i}}],[{key:"fromJSON",value:function(i,o){if(typeof o.from!="number"||typeof o.to!="number"||typeof o.gapFrom!="number"||typeof o.gapTo!="number"||typeof o.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new t(o.from,o.to,o.gapFrom,o.gapTo,M.Slice.fromJSON(i,o.slice),o.insert,!!o.structure)}}]),t})(ve);ve.jsonID("replaceAround",jr);function yu(e,r,t){for(var n=e.resolve(r),i=t-r,o=n.depth;i>0&&o>0&&n.indexAfter(o)==n.node(o).childCount;)o--,i--;if(i>0)for(var s=n.node(o).maybeChild(n.indexAfter(o));i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}return!1}function CT(e,r,t,n){var i=[],o=[],s,a;e.doc.nodesBetween(r,t,function(l,u,c){if(l.isInline){var f=l.marks;if(!n.isInSet(f)&&c.type.allowsMarkType(n.type)){for(var d=Math.max(u,r),h=Math.min(u+l.nodeSize,t),p=n.addToSet(f),m=0;m<f.length;m++)f[m].isInSet(p)||(s&&s.to==d&&s.mark.eq(f[m])?s.to=h:i.push(s=new Sn(d,h,f[m])));a&&a.to==d?a.to=h:o.push(a=new ks(d,h,n))}}}),i.forEach(function(l){return e.step(l)}),o.forEach(function(l){return e.step(l)})}function OT(e,r,t,n){var i=[],o=0;e.doc.nodesBetween(r,t,function(s,a){if(s.isInline){o++;var l=null;if(n instanceof M.MarkType)for(var u=s.marks,c;c=n.isInSet(u);)(l||(l=[])).push(c),u=c.removeFromSet(u);else n?n.isInSet(s.marks)&&(l=[n]):l=s.marks;if(l&&l.length)for(var f=Math.min(a+s.nodeSize,t),d=0;d<l.length;d++){for(var h=l[d],p=void 0,m=0;m<i.length;m++){var v=i[m];v.step==o-1&&h.eq(i[m].style)&&(p=v)}p?(p.to=f,p.step=o):i.push({style:h,from:Math.max(a,r),to:f,step:o})}}}),i.forEach(function(s){return e.step(new Sn(s.from,s.to,s.style))})}function ku(e,r,t){for(var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:t.contentMatch,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=e.doc.nodeAt(r),s=[],a=r+1,l=0;l<o.childCount;l++){var u=o.child(l),c=a+u.nodeSize,f=n.matchType(u.type);if(!f)s.push(new qt(a,c,M.Slice.empty));else{n=f;for(var d=0;d<u.marks.length;d++)t.allowsMarkType(u.marks[d].type)||e.step(new Sn(a,c,u.marks[d]));if(i&&u.isText&&t.whitespace!="pre")for(var h=void 0,p=/\r?\n|\r/g,m=void 0;h=p.exec(u.text);)m||(m=new M.Slice(M.Fragment.from(t.schema.text(" ",t.allowedMarks(u.marks))),0,0)),s.push(new qt(a+h.index,a+h.index+h[0].length,m))}a=c}if(!n.validEnd){var v=n.fillBefore(M.Fragment.empty,!0);e.replace(a,a,new M.Slice(v,0,0))}for(var g=s.length-1;g>=0;g--)e.step(s[g])}function MT(e,r,t){return(r==0||e.canReplace(r,e.childCount))&&(t==e.childCount||e.canReplace(0,t))}function AT(e){for(var r=e.parent,t=r.content.cutByIndex(e.startIndex,e.endIndex),n=e.depth,i=0,o=0;;--n){var s=e.$from.node(n),a=e.$from.index(n)+i,l=e.$to.indexAfter(n)-o;if(n<e.depth&&s.canReplace(a,l,t))return n;if(n==0||s.type.spec.isolating||!MT(s,a,l))break;a&&(i=1),l<s.childCount&&(o=1)}return null}function NT(e,r,t){for(var n=r.$from,i=r.$to,o=r.depth,s=n.before(o+1),a=i.after(o+1),l=s,u=a,c=M.Fragment.empty,f=0,d=o,h=!1;d>t;d--)h||n.index(d)>0?(h=!0,c=M.Fragment.from(n.node(d).copy(c)),f++):l--;for(var p=M.Fragment.empty,m=0,v=o,g=!1;v>t;v--)g||i.after(v+1)<i.end(v)?(g=!0,p=M.Fragment.from(i.node(v).copy(p)),m++):u++;e.step(new jr(l,u,s,a,new M.Slice(c.append(p),f,m),c.size-f,!0))}function PT(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e,i=RT(e,r),o=i&&DT(n,r);return o?i.map(Vp).concat({type:r,attrs:t}).concat(o.map(Vp)):null}function Vp(e){return{type:e,attrs:null}}function RT(e,r){var t=e.parent,n=e.startIndex,i=e.endIndex,o=t.contentMatchAt(n).findWrapping(r);if(!o)return null;var s=o.length?o[0]:r;return t.canReplaceWith(n,i,s)?o:null}function DT(e,r){var t=e.parent,n=e.startIndex,i=e.endIndex,o=t.child(n),s=r.contentMatch.findWrapping(o.type);if(!s)return null;for(var a=s.length?s[s.length-1]:r,l=a.contentMatch,u=n;l&&u<i;u++)l=l.matchType(t.child(u).type);return!l||!l.validEnd?null:s}function IT(e,r,t){for(var n=M.Fragment.empty,i=t.length-1;i>=0;i--){if(n.size){var o=t[i].type.contentMatch.matchFragment(n);if(!o||!o.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=M.Fragment.from(t[i].type.create(t[i].attrs,n))}var s=r.start,a=r.end;e.step(new jr(s,a,s,a,new M.Slice(n,0,0),t.length,!0))}function LT(e,r,t,n,i){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var o=e.steps.length;e.doc.nodesBetween(r,t,function(s,a){var l=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(n,l)&&FT(e.doc,e.mapping.slice(o).map(a),n)){var u=null;if(n.schema.linebreakReplacement){var c=n.whitespace=="pre",f=!!n.contentMatch.matchType(n.schema.linebreakReplacement);c&&!f?u=!1:!c&&f&&(u=!0)}u===!1&&em(e,s,a,o),ku(e,e.mapping.slice(o).map(a,1),n,void 0,u===null);var d=e.mapping.slice(o),h=d.map(a,1),p=d.map(a+s.nodeSize,1);return e.step(new jr(h,p,h+1,p-1,new M.Slice(M.Fragment.from(n.create(l,null,s.marks)),0,0),1,!0)),u===!0&&Qp(e,s,a,o),!1}})}function Qp(e,r,t,n){r.forEach(function(i,o){if(i.isText)for(var s,a=/\r?\n|\r/g;s=a.exec(i.text);){var l=e.mapping.slice(n).map(t+1+o+s.index);e.replaceWith(l,l+1,r.type.schema.linebreakReplacement.create())}})}function em(e,r,t,n){r.forEach(function(i,o){if(i.type==i.type.schema.linebreakReplacement){var s=e.mapping.slice(n).map(t+1+o);e.replaceWith(s,s+1,r.type.schema.text(`
`))}})}function FT(e,r,t){var n=e.resolve(r),i=n.index();return n.parent.canReplaceWith(i,i+1,t)}function BT(e,r,t,n,i){var o=e.doc.nodeAt(r);if(!o)throw new RangeError("No node at given position");t||(t=o.type);var s=t.create(n,null,i||o.marks);if(o.isLeaf)return e.replaceWith(r,r+o.nodeSize,s);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);e.step(new jr(r,r+o.nodeSize,r+1,r+o.nodeSize-1,new M.Slice(M.Fragment.from(s),0,0),1,!0))}function zT(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0,i=e.resolve(r),o=i.depth-t,s=n&&n[n.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(var a=i.depth-1,l=t-2;a>o;a--,l--){var u=i.node(a),c=i.index(a);if(u.type.spec.isolating)return!1;var f=u.content.cutByIndex(c,u.childCount),d=n&&n[l+1];d&&(f=f.replaceChild(0,d.type.create(d.attrs)));var h=n&&n[l]||u;if(!u.canReplace(c+1,u.childCount)||!h.type.validContent(f))return!1}var p=i.indexAfter(o),m=n&&n[0];return i.node(o).canReplaceWith(p,p,m?m.type:i.node(o+1).type)}function qT(e,r){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0,i=e.doc.resolve(r),o=M.Fragment.empty,s=M.Fragment.empty,a=i.depth,l=i.depth-t,u=t-1;a>l;a--,u--){o=M.Fragment.from(i.node(a).copy(o));var c=n&&n[u];s=M.Fragment.from(c?c.type.create(c.attrs,s):i.node(a).copy(s))}e.step(new qt(r,r,new M.Slice(o.append(s),t,t),!0))}function jT(e,r){var t=e.resolve(r),n=t.index();return tm(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(n,n+1)}function HT(e,r){r.content.size||e.type.compatibleContent(r.type);for(var t=e.contentMatchAt(e.childCount),n=e.type.schema.linebreakReplacement,i=0;i<r.childCount;i++){var o=r.child(i),s=o.type==n?e.type.schema.nodes.text:o.type;if(t=t.matchType(s),!t||!e.type.allowsMarks(o.marks))return!1}return t.validEnd}function tm(e,r){return!!(e&&r&&!e.isLeaf&&HT(e,r))}function $T(e,r){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,n=e.resolve(r),i=n.depth;;i--){var o=void 0,s=void 0,a=n.index(i);if(i==n.depth?(o=n.nodeBefore,s=n.nodeAfter):t>0?(o=n.node(i+1),a++,s=n.node(i).maybeChild(a)):(o=n.node(i).maybeChild(a-1),s=n.node(i+1)),o&&!o.isTextblock&&tm(o,s)&&n.node(i).canReplace(a,a+1))return r;if(i==0)break;r=t<0?n.before(i):n.after(i)}}function WT(e,r,t){var n=null,i=e.doc.type.schema.linebreakReplacement,o=e.doc.resolve(r-t),s=o.node().type;if(i&&s.inlineContent){var a=s.whitespace=="pre",l=!!s.contentMatch.matchType(i);a&&!l?n=!1:!a&&l&&(n=!0)}var u=e.steps.length;if(n===!1){var c=e.doc.resolve(r+t);em(e,c.node(),c.before(),u)}s.inlineContent&&ku(e,r+t-1,s,o.node().contentMatchAt(o.index()),n==null);var f=e.mapping.slice(u),d=f.map(r-t);if(e.step(new qt(d,f.map(r+t,-1),M.Slice.empty,!0)),n===!0){var h=e.doc.resolve(d);Qp(e,h.node(),h.before(),e.steps.length)}return e}function rm(e,r,t){var n=e.resolve(r);if(n.parent.canReplaceWith(n.index(),n.index(),t))return r;if(n.parentOffset==0)for(var i=n.depth-1;i>=0;i--){var o=n.index(i);if(n.node(i).canReplaceWith(o,o,t))return n.before(i+1);if(o>0)return null}if(n.parentOffset==n.parent.content.size)for(var s=n.depth-1;s>=0;s--){var a=n.indexAfter(s);if(n.node(s).canReplaceWith(a,a,t))return n.after(s+1);if(a<n.node(s).childCount)return null}return null}function VT(e,r,t){var n=e.resolve(r);if(!t.content.size)return r;for(var i=t.content,o=0;o<t.openStart;o++)i=i.firstChild.content;for(var s=1;s<=(t.openStart==0&&t.size?2:1);s++)for(var a=n.depth;a>=0;a--){var l=a==n.depth?0:n.pos<=(n.start(a+1)+n.end(a+1))/2?-1:1,u=n.index(a)+(l>0?1:0),c=n.node(a),f=!1;if(s==1)f=c.canReplace(u,u,i);else{var d=c.contentMatchAt(u).findWrapping(i.firstChild.type);f=d&&c.canReplaceWith(u,u,d[0])}if(f)return l==0?n.pos:l<0?n.before(a+1):n.after(a+1)}return null}function nm(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:M.Slice.empty;if(r==t&&!n.size)return null;var i=e.resolve(r),o=e.resolve(t);return im(i,o,n)?new qt(r,t,n):new UT(i,o,n).fit()}function im(e,r,t){return!t.openStart&&!t.openEnd&&e.start()==r.start()&&e.parent.canReplace(e.index(),r.index(),t.content)}var UT=(function(){function e(r,t,n){Ee(this,e),this.$from=r,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=M.Fragment.empty;for(var i=0;i<=r.depth;i++){var o=r.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(r.indexAfter(i))})}for(var s=r.depth;s>0;s--)this.placed=M.Fragment.from(r.node(s).copy(this.placed))}return Ce(e,[{key:"depth",get:function(){return this.frontier.length-1}},{key:"fit",value:function(){for(;this.unplaced.size;){var t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}var n=this.mustMoveInline(),i=this.placed.size-this.depth-this.$from.depth,o=this.$from,s=this.close(n<0?this.$to:o.doc.resolve(n));if(!s)return null;for(var a=this.placed,l=o.depth,u=s.depth;l&&u&&a.childCount==1;)a=a.firstChild.content,l--,u--;var c=new M.Slice(a,l,u);return n>-1?new jr(o.pos,n,this.$to.pos,this.$to.end(),c,i):c.size||o.pos!=this.$to.pos?new qt(o.pos,s.pos,c):null}},{key:"findFittable",value:function(){for(var t=this.unplaced.openStart,n=this.unplaced.content,i=0,o=this.unplaced.openEnd;i<t;i++){var s=n.firstChild;if(n.childCount>1&&(o=0),s.type.spec.isolating&&o<=i){t=i;break}n=s.content}for(var a=1;a<=2;a++)for(var l=a==1?t:this.unplaced.openStart;l>=0;l--){var u=void 0,c=null;l?(c=mu(this.unplaced.content,l-1).firstChild,u=c.content):u=this.unplaced.content;for(var f=u.firstChild,d=this.depth;d>=0;d--){var h=this.frontier[d],p=h.type,m=h.match,v=void 0,g=null;if(a==1&&(f?m.matchType(f.type)||(g=m.fillBefore(M.Fragment.from(f),!1)):c&&p.compatibleContent(c.type)))return{sliceDepth:l,frontierDepth:d,parent:c,inject:g};if(a==2&&f&&(v=m.findWrapping(f.type)))return{sliceDepth:l,frontierDepth:d,parent:c,wrap:v};if(c&&m.matchType(c.type))break}}}},{key:"openMore",value:function(){var t=this.unplaced,n=t.content,i=t.openStart,o=t.openEnd,s=mu(n,i);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new M.Slice(n,i+1,Math.max(o,s.size+i>=n.size-o?i+1:0)),!0)}},{key:"dropNode",value:function(){var t=this.unplaced,n=t.content,i=t.openStart,o=t.openEnd,s=mu(n,i);if(s.childCount<=1&&i>0){var a=n.size-i<=i+s.size;this.unplaced=new M.Slice(Mi(n,i-1,1),i-1,a?i-1:o)}else this.unplaced=new M.Slice(Mi(n,i,1),i,o)}},{key:"placeNodes",value:function(t){for(var n=t.sliceDepth,i=t.frontierDepth,o=t.parent,s=t.inject,a=t.wrap;this.depth>i;)this.closeFrontierNode();if(a)for(var l=0;l<a.length;l++)this.openFrontierNode(a[l]);var u=this.unplaced,c=o?o.content:u.content,f=u.openStart-n,d=0,h=[],p=this.frontier[i],m=p.match,v=p.type;if(s){for(var g=0;g<s.childCount;g++)h.push(s.child(g));m=m.matchFragment(s)}for(var y=c.size+n-(u.content.size-u.openEnd);d<c.childCount;){var w=c.child(d),b=m.matchType(w.type);if(!b)break;d++,(d>1||f==0||w.content.size)&&(m=b,h.push(om(w.mark(v.allowedMarks(w.marks)),d==1?f:0,d==c.childCount?y:-1)))}var k=d==c.childCount;k||(y=-1),this.placed=Ai(this.placed,i,M.Fragment.from(h)),this.frontier[i].match=m,k&&y<0&&o&&o.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var x=0,T=c;x<y;x++){var _=T.lastChild;this.frontier.push({type:_.type,match:_.contentMatchAt(_.childCount)}),T=_.content}this.unplaced=k?n==0?M.Slice.empty:new M.Slice(Mi(u.content,n-1,1),n-1,y<0?u.openEnd:n-1):new M.Slice(Mi(u.content,n,d),u.openStart,u.openEnd)}},{key:"mustMoveInline",value:function(){if(!this.$to.parent.isTextblock)return-1;var t=this.frontier[this.depth],n;if(!t.type.isTextblock||!gu(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;for(var i=this.$to.depth,o=this.$to.after(i);i>1&&o==this.$to.end(--i);)++o;return o}},{key:"findCloseLevel",value:function(t){e:for(var n=Math.min(this.depth,t.depth);n>=0;n--){var i=this.frontier[n],o=i.match,s=i.type,a=n<t.depth&&t.end(n+1)==t.pos+(t.depth-(n+1)),l=gu(t,n,s,o,a);if(l){for(var u=n-1;u>=0;u--){var c=this.frontier[u],f=c.match,d=c.type,h=gu(t,u,d,f,!0);if(!h||h.childCount)continue e}return{depth:n,fit:l,move:a?t.doc.resolve(t.after(n+1)):t}}}}},{key:"close",value:function(t){var n=this.findCloseLevel(t);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Ai(this.placed,n.depth,n.fit)),t=n.move;for(var i=n.depth+1;i<=t.depth;i++){var o=t.node(i),s=o.type.contentMatch.fillBefore(o.content,!0,t.index(i));this.openFrontierNode(o.type,o.attrs,s)}return t}},{key:"openFrontierNode",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0,o=this.frontier[this.depth];o.match=o.match.matchType(t),this.placed=Ai(this.placed,this.depth,M.Fragment.from(t.create(n,i))),this.frontier.push({type:t,match:t.contentMatch})}},{key:"closeFrontierNode",value:function(){var t=this.frontier.pop(),n=t.match.fillBefore(M.Fragment.empty,!0);n.childCount&&(this.placed=Ai(this.placed,this.frontier.length,n))}}]),e})();function Mi(e,r,t){return r==0?e.cutByIndex(t,e.childCount):e.replaceChild(0,e.firstChild.copy(Mi(e.firstChild.content,r-1,t)))}function Ai(e,r,t){return r==0?e.append(t):e.replaceChild(e.childCount-1,e.lastChild.copy(Ai(e.lastChild.content,r-1,t)))}function mu(e,r){for(var t=0;t<r;t++)e=e.firstChild.content;return e}function om(e,r,t){if(r<=0)return e;var n=e.content;return r>1&&(n=n.replaceChild(0,om(n.firstChild,r-1,n.childCount==1?t-1:0))),r>0&&(n=e.type.contentMatch.fillBefore(n).append(n),t<=0&&(n=n.append(e.type.contentMatch.matchFragment(n).fillBefore(M.Fragment.empty,!0)))),e.copy(n)}function gu(e,r,t,n,i){var o=e.node(r),s=i?e.indexAfter(r):e.index(r);if(s==o.childCount&&!t.compatibleContent(o.type))return null;var a=n.fillBefore(o.content,!0,s);return a&&!KT(t,o.content,s)?a:null}function KT(e,r,t){for(var n=t;n<r.childCount;n++)if(!e.allowsMarks(r.child(n).marks))return!0;return!1}function JT(e){return e.spec.defining||e.spec.definingForContent}function ZT(e,r,t,n){if(!n.size)return e.deleteRange(r,t);var i=e.doc.resolve(r),o=e.doc.resolve(t);if(im(i,o,n))return e.step(new qt(r,t,n));var s=am(i,o);s[s.length-1]==0&&s.pop();var a=-(i.depth+1);s.unshift(a);for(var l=i.depth,u=i.pos-1;l>0;l--,u--){var c=i.node(l).type.spec;if(c.defining||c.definingAsContext||c.isolating)break;s.indexOf(l)>-1?a=l:i.before(l)==u&&s.splice(1,0,-l)}for(var f=s.indexOf(a),d=[],h=n.openStart,p=n.content,m=0;;m++){var v=p.firstChild;if(d.push(v),m==n.openStart)break;p=v.content}for(var g=h-1;g>=0;g--){var y=d[g],w=JT(y.type);if(w&&!y.sameMarkup(i.node(Math.abs(a)-1)))h=g;else if(w||!y.type.isTextblock)break}for(var b=n.openStart;b>=0;b--){var k=(b+h+1)%(n.openStart+1),x=d[k];if(x)for(var T=0;T<s.length;T++){var _=s[(T+f)%s.length],C=!0;_<0&&(C=!1,_=-_);var A=i.node(_-1),O=i.index(_-1);if(A.canReplaceWith(O,O,x.type,x.marks))return e.replace(i.before(_),C?o.after(_):t,new M.Slice(sm(n.content,0,n.openStart,k),k,n.openEnd))}}for(var B=e.steps.length,U=s.length-1;U>=0&&(e.replace(r,t,n),!(e.steps.length>B));U--){var V=s[U];V<0||(r=i.before(V),t=o.after(V))}}function sm(e,r,t,n,i){if(r<t){var o=e.firstChild;e=e.replaceChild(0,o.copy(sm(o.content,r+1,t,n,o)))}if(r>n){var s=i.contentMatchAt(0),a=s.fillBefore(e).append(e);e=a.append(s.matchFragment(a).fillBefore(M.Fragment.empty,!0))}return e}function GT(e,r,t,n){if(!n.isInline&&r==t&&e.doc.resolve(r).parent.content.size){var i=rm(e.doc,r,n.type);i!=null&&(r=t=i)}e.replaceRange(r,t,new M.Slice(M.Fragment.from(n),0,0))}function XT(e,r,t){for(var n=e.doc.resolve(r),i=e.doc.resolve(t),o=am(n,i),s=0;s<o.length;s++){var a=o[s],l=s==o.length-1;if(l&&a==0||n.node(a).type.contentMatch.validEnd)return e.delete(n.start(a),i.end(a));if(a>0&&(l||n.node(a-1).canReplace(n.index(a-1),i.indexAfter(a-1))))return e.delete(n.before(a),i.after(a))}for(var u=1;u<=n.depth&&u<=i.depth;u++)if(r-n.start(u)==n.depth-u&&t>n.end(u)&&i.end(u)-t!=i.depth-u&&n.start(u-1)==i.start(u-1)&&n.node(u-1).canReplace(n.index(u-1),i.index(u-1)))return e.delete(n.before(u),t);e.delete(r,t)}function am(e,r){for(var t=[],n=Math.min(e.depth,r.depth),i=n;i>=0;i--){var o=e.start(i);if(o<e.pos-(e.depth-i)||r.end(i)>r.pos+(r.depth-i)||e.node(i).type.spec.isolating||r.node(i).type.spec.isolating)break;(o==r.start(i)||i==e.depth&&i==r.depth&&e.parent.inlineContent&&r.parent.inlineContent&&i&&r.start(i-1)==o-1)&&t.push(i)}return t}var wu=(function(e){jt(t,e);var r=Ht(t);function t(n,i,o){var s;return Ee(this,t),s=r.call(this),s.pos=n,s.attr=i,s.value=o,s}return Ce(t,[{key:"apply",value:function(i){var o=i.nodeAt(this.pos);if(!o)return Te.fail("No node at attribute step's position");var s=Object.create(null);for(var a in o.attrs)s[a]=o.attrs[a];s[this.attr]=this.value;var l=o.type.create(s,null,o.marks);return Te.fromReplace(i,this.pos,this.pos+1,new M.Slice(M.Fragment.from(l),0,o.isLeaf?0:1))}},{key:"getMap",value:function(){return ur.empty}},{key:"invert",value:function(i){return new t(this.pos,this.attr,i.nodeAt(this.pos).attrs[this.attr])}},{key:"map",value:function(i){var o=i.mapResult(this.pos,1);return o.deletedAfter?null:new t(o.pos,this.attr,this.value)}},{key:"toJSON",value:function(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}}],[{key:"fromJSON",value:function(i,o){if(typeof o.pos!="number"||typeof o.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new t(o.pos,o.attr,o.value)}}]),t})(ve);ve.jsonID("attr",wu);var Su=(function(e){jt(t,e);var r=Ht(t);function t(n,i){var o;return Ee(this,t),o=r.call(this),o.attr=n,o.value=i,o}return Ce(t,[{key:"apply",value:function(i){var o=Object.create(null);for(var s in i.attrs)o[s]=i.attrs[s];o[this.attr]=this.value;var a=i.type.create(o,i.content,i.marks);return Te.ok(a)}},{key:"getMap",value:function(){return ur.empty}},{key:"invert",value:function(i){return new t(this.attr,i.attrs[this.attr])}},{key:"map",value:function(i){return this}},{key:"toJSON",value:function(){return{stepType:"docAttr",attr:this.attr,value:this.value}}}],[{key:"fromJSON",value:function(i,o){if(typeof o.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new t(o.attr,o.value)}}]),t})(ve);ve.jsonID("docAttr",Su);$.TransformError=(function(e){jt(t,e);var r=Ht(t);function t(){return Ee(this,t),r.apply(this,arguments)}return Ce(t)})(vu(Error));$.TransformError=function e(r){var t=Error.call(this,r);return t.__proto__=e.prototype,t};$.TransformError.prototype=Object.create(Error.prototype);$.TransformError.prototype.constructor=$.TransformError;$.TransformError.prototype.name="TransformError";var YT=(function(){function e(r){Ee(this,e),this.doc=r,this.steps=[],this.docs=[],this.mapping=new Yp}return Ce(e,[{key:"before",get:function(){return this.docs.length?this.docs[0]:this.doc}},{key:"step",value:function(t){var n=this.maybeStep(t);if(n.failed)throw new $.TransformError(n.failed);return this}},{key:"maybeStep",value:function(t){var n=t.apply(this.doc);return n.failed||this.addStep(t,n.doc),n}},{key:"docChanged",get:function(){return this.steps.length>0}},{key:"addStep",value:function(t,n){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=n}},{key:"replace",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:M.Slice.empty,o=nm(this.doc,t,n,i);return o&&this.step(o),this}},{key:"replaceWith",value:function(t,n,i){return this.replace(t,n,new M.Slice(M.Fragment.from(i),0,0))}},{key:"delete",value:function(t,n){return this.replace(t,n,M.Slice.empty)}},{key:"insert",value:function(t,n){return this.replaceWith(t,t,n)}},{key:"replaceRange",value:function(t,n,i){return ZT(this,t,n,i),this}},{key:"replaceRangeWith",value:function(t,n,i){return GT(this,t,n,i),this}},{key:"deleteRange",value:function(t,n){return XT(this,t,n),this}},{key:"lift",value:function(t,n){return NT(this,t,n),this}},{key:"join",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return WT(this,t,n),this}},{key:"wrap",value:function(t,n){return IT(this,t,n),this}},{key:"setBlockType",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return LT(this,t,n,i,o),this}},{key:"setNodeMarkup",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0;return BT(this,t,n,i,o),this}},{key:"setNodeAttribute",value:function(t,n,i){return this.step(new wu(t,n,i)),this}},{key:"setDocAttribute",value:function(t,n){return this.step(new Su(t,n)),this}},{key:"addNodeMark",value:function(t,n){return this.step(new ws(t,n)),this}},{key:"removeNodeMark",value:function(t,n){var i=this.doc.nodeAt(t);if(!i)throw new RangeError("No node at position "+t);if(n instanceof M.Mark)n.isInSet(i.marks)&&this.step(new Ri(t,n));else{for(var o=i.marks,s,a=[];s=n.isInSet(o);)a.push(new Ri(t,s)),o=s.removeFromSet(o);for(var l=a.length-1;l>=0;l--)this.step(a[l])}return this}},{key:"split",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;return qT(this,t,n,i),this}},{key:"addMark",value:function(t,n,i){return CT(this,t,n,i),this}},{key:"removeMark",value:function(t,n,i){return OT(this,t,n,i),this}},{key:"clearIncompatible",value:function(t,n,i){return ku(this,t,n,i),this}}]),e})();$.AddMarkStep=ks;$.AddNodeMarkStep=ws;$.AttrStep=wu;$.DocAttrStep=Su;$.MapResult=bs;$.Mapping=Yp;$.RemoveMarkStep=Sn;$.RemoveNodeMarkStep=Ri;$.ReplaceAroundStep=jr;$.ReplaceStep=qt;$.Step=ve;$.StepMap=ur;$.StepResult=Te;$.Transform=YT;$.canJoin=jT;$.canSplit=zT;$.dropPoint=VT;$.findWrapping=PT;$.insertPoint=rm;$.joinPoint=$T;$.liftTarget=AT;$.replaceStep=nm});var at=S(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});function QT(e){Object.keys(e).filter(r=>r!=="default"&&r!=="__esModule").forEach(r=>{Ss.hasOwnProperty(r)||Object.defineProperty(Ss,r,{enumerable:!0,configurable:!0,get:()=>e[r]})})}var eE=cr();QT(eE)});var $t=S(bt=>{"use strict";function _n(){return typeof Reflect<"u"&&Reflect.get?_n=Reflect.get.bind():_n=function(r,t,n){var i=tE(r,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?r:n):o.value}},_n.apply(this,arguments)}function tE(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=fr(e),e!==null););return e}function _s(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&Eu(e,r)}function Eu(e,r){return Eu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Eu(e,r)}function Ts(e){var r=iE();return function(){var n=fr(e),i;if(r){var o=fr(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return rE(this,i)}}function rE(e,r){if(r&&(Hr(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nE(e)}function nE(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fr(e){return fr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fr(e)}function Hr(e){"@babel/helpers - typeof";return Hr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Hr(e)}function Ve(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function lm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oE(n.key),n)}}function Ue(e,r,t){return r&&lm(e.prototype,r),t&&lm(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function oE(e){var r=sE(e,"string");return Hr(r)==="symbol"?r:String(r)}function sE(e,r){if(Hr(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(Hr(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var lt=lr(),Cu=cr(),xu=Object.create(null),ie=(function(){function e(r,t,n){Ve(this,e),this.$anchor=r,this.$head=t,this.ranges=n||[new mm(r.min(t),r.max(t))]}return Ue(e,[{key:"anchor",get:function(){return this.$anchor.pos}},{key:"head",get:function(){return this.$head.pos}},{key:"from",get:function(){return this.$from.pos}},{key:"to",get:function(){return this.$to.pos}},{key:"$from",get:function(){return this.ranges[0].$from}},{key:"$to",get:function(){return this.ranges[0].$to}},{key:"empty",get:function(){for(var t=this.ranges,n=0;n<t.length;n++)if(t[n].$from.pos!=t[n].$to.pos)return!1;return!0}},{key:"content",value:function(){return this.$from.doc.slice(this.from,this.to,!0)}},{key:"replace",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lt.Slice.empty,i=n.content.lastChild,o=null,s=0;s<n.openEnd;s++)o=i,i=i.lastChild;for(var a=t.steps.length,l=this.ranges,u=0;u<l.length;u++){var c=l[u],f=c.$from,d=c.$to,h=t.mapping.slice(a);t.replaceRange(h.map(f.pos),h.map(d.pos),u?lt.Slice.empty:n),u==0&&fm(t,a,(i?i.isInline:o&&o.isTextblock)?-1:1)}}},{key:"replaceWith",value:function(t,n){for(var i=t.steps.length,o=this.ranges,s=0;s<o.length;s++){var a=o[s],l=a.$from,u=a.$to,c=t.mapping.slice(i),f=c.map(l.pos),d=c.map(u.pos);s?t.deleteRange(f,d):(t.replaceRangeWith(f,d,n),fm(t,i,n.isInline?-1:1))}}},{key:"getBookmark",value:function(){return En.between(this.$anchor,this.$head).getBookmark()}}],[{key:"findFrom",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=t.parent.inlineContent?new En(t):xn(t.node(0),t.parent,t.pos,t.index(),n,i);if(o)return o;for(var s=t.depth-1;s>=0;s--){var a=n<0?xn(t.node(0),t.node(s),t.before(s+1),t.index(s),n,i):xn(t.node(0),t.node(s),t.after(s+1),t.index(s)+1,n,i);if(a)return a}return null}},{key:"near",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this.findFrom(t,n)||this.findFrom(t,-n)||new Tn(t.node(0))}},{key:"atStart",value:function(t){return xn(t,t,0,0,1)||new Tn(t)}},{key:"atEnd",value:function(t){return xn(t,t,t.content.size,t.childCount,-1)||new Tn(t)}},{key:"fromJSON",value:function(t,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");var i=xu[n.type];if(!i)throw new RangeError("No selection type ".concat(n.type," defined"));return i.fromJSON(t,n)}},{key:"jsonID",value:function(t,n){if(t in xu)throw new RangeError("Duplicate use of selection JSON ID "+t);return xu[t]=n,n.prototype.jsonID=t,n}}]),e})();ie.prototype.visible=!0;var mm=Ue(function e(r,t){Ve(this,e),this.$from=r,this.$to=t}),um=!1;function cm(e){!um&&!e.parent.inlineContent&&(um=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}var En=(function(e){_s(t,e);var r=Ts(t);function t(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n;return Ve(this,t),cm(n),cm(i),r.call(this,n,i)}return Ue(t,[{key:"$cursor",get:function(){return this.$anchor.pos==this.$head.pos?this.$head:null}},{key:"map",value:function(i,o){var s=i.resolve(o.map(this.head));if(!s.parent.inlineContent)return ie.near(s);var a=i.resolve(o.map(this.anchor));return new t(a.parent.inlineContent?a:s,s)}},{key:"replace",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lt.Slice.empty;if(_n(fr(t.prototype),"replace",this).call(this,i,o),o==lt.Slice.empty){var s=this.$from.marksAcross(this.$to);s&&i.ensureMarks(s)}}},{key:"eq",value:function(i){return i instanceof t&&i.anchor==this.anchor&&i.head==this.head}},{key:"getBookmark",value:function(){return new gm(this.anchor,this.head)}},{key:"toJSON",value:function(){return{type:"text",anchor:this.anchor,head:this.head}}}],[{key:"fromJSON",value:function(i,o){if(typeof o.anchor!="number"||typeof o.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(i.resolve(o.anchor),i.resolve(o.head))}},{key:"create",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,a=i.resolve(o);return new this(a,s==o?a:i.resolve(s))}},{key:"between",value:function(i,o,s){var a=i.pos-o.pos;if((!s||a)&&(s=a>=0?1:-1),!o.parent.inlineContent){var l=ie.findFrom(o,s,!0)||ie.findFrom(o,-s,!0);if(l)o=l.$head;else return ie.near(o,s)}return i.parent.inlineContent||(a==0?i=o:(i=(ie.findFrom(i,-s,!0)||ie.findFrom(i,s,!0)).$anchor,i.pos<o.pos!=a<0&&(i=o))),new t(i,o)}}]),t})(ie);ie.jsonID("text",En);var gm=(function(){function e(r,t){Ve(this,e),this.anchor=r,this.head=t}return Ue(e,[{key:"map",value:function(t){return new e(t.map(this.anchor),t.map(this.head))}},{key:"resolve",value:function(t){return En.between(t.resolve(this.anchor),t.resolve(this.head))}}]),e})(),$r=(function(e){_s(t,e);var r=Ts(t);function t(n){var i;Ve(this,t);var o=n.nodeAfter,s=n.node(0).resolve(n.pos+o.nodeSize);return i=r.call(this,n,s),i.node=o,i}return Ue(t,[{key:"map",value:function(i,o){var s=o.mapResult(this.anchor),a=s.deleted,l=s.pos,u=i.resolve(l);return a?ie.near(u):new t(u)}},{key:"content",value:function(){return new lt.Slice(lt.Fragment.from(this.node),0,0)}},{key:"eq",value:function(i){return i instanceof t&&i.anchor==this.anchor}},{key:"toJSON",value:function(){return{type:"node",anchor:this.anchor}}},{key:"getBookmark",value:function(){return new aE(this.anchor)}}],[{key:"fromJSON",value:function(i,o){if(typeof o.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(i.resolve(o.anchor))}},{key:"create",value:function(i,o){return new t(i.resolve(o))}},{key:"isSelectable",value:function(i){return!i.isText&&i.type.spec.selectable!==!1}}]),t})(ie);$r.prototype.visible=!1;ie.jsonID("node",$r);var aE=(function(){function e(r){Ve(this,e),this.anchor=r}return Ue(e,[{key:"map",value:function(t){var n=t.mapResult(this.anchor),i=n.deleted,o=n.pos;return i?new gm(o,o):new e(o)}},{key:"resolve",value:function(t){var n=t.resolve(this.anchor),i=n.nodeAfter;return i&&$r.isSelectable(i)?new $r(n):ie.near(n)}}]),e})(),Tn=(function(e){_s(t,e);var r=Ts(t);function t(n){return Ve(this,t),r.call(this,n.resolve(0),n.resolve(n.content.size))}return Ue(t,[{key:"replace",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lt.Slice.empty;if(o==lt.Slice.empty){i.delete(0,i.doc.content.size);var s=ie.atStart(i.doc);s.eq(i.selection)||i.setSelection(s)}else _n(fr(t.prototype),"replace",this).call(this,i,o)}},{key:"toJSON",value:function(){return{type:"all"}}},{key:"map",value:function(i){return new t(i)}},{key:"eq",value:function(i){return i instanceof t}},{key:"getBookmark",value:function(){return lE}}],[{key:"fromJSON",value:function(i){return new t(i)}}]),t})(ie);ie.jsonID("all",Tn);var lE={map:function(){return this},resolve:function(r){return new Tn(r)}};function xn(e,r,t,n,i){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(r.inlineContent)return En.create(e,t);for(var s=n-(i>0?0:1);i>0?s<r.childCount:s>=0;s+=i){var a=r.child(s);if(a.isAtom){if(!o&&$r.isSelectable(a))return $r.create(e,t-(i<0?a.nodeSize:0))}else{var l=xn(e,a,t+i,i<0?a.childCount:0,i,o);if(l)return l}t+=a.nodeSize*i}return null}function fm(e,r,t){var n=e.steps.length-1;if(!(n<r)){var i=e.steps[n];if(i instanceof Cu.ReplaceStep||i instanceof Cu.ReplaceAroundStep){var o=e.mapping.maps[n],s;o.forEach(function(a,l,u,c){s==null&&(s=c)}),e.setSelection(ie.near(e.doc.resolve(s),t))}}}var dm=1,xs=2,hm=4,vm=(function(e){_s(t,e);var r=Ts(t);function t(n){var i;return Ve(this,t),i=r.call(this,n.doc),i.curSelectionFor=0,i.updated=0,i.meta=Object.create(null),i.time=Date.now(),i.curSelection=n.selection,i.storedMarks=n.storedMarks,i}return Ue(t,[{key:"selection",get:function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}},{key:"setSelection",value:function(i){if(i.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=i,this.curSelectionFor=this.steps.length,this.updated=(this.updated|dm)&~xs,this.storedMarks=null,this}},{key:"selectionSet",get:function(){return(this.updated&dm)>0}},{key:"setStoredMarks",value:function(i){return this.storedMarks=i,this.updated|=xs,this}},{key:"ensureMarks",value:function(i){return lt.Mark.sameSet(this.storedMarks||this.selection.$from.marks(),i)||this.setStoredMarks(i),this}},{key:"addStoredMark",value:function(i){return this.ensureMarks(i.addToSet(this.storedMarks||this.selection.$head.marks()))}},{key:"removeStoredMark",value:function(i){return this.ensureMarks(i.removeFromSet(this.storedMarks||this.selection.$head.marks()))}},{key:"storedMarksSet",get:function(){return(this.updated&xs)>0}},{key:"addStep",value:function(i,o){_n(fr(t.prototype),"addStep",this).call(this,i,o),this.updated=this.updated&~xs,this.storedMarks=null}},{key:"setTime",value:function(i){return this.time=i,this}},{key:"replaceSelection",value:function(i){return this.selection.replace(this,i),this}},{key:"replaceSelectionWith",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=this.selection;return o&&(i=i.mark(this.storedMarks||(s.empty?s.$from.marks():s.$from.marksAcross(s.$to)||lt.Mark.none))),s.replaceWith(this,i),this}},{key:"deleteSelection",value:function(){return this.selection.replace(this),this}},{key:"insertText",value:function(i,o,s){var a=this.doc.type.schema;if(o==null)return i?this.replaceSelectionWith(a.text(i),!0):this.deleteSelection();if(s==null&&(s=o),!i)return this.deleteRange(o,s);var l=this.storedMarks;if(!l){var u=this.doc.resolve(o);l=s==o?u.marks():u.marksAcross(this.doc.resolve(s))}return this.replaceRangeWith(o,s,a.text(i,l)),!this.selection.empty&&this.selection.to==o+i.length&&this.setSelection(ie.near(this.selection.$to)),this}},{key:"setMeta",value:function(i,o){return this.meta[typeof i=="string"?i:i.key]=o,this}},{key:"getMeta",value:function(i){return this.meta[typeof i=="string"?i:i.key]}},{key:"isGeneric",get:function(){for(var i in this.meta)return!1;return!0}},{key:"scrollIntoView",value:function(){return this.updated|=hm,this}},{key:"scrolledIntoView",get:function(){return(this.updated&hm)>0}}]),t})(Cu.Transform);function pm(e,r){return!r||!e?e:e.bind(r)}var Di=Ue(function e(r,t,n){Ve(this,e),this.name=r,this.init=pm(t.init,n),this.apply=pm(t.apply,n)}),uE=[new Di("doc",{init:function(r){return r.doc||r.schema.topNodeType.createAndFill()},apply:function(r){return r.doc}}),new Di("selection",{init:function(r,t){return r.selection||ie.atStart(t.doc)},apply:function(r){return r.selection}}),new Di("storedMarks",{init:function(r){return r.storedMarks||null},apply:function(r,t,n,i){return i.selection.$cursor?r.storedMarks:null}}),new Di("scrollToSelection",{init:function(){return 0},apply:function(r,t){return r.scrolledIntoView?t+1:t}})],_u=Ue(function e(r,t){var n=this;Ve(this,e),this.schema=r,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=uE.slice(),t&&t.forEach(function(i){if(n.pluginsByKey[i.key])throw new RangeError("Adding different instances of a keyed plugin ("+i.key+")");n.plugins.push(i),n.pluginsByKey[i.key]=i,i.spec.state&&n.fields.push(new Di(i.key,i.spec.state,i))})}),cE=(function(){function e(r){Ve(this,e),this.config=r}return Ue(e,[{key:"schema",get:function(){return this.config.schema}},{key:"plugins",get:function(){return this.config.plugins}},{key:"apply",value:function(t){return this.applyTransaction(t).state}},{key:"filterTransaction",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,i=0;i<this.config.plugins.length;i++)if(i!=n){var o=this.config.plugins[i];if(o.spec.filterTransaction&&!o.spec.filterTransaction.call(o,t,this))return!1}return!0}},{key:"applyTransaction",value:function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var n=[t],i=this.applyInner(t),o=null;;){for(var s=!1,a=0;a<this.config.plugins.length;a++){var l=this.config.plugins[a];if(l.spec.appendTransaction){var u=o?o[a].n:0,c=o?o[a].state:this,f=u<n.length&&l.spec.appendTransaction.call(l,u?n.slice(u):n,c,i);if(f&&i.filterTransaction(f,a)){if(f.setMeta("appendedTransaction",t),!o){o=[];for(var d=0;d<this.config.plugins.length;d++)o.push(d<a?{state:i,n:n.length}:{state:this,n:0})}n.push(f),i=i.applyInner(f),s=!0}o&&(o[a]={state:i,n:n.length})}}if(!s)return{state:i,transactions:n}}}},{key:"applyInner",value:function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var n=new e(this.config),i=this.config.fields,o=0;o<i.length;o++){var s=i[o];n[s.name]=s.apply(t,this[s.name],this,n)}return n}},{key:"tr",get:function(){return new vm(this)}},{key:"reconfigure",value:function(t){for(var n=new _u(this.schema,t.plugins),i=n.fields,o=new e(n),s=0;s<i.length;s++){var a=i[s].name;o[a]=this.hasOwnProperty(a)?this[a]:i[s].init(t,o)}return o}},{key:"toJSON",value:function(t){var n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(function(a){return a.toJSON()})),t&&Hr(t)=="object")for(var i in t){if(i=="doc"||i=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");var o=t[i],s=o.spec.state;s&&s.toJSON&&(n[i]=s.toJSON.call(o,this[o.key]))}return n}}],[{key:"create",value:function(t){for(var n=new _u(t.doc?t.doc.type.schema:t.schema,t.plugins),i=new e(n),o=0;o<n.fields.length;o++)i[n.fields[o].name]=n.fields[o].init(t,i);return i}},{key:"fromJSON",value:function(t,n,i){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var o=new _u(t.schema,t.plugins),s=new e(o);return o.fields.forEach(function(a){if(a.name=="doc")s.doc=lt.Node.fromJSON(t.schema,n.doc);else if(a.name=="selection")s.selection=ie.fromJSON(s.doc,n.selection);else if(a.name=="storedMarks")n.storedMarks&&(s.storedMarks=n.storedMarks.map(t.schema.markFromJSON));else{if(i)for(var l in i){var u=i[l],c=u.spec.state;if(u.key==a.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(n,l)){s[a.name]=c.fromJSON.call(u,t,n[l],s);return}}s[a.name]=a.init(t,s)}}),s}}]),e})();function ym(e,r,t){for(var n in e){var i=e[n];i instanceof Function?i=i.bind(r):n=="handleDOMEvents"&&(i=ym(i,r,{})),t[n]=i}return t}var fE=(function(){function e(r){Ve(this,e),this.spec=r,this.props={},r.props&&ym(r.props,this,this.props),this.key=r.key?r.key.key:bm("plugin")}return Ue(e,[{key:"getState",value:function(t){return t[this.key]}}]),e})(),Tu=Object.create(null);function bm(e){return e in Tu?e+"$"+ ++Tu[e]:(Tu[e]=0,e+"$")}var dE=(function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"key";Ve(this,e),this.key=bm(r)}return Ue(e,[{key:"get",value:function(t){return t.config.pluginsByKey[this.key]}},{key:"getState",value:function(t){return t[this.key]}}]),e})();bt.AllSelection=Tn;bt.EditorState=cE;bt.NodeSelection=$r;bt.Plugin=fE;bt.PluginKey=dE;bt.Selection=ie;bt.SelectionRange=mm;bt.TextSelection=En;bt.Transaction=vm});var Bm=S(W=>{"use strict";var re=cr(),kt=lr(),K=$t(),Au=function(r,t){return r.selection.empty?!1:(t&&t(r.tr.deleteSelection().scrollIntoView()),!0)};function wm(e,r){var t=e.selection.$cursor;return!t||(r?!r.endOfTextblock("backward",e):t.parentOffset>0)?null:t}var Sm=function(r,t,n){var i=wm(r,n);if(!i)return!1;var o=Nu(i);if(!o){var s=i.blockRange(),a=s&&re.liftTarget(s);return a==null?!1:(t&&t(r.tr.lift(s,a).scrollIntoView()),!0)}var l=o.nodeBefore;if(Dm(r,o,t,-1))return!0;if(i.parent.content.size==0&&(Cn(l,"end")||K.NodeSelection.isSelectable(l)))for(var u=i.depth;;u--){var c=re.replaceStep(r.doc,i.before(u),i.after(u),kt.Slice.empty);if(c&&c.slice.size<c.to-c.from){if(t){var f=r.tr.step(c);f.setSelection(Cn(l,"end")?K.Selection.findFrom(f.doc.resolve(f.mapping.map(o.pos,-1)),-1):K.NodeSelection.create(f.doc,o.pos-l.nodeSize)),t(f.scrollIntoView())}return!0}if(u==1||i.node(u-1).childCount>1)break}return l.isAtom&&o.depth==i.depth-1?(t&&t(r.tr.delete(o.pos-l.nodeSize,o.pos).scrollIntoView()),!0):!1},hE=function(r,t,n){var i=wm(r,n);if(!i)return!1;var o=Nu(i);return o?xm(r,o,t):!1},pE=function(r,t,n){var i=Tm(r,n);if(!i)return!1;var o=Pu(i);return o?xm(r,o,t):!1};function xm(e,r,t){for(var n=r.nodeBefore,i=n,o=r.pos-1;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;var s=i.lastChild;if(!s)return!1;i=s}for(var a=r.nodeAfter,l=a,u=r.pos+1;!l.isTextblock;u++){if(l.type.spec.isolating)return!1;var c=l.firstChild;if(!c)return!1;l=c}var f=re.replaceStep(e.doc,o,u,kt.Slice.empty);if(!f||f.from!=o||f instanceof re.ReplaceStep&&f.slice.size>=u-o)return!1;if(t){var d=e.tr.step(f);d.setSelection(K.TextSelection.create(d.doc,o)),t(d.scrollIntoView())}return!0}function Cn(e,r){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=e;n;n=r=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(t&&n.childCount!=1)return!1}return!1}var _m=function(r,t,n){var i=r.selection,o=i.$head,s=i.empty,a=o;if(!s)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("backward",r):o.parentOffset>0)return!1;a=Nu(o)}var l=a&&a.nodeBefore;return!l||!K.NodeSelection.isSelectable(l)?!1:(t&&t(r.tr.setSelection(K.NodeSelection.create(r.doc,a.pos-l.nodeSize)).scrollIntoView()),!0)};function Nu(e){if(!e.parent.type.spec.isolating)for(var r=e.depth-1;r>=0;r--){if(e.index(r)>0)return e.doc.resolve(e.before(r+1));if(e.node(r).type.spec.isolating)break}return null}function Tm(e,r){var t=e.selection.$cursor;return!t||(r?!r.endOfTextblock("forward",e):t.parentOffset<t.parent.content.size)?null:t}var Em=function(r,t,n){var i=Tm(r,n);if(!i)return!1;var o=Pu(i);if(!o)return!1;var s=o.nodeAfter;if(Dm(r,o,t,1))return!0;if(i.parent.content.size==0&&(Cn(s,"start")||K.NodeSelection.isSelectable(s))){var a=re.replaceStep(r.doc,i.before(),i.after(),kt.Slice.empty);if(a&&a.slice.size<a.to-a.from){if(t){var l=r.tr.step(a);l.setSelection(Cn(s,"start")?K.Selection.findFrom(l.doc.resolve(l.mapping.map(o.pos)),1):K.NodeSelection.create(l.doc,l.mapping.map(o.pos))),t(l.scrollIntoView())}return!0}}return s.isAtom&&o.depth==i.depth-1?(t&&t(r.tr.delete(o.pos,o.pos+s.nodeSize).scrollIntoView()),!0):!1},Cm=function(r,t,n){var i=r.selection,o=i.$head,s=i.empty,a=o;if(!s)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("forward",r):o.parentOffset<o.parent.content.size)return!1;a=Pu(o)}var l=a&&a.nodeAfter;return!l||!K.NodeSelection.isSelectable(l)?!1:(t&&t(r.tr.setSelection(K.NodeSelection.create(r.doc,a.pos)).scrollIntoView()),!0)};function Pu(e){if(!e.parent.type.spec.isolating)for(var r=e.depth-1;r>=0;r--){var t=e.node(r);if(e.index(r)+1<t.childCount)return e.doc.resolve(e.after(r+1));if(t.type.spec.isolating)break}return null}var mE=function(r,t){var n=r.selection,i=n instanceof K.NodeSelection,o;if(i){if(n.node.isTextblock||!re.canJoin(r.doc,n.from))return!1;o=n.from}else if(o=re.joinPoint(r.doc,n.from,-1),o==null)return!1;if(t){var s=r.tr.join(o);i&&s.setSelection(K.NodeSelection.create(s.doc,o-r.doc.resolve(o).nodeBefore.nodeSize)),t(s.scrollIntoView())}return!0},gE=function(r,t){var n=r.selection,i;if(n instanceof K.NodeSelection){if(n.node.isTextblock||!re.canJoin(r.doc,n.to))return!1;i=n.to}else if(i=re.joinPoint(r.doc,n.to,1),i==null)return!1;return t&&t(r.tr.join(i).scrollIntoView()),!0},vE=function(r,t){var n=r.selection,i=n.$from,o=n.$to,s=i.blockRange(o),a=s&&re.liftTarget(s);return a==null?!1:(t&&t(r.tr.lift(s,a).scrollIntoView()),!0)},Om=function(r,t){var n=r.selection,i=n.$head,o=n.$anchor;return!i.parent.type.spec.code||!i.sameParent(o)?!1:(t&&t(r.tr.insertText(`
`).scrollIntoView()),!0)};function Ru(e){for(var r=0;r<e.edgeCount;r++){var t=e.edge(r),n=t.type;if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}var Mm=function(r,t){var n=r.selection,i=n.$head,o=n.$anchor;if(!i.parent.type.spec.code||!i.sameParent(o))return!1;var s=i.node(-1),a=i.indexAfter(-1),l=Ru(s.contentMatchAt(a));if(!l||!s.canReplaceWith(a,a,l))return!1;if(t){var u=i.after(),c=r.tr.replaceWith(u,u,l.createAndFill());c.setSelection(K.Selection.near(c.doc.resolve(u),1)),t(c.scrollIntoView())}return!0},Am=function(r,t){var n=r.selection,i=n.$from,o=n.$to;if(n instanceof K.AllSelection||i.parent.inlineContent||o.parent.inlineContent)return!1;var s=Ru(o.parent.contentMatchAt(o.indexAfter()));if(!s||!s.isTextblock)return!1;if(t){var a=(!i.parentOffset&&o.index()<o.parent.childCount?i:o).pos,l=r.tr.insert(a,s.createAndFill());l.setSelection(K.TextSelection.create(l.doc,a+1)),t(l.scrollIntoView())}return!0},Nm=function(r,t){var n=r.selection.$cursor;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){var i=n.before();if(re.canSplit(r.doc,i))return t&&t(r.tr.split(i).scrollIntoView()),!0}var o=n.blockRange(),s=o&&re.liftTarget(o);return s==null?!1:(t&&t(r.tr.lift(o,s).scrollIntoView()),!0)};function Pm(e){return function(r,t){var n=r.selection,i=n.$from,o=n.$to;if(r.selection instanceof K.NodeSelection&&r.selection.node.isBlock)return!i.parentOffset||!re.canSplit(r.doc,i.pos)?!1:(t&&t(r.tr.split(i.pos).scrollIntoView()),!0);if(!i.depth)return!1;for(var s=[],a,l,u=!1,c=!1,f=i.depth;;f--){var d=i.node(f);if(d.isBlock){u=i.end(f)==i.pos+(i.depth-f),c=i.start(f)==i.pos-(i.depth-f),l=Ru(i.node(f-1).contentMatchAt(i.indexAfter(f-1)));var h=e&&e(o.parent,u,i);s.unshift(h||(u&&l?{type:l}:null)),a=f;break}else{if(f==1)return!1;s.unshift(null)}}var p=r.tr;(r.selection instanceof K.TextSelection||r.selection instanceof K.AllSelection)&&p.deleteSelection();var m=p.mapping.map(i.pos),v=re.canSplit(p.doc,m,s.length,s);if(v||(s[0]=l?{type:l}:null,v=re.canSplit(p.doc,m,s.length,s)),!v)return!1;if(p.split(m,s.length,s),!u&&c&&i.node(a).type!=l){var g=p.mapping.map(i.before(a)),y=p.doc.resolve(g);l&&i.node(a-1).canReplaceWith(y.index(),y.index()+1,l)&&p.setNodeMarkup(p.mapping.map(i.before(a)),l)}return t&&t(p.scrollIntoView()),!0}}var Du=Pm(),yE=function(r,t){return Du(r,t&&function(n){var i=r.storedMarks||r.selection.$to.parentOffset&&r.selection.$from.marks();i&&n.ensureMarks(i),t(n)})},bE=function(r,t){var n=r.selection,i=n.$from,o=n.to,s,a=i.sharedDepth(o);return a==0?!1:(s=i.before(a),t&&t(r.tr.setSelection(K.NodeSelection.create(r.doc,s))),!0)},Rm=function(r,t){return t&&t(r.tr.setSelection(new K.AllSelection(r.doc))),!0};function kE(e,r,t){var n=r.nodeBefore,i=r.nodeAfter,o=r.index();return!n||!i||!n.type.compatibleContent(i.type)?!1:!n.content.size&&r.parent.canReplace(o-1,o)?(t&&t(e.tr.delete(r.pos-n.nodeSize,r.pos).scrollIntoView()),!0):!r.parent.canReplace(o,o+1)||!(i.isTextblock||re.canJoin(e.doc,r.pos))?!1:(t&&t(e.tr.join(r.pos).scrollIntoView()),!0)}function Dm(e,r,t,n){var i=r.nodeBefore,o=r.nodeAfter,s,a,l=i.type.spec.isolating||o.type.spec.isolating;if(!l&&kE(e,r,t))return!0;var u=!l&&r.parent.canReplace(r.index(),r.index()+1);if(u&&(s=(a=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&a.matchType(s[0]||o.type).validEnd){if(t){for(var c=r.pos+o.nodeSize,f=kt.Fragment.empty,d=s.length-1;d>=0;d--)f=kt.Fragment.from(s[d].create(null,f));f=kt.Fragment.from(i.copy(f));var h=e.tr.step(new re.ReplaceAroundStep(r.pos-1,c,r.pos,c,new kt.Slice(f,1,0),s.length,!0)),p=h.doc.resolve(c+2*s.length);p.nodeAfter&&p.nodeAfter.type==i.type&&re.canJoin(h.doc,p.pos)&&h.join(p.pos),t(h.scrollIntoView())}return!0}var m=o.type.spec.isolating||n>0&&l?null:K.Selection.findFrom(r,1),v=m&&m.$from.blockRange(m.$to),g=v&&re.liftTarget(v);if(g!=null&&g>=r.depth)return t&&t(e.tr.lift(v,g).scrollIntoView()),!0;if(u&&Cn(o,"start",!0)&&Cn(i,"end")){for(var y=i,w=[];w.push(y),!y.isTextblock;)y=y.lastChild;for(var b=o,k=1;!b.isTextblock;b=b.firstChild)k++;if(y.canReplace(y.childCount,y.childCount,b.content)){if(t){for(var x=kt.Fragment.empty,T=w.length-1;T>=0;T--)x=kt.Fragment.from(w[T].copy(x));var _=e.tr.step(new re.ReplaceAroundStep(r.pos-w.length,r.pos+o.nodeSize,r.pos+k,r.pos+o.nodeSize-k,new kt.Slice(x,w.length,0),0,!0));t(_.scrollIntoView())}return!0}}return!1}function Im(e){return function(r,t){for(var n=r.selection,i=e<0?n.$from:n.$to,o=i.depth;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(t&&t(r.tr.setSelection(K.TextSelection.create(r.doc,e<0?i.start(o):i.end(o)))),!0):!1}}var Lm=Im(-1),Fm=Im(1);function wE(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return function(t,n){var i=t.selection,o=i.$from,s=i.$to,a=o.blockRange(s),l=a&&re.findWrapping(a,e,r);return l?(n&&n(t.tr.wrap(a,l).scrollIntoView()),!0):!1}}function SE(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return function(t,n){for(var i=!1,o=0;o<t.selection.ranges.length&&!i;o++){var s=t.selection.ranges[o],a=s.$from.pos,l=s.$to.pos;t.doc.nodesBetween(a,l,function(p,m){if(i)return!1;if(!(!p.isTextblock||p.hasMarkup(e,r)))if(p.type==e)i=!0;else{var v=t.doc.resolve(m),g=v.index();i=v.parent.canReplaceWith(g,g+1,e)}})}if(!i)return!1;if(n){for(var u=t.tr,c=0;c<t.selection.ranges.length;c++){var f=t.selection.ranges[c],d=f.$from.pos,h=f.$to.pos;u.setBlockType(d,h,e,r)}n(u.scrollIntoView())}return!0}}function xE(e,r,t,n){for(var i=function(){var l=r[s],u=l.$from,c=l.$to,f=u.depth==0?e.inlineContent&&e.type.allowsMarkType(t):!1;if(e.nodesBetween(u.pos,c.pos,function(d,h){if(f||!n&&d.isAtom&&d.isInline&&h>=u.pos&&h+d.nodeSize<=c.pos)return!1;f=d.inlineContent&&d.type.allowsMarkType(t)}),f)return{v:!0}},o,s=0;s<r.length;s++)if(o=i(),o)return o.v;return!1}function _E(e){for(var r=[],t=function(){var o=e[n],s=o.$from,a=o.$to;s.doc.nodesBetween(s.pos,a.pos,function(l,u){if(l.isAtom&&l.content.size&&l.isInline&&u>=s.pos&&u+l.nodeSize<=a.pos)return u+1>s.pos&&r.push(new K.SelectionRange(s,s.doc.resolve(u+1))),s=s.doc.resolve(u+1+l.content.size),!1}),s.pos<a.pos&&r.push(new K.SelectionRange(s,a))},n=0;n<e.length;n++)t();return r}function TE(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2?arguments[2]:void 0,n=(t&&t.removeWhenPresent)!==!1,i=(t&&t.enterInlineAtoms)!==!1,o=!(t&&t.includeWhitespace);return function(s,a){var l=s.selection,u=l.empty,c=l.$cursor,f=l.ranges;if(u&&!c||!xE(s.doc,f,e,i))return!1;if(a)if(c)e.isInSet(s.storedMarks||c.marks())?a(s.tr.removeStoredMark(e)):a(s.tr.addStoredMark(e.create(r)));else{var d,h=s.tr;i||(f=_E(f)),n?d=!f.some(function(_){return s.doc.rangeHasMark(_.$from.pos,_.$to.pos,e)}):d=!f.every(function(_){var C=!1;return h.doc.nodesBetween(_.$from.pos,_.$to.pos,function(A,O,B){if(C)return!1;C=!e.isInSet(A.marks)&&!!B&&B.type.allowsMarkType(e)&&!(A.isText&&/^\s*$/.test(A.textBetween(Math.max(0,_.$from.pos-O),Math.min(A.nodeSize,_.$to.pos-O))))}),!C});for(var p=0;p<f.length;p++){var m=f[p],v=m.$from,g=m.$to;if(!d)h.removeMark(v.pos,g.pos,e);else{var y=v.pos,w=g.pos,b=v.nodeAfter,k=g.nodeBefore,x=o&&b&&b.isText?/^\s*/.exec(b.text)[0].length:0,T=o&&k&&k.isText?/\s*$/.exec(k.text)[0].length:0;y+x<w&&(y+=x,w-=T),h.addMark(y,w,e.create(r))}}a(h.scrollIntoView())}return!0}}function EE(e,r){return function(t){if(!t.isGeneric)return e(t);for(var n=[],i=0;i<t.mapping.maps.length;i++){for(var o=t.mapping.maps[i],s=0;s<n.length;s++)n[s]=o.map(n[s]);o.forEach(function(w,b,k,x){return n.push(k,x)})}for(var a=[],l=0;l<n.length;l+=2)for(var u=n[l],c=n[l+1],f=t.doc.resolve(u),d=f.sharedDepth(c),h=f.node(d),p=f.indexAfter(d),m=f.after(d+1);m<=c;++p){var v=h.maybeChild(p);if(!v)break;if(p&&a.indexOf(m)==-1){var g=h.child(p-1);g.type==v.type&&r(g,v)&&a.push(m)}m+=v.nodeSize}a.sort(function(w,b){return w-b});for(var y=a.length-1;y>=0;y--)re.canJoin(t.doc,a[y])&&t.join(a[y]);e(t)}}function CE(e,r){var t=Array.isArray(r)?function(n){return r.indexOf(n.type.name)>-1}:r;return function(n,i,o){return e(n,i&&EE(i,t),o)}}function Es(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(n,i,o){for(var s=0;s<r.length;s++)if(r[s](n,i,o))return!0;return!1}}var Ou=Es(Au,Sm,_m),km=Es(Au,Em,Cm),wt={Enter:Es(Om,Am,Nm,Du),"Mod-Enter":Mm,Backspace:Ou,"Mod-Backspace":Ou,"Shift-Backspace":Ou,Delete:km,"Mod-Delete":km,"Mod-a":Rm},Iu={"Ctrl-h":wt.Backspace,"Alt-Backspace":wt["Mod-Backspace"],"Ctrl-d":wt.Delete,"Ctrl-Alt-Backspace":wt["Mod-Delete"],"Alt-Delete":wt["Mod-Delete"],"Alt-d":wt["Mod-Delete"],"Ctrl-a":Lm,"Ctrl-e":Fm};for(Mu in wt)Iu[Mu]=wt[Mu];var Mu,OE=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,ME=OE?Iu:wt;W.autoJoin=CE;W.baseKeymap=ME;W.chainCommands=Es;W.createParagraphNear=Am;W.deleteSelection=Au;W.exitCode=Mm;W.joinBackward=Sm;W.joinDown=gE;W.joinForward=Em;W.joinTextblockBackward=hE;W.joinTextblockForward=pE;W.joinUp=mE;W.lift=vE;W.liftEmptyBlock=Nm;W.macBaseKeymap=Iu;W.newlineInCode=Om;W.pcBaseKeymap=wt;W.selectAll=Rm;W.selectNodeBackward=_m;W.selectNodeForward=Cm;W.selectParentNode=bE;W.selectTextblockEnd=Fm;W.selectTextblockStart=Lm;W.setBlockType=SE;W.splitBlock=Du;W.splitBlockAs=Pm;W.splitBlockKeepMarks=yE;W.toggleMark=TE;W.wrapIn=wE});var ye=S(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});function AE(e){Object.keys(e).filter(r=>r!=="default"&&r!=="__esModule").forEach(r=>{Cs.hasOwnProperty(r)||Object.defineProperty(Cs,r,{enumerable:!0,configurable:!0,get:()=>e[r]})})}var NE=Bm();AE(NE)});var I=S(Os=>{"use strict";Object.defineProperty(Os,"__esModule",{value:!0});function PE(e){Object.keys(e).filter(r=>r!=="default"&&r!=="__esModule").forEach(r=>{Os.hasOwnProperty(r)||Object.defineProperty(Os,r,{enumerable:!0,configurable:!0,get:()=>e[r]})})}var RE=$t();PE(RE)});var ut=S(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});function DE(e){Object.keys(e).filter(r=>r!=="default"&&r!=="__esModule").forEach(r=>{Ms.hasOwnProperty(r)||Object.defineProperty(Ms,r,{enumerable:!0,configurable:!0,get:()=>e[r]})})}var IE=lr();DE(IE)});var Wm=S(ct=>{"use strict";var Wt=cr(),G=lr(),LE=$t(),FE=["ol",0],BE=["ul",0],zE=["li",0],zm={attrs:{order:{default:1,validate:"number"}},parseDOM:[{tag:"ol",getAttrs:function(r){return{order:r.hasAttribute("start")?+r.getAttribute("start"):1}}}],toDOM:function(r){return r.attrs.order==1?FE:["ol",{start:r.attrs.order},0]}},qm={parseDOM:[{tag:"ul"}],toDOM:function(){return BE}},jm={parseDOM:[{tag:"li"}],toDOM:function(){return zE},defining:!0};function Lu(e,r){var t={};for(var n in e)t[n]=e[n];for(var i in r)t[i]=r[i];return t}function qE(e,r,t){return e.append({ordered_list:Lu(zm,{content:"list_item+",group:t}),bullet_list:Lu(qm,{content:"list_item+",group:t}),list_item:Lu(jm,{content:r})})}function jE(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return function(t,n){var i=t.selection,o=i.$from,s=i.$to,a=o.blockRange(s);if(!a)return!1;var l=n?t.tr:null;return Hm(l,a,e,r)?(n&&n(l.scrollIntoView()),!0):!1}}function Hm(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=!1,o=r,s=r.$from.doc;if(r.depth>=2&&r.$from.node(r.depth-1).type.compatibleContent(t)&&r.startIndex==0){if(r.$from.index(r.depth-1)==0)return!1;var a=s.resolve(r.start-2);o=new G.NodeRange(a,a,r.depth),r.endIndex<r.parent.childCount&&(r=new G.NodeRange(r.$from,s.resolve(r.$to.end(r.depth)),r.depth)),i=!0}var l=Wt.findWrapping(o,t,n,r);return l?(e&&HE(e,r,l,i,t),!0):!1}function HE(e,r,t,n,i){for(var o=G.Fragment.empty,s=t.length-1;s>=0;s--)o=G.Fragment.from(t[s].type.create(t[s].attrs,o));e.step(new Wt.ReplaceAroundStep(r.start-(n?2:0),r.end,r.start,r.end,new G.Slice(o,0,0),t.length,!0));for(var a=0,l=0;l<t.length;l++)t[l].type==i&&(a=l+1);for(var u=t.length-a,c=r.start+t.length-(n?2:0),f=r.parent,d=r.startIndex,h=r.endIndex,p=!0;d<h;d++,p=!1)!p&&Wt.canSplit(e.doc,c,u)&&(e.split(c,u),c+=2*u),c+=f.child(d).nodeSize;return e}function $m(e,r){return function(t,n){var i=t.selection,o=i.$from,s=i.$to,a=i.node;if(a&&a.isBlock||o.depth<2||!o.sameParent(s))return!1;var l=o.node(-1);if(l.type!=e)return!1;if(o.parent.content.size==0&&o.node(-1).childCount==o.indexAfter(-1)){if(o.depth==3||o.node(-3).type!=e||o.index(-2)!=o.node(-2).childCount-1)return!1;if(n){for(var u=G.Fragment.empty,c=o.index(-1)?1:o.index(-2)?2:3,f=o.depth-c;f>=o.depth-3;f--)u=G.Fragment.from(o.node(f).copy(u));var d=o.indexAfter(-1)<o.node(-2).childCount?1:o.indexAfter(-2)<o.node(-3).childCount?2:3;u=u.append(G.Fragment.from(e.createAndFill()));var h=o.before(o.depth-(c-1)),p=t.tr.replace(h,o.after(-d),new G.Slice(u,4-c,0)),m=-1;p.doc.nodesBetween(h,p.doc.content.size,function(w,b){if(m>-1)return!1;w.isTextblock&&w.content.size==0&&(m=b+1)}),m>-1&&p.setSelection(LE.Selection.near(p.doc.resolve(m))),n(p.scrollIntoView())}return!0}var v=s.pos==o.end()?l.contentMatchAt(0).defaultType:null,g=t.tr.delete(o.pos,s.pos),y=v?[r?{type:e,attrs:r}:null,{type:v}]:void 0;return Wt.canSplit(g.doc,o.pos,2,y)?(n&&n(g.split(o.pos,2,y).scrollIntoView()),!0):!1}}function $E(e,r){var t=$m(e,r);return function(n,i){return t(n,i&&function(o){var s=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();s&&o.ensureMarks(s),i(o)})}}function WE(e){return function(r,t){var n=r.selection,i=n.$from,o=n.$to,s=i.blockRange(o,function(a){return a.childCount>0&&a.firstChild.type==e});return s?t?i.node(s.depth-1).type==e?VE(r,t,e,s):UE(r,t,s):!0:!1}}function VE(e,r,t,n){var i=e.tr,o=n.end,s=n.$to.end(n.depth);o<s&&(i.step(new Wt.ReplaceAroundStep(o-1,s,o,s,new G.Slice(G.Fragment.from(t.create(null,n.parent.copy())),1,0),1,!0)),n=new G.NodeRange(i.doc.resolve(n.$from.pos),i.doc.resolve(s),n.depth));var a=Wt.liftTarget(n);if(a==null)return!1;i.lift(n,a);var l=i.doc.resolve(i.mapping.map(o,-1)-1);return Wt.canJoin(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),r(i.scrollIntoView()),!0}function UE(e,r,t){for(var n=e.tr,i=t.parent,o=t.end,s=t.endIndex-1,a=t.startIndex;s>a;s--)o-=i.child(s).nodeSize,n.delete(o-1,o+1);var l=n.doc.resolve(t.start),u=l.nodeAfter;if(n.mapping.map(t.end)!=t.start+l.nodeAfter.nodeSize)return!1;var c=t.startIndex==0,f=t.endIndex==i.childCount,d=l.node(-1),h=l.index(-1);if(!d.canReplace(h+(c?0:1),h+1,u.content.append(f?G.Fragment.empty:G.Fragment.from(i))))return!1;var p=l.pos,m=p+u.nodeSize;return n.step(new Wt.ReplaceAroundStep(p-(c?1:0),m+(f?1:0),p+1,m-1,new G.Slice((c?G.Fragment.empty:G.Fragment.from(i.copy(G.Fragment.empty))).append(f?G.Fragment.empty:G.Fragment.from(i.copy(G.Fragment.empty))),c?0:1,f?0:1),c?0:1)),r(n.scrollIntoView()),!0}function KE(e){return function(r,t){var n=r.selection,i=n.$from,o=n.$to,s=i.blockRange(o,function(m){return m.childCount>0&&m.firstChild.type==e});if(!s)return!1;var a=s.startIndex;if(a==0)return!1;var l=s.parent,u=l.child(a-1);if(u.type!=e)return!1;if(t){var c=u.lastChild&&u.lastChild.type==l.type,f=G.Fragment.from(c?e.create():null),d=new G.Slice(G.Fragment.from(e.create(null,G.Fragment.from(l.type.create(null,f)))),c?3:1,0),h=s.start,p=s.end;t(r.tr.step(new Wt.ReplaceAroundStep(h-(c?3:1),p,h,p,d,1,!0)).scrollIntoView())}return!0}}ct.addListNodes=qE;ct.bulletList=qm;ct.liftListItem=WE;ct.listItem=jm;ct.orderedList=zm;ct.sinkListItem=KE;ct.splitListItem=$m;ct.splitListItemKeepMarks=$E;ct.wrapInList=jE;ct.wrapRangeInList=Hm});var Ns=S(As=>{"use strict";Object.defineProperty(As,"__esModule",{value:!0});function JE(e){Object.keys(e).filter(r=>r!=="default"&&r!=="__esModule").forEach(r=>{As.hasOwnProperty(r)||Object.defineProperty(As,r,{enumerable:!0,configurable:!0,get:()=>e[r]})})}var ZE=Wm();JE(ZE)});var cc=S(Ln=>{"use strict";function Cg(e,r){return YE(e)||XE(e,r)||Og(e,r)||GE()}function GE(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XE(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n,i,o,s,a=[],l=!0,u=!1;try{if(o=(t=t.call(e)).next,r===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=o.call(t)).done)&&(a.push(n.value),a.length!==r);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&t.return!=null&&(s=t.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}function YE(e){if(Array.isArray(e))return e}function $u(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Og(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(u){throw u},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,s=!1,a;return{s:function(){t=t.call(e)},n:function(){var u=t.next();return o=u.done,u},e:function(u){s=!0,a=u},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(s)throw a}}}}function Og(e,r){if(e){if(typeof e=="string")return Vm(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Vm(e,r)}}function Vm(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function De(){return typeof Reflect<"u"&&Reflect.get?De=Reflect.get.bind():De=function(r,t,n){var i=QE(r,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?r:n):o.value}},De.apply(this,arguments)}function QE(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=be(e),e!==null););return e}function Gr(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&Wu(e,r)}function Wu(e,r){return Wu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Wu(e,r)}function Xr(e){var r=tC();return function(){var n=be(e),i;if(r){var o=be(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return eC(this,i)}}function eC(e,r){if(r&&(Rn(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mg(e)}function Mg(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tC(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function be(e){return be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},be(e)}function Rn(e){"@babel/helpers - typeof";return Rn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Rn(e)}function oe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Um(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rC(n.key),n)}}function se(e,r,t){return r&&Um(e.prototype,r),t&&Um(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function rC(e){var r=nC(e,"string");return Rn(r)==="symbol"?r:String(r)}function nC(e,r){if(Rn(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(Rn(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var R=$t(),ee=lr(),iC=cr(),ke=function(r){for(var t=0;;t++)if(r=r.previousSibling,!r)return t},Dn=function(r){var t=r.assignedSlot||r.parentNode;return t&&t.nodeType==11?t.host:t},Vu=null,Ut=function(r,t,n){var i=Vu||(Vu=document.createRange());return i.setEnd(r,n??r.nodeValue.length),i.setStart(r,t||0),i},oC=function(){Vu=null},Zr=function(r,t,n,i){return n&&(Km(r,t,n,i,-1)||Km(r,t,n,i,1))},sC=/^(img|br|input|textarea|hr)$/i;function Km(e,r,t,n,i){for(var o;;){if(e==t&&r==n)return!0;if(r==(i<0?0:Xe(e))){var s=e.parentNode;if(!s||s.nodeType!=1||$i(e)||sC.test(e.nodeName)||e.contentEditable=="false")return!1;r=ke(e)+(i<0?0:1),e=s}else if(e.nodeType==1){var a=e.childNodes[r+(i<0?-1:0)];if(a.nodeType==1&&a.contentEditable=="false")if(!((o=a.pmViewDesc)===null||o===void 0)&&o.ignoreForSelection)r+=i;else return!1;else e=a,r=i<0?Xe(e):0}else return!1}}function Xe(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function aC(e,r){for(;;){if(e.nodeType==3&&r)return e;if(e.nodeType==1&&r>0){if(e.contentEditable=="false")return null;e=e.childNodes[r-1],r=Xe(e)}else if(e.parentNode&&!$i(e))r=ke(e),e=e.parentNode;else return null}}function lC(e,r){for(;;){if(e.nodeType==3&&r<e.nodeValue.length)return e;if(e.nodeType==1&&r<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[r],r=0}else if(e.parentNode&&!$i(e))r=ke(e)+1,e=e.parentNode;else return null}}function uC(e,r,t){for(var n=r==0,i=r==Xe(e);n||i;){if(e==t)return!0;var o=ke(e);if(e=e.parentNode,!e)return!1;n=n&&o==0,i=i&&o==Xe(e)}}function $i(e){for(var r,t=e;t&&!(r=t.pmViewDesc);t=t.parentNode);return r&&r.node&&r.node.isBlock&&(r.dom==e||r.contentDOM==e)}var Ls=function(r){return r.focusNode&&Zr(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)};function Wr(e,r){var t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=e,t.key=t.code=r,t}function cC(e){for(var r=e.activeElement;r&&r.shadowRoot;)r=r.shadowRoot.activeElement;return r}function fC(e,r,t){if(e.caretPositionFromPoint)try{var n=e.caretPositionFromPoint(r,t);if(n)return{node:n.offsetNode,offset:Math.min(Xe(n.offsetNode),n.offset)}}catch{}if(e.caretRangeFromPoint){var i=e.caretRangeFromPoint(r,t);if(i)return{node:i.startContainer,offset:Math.min(Xe(i.startContainer),i.startOffset)}}}var St=typeof navigator<"u"?navigator:null,Jm=typeof document<"u"?document:null,gr=St&&St.userAgent||"",Uu=/Edge\/(\d+)/.exec(gr),Ag=/MSIE \d/.exec(gr),Ku=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(gr),$e=!!(Ag||Ku||Uu),mr=Ag?document.documentMode:Ku?+Ku[1]:Uu?+Uu[1]:0,Ye=!$e&&/gecko\/(\d+)/i.test(gr);Ye&&+(/Firefox\/(\d+)/.exec(gr)||[0,0])[1];var Ju=!$e&&/Chrome\/(\d+)/.exec(gr),Me=!!Ju,Ng=Ju?+Ju[1]:0,Ie=!$e&&!!St&&/Apple Computer/.test(St.vendor),In=Ie&&(/Mobile\/\w+/.test(gr)||!!St&&St.maxTouchPoints>2),Ge=In||(St?/Mac/.test(St.platform):!1),dC=St?/Win/.test(St.platform):!1,Kt=/Android \d/.test(gr),Wi=!!Jm&&"webkitFontSmoothing"in Jm.documentElement.style,hC=Wi?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function pC(e){var r=e.defaultView&&e.defaultView.visualViewport;return r?{left:0,right:r.width,top:0,bottom:r.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function Vt(e,r){return typeof e=="number"?e:e[r]}function mC(e){var r=e.getBoundingClientRect(),t=r.width/e.offsetWidth||1,n=r.height/e.offsetHeight||1;return{left:r.left,right:r.left+e.clientWidth*t,top:r.top,bottom:r.top+e.clientHeight*n}}function Zm(e,r,t){for(var n=e.someProp("scrollThreshold")||0,i=e.someProp("scrollMargin")||5,o=e.dom.ownerDocument,s=t||e.dom;s;){if(s.nodeType!=1){s=Dn(s);continue}var a=s,l=a==o.body,u=l?pC(o):mC(a),c=0,f=0;if(r.top<u.top+Vt(n,"top")?f=-(u.top-r.top+Vt(i,"top")):r.bottom>u.bottom-Vt(n,"bottom")&&(f=r.bottom-r.top>u.bottom-u.top?r.top+Vt(i,"top")-u.top:r.bottom-u.bottom+Vt(i,"bottom")),r.left<u.left+Vt(n,"left")?c=-(u.left-r.left+Vt(i,"left")):r.right>u.right-Vt(n,"right")&&(c=r.right-u.right+Vt(i,"right")),c||f)if(l)o.defaultView.scrollBy(c,f);else{var d=a.scrollLeft,h=a.scrollTop;f&&(a.scrollTop+=f),c&&(a.scrollLeft+=c);var p=a.scrollLeft-d,m=a.scrollTop-h;r={left:r.left-p,top:r.top-m,right:r.right-p,bottom:r.bottom-m}}var v=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(v))break;s=v=="absolute"?s.offsetParent:Dn(s)}}function gC(e){for(var r=e.dom.getBoundingClientRect(),t=Math.max(0,r.top),n,i,o=(r.left+r.right)/2,s=t+1;s<Math.min(innerHeight,r.bottom);s+=5){var a=e.root.elementFromPoint(o,s);if(!(!a||a==e.dom||!e.dom.contains(a))){var l=a.getBoundingClientRect();if(l.top>=t-20){n=a,i=l.top;break}}}return{refDOM:n,refTop:i,stack:Pg(e.dom)}}function Pg(e){for(var r=[],t=e.ownerDocument,n=e;n&&(r.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),e!=t);n=Dn(n));return r}function vC(e){var r=e.refDOM,t=e.refTop,n=e.stack,i=r?r.getBoundingClientRect().top:0;Rg(n,i==0?0:i-t)}function Rg(e,r){for(var t=0;t<e.length;t++){var n=e[t],i=n.dom,o=n.top,s=n.left;i.scrollTop!=o+r&&(i.scrollTop=o+r),i.scrollLeft!=s&&(i.scrollLeft=s)}}var On=null;function yC(e){if(e.setActive)return e.setActive();if(On)return e.focus(On);var r=Pg(e);e.focus(On==null?{get preventScroll(){return On={preventScroll:!0},!0}}:void 0),On||(On=!1,Rg(r,0))}function Dg(e,r){for(var t,n=2e8,i,o=0,s=r.top,a=r.top,l,u,c=e.firstChild,f=0;c;c=c.nextSibling,f++){var d=void 0;if(c.nodeType==1)d=c.getClientRects();else if(c.nodeType==3)d=Ut(c).getClientRects();else continue;for(var h=0;h<d.length;h++){var p=d[h];if(p.top<=s&&p.bottom>=a){s=Math.max(p.bottom,s),a=Math.min(p.top,a);var m=p.left>r.left?p.left-r.left:p.right<r.left?r.left-p.right:0;if(m<n){t=c,n=m,i=m&&t.nodeType==3?{left:p.right<r.left?p.right:p.left,top:r.top}:r,c.nodeType==1&&m&&(o=f+(r.left>=(p.left+p.right)/2?1:0));continue}}else p.top>r.top&&!l&&p.left<=r.left&&p.right>=r.left&&(l=c,u={left:Math.max(p.left,Math.min(p.right,r.left)),top:p.top});!t&&(r.left>=p.right&&r.top>=p.top||r.left>=p.left&&r.top>=p.bottom)&&(o=f+1)}}return!t&&l&&(t=l,i=u,n=0),t&&t.nodeType==3?bC(t,i):!t||n&&t.nodeType==1?{node:e,offset:o}:Dg(t,i)}function bC(e,r){for(var t=e.nodeValue.length,n=document.createRange(),i=0;i<t;i++){n.setEnd(e,i+1),n.setStart(e,i);var o=dr(n,1);if(o.top!=o.bottom&&tc(r,o))return{node:e,offset:i+(r.left>=(o.left+o.right)/2?1:0)}}return{node:e,offset:0}}function tc(e,r){return e.left>=r.left-1&&e.left<=r.right+1&&e.top>=r.top-1&&e.top<=r.bottom+1}function kC(e,r){var t=e.parentNode;return t&&/^li$/i.test(t.nodeName)&&r.left<e.getBoundingClientRect().left?t:e}function wC(e,r,t){var n=Dg(r,t),i=n.node,o=n.offset,s=-1;if(i.nodeType==1&&!i.firstChild){var a=i.getBoundingClientRect();s=a.left!=a.right&&t.left>(a.left+a.right)/2?1:-1}return e.docView.posFromDOM(i,o,s)}function SC(e,r,t,n){for(var i=-1,o=r,s=!1;o!=e.dom;){var a=e.docView.nearestDesc(o,!0),l=void 0;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!s&&l.left>n.left||l.top>n.top?i=a.posBefore:(!s&&l.right<n.left||l.bottom<n.top)&&(i=a.posAfter),s=!0),!a.contentDOM&&i<0&&!a.node.isText)){var u=a.node.isBlock?n.top<(l.top+l.bottom)/2:n.left<(l.left+l.right)/2;return u?a.posBefore:a.posAfter}o=a.dom.parentNode}return i>-1?i:e.docView.posFromDOM(r,t,-1)}function Ig(e,r,t){var n=e.childNodes.length;if(n&&t.top<t.bottom)for(var i=Math.max(0,Math.min(n-1,Math.floor(n*(r.top-t.top)/(t.bottom-t.top))-2)),o=i;;){var s=e.childNodes[o];if(s.nodeType==1)for(var a=s.getClientRects(),l=0;l<a.length;l++){var u=a[l];if(tc(r,u))return Ig(s,r,u)}if((o=(o+1)%n)==i)break}return e}function xC(e,r){var t=e.dom.ownerDocument,n,i=0,o=fC(t,r.left,r.top);o&&(n=o.node,i=o.offset);var s=(e.root.elementFromPoint?e.root:t).elementFromPoint(r.left,r.top),a;if(!s||!e.dom.contains(s.nodeType!=1?s.parentNode:s)){var l=e.dom.getBoundingClientRect();if(!tc(r,l)||(s=Ig(e.dom,r,l),!s))return null}if(Ie)for(var u=s;n&&u;u=Dn(u))u.draggable&&(n=void 0);if(s=kC(s,r),n){if(Ye&&n.nodeType==1&&(i=Math.min(i,n.childNodes.length),i<n.childNodes.length)){var c=n.childNodes[i],f;c.nodeName=="IMG"&&(f=c.getBoundingClientRect()).right<=r.left&&f.bottom>r.top&&i++}var d;Wi&&i&&n.nodeType==1&&(d=n.childNodes[i-1]).nodeType==1&&d.contentEditable=="false"&&d.getBoundingClientRect().top>=r.top&&i--,n==e.dom&&i==n.childNodes.length-1&&n.lastChild.nodeType==1&&r.top>n.lastChild.getBoundingClientRect().bottom?a=e.state.doc.content.size:(i==0||n.nodeType!=1||n.childNodes[i-1].nodeName!="BR")&&(a=SC(e,n,i,r))}a==null&&(a=wC(e,s,r));var h=e.docView.nearestDesc(s,!0);return{pos:a,inside:h?h.posAtStart-h.border:-1}}function Gm(e){return e.top<e.bottom||e.left<e.right}function dr(e,r){var t=e.getClientRects();if(t.length){var n=t[r<0?0:t.length-1];if(Gm(n))return n}return Array.prototype.find.call(t,Gm)||e.getBoundingClientRect()}var _C=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Lg(e,r,t){var n=e.docView.domFromPos(r,t<0?-1:1),i=n.node,o=n.offset,s=n.atom,a=Wi||Ye;if(i.nodeType==3)if(a&&(_C.test(i.nodeValue)||(t<0?!o:o==i.nodeValue.length))){var l=dr(Ut(i,o,o),t);if(Ye&&o&&/\s/.test(i.nodeValue[o-1])&&o<i.nodeValue.length){var u=dr(Ut(i,o-1,o-1),-1);if(u.top==l.top){var c=dr(Ut(i,o,o+1),-1);if(c.top!=l.top)return Ii(c,c.left<u.left)}}return l}else{var f=o,d=o,h=t<0?1:-1;return t<0&&!o?(d++,h=-1):t>=0&&o==i.nodeValue.length?(f--,h=1):t<0?f--:d++,Ii(dr(Ut(i,f,d),h),h<0)}var p=e.state.doc.resolve(r-(s||0));if(!p.parent.inlineContent){if(s==null&&o&&(t<0||o==Xe(i))){var m=i.childNodes[o-1];if(m.nodeType==1)return Fu(m.getBoundingClientRect(),!1)}if(s==null&&o<Xe(i)){var v=i.childNodes[o];if(v.nodeType==1)return Fu(v.getBoundingClientRect(),!0)}return Fu(i.getBoundingClientRect(),t>=0)}if(s==null&&o&&(t<0||o==Xe(i))){var g=i.childNodes[o-1],y=g.nodeType==3?Ut(g,Xe(g)-(a?0:1)):g.nodeType==1&&(g.nodeName!="BR"||!g.nextSibling)?g:null;if(y)return Ii(dr(y,1),!1)}if(s==null&&o<Xe(i)){for(var w=i.childNodes[o];w.pmViewDesc&&w.pmViewDesc.ignoreForCoords;)w=w.nextSibling;var b=w?w.nodeType==3?Ut(w,0,a?0:1):w.nodeType==1?w:null:null;if(b)return Ii(dr(b,-1),!0)}return Ii(dr(i.nodeType==3?Ut(i):i,-t),t>=0)}function Ii(e,r){if(e.width==0)return e;var t=r?e.left:e.right;return{top:e.top,bottom:e.bottom,left:t,right:t}}function Fu(e,r){if(e.height==0)return e;var t=r?e.top:e.bottom;return{top:t,bottom:t,left:e.left,right:e.right}}function Fg(e,r,t){var n=e.state,i=e.root.activeElement;n!=r&&e.updateState(r),i!=e.dom&&e.focus();try{return t()}finally{n!=r&&e.updateState(n),i!=e.dom&&i&&i.focus()}}function TC(e,r,t){var n=r.selection,i=t=="up"?n.$from:n.$to;return Fg(e,r,function(){for(var o=e.docView.domFromPos(i.pos,t=="up"?-1:1),s=o.node;;){var a=e.docView.nearestDesc(s,!0);if(!a)break;if(a.node.isBlock){s=a.contentDOM||a.dom;break}s=a.dom.parentNode}for(var l=Lg(e,i.pos,1),u=s.firstChild;u;u=u.nextSibling){var c=void 0;if(u.nodeType==1)c=u.getClientRects();else if(u.nodeType==3)c=Ut(u,0,u.nodeValue.length).getClientRects();else continue;for(var f=0;f<c.length;f++){var d=c[f];if(d.bottom>d.top+1&&(t=="up"?l.top-d.top>(d.bottom-l.top)*2:d.bottom-l.bottom>(l.bottom-d.top)*2))return!1}}return!0})}var EC=/[\u0590-\u08ac]/;function CC(e,r,t){var n=r.selection.$head;if(!n.parent.isTextblock)return!1;var i=n.parentOffset,o=!i,s=i==n.parent.content.size,a=e.domSelection();return a?!EC.test(n.parent.textContent)||!a.modify?t=="left"||t=="backward"?o:s:Fg(e,r,function(){var l=e.domSelectionRange(),u=l.focusNode,c=l.focusOffset,f=l.anchorNode,d=l.anchorOffset,h=a.caretBidiLevel;a.modify("move",t,"character");var p=n.depth?e.docView.domAfterPos(n.before()):e.dom,m=e.domSelectionRange(),v=m.focusNode,g=m.focusOffset,y=v&&!p.contains(v.nodeType==1?v:v.parentNode)||u==v&&c==g;try{a.collapse(f,d),u&&(u!=f||c!=d)&&a.extend&&a.extend(u,c)}catch{}return h!=null&&(a.caretBidiLevel=h),y}):n.pos==n.start()||n.pos==n.end()}var Xm=null,Ym=null,Qm=!1;function OC(e,r,t){return Xm==r&&Ym==t?Qm:(Xm=r,Ym=t,Qm=t=="up"||t=="down"?TC(e,r,t):CC(e,r,t))}var Qe=0,eg=1,Vr=2,xt=3,Vi=(function(){function e(r,t,n,i){oe(this,e),this.parent=r,this.children=t,this.dom=n,this.contentDOM=i,this.dirty=Qe,n.pmViewDesc=this}return se(e,[{key:"matchesWidget",value:function(t){return!1}},{key:"matchesMark",value:function(t){return!1}},{key:"matchesNode",value:function(t,n,i){return!1}},{key:"matchesHack",value:function(t){return!1}},{key:"parseRule",value:function(){return null}},{key:"stopEvent",value:function(t){return!1}},{key:"size",get:function(){for(var t=0,n=0;n<this.children.length;n++)t+=this.children[n].size;return t}},{key:"border",get:function(){return 0}},{key:"destroy",value:function(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(var t=0;t<this.children.length;t++)this.children[t].destroy()}},{key:"posBeforeChild",value:function(t){for(var n=0,i=this.posAtStart;;n++){var o=this.children[n];if(o==t)return i;i+=o.size}}},{key:"posBefore",get:function(){return this.parent.posBeforeChild(this)}},{key:"posAtStart",get:function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}},{key:"posAfter",get:function(){return this.posBefore+this.size}},{key:"posAtEnd",get:function(){return this.posAtStart+this.size-2*this.border}},{key:"localPosFromDOM",value:function(t,n,i){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(i<0){var o,s;if(t==this.contentDOM)o=t.childNodes[n-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;o=t.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{var a,l;if(t==this.contentDOM)a=t.childNodes[n];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;a=t.nextSibling}for(;a&&!((l=a.pmViewDesc)&&l.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(l):this.posAtEnd}var u;if(t==this.dom&&this.contentDOM)u=n>ke(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))u=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(var c=t;;c=c.parentNode){if(c==this.dom){u=!1;break}if(c.previousSibling)break}if(u==null&&n==t.childNodes.length)for(var f=t;;f=f.parentNode){if(f==this.dom){u=!0;break}if(f.nextSibling)break}}return u??i>0?this.posAtEnd:this.posAtStart}},{key:"nearestDesc",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=!0,o=t;o;o=o.parentNode){var s=this.getDesc(o),a=void 0;if(s&&(!n||s.node))if(i&&(a=s.nodeDOM)&&!(a.nodeType==1?a.contains(t.nodeType==1?t:t.parentNode):a==t))i=!1;else return s}}},{key:"getDesc",value:function(t){for(var n=t.pmViewDesc,i=n;i;i=i.parent)if(i==this)return n}},{key:"posFromDOM",value:function(t,n,i){for(var o=t;o;o=o.parentNode){var s=this.getDesc(o);if(s)return s.localPosFromDOM(t,n,i)}return-1}},{key:"descAt",value:function(t){for(var n=0,i=0;n<this.children.length;n++){var o=this.children[n],s=i+o.size;if(i==t&&s!=i){for(;!o.border&&o.children.length;)for(var a=0;a<o.children.length;a++){var l=o.children[a];if(l.size){o=l;break}}return o}if(t<s)return o.descAt(t-i-o.border);i=s}}},{key:"domFromPos",value:function(t,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};for(var i=0,o=0,s=0;i<this.children.length;i++){var a=this.children[i],l=s+a.size;if(l>t||a instanceof qg){o=t-s;break}s=l}if(o)return this.children[i].domFromPos(o-this.children[i].border,n);for(var u;i&&!(u=this.children[i-1]).size&&u instanceof Bg&&u.side>=0;i--);if(n<=0){for(var c,f=!0;c=i?this.children[i-1]:null,!(!c||c.dom.parentNode==this.contentDOM);i--,f=!1);return c&&n&&f&&!c.border&&!c.domAtom?c.domFromPos(c.size,n):{node:this.contentDOM,offset:c?ke(c.dom)+1:0}}else{for(var d,h=!0;d=i<this.children.length?this.children[i]:null,!(!d||d.dom.parentNode==this.contentDOM);i++,h=!1);return d&&h&&!d.border&&!d.domAtom?d.domFromPos(0,n):{node:this.contentDOM,offset:d?ke(d.dom):this.contentDOM.childNodes.length}}}},{key:"parseRange",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.children.length==0)return{node:this.contentDOM,from:t,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var o=-1,s=-1,a=i,l=0;;l++){var u=this.children[l],c=a+u.size;if(o==-1&&t<=c){var f=a+u.border;if(t>=f&&n<=c-u.border&&u.node&&u.contentDOM&&this.contentDOM.contains(u.contentDOM))return u.parseRange(t,n,f);t=a;for(var d=l;d>0;d--){var h=this.children[d-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){o=ke(h.dom)+1;break}t-=h.size}o==-1&&(o=0)}if(o>-1&&(c>n||l==this.children.length-1)){n=c;for(var p=l+1;p<this.children.length;p++){var m=this.children[p];if(m.size&&m.dom.parentNode==this.contentDOM&&!m.emptyChildAt(-1)){s=ke(m.dom);break}n+=m.size}s==-1&&(s=this.contentDOM.childNodes.length);break}a=c}return{node:this.contentDOM,from:t,to:n,fromOffset:o,toOffset:s}}},{key:"emptyChildAt",value:function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var n=this.children[t<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(t)}},{key:"domAfterPos",value:function(t){var n=this.domFromPos(t,0),i=n.node,o=n.offset;if(i.nodeType!=1||o==i.childNodes.length)throw new RangeError("No node after pos "+t);return i.childNodes[o]}},{key:"setSelection",value:function(t,n,i){for(var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=Math.min(t,n),a=Math.max(t,n),l=0,u=0;l<this.children.length;l++){var c=this.children[l],f=u+c.size;if(s>u&&a<f)return c.setSelection(t-u-c.border,n-u-c.border,i,o);u=f}var d=this.domFromPos(t,t?-1:1),h=n==t?d:this.domFromPos(n,n?-1:1),p=i.root.getSelection(),m=i.domSelectionRange(),v=!1;if((Ye||Ie)&&t==n){var g=d,y=g.node,w=g.offset;if(y.nodeType==3){if(v=!!(w&&y.nodeValue[w-1]==`
`),v&&w==y.nodeValue.length)for(var b=y,k;b;b=b.parentNode){if(k=b.nextSibling){k.nodeName=="BR"&&(d=h={node:k.parentNode,offset:ke(k)+1});break}var x=b.pmViewDesc;if(x&&x.node&&x.node.isBlock)break}}else{var T=y.childNodes[w-1];v=T&&(T.nodeName=="BR"||T.contentEditable=="false")}}if(Ye&&m.focusNode&&m.focusNode!=h.node&&m.focusNode.nodeType==1){var _=m.focusNode.childNodes[m.focusOffset];_&&_.contentEditable=="false"&&(o=!0)}if(!(!(o||v&&Ie)&&Zr(d.node,d.offset,m.anchorNode,m.anchorOffset)&&Zr(h.node,h.offset,m.focusNode,m.focusOffset))){var C=!1;if((p.extend||t==n)&&!(v&&Ye)){p.collapse(d.node,d.offset);try{t!=n&&p.extend(h.node,h.offset),C=!0}catch{}}if(!C){if(t>n){var A=d;d=h,h=A}var O=document.createRange();O.setEnd(h.node,h.offset),O.setStart(d.node,d.offset),p.removeAllRanges(),p.addRange(O)}}}},{key:"ignoreMutation",value:function(t){return!this.contentDOM&&t.type!="selection"}},{key:"contentLost",get:function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}},{key:"markDirty",value:function(t,n){for(var i=0,o=0;o<this.children.length;o++){var s=this.children[o],a=i+s.size;if(i==a?t<=a&&n>=i:t<a&&n>i){var l=i+s.border,u=a-s.border;if(t>=l&&n<=u){this.dirty=t==i||n==a?Vr:eg,t==l&&n==u&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=xt:s.markDirty(t-l,n-l);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?Vr:xt}i=a}this.dirty=Vr}},{key:"markParentsDirty",value:function(){for(var t=1,n=this.parent;n;n=n.parent,t++){var i=t==1?Vr:eg;n.dirty<i&&(n.dirty=i)}}},{key:"domAtom",get:function(){return!1}},{key:"ignoreForCoords",get:function(){return!1}},{key:"ignoreForSelection",get:function(){return!1}},{key:"isText",value:function(t){return!1}}]),e})(),Bg=(function(e){Gr(t,e);var r=Xr(t);function t(n,i,o,s){var a;oe(this,t);var l,u=i.type.toDOM;if(typeof u=="function"&&(u=u(o,function(){if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)})),!i.type.spec.raw){if(u.nodeType!=1){var c=document.createElement("span");c.appendChild(u),u=c}u.contentEditable="false",u.classList.add("ProseMirror-widget")}return a=r.call(this,n,[],u,null),a.widget=i,a.widget=i,l=Mg(a),a}return se(t,[{key:"matchesWidget",value:function(i){return this.dirty==Qe&&i.type.eq(this.widget.type)}},{key:"parseRule",value:function(){return{ignore:!0}}},{key:"stopEvent",value:function(i){var o=this.widget.spec.stopEvent;return o?o(i):!1}},{key:"ignoreMutation",value:function(i){return i.type!="selection"||this.widget.spec.ignoreSelection}},{key:"destroy",value:function(){this.widget.type.destroy(this.dom),De(be(t.prototype),"destroy",this).call(this)}},{key:"domAtom",get:function(){return!0}},{key:"ignoreForSelection",get:function(){return!!this.widget.type.spec.relaxedSide}},{key:"side",get:function(){return this.widget.type.side}}]),t})(Vi),MC=(function(e){Gr(t,e);var r=Xr(t);function t(n,i,o,s){var a;return oe(this,t),a=r.call(this,n,[],i,null),a.textDOM=o,a.text=s,a}return se(t,[{key:"size",get:function(){return this.text.length}},{key:"localPosFromDOM",value:function(i,o){return i!=this.textDOM?this.posAtStart+(o?this.size:0):this.posAtStart+o}},{key:"domFromPos",value:function(i){return{node:this.textDOM,offset:i}}},{key:"ignoreMutation",value:function(i){return i.type==="characterData"&&i.target.nodeValue==i.oldValue}}]),t})(Vi),Ps=(function(e){Gr(t,e);var r=Xr(t);function t(n,i,o,s,a){var l;return oe(this,t),l=r.call(this,n,[],o,s),l.mark=i,l.spec=a,l}return se(t,[{key:"parseRule",value:function(){return this.dirty&xt||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}},{key:"matchesMark",value:function(i){return this.dirty!=xt&&this.mark.eq(i)}},{key:"markDirty",value:function(i,o){if(De(be(t.prototype),"markDirty",this).call(this,i,o),this.dirty!=Qe){for(var s=this.parent;!s.node;)s=s.parent;s.dirty<this.dirty&&(s.dirty=this.dirty),this.dirty=Qe}}},{key:"slice",value:function(i,o,s){var a=t.create(this.parent,this.mark,!0,s),l=this.children,u=this.size;o<u&&(l=Gu(l,o,u,s)),i>0&&(l=Gu(l,0,i,s));for(var c=0;c<l.length;c++)l[c].parent=a;return a.children=l,a}},{key:"ignoreMutation",value:function(i){return this.spec.ignoreMutation?this.spec.ignoreMutation(i):De(be(t.prototype),"ignoreMutation",this).call(this,i)}},{key:"destroy",value:function(){this.spec.destroy&&this.spec.destroy(),De(be(t.prototype),"destroy",this).call(this)}}],[{key:"create",value:function(i,o,s,a){var l=a.nodeViews[o.type.name],u=l&&l(o,a,s);return(!u||!u.dom)&&(u=ee.DOMSerializer.renderSpec(document,o.type.spec.toDOM(o,s),null,o.attrs)),new t(i,o,u.dom,u.contentDOM||u.dom,u)}}]),t})(Vi),Nn=(function(e){Gr(t,e);var r=Xr(t);function t(n,i,o,s,a,l,u,c,f){var d;return oe(this,t),d=r.call(this,n,[],a,l),d.node=i,d.outerDeco=o,d.innerDeco=s,d.nodeDOM=u,d}return se(t,[{key:"parseRule",value:function(){var i=this;if(this.node.type.spec.reparseInView)return null;var o={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(o.preserveWhitespace="full"),!this.contentDOM)o.getContent=function(){return i.node.content};else if(!this.contentLost)o.contentElement=this.contentDOM;else{for(var s=this.children.length-1;s>=0;s--){var a=this.children[s];if(this.dom.contains(a.dom.parentNode)){o.contentElement=a.dom.parentNode;break}}o.contentElement||(o.getContent=function(){return ee.Fragment.empty})}return o}},{key:"matchesNode",value:function(i,o,s){return this.dirty==Qe&&i.eq(this.node)&&Rs(o,this.outerDeco)&&s.eq(this.innerDeco)}},{key:"size",get:function(){return this.node.nodeSize}},{key:"border",get:function(){return this.node.isLeaf?0:1}},{key:"updateChildren",value:function(i,o){var s=this,a=this.node.inlineContent,l=o,u=i.composing?this.localCompositionInfo(i,o):null,c=u&&u.pos>-1?u:null,f=u&&u.pos<0,d=new PC(this,c&&c.node,i);IC(this.node,this.innerDeco,function(h,p,m){h.spec.marks?d.syncToMarks(h.spec.marks,a,i):h.type.side>=0&&!m&&d.syncToMarks(p==s.node.childCount?ee.Mark.none:s.node.child(p).marks,a,i),d.placeWidget(h,i,l)},function(h,p,m,v){d.syncToMarks(h.marks,a,i);var g;d.findNodeMatch(h,p,m,v)||f&&i.state.selection.from>l&&i.state.selection.to<l+h.nodeSize&&(g=d.findIndexWithChild(u.node))>-1&&d.updateNodeAt(h,p,m,g,i)||d.updateNextNode(h,p,m,i,v,l)||d.addNode(h,p,m,i,l),l+=h.nodeSize}),d.syncToMarks([],a,i),this.node.isTextblock&&d.addTextblockHacks(),d.destroyRest(),(d.changed||this.dirty==Vr)&&(c&&this.protectLocalComposition(i,c),jg(this.contentDOM,this.children,i),In&&LC(this.dom))}},{key:"localCompositionInfo",value:function(i,o){var s=i.state.selection,a=s.from,l=s.to;if(!(i.state.selection instanceof R.TextSelection)||a<o||l>o+this.node.content.size)return null;var u=i.input.compositionNode;if(!u||!this.dom.contains(u.parentNode))return null;if(this.node.inlineContent){var c=u.nodeValue,f=FC(this.node.content,c,a-o,l-o);return f<0?null:{node:u,pos:f,text:c}}else return{node:u,pos:-1,text:""}}},{key:"protectLocalComposition",value:function(i,o){var s=o.node,a=o.pos,l=o.text;if(!this.getDesc(s)){for(var u=s;u.parentNode!=this.contentDOM;u=u.parentNode){for(;u.previousSibling;)u.parentNode.removeChild(u.previousSibling);for(;u.nextSibling;)u.parentNode.removeChild(u.nextSibling);u.pmViewDesc&&(u.pmViewDesc=void 0)}var c=new MC(this,u,s,l);i.input.compositionNodes.push(c),this.children=Gu(this.children,a,a+l.length,i,c)}}},{key:"update",value:function(i,o,s,a){return this.dirty==xt||!i.sameMarkup(this.node)?!1:(this.updateInner(i,o,s,a),!0)}},{key:"updateInner",value:function(i,o,s,a){this.updateOuterDeco(o),this.node=i,this.innerDeco=s,this.contentDOM&&this.updateChildren(a,this.posAtStart),this.dirty=Qe}},{key:"updateOuterDeco",value:function(i){if(!Rs(i,this.outerDeco)){var o=this.nodeDOM.nodeType!=1,s=this.dom;this.dom=Hg(this.dom,this.nodeDOM,Zu(this.outerDeco,this.node,o),Zu(i,this.node,o)),this.dom!=s&&(s.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=i}}},{key:"selectNode",value:function(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}},{key:"deselectNode",value:function(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}},{key:"domAtom",get:function(){return this.node.isAtom}}],[{key:"create",value:function(i,o,s,a,l,u){var c=l.nodeViews[o.type.name],f,d=c&&c(o,l,function(){if(!f)return u;if(f.parent)return f.parent.posBeforeChild(f)},s,a),h=d&&d.dom,p=d&&d.contentDOM;if(o.isText){if(!h)h=document.createTextNode(o.text);else if(h.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else if(!h){var m=ee.DOMSerializer.renderSpec(document,o.type.spec.toDOM(o),null,o.attrs);h=m.dom,p=m.contentDOM}!p&&!o.isText&&h.nodeName!="BR"&&(h.hasAttribute("contenteditable")||(h.contentEditable="false"),o.type.spec.draggable&&(h.draggable=!0));var v=h;return h=$g(h,s,o),d?f=new AC(i,o,s,a,h,p||null,v,d,l,u+1):o.isText?new zg(i,o,s,a,h,v,l):new t(i,o,s,a,h,p||null,v,l,u+1)}}]),t})(Vi);function tg(e,r,t,n,i){$g(n,r,e);var o=new Nn(void 0,e,r,t,n,n,n,i,0);return o.contentDOM&&o.updateChildren(i,0),o}var zg=(function(e){Gr(t,e);var r=Xr(t);function t(n,i,o,s,a,l,u){return oe(this,t),r.call(this,n,i,o,s,a,null,l,u,0)}return se(t,[{key:"parseRule",value:function(){for(var i=this.nodeDOM.parentNode;i&&i!=this.dom&&!i.pmIsDeco;)i=i.parentNode;return{skip:i||!0}}},{key:"update",value:function(i,o,s,a){return this.dirty==xt||this.dirty!=Qe&&!this.inParent()||!i.sameMarkup(this.node)?!1:(this.updateOuterDeco(o),(this.dirty!=Qe||i.text!=this.node.text)&&i.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=i.text,a.trackWrites==this.nodeDOM&&(a.trackWrites=null)),this.node=i,this.dirty=Qe,!0)}},{key:"inParent",value:function(){for(var i=this.parent.contentDOM,o=this.nodeDOM;o;o=o.parentNode)if(o==i)return!0;return!1}},{key:"domFromPos",value:function(i){return{node:this.nodeDOM,offset:i}}},{key:"localPosFromDOM",value:function(i,o,s){return i==this.nodeDOM?this.posAtStart+Math.min(o,this.node.text.length):De(be(t.prototype),"localPosFromDOM",this).call(this,i,o,s)}},{key:"ignoreMutation",value:function(i){return i.type!="characterData"&&i.type!="selection"}},{key:"slice",value:function(i,o,s){var a=this.node.cut(i,o),l=document.createTextNode(a.text);return new t(this.parent,a,this.outerDeco,this.innerDeco,l,l,s)}},{key:"markDirty",value:function(i,o){De(be(t.prototype),"markDirty",this).call(this,i,o),this.dom!=this.nodeDOM&&(i==0||o==this.nodeDOM.nodeValue.length)&&(this.dirty=xt)}},{key:"domAtom",get:function(){return!1}},{key:"isText",value:function(i){return this.node.text==i}}]),t})(Nn),qg=(function(e){Gr(t,e);var r=Xr(t);function t(){return oe(this,t),r.apply(this,arguments)}return se(t,[{key:"parseRule",value:function(){return{ignore:!0}}},{key:"matchesHack",value:function(i){return this.dirty==Qe&&this.dom.nodeName==i}},{key:"domAtom",get:function(){return!0}},{key:"ignoreForCoords",get:function(){return this.dom.nodeName=="IMG"}}]),t})(Vi),AC=(function(e){Gr(t,e);var r=Xr(t);function t(n,i,o,s,a,l,u,c,f,d){var h;return oe(this,t),h=r.call(this,n,i,o,s,a,l,u,f,d),h.spec=c,h}return se(t,[{key:"update",value:function(i,o,s,a){if(this.dirty==xt)return!1;if(this.spec.update&&(this.node.type==i.type||this.spec.multiType)){var l=this.spec.update(i,o,s);return l&&this.updateInner(i,o,s,a),l}else return!this.contentDOM&&!i.isLeaf?!1:De(be(t.prototype),"update",this).call(this,i,o,s,a)}},{key:"selectNode",value:function(){this.spec.selectNode?this.spec.selectNode():De(be(t.prototype),"selectNode",this).call(this)}},{key:"deselectNode",value:function(){this.spec.deselectNode?this.spec.deselectNode():De(be(t.prototype),"deselectNode",this).call(this)}},{key:"setSelection",value:function(i,o,s,a){this.spec.setSelection?this.spec.setSelection(i,o,s.root):De(be(t.prototype),"setSelection",this).call(this,i,o,s,a)}},{key:"destroy",value:function(){this.spec.destroy&&this.spec.destroy(),De(be(t.prototype),"destroy",this).call(this)}},{key:"stopEvent",value:function(i){return this.spec.stopEvent?this.spec.stopEvent(i):!1}},{key:"ignoreMutation",value:function(i){return this.spec.ignoreMutation?this.spec.ignoreMutation(i):De(be(t.prototype),"ignoreMutation",this).call(this,i)}}]),t})(Nn);function jg(e,r,t){for(var n=e.firstChild,i=!1,o=0;o<r.length;o++){var s=r[o],a=s.dom;if(a.parentNode==e){for(;a!=n;)n=rg(n),i=!0;n=n.nextSibling}else i=!0,e.insertBefore(a,n);if(s instanceof Ps){var l=n?n.previousSibling:e.lastChild;jg(s.contentDOM,s.children,t),n=l?l.nextSibling:e.firstChild}}for(;n;)n=rg(n),i=!0;i&&t.trackWrites==e&&(t.trackWrites=null)}var Li=function(r){r&&(this.nodeName=r)};Li.prototype=Object.create(null);var Ur=[new Li];function Zu(e,r,t){if(e.length==0)return Ur;for(var n=t?Ur[0]:new Li,i=[n],o=0;o<e.length;o++){var s=e[o].type.attrs;if(s){s.nodeName&&i.push(n=new Li(s.nodeName));for(var a in s){var l=s[a];l!=null&&(t&&i.length==1&&i.push(n=new Li(r.isInline?"span":"div")),a=="class"?n.class=(n.class?n.class+" ":"")+l:a=="style"?n.style=(n.style?n.style+";":"")+l:a!="nodeName"&&(n[a]=l))}}}return i}function Hg(e,r,t,n){if(t==Ur&&n==Ur)return r;for(var i=r,o=0;o<n.length;o++){var s=n[o],a=t[o];if(o){var l=void 0;a&&a.nodeName==s.nodeName&&i!=e&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=Ur[0]),i=l}NC(i,a||Ur[0],s)}return i}function NC(e,r,t){for(var n in r)n!="class"&&n!="style"&&n!="nodeName"&&!(n in t)&&e.removeAttribute(n);for(var i in t)i!="class"&&i!="style"&&i!="nodeName"&&t[i]!=r[i]&&e.setAttribute(i,t[i]);if(r.class!=t.class){for(var o=r.class?r.class.split(" ").filter(Boolean):[],s=t.class?t.class.split(" ").filter(Boolean):[],a=0;a<o.length;a++)s.indexOf(o[a])==-1&&e.classList.remove(o[a]);for(var l=0;l<s.length;l++)o.indexOf(s[l])==-1&&e.classList.add(s[l]);e.classList.length==0&&e.removeAttribute("class")}if(r.style!=t.style){if(r.style)for(var u=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,c;c=u.exec(r.style);)e.style.removeProperty(c[1]);t.style&&(e.style.cssText+=t.style)}}function $g(e,r,t){return Hg(e,e,Ur,Zu(r,t,e.nodeType!=1))}function Rs(e,r){if(e.length!=r.length)return!1;for(var t=0;t<e.length;t++)if(!e[t].type.eq(r[t].type))return!1;return!0}function rg(e){var r=e.nextSibling;return e.parentNode.removeChild(e),r}var PC=(function(){function e(r,t,n){oe(this,e),this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=r,this.preMatch=RC(r.node.content,r)}return se(e,[{key:"destroyBetween",value:function(t,n){if(t!=n){for(var i=t;i<n;i++)this.top.children[i].destroy();this.top.children.splice(t,n-t),this.changed=!0}}},{key:"destroyRest",value:function(){this.destroyBetween(this.index,this.top.children.length)}},{key:"syncToMarks",value:function(t,n,i){for(var o=0,s=this.stack.length>>1,a=Math.min(s,t.length);o<a&&(o==s-1?this.top:this.stack[o+1<<1]).matchesMark(t[o])&&t[o].type.spec.spanning!==!1;)o++;for(;o<s;)this.destroyRest(),this.top.dirty=Qe,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<t.length;){this.stack.push(this.top,this.index+1);for(var l=-1,u=this.index;u<Math.min(this.index+3,this.top.children.length);u++){var c=this.top.children[u];if(c.matchesMark(t[s])&&!this.isLocked(c.dom)){l=u;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{var f=Ps.create(this.top,t[s],n,i);this.top.children.splice(this.index,0,f),this.top=f,this.changed=!0}this.index=0,s++}}},{key:"findNodeMatch",value:function(t,n,i,o){var s=-1,a;if(o>=this.preMatch.index&&(a=this.preMatch.matches[o-this.preMatch.index]).parent==this.top&&a.matchesNode(t,n,i))s=this.top.children.indexOf(a,this.index);else for(var l=this.index,u=Math.min(this.top.children.length,l+5);l<u;l++){var c=this.top.children[l];if(c.matchesNode(t,n,i)&&!this.preMatch.matched.has(c)){s=l;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}},{key:"updateNodeAt",value:function(t,n,i,o,s){var a=this.top.children[o];return a.dirty==xt&&a.dom==a.contentDOM&&(a.dirty=Vr),a.update(t,n,i,s)?(this.destroyBetween(this.index,o),this.index++,!0):!1}},{key:"findIndexWithChild",value:function(t){for(;;){var n=t.parentNode;if(!n)return-1;if(n==this.top.contentDOM){var i=t.pmViewDesc;if(i){for(var o=this.index;o<this.top.children.length;o++)if(this.top.children[o]==i)return o}return-1}t=n}}},{key:"updateNextNode",value:function(t,n,i,o,s,a){for(var l=this.index;l<this.top.children.length;l++){var u=this.top.children[l];if(u instanceof Nn){var c=this.preMatch.matched.get(u);if(c!=null&&c!=s)return!1;var f=u.dom,d=void 0,h=this.isLocked(f)&&!(t.isText&&u.node&&u.node.isText&&u.nodeDOM.nodeValue==t.text&&u.dirty!=xt&&Rs(n,u.outerDeco));if(!h&&u.update(t,n,i,o))return this.destroyBetween(this.index,l),u.dom!=f&&(this.changed=!0),this.index++,!0;if(!h&&(d=this.recreateWrapper(u,t,n,i,o,a)))return this.destroyBetween(this.index,l),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=Vr,d.updateChildren(o,a+1),d.dirty=Qe),this.changed=!0,this.index++,!0;break}}return!1}},{key:"recreateWrapper",value:function(t,n,i,o,s,a){if(t.dirty||n.isAtom||!t.children.length||!t.node.content.eq(n.content)||!Rs(i,t.outerDeco)||!o.eq(t.innerDeco))return null;var l=Nn.create(this.top,n,i,o,s,a);if(l.contentDOM){l.children=t.children,t.children=[];var u=$u(l.children),c;try{for(u.s();!(c=u.n()).done;){var f=c.value;f.parent=l}}catch(d){u.e(d)}finally{u.f()}}return t.destroy(),l}},{key:"addNode",value:function(t,n,i,o,s){var a=Nn.create(this.top,t,n,i,o,s);a.contentDOM&&a.updateChildren(o,s+1),this.top.children.splice(this.index++,0,a),this.changed=!0}},{key:"placeWidget",value:function(t,n,i){var o=this.index<this.top.children.length?this.top.children[this.index]:null;if(o&&o.matchesWidget(t)&&(t==o.widget||!o.widget.type.toDOM.parentNode))this.index++;else{var s=new Bg(this.top,t,n,i);this.top.children.splice(this.index++,0,s),this.changed=!0}}},{key:"addTextblockHacks",value:function(){for(var t=this.top.children[this.index-1],n=this.top;t instanceof Ps;)n=t,t=n.children[n.children.length-1];(!t||!(t instanceof zg)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((Ie||Me)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}},{key:"addHackNode",value:function(t,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(t))this.index++;else{var i=document.createElement(t);t=="IMG"&&(i.className="ProseMirror-separator",i.alt=""),t=="BR"&&(i.className="ProseMirror-trailingBreak");var o=new qg(this.top,[],i,null);n!=this.top?n.children.push(o):n.children.splice(this.index++,0,o),this.changed=!0}}},{key:"isLocked",value:function(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}]),e})();function RC(e,r){var t=r,n=t.children.length,i=e.childCount,o=new Map,s=[];e:for(;i>0;){for(var a=void 0;;)if(n){var l=t.children[n-1];if(l instanceof Ps)t=l,n=l.children.length;else{a=l,n--;break}}else{if(t==r)break e;n=t.parent.children.indexOf(t),t=t.parent}var u=a.node;if(u){if(u!=e.child(i-1))break;--i,o.set(a,i),s.push(a)}}return{index:i,matched:o,matches:s.reverse()}}function DC(e,r){return e.type.side-r.type.side}function IC(e,r,t,n){var i=r.locals(e),o=0;if(i.length==0){for(var s=0;s<e.childCount;s++){var a=e.child(s);n(a,i,r.forChild(o,a),s),o+=a.nodeSize}return}for(var l=0,u=[],c=null,f=0;;){for(var d=void 0,h=void 0;l<i.length&&i[l].to==o;){var p=i[l++];p.widget&&(d?(h||(h=[d])).push(p):d=p)}if(d)if(h){h.sort(DC);for(var m=0;m<h.length;m++)t(h[m],f,!!c)}else t(d,f,!!c);var v=void 0,g=void 0;if(c)g=-1,v=c,c=null;else if(f<e.childCount)g=f,v=e.child(f++);else break;for(var y=0;y<u.length;y++)u[y].to<=o&&u.splice(y--,1);for(;l<i.length&&i[l].from<=o&&i[l].to>o;)u.push(i[l++]);var w=o+v.nodeSize;if(v.isText){var b=w;l<i.length&&i[l].from<b&&(b=i[l].from);for(var k=0;k<u.length;k++)u[k].to<b&&(b=u[k].to);b<w&&(c=v.cut(b-o),v=v.cut(0,b-o),w=b,g=-1)}else for(;l<i.length&&i[l].to<w;)l++;var x=v.isInline&&!v.isLeaf?u.filter(function(T){return!T.inline}):u.slice();n(v,x,r.forChild(o,v),g),o=w}}function LC(e){if(e.nodeName=="UL"||e.nodeName=="OL"){var r=e.style.cssText;e.style.cssText=r+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=r}}function FC(e,r,t,n){for(var i=0,o=0;i<e.childCount&&o<=n;){var s=e.child(i++),a=o;if(o+=s.nodeSize,!!s.isText){for(var l=s.text;i<e.childCount;){var u=e.child(i++);if(o+=u.nodeSize,!u.isText)break;l+=u.text}if(o>=t){if(o>=n&&l.slice(n-r.length-a,n-a)==r)return n-r.length;var c=a<n?l.lastIndexOf(r,n-a-1):-1;if(c>=0&&c+r.length+a>=t)return a+c;if(t==n&&l.length>=n+r.length-a&&l.slice(n-a,n-a+r.length)==r)return n}}}return-1}function Gu(e,r,t,n,i){for(var o=[],s=0,a=0;s<e.length;s++){var l=e[s],u=a,c=a+=l.size;u>=t||c<=r?o.push(l):(u<r&&o.push(l.slice(0,r-u,n)),i&&(o.push(i),i=void 0),c>t&&o.push(l.slice(t-u,l.size,n)))}return o}function rc(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=e.domSelectionRange(),n=e.state.doc;if(!t.focusNode)return null;var i=e.docView.nearestDesc(t.focusNode),o=i&&i.size==0,s=e.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;var a=n.resolve(s),l,u;if(Ls(t)){for(l=s;i&&!i.node;)i=i.parent;var c=i.node;if(i&&c.isAtom&&R.NodeSelection.isSelectable(c)&&i.parent&&!(c.isInline&&uC(t.focusNode,t.focusOffset,i.dom))){var f=i.posBefore;u=new R.NodeSelection(s==f?a:n.resolve(f))}}else{if(t instanceof e.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){for(var d=s,h=s,p=0;p<t.rangeCount;p++){var m=t.getRangeAt(p);d=Math.min(d,e.docView.posFromDOM(m.startContainer,m.startOffset,1)),h=Math.max(h,e.docView.posFromDOM(m.endContainer,m.endOffset,-1))}if(d<0)return null;var v=h==e.state.selection.anchor?[h,d]:[d,h],g=Cg(v,2);l=g[0],s=g[1],a=n.resolve(s)}else l=e.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(l<0)return null}var y=n.resolve(l);if(!u){var w=r=="pointer"||e.state.selection.head<a.pos&&!o?1:-1;u=nc(e,y,a,w)}return u}function Wg(e){return e.editable?e.hasFocus():Ug(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function Jt(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=e.state.selection;if(Vg(e,t),!!Wg(e)){if(!r&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&Me){var n=e.domSelectionRange(),i=e.domObserver.currentSelection;if(n.anchorNode&&i.anchorNode&&Zr(n.anchorNode,n.anchorOffset,i.anchorNode,i.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)zC(e);else{var o=t.anchor,s=t.head,a,l;ng&&!(t instanceof R.TextSelection)&&(t.$from.parent.inlineContent||(a=ig(e,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(l=ig(e,t.to))),e.docView.setSelection(o,s,e,r),ng&&(a&&og(a),l&&og(l)),t.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&BC(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}var ng=Ie||Me&&Ng<63;function ig(e,r){var t=e.docView.domFromPos(r,0),n=t.node,i=t.offset,o=i<n.childNodes.length?n.childNodes[i]:null,s=i?n.childNodes[i-1]:null;if(Ie&&o&&o.contentEditable=="false")return Bu(o);if((!o||o.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(o)return Bu(o);if(s)return Bu(s)}}function Bu(e){return e.contentEditable="true",Ie&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function og(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function BC(e){var r=e.dom.ownerDocument;r.removeEventListener("selectionchange",e.input.hideSelectionGuard);var t=e.domSelectionRange(),n=t.anchorNode,i=t.anchorOffset;r.addEventListener("selectionchange",e.input.hideSelectionGuard=function(){(t.anchorNode!=n||t.anchorOffset!=i)&&(r.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(function(){(!Wg(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}function zC(e){var r=e.domSelection();if(r){var t=e.cursorWrapper.dom,n=t.nodeName=="IMG";n?r.collapse(t.parentNode,ke(t)+1):r.collapse(t,0),!n&&!e.state.selection.visible&&$e&&mr<=11&&(t.disabled=!0,t.disabled=!1)}}function Vg(e,r){if(r instanceof R.NodeSelection){var t=e.docView.descAt(r.from);t!=e.lastSelectedViewDesc&&(sg(e),t&&t.selectNode(),e.lastSelectedViewDesc=t)}else sg(e)}function sg(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function nc(e,r,t,n){return e.someProp("createSelectionBetween",function(i){return i(e,r,t)})||R.TextSelection.between(r,t,n)}function ag(e){return e.editable&&!e.hasFocus()?!1:Ug(e)}function Ug(e){var r=e.domSelectionRange();if(!r.anchorNode)return!1;try{return e.dom.contains(r.anchorNode.nodeType==3?r.anchorNode.parentNode:r.anchorNode)&&(e.editable||e.dom.contains(r.focusNode.nodeType==3?r.focusNode.parentNode:r.focusNode))}catch{return!1}}function qC(e){var r=e.docView.domFromPos(e.state.selection.anchor,0),t=e.domSelectionRange();return Zr(r.node,r.offset,t.anchorNode,t.anchorOffset)}function Xu(e,r){var t=e.selection,n=t.$anchor,i=t.$head,o=r>0?n.max(i):n.min(i),s=o.parent.inlineContent?o.depth?e.doc.resolve(r>0?o.after():o.before()):null:o;return s&&R.Selection.findFrom(s,r)}function hr(e,r){return e.dispatch(e.state.tr.setSelection(r).scrollIntoView()),!0}function lg(e,r,t){var n=e.state.selection;if(n instanceof R.TextSelection)if(t.indexOf("s")>-1){var i=n.$head,o=i.textOffset?null:r<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;var s=e.state.doc.resolve(i.pos+o.nodeSize*(r<0?-1:1));return hr(e,new R.TextSelection(n.$anchor,s))}else if(n.empty){if(e.endOfTextblock(r>0?"forward":"backward")){var a=Xu(e.state,r);return a&&a instanceof R.NodeSelection?hr(e,a):!1}else if(!(Ge&&t.indexOf("m")>-1)){var l=n.$head,u=l.textOffset?null:r<0?l.nodeBefore:l.nodeAfter,c;if(!u||u.isText)return!1;var f=r<0?l.pos-u.nodeSize:l.pos;return u.isAtom||(c=e.docView.descAt(f))&&!c.contentDOM?R.NodeSelection.isSelectable(u)?hr(e,new R.NodeSelection(r<0?e.state.doc.resolve(l.pos-u.nodeSize):l)):Wi?hr(e,new R.TextSelection(e.state.doc.resolve(r<0?f:f+u.nodeSize))):!1:!1}}else return!1;else{if(n instanceof R.NodeSelection&&n.node.isInline)return hr(e,new R.TextSelection(r>0?n.$to:n.$from));var d=Xu(e.state,r);return d?hr(e,d):!1}}function Ds(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function Fi(e,r){var t=e.pmViewDesc;return t&&t.size==0&&(r<0||e.nextSibling||e.nodeName!="BR")}function Mn(e,r){return r<0?jC(e):HC(e)}function jC(e){var r=e.domSelectionRange(),t=r.focusNode,n=r.focusOffset;if(t){var i,o,s=!1;for(Ye&&t.nodeType==1&&n<Ds(t)&&Fi(t.childNodes[n],-1)&&(s=!0);;)if(n>0){if(t.nodeType!=1)break;var a=t.childNodes[n-1];if(Fi(a,-1))i=t,o=--n;else if(a.nodeType==3)t=a,n=t.nodeValue.length;else break}else{if(Kg(t))break;for(var l=t.previousSibling;l&&Fi(l,-1);)i=t.parentNode,o=ke(l),l=l.previousSibling;if(l)t=l,n=Ds(t);else{if(t=t.parentNode,t==e.dom)break;n=0}}s?Yu(e,t,n):i&&Yu(e,i,o)}}function HC(e){var r=e.domSelectionRange(),t=r.focusNode,n=r.focusOffset;if(t){for(var i=Ds(t),o,s;;)if(n<i){if(t.nodeType!=1)break;var a=t.childNodes[n];if(Fi(a,1))o=t,s=++n;else break}else{if(Kg(t))break;for(var l=t.nextSibling;l&&Fi(l,1);)o=l.parentNode,s=ke(l)+1,l=l.nextSibling;if(l)t=l,n=0,i=Ds(t);else{if(t=t.parentNode,t==e.dom)break;n=i=0}}o&&Yu(e,o,s)}}function Kg(e){var r=e.pmViewDesc;return r&&r.node&&r.node.isBlock}function $C(e,r){for(;e&&r==e.childNodes.length&&!$i(e);)r=ke(e)+1,e=e.parentNode;for(;e&&r<e.childNodes.length;){var t=e.childNodes[r];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;e=t,r=0}}function WC(e,r){for(;e&&!r&&!$i(e);)r=ke(e),e=e.parentNode;for(;e&&r;){var t=e.childNodes[r-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;e=t,r=e.childNodes.length}}function Yu(e,r,t){if(r.nodeType!=3){var n,i;(i=$C(r,t))?(r=i,t=0):(n=WC(r,t))&&(r=n,t=n.nodeValue.length)}var o=e.domSelection();if(o){if(Ls(o)){var s=document.createRange();s.setEnd(r,t),s.setStart(r,t),o.removeAllRanges(),o.addRange(s)}else o.extend&&o.extend(r,t);e.domObserver.setCurSelection();var a=e.state;setTimeout(function(){e.state==a&&Jt(e)},50)}}function ug(e,r){var t=e.state.doc.resolve(r);if(!(Me||dC)&&t.parent.inlineContent){var n=e.coordsAtPos(r);if(r>t.start()){var i=e.coordsAtPos(r-1),o=(i.top+i.bottom)/2;if(o>n.top&&o<n.bottom&&Math.abs(i.left-n.left)>1)return i.left<n.left?"ltr":"rtl"}if(r<t.end()){var s=e.coordsAtPos(r+1),a=(s.top+s.bottom)/2;if(a>n.top&&a<n.bottom&&Math.abs(s.left-n.left)>1)return s.left>n.left?"ltr":"rtl"}}var l=getComputedStyle(e.dom).direction;return l=="rtl"?"rtl":"ltr"}function cg(e,r,t){var n=e.state.selection;if(n instanceof R.TextSelection&&!n.empty||t.indexOf("s")>-1||Ge&&t.indexOf("m")>-1)return!1;var i=n.$from,o=n.$to;if(!i.parent.inlineContent||e.endOfTextblock(r<0?"up":"down")){var s=Xu(e.state,r);if(s&&s instanceof R.NodeSelection)return hr(e,s)}if(!i.parent.inlineContent){var a=r<0?i:o,l=n instanceof R.AllSelection?R.Selection.near(a,r):R.Selection.findFrom(a,r);return l?hr(e,l):!1}return!1}function fg(e,r){if(!(e.state.selection instanceof R.TextSelection))return!0;var t=e.state.selection,n=t.$head,i=t.$anchor,o=t.empty;if(!n.sameParent(i))return!0;if(!o)return!1;if(e.endOfTextblock(r>0?"forward":"backward"))return!0;var s=!n.textOffset&&(r<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){var a=e.state.tr;return r<0?a.delete(n.pos-s.nodeSize,n.pos):a.delete(n.pos,n.pos+s.nodeSize),e.dispatch(a),!0}return!1}function dg(e,r,t){e.domObserver.stop(),r.contentEditable=t,e.domObserver.start()}function VC(e){if(!Ie||e.state.selection.$head.parentOffset>0)return!1;var r=e.domSelectionRange(),t=r.focusNode,n=r.focusOffset;if(t&&t.nodeType==1&&n==0&&t.firstChild&&t.firstChild.contentEditable=="false"){var i=t.firstChild;dg(e,i,"true"),setTimeout(function(){return dg(e,i,"false")},20)}return!1}function UC(e){var r="";return e.ctrlKey&&(r+="c"),e.metaKey&&(r+="m"),e.altKey&&(r+="a"),e.shiftKey&&(r+="s"),r}function KC(e,r){var t=r.keyCode,n=UC(r);if(t==8||Ge&&t==72&&n=="c")return fg(e,-1)||Mn(e,-1);if(t==46&&!r.shiftKey||Ge&&t==68&&n=="c")return fg(e,1)||Mn(e,1);if(t==13||t==27)return!0;if(t==37||Ge&&t==66&&n=="c"){var i=t==37?ug(e,e.state.selection.from)=="ltr"?-1:1:-1;return lg(e,i,n)||Mn(e,i)}else if(t==39||Ge&&t==70&&n=="c"){var o=t==39?ug(e,e.state.selection.from)=="ltr"?1:-1:1;return lg(e,o,n)||Mn(e,o)}else{if(t==38||Ge&&t==80&&n=="c")return cg(e,-1,n)||Mn(e,-1);if(t==40||Ge&&t==78&&n=="c")return VC(e)||cg(e,1,n)||Mn(e,1);if(n==(Ge?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function ic(e,r){e.someProp("transformCopied",function(g){r=g(r,e)});for(var t=[],n=r,i=n.content,o=n.openStart,s=n.openEnd;o>1&&s>1&&i.childCount==1&&i.firstChild.childCount==1;){o--,s--;var a=i.firstChild;t.push(a.type.name,a.attrs!=a.type.defaultAttrs?a.attrs:null),i=a.content}var l=e.someProp("clipboardSerializer")||ee.DOMSerializer.fromSchema(e.state.schema),u=Yg(),c=u.createElement("div");c.appendChild(l.serializeFragment(i,{document:u}));for(var f=c.firstChild,d,h=0;f&&f.nodeType==1&&(d=Xg[f.nodeName.toLowerCase()]);){for(var p=d.length-1;p>=0;p--){for(var m=u.createElement(d[p]);c.firstChild;)m.appendChild(c.firstChild);c.appendChild(m),h++}f=c.firstChild}f&&f.nodeType==1&&f.setAttribute("data-pm-slice","".concat(o," ").concat(s).concat(h?" -".concat(h):""," ").concat(JSON.stringify(t)));var v=e.someProp("clipboardTextSerializer",function(g){return g(r,e)})||r.content.textBetween(0,r.content.size,`

`);return{dom:c,text:v,slice:r}}function oc(e,r,t,n,i){var o=i.parent.type.spec.code,s,a;if(!t&&!r)return null;var l=!!r&&(n||o||!t);if(l){if(e.someProp("transformPastedText",function(x){r=x(r,o||n,e)}),o)return a=new ee.Slice(ee.Fragment.from(e.state.schema.text(r.replace(/\r\n?/g,`
`))),0,0),e.someProp("transformPasted",function(x){a=x(a,e,!0)}),a;var u=e.someProp("clipboardTextParser",function(x){return x(r,i,n,e)});if(u)a=u;else{var c=i.marks(),f=e.state.schema,d=ee.DOMSerializer.fromSchema(f);s=document.createElement("div"),r.split(/(?:\r\n?|\n)+/).forEach(function(x){var T=s.appendChild(document.createElement("p"));x&&T.appendChild(d.serializeNode(f.text(x,c)))})}}else e.someProp("transformPastedHTML",function(x){t=x(t,e)}),s=XC(t),Wi&&YC(s);var h=s&&s.querySelector("[data-pm-slice]"),p=h&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(h.getAttribute("data-pm-slice")||"");if(p&&p[3])for(var m=+p[3];m>0;m--){for(var v=s.firstChild;v&&v.nodeType!=1;)v=v.nextSibling;if(!v)break;s=v}if(!a){var g=e.someProp("clipboardParser")||e.someProp("domParser")||ee.DOMParser.fromSchema(e.state.schema);a=g.parseSlice(s,{preserveWhitespace:!!(l||p),context:i,ruleFromNode:function(T){return T.nodeName=="BR"&&!T.nextSibling&&T.parentNode&&!JC.test(T.parentNode.nodeName)?{ignore:!0}:null}})}if(p)a=QC(hg(a,+p[1],+p[2]),p[4]);else if(a=ee.Slice.maxOpen(ZC(a.content,i),!0),a.openStart||a.openEnd){for(var y=0,w=0,b=a.content.firstChild;y<a.openStart&&!b.type.spec.isolating;y++,b=b.firstChild);for(var k=a.content.lastChild;w<a.openEnd&&!k.type.spec.isolating;w++,k=k.lastChild);a=hg(a,y,w)}return e.someProp("transformPasted",function(x){a=x(a,e,l)}),a}var JC=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function ZC(e,r){if(e.childCount<2)return e;for(var t=function(){var s=r.node(i),a=s.contentMatchAt(r.index(i)),l,u=[];if(e.forEach(function(c){if(u){var f=a.findWrapping(c.type),d;if(!f)return u=null;if(d=u.length&&l.length&&Zg(f,l,c,u[u.length-1],0))u[u.length-1]=d;else{u.length&&(u[u.length-1]=Gg(u[u.length-1],l.length));var h=Jg(c,f);u.push(h),a=a.matchType(h.type),l=f}}}),u)return{v:ee.Fragment.from(u)}},n,i=r.depth;i>=0;i--)if(n=t(),n)return n.v;return e}function Jg(e,r){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=r.length-1;n>=t;n--)e=r[n].create(null,ee.Fragment.from(e));return e}function Zg(e,r,t,n,i){if(i<e.length&&i<r.length&&e[i]==r[i]){var o=Zg(e,r,t,n.lastChild,i+1);if(o)return n.copy(n.content.replaceChild(n.childCount-1,o));var s=n.contentMatchAt(n.childCount);if(s.matchType(i==e.length-1?t.type:e[i+1]))return n.copy(n.content.append(ee.Fragment.from(Jg(t,e,i+1))))}}function Gg(e,r){if(r==0)return e;var t=e.content.replaceChild(e.childCount-1,Gg(e.lastChild,r-1)),n=e.contentMatchAt(e.childCount).fillBefore(ee.Fragment.empty,!0);return e.copy(t.append(n))}function Qu(e,r,t,n,i,o){var s=r<0?e.firstChild:e.lastChild,a=s.content;return e.childCount>1&&(o=0),i<n-1&&(a=Qu(a,r,t,n,i+1,o)),i>=t&&(a=r<0?s.contentMatchAt(0).fillBefore(a,o<=i).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(ee.Fragment.empty,!0))),e.replaceChild(r<0?0:e.childCount-1,s.copy(a))}function hg(e,r,t){return r<e.openStart&&(e=new ee.Slice(Qu(e.content,-1,r,e.openStart,0,e.openEnd),r,e.openEnd)),t<e.openEnd&&(e=new ee.Slice(Qu(e.content,1,t,e.openEnd,0,0),e.openStart,t)),e}var Xg={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},pg=null;function Yg(){return pg||(pg=document.implementation.createHTMLDocument("title"))}var zu=null;function GC(e){var r=window.trustedTypes;return r?(zu||(zu=r.defaultPolicy||r.createPolicy("ProseMirrorClipboard",{createHTML:function(n){return n}})),zu.createHTML(e)):e}function XC(e){var r=/^(\s*<meta [^>]*>)*/.exec(e);r&&(e=e.slice(r[0].length));var t=Yg().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(e),i;if((i=n&&Xg[n[1].toLowerCase()])&&(e=i.map(function(s){return"<"+s+">"}).join("")+e+i.map(function(s){return"</"+s+">"}).reverse().join("")),t.innerHTML=GC(e),i)for(var o=0;o<i.length;o++)t=t.querySelector(i[o])||t;return t}function YC(e){for(var r=e.querySelectorAll(Me?"span:not([class]):not([style])":"span.Apple-converted-space"),t=0;t<r.length;t++){var n=r[t];n.childNodes.length==1&&n.textContent=="\xA0"&&n.parentNode&&n.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),n)}}function QC(e,r){if(!e.size)return e;var t=e.content.firstChild.type.schema,n;try{n=JSON.parse(r)}catch{return e}for(var i=e.content,o=e.openStart,s=e.openEnd,a=n.length-2;a>=0;a-=2){var l=t.nodes[n[a]];if(!l||l.hasRequiredAttrs())break;i=ee.Fragment.from(l.create(n[a+1],i)),o++,s++}return new ee.Slice(i,o,s)}var Le={},Fe={},eO={touchstart:!0,touchmove:!0},tO=se(function e(){oe(this,e),this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null});function rO(e){var r=function(){var i=Le[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=function(o){iO(e,o)&&!sc(e,o)&&(e.editable||!(o.type in Fe))&&i(e,o)},eO[t]?{passive:!0}:void 0)};for(var t in Le)r();Ie&&e.dom.addEventListener("input",function(){return null}),ec(e)}function pr(e,r){e.input.lastSelectionOrigin=r,e.input.lastSelectionTime=Date.now()}function nO(e){e.domObserver.stop();for(var r in e.input.eventHandlers)e.dom.removeEventListener(r,e.input.eventHandlers[r]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}function ec(e){e.someProp("handleDOMEvents",function(r){for(var t in r)e.input.eventHandlers[t]||e.dom.addEventListener(t,e.input.eventHandlers[t]=function(n){return sc(e,n)})})}function sc(e,r){return e.someProp("handleDOMEvents",function(t){var n=t[r.type];return n?n(e,r)||r.defaultPrevented:!1})}function iO(e,r){if(!r.bubbles)return!0;if(r.defaultPrevented)return!1;for(var t=r.target;t!=e.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(r))return!1;return!0}function oO(e,r){!sc(e,r)&&Le[r.type]&&(e.editable||!(r.type in Fe))&&Le[r.type](e,r)}Fe.keydown=function(e,r){var t=r;if(e.input.shiftKey=t.keyCode==16||t.shiftKey,!ev(e,t)&&(e.input.lastKeyCode=t.keyCode,e.input.lastKeyCodeTime=Date.now(),!(Kt&&Me&&t.keyCode==13)))if(t.keyCode!=229&&e.domObserver.forceFlush(),In&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){var n=Date.now();e.input.lastIOSEnter=n,e.input.lastIOSEnterFallbackTimeout=setTimeout(function(){e.input.lastIOSEnter==n&&(e.someProp("handleKeyDown",function(i){return i(e,Wr(13,"Enter"))}),e.input.lastIOSEnter=0)},200)}else e.someProp("handleKeyDown",function(i){return i(e,t)})||KC(e,t)?t.preventDefault():pr(e,"key")};Fe.keyup=function(e,r){r.keyCode==16&&(e.input.shiftKey=!1)};Fe.keypress=function(e,r){var t=r;if(!(ev(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||Ge&&t.metaKey)){if(e.someProp("handleKeyPress",function(s){return s(e,t)})){t.preventDefault();return}var n=e.state.selection;if(!(n instanceof R.TextSelection)||!n.$from.sameParent(n.$to)){var i=String.fromCharCode(t.charCode),o=function(){return e.state.tr.insertText(i).scrollIntoView()};!/[\r\n]/.test(i)&&!e.someProp("handleTextInput",function(s){return s(e,n.$from.pos,n.$to.pos,i,o)})&&e.dispatch(o()),t.preventDefault()}}};function Fs(e){return{left:e.clientX,top:e.clientY}}function sO(e,r){var t=r.x-e.clientX,n=r.y-e.clientY;return t*t+n*n<100}function ac(e,r,t,n,i){if(n==-1)return!1;for(var o=e.state.doc.resolve(n),s=function(c){if(e.someProp(r,function(f){return c>o.depth?f(e,t,o.nodeAfter,o.before(c),i,!0):f(e,t,o.node(c),o.before(c),i,!1)}))return{v:!0}},a,l=o.depth+1;l>0;l--)if(a=s(l),a)return a.v;return!1}function Pn(e,r,t){if(e.focused||e.focus(),!e.state.selection.eq(r)){var n=e.state.tr.setSelection(r);t=="pointer"&&n.setMeta("pointer",!0),e.dispatch(n)}}function aO(e,r){if(r==-1)return!1;var t=e.state.doc.resolve(r),n=t.nodeAfter;return n&&n.isAtom&&R.NodeSelection.isSelectable(n)?(Pn(e,new R.NodeSelection(t),"pointer"),!0):!1}function lO(e,r){if(r==-1)return!1;var t=e.state.selection,n,i;t instanceof R.NodeSelection&&(n=t.node);for(var o=e.state.doc.resolve(r),s=o.depth+1;s>0;s--){var a=s>o.depth?o.nodeAfter:o.node(s);if(R.NodeSelection.isSelectable(a)){n&&t.$from.depth>0&&s>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?i=o.before(t.$from.depth):i=o.before(s);break}}return i!=null?(Pn(e,R.NodeSelection.create(e.state.doc,i),"pointer"),!0):!1}function uO(e,r,t,n,i){return ac(e,"handleClickOn",r,t,n)||e.someProp("handleClick",function(o){return o(e,r,n)})||(i?lO(e,t):aO(e,t))}function cO(e,r,t,n){return ac(e,"handleDoubleClickOn",r,t,n)||e.someProp("handleDoubleClick",function(i){return i(e,r,n)})}function fO(e,r,t,n){return ac(e,"handleTripleClickOn",r,t,n)||e.someProp("handleTripleClick",function(i){return i(e,r,n)})||dO(e,t,n)}function dO(e,r,t){if(t.button!=0)return!1;var n=e.state.doc;if(r==-1)return n.inlineContent?(Pn(e,R.TextSelection.create(n,0,n.content.size),"pointer"),!0):!1;for(var i=n.resolve(r),o=i.depth+1;o>0;o--){var s=o>i.depth?i.nodeAfter:i.node(o),a=i.before(o);if(s.inlineContent)Pn(e,R.TextSelection.create(n,a+1,a+1+s.content.size),"pointer");else if(R.NodeSelection.isSelectable(s))Pn(e,R.NodeSelection.create(n,a),"pointer");else continue;return!0}}function lc(e){return zi(e)}var Qg=Ge?"metaKey":"ctrlKey";Le.mousedown=function(e,r){var t=r;e.input.shiftKey=t.shiftKey;var n=lc(e),i=Date.now(),o="singleClick";i-e.input.lastClick.time<500&&sO(t,e.input.lastClick)&&!t[Qg]&&e.input.lastClick.button==t.button&&(e.input.lastClick.type=="singleClick"?o="doubleClick":e.input.lastClick.type=="doubleClick"&&(o="tripleClick")),e.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:o,button:t.button};var s=e.posAtCoords(Fs(t));s&&(o=="singleClick"?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new hO(e,s,t,!!n)):(o=="doubleClick"?cO:fO)(e,s.pos,s.inside,t)?t.preventDefault():pr(e,"pointer"))};var hO=(function(){function e(r,t,n,i){var o=this;oe(this,e),this.view=r,this.pos=t,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=r.state.doc,this.selectNode=!!n[Qg],this.allowDefault=n.shiftKey;var s,a;if(t.inside>-1)s=r.state.doc.nodeAt(t.inside),a=t.inside;else{var l=r.state.doc.resolve(t.pos);s=l.parent,a=l.depth?l.before():0}var u=i?null:n.target,c=u?r.docView.nearestDesc(u,!0):null;this.target=c&&c.nodeDOM.nodeType==1?c.nodeDOM:null;var f=r.state.selection;(n.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||f instanceof R.NodeSelection&&f.from<=a&&f.to>a)&&(this.mightDrag={node:s,pos:a,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Ye&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(function(){o.view.input.mouseDown==o&&o.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),r.root.addEventListener("mouseup",this.up=this.up.bind(this)),r.root.addEventListener("mousemove",this.move=this.move.bind(this)),pr(r,"pointer")}return se(e,[{key:"done",value:function(){var t=this;this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(function(){return Jt(t.view)}),this.view.input.mouseDown=null}},{key:"up",value:function(t){if(this.done(),!!this.view.dom.contains(t.target)){var n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Fs(t))),this.updateAllowDefault(t),this.allowDefault||!n?pr(this.view,"pointer"):uO(this.view,n.pos,n.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||Ie&&this.mightDrag&&!this.mightDrag.node.isAtom||Me&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Pn(this.view,R.Selection.near(this.view.state.doc.resolve(n.pos)),"pointer"),t.preventDefault()):pr(this.view,"pointer")}}},{key:"move",value:function(t){this.updateAllowDefault(t),pr(this.view,"pointer"),t.buttons==0&&this.done()}},{key:"updateAllowDefault",value:function(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}]),e})();Le.touchstart=function(e){e.input.lastTouch=Date.now(),lc(e),pr(e,"pointer")};Le.touchmove=function(e){e.input.lastTouch=Date.now(),pr(e,"pointer")};Le.contextmenu=function(e){return lc(e)};function ev(e,r){return e.composing?!0:Ie&&Math.abs(r.timeStamp-e.input.compositionEndedAt)<500?(e.input.compositionEndedAt=-2e8,!0):!1}var pO=Kt?5e3:-1;Fe.compositionstart=Fe.compositionupdate=function(e){if(!e.composing){e.domObserver.flush();var r=e.state,t=r.selection.$to;if(r.selection instanceof R.TextSelection&&(r.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(function(l){return l.type.spec.inclusive===!1})))e.markCursor=e.state.storedMarks||t.marks(),zi(e,!0),e.markCursor=null;else if(zi(e,!r.selection.empty),Ye&&r.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length)for(var n=e.domSelectionRange(),i=n.focusNode,o=n.focusOffset;i&&i.nodeType==1&&o!=0;){var s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){var a=e.domSelection();a&&a.collapse(s,s.nodeValue.length);break}else i=s,o=-1}e.input.composing=!0}tv(e,pO)};Fe.compositionend=function(e,r){e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=r.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(function(){return e.domObserver.flush()}),e.input.compositionID++,tv(e,20))};function tv(e,r){clearTimeout(e.input.composingTimeout),r>-1&&(e.input.composingTimeout=setTimeout(function(){return zi(e)},r))}function rv(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=gO());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function mO(e){var r=e.domSelectionRange();if(!r.focusNode)return null;var t=aC(r.focusNode,r.focusOffset),n=lC(r.focusNode,r.focusOffset);if(t&&n&&t!=n){var i=n.pmViewDesc,o=e.domObserver.lastChangedTextNode;if(t==o||n==o)return o;if(!i||!i.isText(n.nodeValue))return n;if(e.input.compositionNode==n){var s=t.pmViewDesc;if(!(!s||!s.isText(t.nodeValue)))return n}}return t||n}function gO(){var e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}function zi(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!(Kt&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),rv(e),r||e.docView&&e.docView.dirty){var t=rc(e),n=e.state.selection;return t&&!t.eq(n)?e.dispatch(e.state.tr.setSelection(t)):(e.markCursor||r)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?e.dispatch(e.state.tr.deleteSelection()):e.updateState(e.state),!0}return!1}}function vO(e,r){if(e.dom.parentNode){var t=e.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(r),t.style.cssText="position: fixed; left: -10000px; top: 10px";var n=getSelection(),i=document.createRange();i.selectNodeContents(r),e.dom.blur(),n.removeAllRanges(),n.addRange(i),setTimeout(function(){t.parentNode&&t.parentNode.removeChild(t),e.focus()},50)}}var qi=$e&&mr<15||In&&hC<604;Le.copy=Fe.cut=function(e,r){var t=r,n=e.state.selection,i=t.type=="cut";if(!n.empty){var o=qi?null:t.clipboardData,s=n.content(),a=ic(e,s),l=a.dom,u=a.text;o?(t.preventDefault(),o.clearData(),o.setData("text/html",l.innerHTML),o.setData("text/plain",u)):vO(e,l),i&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}};function yO(e){return e.openStart==0&&e.openEnd==0&&e.content.childCount==1?e.content.firstChild:null}function bO(e,r){if(e.dom.parentNode){var t=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,n=e.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();var i=e.input.shiftKey&&e.input.lastKeyCode!=45;setTimeout(function(){e.focus(),n.parentNode&&n.parentNode.removeChild(n),t?ji(e,n.value,null,i,r):ji(e,n.textContent,n.innerHTML,i,r)},50)}}function ji(e,r,t,n,i){var o=oc(e,r,t,n,e.state.selection.$from);if(e.someProp("handlePaste",function(l){return l(e,i,o||ee.Slice.empty)}))return!0;if(!o)return!1;var s=yO(o),a=s?e.state.tr.replaceSelectionWith(s,n):e.state.tr.replaceSelection(o);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function nv(e){var r=e.getData("text/plain")||e.getData("Text");if(r)return r;var t=e.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Fe.paste=function(e,r){var t=r;if(!(e.composing&&!Kt)){var n=qi?null:t.clipboardData,i=e.input.shiftKey&&e.input.lastKeyCode!=45;n&&ji(e,nv(n),n.getData("text/html"),i,t)?t.preventDefault():bO(e,t)}};var iv=se(function e(r,t,n){oe(this,e),this.slice=r,this.move=t,this.node=n}),kO=Ge?"altKey":"ctrlKey";function ov(e,r){var t=e.someProp("dragCopies",function(n){return!n(r)});return t??!r[kO]}Le.dragstart=function(e,r){var t=r,n=e.input.mouseDown;if(n&&n.done(),!!t.dataTransfer){var i=e.state.selection,o=i.empty?null:e.posAtCoords(Fs(t)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof R.NodeSelection?i.to-1:i.to))){if(n&&n.mightDrag)s=R.NodeSelection.create(e.state.doc,n.mightDrag.pos);else if(t.target&&t.target.nodeType==1){var a=e.docView.nearestDesc(t.target,!0);a&&a.node.type.spec.draggable&&a!=e.docView&&(s=R.NodeSelection.create(e.state.doc,a.posBefore))}}var l=(s||e.state.selection).content(),u=ic(e,l),c=u.dom,f=u.text,d=u.slice;(!t.dataTransfer.files.length||!Me||Ng>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(qi?"Text":"text/html",c.innerHTML),t.dataTransfer.effectAllowed="copyMove",qi||t.dataTransfer.setData("text/plain",f),e.dragging=new iv(d,ov(e,t),s)}};Le.dragend=function(e){var r=e.dragging;window.setTimeout(function(){e.dragging==r&&(e.dragging=null)},50)};Fe.dragover=Fe.dragenter=function(e,r){return r.preventDefault()};Fe.drop=function(e,r){var t=r,n=e.dragging;if(e.dragging=null,!!t.dataTransfer){var i=e.posAtCoords(Fs(t));if(i){var o=e.state.doc.resolve(i.pos),s=n&&n.slice;s?e.someProp("transformPasted",function(v){s=v(s,e,!1)}):s=oc(e,nv(t.dataTransfer),qi?null:t.dataTransfer.getData("text/html"),!1,o);var a=!!(n&&ov(e,t));if(e.someProp("handleDrop",function(v){return v(e,t,s||ee.Slice.empty,a)})){t.preventDefault();return}if(s){t.preventDefault();var l=s?iC.dropPoint(e.state.doc,o.pos,s):o.pos;l==null&&(l=o.pos);var u=e.state.tr;if(a){var c=n.node;c?c.replace(u):u.deleteSelection()}var f=u.mapping.map(l),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,h=u.doc;if(d?u.replaceRangeWith(f,f,s.content.firstChild):u.replaceRange(f,f,s),!u.doc.eq(h)){var p=u.doc.resolve(f);if(d&&R.NodeSelection.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild))u.setSelection(new R.NodeSelection(p));else{var m=u.mapping.map(l);u.mapping.maps[u.mapping.maps.length-1].forEach(function(v,g,y,w){return m=w}),u.setSelection(nc(e,p,u.doc.resolve(m)))}e.focus(),e.dispatch(u.setMeta("uiEvent","drop"))}}}}};Le.focus=function(e){e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(function(){e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&Jt(e)},20))};Le.blur=function(e,r){var t=r;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),t.relatedTarget&&e.dom.contains(t.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)};Le.beforeinput=function(e,r){var t=r;if(Me&&Kt&&t.inputType=="deleteContentBackward"){e.domObserver.flushSoon();var n=e.input.domChangeCount;setTimeout(function(){if(e.input.domChangeCount==n&&(e.dom.blur(),e.focus(),!e.someProp("handleKeyDown",function(o){return o(e,Wr(8,"Backspace"))}))){var i=e.state.selection.$cursor;i&&i.pos>0&&e.dispatch(e.state.tr.delete(i.pos-1,i.pos).scrollIntoView())}},50)}};for(qu in Fe)Le[qu]=Fe[qu];var qu;function Hi(e,r){if(e==r)return!0;for(var t in e)if(e[t]!==r[t])return!1;for(var n in r)if(!(n in e))return!1;return!0}var mg=(function(){function e(r,t){oe(this,e),this.toDOM=r,this.spec=t||Kr,this.side=this.spec.side||0}return se(e,[{key:"map",value:function(t,n,i,o){var s=t.mapResult(n.from+o,this.side<0?-1:1),a=s.pos,l=s.deleted;return l?null:new Yr(a-i,a-i,this)}},{key:"valid",value:function(){return!0}},{key:"eq",value:function(t){return this==t||t instanceof e&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Hi(this.spec,t.spec))}},{key:"destroy",value:function(t){this.spec.destroy&&this.spec.destroy(t)}}]),e})(),Bi=(function(){function e(r,t){oe(this,e),this.attrs=r,this.spec=t||Kr}return se(e,[{key:"map",value:function(t,n,i,o){var s=t.map(n.from+o,this.spec.inclusiveStart?-1:1)-i,a=t.map(n.to+o,this.spec.inclusiveEnd?1:-1)-i;return s>=a?null:new Yr(s,a,this)}},{key:"valid",value:function(t,n){return n.from<n.to}},{key:"eq",value:function(t){return this==t||t instanceof e&&Hi(this.attrs,t.attrs)&&Hi(this.spec,t.spec)}},{key:"destroy",value:function(){}}],[{key:"is",value:function(t){return t.type instanceof e}}]),e})(),wO=(function(){function e(r,t){oe(this,e),this.attrs=r,this.spec=t||Kr}return se(e,[{key:"map",value:function(t,n,i,o){var s=t.mapResult(n.from+o,1);if(s.deleted)return null;var a=t.mapResult(n.to+o,-1);return a.deleted||a.pos<=s.pos?null:new Yr(s.pos-i,a.pos-i,this)}},{key:"valid",value:function(t,n){var i=t.content.findIndex(n.from),o=i.index,s=i.offset,a;return s==n.from&&!(a=t.child(o)).isText&&s+a.nodeSize==n.to}},{key:"eq",value:function(t){return this==t||t instanceof e&&Hi(this.attrs,t.attrs)&&Hi(this.spec,t.spec)}},{key:"destroy",value:function(){}}]),e})(),Yr=(function(){function e(r,t,n){oe(this,e),this.from=r,this.to=t,this.type=n}return se(e,[{key:"copy",value:function(t,n){return new e(t,n,this.type)}},{key:"eq",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this.type.eq(t.type)&&this.from+n==t.from&&this.to+n==t.to}},{key:"map",value:function(t,n,i){return this.type.map(t,this,n,i)}},{key:"spec",get:function(){return this.type.spec}},{key:"inline",get:function(){return this.type instanceof Bi}},{key:"widget",get:function(){return this.type instanceof mg}}],[{key:"widget",value:function(t,n,i){return new e(t,t,new mg(n,i))}},{key:"inline",value:function(t,n,i,o){return new e(t,n,new Bi(i,o))}},{key:"node",value:function(t,n,i,o){return new e(t,n,new wO(i,o))}}]),e})(),An=[],Kr={},ft=(function(){function e(r,t){oe(this,e),this.local=r.length?r:An,this.children=t.length?t:An}return se(e,[{key:"find",value:function(t,n,i){var o=[];return this.findInner(t??0,n??1e9,o,0,i),o}},{key:"findInner",value:function(t,n,i,o,s){for(var a=0;a<this.local.length;a++){var l=this.local[a];l.from<=n&&l.to>=t&&(!s||s(l.spec))&&i.push(l.copy(l.from+o,l.to+o))}for(var u=0;u<this.children.length;u+=3)if(this.children[u]<n&&this.children[u+1]>t){var c=this.children[u]+1;this.children[u+2].findInner(t-c,n-c,i,o+c,s)}}},{key:"map",value:function(t,n,i){return this==Oe||t.maps.length==0?this:this.mapInner(t,n,0,0,i||Kr)}},{key:"mapInner",value:function(t,n,i,o,s){for(var a,l=0;l<this.local.length;l++){var u=this.local[l].map(t,i,o);u&&u.type.valid(n,u)?(a||(a=[])).push(u):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?SO(this.children,a||[],t,n,i,o,s):a?new e(a.sort(Jr),An):Oe}},{key:"add",value:function(t,n){return n.length?this==Oe?e.create(t,n):this.addInner(t,n,0):this}},{key:"addInner",value:function(t,n,i){var o=this,s,a=0;t.forEach(function(c,f){var d=f+i,h;if(h=lv(n,c,d)){for(s||(s=o.children.slice());a<s.length&&s[a]<f;)a+=3;s[a]==f?s[a+2]=s[a+2].addInner(c,h,d+1):s.splice(a,0,f,f+c.nodeSize,Is(h,c,d+1,Kr)),a+=3}});for(var l=av(a?uv(n):n,-i),u=0;u<l.length;u++)l[u].type.valid(t,l[u])||l.splice(u--,1);return new e(l.length?this.local.concat(l).sort(Jr):this.local,s||this.children)}},{key:"remove",value:function(t){return t.length==0||this==Oe?this:this.removeInner(t,0)}},{key:"removeInner",value:function(t,n){for(var i=this.children,o=this.local,s=0;s<i.length;s+=3){for(var a=void 0,l=i[s]+n,u=i[s+1]+n,c=0,f;c<t.length;c++)(f=t[c])&&f.from>l&&f.to<u&&(t[c]=null,(a||(a=[])).push(f));if(a){i==this.children&&(i=this.children.slice());var d=i[s+2].removeInner(a,l+1);d!=Oe?i[s+2]=d:(i.splice(s,3),s-=3)}}if(o.length){for(var h=0,p;h<t.length;h++)if(p=t[h])for(var m=0;m<o.length;m++)o[m].eq(p,n)&&(o==this.local&&(o=this.local.slice()),o.splice(m--,1))}return i==this.children&&o==this.local?this:o.length||i.length?new e(o,i):Oe}},{key:"forChild",value:function(t,n){if(this==Oe)return this;if(n.isLeaf)return e.empty;for(var i,o,s=0;s<this.children.length;s+=3)if(this.children[s]>=t){this.children[s]==t&&(i=this.children[s+2]);break}for(var a=t+1,l=a+n.content.size,u=0;u<this.local.length;u++){var c=this.local[u];if(c.from<l&&c.to>a&&c.type instanceof Bi){var f=Math.max(a,c.from)-a,d=Math.min(l,c.to)-a;f<d&&(o||(o=[])).push(c.copy(f,d))}}if(o){var h=new e(o.sort(Jr),An);return i?new sv([h,i]):h}return i||Oe}},{key:"eq",value:function(t){if(this==t)return!0;if(!(t instanceof e)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var n=0;n<this.local.length;n++)if(!this.local[n].eq(t.local[n]))return!1;for(var i=0;i<this.children.length;i+=3)if(this.children[i]!=t.children[i]||this.children[i+1]!=t.children[i+1]||!this.children[i+2].eq(t.children[i+2]))return!1;return!0}},{key:"locals",value:function(t){return uc(this.localsInner(t))}},{key:"localsInner",value:function(t){if(this==Oe)return An;if(t.inlineContent||!this.local.some(Bi.is))return this.local;for(var n=[],i=0;i<this.local.length;i++)this.local[i].type instanceof Bi||n.push(this.local[i]);return n}},{key:"forEachSet",value:function(t){t(this)}}],[{key:"create",value:function(t,n){return n.length?Is(n,t,0,Kr):Oe}}]),e})();ft.empty=new ft([],[]);ft.removeOverlap=uc;var Oe=ft.empty,sv=(function(){function e(r){oe(this,e),this.members=r}return se(e,[{key:"map",value:function(t,n){var i=this.members.map(function(o){return o.map(t,n,Kr)});return e.from(i)}},{key:"forChild",value:function(t,n){if(n.isLeaf)return ft.empty;for(var i=[],o=0;o<this.members.length;o++){var s=this.members[o].forChild(t,n);s!=Oe&&(s instanceof e?i=i.concat(s.members):i.push(s))}return e.from(i)}},{key:"eq",value:function(t){if(!(t instanceof e)||t.members.length!=this.members.length)return!1;for(var n=0;n<this.members.length;n++)if(!this.members[n].eq(t.members[n]))return!1;return!0}},{key:"locals",value:function(t){for(var n,i=!0,o=0;o<this.members.length;o++){var s=this.members[o].localsInner(t);if(s.length)if(!n)n=s;else{i&&(n=n.slice(),i=!1);for(var a=0;a<s.length;a++)n.push(s[a])}}return n?uc(i?n:n.sort(Jr)):An}},{key:"forEachSet",value:function(t){for(var n=0;n<this.members.length;n++)this.members[n].forEachSet(t)}}],[{key:"from",value:function(t){switch(t.length){case 0:return Oe;case 1:return t[0];default:return new e(t.every(function(n){return n instanceof ft})?t:t.reduce(function(n,i){return n.concat(i instanceof ft?i:i.members)},[]))}}}]),e})();function SO(e,r,t,n,i,o,s){for(var a=e.slice(),l=function(U){var V=0;t.maps[u].forEach(function(Z,Pe,z,ar){for(var yt=ar-z-(Pe-Z),Re=0;Re<a.length;Re+=3){var np=a[Re+1];if(!(np<0||Z>np+U-V)){var ip=a[Re]+U-V;Pe>=ip?a[Re+1]=Z<=ip?-2:-1:Z>=U&&yt&&(a[Re]+=yt,a[Re+1]+=yt)}}V+=yt}),U=t.maps[u].map(U,-1),c=U},u=0,c=o;u<t.maps.length;u++)l(c);for(var f=!1,d=0;d<a.length;d+=3)if(a[d+1]<0){if(a[d+1]==-2){f=!0,a[d+1]=-1;continue}var h=t.map(e[d]+o),p=h-i;if(p<0||p>=n.content.size){f=!0;continue}var m=t.map(e[d+1]+o,-1),v=m-i,g=n.content.findIndex(p),y=g.index,w=g.offset,b=n.maybeChild(y);if(b&&w==p&&w+b.nodeSize==v){var k=a[d+2].mapInner(t,b,h+1,e[d]+o+1,s);k!=Oe?(a[d]=p,a[d+1]=v,a[d+2]=k):(a[d+1]=-2,f=!0)}else f=!0}if(f){var x=xO(a,e,r,t,i,o,s),T=Is(x,n,0,s);r=T.local;for(var _=0;_<a.length;_+=3)a[_+1]<0&&(a.splice(_,3),_-=3);for(var C=0,A=0;C<T.children.length;C+=3){for(var O=T.children[C];A<a.length&&a[A]<O;)A+=3;a.splice(A,0,T.children[C],T.children[C+1],T.children[C+2])}}return new ft(r.sort(Jr),a)}function av(e,r){if(!r||!e.length)return e;for(var t=[],n=0;n<e.length;n++){var i=e[n];t.push(new Yr(i.from+r,i.to+r,i.type))}return t}function xO(e,r,t,n,i,o,s){function a(u,c){for(var f=0;f<u.local.length;f++){var d=u.local[f].map(n,i,c);d?t.push(d):s.onRemove&&s.onRemove(u.local[f].spec)}for(var h=0;h<u.children.length;h+=3)a(u.children[h+2],u.children[h]+c+1)}for(var l=0;l<e.length;l+=3)e[l+1]==-1&&a(e[l+2],r[l]+o+1);return t}function lv(e,r,t){if(r.isLeaf)return null;for(var n=t+r.nodeSize,i=null,o=0,s;o<e.length;o++)(s=e[o])&&s.from>t&&s.to<n&&((i||(i=[])).push(s),e[o]=null);return i}function uv(e){for(var r=[],t=0;t<e.length;t++)e[t]!=null&&r.push(e[t]);return r}function Is(e,r,t,n){var i=[],o=!1;r.forEach(function(l,u){var c=lv(e,l,u+t);if(c){o=!0;var f=Is(c,l,t+u+1,n);f!=Oe&&i.push(u,u+l.nodeSize,f)}});for(var s=av(o?uv(e):e,-t).sort(Jr),a=0;a<s.length;a++)s[a].type.valid(r,s[a])||(n.onRemove&&n.onRemove(s[a].spec),s.splice(a--,1));return s.length||i.length?new ft(s,i):Oe}function Jr(e,r){return e.from-r.from||e.to-r.to}function uc(e){for(var r=e,t=0;t<r.length-1;t++){var n=r[t];if(n.from!=n.to)for(var i=t+1;i<r.length;i++){var o=r[i];if(o.from==n.from){o.to!=n.to&&(r==e&&(r=e.slice()),r[i]=o.copy(o.from,n.to),gg(r,i+1,o.copy(n.to,o.to)));continue}else{o.from<n.to&&(r==e&&(r=e.slice()),r[t]=n.copy(n.from,o.from),gg(r,i,n.copy(o.from,n.to)));break}}}return r}function gg(e,r,t){for(;r<e.length&&Jr(t,e[r])>0;)r++;e.splice(r,0,t)}function ju(e){var r=[];return e.someProp("decorations",function(t){var n=t(e.state);n&&n!=Oe&&r.push(n)}),e.cursorWrapper&&r.push(ft.create(e.state.doc,[e.cursorWrapper.deco])),sv.from(r)}var _O={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},TO=$e&&mr<=11,EO=(function(){function e(){oe(this,e),this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}return se(e,[{key:"set",value:function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}},{key:"clear",value:function(){this.anchorNode=this.focusNode=null}},{key:"eq",value:function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}]),e})(),CO=(function(){function e(r,t){var n=this;oe(this,e),this.view=r,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new EO,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(function(i){for(var o=0;o<i.length;o++)n.queue.push(i[o]);$e&&mr<=11&&i.some(function(s){return s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length})?n.flushSoon():n.flush()}),TO&&(this.onCharData=function(i){n.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}return se(e,[{key:"flushSoon",value:function(){var t=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(function(){t.flushingSoon=-1,t.flush()},20))}},{key:"forceFlush",value:function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}},{key:"start",value:function(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,_O)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}},{key:"stop",value:function(){var t=this;if(this.observer){var n=this.observer.takeRecords();if(n.length){for(var i=0;i<n.length;i++)this.queue.push(n[i]);window.setTimeout(function(){return t.flush()},20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}},{key:"connectSelection",value:function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}},{key:"disconnectSelection",value:function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}},{key:"suppressSelectionUpdates",value:function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout(function(){return t.suppressingSelectionUpdates=!1},50)}},{key:"onSelectionChange",value:function(){if(ag(this.view)){if(this.suppressingSelectionUpdates)return Jt(this.view);if($e&&mr<=11&&!this.view.state.selection.empty){var t=this.view.domSelectionRange();if(t.focusNode&&Zr(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}},{key:"setCurSelection",value:function(){this.currentSelection.set(this.view.domSelectionRange())}},{key:"ignoreSelectionChange",value:function(t){if(!t.focusNode)return!0;for(var n=new Set,i,o=t.focusNode;o;o=Dn(o))n.add(o);for(var s=t.anchorNode;s;s=Dn(s))if(n.has(s)){i=s;break}var a=i&&this.view.docView.nearestDesc(i);if(a&&a.ignoreMutation({type:"selection",target:i.nodeType==3?i.parentNode:i}))return this.setCurSelection(),!0}},{key:"pendingRecords",value:function(){if(this.observer){var t=$u(this.observer.takeRecords()),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;this.queue.push(i)}}catch(o){t.e(o)}finally{t.f()}}return this.queue}},{key:"flush",value:function(){var t=this.view;if(!(!t.docView||this.flushingSoon>-1)){var n=this.pendingRecords();n.length&&(this.queue=[]);var i=t.domSelectionRange(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(i)&&ag(t)&&!this.ignoreSelectionChange(i),s=-1,a=-1,l=!1,u=[];if(t.editable)for(var c=0;c<n.length;c++){var f=this.registerMutation(n[c],u);f&&(s=s<0?f.from:Math.min(f.from,s),a=a<0?f.to:Math.max(f.to,a),f.typeOver&&(l=!0))}if(Ye&&u.length){var d=u.filter(function(x){return x.nodeName=="BR"});if(d.length==2){var h=Cg(d,2),p=h[0],m=h[1];p.parentNode&&p.parentNode.parentNode==m.parentNode?m.remove():p.remove()}else{var v=this.currentSelection.focusNode,g=$u(d),y;try{for(g.s();!(y=g.n()).done;){var w=y.value,b=w.parentNode;b&&b.nodeName=="LI"&&(!v||AO(t,v)!=b)&&w.remove()}}catch(x){g.e(x)}finally{g.f()}}}var k=null;s<0&&o&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&Ls(i)&&(k=rc(t))&&k.eq(R.Selection.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,Jt(t),this.currentSelection.set(i),t.scrollToSelection()):(s>-1||o)&&(s>-1&&(t.docView.markDirty(s,a),OO(t)),this.handleDOMChange(s,a,l,u),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(i)||Jt(t),this.currentSelection.set(i))}}},{key:"registerMutation",value:function(t,n){if(n.indexOf(t.target)>-1)return null;var i=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(i==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!i||i.ignoreMutation(t))return null;if(t.type=="childList"){for(var o=0;o<t.addedNodes.length;o++){var s=t.addedNodes[o];n.push(s),s.nodeType==3&&(this.lastChangedTextNode=s)}if(i.contentDOM&&i.contentDOM!=i.dom&&!i.contentDOM.contains(t.target))return{from:i.posBefore,to:i.posAfter};var a=t.previousSibling,l=t.nextSibling;if($e&&mr<=11&&t.addedNodes.length)for(var u=0;u<t.addedNodes.length;u++){var c=t.addedNodes[u],f=c.previousSibling,d=c.nextSibling;(!f||Array.prototype.indexOf.call(t.addedNodes,f)<0)&&(a=f),(!d||Array.prototype.indexOf.call(t.addedNodes,d)<0)&&(l=d)}var h=a&&a.parentNode==t.target?ke(a)+1:0,p=i.localPosFromDOM(t.target,h,-1),m=l&&l.parentNode==t.target?ke(l):t.target.childNodes.length,v=i.localPosFromDOM(t.target,m,1);return{from:p,to:v}}else return t.type=="attributes"?{from:i.posAtStart-i.border,to:i.posAtEnd+i.border}:(this.lastChangedTextNode=t.target,{from:i.posAtStart,to:i.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}]),e})(),vg=new WeakMap,yg=!1;function OO(e){if(!vg.has(e)&&(vg.set(e,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)!==-1)){if(e.requiresGeckoHackNode=Ye,yg)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),yg=!0}}function bg(e,r){var t=r.startContainer,n=r.startOffset,i=r.endContainer,o=r.endOffset,s=e.domAtPos(e.state.selection.anchor);if(Zr(s.node,s.offset,i,o)){var a=[i,o,t,n];t=a[0],n=a[1],i=a[2],o=a[3]}return{anchorNode:t,anchorOffset:n,focusNode:i,focusOffset:o}}function MO(e,r){if(r.getComposedRanges){var t=r.getComposedRanges(e.root)[0];if(t)return bg(e,t)}var n;function i(o){o.preventDefault(),o.stopImmediatePropagation(),n=o.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",i,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",i,!0),n?bg(e,n):null}function AO(e,r){for(var t=r.parentNode;t&&t!=e.dom;t=t.parentNode){var n=e.docView.nearestDesc(t,!0);if(n&&n.node.isBlock)return t}return null}function NO(e,r,t){var n=e.docView.parseRange(r,t),i=n.node,o=n.fromOffset,s=n.toOffset,a=n.from,l=n.to,u=e.domSelectionRange(),c,f=u.anchorNode;if(f&&e.dom.contains(f.nodeType==1?f:f.parentNode)&&(c=[{node:f,offset:u.anchorOffset}],Ls(u)||c.push({node:u.focusNode,offset:u.focusOffset})),Me&&e.input.lastKeyCode===8)for(var d=s;d>o;d--){var h=i.childNodes[d-1],p=h.pmViewDesc;if(h.nodeName=="BR"&&!p){s=d;break}if(!p||p.size)break}var m=e.state.doc,v=e.someProp("domParser")||ee.DOMParser.fromSchema(e.state.schema),g=m.resolve(a),y=null,w=v.parse(i,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:o,to:s,preserveWhitespace:g.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:PO,context:g});if(c&&c[0].pos!=null){var b=c[0].pos,k=c[1]&&c[1].pos;k==null&&(k=b),y={anchor:b+a,head:k+a}}return{doc:w,sel:y,from:a,to:l}}function PO(e){var r=e.pmViewDesc;if(r)return r.parseRule();if(e.nodeName=="BR"&&e.parentNode){if(Ie&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){var t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(e.parentNode.lastChild==e||Ie&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if(e.nodeName=="IMG"&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}var RO=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function DO(e,r,t,n,i){var o=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,r<0){var s=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,a=rc(e,s);if(a&&!e.state.selection.eq(a)){if(Me&&Kt&&e.input.lastKeyCode===13&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",function(z){return z(e,Wr(13,"Enter"))}))return;var l=e.state.tr.setSelection(a);s=="pointer"?l.setMeta("pointer",!0):s=="key"&&l.scrollIntoView(),o&&l.setMeta("composition",o),e.dispatch(l)}return}var u=e.state.doc.resolve(r),c=u.sharedDepth(t);r=u.before(c+1),t=e.state.doc.resolve(t).after(c+1);var f=e.state.selection,d=NO(e,r,t),h=e.state.doc,p=h.slice(d.from,d.to),m,v;e.input.lastKeyCode===8&&Date.now()-100<e.input.lastKeyCodeTime?(m=e.state.selection.to,v="end"):(m=e.state.selection.from,v="start"),e.input.lastKeyCode=null;var g=FO(p.content,d.doc.content,d.from,m,v);if(g&&e.input.domChangeCount++,(In&&e.input.lastIOSEnter>Date.now()-225||Kt)&&i.some(function(z){return z.nodeType==1&&!RO.test(z.nodeName)})&&(!g||g.endA>=g.endB)&&e.someProp("handleKeyDown",function(z){return z(e,Wr(13,"Enter"))})){e.input.lastIOSEnter=0;return}if(!g)if(n&&f instanceof R.TextSelection&&!f.empty&&f.$head.sameParent(f.$anchor)&&!e.composing&&!(d.sel&&d.sel.anchor!=d.sel.head))g={start:f.from,endA:f.to,endB:f.to};else{if(d.sel){var y=kg(e,e.state.doc,d.sel);if(y&&!y.eq(e.state.selection)){var w=e.state.tr.setSelection(y);o&&w.setMeta("composition",o),e.dispatch(w)}}return}e.state.selection.from<e.state.selection.to&&g.start==g.endB&&e.state.selection instanceof R.TextSelection&&(g.start>e.state.selection.from&&g.start<=e.state.selection.from+2&&e.state.selection.from>=d.from?g.start=e.state.selection.from:g.endA<e.state.selection.to&&g.endA>=e.state.selection.to-2&&e.state.selection.to<=d.to&&(g.endB+=e.state.selection.to-g.endA,g.endA=e.state.selection.to)),$e&&mr<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>d.from&&d.doc.textBetween(g.start-d.from-1,g.start-d.from+1)==" \xA0"&&(g.start--,g.endA--,g.endB--);var b=d.doc.resolveNoCache(g.start-d.from),k=d.doc.resolveNoCache(g.endB-d.from),x=h.resolve(g.start),T=b.sameParent(k)&&b.parent.inlineContent&&x.end()>=g.endA;if((In&&e.input.lastIOSEnter>Date.now()-225&&(!T||i.some(function(z){return z.nodeName=="DIV"||z.nodeName=="P"}))||!T&&b.pos<d.doc.content.size&&(!b.sameParent(k)||!b.parent.inlineContent)&&b.pos<k.pos&&!/\S/.test(d.doc.textBetween(b.pos,k.pos,"","")))&&e.someProp("handleKeyDown",function(z){return z(e,Wr(13,"Enter"))})){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>g.start&&LO(h,g.start,g.endA,b,k)&&e.someProp("handleKeyDown",function(z){return z(e,Wr(8,"Backspace"))})){Kt&&Me&&e.domObserver.suppressSelectionUpdates();return}Me&&g.endB==g.start&&(e.input.lastChromeDelete=Date.now()),Kt&&!T&&b.start()!=k.start()&&k.parentOffset==0&&b.depth==k.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==g.endA&&(g.endB-=2,k=d.doc.resolveNoCache(g.endB-d.from),setTimeout(function(){e.someProp("handleKeyDown",function(z){return z(e,Wr(13,"Enter"))})},20));var _=g.start,C=g.endA,A=function(ar){var yt=ar||e.state.tr.replace(_,C,d.doc.slice(g.start-d.from,g.endB-d.from));if(d.sel){var Re=kg(e,yt.doc,d.sel);Re&&!(Me&&e.composing&&Re.empty&&(g.start!=g.endB||e.input.lastChromeDelete<Date.now()-100)&&(Re.head==_||Re.head==yt.mapping.map(C)-1)||$e&&Re.empty&&Re.head==_)&&yt.setSelection(Re)}return o&&yt.setMeta("composition",o),yt.scrollIntoView()},O;if(T)if(b.pos==k.pos){$e&&mr<=11&&b.parentOffset==0&&(e.domObserver.suppressSelectionUpdates(),setTimeout(function(){return Jt(e)},20));var B=A(e.state.tr.delete(_,C)),U=h.resolve(g.start).marksAcross(h.resolve(g.endA));U&&B.ensureMarks(U),e.dispatch(B)}else if(g.endA==g.endB&&(O=IO(b.parent.content.cut(b.parentOffset,k.parentOffset),x.parent.content.cut(x.parentOffset,g.endA-x.start())))){var V=A(e.state.tr);O.type=="add"?V.addMark(_,C,O.mark):V.removeMark(_,C,O.mark),e.dispatch(V)}else if(b.parent.child(b.index()).isText&&b.index()==k.index()-(k.textOffset?0:1)){var Z=b.parent.textBetween(b.parentOffset,k.parentOffset),Pe=function(){return A(e.state.tr.insertText(Z,_,C))};e.someProp("handleTextInput",function(z){return z(e,_,C,Z,Pe)})||e.dispatch(Pe())}else e.dispatch(A());else e.dispatch(A())}function kg(e,r,t){return Math.max(t.anchor,t.head)>r.content.size?null:nc(e,r.resolve(t.anchor),r.resolve(t.head))}function IO(e,r){for(var t=e.firstChild.marks,n=r.firstChild.marks,i=t,o=n,s,a,l,u=0;u<n.length;u++)i=n[u].removeFromSet(i);for(var c=0;c<t.length;c++)o=t[c].removeFromSet(o);if(i.length==1&&o.length==0)a=i[0],s="add",l=function(p){return p.mark(a.addToSet(p.marks))};else if(i.length==0&&o.length==1)a=o[0],s="remove",l=function(p){return p.mark(a.removeFromSet(p.marks))};else return null;for(var f=[],d=0;d<r.childCount;d++)f.push(l(r.child(d)));if(ee.Fragment.from(f).eq(e))return{mark:a,type:s}}function LO(e,r,t,n,i){if(t-r<=i.pos-n.pos||Hu(n,!0,!1)<i.pos)return!1;var o=e.resolve(r);if(!n.parent.isTextblock){var s=o.nodeAfter;return s!=null&&t==r+s.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;var a=e.resolve(Hu(o,!0,!0));return!a.parent.isTextblock||a.pos>t||Hu(a,!0,!1)<t?!1:n.parent.content.cut(n.parentOffset).eq(a.parent.content)}function Hu(e,r,t){for(var n=e.depth,i=r?e.end():e.pos;n>0&&(r||e.indexAfter(n)==e.node(n).childCount);)n--,i++,r=!1;if(t)for(var o=e.node(n).maybeChild(e.indexAfter(n));o&&!o.isLeaf;)o=o.firstChild,i++;return i}function FO(e,r,t,n,i){var o=e.findDiffStart(r,t);if(o==null)return null;var s=e.findDiffEnd(r,t+e.size,t+r.size),a=s.a,l=s.b;if(i=="end"){var u=Math.max(0,o-Math.min(a,l));n-=a+u-o}if(a<o&&e.size<r.size){var c=n<=o&&n>=a?o-n:0;o-=c,o&&o<r.size&&wg(r.textBetween(o-1,o+1))&&(o+=c?1:-1),l=o+(l-a),a=o}else if(l<o){var f=n<=o&&n>=l?o-n:0;o-=f,o&&o<e.size&&wg(e.textBetween(o-1,o+1))&&(o+=f?1:-1),a=o+(a-l),l=o}return{start:o,endA:a,endB:l}}function wg(e){if(e.length!=2)return!1;var r=e.charCodeAt(0),t=e.charCodeAt(1);return r>=56320&&r<=57343&&t>=55296&&t<=56319}var BO=oc,zO=zi,cv=(function(){function e(r,t){var n=this;oe(this,e),this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new tO,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Eg),this.dispatch=this.dispatch.bind(this),this.dom=r&&r.mount||document.createElement("div"),r&&(r.appendChild?r.appendChild(this.dom):typeof r=="function"?r(this.dom):r.mount&&(this.mounted=!0)),this.editable=_g(this),xg(this),this.nodeViews=Tg(this),this.docView=tg(this.state.doc,Sg(this),ju(this),this.dom,this),this.domObserver=new CO(this,function(i,o,s,a){return DO(n,i,o,s,a)}),this.domObserver.start(),rO(this),this.updatePluginViews()}return se(e,[{key:"composing",get:function(){return this.input.composing}},{key:"props",get:function(){if(this._props.state!=this.state){var t=this._props;this._props={};for(var n in t)this._props[n]=t[n];this._props.state=this.state}return this._props}},{key:"update",value:function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&ec(this);var n=this._props;this._props=t,t.plugins&&(t.plugins.forEach(Eg),this.directPlugins=t.plugins),this.updateStateInner(t.state,n)}},{key:"setProps",value:function(t){var n={};for(var i in this._props)n[i]=this._props[i];n.state=this.state;for(var o in t)n[o]=t[o];this.update(n)}},{key:"updateState",value:function(t){this.updateStateInner(t,this._props)}},{key:"updateStateInner",value:function(t,n){var i,o=this.state,s=!1,a=!1;t.storedMarks&&this.composing&&(rv(this),a=!0),this.state=t;var l=o.plugins!=t.plugins||this._props.plugins!=n.plugins;if(l||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){var u=Tg(this);jO(u,this.nodeViews)&&(this.nodeViews=u,s=!0)}(l||n.handleDOMEvents!=this._props.handleDOMEvents)&&ec(this),this.editable=_g(this),xg(this);var c=ju(this),f=Sg(this),d=o.plugins!=t.plugins&&!o.doc.eq(t.doc)?"reset":t.scrollToSelection>o.scrollToSelection?"to selection":"preserve",h=s||!this.docView.matchesNode(t.doc,f,c);(h||!t.selection.eq(o.selection))&&(a=!0);var p=d=="preserve"&&a&&this.dom.style.overflowAnchor==null&&gC(this);if(a){this.domObserver.stop();var m=h&&($e||Me)&&!this.composing&&!o.selection.empty&&!t.selection.empty&&qO(o.selection,t.selection);if(h){var v=Me?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=mO(this)),(s||!this.docView.update(t.doc,f,c,this))&&(this.docView.updateOuterDeco(f),this.docView.destroy(),this.docView=tg(t.doc,f,c,this.dom,this)),v&&!this.trackWrites&&(m=!0)}m||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&qC(this))?Jt(this,m):(Vg(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(o),!((i=this.dragging)===null||i===void 0)&&i.node&&!o.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,o),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():p&&vC(p)}},{key:"scrollToSelection",value:function(){var t=this,n=this.domSelectionRange().focusNode;if(!(!n||!this.dom.contains(n.nodeType==1?n:n.parentNode))){if(!this.someProp("handleScrollToSelection",function(o){return o(t)}))if(this.state.selection instanceof R.NodeSelection){var i=this.docView.domAfterPos(this.state.selection.from);i.nodeType==1&&Zm(this,i.getBoundingClientRect(),n)}else Zm(this,this.coordsAtPos(this.state.selection.head,1),n)}}},{key:"destroyPluginViews",value:function(){for(var t;t=this.pluginViews.pop();)t.destroy&&t.destroy()}},{key:"updatePluginViews",value:function(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(var n=0;n<this.directPlugins.length;n++){var i=this.directPlugins[n];i.spec.view&&this.pluginViews.push(i.spec.view(this))}for(var o=0;o<this.state.plugins.length;o++){var s=this.state.plugins[o];s.spec.view&&this.pluginViews.push(s.spec.view(this))}}else for(var a=0;a<this.pluginViews.length;a++){var l=this.pluginViews[a];l.update&&l.update(this,t)}}},{key:"updateDraggedNode",value:function(t,n){var i=t.node,o=-1;if(this.state.doc.nodeAt(i.from)==i.node)o=i.from;else{var s=i.from+(this.state.doc.content.size-n.doc.content.size),a=s>0&&this.state.doc.nodeAt(s);a==i.node&&(o=s)}this.dragging=new iv(t.slice,t.move,o<0?void 0:R.NodeSelection.create(this.state.doc,o))}},{key:"someProp",value:function(t,n){var i=this._props&&this._props[t],o;if(i!=null&&(o=n?n(i):i))return o;for(var s=0;s<this.directPlugins.length;s++){var a=this.directPlugins[s].props[t];if(a!=null&&(o=n?n(a):a))return o}var l=this.state.plugins;if(l)for(var u=0;u<l.length;u++){var c=l[u].props[t];if(c!=null&&(o=n?n(c):c))return o}}},{key:"hasFocus",value:function(){if($e){var t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}},{key:"focus",value:function(){this.domObserver.stop(),this.editable&&yC(this.dom),Jt(this),this.domObserver.start()}},{key:"root",get:function(){var t=this,n=this._root;if(n==null){for(var i=function(l){if(l.nodeType==9||l.nodeType==11&&l.host)return l.getSelection||(Object.getPrototypeOf(l).getSelection=function(){return l.ownerDocument.getSelection()}),{v:t._root=l}},o,s=this.dom.parentNode;s;s=s.parentNode)if(o=i(s),o)return o.v}return n||document}},{key:"updateRoot",value:function(){this._root=null}},{key:"posAtCoords",value:function(t){return xC(this,t)}},{key:"coordsAtPos",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return Lg(this,t,n)}},{key:"domAtPos",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this.docView.domFromPos(t,n)}},{key:"nodeDOM",value:function(t){var n=this.docView.descAt(t);return n?n.nodeDOM:null}},{key:"posAtDOM",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=this.docView.posFromDOM(t,n,i);if(o==null)throw new RangeError("DOM position not inside the editor");return o}},{key:"endOfTextblock",value:function(t,n){return OC(this,n||this.state,t)}},{key:"pasteHTML",value:function(t,n){return ji(this,"",t,!1,n||new ClipboardEvent("paste"))}},{key:"pasteText",value:function(t,n){return ji(this,t,null,!0,n||new ClipboardEvent("paste"))}},{key:"serializeForClipboard",value:function(t){return ic(this,t)}},{key:"destroy",value:function(){this.docView&&(nO(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ju(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,oC())}},{key:"isDestroyed",get:function(){return this.docView==null}},{key:"dispatchEvent",value:function(t){return oO(this,t)}},{key:"domSelectionRange",value:function(){var t=this.domSelection();return t?Ie&&this.root.nodeType===11&&cC(this.dom.ownerDocument)==this.dom&&MO(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}},{key:"domSelection",value:function(){return this.root.getSelection()}}]),e})();cv.prototype.dispatch=function(e){var r=this._props.dispatchTransaction;r?r.call(this,e):this.updateState(this.state.apply(e))};function Sg(e){var r=Object.create(null);return r.class="ProseMirror",r.contenteditable=String(e.editable),e.someProp("attributes",function(t){if(typeof t=="function"&&(t=t(e.state)),t)for(var n in t)n=="class"?r.class+=" "+t[n]:n=="style"?r.style=(r.style?r.style+";":"")+t[n]:!r[n]&&n!="contenteditable"&&n!="nodeName"&&(r[n]=String(t[n]))}),r.translate||(r.translate="no"),[Yr.node(0,e.state.doc.content.size,r)]}function xg(e){if(e.markCursor){var r=document.createElement("img");r.className="ProseMirror-separator",r.setAttribute("mark-placeholder","true"),r.setAttribute("alt",""),e.cursorWrapper={dom:r,deco:Yr.widget(e.state.selection.from,r,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function _g(e){return!e.someProp("editable",function(r){return r(e.state)===!1})}function qO(e,r){var t=Math.min(e.$anchor.sharedDepth(e.head),r.$anchor.sharedDepth(r.head));return e.$anchor.start(t)!=r.$anchor.start(t)}function Tg(e){var r=Object.create(null);function t(n){for(var i in n)Object.prototype.hasOwnProperty.call(r,i)||(r[i]=n[i])}return e.someProp("nodeViews",t),e.someProp("markViews",t),r}function jO(e,r){var t=0,n=0;for(var i in e){if(e[i]!=r[i])return!0;t++}for(var o in r)n++;return t!=n}function Eg(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}Ln.Decoration=Yr;Ln.DecorationSet=ft;Ln.EditorView=cv;Ln.__endComposition=zO;Ln.__parseFromClipboard=BO});var Ui=S(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});function HO(e){Object.keys(e).filter(r=>r!=="default"&&r!=="__esModule").forEach(r=>{Bs.hasOwnProperty(r)||Object.defineProperty(Bs,r,{enumerable:!0,configurable:!0,get:()=>e[r]})})}var $O=cc();HO($O)});var fv=S(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});var vr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Ki={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},WO=typeof navigator<"u"&&/Mac/.test(navigator.platform),VO=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(le=0;le<10;le++)vr[48+le]=vr[96+le]=String(le);var le;for(le=1;le<=24;le++)vr[le+111]="F"+le;var le;for(le=65;le<=90;le++)vr[le]=String.fromCharCode(le+32),Ki[le]=String.fromCharCode(le);var le;for(zs in vr)Ki.hasOwnProperty(zs)||(Ki[zs]=vr[zs]);var zs;function UO(e){var r=WO&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||VO&&e.shiftKey&&e.key&&e.key.length==1||e.key=="Unidentified",t=!r&&e.key||(e.shiftKey?Ki:vr)[e.keyCode]||e.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}Ji.base=vr;Ji.keyName=UO;Ji.shift=Ki});var hc=S(dc=>{"use strict";var dv=fv(),KO=$t(),JO=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),ZO=typeof navigator<"u"&&/Win/.test(navigator.platform);function GO(e){var r=e.split(/-(?!$)/),t=r[r.length-1];t=="Space"&&(t=" ");for(var n,i,o,s,a=0;a<r.length-1;a++){var l=r[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))JO?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return n&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function XO(e){var r=Object.create(null);for(var t in e)r[GO(t)]=e[t];return r}function fc(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return r.altKey&&(e="Alt-"+e),r.ctrlKey&&(e="Ctrl-"+e),r.metaKey&&(e="Meta-"+e),t&&r.shiftKey&&(e="Shift-"+e),e}function YO(e){return new KO.Plugin({props:{handleKeyDown:hv(e)}})}function hv(e){var r=XO(e);return function(t,n){var i=dv.keyName(n),o,s=r[fc(i,n)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(n.shiftKey){var a=r[fc(i,n,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(ZO&&n.ctrlKey&&n.altKey)&&(o=dv.base[n.keyCode])&&o!=i){var l=r[fc(o,n)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}dc.keydownHandler=hv;dc.keymap=YO});var pv=S(qs=>{"use strict";Object.defineProperty(qs,"__esModule",{value:!0});function QO(e){Object.keys(e).filter(r=>r!=="default"&&r!=="__esModule").forEach(r=>{qs.hasOwnProperty(r)||Object.defineProperty(qs,r,{enumerable:!0,configurable:!0,get:()=>e[r]})})}var eM=hc();QO(eM)});var P=S(($j,Ey)=>{"use strict";var Sc=Object.defineProperty,tM=Object.getOwnPropertyDescriptor,rM=Object.getOwnPropertyNames,nM=Object.prototype.hasOwnProperty,Js=(e,r)=>{for(var t in r)Sc(e,t,{get:r[t],enumerable:!0})},iM=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of rM(r))!nM.call(e,i)&&i!==t&&Sc(e,i,{get:()=>r[i],enumerable:!(n=tM(r,i))||n.enumerable});return e},oM=e=>iM(Sc({},"__esModule",{value:!0}),e),Nv={};Js(Nv,{CommandManager:()=>to,Editor:()=>_N,Extendable:()=>oa,Extension:()=>dt,Fragment:()=>AN,InputRule:()=>Hn,Mark:()=>Yv,MarkView:()=>zN,Node:()=>qN,NodePos:()=>gy,NodeView:()=>jN,PasteRule:()=>sa,ResizableNodeView:()=>yy,ResizableNodeview:()=>PN,Tracker:()=>VN,callOrReturn:()=>j,canInsertNode:()=>DN,combineTransactionSteps:()=>Iv,commands:()=>xc,createAtomBlockMarkdownSpec:()=>ky,createBlockMarkdownSpec:()=>wy,createChainableState:()=>eo,createDocument:()=>Us,createElement:()=>Mv,createInlineMarkdownSpec:()=>Sy,createNodeFromContent:()=>zn,createStyleTag:()=>vy,defaultBlockAt:()=>Lv,deleteProps:()=>yc,elementFromString:()=>Bn,escapeForRegEx:()=>IN,extensions:()=>ry,findChildren:()=>yA,findChildrenInRange:()=>bA,findDuplicates:()=>jv,findParentNode:()=>no,findParentNodeClosestToPos:()=>Fv,flattenExtensions:()=>Qs,fromString:()=>qv,generateHTML:()=>xA,generateJSON:()=>TA,generateText:()=>CA,getAttributes:()=>$v,getAttributesFromExtensions:()=>Mc,getChangedRanges:()=>Vv,getDebugJSON:()=>Uv,getExtensionField:()=>N,getHTMLFromFragment:()=>io,getMarkAttributes:()=>Cc,getMarkRange:()=>Gs,getMarkType:()=>Tt,getMarksBetween:()=>Rc,getNodeAtPosition:()=>MA,getNodeAttributes:()=>Hv,getNodeType:()=>pe,getRenderedAttributes:()=>Qi,getSchema:()=>ra,getSchemaByResolvedExtensions:()=>Ac,getSchemaTypeByName:()=>Vs,getSchemaTypeNameByName:()=>ro,getSplittedAttributes:()=>Xi,getText:()=>Pc,getTextBetween:()=>Nc,getTextContentFromNodes:()=>Kv,getTextSerializersFromSchema:()=>na,h:()=>Mv,injectExtensionAttributesToParseRule:()=>bc,inputRulesPlugin:()=>Xv,isActive:()=>Jv,isAndroid:()=>Xs,isAtEndOfNode:()=>AA,isAtStartOfNode:()=>NA,isEmptyObject:()=>Bv,isExtensionRulesEnabled:()=>kc,isFunction:()=>Oc,isList:()=>wc,isMacOS:()=>Ec,isMarkActive:()=>Ks,isNodeActive:()=>qn,isNodeEmpty:()=>ia,isNodeSelection:()=>RA,isNumber:()=>ey,isPlainObject:()=>Gi,isRegExp:()=>Zs,isString:()=>LN,isTextSelection:()=>_c,isiOS:()=>jn,markInputRule:()=>TN,markPasteRule:()=>HN,markdown:()=>by,mergeAttributes:()=>zv,mergeDeep:()=>Dc,minMax:()=>_t,nodeInputRule:()=>EN,nodePasteRule:()=>$N,objectIncludes:()=>Yi,parseAttributes:()=>la,parseIndentedBlocks:()=>xy,pasteRulesPlugin:()=>ty,posToDOMRect:()=>DA,removeDuplicates:()=>Wv,renderNestedMarkdownContent:()=>_y,resolveExtensions:()=>ta,resolveFocusPosition:()=>Tc,rewriteUnknownContent:()=>IA,selectionToInsertionEnd:()=>Dv,serializeAttributes:()=>ua,sortExtensions:()=>ea,splitExtensions:()=>en,textInputRule:()=>ON,textPasteRule:()=>WN,textblockTypeInputRule:()=>CN,updateMarkViewAttributes:()=>Ic,wrappingInputRule:()=>MN});Ey.exports=oM(Nv);function eo(e){let{state:r,transaction:t}=e,{selection:n}=t,{doc:i}=t,{storedMarks:o}=t;return{...r,apply:r.apply.bind(r),applyTransaction:r.applyTransaction.bind(r),plugins:r.plugins,schema:r.schema,reconfigure:r.reconfigure.bind(r),toJSON:r.toJSON.bind(r),get storedMarks(){return o},get selection(){return n},get doc(){return i},get tr(){return n=t.selection,i=t.doc,o=t.storedMarks,t}}}var to=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){let{rawCommands:e,editor:r,state:t}=this,{view:n}=r,{tr:i}=t,o=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([s,a])=>[s,(...u)=>{let c=a(...u)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(i),c}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,r=!0){let{rawCommands:t,editor:n,state:i}=this,{view:o}=n,s=[],a=!!e,l=e||i.tr,u=()=>(!a&&r&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(l),s.every(f=>f===!0)),c={...Object.fromEntries(Object.entries(t).map(([f,d])=>[f,(...p)=>{let m=this.buildProps(l,r),v=d(...p)(m);return s.push(v),c}])),run:u};return c}createCan(e){let{rawCommands:r,state:t}=this,n=!1,i=e||t.tr,o=this.buildProps(i,n);return{...Object.fromEntries(Object.entries(r).map(([a,l])=>[a,(...u)=>l(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,n)}}buildProps(e,r=!0){let{rawCommands:t,editor:n,state:i}=this,{view:o}=n,s={tr:e,editor:n,view:o,state:eo({state:i,transaction:e}),dispatch:r?()=>{}:void 0,chain:()=>this.createChain(e,r),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...u)=>l(...u)(s)]))}};return s}},xc={};Js(xc,{blur:()=>sM,clearContent:()=>aM,clearNodes:()=>uM,command:()=>cM,createParagraphNear:()=>dM,cut:()=>pM,deleteCurrentNode:()=>mM,deleteNode:()=>gM,deleteRange:()=>vM,deleteSelection:()=>bM,enter:()=>kM,exitCode:()=>SM,extendMarkRange:()=>_M,first:()=>TM,focus:()=>CM,forEach:()=>OM,insertContent:()=>MM,insertContentAt:()=>RM,joinBackward:()=>LM,joinDown:()=>IM,joinForward:()=>FM,joinItemBackward:()=>zM,joinItemForward:()=>jM,joinTextblockBackward:()=>$M,joinTextblockForward:()=>VM,joinUp:()=>DM,keyboardShortcut:()=>KM,lift:()=>ZM,liftEmptyBlock:()=>XM,liftListItem:()=>QM,newlineInCode:()=>tA,resetAttributes:()=>rA,scrollIntoView:()=>nA,selectAll:()=>oA,selectNodeBackward:()=>aA,selectNodeForward:()=>uA,selectParentNode:()=>fA,selectTextblockEnd:()=>hA,selectTextblockStart:()=>mA,setContent:()=>gA,setMark:()=>FA,setMeta:()=>BA,setNode:()=>zA,setNodeSelection:()=>jA,setTextDirection:()=>HA,setTextSelection:()=>$A,sinkListItem:()=>VA,splitBlock:()=>UA,splitListItem:()=>ZA,toggleList:()=>GA,toggleMark:()=>XA,toggleNode:()=>YA,toggleWrap:()=>QA,undoInputRule:()=>eN,unsetAllMarks:()=>tN,unsetMark:()=>rN,unsetTextDirection:()=>nN,updateAttributes:()=>iN,wrapIn:()=>sN,wrapInList:()=>lN});var sM=()=>({editor:e,view:r})=>(requestAnimationFrame(()=>{var t;e.isDestroyed||(r.dom.blur(),(t=window?.getSelection())==null||t.removeAllRanges())}),!0),aM=(e=!0)=>({commands:r})=>r.setContent("",{emitUpdate:e}),lM=at(),uM=()=>({state:e,tr:r,dispatch:t})=>{let{selection:n}=r,{ranges:i}=n;return t&&i.forEach(({$from:o,$to:s})=>{e.doc.nodesBetween(o.pos,s.pos,(a,l)=>{if(a.type.isText)return;let{doc:u,mapping:c}=r,f=u.resolve(c.map(l)),d=u.resolve(c.map(l+a.nodeSize)),h=f.blockRange(d);if(!h)return;let p=(0,lM.liftTarget)(h);if(a.type.isTextblock){let{defaultType:m}=f.parent.contentMatchAt(f.index());r.setNodeMarkup(h.start,m)}(p||p===0)&&r.lift(h,p)})}),!0},cM=e=>r=>e(r),fM=ye(),dM=()=>({state:e,dispatch:r})=>(0,fM.createParagraphNear)(e,r),hM=I(),pM=(e,r)=>({editor:t,tr:n})=>{let{state:i}=t,o=i.doc.slice(e.from,e.to);n.deleteRange(e.from,e.to);let s=n.mapping.map(r);return n.insert(s,o.content),n.setSelection(new hM.TextSelection(n.doc.resolve(Math.max(s-1,0)))),!0},mM=()=>({tr:e,dispatch:r})=>{let{selection:t}=e,n=t.$anchor.node();if(n.content.size>0)return!1;let i=e.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===n.type){if(r){let a=i.before(o),l=i.after(o);e.delete(a,l).scrollIntoView()}return!0}return!1};function pe(e,r){if(typeof e=="string"){if(!r.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return r.nodes[e]}return e}var gM=e=>({tr:r,state:t,dispatch:n})=>{let i=pe(e,t.schema),o=r.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(n){let l=o.before(s),u=o.after(s);r.delete(l,u).scrollIntoView()}return!0}return!1},vM=e=>({tr:r,dispatch:t})=>{let{from:n,to:i}=e;return t&&r.delete(n,i),!0},yM=ye(),bM=()=>({state:e,dispatch:r})=>(0,yM.deleteSelection)(e,r),kM=()=>({commands:e})=>e.keyboardShortcut("Enter"),wM=ye(),SM=()=>({state:e,dispatch:r})=>(0,wM.exitCode)(e,r),xM=I();function Zs(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Yi(e,r,t={strict:!0}){let n=Object.keys(r);return n.length?n.every(i=>t.strict?r[i]===e[i]:Zs(r[i])?r[i].test(e[i]):r[i]===e[i]):!0}function Pv(e,r,t={}){return e.find(n=>n.type===r&&Yi(Object.fromEntries(Object.keys(t).map(i=>[i,n.attrs[i]])),t))}function mv(e,r,t={}){return!!Pv(e,r,t)}function Gs(e,r,t){var n;if(!e||!r)return;let i=e.parent.childAfter(e.parentOffset);if((!i.node||!i.node.marks.some(c=>c.type===r))&&(i=e.parent.childBefore(e.parentOffset)),!i.node||!i.node.marks.some(c=>c.type===r)||(t=t||((n=i.node.marks[0])==null?void 0:n.attrs),!Pv([...i.node.marks],r,t)))return;let s=i.index,a=e.start()+i.offset,l=s+1,u=a+i.node.nodeSize;for(;s>0&&mv([...e.parent.child(s-1).marks],r,t);)s-=1,a-=e.parent.child(s).nodeSize;for(;l<e.parent.childCount&&mv([...e.parent.child(l).marks],r,t);)u+=e.parent.child(l).nodeSize,l+=1;return{from:a,to:u}}function Tt(e,r){if(typeof e=="string"){if(!r.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return r.marks[e]}return e}var _M=(e,r={})=>({tr:t,state:n,dispatch:i})=>{let o=Tt(e,n.schema),{doc:s,selection:a}=t,{$from:l,from:u,to:c}=a;if(i){let f=Gs(l,o,r);if(f&&f.from<=u&&f.to>=c){let d=xM.TextSelection.create(s,f.from,f.to);t.setSelection(d)}}return!0},TM=e=>r=>{let t=typeof e=="function"?e(r):e;for(let n=0;n<t.length;n+=1)if(t[n](r))return!0;return!1},EM=I();function _c(e){return e instanceof EM.TextSelection}var js=I();function _t(e=0,r=0,t=0){return Math.min(Math.max(e,r),t)}function Tc(e,r=null){if(!r)return null;let t=js.Selection.atStart(e),n=js.Selection.atEnd(e);if(r==="start"||r===!0)return t;if(r==="end")return n;let i=t.from,o=n.to;return r==="all"?js.TextSelection.create(e,_t(0,i,o),_t(e.content.size,i,o)):js.TextSelection.create(e,_t(r,i,o),_t(r,i,o))}function Xs(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function jn(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var CM=(e=null,r={})=>({editor:t,view:n,tr:i,dispatch:o})=>{r={scrollIntoView:!0,...r};let s=()=>{(jn()||Xs())&&n.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(n.focus(),r?.scrollIntoView&&t.commands.scrollIntoView())})};if(n.hasFocus()&&e===null||e===!1)return!0;if(o&&e===null&&!_c(t.state.selection))return s(),!0;let a=Tc(i.doc,e)||t.state.selection,l=t.state.selection.eq(a);return o&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},OM=(e,r)=>t=>e.every((n,i)=>r(n,{...t,index:i})),MM=(e,r)=>({tr:t,commands:n})=>n.insertContentAt({from:t.selection.from,to:t.selection.to},e,r),AM=ut(),Qr=ut(),Rv=e=>{let r=e.childNodes;for(let t=r.length-1;t>=0;t-=1){let n=r[t];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?e.removeChild(n):n.nodeType===1&&Rv(n)}return e};function Bn(e){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");let r=`<body>${e}</body>`,t=new window.DOMParser().parseFromString(r,"text/html").body;return Rv(t)}function zn(e,r,t){if(e instanceof Qr.Node||e instanceof Qr.Fragment)return e;t={slice:!0,parseOptions:{},...t};let n=typeof e=="object"&&e!==null,i=typeof e=="string";if(n)try{if(Array.isArray(e)&&e.length>0)return Qr.Fragment.fromArray(e.map(a=>r.nodeFromJSON(a)));let s=r.nodeFromJSON(e);return t.errorOnInvalidContent&&s.check(),s}catch(o){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",o),zn("",r,t)}if(i){if(t.errorOnInvalidContent){let s=!1,a="",l=new Qr.Schema({topNode:r.spec.topNode,marks:r.spec.marks,nodes:r.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(s=!0,a=typeof u=="string"?u:u.outerHTML,null)}]}})});if(t.slice?Qr.DOMParser.fromSchema(l).parseSlice(Bn(e),t.parseOptions):Qr.DOMParser.fromSchema(l).parse(Bn(e),t.parseOptions),t.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}let o=Qr.DOMParser.fromSchema(r);return t.slice?o.parseSlice(Bn(e),t.parseOptions).content:o.parse(Bn(e),t.parseOptions)}return zn("",r,t)}var NM=I(),gv=at();function Dv(e,r,t){let n=e.steps.length-1;if(n<r)return;let i=e.steps[n];if(!(i instanceof gv.ReplaceStep||i instanceof gv.ReplaceAroundStep))return;let o=e.mapping.maps[n],s=0;o.forEach((a,l,u,c)=>{s===0&&(s=c)}),e.setSelection(NM.Selection.near(e.doc.resolve(s),t))}var PM=e=>!("type"in e),RM=(e,r,t)=>({tr:n,dispatch:i,editor:o})=>{var s;if(i){t={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let a,l=v=>{o.emit("contentError",{editor:o,error:v,disableCollaboration:()=>{"collaboration"in o.storage&&typeof o.storage.collaboration=="object"&&o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...t.parseOptions};if(!t.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{zn(r,o.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(v){l(v)}try{a=zn(r,o.schema,{parseOptions:u,errorOnInvalidContent:(s=t.errorOnInvalidContent)!=null?s:o.options.enableContentCheck})}catch(v){return l(v),!1}let{from:c,to:f}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},d=!0,h=!0;if((PM(a)?a:[a]).forEach(v=>{v.check(),d=d?v.isText&&v.marks.length===0:!1,h=h?v.isBlock:!1}),c===f&&h){let{parent:v}=n.doc.resolve(c);v.isTextblock&&!v.type.spec.code&&!v.childCount&&(c-=1,f+=1)}let m;if(d){if(Array.isArray(r))m=r.map(v=>v.text||"").join("");else if(r instanceof AM.Fragment){let v="";r.forEach(g=>{g.text&&(v+=g.text)}),m=v}else typeof r=="object"&&r&&r.text?m=r.text:m=r;n.insertText(m,c,f)}else{m=a;let v=n.doc.resolve(c),g=v.node(),y=v.parentOffset===0,w=g.isText||g.isTextblock,b=g.content.size>0;y&&w&&b&&(c=Math.max(0,c-1)),n.replaceWith(c,f,m)}t.updateSelection&&Dv(n,n.steps.length-1,-1),t.applyInputRules&&n.setMeta("applyInputRules",{from:c,text:m}),t.applyPasteRules&&n.setMeta("applyPasteRules",{from:c,text:m})}return!0},Ys=ye(),DM=()=>({state:e,dispatch:r})=>(0,Ys.joinUp)(e,r),IM=()=>({state:e,dispatch:r})=>(0,Ys.joinDown)(e,r),LM=()=>({state:e,dispatch:r})=>(0,Ys.joinBackward)(e,r),FM=()=>({state:e,dispatch:r})=>(0,Ys.joinForward)(e,r),BM=at(),zM=()=>({state:e,dispatch:r,tr:t})=>{try{let n=(0,BM.joinPoint)(e.doc,e.selection.$from.pos,-1);return n==null?!1:(t.join(n,2),r&&r(t),!0)}catch{return!1}},qM=at(),jM=()=>({state:e,dispatch:r,tr:t})=>{try{let n=(0,qM.joinPoint)(e.doc,e.selection.$from.pos,1);return n==null?!1:(t.join(n,2),r&&r(t),!0)}catch{return!1}},HM=ye(),$M=()=>({state:e,dispatch:r})=>(0,HM.joinTextblockBackward)(e,r),WM=ye(),VM=()=>({state:e,dispatch:r})=>(0,WM.joinTextblockForward)(e,r);function Ec(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function UM(e){let r=e.split(/-(?!$)/),t=r[r.length-1];t==="Space"&&(t=" ");let n,i,o,s;for(let a=0;a<r.length-1;a+=1){let l=r[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))jn()||Ec()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return n&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),s&&(t=`Meta-${t}`),o&&(t=`Shift-${t}`),t}var KM=e=>({editor:r,view:t,tr:n,dispatch:i})=>{let o=UM(e).split(/-(?!$)/),s=o.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=r.captureTransaction(()=>{t.someProp("handleKeyDown",u=>u(t,a))});return l?.steps.forEach(u=>{let c=u.map(n.mapping);c&&i&&n.maybeStep(c)}),!0},JM=ye();function qn(e,r,t={}){let{from:n,to:i,empty:o}=e.selection,s=r?pe(r,e.schema):null,a=[];e.doc.nodesBetween(n,i,(f,d)=>{if(f.isText)return;let h=Math.max(n,d),p=Math.min(i,d+f.nodeSize);a.push({node:f,from:h,to:p})});let l=i-n,u=a.filter(f=>s?s.name===f.node.type.name:!0).filter(f=>Yi(f.node.attrs,t,{strict:!1}));return o?!!u.length:u.reduce((f,d)=>f+d.to-d.from,0)>=l}var ZM=(e,r={})=>({state:t,dispatch:n})=>{let i=pe(e,t.schema);return qn(t,i,r)?(0,JM.lift)(t,n):!1},GM=ye(),XM=()=>({state:e,dispatch:r})=>(0,GM.liftEmptyBlock)(e,r),YM=Ns(),QM=e=>({state:r,dispatch:t})=>{let n=pe(e,r.schema);return(0,YM.liftListItem)(n)(r,t)},eA=ye(),tA=()=>({state:e,dispatch:r})=>(0,eA.newlineInCode)(e,r);function ro(e,r){return r.nodes[e]?"node":r.marks[e]?"mark":null}function yc(e,r){let t=typeof r=="string"?[r]:r;return Object.keys(e).reduce((n,i)=>(t.includes(i)||(n[i]=e[i]),n),{})}var rA=(e,r)=>({tr:t,state:n,dispatch:i})=>{let o=null,s=null,a=ro(typeof e=="string"?e:e.name,n.schema);if(!a)return!1;a==="node"&&(o=pe(e,n.schema)),a==="mark"&&(s=Tt(e,n.schema));let l=!1;return t.selection.ranges.forEach(u=>{n.doc.nodesBetween(u.$from.pos,u.$to.pos,(c,f)=>{o&&o===c.type&&(l=!0,i&&t.setNodeMarkup(f,void 0,yc(c.attrs,r))),s&&c.marks.length&&c.marks.forEach(d=>{s===d.type&&(l=!0,i&&t.addMark(f,f+c.nodeSize,s.create(yc(d.attrs,r))))})})}),l},nA=()=>({tr:e,dispatch:r})=>(r&&e.scrollIntoView(),!0),iA=I(),oA=()=>({tr:e,dispatch:r})=>{if(r){let t=new iA.AllSelection(e.doc);e.setSelection(t)}return!0},sA=ye(),aA=()=>({state:e,dispatch:r})=>(0,sA.selectNodeBackward)(e,r),lA=ye(),uA=()=>({state:e,dispatch:r})=>(0,lA.selectNodeForward)(e,r),cA=ye(),fA=()=>({state:e,dispatch:r})=>(0,cA.selectParentNode)(e,r),dA=ye(),hA=()=>({state:e,dispatch:r})=>(0,dA.selectTextblockEnd)(e,r),pA=ye(),mA=()=>({state:e,dispatch:r})=>(0,pA.selectTextblockStart)(e,r);function Us(e,r,t={},n={}){return zn(e,r,{slice:!1,parseOptions:t,errorOnInvalidContent:n.errorOnInvalidContent})}var gA=(e,{errorOnInvalidContent:r,emitUpdate:t=!0,parseOptions:n={}}={})=>({editor:i,tr:o,dispatch:s,commands:a})=>{let{doc:l}=o;if(n.preserveWhitespace!=="full"){let u=Us(e,i.schema,n,{errorOnInvalidContent:r??i.options.enableContentCheck});return s&&o.replaceWith(0,l.content.size,u).setMeta("preventUpdate",!t),!0}return s&&o.setMeta("preventUpdate",!t),a.insertContentAt({from:0,to:l.content.size},e,{parseOptions:n,errorOnInvalidContent:r??i.options.enableContentCheck})};function Cc(e,r){let t=Tt(r,e.schema),{from:n,to:i,empty:o}=e.selection,s=[];o?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(n,i,l=>{s.push(...l.marks)});let a=s.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}var vA=at();function Iv(e,r){let t=new vA.Transform(e);return r.forEach(n=>{n.steps.forEach(i=>{t.step(i)})}),t}function Lv(e){for(let r=0;r<e.edgeCount;r+=1){let{type:t}=e.edge(r);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function yA(e,r){let t=[];return e.descendants((n,i)=>{r(n)&&t.push({node:n,pos:i})}),t}function bA(e,r,t){let n=[];return e.nodesBetween(r.from,r.to,(i,o)=>{t(i)&&n.push({node:i,pos:o})}),n}function Fv(e,r){for(let t=e.depth;t>0;t-=1){let n=e.node(t);if(r(n))return{pos:t>0?e.before(t):0,start:e.start(t),depth:t,node:n}}}function no(e){return r=>Fv(r.$from,e)}function N(e,r,t){return e.config[r]===void 0&&e.parent?N(e.parent,r,t):typeof e.config[r]=="function"?e.config[r].bind({...t,parent:e.parent?N(e.parent,r,t):null}):e.config[r]}function Qs(e){return e.map(r=>{let t={name:r.name,options:r.options,storage:r.storage},n=N(r,"addExtensions",t);return n?[r,...Qs(n())]:r}).flat(10)}var kA=ut(),wA=ut();function io(e,r){let t=wA.DOMSerializer.fromSchema(r).serializeFragment(e),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(t),i.innerHTML}var SA=ut();function Oc(e){return typeof e=="function"}function j(e,r=void 0,...t){return Oc(e)?r?e.bind(r)(...t):e(...t):e}function Bv(e={}){return Object.keys(e).length===0&&e.constructor===Object}function en(e){let r=e.filter(i=>i.type==="extension"),t=e.filter(i=>i.type==="node"),n=e.filter(i=>i.type==="mark");return{baseExtensions:r,nodeExtensions:t,markExtensions:n}}function Mc(e){let r=[],{nodeExtensions:t,markExtensions:n}=en(e),i=[...t,...n],o={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(s=>{let a={name:s.name,options:s.options,storage:s.storage,extensions:i},l=N(s,"addGlobalAttributes",a);if(!l)return;l().forEach(c=>{c.types.forEach(f=>{Object.entries(c.attributes).forEach(([d,h])=>{r.push({type:f,name:d,attribute:{...o,...h}})})})})}),i.forEach(s=>{let a={name:s.name,options:s.options,storage:s.storage},l=N(s,"addAttributes",a);if(!l)return;let u=l();Object.entries(u).forEach(([c,f])=>{let d={...o,...f};typeof d?.default=="function"&&(d.default=d.default()),d?.isRequired&&d?.default===void 0&&delete d.default,r.push({type:s.name,name:c,attribute:d})})}),r}function zv(...e){return e.filter(r=>!!r).reduce((r,t)=>{let n={...r};return Object.entries(t).forEach(([i,o])=>{if(!n[i]){n[i]=o;return}if(i==="class"){let a=o?String(o).split(" "):[],l=n[i]?n[i].split(" "):[],u=a.filter(c=>!l.includes(c));n[i]=[...l,...u].join(" ")}else if(i==="style"){let a=o?o.split(";").map(c=>c.trim()).filter(Boolean):[],l=n[i]?n[i].split(";").map(c=>c.trim()).filter(Boolean):[],u=new Map;l.forEach(c=>{let[f,d]=c.split(":").map(h=>h.trim());u.set(f,d)}),a.forEach(c=>{let[f,d]=c.split(":").map(h=>h.trim());u.set(f,d)}),n[i]=Array.from(u.entries()).map(([c,f])=>`${c}: ${f}`).join("; ")}else n[i]=o}),n},{})}function Qi(e,r){return r.filter(t=>t.type===e.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((t,n)=>zv(t,n),{})}function qv(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function bc(e,r){return"style"in e?e:{...e,getAttrs:t=>{let n=e.getAttrs?e.getAttrs(t):e.attrs;if(n===!1)return!1;let i=r.reduce((o,s)=>{let a=s.attribute.parseHTML?s.attribute.parseHTML(t):qv(t.getAttribute(s.name));return a==null?o:{...o,[s.name]:a}},{});return{...n,...i}}}}function vv(e){return Object.fromEntries(Object.entries(e).filter(([r,t])=>r==="attrs"&&Bv(t)?!1:t!=null))}function yv(e){var r,t;let n={};return!((r=e?.attribute)!=null&&r.isRequired)&&"default"in(e?.attribute||{})&&(n.default=e.attribute.default),((t=e?.attribute)==null?void 0:t.validate)!==void 0&&(n.validate=e.attribute.validate),[e.name,n]}function Ac(e,r){var t;let n=Mc(e),{nodeExtensions:i,markExtensions:o}=en(e),s=(t=i.find(u=>N(u,"topNode")))==null?void 0:t.name,a=Object.fromEntries(i.map(u=>{let c=n.filter(g=>g.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:r},d=e.reduce((g,y)=>{let w=N(y,"extendNodeSchema",f);return{...g,...w?w(u):{}}},{}),h=vv({...d,content:j(N(u,"content",f)),marks:j(N(u,"marks",f)),group:j(N(u,"group",f)),inline:j(N(u,"inline",f)),atom:j(N(u,"atom",f)),selectable:j(N(u,"selectable",f)),draggable:j(N(u,"draggable",f)),code:j(N(u,"code",f)),whitespace:j(N(u,"whitespace",f)),linebreakReplacement:j(N(u,"linebreakReplacement",f)),defining:j(N(u,"defining",f)),isolating:j(N(u,"isolating",f)),attrs:Object.fromEntries(c.map(yv))}),p=j(N(u,"parseHTML",f));p&&(h.parseDOM=p.map(g=>bc(g,c)));let m=N(u,"renderHTML",f);m&&(h.toDOM=g=>m({node:g,HTMLAttributes:Qi(g,c)}));let v=N(u,"renderText",f);return v&&(h.toText=v),[u.name,h]})),l=Object.fromEntries(o.map(u=>{let c=n.filter(v=>v.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:r},d=e.reduce((v,g)=>{let y=N(g,"extendMarkSchema",f);return{...v,...y?y(u):{}}},{}),h=vv({...d,inclusive:j(N(u,"inclusive",f)),excludes:j(N(u,"excludes",f)),group:j(N(u,"group",f)),spanning:j(N(u,"spanning",f)),code:j(N(u,"code",f)),attrs:Object.fromEntries(c.map(yv))}),p=j(N(u,"parseHTML",f));p&&(h.parseDOM=p.map(v=>bc(v,c)));let m=N(u,"renderHTML",f);return m&&(h.toDOM=v=>m({mark:v,HTMLAttributes:Qi(v,c)})),[u.name,h]}));return new SA.Schema({topNode:s,nodes:a,marks:l})}function jv(e){let r=e.filter((t,n)=>e.indexOf(t)!==n);return Array.from(new Set(r))}function ea(e){return e.sort((t,n)=>{let i=N(t,"priority")||100,o=N(n,"priority")||100;return i>o?-1:i<o?1:0})}function ta(e){let r=ea(Qs(e)),t=jv(r.map(n=>n.name));return t.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${t.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),r}function ra(e,r){let t=ta(e);return Ac(t,r)}function xA(e,r){let t=ra(r),n=kA.Node.fromJSON(t,e);return io(n.content,t)}var _A=ut();function TA(e,r){let t=ra(r),n=Bn(e);return _A.DOMParser.fromSchema(t).parse(n).toJSON()}var EA=ut();function Nc(e,r,t){let{from:n,to:i}=r,{blockSeparator:o=`

`,textSerializers:s={}}=t||{},a="";return e.nodesBetween(n,i,(l,u,c,f)=>{var d;l.isBlock&&u>n&&(a+=o);let h=s?.[l.type.name];if(h)return c&&(a+=h({node:l,pos:u,parent:c,index:f,range:r})),!1;l.isText&&(a+=(d=l?.text)==null?void 0:d.slice(Math.max(n,u)-u,i-u))}),a}function Pc(e,r){let t={from:0,to:e.content.size};return Nc(e,t,r)}function na(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,r])=>r.spec.toText).map(([r,t])=>[r,t.spec.toText]))}function CA(e,r,t){let{blockSeparator:n=`

`,textSerializers:i={}}=t||{},o=ra(r),s=EA.Node.fromJSON(o,e);return Pc(s,{blockSeparator:n,textSerializers:{...na(o),...i}})}function Hv(e,r){let t=pe(r,e.schema),{from:n,to:i}=e.selection,o=[];e.doc.nodesBetween(n,i,a=>{o.push(a)});let s=o.reverse().find(a=>a.type.name===t.name);return s?{...s.attrs}:{}}function $v(e,r){let t=ro(typeof r=="string"?r:r.name,e.schema);return t==="node"?Hv(e,r):t==="mark"?Cc(e,r):{}}function Wv(e,r=JSON.stringify){let t={};return e.filter(n=>{let i=r(n);return Object.prototype.hasOwnProperty.call(t,i)?!1:t[i]=!0})}function OA(e){let r=Wv(e);return r.length===1?r:r.filter((t,n)=>!r.filter((o,s)=>s!==n).some(o=>t.oldRange.from>=o.oldRange.from&&t.oldRange.to<=o.oldRange.to&&t.newRange.from>=o.newRange.from&&t.newRange.to<=o.newRange.to))}function Vv(e){let{mapping:r,steps:t}=e,n=[];return r.maps.forEach((i,o)=>{let s=[];if(i.ranges.length)i.forEach((a,l)=>{s.push({from:a,to:l})});else{let{from:a,to:l}=t[o];if(a===void 0||l===void 0)return;s.push({from:a,to:l})}s.forEach(({from:a,to:l})=>{let u=r.slice(o).map(a,-1),c=r.slice(o).map(l),f=r.invert().map(u,-1),d=r.invert().map(c);n.push({oldRange:{from:f,to:d},newRange:{from:u,to:c}})})}),OA(n)}function Uv(e,r=0){let n=e.type===e.type.schema.topNodeType?0:1,i=r,o=i+e.nodeSize,s=e.marks.map(u=>{let c={type:u.type.name};return Object.keys(u.attrs).length&&(c.attrs={...u.attrs}),c}),a={...e.attrs},l={type:e.type.name,from:i,to:o};return Object.keys(a).length&&(l.attrs=a),s.length&&(l.marks=s),e.content.childCount&&(l.content=[],e.forEach((u,c)=>{var f;(f=l.content)==null||f.push(Uv(u,r+c+n))})),e.text&&(l.text=e.text),l}function Rc(e,r,t){let n=[];return e===r?t.resolve(e).marks().forEach(i=>{let o=t.resolve(e),s=Gs(o,i.type);s&&n.push({mark:i,...s})}):t.nodesBetween(e,r,(i,o)=>{!i||i?.nodeSize===void 0||n.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),n}var MA=(e,r,t,n=20)=>{let i=e.doc.resolve(t),o=n,s=null;for(;o>0&&s===null;){let a=i.node(o);a?.type.name===r?s=a:o-=1}return[s,o]};function Vs(e,r){return r.nodes[e]||r.marks[e]||null}function Xi(e,r,t){return Object.fromEntries(Object.entries(t).filter(([n])=>{let i=e.find(o=>o.type===r&&o.name===n);return i?i.attribute.keepOnSplit:!1}))}var Kv=(e,r=500)=>{let t="",n=e.parentOffset;return e.parent.nodesBetween(Math.max(0,n-r),n,(i,o,s,a)=>{var l,u;let c=((u=(l=i.type.spec).toText)==null?void 0:u.call(l,{node:i,pos:o,parent:s,index:a}))||i.textContent||"%leaf%";t+=i.isAtom&&!i.isText?c:c.slice(0,Math.max(0,n-o))}),t};function Ks(e,r,t={}){let{empty:n,ranges:i}=e.selection,o=r?Tt(r,e.schema):null;if(n)return!!(e.storedMarks||e.selection.$from.marks()).filter(f=>o?o.name===f.type.name:!0).find(f=>Yi(f.attrs,t,{strict:!1}));let s=0,a=[];if(i.forEach(({$from:f,$to:d})=>{let h=f.pos,p=d.pos;e.doc.nodesBetween(h,p,(m,v)=>{if(!m.isText&&!m.marks.length)return;let g=Math.max(h,v),y=Math.min(p,v+m.nodeSize),w=y-g;s+=w,a.push(...m.marks.map(b=>({mark:b,from:g,to:y})))})}),s===0)return!1;let l=a.filter(f=>o?o.name===f.mark.type.name:!0).filter(f=>Yi(f.mark.attrs,t,{strict:!1})).reduce((f,d)=>f+d.to-d.from,0),u=a.filter(f=>o?f.mark.type!==o&&f.mark.type.excludes(o):!0).reduce((f,d)=>f+d.to-d.from,0);return(l>0?l+u:l)>=s}function Jv(e,r,t={}){if(!r)return qn(e,null,t)||Ks(e,null,t);let n=ro(r,e.schema);return n==="node"?qn(e,r,t):n==="mark"?Ks(e,r,t):!1}var AA=(e,r)=>{let{$from:t,$to:n,$anchor:i}=e.selection;if(r){let o=no(a=>a.type.name===r)(e.selection);if(!o)return!1;let s=e.doc.resolve(o.pos+1);return i.pos+1===s.end()}return!(n.parentOffset<n.parent.nodeSize-2||t.pos!==n.pos)},NA=e=>{let{$from:r,$to:t}=e.selection;return!(r.parentOffset>0||r.pos!==t.pos)};function kc(e,r){return Array.isArray(r)?r.some(t=>(typeof t=="string"?t:t.name)===e.name):r}function wc(e,r){let{nodeExtensions:t}=en(r),n=t.find(s=>s.name===e);if(!n)return!1;let i={name:n.name,options:n.options,storage:n.storage},o=j(N(n,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function ia(e,{checkChildren:r=!0,ignoreWhitespace:t=!1}={}){var n;if(t){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((n=e.text)!=null?n:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(r){let i=!0;return e.content.forEach(o=>{i!==!1&&(ia(o,{ignoreWhitespace:t,checkChildren:r})||(i=!1))}),i}return!1}var PA=I();function RA(e){return e instanceof PA.NodeSelection}function DA(e,r,t){let i=e.state.doc.content.size,o=_t(r,0,i),s=_t(t,0,i),a=e.coordsAtPos(o),l=e.coordsAtPos(s,-1),u=Math.min(a.top,l.top),c=Math.max(a.bottom,l.bottom),f=Math.min(a.left,l.left),d=Math.max(a.right,l.right),h=d-f,p=c-u,g={top:u,bottom:c,left:f,right:d,width:h,height:p,x:f,y:u};return{...g,toJSON:()=>g}}function Zv({json:e,validMarks:r,validNodes:t,options:n,rewrittenContent:i=[]}){return e.marks&&Array.isArray(e.marks)&&(e.marks=e.marks.filter(o=>{let s=typeof o=="string"?o:o.type;return r.has(s)?!0:(i.push({original:JSON.parse(JSON.stringify(o)),unsupported:s}),!1)})),e.content&&Array.isArray(e.content)&&(e.content=e.content.map(o=>Zv({json:o,validMarks:r,validNodes:t,options:n,rewrittenContent:i}).json).filter(o=>o!=null)),e.type&&!t.has(e.type)?(i.push({original:JSON.parse(JSON.stringify(e)),unsupported:e.type}),e.content&&Array.isArray(e.content)&&n?.fallbackToParagraph!==!1?(e.type="paragraph",{json:e,rewrittenContent:i}):{json:null,rewrittenContent:i}):{json:e,rewrittenContent:i}}function IA(e,r,t){return Zv({json:e,validNodes:new Set(Object.keys(r.nodes)),validMarks:new Set(Object.keys(r.marks)),options:t})}function LA(e,r,t){var n;let{selection:i}=r,o=null;if(_c(i)&&(o=i.$cursor),o){let a=(n=e.storedMarks)!=null?n:o.marks();return o.parent.type.allowsMarkType(t)&&(!!t.isInSet(a)||!a.some(u=>u.type.excludes(t)))}let{ranges:s}=i;return s.some(({$from:a,$to:l})=>{let u=a.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(t):!1;return e.doc.nodesBetween(a.pos,l.pos,(c,f,d)=>{if(u)return!1;if(c.isInline){let h=!d||d.type.allowsMarkType(t),p=!!t.isInSet(c.marks)||!c.marks.some(m=>m.type.excludes(t));u=h&&p}return!u}),u})}var FA=(e,r={})=>({tr:t,state:n,dispatch:i})=>{let{selection:o}=t,{empty:s,ranges:a}=o,l=Tt(e,n.schema);if(i)if(s){let u=Cc(n,l);t.addStoredMark(l.create({...u,...r}))}else a.forEach(u=>{let c=u.$from.pos,f=u.$to.pos;n.doc.nodesBetween(c,f,(d,h)=>{let p=Math.max(h,c),m=Math.min(h+d.nodeSize,f);d.marks.find(g=>g.type===l)?d.marks.forEach(g=>{l===g.type&&t.addMark(p,m,l.create({...g.attrs,...r}))}):t.addMark(p,m,l.create(r))})});return LA(n,t,l)},BA=(e,r)=>({tr:t})=>(t.setMeta(e,r),!0),bv=ye(),zA=(e,r={})=>({state:t,dispatch:n,chain:i})=>{let o=pe(e,t.schema),s;return t.selection.$anchor.sameParent(t.selection.$head)&&(s=t.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:a})=>(0,bv.setBlockType)(o,{...s,...r})(t)?!0:a.clearNodes()).command(({state:a})=>(0,bv.setBlockType)(o,{...s,...r})(a,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},qA=I(),jA=e=>({tr:r,dispatch:t})=>{if(t){let{doc:n}=r,i=_t(e,0,n.content.size),o=qA.NodeSelection.create(n,i);r.setSelection(o)}return!0},HA=(e,r)=>({tr:t,state:n,dispatch:i})=>{let{selection:o}=n,s,a;return typeof r=="number"?(s=r,a=r):r&&"from"in r&&"to"in r?(s=r.from,a=r.to):(s=o.from,a=o.to),i&&t.doc.nodesBetween(s,a,(l,u)=>{l.isText||t.setNodeMarkup(u,void 0,{...l.attrs,dir:e})}),!0},pc=I(),$A=e=>({tr:r,dispatch:t})=>{if(t){let{doc:n}=r,{from:i,to:o}=typeof e=="number"?{from:e,to:e}:e,s=pc.TextSelection.atStart(n).from,a=pc.TextSelection.atEnd(n).to,l=_t(i,s,a),u=_t(o,s,a),c=pc.TextSelection.create(n,l,u);r.setSelection(c)}return!0},WA=Ns(),VA=e=>({state:r,dispatch:t})=>{let n=pe(e,r.schema);return(0,WA.sinkListItem)(n)(r,t)},kv=I(),mc=at();function wv(e,r){let t=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(t){let n=t.filter(i=>r?.includes(i.type.name));e.tr.ensureMarks(n)}}var UA=({keepMarks:e=!0}={})=>({tr:r,state:t,dispatch:n,editor:i})=>{let{selection:o,doc:s}=r,{$from:a,$to:l}=o,u=i.extensionManager.attributes,c=Xi(u,a.node().type.name,a.node().attrs);if(o instanceof kv.NodeSelection&&o.node.isBlock)return!a.parentOffset||!(0,mc.canSplit)(s,a.pos)?!1:(n&&(e&&wv(t,i.extensionManager.splittableMarks),r.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;let f=l.parentOffset===l.parent.content.size,d=a.depth===0?void 0:Lv(a.node(-1).contentMatchAt(a.indexAfter(-1))),h=f&&d?[{type:d,attrs:c}]:void 0,p=(0,mc.canSplit)(r.doc,r.mapping.map(a.pos),1,h);if(!h&&!p&&(0,mc.canSplit)(r.doc,r.mapping.map(a.pos),1,d?[{type:d}]:void 0)&&(p=!0,h=d?[{type:d,attrs:c}]:void 0),n){if(p&&(o instanceof kv.TextSelection&&r.deleteSelection(),r.split(r.mapping.map(a.pos),1,h),d&&!f&&!a.parentOffset&&a.parent.type!==d)){let m=r.mapping.map(a.before()),v=r.doc.resolve(m);a.node(-1).canReplaceWith(v.index(),v.index()+1,d)&&r.setNodeMarkup(r.mapping.map(a.before()),d)}e&&wv(t,i.extensionManager.splittableMarks),r.scrollIntoView()}return p},Hs=ut(),KA=I(),JA=at(),ZA=(e,r={})=>({tr:t,state:n,dispatch:i,editor:o})=>{var s;let a=pe(e,n.schema),{$from:l,$to:u}=n.selection,c=n.selection.node;if(c&&c.isBlock||l.depth<2||!l.sameParent(u))return!1;let f=l.node(-1);if(f.type!==a)return!1;let d=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let g=Hs.Fragment.empty,y=l.index(-1)?1:l.index(-2)?2:3;for(let _=l.depth-y;_>=l.depth-3;_-=1)g=Hs.Fragment.from(l.node(_).copy(g));let w=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,b={...Xi(d,l.node().type.name,l.node().attrs),...r},k=((s=a.contentMatch.defaultType)==null?void 0:s.createAndFill(b))||void 0;g=g.append(Hs.Fragment.from(a.createAndFill(null,k)||void 0));let x=l.before(l.depth-(y-1));t.replace(x,l.after(-w),new Hs.Slice(g,4-y,0));let T=-1;t.doc.nodesBetween(x,t.doc.content.size,(_,C)=>{if(T>-1)return!1;_.isTextblock&&_.content.size===0&&(T=C+1)}),T>-1&&t.setSelection(KA.TextSelection.near(t.doc.resolve(T))),t.scrollIntoView()}return!0}let h=u.pos===l.end()?f.contentMatchAt(0).defaultType:null,p={...Xi(d,f.type.name,f.attrs),...r},m={...Xi(d,l.node().type.name,l.node().attrs),...r};t.delete(l.pos,u.pos);let v=h?[{type:a,attrs:p},{type:h,attrs:m}]:[{type:a,attrs:p}];if(!(0,JA.canSplit)(t.doc,l.pos,2))return!1;if(i){let{selection:g,storedMarks:y}=n,{splittableMarks:w}=o.extensionManager,b=y||g.$to.parentOffset&&g.$from.marks();if(t.split(l.pos,2,v).scrollIntoView(),!b||!i)return!0;let k=b.filter(x=>w.includes(x.type.name));t.ensureMarks(k)}return!0},Gv=at(),gc=(e,r)=>{let t=no(s=>s.type===r)(e.selection);if(!t)return!0;let n=e.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(n===void 0)return!0;let i=e.doc.nodeAt(n);return t.node.type===i?.type&&(0,Gv.canJoin)(e.doc,t.pos)&&e.join(t.pos),!0},vc=(e,r)=>{let t=no(s=>s.type===r)(e.selection);if(!t)return!0;let n=e.doc.resolve(t.start).after(t.depth);if(n===void 0)return!0;let i=e.doc.nodeAt(n);return t.node.type===i?.type&&(0,Gv.canJoin)(e.doc,n)&&e.join(n),!0},GA=(e,r,t,n={})=>({editor:i,tr:o,state:s,dispatch:a,chain:l,commands:u,can:c})=>{let{extensions:f,splittableMarks:d}=i.extensionManager,h=pe(e,s.schema),p=pe(r,s.schema),{selection:m,storedMarks:v}=s,{$from:g,$to:y}=m,w=g.blockRange(y),b=v||m.$to.parentOffset&&m.$from.marks();if(!w)return!1;let k=no(x=>wc(x.type.name,f))(m);if(w.depth>=1&&k&&w.depth-k.depth<=1){if(k.node.type===h)return u.liftListItem(p);if(wc(k.node.type.name,f)&&h.validContent(k.node.content)&&a)return l().command(()=>(o.setNodeMarkup(k.pos,h),!0)).command(()=>gc(o,h)).command(()=>vc(o,h)).run()}return!t||!b||!a?l().command(()=>c().wrapInList(h,n)?!0:u.clearNodes()).wrapInList(h,n).command(()=>gc(o,h)).command(()=>vc(o,h)).run():l().command(()=>{let x=c().wrapInList(h,n),T=b.filter(_=>d.includes(_.type.name));return o.ensureMarks(T),x?!0:u.clearNodes()}).wrapInList(h,n).command(()=>gc(o,h)).command(()=>vc(o,h)).run()},XA=(e,r={},t={})=>({state:n,commands:i})=>{let{extendEmptyMarkRange:o=!1}=t,s=Tt(e,n.schema);return Ks(n,s,r)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,r)},YA=(e,r,t={})=>({state:n,commands:i})=>{let o=pe(e,n.schema),s=pe(r,n.schema),a=qn(n,o,t),l;return n.selection.$anchor.sameParent(n.selection.$head)&&(l=n.selection.$anchor.parent.attrs),a?i.setNode(s,l):i.setNode(o,{...l,...t})},QA=(e,r={})=>({state:t,commands:n})=>{let i=pe(e,t.schema);return qn(t,i,r)?n.lift(i):n.wrapIn(i,r)},eN=()=>({state:e,dispatch:r})=>{let t=e.plugins;for(let n=0;n<t.length;n+=1){let i=t[n],o;if(i.spec.isInputRules&&(o=i.getState(e))){if(r){let s=e.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(o.text){let l=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,e.schema.text(o.text,l))}else s.delete(o.from,o.to)}return!0}}return!1},tN=()=>({tr:e,dispatch:r})=>{let{selection:t}=e,{empty:n,ranges:i}=t;return n||r&&i.forEach(o=>{e.removeMark(o.$from.pos,o.$to.pos)}),!0},rN=(e,r={})=>({tr:t,state:n,dispatch:i})=>{var o;let{extendEmptyMarkRange:s=!1}=r,{selection:a}=t,l=Tt(e,n.schema),{$from:u,empty:c,ranges:f}=a;if(!i)return!0;if(c&&s){let{from:d,to:h}=a,p=(o=u.marks().find(v=>v.type===l))==null?void 0:o.attrs,m=Gs(u,l,p);m&&(d=m.from,h=m.to),t.removeMark(d,h,l)}else f.forEach(d=>{t.removeMark(d.$from.pos,d.$to.pos,l)});return t.removeStoredMark(l),!0},nN=e=>({tr:r,state:t,dispatch:n})=>{let{selection:i}=t,o,s;return typeof e=="number"?(o=e,s=e):e&&"from"in e&&"to"in e?(o=e.from,s=e.to):(o=i.from,s=i.to),n&&r.doc.nodesBetween(o,s,(a,l)=>{if(a.isText)return;let u={...a.attrs};delete u.dir,r.setNodeMarkup(l,void 0,u)}),!0},iN=(e,r={})=>({tr:t,state:n,dispatch:i})=>{let o=null,s=null,a=ro(typeof e=="string"?e:e.name,n.schema);if(!a)return!1;a==="node"&&(o=pe(e,n.schema)),a==="mark"&&(s=Tt(e,n.schema));let l=!1;return t.selection.ranges.forEach(u=>{let c=u.$from.pos,f=u.$to.pos,d,h,p,m;t.selection.empty?n.doc.nodesBetween(c,f,(v,g)=>{o&&o===v.type&&(l=!0,p=Math.max(g,c),m=Math.min(g+v.nodeSize,f),d=g,h=v)}):n.doc.nodesBetween(c,f,(v,g)=>{g<c&&o&&o===v.type&&(l=!0,p=Math.max(g,c),m=Math.min(g+v.nodeSize,f),d=g,h=v),g>=c&&g<=f&&(o&&o===v.type&&(l=!0,i&&t.setNodeMarkup(g,void 0,{...v.attrs,...r})),s&&v.marks.length&&v.marks.forEach(y=>{if(s===y.type&&(l=!0,i)){let w=Math.max(g,c),b=Math.min(g+v.nodeSize,f);t.addMark(w,b,s.create({...y.attrs,...r}))}}))}),h&&(d!==void 0&&i&&t.setNodeMarkup(d,void 0,{...h.attrs,...r}),s&&h.marks.length&&h.marks.forEach(v=>{s===v.type&&i&&t.addMark(p,m,s.create({...v.attrs,...r}))}))}),l},oN=ye(),sN=(e,r={})=>({state:t,dispatch:n})=>{let i=pe(e,t.schema);return(0,oN.wrapIn)(i,r)(t,n)},aN=Ns(),lN=(e,r={})=>({state:t,dispatch:n})=>{let i=pe(e,t.schema);return(0,aN.wrapInList)(i,r)(t,n)},uN=I(),cN=Ui(),fN=class{constructor(){this.callbacks={}}on(e,r){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(r),this}emit(e,...r){let t=this.callbacks[e];return t&&t.forEach(n=>n.apply(this,r)),this}off(e,r){let t=this.callbacks[e];return t&&(r?this.callbacks[e]=t.filter(n=>n!==r):delete this.callbacks[e]),this}once(e,r){let t=(...n)=>{this.off(e,t),r.apply(this,n)};return this.on(e,t)}removeAllListeners(){this.callbacks={}}},dN=pv(),hN=ut(),pN=I(),Hn=class{constructor(e){var r;this.find=e.find,this.handler=e.handler,this.undoable=(r=e.undoable)!=null?r:!0}},mN=(e,r)=>{if(Zs(r))return r.exec(e);let t=r(e);if(!t)return null;let n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(t.replaceWith)),n};function $s(e){var r;let{editor:t,from:n,to:i,text:o,rules:s,plugin:a}=e,{view:l}=t;if(l.composing)return!1;let u=l.state.doc.resolve(n);if(u.parent.type.spec.code||(r=u.nodeBefore||u.nodeAfter)!=null&&r.marks.find(d=>d.type.spec.code))return!1;let c=!1,f=Kv(u)+o;return s.forEach(d=>{if(c)return;let h=mN(f,d.find);if(!h)return;let p=l.state.tr,m=eo({state:l.state,transaction:p}),v={from:n-(h[0].length-o.length),to:i},{commands:g,chain:y,can:w}=new to({editor:t,state:m});d.handler({state:m,range:v,match:h,commands:g,chain:y,can:w})===null||!p.steps.length||(d.undoable&&p.setMeta(a,{transform:p,from:n,to:i,text:o}),l.dispatch(p),c=!0)}),c}function Xv(e){let{editor:r,rules:t}=e,n=new pN.Plugin({state:{init(){return null},apply(i,o,s){let a=i.getMeta(n);if(a)return a;let l=i.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:c}=l;typeof c=="string"?c=c:c=io(hN.Fragment.from(c),s.schema);let{from:f}=l,d=f+c.length;$s({editor:r,from:f,to:d,text:c,rules:t,plugin:n})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,s,a){return $s({editor:r,from:o,to:s,text:a,rules:t,plugin:n})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{let{$cursor:o}=i.state.selection;o&&$s({editor:r,from:o.pos,to:o.pos,text:"",rules:t,plugin:n})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;let{$cursor:s}=i.state.selection;return s?$s({editor:r,from:s.pos,to:s.pos,text:`
`,rules:t,plugin:n}):!1}},isInputRules:!0});return n}function gN(e){return Object.prototype.toString.call(e).slice(8,-1)}function Gi(e){return gN(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function Dc(e,r){let t={...e};return Gi(e)&&Gi(r)&&Object.keys(r).forEach(n=>{Gi(r[n])&&Gi(e[n])?t[n]=Dc(e[n],r[n]):t[n]=r[n]}),t}var oa=class{constructor(e={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...e},this.name=this.config.name}get options(){return{...j(N(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...j(N(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(e={}){let r=this.extend({...this.config,addOptions:()=>Dc(this.options,e)});return r.name=this.name,r.parent=this.parent,r}extend(e={}){let r=new this.constructor({...this.config,...e});return r.parent=this,this.child=r,r.name="name"in e?e.name:r.parent.name,r}},Yv=class Qv extends oa{constructor(){super(...arguments),this.type="mark"}static create(r={}){let t=typeof r=="function"?r():r;return new Qv(t)}static handleExit({editor:r,mark:t}){let{tr:n}=r.state,i=r.state.selection.$from;if(i.pos===i.end()){let s=i.marks();if(!!!s.find(u=>u?.type.name===t.name))return!1;let l=s.find(u=>u?.type.name===t.name);return l&&n.removeStoredMark(l),n.insertText(" ",i.pos),r.view.dispatch(n),!0}return!1}configure(r){return super.configure(r)}extend(r){let t=typeof r=="function"?r():r;return super.extend(t)}},vN=ut(),yN=I();function ey(e){return typeof e=="number"}var sa=class{constructor(e){this.find=e.find,this.handler=e.handler}},bN=(e,r,t)=>{if(Zs(r))return[...e.matchAll(r)];let n=r(e,t);return n?n.map(i=>{let o=[i.text];return o.index=i.index,o.input=e,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function kN(e){let{editor:r,state:t,from:n,to:i,rule:o,pasteEvent:s,dropEvent:a}=e,{commands:l,chain:u,can:c}=new to({editor:r,state:t}),f=[];return t.doc.nodesBetween(n,i,(h,p)=>{var m,v,g,y,w;if((v=(m=h.type)==null?void 0:m.spec)!=null&&v.code||!(h.isText||h.isTextblock||h.isInline))return;let b=(w=(y=(g=h.content)==null?void 0:g.size)!=null?y:h.nodeSize)!=null?w:0,k=Math.max(n,p),x=Math.min(i,p+b);if(k>=x)return;let T=h.isText?h.text||"":h.textBetween(k-p,x-p,void 0,"\uFFFC");bN(T,o.find,s).forEach(C=>{if(C.index===void 0)return;let A=k+C.index+1,O=A+C[0].length,B={from:t.tr.mapping.map(A),to:t.tr.mapping.map(O)},U=o.handler({state:t,range:B,match:C,commands:l,chain:u,can:c,pasteEvent:s,dropEvent:a});f.push(U)})}),f.every(h=>h!==null)}var Ws=null,wN=e=>{var r;let t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(r=t.clipboardData)==null||r.setData("text/html",e),t};function ty(e){let{editor:r,rules:t}=e,n=null,i=!1,o=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}let l=({state:c,from:f,to:d,rule:h,pasteEvt:p})=>{let m=c.tr,v=eo({state:c,transaction:m});if(!(!kN({editor:r,state:v,from:Math.max(f-1,0),to:d.b-1,rule:h,pasteEvent:p,dropEvent:a})||!m.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,m}};return t.map(c=>new yN.Plugin({view(f){let d=p=>{var m;n=(m=f.dom.parentElement)!=null&&m.contains(p.target)?f.dom.parentElement:null,n&&(Ws=r)},h=()=>{Ws&&(Ws=null)};return window.addEventListener("dragstart",d),window.addEventListener("dragend",h),{destroy(){window.removeEventListener("dragstart",d),window.removeEventListener("dragend",h)}}},props:{handleDOMEvents:{drop:(f,d)=>{if(o=n===f.dom.parentElement,a=d,!o){let h=Ws;h?.isEditable&&setTimeout(()=>{let p=h.state.selection;p&&h.commands.deleteRange({from:p.from,to:p.to})},10)}return!1},paste:(f,d)=>{var h;let p=(h=d.clipboardData)==null?void 0:h.getData("text/html");return s=d,i=!!p?.includes("data-pm-slice"),!1}}},appendTransaction:(f,d,h)=>{let p=f[0],m=p.getMeta("uiEvent")==="paste"&&!i,v=p.getMeta("uiEvent")==="drop"&&!o,g=p.getMeta("applyPasteRules"),y=!!g;if(!m&&!v&&!y)return;if(y){let{text:k}=g;typeof k=="string"?k=k:k=io(vN.Fragment.from(k),h.schema);let{from:x}=g,T=x+k.length,_=wN(k);return l({rule:c,state:h,from:x,to:{b:T},pasteEvt:_})}let w=d.doc.content.findDiffStart(h.doc.content),b=d.doc.content.findDiffEnd(h.doc.content);if(!(!ey(w)||!b||w===b.b))return l({rule:c,state:h,from:w,to:b,pasteEvt:s})}}))}var aa=class{constructor(e,r){this.splittableMarks=[],this.editor=r,this.baseExtensions=e,this.extensions=ta(e),this.schema=Ac(this.extensions,r),this.setupExtensions()}get commands(){return this.extensions.reduce((e,r)=>{let t={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:this.editor,type:Vs(r.name,this.schema)},n=N(r,"addCommands",t);return n?{...e,...n()}:e},{})}get plugins(){let{editor:e}=this;return ea([...this.extensions].reverse()).flatMap(n=>{let i={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:e,type:Vs(n.name,this.schema)},o=[],s=N(n,"addKeyboardShortcuts",i),a={};if(n.type==="mark"&&N(n,"exitable",i)&&(a.ArrowRight=()=>Yv.handleExit({editor:e,mark:n})),s){let d=Object.fromEntries(Object.entries(s()).map(([h,p])=>[h,()=>p({editor:e})]));a={...a,...d}}let l=(0,dN.keymap)(a);o.push(l);let u=N(n,"addInputRules",i);if(kc(n,e.options.enableInputRules)&&u){let d=u();if(d&&d.length){let h=Xv({editor:e,rules:d}),p=Array.isArray(h)?h:[h];o.push(...p)}}let c=N(n,"addPasteRules",i);if(kc(n,e.options.enablePasteRules)&&c){let d=c();if(d&&d.length){let h=ty({editor:e,rules:d});o.push(...h)}}let f=N(n,"addProseMirrorPlugins",i);if(f){let d=f();o.push(...d)}return o})}get attributes(){return Mc(this.extensions)}get nodeViews(){let{editor:e}=this,{nodeExtensions:r}=en(this.extensions);return Object.fromEntries(r.filter(t=>!!N(t,"addNodeView")).map(t=>{let n=this.attributes.filter(l=>l.type===t.name),i={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:pe(t.name,this.schema)},o=N(t,"addNodeView",i);if(!o)return[];let s=o();if(!s)return[];let a=(l,u,c,f,d)=>{let h=Qi(l,n);return s({node:l,view:u,getPos:c,decorations:f,innerDecorations:d,editor:e,extension:t,HTMLAttributes:h})};return[t.name,a]}))}get markViews(){let{editor:e}=this,{markExtensions:r}=en(this.extensions);return Object.fromEntries(r.filter(t=>!!N(t,"addMarkView")).map(t=>{let n=this.attributes.filter(a=>a.type===t.name),i={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:Tt(t.name,this.schema)},o=N(t,"addMarkView",i);if(!o)return[];let s=(a,l,u)=>{let c=Qi(a,n);return o()({mark:a,view:l,inline:u,editor:e,extension:t,HTMLAttributes:c,updateAttributes:f=>{Ic(a,e,f)}})};return[t.name,s]}))}setupExtensions(){let e=this.extensions;this.editor.extensionStorage=Object.fromEntries(e.map(r=>[r.name,r.storage])),e.forEach(r=>{var t;let n={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:this.editor,type:Vs(r.name,this.schema)};r.type==="mark"&&((t=j(N(r,"keepOnSplit",n)))==null||t)&&this.splittableMarks.push(r.name);let i=N(r,"onBeforeCreate",n),o=N(r,"onCreate",n),s=N(r,"onUpdate",n),a=N(r,"onSelectionUpdate",n),l=N(r,"onTransaction",n),u=N(r,"onFocus",n),c=N(r,"onBlur",n),f=N(r,"onDestroy",n);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),s&&this.editor.on("update",s),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),u&&this.editor.on("focus",u),c&&this.editor.on("blur",c),f&&this.editor.on("destroy",f)})}};aa.resolve=ta;aa.sort=ea;aa.flatten=Qs;var ry={};Js(ry,{ClipboardTextSerializer:()=>iy,Commands:()=>oy,Delete:()=>sy,Drop:()=>ay,Editable:()=>ly,FocusEvents:()=>fy,Keymap:()=>dy,Paste:()=>hy,Tabindex:()=>py,TextDirection:()=>my,focusEventsPluginKey:()=>cy});var Sv=I(),dt=class ny extends oa{constructor(){super(...arguments),this.type="extension"}static create(r={}){let t=typeof r=="function"?r():r;return new ny(t)}configure(r){return super.configure(r)}extend(r){let t=typeof r=="function"?r():r;return super.extend(t)}},iy=dt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Sv.Plugin({key:new Sv.PluginKey("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{let{editor:e}=this,{state:r,schema:t}=e,{doc:n,selection:i}=r,{ranges:o}=i,s=Math.min(...o.map(c=>c.$from.pos)),a=Math.max(...o.map(c=>c.$to.pos)),l=na(t);return Nc(n,{from:s,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),oy=dt.create({name:"commands",addCommands(){return{...xc}}}),SN=at(),sy=dt.create({name:"delete",onUpdate({transaction:e,appendedTransactions:r}){var t,n,i;let o=()=>{var s,a,l,u;if((u=(l=(a=(s=this.editor.options.coreExtensionOptions)==null?void 0:s.delete)==null?void 0:a.filterTransaction)==null?void 0:l.call(a,e))!=null?u:e.getMeta("y-sync$"))return;let c=Iv(e.before,[e,...r]);Vv(c).forEach(h=>{c.mapping.mapResult(h.oldRange.from).deletedAfter&&c.mapping.mapResult(h.oldRange.to).deletedBefore&&c.before.nodesBetween(h.oldRange.from,h.oldRange.to,(p,m)=>{let v=m+p.nodeSize-2,g=h.oldRange.from<=m&&v<=h.oldRange.to;this.editor.emit("delete",{type:"node",node:p,from:m,to:v,newFrom:c.mapping.map(m),newTo:c.mapping.map(v),deletedRange:h.oldRange,newRange:h.newRange,partial:!g,editor:this.editor,transaction:e,combinedTransform:c})})});let d=c.mapping;c.steps.forEach((h,p)=>{var m,v;if(h instanceof SN.RemoveMarkStep){let g=d.slice(p).map(h.from,-1),y=d.slice(p).map(h.to),w=d.invert().map(g,-1),b=d.invert().map(y),k=(m=c.doc.nodeAt(g-1))==null?void 0:m.marks.some(T=>T.eq(h.mark)),x=(v=c.doc.nodeAt(y))==null?void 0:v.marks.some(T=>T.eq(h.mark));this.editor.emit("delete",{type:"mark",mark:h.mark,from:h.from,to:h.to,deletedRange:{from:w,to:b},newRange:{from:g,to:y},partial:!!(x||k),editor:this.editor,transaction:e,combinedTransform:c})}})};(i=(n=(t=this.editor.options.coreExtensionOptions)==null?void 0:t.delete)==null?void 0:n.async)==null||i?setTimeout(o,0):o()}}),xv=I(),ay=dt.create({name:"drop",addProseMirrorPlugins(){return[new xv.Plugin({key:new xv.PluginKey("tiptapDrop"),props:{handleDrop:(e,r,t,n)=>{this.editor.emit("drop",{editor:this.editor,event:r,slice:t,moved:n})}}})]}}),_v=I(),ly=dt.create({name:"editable",addProseMirrorPlugins(){return[new _v.Plugin({key:new _v.PluginKey("editable"),props:{editable:()=>this.editor.options.editable}})]}}),uy=I(),cy=new uy.PluginKey("focusEvents"),fy=dt.create({name:"focusEvents",addProseMirrorPlugins(){let{editor:e}=this;return[new uy.Plugin({key:cy,props:{handleDOMEvents:{focus:(r,t)=>{e.isFocused=!0;let n=e.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return r.dispatch(n),!1},blur:(r,t)=>{e.isFocused=!1;let n=e.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return r.dispatch(n),!1}}}})]}}),Zi=I(),dy=dt.create({name:"keymap",addKeyboardShortcuts(){let e=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{let{selection:l,doc:u}=a,{empty:c,$anchor:f}=l,{pos:d,parent:h}=f,p=f.parent.isTextblock&&d>0?a.doc.resolve(d-1):f,m=p.parent.type.spec.isolating,v=f.pos-f.parentOffset,g=m&&p.parent.childCount===1?v===f.pos:Zi.Selection.atStart(u).from===d;return!c||!h.type.isTextblock||h.textContent.length||!g||g&&f.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),r=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:r,"Mod-Delete":r,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},o={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":r,"Ctrl-Alt-Backspace":r,"Alt-Delete":r,"Alt-d":r,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return jn()||Ec()?o:i},addProseMirrorPlugins(){return[new Zi.Plugin({key:new Zi.PluginKey("clearDocument"),appendTransaction:(e,r,t)=>{if(e.some(m=>m.getMeta("composition")))return;let n=e.some(m=>m.docChanged)&&!r.doc.eq(t.doc),i=e.some(m=>m.getMeta("preventClearDocument"));if(!n||i)return;let{empty:o,from:s,to:a}=r.selection,l=Zi.Selection.atStart(r.doc).from,u=Zi.Selection.atEnd(r.doc).to;if(o||!(s===l&&a===u)||!ia(t.doc))return;let d=t.tr,h=eo({state:t,transaction:d}),{commands:p}=new to({editor:this.editor,state:h});if(p.clearNodes(),!!d.steps.length)return d}})]}}),Tv=I(),hy=dt.create({name:"paste",addProseMirrorPlugins(){return[new Tv.Plugin({key:new Tv.PluginKey("tiptapPaste"),props:{handlePaste:(e,r,t)=>{this.editor.emit("paste",{editor:this.editor,event:r,slice:t})}}})]}}),Ev=I(),py=dt.create({name:"tabindex",addProseMirrorPlugins(){return[new Ev.Plugin({key:new Ev.PluginKey("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),Cv=I(),my=dt.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];let{nodeExtensions:e}=en(this.extensions);return[{types:e.filter(r=>r.name!=="text").map(r=>r.name),attributes:{dir:{default:this.options.direction,parseHTML:r=>{let t=r.getAttribute("dir");return t&&(t==="ltr"||t==="rtl"||t==="auto")?t:this.options.direction},renderHTML:r=>r.dir?{dir:r.dir}:{}}}}]},addProseMirrorPlugins(){return[new Cv.Plugin({key:new Cv.PluginKey("textDirection"),props:{attributes:()=>{let e=this.options.direction;return e?{dir:e}:{}}}})]}}),gy=class Fn{constructor(r,t,n=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=r,this.editor=t,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var r;return(r=this.actualDepth)!=null?r:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(r){let t=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can\u2019t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},r)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;let r=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(r);return new Fn(t,this.editor)}get before(){let r=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return r.depth!==this.depth&&(r=this.resolvedPos.doc.resolve(this.from-3)),new Fn(r,this.editor)}get after(){let r=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return r.depth!==this.depth&&(r=this.resolvedPos.doc.resolve(this.to+3)),new Fn(r,this.editor)}get children(){let r=[];return this.node.content.forEach((t,n)=>{let i=t.isBlock&&!t.isTextblock,o=t.isAtom&&!t.isText,s=this.pos+n+(o?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;let a=this.resolvedPos.doc.resolve(s);if(!i&&a.depth<=this.depth)return;let l=new Fn(a,this.editor,i,i?t:null);i&&(l.actualDepth=this.depth+1),r.push(new Fn(a,this.editor,i,i?t:null))}),r}get firstChild(){return this.children[0]||null}get lastChild(){let r=this.children;return r[r.length-1]||null}closest(r,t={}){let n=null,i=this.parent;for(;i&&!n;){if(i.node.type.name===r)if(Object.keys(t).length>0){let o=i.node.attrs,s=Object.keys(t);for(let a=0;a<s.length;a+=1){let l=s[a];if(o[l]!==t[l])break}}else n=i;i=i.parent}return n}querySelector(r,t={}){return this.querySelectorAll(r,t,!0)[0]||null}querySelectorAll(r,t={},n=!1){let i=[];if(!this.children||this.children.length===0)return i;let o=Object.keys(t);return this.children.forEach(s=>{n&&i.length>0||(s.node.type.name===r&&o.every(l=>t[l]===s.node.attrs[l])&&i.push(s),!(n&&i.length>0)&&(i=i.concat(s.querySelectorAll(r,t,n))))}),i}setAttribute(r){let{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...r}),this.editor.view.dispatch(t)}},xN=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function vy(e,r,t){let n=document.querySelector(`style[data-tiptap-style${t?`-${t}`:""}]`);if(n!==null)return n;let i=document.createElement("style");return r&&i.setAttribute("nonce",r),i.setAttribute(`data-tiptap-style${t?`-${t}`:""}`,""),i.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(i),i}var _N=class extends fN{constructor(e={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:i,moved:o})=>this.options.onDrop(n,i,o)),this.on("paste",({event:n,slice:i})=>this.options.onPaste(n,i)),this.on("delete",this.options.onDelete);let r=this.createDoc(),t=Tc(r,this.options.autofocus);this.editorState=uN.EditorState.create({doc:r,schema:this.schema,selection:t||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){let e=this.editorView.dom;e?.editor&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=vy(xN,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,r=!0){this.setOptions({editable:e}),r&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,r)=>{if(this.editorView)return this.editorView[r];if(r==="state")return this.editorState;if(r in e)return Reflect.get(e,r);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${r}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,r){let t=Oc(r)?r(e,[...this.state.plugins]):[...this.state.plugins,e],n=this.state.reconfigure({plugins:t});return this.view.updateState(n),n}unregisterPlugin(e){if(this.isDestroyed)return;let r=this.state.plugins,t=r;if([].concat(e).forEach(i=>{let o=typeof i=="string"?`${i}$`:i.key;t=t.filter(s=>!s.key.startsWith(o))}),r.length===t.length)return;let n=this.state.reconfigure({plugins:t});return this.view.updateState(n),n}createExtensionManager(){var e,r;let n=[...this.options.enableCoreExtensions?[ly,iy.configure({blockSeparator:(r=(e=this.options.coreExtensionOptions)==null?void 0:e.clipboardTextSerializer)==null?void 0:r.blockSeparator}),oy,fy,dy,py,ay,hy,sy,my.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i?.type));this.extensionManager=new aa(n,this)}createCommandManager(){this.commandManager=new to({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=Us(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(r){if(!(r instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(r.message))throw r;this.emit("contentError",{editor:this,error:r,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(t=>t.name!=="collaboration"),this.createExtensionManager()}}),e=Us(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){var r;this.editorView=new cN.EditorView(e,{...this.options.editorProps,attributes:{role:"textbox",...(r=this.options.editorProps)==null?void 0:r.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});let t=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(t),this.prependClass(),this.injectCSS();let n=this.view.dom;n.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;let r=this.capturedTransaction;return this.capturedTransaction=null,r}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(u=>{var c;return(c=this.capturedTransaction)==null?void 0:c.step(u)});return}let{state:r,transactions:t}=this.state.applyTransaction(e),n=!this.state.selection.eq(r.selection),i=t.includes(e),o=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:r}),!i)return;this.view.updateState(r),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:t.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});let s=t.findLast(u=>u.getMeta("focus")||u.getMeta("blur")),a=s?.getMeta("focus"),l=s?.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:s}),l&&this.emit("blur",{editor:this,event:l.event,transaction:s}),!(e.getMeta("preventUpdate")||!t.some(u=>u.docChanged)||o.doc.eq(r.doc))&&this.emit("update",{editor:this,transaction:e,appendedTransactions:t.slice(1)})}getAttributes(e){return $v(this.state,e)}isActive(e,r){let t=typeof e=="string"?e:null,n=typeof e=="string"?r:e;return Jv(this.state,t,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return io(this.state.doc.content,this.schema)}getText(e){let{blockSeparator:r=`

`,textSerializers:t={}}=e||{};return Pc(this.state.doc,{blockSeparator:r,textSerializers:{...na(this.schema),...t}})}get isEmpty(){return ia(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,r;return(r=(e=this.editorView)==null?void 0:e.isDestroyed)!=null?r:!0}$node(e,r){var t;return((t=this.$doc)==null?void 0:t.querySelector(e,r))||null}$nodes(e,r){var t;return((t=this.$doc)==null?void 0:t.querySelectorAll(e,r))||null}$pos(e){let r=this.state.doc.resolve(e);return new gy(r,this)}get $doc(){return this.$pos(0)}};function TN(e){return new Hn({find:e.find,handler:({state:r,range:t,match:n})=>{let i=j(e.getAttributes,void 0,n);if(i===!1||i===null)return null;let{tr:o}=r,s=n[n.length-1],a=n[0];if(s){let l=a.search(/\S/),u=t.from+a.indexOf(s),c=u+s.length;if(Rc(t.from,t.to,r.doc).filter(h=>h.mark.type.excluded.find(m=>m===e.type&&m!==h.mark.type)).filter(h=>h.to>u).length)return null;c<t.to&&o.delete(c,t.to),u>t.from&&o.delete(t.from+l,u);let d=t.from+l+s.length;o.addMark(t.from+l,d,e.type.create(i||{})),o.removeStoredMark(e.type)}},undoable:e.undoable})}function EN(e){return new Hn({find:e.find,handler:({state:r,range:t,match:n})=>{let i=j(e.getAttributes,void 0,n)||{},{tr:o}=r,s=t.from,a=t.to,l=e.type.create(i);if(n[1]){let u=n[0].lastIndexOf(n[1]),c=s+u;c>a?c=a:a=c+n[1].length;let f=n[0][n[0].length-1];o.insertText(f,s+n[0].length-1),o.replaceWith(c,a,l)}else if(n[0]){let u=e.type.isInline?s:s-1;o.insert(u,e.type.create(i)).delete(o.mapping.map(s),o.mapping.map(a))}o.scrollIntoView()},undoable:e.undoable})}function CN(e){return new Hn({find:e.find,handler:({state:r,range:t,match:n})=>{let i=r.doc.resolve(t.from),o=j(e.getAttributes,void 0,n)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),e.type))return null;r.tr.delete(t.from,t.to).setBlockType(t.from,t.from,e.type,o)},undoable:e.undoable})}function ON(e){return new Hn({find:e.find,handler:({state:r,range:t,match:n})=>{let i=e.replace,o=t.from,s=t.to;if(n[1]){let a=n[0].lastIndexOf(n[1]);i+=n[0].slice(a+n[1].length),o+=a;let l=o-s;l>0&&(i=n[0].slice(a-l,a)+i,o=s)}r.tr.insertText(i,o,s)},undoable:e.undoable})}var Ov=at();function MN(e){return new Hn({find:e.find,handler:({state:r,range:t,match:n,chain:i})=>{let o=j(e.getAttributes,void 0,n)||{},s=r.tr.delete(t.from,t.to),l=s.doc.resolve(t.from).blockRange(),u=l&&(0,Ov.findWrapping)(l,e.type,o);if(!u)return null;if(s.wrap(l,u),e.keepMarks&&e.editor){let{selection:f,storedMarks:d}=r,{splittableMarks:h}=e.editor.extensionManager,p=d||f.$to.parentOffset&&f.$from.marks();if(p){let m=p.filter(v=>h.includes(v.type.name));s.ensureMarks(m)}}if(e.keepAttributes){let f=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(f,o).run()}let c=s.doc.resolve(t.from-1).nodeBefore;c&&c.type===e.type&&(0,Ov.canJoin)(s.doc,t.from-1)&&(!e.joinPredicate||e.joinPredicate(n,c))&&s.join(t.from-1)},undoable:e.undoable})}function AN(e){return e.children}var Mv=(e,r)=>{if(e==="slot")return 0;if(e instanceof Function)return e(r);let{children:t,...n}=r??{};if(e==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,n,t]},NN=e=>"touches"in e,yy=class{constructor(e){this.directions=["bottom-left","bottom-right","top-left","top-right"],this.minSize={height:8,width:8},this.preserveAspectRatio=!1,this.classNames={container:"",wrapper:"",handle:"",resizing:""},this.initialWidth=0,this.initialHeight=0,this.aspectRatio=1,this.isResizing=!1,this.activeHandle=null,this.startX=0,this.startY=0,this.startWidth=0,this.startHeight=0,this.isShiftKeyPressed=!1,this.handleMouseMove=s=>{if(!this.isResizing||!this.activeHandle)return;let a=s.clientX-this.startX,l=s.clientY-this.startY;this.handleResize(a,l)},this.handleTouchMove=s=>{if(!this.isResizing||!this.activeHandle)return;let a=s.touches[0];if(!a)return;let l=a.clientX-this.startX,u=a.clientY-this.startY;this.handleResize(l,u)},this.handleMouseUp=()=>{if(!this.isResizing)return;let s=this.element.offsetWidth,a=this.element.offsetHeight;this.onCommit(s,a),this.isResizing=!1,this.activeHandle=null,this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)},this.handleKeyDown=s=>{s.key==="Shift"&&(this.isShiftKeyPressed=!0)},this.handleKeyUp=s=>{s.key==="Shift"&&(this.isShiftKeyPressed=!1)};var r,t,n,i,o;this.node=e.node,this.element=e.element,this.contentElement=e.contentElement,this.getPos=e.getPos,this.onResize=e.onResize,this.onCommit=e.onCommit,this.onUpdate=e.onUpdate,(r=e.options)!=null&&r.min&&(this.minSize={...this.minSize,...e.options.min}),(t=e.options)!=null&&t.max&&(this.maxSize=e.options.max),(n=e?.options)!=null&&n.directions&&(this.directions=e.options.directions),(i=e.options)!=null&&i.preserveAspectRatio&&(this.preserveAspectRatio=e.options.preserveAspectRatio),(o=e.options)!=null&&o.className&&(this.classNames={container:e.options.className.container||"",wrapper:e.options.className.wrapper||"",handle:e.options.className.handle||"",resizing:e.options.className.resizing||""}),this.wrapper=this.createWrapper(),this.container=this.createContainer(),this.applyInitialSize(),this.attachHandles()}get dom(){return this.container}get contentDOM(){return this.contentElement}update(e,r,t){return e.type!==this.node.type?!1:(this.node=e,this.onUpdate?this.onUpdate(e,r,t):!0)}destroy(){this.isResizing&&(this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp),this.isResizing=!1,this.activeHandle=null),this.container.remove()}createContainer(){let e=document.createElement("div");return e.dataset.resizeContainer="",e.dataset.node=this.node.type.name,e.style.display="flex",e.style.justifyContent="flex-start",e.style.alignItems="flex-start",this.classNames.container&&(e.className=this.classNames.container),e.appendChild(this.wrapper),e}createWrapper(){let e=document.createElement("div");return e.style.position="relative",e.style.display="block",e.dataset.resizeWrapper="",this.classNames.wrapper&&(e.className=this.classNames.wrapper),e.appendChild(this.element),e}createHandle(e){let r=document.createElement("div");return r.dataset.resizeHandle=e,r.style.position="absolute",this.classNames.handle&&(r.className=this.classNames.handle),r}positionHandle(e,r){let t=r.includes("top"),n=r.includes("bottom"),i=r.includes("left"),o=r.includes("right");t&&(e.style.top="0"),n&&(e.style.bottom="0"),i&&(e.style.left="0"),o&&(e.style.right="0"),(r==="top"||r==="bottom")&&(e.style.left="0",e.style.right="0"),(r==="left"||r==="right")&&(e.style.top="0",e.style.bottom="0")}attachHandles(){this.directions.forEach(e=>{let r=this.createHandle(e);this.positionHandle(r,e),r.addEventListener("mousedown",t=>this.handleResizeStart(t,e)),r.addEventListener("touchstart",t=>this.handleResizeStart(t,e)),this.wrapper.appendChild(r)})}applyInitialSize(){let e=this.node.attrs.width,r=this.node.attrs.height;e?(this.element.style.width=`${e}px`,this.initialWidth=e):this.initialWidth=this.element.offsetWidth,r?(this.element.style.height=`${r}px`,this.initialHeight=r):this.initialHeight=this.element.offsetHeight,this.initialWidth>0&&this.initialHeight>0&&(this.aspectRatio=this.initialWidth/this.initialHeight)}handleResizeStart(e,r){e.preventDefault(),e.stopPropagation(),this.isResizing=!0,this.activeHandle=r,NN(e)?(this.startX=e.touches[0].clientX,this.startY=e.touches[0].clientY):(this.startX=e.clientX,this.startY=e.clientY),this.startWidth=this.element.offsetWidth,this.startHeight=this.element.offsetHeight,this.startWidth>0&&this.startHeight>0&&(this.aspectRatio=this.startWidth/this.startHeight);let t=this.getPos();this.container.dataset.resizeState="true",this.classNames.resizing&&this.container.classList.add(this.classNames.resizing),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}handleResize(e,r){if(!this.activeHandle)return;let t=this.preserveAspectRatio||this.isShiftKeyPressed,{width:n,height:i}=this.calculateNewDimensions(this.activeHandle,e,r),o=this.applyConstraints(n,i,t);this.element.style.width=`${o.width}px`,this.element.style.height=`${o.height}px`,this.onResize&&this.onResize(o.width,o.height)}calculateNewDimensions(e,r,t){let n=this.startWidth,i=this.startHeight,o=e.includes("right"),s=e.includes("left"),a=e.includes("bottom"),l=e.includes("top");return o?n=this.startWidth+r:s&&(n=this.startWidth-r),a?i=this.startHeight+t:l&&(i=this.startHeight-t),(e==="right"||e==="left")&&(n=this.startWidth+(o?r:-r)),(e==="top"||e==="bottom")&&(i=this.startHeight+(a?t:-t)),this.preserveAspectRatio||this.isShiftKeyPressed?this.applyAspectRatio(n,i,e):{width:n,height:i}}applyConstraints(e,r,t){var n,i,o,s;if(!t){let u=Math.max(this.minSize.width,e),c=Math.max(this.minSize.height,r);return(n=this.maxSize)!=null&&n.width&&(u=Math.min(this.maxSize.width,u)),(i=this.maxSize)!=null&&i.height&&(c=Math.min(this.maxSize.height,c)),{width:u,height:c}}let a=e,l=r;return a<this.minSize.width&&(a=this.minSize.width,l=a/this.aspectRatio),l<this.minSize.height&&(l=this.minSize.height,a=l*this.aspectRatio),(o=this.maxSize)!=null&&o.width&&a>this.maxSize.width&&(a=this.maxSize.width,l=a/this.aspectRatio),(s=this.maxSize)!=null&&s.height&&l>this.maxSize.height&&(l=this.maxSize.height,a=l*this.aspectRatio),{width:a,height:l}}applyAspectRatio(e,r,t){let n=t==="left"||t==="right",i=t==="top"||t==="bottom";return n?{width:e,height:e/this.aspectRatio}:i?{width:r*this.aspectRatio,height:r}:{width:e,height:e/this.aspectRatio}}},PN=yy,RN=I();function DN(e,r){let{selection:t}=e,{$from:n}=t;if(t instanceof RN.NodeSelection){let o=n.index();return n.parent.canReplaceWith(o,o+1,r)}let i=n.depth;for(;i>=0;){let o=n.index(i);if(n.node(i).contentMatchAt(o).matchType(r))return!0;i-=1}return!1}function IN(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function LN(e){return typeof e=="string"}var by={};Js(by,{createAtomBlockMarkdownSpec:()=>ky,createBlockMarkdownSpec:()=>wy,createInlineMarkdownSpec:()=>Sy,parseAttributes:()=>la,parseIndentedBlocks:()=>xy,renderNestedMarkdownContent:()=>_y,serializeAttributes:()=>ua});function la(e){if(!e?.trim())return{};let r={},t=[],n=e.replace(/["']([^"']*)["']/g,u=>(t.push(u),`__QUOTED_${t.length-1}__`)),i=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){let u=i.map(c=>c.trim().slice(1));r.class=u.join(" ")}let o=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);o&&(r.id=o[1]);let s=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(s)).forEach(([,u,c])=>{var f;let d=parseInt(((f=c.match(/__QUOTED_(\d+)__/))==null?void 0:f[1])||"0",10),h=t[d];h&&(r[u]=h.slice(1,-1))});let l=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(c=>{c.match(/^[a-zA-Z][\w-]*$/)&&(r[c]=!0)}),r}function ua(e){if(!e||Object.keys(e).length===0)return"";let r=[];return e.class&&String(e.class).split(/\s+/).filter(Boolean).forEach(n=>r.push(`.${n}`)),e.id&&r.push(`#${e.id}`),Object.entries(e).forEach(([t,n])=>{t==="class"||t==="id"||(n===!0?r.push(t):n!==!1&&n!=null&&r.push(`${t}="${String(n)}"`))}),r.join(" ")}function ky(e){let{nodeName:r,name:t,parseAttributes:n=la,serializeAttributes:i=ua,defaultAttributes:o={},requiredAttributes:s=[],allowedAttributes:a}=e,l=t||r,u=c=>{if(!a)return c;let f={};return a.forEach(d=>{d in c&&(f[d]=c[d])}),f};return{parseMarkdown:(c,f)=>{let d={...o,...c.attributes};return f.createNode(r,d,[])},markdownTokenizer:{name:r,level:"block",start(c){var f;let d=new RegExp(`^:::${l}(?:\\s|$)`,"m"),h=(f=c.match(d))==null?void 0:f.index;return h!==void 0?h:-1},tokenize(c,f,d){let h=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),p=c.match(h);if(!p)return;let m=p[1]||"",v=n(m);if(!s.find(y=>!(y in v)))return{type:r,raw:p[0],attributes:v}}},renderMarkdown:c=>{let f=u(c.attrs||{}),d=i(f),h=d?` {${d}}`:"";return`:::${l}${h} :::`}}}function wy(e){let{nodeName:r,name:t,getContent:n,parseAttributes:i=la,serializeAttributes:o=ua,defaultAttributes:s={},content:a="block",allowedAttributes:l}=e,u=t||r,c=f=>{if(!l)return f;let d={};return l.forEach(h=>{h in f&&(d[h]=f[h])}),d};return{parseMarkdown:(f,d)=>{let h;if(n){let m=n(f);h=typeof m=="string"?[{type:"text",text:m}]:m}else a==="block"?h=d.parseChildren(f.tokens||[]):h=d.parseInline(f.tokens||[]);let p={...s,...f.attributes};return d.createNode(r,p,h)},markdownTokenizer:{name:r,level:"block",start(f){var d;let h=new RegExp(`^:::${u}`,"m"),p=(d=f.match(h))==null?void 0:d.index;return p!==void 0?p:-1},tokenize(f,d,h){var p;let m=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),v=f.match(m);if(!v)return;let[g,y=""]=v,w=i(y),b=1,k=g.length,x="",T=/^:::([\w-]*)(\s.*)?/gm,_=f.slice(k);for(T.lastIndex=0;;){let C=T.exec(_);if(C===null)break;let A=C.index,O=C[1];if(!((p=C[2])!=null&&p.endsWith(":::"))){if(O)b+=1;else if(b-=1,b===0){let B=_.slice(0,A);x=B.trim();let U=f.slice(0,k+A+C[0].length),V=[];if(x)if(a==="block")for(V=h.blockTokens(B),V.forEach(Z=>{Z.text&&(!Z.tokens||Z.tokens.length===0)&&(Z.tokens=h.inlineTokens(Z.text))});V.length>0;){let Z=V[V.length-1];if(Z.type==="paragraph"&&(!Z.text||Z.text.trim()===""))V.pop();else break}else V=h.inlineTokens(x);return{type:r,raw:U,attributes:w,content:x,tokens:V}}}}}},renderMarkdown:(f,d)=>{let h=c(f.attrs||{}),p=o(h),m=p?` {${p}}`:"",v=d.renderChildren(f.content||[],`

`);return`:::${u}${m}

${v}

:::`}}}function FN(e){if(!e.trim())return{};let r={},t=/(\w+)=(?:"([^"]*)"|'([^']*)')/g,n=t.exec(e);for(;n!==null;){let[,i,o,s]=n;r[i]=o||s,n=t.exec(e)}return r}function BN(e){return Object.entries(e).filter(([,r])=>r!=null).map(([r,t])=>`${r}="${t}"`).join(" ")}function Sy(e){let{nodeName:r,name:t,getContent:n,parseAttributes:i=FN,serializeAttributes:o=BN,defaultAttributes:s={},selfClosing:a=!1,allowedAttributes:l}=e,u=t||r,c=d=>{if(!l)return d;let h={};return l.forEach(p=>{p in d&&(h[p]=d[p])}),h},f=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(d,h)=>{let p={...s,...d.attributes};if(a)return h.createNode(r,p);let m=n?n(d):d.content||"";return m?h.createNode(r,p,[h.createTextNode(m)]):h.createNode(r,p,[])},markdownTokenizer:{name:r,level:"inline",start(d){let h=a?new RegExp(`\\[${f}\\s*[^\\]]*\\]`):new RegExp(`\\[${f}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${f}\\]`),p=d.match(h),m=p?.index;return m!==void 0?m:-1},tokenize(d,h,p){let m=a?new RegExp(`^\\[${f}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${f}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${f}\\]`),v=d.match(m);if(!v)return;let g="",y="";if(a){let[,b]=v;y=b}else{let[,b,k]=v;y=b,g=k||""}let w=i(y.trim());return{type:r,raw:v[0],content:g.trim(),attributes:w}}},renderMarkdown:d=>{let h="";n?h=n(d):d.content&&d.content.length>0&&(h=d.content.filter(g=>g.type==="text").map(g=>g.text).join(""));let p=c(d.attrs||{}),m=o(p),v=m?` ${m}`:"";return a?`[${u}${v}]`:`[${u}${v}]${h}[/${u}]`}}}function xy(e,r,t){var n,i,o,s;let a=e.split(`
`),l=[],u="",c=0,f=r.baseIndentSize||2;for(;c<a.length;){let d=a[c],h=d.match(r.itemPattern);if(!h){if(l.length>0)break;if(d.trim()===""){c+=1,u=`${u}${d}
`;continue}else return}let p=r.extractItemData(h),{indentLevel:m,mainContent:v}=p;u=`${u}${d}
`;let g=[v];for(c+=1;c<a.length;){let k=a[c];if(k.trim()===""){let T=a.slice(c+1).findIndex(A=>A.trim()!=="");if(T===-1)break;if((((i=(n=a[c+1+T].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:i.length)||0)>m){g.push(k),u=`${u}${k}
`,c+=1;continue}else break}if((((s=(o=k.match(/^(\s*)/))==null?void 0:o[1])==null?void 0:s.length)||0)>m)g.push(k),u=`${u}${k}
`,c+=1;else break}let y,w=g.slice(1);if(w.length>0){let k=w.map(x=>x.slice(m+f)).join(`
`);k.trim()&&(r.customNestedParser?y=r.customNestedParser(k):y=t.blockTokens(k))}let b=r.createToken(p,y);l.push(b)}if(l.length!==0)return{items:l,raw:u}}function _y(e,r,t,n){if(!e||!Array.isArray(e.content))return"";let i=typeof t=="function"?t(n):t,[o,...s]=e.content,a=r.renderChildren([o]),l=[`${i}${a}`];return s&&s.length>0&&s.forEach(u=>{let c=r.renderChildren([u]);if(c){let f=c.split(`
`).map(d=>d?r.indent(d):"").join(`
`);l.push(f)}}),l.join(`
`)}function Ic(e,r,t={}){let{state:n}=r,{doc:i,tr:o}=n,s=e;i.descendants((a,l)=>{let u=o.mapping.map(l),c=o.mapping.map(l)+a.nodeSize,f=null;if(a.marks.forEach(h=>{if(h!==s)return!1;f=h}),!f)return;let d=!1;if(Object.keys(t).forEach(h=>{t[h]!==f.attrs[h]&&(d=!0)}),d){let h=e.type.create({...e.attrs,...t});o.removeMark(u,c,e.type),o.addMark(u,c,h)}}),o.docChanged&&r.view.dispatch(o)}var zN=class{constructor(e,r,t){this.component=e,this.editor=r.editor,this.options={...t},this.mark=r.mark,this.HTMLAttributes=r.HTMLAttributes}get dom(){return this.editor.view.dom}get contentDOM(){return null}updateAttributes(e,r){Ic(r||this.mark,this.editor,e)}ignoreMutation(e){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:e}):e.type==="selection"||this.dom.contains(e.target)&&e.type==="childList"&&(jn()||Xs())&&this.editor.isFocused&&[...Array.from(e.addedNodes),...Array.from(e.removedNodes)].every(t=>t.isContentEditable)?!1:this.contentDOM===e.target&&e.type==="attributes"?!0:!this.contentDOM.contains(e.target)}},qN=class Ty extends oa{constructor(){super(...arguments),this.type="node"}static create(r={}){let t=typeof r=="function"?r():r;return new Ty(t)}configure(r){return super.configure(r)}extend(r){let t=typeof r=="function"?r():r;return super.extend(t)}},Av=I(),jN=class{constructor(e,r,t){this.isDragging=!1,this.component=e,this.editor=r.editor,this.options={stopEvent:null,ignoreMutation:null,...t},this.extension=r.extension,this.node=r.node,this.decorations=r.decorations,this.innerDecorations=r.innerDecorations,this.view=r.view,this.HTMLAttributes=r.HTMLAttributes,this.getPos=r.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(e){var r,t,n,i,o,s,a;let{view:l}=this.editor,u=e.target,c=u.nodeType===3?(r=u.parentElement)==null?void 0:r.closest("[data-drag-handle]"):u.closest("[data-drag-handle]");if(!this.dom||(t=this.contentDOM)!=null&&t.contains(u)||!c)return;let f=0,d=0;if(this.dom!==c){let y=this.dom.getBoundingClientRect(),w=c.getBoundingClientRect(),b=(i=e.offsetX)!=null?i:(n=e.nativeEvent)==null?void 0:n.offsetX,k=(s=e.offsetY)!=null?s:(o=e.nativeEvent)==null?void 0:o.offsetY;f=w.x-y.x+b,d=w.y-y.y+k}let h=this.dom.cloneNode(!0);try{let y=this.dom.getBoundingClientRect();h.style.width=`${Math.round(y.width)}px`,h.style.height=`${Math.round(y.height)}px`,h.style.boxSizing="border-box",h.style.pointerEvents="none"}catch{}let p=null;try{p=document.createElement("div"),p.style.position="absolute",p.style.top="-9999px",p.style.left="-9999px",p.style.pointerEvents="none",p.appendChild(h),document.body.appendChild(p),(a=e.dataTransfer)==null||a.setDragImage(h,f,d)}finally{p&&setTimeout(()=>{try{p?.remove()}catch{}},0)}let m=this.getPos();if(typeof m!="number")return;let v=Av.NodeSelection.create(l.state.doc,m),g=l.state.tr.setSelection(v);l.dispatch(g)}stopEvent(e){var r;if(!this.dom)return!1;if(typeof this.options.stopEvent=="function")return this.options.stopEvent({event:e});let t=e.target;if(!(this.dom.contains(t)&&!((r=this.contentDOM)!=null&&r.contains(t))))return!1;let i=e.type.startsWith("drag"),o=e.type==="drop";if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(t.tagName)||t.isContentEditable)&&!o&&!i)return!0;let{isEditable:a}=this.editor,{isDragging:l}=this,u=!!this.node.type.spec.draggable,c=Av.NodeSelection.isSelectable(this.node),f=e.type==="copy",d=e.type==="paste",h=e.type==="cut",p=e.type==="mousedown";if(!u&&c&&i&&e.target===this.dom&&e.preventDefault(),u&&i&&!l&&e.target===this.dom)return e.preventDefault(),!1;if(u&&a&&!l&&p){let m=t.closest("[data-drag-handle]");m&&(this.dom===m||this.dom.contains(m))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(l||o||f||d||h||p&&c)}ignoreMutation(e){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:e}):this.node.isLeaf||this.node.isAtom?!0:e.type==="selection"||this.dom.contains(e.target)&&e.type==="childList"&&(jn()||Xs())&&this.editor.isFocused&&[...Array.from(e.addedNodes),...Array.from(e.removedNodes)].every(t=>t.isContentEditable)?!1:this.contentDOM===e.target&&e.type==="attributes"?!0:!this.contentDOM.contains(e.target)}updateAttributes(e){this.editor.commands.command(({tr:r})=>{let t=this.getPos();return typeof t!="number"?!1:(r.setNodeMarkup(t,void 0,{...this.node.attrs,...e}),!0)})}deleteNode(){let e=this.getPos();if(typeof e!="number")return;let r=e+this.node.nodeSize;this.editor.commands.deleteRange({from:e,to:r})}};function HN(e){return new sa({find:e.find,handler:({state:r,range:t,match:n,pasteEvent:i})=>{let o=j(e.getAttributes,void 0,n,i);if(o===!1||o===null)return null;let{tr:s}=r,a=n[n.length-1],l=n[0],u=t.to;if(a){let c=l.search(/\S/),f=t.from+l.indexOf(a),d=f+a.length;if(Rc(t.from,t.to,r.doc).filter(p=>p.mark.type.excluded.find(v=>v===e.type&&v!==p.mark.type)).filter(p=>p.to>f).length)return null;d<t.to&&s.delete(d,t.to),f>t.from&&s.delete(t.from+c,f),u=t.from+c+a.length,s.addMark(t.from+c,u,e.type.create(o||{})),s.removeStoredMark(e.type)}}})}function $N(e){return new sa({find:e.find,handler({match:r,chain:t,range:n,pasteEvent:i}){let o=j(e.getAttributes,void 0,r,i),s=j(e.getContent,void 0,o);if(o===!1||o===null)return null;let a={type:e.type.name,attrs:o};s&&(a.content=s),r.input&&t().deleteRange(n).insertContentAt(n.from,a)}})}function WN(e){return new sa({find:e.find,handler:({state:r,range:t,match:n})=>{let i=e.replace,o=t.from,s=t.to;if(n[1]){let a=n[0].lastIndexOf(n[1]);i+=n[0].slice(a+n[1].length),o+=a;let l=o-s;l>0&&(i=n[0].slice(a-l,a)+i,o=s)}r.tr.insertText(i,o,s)}})}var VN=class{constructor(e){this.transaction=e,this.currentStep=this.transaction.steps.length}map(e){let r=!1;return{position:this.transaction.steps.slice(this.currentStep).reduce((n,i)=>{let o=i.getMap().mapResult(n);return o.deleted&&(r=!0),o.pos},e),deleted:r}}}});var My=S((tH,Oy)=>{"use strict";var Lc=Object.defineProperty,UN=Object.getOwnPropertyDescriptor,KN=Object.getOwnPropertyNames,JN=Object.prototype.hasOwnProperty,ZN=(e,r)=>{for(var t in r)Lc(e,t,{get:r[t],enumerable:!0})},GN=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of KN(r))!JN.call(e,i)&&i!==t&&Lc(e,i,{get:()=>r[i],enumerable:!(n=UN(r,i))||n.enumerable});return e},XN=e=>GN(Lc({},"__esModule",{value:!0}),e),Cy={};ZN(Cy,{Fragment:()=>YN,createElement:()=>oo,h:()=>oo,jsx:()=>oo,jsxDEV:()=>oo,jsxs:()=>oo});Oy.exports=XN(Cy);function YN(e){return e.children}var oo=(e,r)=>{if(e==="slot")return 0;if(e instanceof Function)return e(r);let{children:t,...n}=r??{};if(e==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,n,t]}});var Fc=S((rH,Ay)=>{Ay.exports=My()});var Ly=S((nH,Iy)=>{"use strict";var zc=Object.defineProperty,QN=Object.getOwnPropertyDescriptor,eP=Object.getOwnPropertyNames,tP=Object.prototype.hasOwnProperty,rP=(e,r)=>{for(var t in r)zc(e,t,{get:r[t],enumerable:!0})},nP=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of eP(r))!tP.call(e,i)&&i!==t&&zc(e,i,{get:()=>r[i],enumerable:!(n=QN(r,i))||n.enumerable});return e},iP=e=>nP(zc({},"__esModule",{value:!0}),e),Py={};rP(Py,{Blockquote:()=>Dy,default:()=>oP,inputRegex:()=>Ry});Iy.exports=iP(Py);var Bc=P(),Ny=Fc(),Ry=/^\s*>\s$/,Dy=Bc.Node.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return(0,Ny.jsx)("blockquote",{...(0,Bc.mergeAttributes)(this.options.HTMLAttributes,e),children:(0,Ny.jsx)("slot",{})})},parseMarkdown:(e,r)=>r.createNode("blockquote",void 0,r.parseChildren(e.tokens||[])),renderMarkdown:(e,r)=>{if(!e.content)return"";let t=">",n=[];return e.content.forEach(i=>{let a=r.renderChildren([i]).split(`
`).map(l=>l.trim()===""?t:`${t} ${l}`);n.push(a.join(`
`))}),n.join(`
${t}
`)},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[(0,Bc.wrappingInputRule)({find:Ry,type:this.type})]}}),oP=Dy});var Vy=S((iH,Wy)=>{"use strict";var qc=Object.defineProperty,sP=Object.getOwnPropertyDescriptor,aP=Object.getOwnPropertyNames,lP=Object.prototype.hasOwnProperty,uP=(e,r)=>{for(var t in r)qc(e,t,{get:r[t],enumerable:!0})},cP=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of aP(r))!lP.call(e,i)&&i!==t&&qc(e,i,{get:()=>r[i],enumerable:!(n=sP(r,i))||n.enumerable});return e},fP=e=>cP(qc({},"__esModule",{value:!0}),e),By={};uP(By,{Bold:()=>$y,default:()=>dP,starInputRegex:()=>zy,starPasteRegex:()=>qy,underscoreInputRegex:()=>jy,underscorePasteRegex:()=>Hy});Wy.exports=fP(By);var $n=P(),Fy=Fc(),zy=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,qy=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,jy=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Hy=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,$y=$n.Mark.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return(0,Fy.jsx)("strong",{...(0,$n.mergeAttributes)(this.options.HTMLAttributes,e),children:(0,Fy.jsx)("slot",{})})},markdownTokenName:"strong",parseMarkdown:(e,r)=>r.applyMark("bold",r.parseInline(e.tokens||[])),renderMarkdown:(e,r)=>`**${r.renderChildren(e)}**`,addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[(0,$n.markInputRule)({find:zy,type:this.type}),(0,$n.markInputRule)({find:jy,type:this.type})]},addPasteRules(){return[(0,$n.markPasteRule)({find:qy,type:this.type}),(0,$n.markPasteRule)({find:Hy,type:this.type})]}}),dP=$y});var Xy=S((oH,Gy)=>{"use strict";var jc=Object.defineProperty,hP=Object.getOwnPropertyDescriptor,pP=Object.getOwnPropertyNames,mP=Object.prototype.hasOwnProperty,gP=(e,r)=>{for(var t in r)jc(e,t,{get:r[t],enumerable:!0})},vP=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of pP(r))!mP.call(e,i)&&i!==t&&jc(e,i,{get:()=>r[i],enumerable:!(n=hP(r,i))||n.enumerable});return e},yP=e=>vP(jc({},"__esModule",{value:!0}),e),Uy={};gP(Uy,{Code:()=>Zy,default:()=>bP,inputRegex:()=>Ky,pasteRegex:()=>Jy});Gy.exports=yP(Uy);var ca=P(),Ky=/(^|[^`])`([^`]+)`(?!`)$/,Jy=/(^|[^`])`([^`]+)`(?!`)/g,Zy=ca.Mark.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",(0,ca.mergeAttributes)(this.options.HTMLAttributes,e),0]},markdownTokenName:"codespan",parseMarkdown:(e,r)=>r.applyMark("code",[{type:"text",text:e.text||""}]),renderMarkdown:(e,r)=>e.content?`\`${r.renderChildren(e.content)}\``:"",addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[(0,ca.markInputRule)({find:Ky,type:this.type})]},addPasteRules(){return[(0,ca.markPasteRule)({find:Jy,type:this.type})]}}),bP=Zy});var n0=S((sH,r0)=>{"use strict";var $c=Object.defineProperty,kP=Object.getOwnPropertyDescriptor,wP=Object.getOwnPropertyNames,SP=Object.prototype.hasOwnProperty,xP=(e,r)=>{for(var t in r)$c(e,t,{get:r[t],enumerable:!0})},_P=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of wP(r))!SP.call(e,i)&&i!==t&&$c(e,i,{get:()=>r[i],enumerable:!(n=kP(r,i))||n.enumerable});return e},TP=e=>_P($c({},"__esModule",{value:!0}),e),Yy={};xP(Yy,{CodeBlock:()=>t0,backtickInputRegex:()=>Qy,default:()=>EP,tildeInputRegex:()=>e0});r0.exports=TP(Yy);var fa=P(),so=I(),Hc=4,Qy=/^```([a-z]+)?[\s\n]$/,e0=/^~~~([a-z]+)?[\s\n]$/,t0=fa.Node.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:Hc,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var r;let{languageClassPrefix:t}=this.options;if(!t)return null;let o=[...((r=e.firstElementChild)==null?void 0:r.classList)||[]].filter(s=>s.startsWith(t)).map(s=>s.replace(t,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:r}){return["pre",(0,fa.mergeAttributes)(this.options.HTMLAttributes,r),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,r)=>{var t;return((t=e.raw)==null?void 0:t.startsWith("```"))===!1&&e.codeBlockStyle!=="indented"?[]:r.createNode("codeBlock",{language:e.lang||null},e.text?[r.createTextNode(e.text)]:[])},renderMarkdown:(e,r)=>{var t;let n="",i=((t=e.attrs)==null?void 0:t.language)||"";return e.content?n=[`\`\`\`${i}`,r.renderChildren(e.content),"```"].join(`
`):n=`\`\`\`${i}

\`\`\``,n},addCommands(){return{setCodeBlock:e=>({commands:r})=>r.setNode(this.name,e),toggleCodeBlock:e=>({commands:r})=>r.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{let{empty:e,$anchor:r}=this.editor.state.selection,t=r.pos===1;return!e||r.parent.type.name!==this.name?!1:t||!r.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:e})=>{var r;if(!this.options.enableTabIndentation)return!1;let t=(r=this.options.tabSize)!=null?r:Hc,{state:n}=e,{selection:i}=n,{$from:o,empty:s}=i;if(o.parent.type!==this.type)return!1;let a=" ".repeat(t);return s?e.commands.insertContent(a):e.commands.command(({tr:l})=>{let{from:u,to:c}=i,h=n.doc.textBetween(u,c,`
`,`
`).split(`
`).map(p=>a+p).join(`
`);return l.replaceWith(u,c,n.schema.text(h)),!0})},"Shift-Tab":({editor:e})=>{var r;if(!this.options.enableTabIndentation)return!1;let t=(r=this.options.tabSize)!=null?r:Hc,{state:n}=e,{selection:i}=n,{$from:o,empty:s}=i;return o.parent.type!==this.type?!1:s?e.commands.command(({tr:a})=>{var l;let{pos:u}=o,c=o.start(),f=o.end(),h=n.doc.textBetween(c,f,`
`,`
`).split(`
`),p=0,m=0,v=u-c;for(let x=0;x<h.length;x+=1){if(m+h[x].length>=v){p=x;break}m+=h[x].length+1}let y=((l=h[p].match(/^ */))==null?void 0:l[0])||"",w=Math.min(y.length,t);if(w===0)return!0;let b=c;for(let x=0;x<p;x+=1)b+=h[x].length+1;return a.delete(b,b+w),u-b<=w&&a.setSelection(so.TextSelection.create(a.doc,b)),!0}):e.commands.command(({tr:a})=>{let{from:l,to:u}=i,d=n.doc.textBetween(l,u,`
`,`
`).split(`
`).map(h=>{var p;let m=((p=h.match(/^ */))==null?void 0:p[0])||"",v=Math.min(m.length,t);return h.slice(v)}).join(`
`);return a.replaceWith(l,u,n.schema.text(d)),!0})},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;let{state:r}=e,{selection:t}=r,{$from:n,empty:i}=t;if(!i||n.parent.type!==this.type)return!1;let o=n.parentOffset===n.parent.nodeSize-2,s=n.parent.textContent.endsWith(`

`);return!o||!s?!1:e.chain().command(({tr:a})=>(a.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;let{state:r}=e,{selection:t,doc:n}=r,{$from:i,empty:o}=t;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;let a=i.after();return a===void 0?!1:n.nodeAt(a)?e.commands.command(({tr:u})=>(u.setSelection(so.Selection.near(n.resolve(a))),!0)):e.commands.exitCode()}}},addInputRules(){return[(0,fa.textblockTypeInputRule)({find:Qy,type:this.type,getAttributes:e=>({language:e[1]})}),(0,fa.textblockTypeInputRule)({find:e0,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new so.Plugin({key:new so.PluginKey("codeBlockVSCodeHandler"),props:{handlePaste:(e,r)=>{if(!r.clipboardData||this.editor.isActive(this.type.name))return!1;let t=r.clipboardData.getData("text/plain"),n=r.clipboardData.getData("vscode-editor-data"),i=n?JSON.parse(n):void 0,o=i?.mode;if(!t||!o)return!1;let{tr:s,schema:a}=e.state,l=a.text(t.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(so.TextSelection.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),e.dispatch(s),!0}}})]}}),EP=t0});var a0=S((aH,s0)=>{"use strict";var Wc=Object.defineProperty,CP=Object.getOwnPropertyDescriptor,OP=Object.getOwnPropertyNames,MP=Object.prototype.hasOwnProperty,AP=(e,r)=>{for(var t in r)Wc(e,t,{get:r[t],enumerable:!0})},NP=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of OP(r))!MP.call(e,i)&&i!==t&&Wc(e,i,{get:()=>r[i],enumerable:!(n=CP(r,i))||n.enumerable});return e},PP=e=>NP(Wc({},"__esModule",{value:!0}),e),i0={};AP(i0,{Document:()=>o0,default:()=>DP});s0.exports=PP(i0);var RP=P(),o0=RP.Node.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(e,r)=>e.content?r.renderChildren(e.content,`

`):""}),DP=o0});var d0=S((lH,f0)=>{"use strict";var Vc=Object.defineProperty,IP=Object.getOwnPropertyDescriptor,LP=Object.getOwnPropertyNames,FP=Object.prototype.hasOwnProperty,BP=(e,r)=>{for(var t in r)Vc(e,t,{get:r[t],enumerable:!0})},zP=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of LP(r))!FP.call(e,i)&&i!==t&&Vc(e,i,{get:()=>r[i],enumerable:!(n=IP(r,i))||n.enumerable});return e},qP=e=>zP(Vc({},"__esModule",{value:!0}),e),u0={};BP(u0,{HardBreak:()=>c0,default:()=>jP});f0.exports=qP(u0);var l0=P(),c0=l0.Node.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",(0,l0.mergeAttributes)(this.options.HTMLAttributes,e)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:e,chain:r,state:t,editor:n})=>e.first([()=>e.exitCode(),()=>e.command(()=>{let{selection:i,storedMarks:o}=t;if(i.$from.parent.type.spec.isolating)return!1;let{keepMarks:s}=this.options,{splittableMarks:a}=n.extensionManager,l=o||i.$to.parentOffset&&i.$from.marks();return r().insertContent({type:this.name}).command(({tr:u,dispatch:c})=>{if(c&&l&&s){let f=l.filter(d=>a.includes(d.type.name));u.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),jP=c0});var Jc=S((uH,m0)=>{"use strict";var Kc=Object.defineProperty,HP=Object.getOwnPropertyDescriptor,$P=Object.getOwnPropertyNames,WP=Object.prototype.hasOwnProperty,VP=(e,r)=>{for(var t in r)Kc(e,t,{get:r[t],enumerable:!0})},UP=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of $P(r))!WP.call(e,i)&&i!==t&&Kc(e,i,{get:()=>r[i],enumerable:!(n=HP(r,i))||n.enumerable});return e},KP=e=>UP(Kc({},"__esModule",{value:!0}),e),h0={};VP(h0,{Heading:()=>p0,default:()=>JP});m0.exports=KP(h0);var Uc=P(),p0=Uc.Node.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:r}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,(0,Uc.mergeAttributes)(this.options.HTMLAttributes,r),0]},parseMarkdown:(e,r)=>r.createNode("heading",{level:e.depth||1},r.parseInline(e.tokens||[])),renderMarkdown:(e,r)=>{var t;let n=(t=e.attrs)!=null&&t.level?parseInt(e.attrs.level,10):1,i="#".repeat(n);return e.content?`${i} ${r.renderChildren(e.content)}`:""},addCommands(){return{setHeading:e=>({commands:r})=>this.options.levels.includes(e.level)?r.setNode(this.name,e):!1,toggleHeading:e=>({commands:r})=>this.options.levels.includes(e.level)?r.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,r)=>({...e,[`Mod-Alt-${r}`]:()=>this.editor.commands.toggleHeading({level:r})}),{})},addInputRules(){return this.options.levels.map(e=>(0,Uc.textblockTypeInputRule)({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),JP=p0});var b0=S((cH,y0)=>{"use strict";var Zc=Object.defineProperty,ZP=Object.getOwnPropertyDescriptor,GP=Object.getOwnPropertyNames,XP=Object.prototype.hasOwnProperty,YP=(e,r)=>{for(var t in r)Zc(e,t,{get:r[t],enumerable:!0})},QP=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of GP(r))!XP.call(e,i)&&i!==t&&Zc(e,i,{get:()=>r[i],enumerable:!(n=ZP(r,i))||n.enumerable});return e},eR=e=>QP(Zc({},"__esModule",{value:!0}),e),g0={};YP(g0,{HorizontalRule:()=>v0,default:()=>tR});y0.exports=eR(g0);var ao=P(),da=I(),v0=ao.Node.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",(0,ao.mergeAttributes)(this.options.HTMLAttributes,e)]},markdownTokenName:"hr",parseMarkdown:(e,r)=>r.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:e,state:r})=>{if(!(0,ao.canInsertNode)(r,r.schema.nodes[this.name]))return!1;let{selection:t}=r,{$to:n}=t,i=e();return(0,ao.isNodeSelection)(t)?i.insertContentAt(n.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:o,tr:s,dispatch:a})=>{if(a){let{$to:l}=s.selection,u=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?s.setSelection(da.TextSelection.create(s.doc,l.pos+1)):l.nodeAfter.isBlock?s.setSelection(da.NodeSelection.create(s.doc,l.pos)):s.setSelection(da.TextSelection.create(s.doc,l.pos));else{let c=o.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,f=c?.create();f&&(s.insert(u,f),s.setSelection(da.TextSelection.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[(0,ao.nodeInputRule)({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),tR=v0});var C0=S((fH,E0)=>{"use strict";var Gc=Object.defineProperty,rR=Object.getOwnPropertyDescriptor,nR=Object.getOwnPropertyNames,iR=Object.prototype.hasOwnProperty,oR=(e,r)=>{for(var t in r)Gc(e,t,{get:r[t],enumerable:!0})},sR=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of nR(r))!iR.call(e,i)&&i!==t&&Gc(e,i,{get:()=>r[i],enumerable:!(n=rR(r,i))||n.enumerable});return e},aR=e=>sR(Gc({},"__esModule",{value:!0}),e),k0={};oR(k0,{Italic:()=>T0,default:()=>lR,starInputRegex:()=>w0,starPasteRegex:()=>S0,underscoreInputRegex:()=>x0,underscorePasteRegex:()=>_0});E0.exports=aR(k0);var Wn=P(),w0=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,S0=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,x0=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,_0=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,T0=Wn.Mark.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",(0,Wn.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(e,r)=>r.applyMark("italic",r.parseInline(e.tokens||[])),renderMarkdown:(e,r)=>`*${r.renderChildren(e)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[(0,Wn.markInputRule)({find:w0,type:this.type}),(0,Wn.markInputRule)({find:x0,type:this.type})]},addPasteRules(){return[(0,Wn.markPasteRule)({find:S0,type:this.type}),(0,Wn.markPasteRule)({find:_0,type:this.type})]}}),lR=T0});var Ua=S(ge=>{"use strict";var uR="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5m\xF6gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",cR="\u03B5\u03BB1\u03C52\u0431\u04331\u0435\u043B3\u0434\u0435\u0442\u04384\u0435\u044E2\u043A\u0430\u0442\u043E\u043B\u0438\u043A6\u043E\u043C3\u043C\u043A\u04342\u043E\u043D1\u0441\u043A\u0432\u04306\u043E\u043D\u043B\u0430\u0439\u043D5\u0440\u04333\u0440\u0443\u04412\u04442\u0441\u0430\u0439\u04423\u0440\u04313\u0443\u043A\u04403\u049B\u0430\u04373\u0570\u0561\u05753\u05D9\u05E9\u05E8\u05D0\u05DC5\u05E7\u05D5\u05DD3\u0627\u0628\u0648\u0638\u0628\u064A5\u0631\u0627\u0645\u0643\u06485\u0644\u0627\u0631\u062F\u06464\u0628\u062D\u0631\u064A\u06465\u062C\u0632\u0627\u0626\u06315\u0633\u0639\u0648\u062F\u064A\u06296\u0639\u0644\u064A\u0627\u06465\u0645\u063A\u0631\u06285\u0645\u0627\u0631\u0627\u062A5\u06CC\u0631\u0627\u06465\u0628\u0627\u0631\u062A2\u0632\u0627\u06314\u064A\u062A\u06433\u06BE\u0627\u0631\u062A5\u062A\u0648\u0646\u06334\u0633\u0648\u062F\u0627\u06463\u0631\u064A\u06295\u0634\u0628\u0643\u06294\u0639\u0631\u0627\u06422\u06282\u0645\u0627\u06464\u0641\u0644\u0633\u0637\u064A\u06466\u0642\u0637\u06313\u0643\u0627\u062B\u0648\u0644\u064A\u06436\u0648\u06453\u0645\u0635\u06312\u0644\u064A\u0633\u064A\u06275\u0648\u0631\u064A\u062A\u0627\u0646\u064A\u06277\u0642\u06394\u0647\u0645\u0631\u0627\u06475\u067E\u0627\u06A9\u0633\u062A\u0627\u06467\u0680\u0627\u0631\u062A4\u0915\u0949\u092E3\u0928\u0947\u091F3\u092D\u093E\u0930\u09240\u092E\u094D3\u094B\u09245\u0938\u0902\u0917\u0920\u09285\u09AC\u09BE\u0982\u09B2\u09BE5\u09AD\u09BE\u09B0\u09A42\u09F0\u09A44\u0A2D\u0A3E\u0A30\u0A244\u0AAD\u0ABE\u0AB0\u0AA44\u0B2D\u0B3E\u0B30\u0B244\u0B87\u0BA8\u0BCD\u0BA4\u0BBF\u0BAF\u0BBE6\u0BB2\u0B99\u0BCD\u0B95\u0BC86\u0B9A\u0BBF\u0B99\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0BC2\u0BB0\u0BCD11\u0C2D\u0C3E\u0C30\u0C24\u0C4D5\u0CAD\u0CBE\u0CB0\u0CA44\u0D2D\u0D3E\u0D30\u0D24\u0D025\u0DBD\u0D82\u0D9A\u0DCF4\u0E04\u0E2D\u0E213\u0E44\u0E17\u0E223\u0EA5\u0EB2\u0EA73\u10D2\u10D42\u307F\u3093\u306A3\u30A2\u30DE\u30BE\u30F34\u30AF\u30E9\u30A6\u30C94\u30B0\u30FC\u30B0\u30EB4\u30B3\u30E02\u30B9\u30C8\u30A23\u30BB\u30FC\u30EB3\u30D5\u30A1\u30C3\u30B7\u30E7\u30F36\u30DD\u30A4\u30F3\u30C84\u4E16\u754C2\u4E2D\u4FE11\u56FD1\u570B1\u6587\u7F513\u4E9A\u9A6C\u900A3\u4F01\u4E1A2\u4F5B\u5C712\u4FE1\u606F2\u5065\u5EB72\u516B\u53662\u516C\u53F81\u76CA2\u53F0\u6E7E1\u70632\u5546\u57CE1\u5E971\u68072\u5609\u91CC0\u5927\u9152\u5E975\u5728\u7EBF2\u5927\u62FF2\u5929\u4E3B\u65593\u5A31\u4E502\u5BB6\u96FB2\u5E7F\u4E1C2\u5FAE\u535A2\u6148\u55842\u6211\u7231\u4F603\u624B\u673A2\u62DB\u80582\u653F\u52A11\u5E9C2\u65B0\u52A0\u57612\u95FB2\u65F6\u5C1A2\u66F8\u7C4D2\u673A\u67842\u6DE1\u9A6C\u95213\u6E38\u620F2\u6FB3\u95802\u70B9\u770B2\u79FB\u52A82\u7EC4\u7EC7\u673A\u67844\u7F51\u57401\u5E971\u7AD91\u7EDC2\u8054\u901A2\u8C37\u6B4C2\u8D2D\u72692\u901A\u8CA92\u96C6\u56E22\u96FB\u8A0A\u76C8\u79D14\u98DE\u5229\u6D663\u98DF\u54C12\u9910\u53852\u9999\u683C\u91CC\u62C93\u6E2F2\uB2F7\uB1371\uCEF42\uC0BC\uC1312\uD55C\uAD6D2",tf="numeric",rf="ascii",nf="alpha",co="asciinumeric",lo="alphanumeric",of="domain",P0="emoji",fR="scheme",dR="slashscheme",Xc="whitespace";function hR(e,r){return e in r||(r[e]=[]),r[e]}function tn(e,r,t){r[tf]&&(r[co]=!0,r[lo]=!0),r[rf]&&(r[co]=!0,r[nf]=!0),r[co]&&(r[lo]=!0),r[nf]&&(r[lo]=!0),r[lo]&&(r[of]=!0),r[P0]&&(r[of]=!0);for(let n in r){let i=hR(n,t);i.indexOf(e)<0&&i.push(e)}}function pR(e,r){let t={};for(let n in r)r[n].indexOf(e)>=0&&(t[n]=!0);return t}function Be(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}Be.groups={};Be.prototype={accepts(){return!!this.t},go(e){let r=this,t=r.j[e];if(t)return t;for(let n=0;n<r.jr.length;n++){let i=r.jr[n][0],o=r.jr[n][1];if(o&&i.test(e))return o}return r.jd},has(e,r=!1){return r?e in this.j:!!this.go(e)},ta(e,r,t,n){for(let i=0;i<e.length;i++)this.tt(e[i],r,t,n)},tr(e,r,t,n){n=n||Be.groups;let i;return r&&r.j?i=r:(i=new Be(r),t&&n&&tn(r,t,n)),this.jr.push([e,i]),i},ts(e,r,t,n){let i=this,o=e.length;if(!o)return i;for(let s=0;s<o-1;s++)i=i.tt(e[s]);return i.tt(e[o-1],r,t,n)},tt(e,r,t,n){n=n||Be.groups;let i=this;if(r&&r.j)return i.j[e]=r,r;let o=r,s,a=i.go(e);if(a?(s=new Be,Object.assign(s.j,a.j),s.jr.push.apply(s.jr,a.jr),s.jd=a.jd,s.t=a.t):s=new Be,o){if(n)if(s.t&&typeof s.t=="string"){let l=Object.assign(pR(s.t,n),t);tn(o,l,n)}else t&&tn(o,t,n);s.t=o}return i.j[e]=s,s}};var D=(e,r,t,n,i)=>e.ta(r,t,n,i),ne=(e,r,t,n,i)=>e.tr(r,t,n,i),O0=(e,r,t,n,i)=>e.ts(r,t,n,i),E=(e,r,t,n,i)=>e.tt(r,t,n,i),Zt="WORD",sf="UWORD",R0="ASCIINUMERICAL",D0="ALPHANUMERICAL",vo="LOCALHOST",af="TLD",lf="UTLD",ma="SCHEME",Vn="SLASH_SCHEME",df="NUM",uf="WS",hf="NL",fo="OPENBRACE",ho="CLOSEBRACE",ya="OPENBRACKET",ba="CLOSEBRACKET",ka="OPENPAREN",wa="CLOSEPAREN",Sa="OPENANGLEBRACKET",xa="CLOSEANGLEBRACKET",_a="FULLWIDTHLEFTPAREN",Ta="FULLWIDTHRIGHTPAREN",Ea="LEFTCORNERBRACKET",Ca="RIGHTCORNERBRACKET",Oa="LEFTWHITECORNERBRACKET",Ma="RIGHTWHITECORNERBRACKET",Aa="FULLWIDTHLESSTHAN",Na="FULLWIDTHGREATERTHAN",Pa="AMPERSAND",Ra="APOSTROPHE",Da="ASTERISK",br="AT",Ia="BACKSLASH",La="BACKTICK",Fa="CARET",kr="COLON",pf="COMMA",Ba="DOLLAR",Ot="DOT",za="EQUALS",mf="EXCLAMATION",tt="HYPHEN",po="PERCENT",qa="PIPE",ja="PLUS",Ha="POUND",mo="QUERY",gf="QUOTE",I0="FULLWIDTHMIDDLEDOT",vf="SEMI",Mt="SLASH",go="TILDE",$a="UNDERSCORE",L0="EMOJI",Wa="SYM",F0=Object.freeze({__proto__:null,ALPHANUMERICAL:D0,AMPERSAND:Pa,APOSTROPHE:Ra,ASCIINUMERICAL:R0,ASTERISK:Da,AT:br,BACKSLASH:Ia,BACKTICK:La,CARET:Fa,CLOSEANGLEBRACKET:xa,CLOSEBRACE:ho,CLOSEBRACKET:ba,CLOSEPAREN:wa,COLON:kr,COMMA:pf,DOLLAR:Ba,DOT:Ot,EMOJI:L0,EQUALS:za,EXCLAMATION:mf,FULLWIDTHGREATERTHAN:Na,FULLWIDTHLEFTPAREN:_a,FULLWIDTHLESSTHAN:Aa,FULLWIDTHMIDDLEDOT:I0,FULLWIDTHRIGHTPAREN:Ta,HYPHEN:tt,LEFTCORNERBRACKET:Ea,LEFTWHITECORNERBRACKET:Oa,LOCALHOST:vo,NL:hf,NUM:df,OPENANGLEBRACKET:Sa,OPENBRACE:fo,OPENBRACKET:ya,OPENPAREN:ka,PERCENT:po,PIPE:qa,PLUS:ja,POUND:Ha,QUERY:mo,QUOTE:gf,RIGHTCORNERBRACKET:Ca,RIGHTWHITECORNERBRACKET:Ma,SCHEME:ma,SEMI:vf,SLASH:Mt,SLASH_SCHEME:Vn,SYM:Wa,TILDE:go,TLD:af,UNDERSCORE:$a,UTLD:lf,UWORD:sf,WORD:Zt,WS:uf}),Et=/[a-z]/,Un=/\p{L}/u,ga=/\p{Emoji}/u,mR=/\ufe0f/,Ct=/\d/,va=/\s/,gR=Object.freeze({__proto__:null,ASCII_LETTER:Et,DIGIT:Ct,EMOJI:ga,EMOJI_VARIATION:mR,LETTER:Un,SPACE:va}),M0="\r",Yc=`
`,vR="\uFE0F",yR="\u200D",Qc="\uFFFC",ha=null,pa=null;function bR(e=[]){let r={};Be.groups=r;let t=new Be;ha==null&&(ha=A0(uR)),pa==null&&(pa=A0(cR)),E(t,"'",Ra),E(t,"{",fo),E(t,"}",ho),E(t,"[",ya),E(t,"]",ba),E(t,"(",ka),E(t,")",wa),E(t,"<",Sa),E(t,">",xa),E(t,"\uFF08",_a),E(t,"\uFF09",Ta),E(t,"\u300C",Ea),E(t,"\u300D",Ca),E(t,"\u300E",Oa),E(t,"\u300F",Ma),E(t,"\uFF1C",Aa),E(t,"\uFF1E",Na),E(t,"&",Pa),E(t,"*",Da),E(t,"@",br),E(t,"`",La),E(t,"^",Fa),E(t,":",kr),E(t,",",pf),E(t,"$",Ba),E(t,".",Ot),E(t,"=",za),E(t,"!",mf),E(t,"-",tt),E(t,"%",po),E(t,"|",qa),E(t,"+",ja),E(t,"#",Ha),E(t,"?",mo),E(t,'"',gf),E(t,"/",Mt),E(t,";",vf),E(t,"~",go),E(t,"_",$a),E(t,"\\",Ia),E(t,"\u30FB",I0);let n=ne(t,Ct,df,{[tf]:!0});ne(n,Ct,n);let i=ne(n,Et,R0,{[co]:!0}),o=ne(n,Un,D0,{[lo]:!0}),s=ne(t,Et,Zt,{[rf]:!0});ne(s,Ct,i),ne(s,Et,s),ne(i,Ct,i),ne(i,Et,i);let a=ne(t,Un,sf,{[nf]:!0});ne(a,Et),ne(a,Ct,o),ne(a,Un,a),ne(o,Ct,o),ne(o,Et),ne(o,Un,o);let l=E(t,Yc,hf,{[Xc]:!0}),u=E(t,M0,uf,{[Xc]:!0}),c=ne(t,va,uf,{[Xc]:!0});E(t,Qc,c),E(u,Yc,l),E(u,Qc,c),ne(u,va,c),E(c,M0),E(c,Yc),ne(c,va,c),E(c,Qc,c);let f=ne(t,ga,L0,{[P0]:!0});E(f,"#"),ne(f,ga,f),E(f,vR,f);let d=E(f,yR);E(d,"#"),ne(d,ga,f);let h=[[Et,s],[Ct,i]],p=[[Et,null],[Un,a],[Ct,o]];for(let m=0;m<ha.length;m++)yr(t,ha[m],af,Zt,h);for(let m=0;m<pa.length;m++)yr(t,pa[m],lf,sf,p);tn(af,{tld:!0,ascii:!0},r),tn(lf,{utld:!0,alpha:!0},r),yr(t,"file",ma,Zt,h),yr(t,"mailto",ma,Zt,h),yr(t,"http",Vn,Zt,h),yr(t,"https",Vn,Zt,h),yr(t,"ftp",Vn,Zt,h),yr(t,"ftps",Vn,Zt,h),tn(ma,{scheme:!0,ascii:!0},r),tn(Vn,{slashscheme:!0,ascii:!0},r),e=e.sort((m,v)=>m[0]>v[0]?1:-1);for(let m=0;m<e.length;m++){let v=e[m][0],y=e[m][1]?{[fR]:!0}:{[dR]:!0};v.indexOf("-")>=0?y[of]=!0:Et.test(v)?Ct.test(v)?y[co]=!0:y[rf]=!0:y[tf]=!0,O0(t,v,v,y)}return O0(t,"localhost",vo,{ascii:!0}),t.jd=new Be(Wa),{start:t,tokens:Object.assign({groups:r},F0)}}function B0(e,r){let t=z0(r.replace(/[A-Z]/g,a=>a.toLowerCase())),n=t.length,i=[],o=0,s=0;for(;s<n;){let a=e,l=null,u=0,c=null,f=-1,d=-1;for(;s<n&&(l=a.go(t[s]));)a=l,a.accepts()?(f=0,d=0,c=a):f>=0&&(f+=t[s].length,d++),u+=t[s].length,o+=t[s].length,s++;o-=f,s-=d,u-=f,i.push({t:c.t,v:r.slice(o-u,o),s:o-u,e:o})}return i}function z0(e){let r=[],t=e.length,n=0;for(;n<t;){let i=e.charCodeAt(n),o,s=i<55296||i>56319||n+1===t||(o=e.charCodeAt(n+1))<56320||o>57343?e[n]:e.slice(n,n+2);r.push(s),n+=s.length}return r}function yr(e,r,t,n,i){let o,s=r.length;for(let a=0;a<s-1;a++){let l=r[a];e.j[l]?o=e.j[l]:(o=new Be(n),o.jr=i.slice(),e.j[l]=o),e=o}return o=new Be(t),o.jr=i.slice(),e.j[r[s-1]]=o,o}function A0(e){let r=[],t=[],n=0,i="0123456789";for(;n<e.length;){let o=0;for(;i.indexOf(e[n+o])>=0;)o++;if(o>0){r.push(t.join(""));for(let s=parseInt(e.substring(n,n+o),10);s>0;s--)t.pop();n+=o}else t.push(e[n]),n++}return r}var Kn={defaultProtocol:"http",events:null,format:N0,formatHref:N0,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function ko(e,r=null){let t=Object.assign({},Kn);e&&(t=Object.assign(t,e instanceof ko?e.o:e));let n=t.ignoreTags,i=[];for(let o=0;o<n.length;o++)i.push(n[o].toUpperCase());this.o=t,r&&(this.defaultRender=r),this.ignoreTags=i}ko.prototype={o:Kn,ignoreTags:[],defaultRender(e){return e},check(e){return this.get("validate",e.toString(),e)},get(e,r,t){let n=r!=null,i=this.o[e];return i&&(typeof i=="object"?(i=t.t in i?i[t.t]:Kn[e],typeof i=="function"&&n&&(i=i(r,t))):typeof i=="function"&&n&&(i=i(r,t.t,t)),i)},getObj(e,r,t){let n=this.o[e];return typeof n=="function"&&r!=null&&(n=n(r,t.t,t)),n},render(e){let r=e.render(this);return(this.get("render",null,e)||this.defaultRender)(r,e.t,e)}};function N0(e){return e}var kR=Object.freeze({__proto__:null,Options:ko,defaults:Kn});function yo(e,r){this.t="token",this.v=e,this.tk=r}yo.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){let r=this.toString(),t=e.get("truncate",r,this),n=e.get("format",r,this);return t&&n.length>t?n.substring(0,t)+"\u2026":n},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=Kn.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){let r=this,t=this.toHref(e.get("defaultProtocol")),n=e.get("formatHref",t,this),i=e.get("tagName",t,r),o=this.toFormattedString(e),s={},a=e.get("className",t,r),l=e.get("target",t,r),u=e.get("rel",t,r),c=e.getObj("attributes",t,r),f=e.getObj("events",t,r);return s.href=n,a&&(s.class=a),l&&(s.target=l),u&&(s.rel=u),c&&Object.assign(s,c),{tagName:i,attributes:s,content:o,eventListeners:f}}};function Jn(e,r){class t extends yo{constructor(i,o){super(i,o),this.t=e}}for(let n in r)t.prototype[n]=r[n];return t.t=e,t}var cf=Jn("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),ff=Jn("text"),q0=Jn("nl"),uo=Jn("url",{isLink:!0,toHref(e=Kn.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){let e=this.tk;return e.length>=2&&e[0].t!==vo&&e[1].t===kr}}),j0=Object.freeze({__proto__:null,Base:yo,Email:cf,MultiToken:yo,Nl:q0,Text:ff,Url:uo,createTokenClass:Jn}),et=e=>new Be(e);function wR({groups:e}){let r=e.domain.concat([Pa,Da,br,Ia,La,Fa,Ba,za,tt,df,po,qa,ja,Ha,Mt,Wa,go,$a]),t=[Ra,kr,pf,Ot,mf,po,mo,gf,vf,Sa,xa,fo,ho,ba,ya,ka,wa,_a,Ta,Ea,Ca,Oa,Ma,Aa,Na],n=[Pa,Ra,Da,Ia,La,Fa,Ba,za,tt,fo,ho,po,qa,ja,Ha,mo,Mt,Wa,go,$a],i=et(),o=E(i,go);D(o,n,o),D(o,e.domain,o);let s=et(),a=et(),l=et();D(i,e.domain,s),D(i,e.scheme,a),D(i,e.slashscheme,l),D(s,n,o),D(s,e.domain,s);let u=E(s,br);E(o,br,u),E(a,br,u),E(l,br,u);let c=E(o,Ot);D(c,n,o),D(c,e.domain,o);let f=et();D(u,e.domain,f),D(f,e.domain,f);let d=E(f,Ot);D(d,e.domain,f);let h=et(cf);D(d,e.tld,h),D(d,e.utld,h),E(u,vo,h);let p=E(f,tt);E(p,tt,p),D(p,e.domain,f),D(h,e.domain,f),E(h,Ot,d),E(h,tt,p);let m=E(h,kr);D(m,e.numeric,cf);let v=E(s,tt),g=E(s,Ot);E(v,tt,v),D(v,e.domain,s),D(g,n,o),D(g,e.domain,s);let y=et(uo);D(g,e.tld,y),D(g,e.utld,y),D(y,e.domain,s),D(y,n,o),E(y,Ot,g),E(y,tt,v),E(y,br,u);let w=E(y,kr),b=et(uo);D(w,e.numeric,b);let k=et(uo),x=et();D(k,r,k),D(k,t,x),D(x,r,k),D(x,t,x),E(y,Mt,k),E(b,Mt,k);let T=E(a,kr),_=E(l,kr),C=E(_,Mt),A=E(C,Mt);D(a,e.domain,s),E(a,Ot,g),E(a,tt,v),D(l,e.domain,s),E(l,Ot,g),E(l,tt,v),D(T,e.domain,k),E(T,Mt,k),E(T,mo,k),D(A,e.domain,k),D(A,r,k),E(A,Mt,k);let O=[[fo,ho],[ya,ba],[ka,wa],[Sa,xa],[_a,Ta],[Ea,Ca],[Oa,Ma],[Aa,Na]];for(let B=0;B<O.length;B++){let[U,V]=O[B],Z=E(k,U);E(x,U,Z),E(Z,V,k);let Pe=et(uo);D(Z,r,Pe);let z=et();D(Z,t),D(Pe,r,Pe),D(Pe,t,z),D(z,r,Pe),D(z,t,z),E(Pe,V,k),E(z,V,k)}return E(i,vo,y),E(i,hf,q0),{start:i,tokens:F0}}function SR(e,r,t){let n=t.length,i=0,o=[],s=[];for(;i<n;){let a=e,l=null,u=null,c=0,f=null,d=-1;for(;i<n&&!(l=a.go(t[i].t));)s.push(t[i++]);for(;i<n&&(u=l||a.go(t[i].t));)l=null,a=u,a.accepts()?(d=0,f=a):d>=0&&d++,i++,c++;if(d<0)i-=c,i<n&&(s.push(t[i]),i++);else{s.length>0&&(o.push(ef(ff,r,s)),s=[]),i-=d,c-=d;let h=f.t,p=t.slice(i-c,i);o.push(ef(h,r,p))}}return s.length>0&&o.push(ef(ff,r,s)),o}function ef(e,r,t){let n=t[0].s,i=t[t.length-1].e,o=r.slice(n,i);return new e(o,t)}var bo=typeof console<"u"&&console&&console.warn||(()=>{}),yf="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",L={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function xR(){return Be.groups={},L.scanner=null,L.parser=null,L.tokenQueue=[],L.pluginQueue=[],L.customSchemes=[],L.initialized=!1,L}function _R(e,r){if(typeof r!="function")throw new Error(`linkifyjs: Invalid token plugin ${r} (expects function)`);for(let t=0;t<L.tokenQueue.length;t++)if(e===L.tokenQueue[t][0]){bo(`linkifyjs: token plugin "${e}" already registered - will be overwritten`),L.tokenQueue[t]=[e,r];return}L.tokenQueue.push([e,r]),L.initialized&&bo(`linkifyjs: already initialized - will not register token plugin "${e}" ${yf}`)}function TR(e,r){if(typeof r!="function")throw new Error(`linkifyjs: Invalid plugin ${r} (expects function)`);for(let t=0;t<L.pluginQueue.length;t++)if(e===L.pluginQueue[t][0]){bo(`linkifyjs: plugin "${e}" already registered - will be overwritten`),L.pluginQueue[t]=[e,r];return}L.pluginQueue.push([e,r]),L.initialized&&bo(`linkifyjs: already initialized - will not register plugin "${e}" ${yf}`)}function ER(e,r=!1){if(L.initialized&&bo(`linkifyjs: already initialized - will not register custom scheme "${e}" ${yf}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);L.customSchemes.push([e,r])}function H0(){L.scanner=bR(L.customSchemes);for(let e=0;e<L.tokenQueue.length;e++)L.tokenQueue[e][1]({scanner:L.scanner});L.parser=wR(L.scanner.tokens);for(let e=0;e<L.pluginQueue.length;e++)L.pluginQueue[e][1]({scanner:L.scanner,parser:L.parser});return L.initialized=!0,L}function Va(e){return L.initialized||H0(),SR(L.parser.start,e,B0(L.scanner.start,e))}Va.scan=B0;function CR(e,r=null,t=null){if(r&&typeof r=="object"){if(t)throw Error(`linkifyjs: Invalid link type ${r}; must be a string`);t=r,r=null}let n=new ko(t),i=Va(e),o=[];for(let s=0;s<i.length;s++){let a=i[s];a.isLink&&(!r||a.t===r)&&n.check(a)&&o.push(a.toFormattedObject(n))}return o}function OR(e,r=null){let t=Va(e);return t.length===1&&t[0].isLink&&(!r||t[0].t===r)}ge.MultiToken=yo;ge.Options=ko;ge.State=Be;ge.createTokenClass=Jn;ge.find=CR;ge.init=H0;ge.multi=j0;ge.options=kR;ge.regexp=gR;ge.registerCustomProtocol=ER;ge.registerPlugin=TR;ge.registerTokenPlugin=_R;ge.reset=xR;ge.stringToArray=z0;ge.test=OR;ge.text=j0;ge.tokenize=Va});var Z0=S((hH,J0)=>{"use strict";var bf=Object.defineProperty,MR=Object.getOwnPropertyDescriptor,AR=Object.getOwnPropertyNames,NR=Object.prototype.hasOwnProperty,PR=(e,r)=>{for(var t in r)bf(e,t,{get:r[t],enumerable:!0})},RR=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of AR(r))!NR.call(e,i)&&i!==t&&bf(e,i,{get:()=>r[i],enumerable:!(n=MR(r,i))||n.enumerable});return e},DR=e=>RR(bf({},"__esModule",{value:!0}),e),U0={};PR(U0,{Link:()=>K0,default:()=>UR,isAllowedUri:()=>wr,pasteRegex:()=>VR});J0.exports=DR(U0);var Ka=P(),Ja=Ua(),Za=P(),$0=I(),IR=Ua(),kf="[\0- \xA0\u1680\u180E\u2000-\u2029\u205F\u3000]",LR=new RegExp(kf),FR=new RegExp(`${kf}$`),BR=new RegExp(kf,"g");function zR(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function qR(e){return new $0.Plugin({key:new $0.PluginKey("autolink"),appendTransaction:(r,t,n)=>{let i=r.some(u=>u.docChanged)&&!t.doc.eq(n.doc),o=r.some(u=>u.getMeta("preventAutolink"));if(!i||o)return;let{tr:s}=n,a=(0,Za.combineTransactionSteps)(t.doc,[...r]);if((0,Za.getChangedRanges)(a).forEach(({newRange:u})=>{let c=(0,Za.findChildrenInRange)(n.doc,u,h=>h.isTextblock),f,d;if(c.length>1)f=c[0],d=n.doc.textBetween(f.pos,f.pos+f.node.nodeSize,void 0," ");else if(c.length){let h=n.doc.textBetween(u.from,u.to," "," ");if(!FR.test(h))return;f=c[0],d=n.doc.textBetween(f.pos,u.to,void 0," ")}if(f&&d){let h=d.split(LR).filter(Boolean);if(h.length<=0)return!1;let p=h[h.length-1],m=f.pos+d.lastIndexOf(p);if(!p)return!1;let v=(0,IR.tokenize)(p).map(g=>g.toObject(e.defaultProtocol));if(!zR(v))return!1;v.filter(g=>g.isLink).map(g=>({...g,from:m+g.start+1,to:m+g.end+1})).filter(g=>n.schema.marks.code?!n.doc.rangeHasMark(g.from,g.to,n.schema.marks.code):!0).filter(g=>e.validate(g.value)).filter(g=>e.shouldAutoLink(g.value)).forEach(g=>{(0,Za.getMarksBetween)(g.from,g.to,n.doc).some(y=>y.mark.type===e.type)||s.addMark(g.from,g.to,e.type.create({href:g.href}))})}}),!!s.steps.length)return s}})}var jR=P(),W0=I();function HR(e){return new W0.Plugin({key:new W0.PluginKey("handleClickLink"),props:{handleClick:(r,t,n)=>{var i,o;if(n.button!==0||!r.editable)return!1;let s=null;if(n.target instanceof HTMLAnchorElement)s=n.target;else{let c=n.target,f=[];for(;c.nodeName!=="DIV";)f.push(c),c=c.parentNode;s=f.find(d=>d.nodeName==="A")}if(!s)return!1;let a=(0,jR.getAttributes)(r.state,e.type.name),l=(i=s?.href)!=null?i:a.href,u=(o=s?.target)!=null?o:a.target;return e.enableClickSelection&&e.editor.commands.extendMarkRange(e.type.name),s&&l?(window.open(l,u),!0):!1}}})}var V0=I(),$R=Ua();function WR(e){return new V0.Plugin({key:new V0.PluginKey("handlePasteLink"),props:{handlePaste:(r,t,n)=>{let{shouldAutoLink:i}=e,{state:o}=r,{selection:s}=o,{empty:a}=s;if(a)return!1;let l="";n.content.forEach(c=>{l+=c.textContent});let u=(0,$R.find)(l,{defaultProtocol:e.defaultProtocol}).find(c=>c.isLink&&c.value===l);return!l||!u||i!==void 0&&!i(u.href)?!1:e.editor.commands.setMark(e.type,{href:u.href})}}})}var VR=/https?:\/\/(?:www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z]{2,}\b(?:[-a-zA-Z0-9@:%._+~#=?!&/]*)(?:[-a-zA-Z0-9@:%._+~#=?!&/]*)/gi;function wr(e,r){let t=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return r&&r.forEach(n=>{let i=typeof n=="string"?n:n.scheme;i&&t.push(i)}),!e||e.replace(BR,"").match(new RegExp(`^(?:(?:${t.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var K0=Ka.Mark.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if(typeof e=="string"){(0,Ja.registerCustomProtocol)(e);return}(0,Ja.registerCustomProtocol)(e.scheme,e.optionalSlashes)})},onDestroy(){(0,Ja.reset)()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,r)=>!!wr(e,r.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{let r=e.getAttribute("href");return!r||!this.options.isAllowedUri(r,{defaultValidate:t=>!!wr(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:r=>!!wr(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",(0,Ka.mergeAttributes)(this.options.HTMLAttributes,e),0]:["a",(0,Ka.mergeAttributes)(this.options.HTMLAttributes,{...e,href:""}),0]},markdownTokenName:"link",parseMarkdown:(e,r)=>r.applyMark("link",r.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,r)=>{var t;let n=((t=e.attrs)==null?void 0:t.href)||"";return`[${r.renderChildren(e)}](${n})`},addCommands(){return{setLink:e=>({chain:r})=>{let{href:t}=e;return this.options.isAllowedUri(t,{defaultValidate:n=>!!wr(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?r().setMark(this.name,e).setMeta("preventAutolink",!0).run():!1},toggleLink:e=>({chain:r})=>{let{href:t}=e||{};return t&&!this.options.isAllowedUri(t,{defaultValidate:n=>!!wr(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:r().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[(0,Ka.markPasteRule)({find:e=>{let r=[];if(e){let{protocols:t,defaultProtocol:n}=this.options,i=(0,Ja.find)(e).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:s=>!!wr(s,t),protocols:t,defaultProtocol:n}));i.length&&i.forEach(o=>{this.options.shouldAutoLink(o.value)&&r.push({text:o.value,data:{href:o.href},index:o.start})})}return r},type:this.type,getAttributes:e=>{var r;return{href:(r=e.data)==null?void 0:r.href}}})]},addProseMirrorPlugins(){let e=[],{protocols:r,defaultProtocol:t}=this.options;return this.options.autolink&&e.push(qR({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:i=>!!wr(i,r),protocols:r,defaultProtocol:t}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&e.push(HR({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push(WR({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),e}}),UR=K0});var Sr=S((pH,gb)=>{"use strict";var Cf=Object.defineProperty,KR=Object.getOwnPropertyDescriptor,JR=Object.getOwnPropertyNames,ZR=Object.prototype.hasOwnProperty,eb=(e,r)=>{for(var t in r)Cf(e,t,{get:r[t],enumerable:!0})},GR=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of JR(r))!ZR.call(e,i)&&i!==t&&Cf(e,i,{get:()=>r[i],enumerable:!(n=KR(r,i))||n.enumerable});return e},XR=e=>GR(Cf({},"__esModule",{value:!0}),e),tb={};eb(tb,{BulletList:()=>rb,ListItem:()=>nb,ListKeymap:()=>cb,ListKit:()=>uD,OrderedList:()=>db,TaskItem:()=>pb,TaskList:()=>mb,bulletListInputRegex:()=>xf,inputRegex:()=>hb,listHelpers:()=>ib,orderedListInputRegex:()=>Ef});gb.exports=XR(tb);var Ga=P(),YR="listItem",G0="textStyle",xf=/^\s*([-+*])\s$/,rb=Ga.Node.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",(0,Ga.mergeAttributes)(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,r)=>e.type!=="list"||e.ordered?[]:{type:"bulletList",content:e.items?r.parseChildren(e.items):[]},renderMarkdown:(e,r)=>e.content?r.renderChildren(e.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:e,chain:r})=>this.options.keepAttributes?r().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(YR,this.editor.getAttributes(G0)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=(0,Ga.wrappingInputRule)({find:xf,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=(0,Ga.wrappingInputRule)({find:xf,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(G0),editor:this.editor})),[e]}}),wf=P(),nb=wf.Node.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",(0,wf.mergeAttributes)(this.options.HTMLAttributes,e),0]},markdownTokenName:"list_item",parseMarkdown:(e,r)=>{if(e.type!=="list_item")return[];let t=[];if(e.tokens&&e.tokens.length>0)if(e.tokens.some(i=>i.type==="paragraph"))t=r.parseChildren(e.tokens);else{let i=e.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(t=[{type:"paragraph",content:r.parseInline(i.tokens)}],e.tokens.length>1){let s=e.tokens.slice(1),a=r.parseChildren(s);t.push(...a)}}else t=r.parseChildren(e.tokens)}return t.length===0&&(t=[{type:"paragraph",content:[]}]),{type:"listItem",content:t}},renderMarkdown:(e,r,t)=>(0,wf.renderNestedMarkdownContent)(e,r,n=>n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${n.index+1}. `:"- ",t),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),QR=P(),ib={};eb(ib,{findListItemPos:()=>So,getNextListDepth:()=>Of,handleBackspace:()=>_f,handleDelete:()=>Tf,hasListBefore:()=>ob,hasListItemAfter:()=>nD,hasListItemBefore:()=>sb,listItemHasSubList:()=>ab,nextListIsDeeper:()=>lb,nextListIsHigher:()=>ub});var eD=P(),So=(e,r)=>{let{$from:t}=r.selection,n=(0,eD.getNodeType)(e,r.schema),i=null,o=t.depth,s=t.pos,a=null;for(;o>0&&a===null;)i=t.node(o),i.type===n?a=o:(o-=1,s-=1);return a===null?null:{$pos:r.doc.resolve(s),depth:a}},tD=P(),Of=(e,r)=>{let t=So(e,r);if(!t)return!1;let[,n]=(0,tD.getNodeAtPosition)(r,e,t.$pos.pos+4);return n},Sf=P(),ob=(e,r,t)=>{let{$anchor:n}=e.selection,i=Math.max(0,n.pos-2),o=e.doc.resolve(i).node();return!(!o||!t.includes(o.type.name))},sb=(e,r)=>{var t;let{$anchor:n}=r.selection,i=r.doc.resolve(n.pos-2);return!(i.index()===0||((t=i.nodeBefore)==null?void 0:t.type.name)!==e)},rD=P(),ab=(e,r,t)=>{if(!t)return!1;let n=(0,rD.getNodeType)(e,r.schema),i=!1;return t.descendants(o=>{o.type===n&&(i=!0)}),i},_f=(e,r,t)=>{if(e.commands.undoInputRule())return!0;if(e.state.selection.from!==e.state.selection.to)return!1;if(!(0,Sf.isNodeActive)(e.state,r)&&ob(e.state,r,t)){let{$anchor:a}=e.state.selection,l=e.state.doc.resolve(a.before()-1),u=[];l.node().descendants((d,h)=>{d.type.name===r&&u.push({node:d,pos:h})});let c=u.at(-1);if(!c)return!1;let f=e.state.doc.resolve(l.start()+c.pos+1);return e.chain().cut({from:a.start()-1,to:a.end()+1},f.end()).joinForward().run()}if(!(0,Sf.isNodeActive)(e.state,r)||!(0,Sf.isAtStartOfNode)(e.state))return!1;let n=So(r,e.state);if(!n)return!1;let o=e.state.doc.resolve(n.$pos.pos-2).node(n.depth),s=ab(r,e.state,o);return sb(r,e.state)&&!s?e.commands.joinItemBackward():e.chain().liftListItem(r).run()},X0=P(),lb=(e,r)=>{let t=Of(e,r),n=So(e,r);return!n||!t?!1:t>n.depth},ub=(e,r)=>{let t=Of(e,r),n=So(e,r);return!n||!t?!1:t<n.depth},Tf=(e,r)=>{if(!(0,X0.isNodeActive)(e.state,r)||!(0,X0.isAtEndOfNode)(e.state,r))return!1;let{selection:t}=e.state,{$from:n,$to:i}=t;return!t.empty&&n.sameParent(i)?!1:lb(r,e.state)?e.chain().focus(e.state.selection.from+4).lift(r).joinBackward().run():ub(r,e.state)?e.chain().joinForward().joinBackward().run():e.commands.joinItemForward()},nD=(e,r)=>{var t;let{$anchor:n}=r.selection,i=r.doc.resolve(n.pos-n.parentOffset-2);return!(i.index()===i.parent.childCount-1||((t=i.nodeAfter)==null?void 0:t.type.name)!==e)},cb=QR.Extension.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:e})=>{let r=!1;return this.options.listTypes.forEach(({itemName:t})=>{e.state.schema.nodes[t]!==void 0&&Tf(e,t)&&(r=!0)}),r},"Mod-Delete":({editor:e})=>{let r=!1;return this.options.listTypes.forEach(({itemName:t})=>{e.state.schema.nodes[t]!==void 0&&Tf(e,t)&&(r=!0)}),r},Backspace:({editor:e})=>{let r=!1;return this.options.listTypes.forEach(({itemName:t,wrapperNames:n})=>{e.state.schema.nodes[t]!==void 0&&_f(e,t,n)&&(r=!0)}),r},"Mod-Backspace":({editor:e})=>{let r=!1;return this.options.listTypes.forEach(({itemName:t,wrapperNames:n})=>{e.state.schema.nodes[t]!==void 0&&_f(e,t,n)&&(r=!0)}),r}}}}),iD=P(),wo=P(),Y0=/^(\s*)(\d+)\.\s+(.*)$/,oD=/^\s/;function sD(e){let r=[],t=0,n=0;for(;t<e.length;){let i=e[t],o=i.match(Y0);if(!o)break;let[,s,a,l]=o,u=s.length,c=l,f=t+1,d=[i];for(;f<e.length;){let h=e[f];if(h.match(Y0))break;if(h.trim()==="")d.push(h),c+=`
`,f+=1;else if(h.match(oD))d.push(h),c+=`
${h.slice(u+2)}`,f+=1;else break}r.push({indent:u,number:parseInt(a,10),content:c.trim(),raw:d.join(`
`)}),n=f,t=f}return[r,n]}function fb(e,r,t){var n;let i=[],o=0;for(;o<e.length;){let s=e[o];if(s.indent===r){let a=s.content.split(`
`),l=((n=a[0])==null?void 0:n.trim())||"",u=[];l&&u.push({type:"paragraph",raw:l,tokens:t.inlineTokens(l)});let c=a.slice(1).join(`
`).trim();if(c){let h=t.blockTokens(c);u.push(...h)}let f=o+1,d=[];for(;f<e.length&&e[f].indent>r;)d.push(e[f]),f+=1;if(d.length>0){let h=Math.min(...d.map(m=>m.indent)),p=fb(d,h,t);u.push({type:"list",ordered:!0,start:d[0].number,items:p,raw:d.map(m=>m.raw).join(`
`)})}i.push({type:"list_item",raw:s.raw,tokens:u}),o=f}else o+=1}return i}function aD(e,r){return e.map(t=>{if(t.type!=="list_item")return r.parseChildren([t])[0];let n=[];return t.tokens&&t.tokens.length>0&&t.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")n.push(...r.parseChildren([i]));else if(i.type==="text"&&i.tokens){let o=r.parseChildren([i]);n.push({type:"paragraph",content:o})}else{let o=r.parseChildren([i]);o.length>0&&n.push(...o)}}),{type:"listItem",content:n}})}var lD="listItem",Q0="textStyle",Ef=/^(\d+)\.\s$/,db=wo.Node.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){let{start:r,...t}=e;return r===1?["ol",(0,wo.mergeAttributes)(this.options.HTMLAttributes,t),0]:["ol",(0,wo.mergeAttributes)(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,r)=>{if(e.type!=="list"||!e.ordered)return[];let t=e.start||1,n=e.items?aD(e.items,r):[];return t!==1?{type:"orderedList",attrs:{start:t},content:n}:{type:"orderedList",content:n}},renderMarkdown:(e,r)=>e.content?r.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:e=>{let r=e.match(/^(\s*)(\d+)\.\s+/),t=r?.index;return t!==void 0?t:-1},tokenize:(e,r,t)=>{var n;let i=e.split(`
`),[o,s]=sD(i);if(o.length===0)return;let a=fb(o,0,t);return a.length===0?void 0:{type:"list",ordered:!0,start:((n=o[0])==null?void 0:n.number)||1,items:a,raw:i.slice(0,s).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:r})=>this.options.keepAttributes?r().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(lD,this.editor.getAttributes(Q0)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=(0,wo.wrappingInputRule)({find:Ef,type:this.type,getAttributes:r=>({start:+r[1]}),joinPredicate:(r,t)=>t.childCount+t.attrs.start===+r[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=(0,wo.wrappingInputRule)({find:Ef,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:r=>({start:+r[1],...this.editor.getAttributes(Q0)}),joinPredicate:(r,t)=>t.childCount+t.attrs.start===+r[1],editor:this.editor})),[e]}}),Xa=P(),hb=/^\s*(\[([( |x])?\])\s$/,pb=Xa.Node.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{let r=e.getAttribute("data-checked");return r===""||r==="true"},renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:r}){return["li",(0,Xa.mergeAttributes)(this.options.HTMLAttributes,r,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(e,r)=>{let t=[];if(e.tokens&&e.tokens.length>0?t.push(r.createNode("paragraph",{},r.parseInline(e.tokens))):e.text?t.push(r.createNode("paragraph",{},[r.createNode("text",{text:e.text})])):t.push(r.createNode("paragraph",{},[])),e.nestedTokens&&e.nestedTokens.length>0){let n=r.parseChildren(e.nestedTokens);t.push(...n)}return r.createNode("taskItem",{checked:e.checked||!1},t)},renderMarkdown:(e,r)=>{var t;let i=`- [${(t=e.attrs)!=null&&t.checked?"x":" "}] `;return(0,Xa.renderNestedMarkdownContent)(e,r,i)},addKeyboardShortcuts(){let e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...e,Tab:()=>this.editor.commands.sinkListItem(this.name)}:e},addNodeView(){return({node:e,HTMLAttributes:r,getPos:t,editor:n})=>{let i=document.createElement("li"),o=document.createElement("label"),s=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div"),u=c=>{var f,d;a.ariaLabel=((d=(f=this.options.a11y)==null?void 0:f.checkboxLabel)==null?void 0:d.call(f,c,a.checked))||`Task item checkbox for ${c.textContent||"empty task item"}`};return u(e),o.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",c=>c.preventDefault()),a.addEventListener("change",c=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}let{checked:f}=c.target;n.isEditable&&typeof t=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:d})=>{let h=t();if(typeof h!="number")return!1;let p=d.doc.nodeAt(h);return d.setNodeMarkup(h,void 0,{...p?.attrs,checked:f}),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,f)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([c,f])=>{i.setAttribute(c,f)}),i.dataset.checked=e.attrs.checked,a.checked=e.attrs.checked,o.append(a,s),i.append(o,l),Object.entries(r).forEach(([c,f])=>{i.setAttribute(c,f)}),{dom:i,contentDOM:l,update:c=>c.type!==this.type?!1:(i.dataset.checked=c.attrs.checked,a.checked=c.attrs.checked,u(c),!0)}}},addInputRules(){return[(0,Xa.wrappingInputRule)({find:hb,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),Ya=P(),mb=Ya.Node.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",(0,Ya.mergeAttributes)(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},parseMarkdown:(e,r)=>r.createNode("taskList",{},r.parseChildren(e.items||[])),renderMarkdown:(e,r)=>e.content?r.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(e){var r;let t=(r=e.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:r.index;return t!==void 0?t:-1},tokenize(e,r,t){let n=o=>{let s=(0,Ya.parseIndentedBlocks)(o,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,l)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:t.inlineTokens(a.mainContent),nestedTokens:l}),customNestedParser:n},t);return s?[{type:"taskList",raw:s.raw,items:s.items}]:t.blockTokens(o)},i=(0,Ya.parseIndentedBlocks)(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,s)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:t.inlineTokens(o.mainContent),nestedTokens:s}),customNestedParser:n},t);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),uD=iD.Extension.create({name:"listKit",addExtensions(){let e=[];return this.options.bulletList!==!1&&e.push(rb.configure(this.options.bulletList)),this.options.listItem!==!1&&e.push(nb.configure(this.options.listItem)),this.options.listKeymap!==!1&&e.push(cb.configure(this.options.listKeymap)),this.options.orderedList!==!1&&e.push(db.configure(this.options.orderedList)),this.options.taskItem!==!1&&e.push(pb.configure(this.options.taskItem)),this.options.taskList!==!1&&e.push(mb.configure(this.options.taskList)),e}})});var Af=S((mH,kb)=>{"use strict";var Mf=Object.defineProperty,cD=Object.getOwnPropertyDescriptor,fD=Object.getOwnPropertyNames,dD=Object.prototype.hasOwnProperty,hD=(e,r)=>{for(var t in r)Mf(e,t,{get:r[t],enumerable:!0})},pD=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of fD(r))!dD.call(e,i)&&i!==t&&Mf(e,i,{get:()=>r[i],enumerable:!(n=cD(r,i))||n.enumerable});return e},mD=e=>pD(Mf({},"__esModule",{value:!0}),e),yb={};hD(yb,{Paragraph:()=>bb,default:()=>gD});kb.exports=mD(yb);var vb=P(),bb=vb.Node.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",(0,vb.mergeAttributes)(this.options.HTMLAttributes,e),0]},parseMarkdown:(e,r)=>{let t=e.tokens||[];return t.length===1&&t[0].type==="image"?r.parseChildren([t[0]]):r.createNode("paragraph",void 0,r.parseInline(t))},renderMarkdown:(e,r)=>!e||!Array.isArray(e.content)?"":r.renderChildren(e.content),addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),gD=bb});var Eb=S((gH,Tb)=>{"use strict";var Nf=Object.defineProperty,vD=Object.getOwnPropertyDescriptor,yD=Object.getOwnPropertyNames,bD=Object.prototype.hasOwnProperty,kD=(e,r)=>{for(var t in r)Nf(e,t,{get:r[t],enumerable:!0})},wD=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of yD(r))!bD.call(e,i)&&i!==t&&Nf(e,i,{get:()=>r[i],enumerable:!(n=vD(r,i))||n.enumerable});return e},SD=e=>wD(Nf({},"__esModule",{value:!0}),e),wb={};kD(wb,{Strike:()=>_b,default:()=>xD,inputRegex:()=>Sb,pasteRegex:()=>xb});Tb.exports=SD(wb);var Qa=P(),Sb=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,xb=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,_b=Qa.Mark.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",(0,Qa.mergeAttributes)(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:(e,r)=>r.applyMark("strike",r.parseInline(e.tokens||[])),renderMarkdown:(e,r)=>`~~${r.renderChildren(e)}~~`,addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[(0,Qa.markInputRule)({find:Sb,type:this.type})]},addPasteRules(){return[(0,Qa.markPasteRule)({find:xb,type:this.type})]}}),xD=_b});var Ab=S((vH,Mb)=>{"use strict";var Pf=Object.defineProperty,_D=Object.getOwnPropertyDescriptor,TD=Object.getOwnPropertyNames,ED=Object.prototype.hasOwnProperty,CD=(e,r)=>{for(var t in r)Pf(e,t,{get:r[t],enumerable:!0})},OD=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of TD(r))!ED.call(e,i)&&i!==t&&Pf(e,i,{get:()=>r[i],enumerable:!(n=_D(r,i))||n.enumerable});return e},MD=e=>OD(Pf({},"__esModule",{value:!0}),e),Cb={};CD(Cb,{Text:()=>Ob,default:()=>ND});Mb.exports=MD(Cb);var AD=P(),Ob=AD.Node.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""}),ND=Ob});var el=S((yH,Db)=>{"use strict";var Rf=Object.defineProperty,PD=Object.getOwnPropertyDescriptor,RD=Object.getOwnPropertyNames,DD=Object.prototype.hasOwnProperty,ID=(e,r)=>{for(var t in r)Rf(e,t,{get:r[t],enumerable:!0})},LD=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of RD(r))!DD.call(e,i)&&i!==t&&Rf(e,i,{get:()=>r[i],enumerable:!(n=PD(r,i))||n.enumerable});return e},FD=e=>LD(Rf({},"__esModule",{value:!0}),e),Pb={};ID(Pb,{Underline:()=>Rb,default:()=>BD});Db.exports=FD(Pb);var Nb=P(),Rb=Nb.Mark.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",(0,Nb.mergeAttributes)(this.options.HTMLAttributes,e),0]},parseMarkdown(e,r){return r.applyMark(this.name||"underline",r.parseInline(e.tokens||[]))},renderMarkdown(e,r){return`++${r.renderChildren(e)}++`},markdownTokenizer:{name:"underline",level:"inline",start(e){return e.indexOf("++")},tokenize(e,r,t){let i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!i)return;let o=i[2].trim();return{type:"underline",raw:i[0],text:o,tokens:t.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),BD=Rb});var Fb=S(Lb=>{"use strict";function xo(e){"@babel/helpers - typeof";return xo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},xo(e)}function zD(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Ib(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jD(n.key),n)}}function qD(e,r,t){return r&&Ib(e.prototype,r),t&&Ib(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jD(e){var r=HD(e,"string");return xo(r)==="symbol"?r:String(r)}function HD(e,r){if(xo(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(xo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var $D=$t(),WD=cr();function VD(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new $D.Plugin({view:function(t){return new UD(t,e)}})}var UD=(function(){function e(r,t){var n=this;zD(this,e);var i;this.editorView=r,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(i=t.width)!==null&&i!==void 0?i:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(function(o){var s=function(l){n[o](l)};return r.dom.addEventListener(o,s),{name:o,handler:s}})}return qD(e,[{key:"destroy",value:function(){var t=this;this.handlers.forEach(function(n){var i=n.name,o=n.handler;return t.editorView.dom.removeEventListener(i,o)})}},{key:"update",value:function(t,n){this.cursorPos!=null&&n.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}},{key:"setCursor",value:function(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}},{key:"updateOverlay",value:function(){var t=this.editorView.state.doc.resolve(this.cursorPos),n=!t.parent.inlineContent,i,o=this.editorView.dom,s=o.getBoundingClientRect(),a=s.width/o.offsetWidth,l=s.height/o.offsetHeight;if(n){var u=t.nodeBefore,c=t.nodeAfter;if(u||c){var f=this.editorView.nodeDOM(this.cursorPos-(u?u.nodeSize:0));if(f){var d=f.getBoundingClientRect(),h=u?d.bottom:d.top;u&&c&&(h=(h+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);var p=this.width/2*l;i={left:d.left,right:d.right,top:h-p,bottom:h+p}}}}if(!i){var m=this.editorView.coordsAtPos(this.cursorPos),v=this.width/2*a;i={left:m.left-v,right:m.left+v,top:m.top,bottom:m.bottom}}var g=this.editorView.dom.offsetParent;this.element||(this.element=g.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);var y,w;if(!g||g==document.body&&getComputedStyle(g).position=="static")y=-pageXOffset,w=-pageYOffset;else{var b=g.getBoundingClientRect(),k=b.width/g.offsetWidth,x=b.height/g.offsetHeight;y=b.left-g.scrollLeft*k,w=b.top-g.scrollTop*x}this.element.style.left=(i.left-y)/a+"px",this.element.style.top=(i.top-w)/l+"px",this.element.style.width=(i.right-i.left)/a+"px",this.element.style.height=(i.bottom-i.top)/l+"px"}},{key:"scheduleRemoval",value:function(t){var n=this;clearTimeout(this.timeout),this.timeout=setTimeout(function(){return n.setCursor(null)},t)}},{key:"dragover",value:function(t){if(this.editorView.editable){var n=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),i=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),o=i&&i.type.spec.disableDropCursor,s=typeof o=="function"?o(this.editorView,n,t):o;if(n&&!s){var a=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){var l=WD.dropPoint(this.editorView.state.doc,a,this.editorView.dragging.slice);l!=null&&(a=l)}this.setCursor(a),this.scheduleRemoval(5e3)}}}},{key:"dragend",value:function(){this.scheduleRemoval(20)}},{key:"drop",value:function(){this.scheduleRemoval(20)}},{key:"dragleave",value:function(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}]),e})();Lb.dropCursor=VD});var Bb=S(tl=>{"use strict";Object.defineProperty(tl,"__esModule",{value:!0});function KD(e){Object.keys(e).filter(r=>r!=="default"&&r!=="__esModule").forEach(r=>{tl.hasOwnProperty(r)||Object.defineProperty(tl,r,{enumerable:!0,configurable:!0,get:()=>e[r]})})}var JD=Fb();KD(JD)});var Wb=S(If=>{"use strict";function Zn(e){"@babel/helpers - typeof";return Zn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Zn(e)}function jb(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function zb(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZD(n.key),n)}}function Hb(e,r,t){return r&&zb(e.prototype,r),t&&zb(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZD(e){var r=GD(e,"string");return Zn(r)==="symbol"?r:String(r)}function GD(e,r){if(Zn(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(Zn(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function XD(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&Df(e,r)}function Df(e,r){return Df=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Df(e,r)}function YD(e){var r=tI();return function(){var n=il(e),i;if(r){var o=il(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return QD(this,i)}}function QD(e,r){if(r&&(Zn(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eI(e)}function eI(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function il(e){return il=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},il(e)}var rI=hc(),Gt=$t(),nl=lr(),qb=cc(),ze=(function(e){XD(t,e);var r=YD(t);function t(n){return jb(this,t),r.call(this,n,n)}return Hb(t,[{key:"map",value:function(i,o){var s=i.resolve(o.map(this.head));return t.valid(s)?new t(s):Gt.Selection.near(s)}},{key:"content",value:function(){return nl.Slice.empty}},{key:"eq",value:function(i){return i instanceof t&&i.head==this.head}},{key:"toJSON",value:function(){return{type:"gapcursor",pos:this.head}}},{key:"getBookmark",value:function(){return new nI(this.anchor)}}],[{key:"fromJSON",value:function(i,o){if(typeof o.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new t(i.resolve(o.pos))}},{key:"valid",value:function(i){var o=i.parent;if(o.isTextblock||!iI(i)||!oI(i))return!1;var s=o.type.spec.allowGapCursor;if(s!=null)return s;var a=o.contentMatchAt(i.index()).defaultType;return a&&a.isTextblock}},{key:"findGapCursorFrom",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;e:for(;;){if(!s&&t.valid(i))return i;for(var a=i.pos,l=null,u=i.depth;;u--){var c=i.node(u);if(o>0?i.indexAfter(u)<c.childCount:i.index(u)>0){l=c.child(o>0?i.indexAfter(u):i.index(u)-1);break}else if(u==0)return null;a+=o;var f=i.doc.resolve(a);if(t.valid(f))return f}for(;;){var d=o>0?l.firstChild:l.lastChild;if(!d){if(l.isAtom&&!l.isText&&!Gt.NodeSelection.isSelectable(l)){i=i.doc.resolve(a+l.nodeSize*o),s=!1;continue e}break}l=d,a+=o;var h=i.doc.resolve(a);if(t.valid(h))return h}return null}}}]),t})(Gt.Selection);ze.prototype.visible=!1;ze.findFrom=ze.findGapCursorFrom;Gt.Selection.jsonID("gapcursor",ze);var nI=(function(){function e(r){jb(this,e),this.pos=r}return Hb(e,[{key:"map",value:function(t){return new e(t.map(this.pos))}},{key:"resolve",value:function(t){var n=t.resolve(this.pos);return ze.valid(n)?new ze(n):Gt.Selection.near(n)}}]),e})();function $b(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}function iI(e){for(var r=e.depth;r>=0;r--){var t=e.index(r),n=e.node(r);if(t==0){if(n.type.spec.isolating)return!0;continue}for(var i=n.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||$b(i.type))return!0;if(i.inlineContent)return!1}}return!0}function oI(e){for(var r=e.depth;r>=0;r--){var t=e.indexAfter(r),n=e.node(r);if(t==n.childCount){if(n.type.spec.isolating)return!0;continue}for(var i=n.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||$b(i.type))return!0;if(i.inlineContent)return!1}}return!0}function sI(){return new Gt.Plugin({props:{decorations:cI,createSelectionBetween:function(r,t,n){return t.pos==n.pos&&ze.valid(n)?new ze(n):null},handleClick:lI,handleKeyDown:aI,handleDOMEvents:{beforeinput:uI}}})}var aI=rI.keydownHandler({ArrowLeft:rl("horiz",-1),ArrowRight:rl("horiz",1),ArrowUp:rl("vert",-1),ArrowDown:rl("vert",1)});function rl(e,r){var t=e=="vert"?r>0?"down":"up":r>0?"right":"left";return function(n,i,o){var s=n.selection,a=r>0?s.$to:s.$from,l=s.empty;if(s instanceof Gt.TextSelection){if(!o.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=n.doc.resolve(r>0?a.after():a.before())}var u=ze.findGapCursorFrom(a,r,l);return u?(i&&i(n.tr.setSelection(new ze(u))),!0):!1}}function lI(e,r,t){if(!e||!e.editable)return!1;var n=e.state.doc.resolve(r);if(!ze.valid(n))return!1;var i=e.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&Gt.NodeSelection.isSelectable(e.state.doc.nodeAt(i.inside))?!1:(e.dispatch(e.state.tr.setSelection(new ze(n))),!0)}function uI(e,r){if(r.inputType!="insertCompositionText"||!(e.state.selection instanceof ze))return!1;var t=e.state.selection.$from,n=t.parent.contentMatchAt(t.index()).findWrapping(e.state.schema.nodes.text);if(!n)return!1;for(var i=nl.Fragment.empty,o=n.length-1;o>=0;o--)i=nl.Fragment.from(n[o].createAndFill(null,i));var s=e.state.tr.replace(t.pos,t.pos,new nl.Slice(i,0,0));return s.setSelection(Gt.TextSelection.near(s.doc.resolve(t.pos+1))),e.dispatch(s),!1}function cI(e){if(!(e.selection instanceof ze))return null;var r=document.createElement("div");return r.className="ProseMirror-gapcursor",qb.DecorationSet.create(e.doc,[qb.Decoration.widget(e.selection.head,r,{key:"gapcursor"})])}If.GapCursor=ze;If.gapCursor=sI});var Vb=S(ol=>{"use strict";Object.defineProperty(ol,"__esModule",{value:!0});function fI(e){Object.keys(e).filter(r=>r!=="default"&&r!=="__esModule").forEach(r=>{ol.hasOwnProperty(r)||Object.defineProperty(ol,r,{enumerable:!0,configurable:!0,get:()=>e[r]})})}var dI=Wb();fI(dI)});var Jb=S((xH,Kb)=>{"use strict";var sl=200,we=function(){};we.prototype.append=function(r){return r.length?(r=we.from(r),!this.length&&r||r.length<sl&&this.leafAppend(r)||this.length<sl&&r.leafPrepend(this)||this.appendInner(r)):this};we.prototype.prepend=function(r){return r.length?we.from(r).append(this):this};we.prototype.appendInner=function(r){return new hI(this,r)};we.prototype.slice=function(r,t){return r===void 0&&(r=0),t===void 0&&(t=this.length),r>=t?we.empty:this.sliceInner(Math.max(0,r),Math.min(this.length,t))};we.prototype.get=function(r){if(!(r<0||r>=this.length))return this.getInner(r)};we.prototype.forEach=function(r,t,n){t===void 0&&(t=0),n===void 0&&(n=this.length),t<=n?this.forEachInner(r,t,n,0):this.forEachInvertedInner(r,t,n,0)};we.prototype.map=function(r,t,n){t===void 0&&(t=0),n===void 0&&(n=this.length);var i=[];return this.forEach(function(o,s){return i.push(r(o,s))},t,n),i};we.from=function(r){return r instanceof we?r:r&&r.length?new Ub(r):we.empty};var Ub=(function(e){function r(n){e.call(this),this.values=n}e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r;var t={length:{configurable:!0},depth:{configurable:!0}};return r.prototype.flatten=function(){return this.values},r.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new r(this.values.slice(i,o))},r.prototype.getInner=function(i){return this.values[i]},r.prototype.forEachInner=function(i,o,s,a){for(var l=o;l<s;l++)if(i(this.values[l],a+l)===!1)return!1},r.prototype.forEachInvertedInner=function(i,o,s,a){for(var l=o-1;l>=s;l--)if(i(this.values[l],a+l)===!1)return!1},r.prototype.leafAppend=function(i){if(this.length+i.length<=sl)return new r(this.values.concat(i.flatten()))},r.prototype.leafPrepend=function(i){if(this.length+i.length<=sl)return new r(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(r.prototype,t),r})(we);we.empty=new Ub([]);var hI=(function(e){function r(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},r.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},r.prototype.forEachInner=function(n,i,o,s){var a=this.left.length;if(i<a&&this.left.forEachInner(n,i,Math.min(o,a),s)===!1||o>a&&this.right.forEachInner(n,Math.max(i-a,0),Math.min(this.length,o)-a,s+a)===!1)return!1},r.prototype.forEachInvertedInner=function(n,i,o,s){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(n,i-a,Math.max(o,a)-a,s+a)===!1||o<a&&this.left.forEachInvertedInner(n,Math.min(i,a),o,s)===!1)return!1},r.prototype.sliceInner=function(n,i){if(n==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(n,i):n>=o?this.right.slice(n-o,i-o):this.left.slice(n,o).append(this.right.slice(0,i-o))},r.prototype.leafAppend=function(n){var i=this.right.leafAppend(n);if(i)return new r(this.left,i)},r.prototype.leafPrepend=function(n){var i=this.left.leafPrepend(n);if(i)return new r(i,this.right)},r.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new r(this.left,new r(this.right,n)):new r(this,n)},r})(we);Kb.exports=we});var rk=S(Nt=>{"use strict";function _o(e){"@babel/helpers - typeof";return _o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_o(e)}function Bf(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Zb(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pI(n.key),n)}}function zf(e,r,t){return r&&Zb(e.prototype,r),t&&Zb(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pI(e){var r=mI(e,"string");return _o(r)==="symbol"?r:String(r)}function mI(e,r){if(_o(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(_o(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Yb=Jb(),gI=cr(),qf=$t(),vI=500,To=(function(){function e(r,t){Bf(this,e),this.items=r,this.eventCount=t}return zf(e,[{key:"popEvent",value:function(t,n){var i=this;if(this.eventCount==0)return null;for(var o=this.items.length;;o--){var s=this.items.get(o-1);if(s.selection){--o;break}}var a,l;n&&(a=this.remapping(o,this.items.length),l=a.maps.length);var u=t.tr,c,f,d=[],h=[];return this.items.forEach(function(p,m){if(!p.step){a||(a=i.remapping(o,m+1),l=a.maps.length),l--,h.push(p);return}if(a){h.push(new xr(p.map));var v=p.step.map(a.slice(l)),g;v&&u.maybeStep(v).doc&&(g=u.mapping.maps[u.mapping.maps.length-1],d.push(new xr(g,void 0,void 0,d.length+h.length))),l--,g&&a.appendMap(g,l)}else u.maybeStep(p.step);if(p.selection)return c=a?p.selection.map(a.slice(l)):p.selection,f=new e(i.items.slice(0,o).append(h.reverse().concat(d)),i.eventCount-1),!1},this.items.length,0),{remaining:f,transform:u,selection:c}}},{key:"addTransform",value:function(t,n,i,o){for(var s=[],a=this.eventCount,l=this.items,u=!o&&l.length?l.get(l.length-1):null,c=0;c<t.steps.length;c++){var f=t.steps[c].invert(t.docs[c]),d=new xr(t.mapping.maps[c],f,n),h=void 0;(h=u&&u.merge(d))&&(d=h,c?s.pop():l=l.slice(0,l.length-1)),s.push(d),n&&(a++,n=void 0),o||(u=d)}var p=a-i.depth;return p>bI&&(l=yI(l,p),a-=p),new e(l.append(s),a)}},{key:"remapping",value:function(t,n){var i=new gI.Mapping;return this.items.forEach(function(o,s){var a=o.mirrorOffset!=null&&s-o.mirrorOffset>=t?i.maps.length-o.mirrorOffset:void 0;i.appendMap(o.map,a)},t,n),i}},{key:"addMaps",value:function(t){return this.eventCount==0?this:new e(this.items.append(t.map(function(n){return new xr(n)})),this.eventCount)}},{key:"rebased",value:function(t,n){if(!this.eventCount)return this;var i=[],o=Math.max(0,this.items.length-n),s=t.mapping,a=t.steps.length,l=this.eventCount;this.items.forEach(function(p){p.selection&&l--},o);var u=n;this.items.forEach(function(p){var m=s.getMirror(--u);if(m!=null){a=Math.min(a,m);var v=s.maps[m];if(p.step){var g=t.steps[m].invert(t.docs[m]),y=p.selection&&p.selection.map(s.slice(u+1,m));y&&l++,i.push(new xr(v,g,y))}else i.push(new xr(v))}},o);for(var c=[],f=n;f<a;f++)c.push(new xr(s.maps[f]));var d=this.items.slice(0,o).append(c).append(i),h=new e(d,l);return h.emptyItemCount()>vI&&(h=h.compress(this.items.length-i.length)),h}},{key:"emptyItemCount",value:function(){var t=0;return this.items.forEach(function(n){n.step||t++}),t}},{key:"compress",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.items.length,n=this.remapping(0,t),i=n.maps.length,o=[],s=0;return this.items.forEach(function(a,l){if(l>=t)o.push(a),a.selection&&s++;else if(a.step){var u=a.step.map(n.slice(i)),c=u&&u.getMap();if(i--,c&&n.appendMap(c,i),u){var f=a.selection&&a.selection.map(n.slice(i));f&&s++;var d=new xr(c.invert(),u,f),h,p=o.length-1;(h=o.length&&o[p].merge(d))?o[p]=h:o.push(d)}}else a.map&&i--},this.items.length,0),new e(Yb.from(o.reverse()),s)}}]),e})();To.empty=new To(Yb.empty,0);function yI(e,r){var t;return e.forEach(function(n,i){if(n.selection&&r--==0)return t=i,!1}),e.slice(t)}var xr=(function(){function e(r,t,n,i){Bf(this,e),this.map=r,this.step=t,this.selection=n,this.mirrorOffset=i}return zf(e,[{key:"merge",value:function(t){if(this.step&&t.step&&!t.selection){var n=t.step.merge(this.step);if(n)return new e(n.getMap().invert(),n,this.selection)}}}]),e})(),_r=zf(function e(r,t,n,i,o){Bf(this,e),this.done=r,this.undone=t,this.prevRanges=n,this.prevTime=i,this.prevComposition=o}),bI=20;function kI(e,r,t,n){var i=t.getMeta(At),o;if(i)return i.historyState;t.getMeta(Qb)&&(e=new _r(e.done,e.undone,null,0,-1));var s=t.getMeta("appendedTransaction");if(t.steps.length==0)return e;if(s&&s.getMeta(At))return s.getMeta(At).redo?new _r(e.done.addTransform(t,void 0,n,al(r)),e.undone,Gb(t.mapping.maps),e.prevTime,e.prevComposition):new _r(e.done,e.undone.addTransform(t,void 0,n,al(r)),null,e.prevTime,e.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){var a=t.getMeta("composition"),l=e.prevTime==0||!s&&e.prevComposition!=a&&(e.prevTime<(t.time||0)-n.newGroupDelay||!wI(t,e.prevRanges)),u=s?Lf(e.prevRanges,t.mapping):Gb(t.mapping.maps);return new _r(e.done.addTransform(t,l?r.selection.getBookmark():void 0,n,al(r)),To.empty,u,t.time,a??e.prevComposition)}else return(o=t.getMeta("rebased"))?new _r(e.done.rebased(t,o),e.undone.rebased(t,o),Lf(e.prevRanges,t.mapping),e.prevTime,e.prevComposition):new _r(e.done.addMaps(t.mapping.maps),e.undone.addMaps(t.mapping.maps),Lf(e.prevRanges,t.mapping),e.prevTime,e.prevComposition)}function wI(e,r){if(!r)return!1;if(!e.docChanged)return!0;var t=!1;return e.mapping.maps[0].forEach(function(n,i){for(var o=0;o<r.length;o+=2)n<=r[o+1]&&i>=r[o]&&(t=!0)}),t}function Gb(e){for(var r=[],t=e.length-1;t>=0&&r.length==0;t--)e[t].forEach(function(n,i,o,s){return r.push(o,s)});return r}function Lf(e,r){if(!e)return null;for(var t=[],n=0;n<e.length;n+=2){var i=r.map(e[n],1),o=r.map(e[n+1],-1);i<=o&&t.push(i,o)}return t}function SI(e,r,t){var n=al(r),i=At.get(r).spec.config,o=(t?e.undone:e.done).popEvent(r,n);if(!o)return null;var s=o.selection.resolve(o.transform.doc),a=(t?e.done:e.undone).addTransform(o.transform,r.selection.getBookmark(),i,n),l=new _r(t?a:o.remaining,t?o.remaining:a,null,0,-1);return o.transform.setSelection(s).setMeta(At,{redo:t,historyState:l})}var Ff=!1,Xb=null;function al(e){var r=e.plugins;if(Xb!=r){Ff=!1,Xb=r;for(var t=0;t<r.length;t++)if(r[t].spec.historyPreserveItems){Ff=!0;break}}return Ff}function xI(e){return e.setMeta(Qb,!0)}var At=new qf.PluginKey("history"),Qb=new qf.PluginKey("closeHistory");function _I(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new qf.Plugin({key:At,state:{init:function(){return new _r(To.empty,To.empty,null,0,-1)},apply:function(t,n,i){return kI(n,i,t,e)}},config:e,props:{handleDOMEvents:{beforeinput:function(t,n){var i=n.inputType,o=i=="historyUndo"?ek:i=="historyRedo"?tk:null;return!o||!t.editable?!1:(n.preventDefault(),o(t.state,t.dispatch))}}}})}function ll(e,r){return function(t,n){var i=At.getState(t);if(!i||(e?i.undone:i.done).eventCount==0)return!1;if(n){var o=SI(i,t,e);o&&n(r?o.scrollIntoView():o)}return!0}}var ek=ll(!1,!0),tk=ll(!0,!0),TI=ll(!1,!1),EI=ll(!0,!1);function CI(e){var r=At.getState(e);return r?r.done.eventCount:0}function OI(e){var r=At.getState(e);return r?r.undone.eventCount:0}function MI(e){return e.getMeta(At)!=null}Nt.closeHistory=xI;Nt.history=_I;Nt.isHistoryTransaction=MI;Nt.redo=tk;Nt.redoDepth=OI;Nt.redoNoScroll=EI;Nt.undo=ek;Nt.undoDepth=CI;Nt.undoNoScroll=TI});var nk=S(ul=>{"use strict";Object.defineProperty(ul,"__esModule",{value:!0});function AI(e){Object.keys(e).filter(r=>r!=="default"&&r!=="__esModule").forEach(r=>{ul.hasOwnProperty(r)||Object.defineProperty(ul,r,{enumerable:!0,configurable:!0,get:()=>e[r]})})}var NI=rk();AI(NI)});var gk=S((EH,mk)=>{"use strict";var Wf=Object.defineProperty,PI=Object.getOwnPropertyDescriptor,RI=Object.getOwnPropertyNames,DI=Object.prototype.hasOwnProperty,II=(e,r)=>{for(var t in r)Wf(e,t,{get:r[t],enumerable:!0})},LI=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of RI(r))!DI.call(e,i)&&i!==t&&Wf(e,i,{get:()=>r[i],enumerable:!(n=PI(r,i))||n.enumerable});return e},FI=e=>LI(Wf({},"__esModule",{value:!0}),e),pk={};II(pk,{CharacterCount:()=>zI,Dropcursor:()=>HI,Focus:()=>WI,Gapcursor:()=>UI,Placeholder:()=>KI,Selection:()=>JI,TrailingNode:()=>GI,UndoRedo:()=>YI});mk.exports=FI(pk);var BI=P(),ik=I(),zI=BI.Extension.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(r=>r!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{let r=e?.node||this.editor.state.doc;if((e?.mode||this.options.mode)==="textSize"){let n=r.textBetween(0,r.content.size,void 0," ");return this.options.textCounter(n)}return r.nodeSize},this.storage.words=e=>{let r=e?.node||this.editor.state.doc,t=r.textBetween(0,r.content.size," "," ");return this.options.wordCounter(t)}},addProseMirrorPlugins(){let e=!1;return[new ik.Plugin({key:new ik.PluginKey("characterCount"),appendTransaction:(r,t,n)=>{if(e)return;let i=this.options.limit;if(i==null||i===0){e=!0;return}let o=this.storage.characters({node:n.doc});if(o>i){let s=o-i,a=0,l=s;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);let u=n.tr.deleteRange(a,l);return e=!0,u}e=!0},filterTransaction:(r,t)=>{let n=this.options.limit;if(!r.docChanged||n===0||n===null||n===void 0)return!0;let i=this.storage.characters({node:t.doc}),o=this.storage.characters({node:r.doc});if(o<=n||i>n&&o>n&&o<=i)return!0;if(i>n&&o>n&&o>i||!r.getMeta("paste"))return!1;let a=r.selection.$head.pos,l=o-n,u=a-l,c=a;return r.deleteRange(u,c),!(this.storage.characters({node:r.doc})>n)}})]}}),qI=P(),jI=Bb(),HI=qI.Extension.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[(0,jI.dropCursor)(this.options)]}}),$I=P(),ok=I(),jf=Ui(),WI=$I.Extension.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new ok.Plugin({key:new ok.PluginKey("focus"),props:{decorations:({doc:e,selection:r})=>{let{isEditable:t,isFocused:n}=this.editor,{anchor:i}=r,o=[];if(!t||!n)return jf.DecorationSet.create(e,[]);let s=0;this.options.mode==="deepest"&&e.descendants((l,u)=>{if(l.isText)return;if(!(i>=u&&i<=u+l.nodeSize-1))return!1;s+=1});let a=0;return e.descendants((l,u)=>{if(l.isText||!(i>=u&&i<=u+l.nodeSize-1))return!1;if(a+=1,this.options.mode==="deepest"&&s-a>0||this.options.mode==="shallowest"&&a>1)return this.options.mode==="deepest";o.push(jf.Decoration.node(u,u+l.nodeSize,{class:this.options.className}))}),jf.DecorationSet.create(e,o)}}})]}}),Hf=P(),VI=Vb(),UI=Hf.Extension.create({name:"gapCursor",addProseMirrorPlugins(){return[(0,VI.gapCursor)()]},extendNodeSchema(e){var r;let t={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(r=(0,Hf.callOrReturn)((0,Hf.getExtensionField)(e,"allowGapCursor",t)))!=null?r:null}}}),sk=P(),ak=I(),lk=Ui(),KI=sk.Extension.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something \u2026",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new ak.Plugin({key:new ak.PluginKey("placeholder"),props:{decorations:({doc:e,selection:r})=>{let t=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=r,i=[];if(!t)return null;let o=this.editor.isEmpty;return e.descendants((s,a)=>{let l=n>=a&&n<=a+s.nodeSize,u=!s.isLeaf&&(0,sk.isNodeEmpty)(s);if((l||!this.options.showOnlyCurrent)&&u){let c=[this.options.emptyNodeClass];o&&c.push(this.options.emptyEditorClass);let f=lk.Decoration.node(a,a+s.nodeSize,{class:c.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:a,hasAnchor:l}):this.options.placeholder});i.push(f)}return this.options.includeChildren}),lk.DecorationSet.create(e,i)}}})]}}),uk=P(),ck=I(),fk=Ui(),JI=uk.Extension.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){let{editor:e,options:r}=this;return[new ck.Plugin({key:new ck.PluginKey("selection"),props:{decorations(t){return t.selection.empty||e.isFocused||!e.isEditable||(0,uk.isNodeSelection)(t.selection)||e.view.dragging?null:fk.DecorationSet.create(t.doc,[fk.Decoration.inline(t.selection.from,t.selection.to,{class:r.className})])}}})]}}),ZI=P(),dk=I();function hk({types:e,node:r}){return r&&Array.isArray(e)&&e.includes(r.type)||r?.type===e}var GI=ZI.Extension.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var e;let r=new dk.PluginKey(this.name),t=((e=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:e.name)||this.options.node||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(t).includes(i.name));return[new dk.Plugin({key:r,appendTransaction:(i,o,s)=>{let{doc:a,tr:l,schema:u}=s,c=r.getState(s),f=a.content.size,d=u.nodes[t];if(c)return l.insert(f,d.create())},state:{init:(i,o)=>{let s=o.tr.doc.lastChild;return!hk({node:s,types:n})},apply:(i,o)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return o;let s=i.doc.lastChild;return!hk({node:s,types:n})}}})]}}),XI=P(),$f=nk(),YI=XI.Extension.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:r})=>(0,$f.undo)(e,r),redo:()=>({state:e,dispatch:r})=>(0,$f.redo)(e,r)}},addProseMirrorPlugins(){return[(0,$f.history)(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044F":()=>this.editor.commands.undo(),"Shift-Mod-\u044F":()=>this.editor.commands.redo()}}})});var Uf=S((CH,bk)=>{"use strict";var Vf=Object.defineProperty,QI=Object.getOwnPropertyDescriptor,e2=Object.getOwnPropertyNames,t2=Object.prototype.hasOwnProperty,r2=(e,r)=>{for(var t in r)Vf(e,t,{get:r[t],enumerable:!0})},n2=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of e2(r))!t2.call(e,i)&&i!==t&&Vf(e,i,{get:()=>r[i],enumerable:!(n=QI(r,i))||n.enumerable});return e},i2=e=>n2(Vf({},"__esModule",{value:!0}),e),vk={};r2(vk,{StarterKit:()=>yk,default:()=>k2});bk.exports=i2(vk);var o2=P(),s2=Ly(),a2=Vy(),l2=Xy(),u2=n0(),c2=a0(),f2=d0(),d2=Jc(),h2=b0(),p2=C0(),m2=Z0(),cl=Sr(),g2=Af(),v2=Eb(),y2=Ab(),b2=el(),fl=gk(),yk=o2.Extension.create({name:"starterKit",addExtensions(){var e,r,t,n;let i=[];return this.options.bold!==!1&&i.push(a2.Bold.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(s2.Blockquote.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(cl.BulletList.configure(this.options.bulletList)),this.options.code!==!1&&i.push(l2.Code.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(u2.CodeBlock.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(c2.Document.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(fl.Dropcursor.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(fl.Gapcursor.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(f2.HardBreak.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(d2.Heading.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(fl.UndoRedo.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(h2.HorizontalRule.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(p2.Italic.configure(this.options.italic)),this.options.listItem!==!1&&i.push(cl.ListItem.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(cl.ListKeymap.configure((e=this.options)==null?void 0:e.listKeymap)),this.options.link!==!1&&i.push(m2.Link.configure((r=this.options)==null?void 0:r.link)),this.options.orderedList!==!1&&i.push(cl.OrderedList.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(g2.Paragraph.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(v2.Strike.configure(this.options.strike)),this.options.text!==!1&&i.push(y2.Text.configure(this.options.text)),this.options.underline!==!1&&i.push(b2.Underline.configure((t=this.options)==null?void 0:t.underline)),this.options.trailingNode!==!1&&i.push(fl.TrailingNode.configure((n=this.options)==null?void 0:n.trailingNode)),i}}),k2=yk});var Sk=S((OH,wk)=>{"use strict";var Kf=Object.defineProperty,w2=Object.getOwnPropertyDescriptor,S2=Object.getOwnPropertyNames,x2=Object.prototype.hasOwnProperty,_2=(e,r)=>{for(var t in r)Kf(e,t,{get:r[t],enumerable:!0})},T2=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of S2(r))!x2.call(e,i)&&i!==t&&Kf(e,i,{get:()=>r[i],enumerable:!(n=w2(r,i))||n.enumerable});return e},E2=e=>T2(Kf({},"__esModule",{value:!0}),e),kk={};_2(kk,{BulletList:()=>O2.BulletList,default:()=>M2});wk.exports=E2(kk);var C2=Sr(),O2=Sr(),M2=C2.BulletList});var Tk=S((MH,_k)=>{"use strict";var Jf=Object.defineProperty,A2=Object.getOwnPropertyDescriptor,N2=Object.getOwnPropertyNames,P2=Object.prototype.hasOwnProperty,R2=(e,r)=>{for(var t in r)Jf(e,t,{get:r[t],enumerable:!0})},D2=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of N2(r))!P2.call(e,i)&&i!==t&&Jf(e,i,{get:()=>r[i],enumerable:!(n=A2(r,i))||n.enumerable});return e},I2=e=>D2(Jf({},"__esModule",{value:!0}),e),xk={};R2(xk,{OrderedList:()=>F2.OrderedList,default:()=>B2});_k.exports=I2(xk);var L2=Sr(),F2=Sr(),B2=L2.OrderedList});var Ok=S((AH,Ck)=>{"use strict";var Zf=Object.defineProperty,z2=Object.getOwnPropertyDescriptor,q2=Object.getOwnPropertyNames,j2=Object.prototype.hasOwnProperty,H2=(e,r)=>{for(var t in r)Zf(e,t,{get:r[t],enumerable:!0})},$2=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of q2(r))!j2.call(e,i)&&i!==t&&Zf(e,i,{get:()=>r[i],enumerable:!(n=z2(r,i))||n.enumerable});return e},W2=e=>$2(Zf({},"__esModule",{value:!0}),e),Ek={};H2(Ek,{ListItem:()=>U2.ListItem,default:()=>K2});Ck.exports=W2(Ek);var V2=Sr(),U2=Sr(),K2=V2.ListItem});var Xf=S((NH,Pk)=>{"use strict";var Gf=Object.defineProperty,J2=Object.getOwnPropertyDescriptor,Z2=Object.getOwnPropertyNames,G2=Object.prototype.hasOwnProperty,X2=(e,r)=>{for(var t in r)Gf(e,t,{get:r[t],enumerable:!0})},Y2=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of Z2(r))!G2.call(e,i)&&i!==t&&Gf(e,i,{get:()=>r[i],enumerable:!(n=J2(r,i))||n.enumerable});return e},Q2=e=>Y2(Gf({},"__esModule",{value:!0}),e),Ak={};X2(Ak,{Subscript:()=>Nk,default:()=>eL});Pk.exports=Q2(Ak);var Mk=P(),Nk=Mk.Mark.create({name:"subscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sub"},{style:"vertical-align",getAttrs(e){return e!=="sub"?!1:null}}]},renderHTML({HTMLAttributes:e}){return["sub",(0,Mk.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{setSubscript:()=>({commands:e})=>e.setMark(this.name),toggleSubscript:()=>({commands:e})=>e.toggleMark(this.name),unsetSubscript:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-,":()=>this.editor.commands.toggleSubscript()}}}),eL=Nk});var Qf=S((PH,Lk)=>{"use strict";var Yf=Object.defineProperty,tL=Object.getOwnPropertyDescriptor,rL=Object.getOwnPropertyNames,nL=Object.prototype.hasOwnProperty,iL=(e,r)=>{for(var t in r)Yf(e,t,{get:r[t],enumerable:!0})},oL=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of rL(r))!nL.call(e,i)&&i!==t&&Yf(e,i,{get:()=>r[i],enumerable:!(n=tL(r,i))||n.enumerable});return e},sL=e=>oL(Yf({},"__esModule",{value:!0}),e),Dk={};iL(Dk,{Superscript:()=>Ik,default:()=>aL});Lk.exports=sL(Dk);var Rk=P(),Ik=Rk.Mark.create({name:"superscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sup"},{style:"vertical-align",getAttrs(e){return e!=="super"?!1:null}}]},renderHTML({HTMLAttributes:e}){return["sup",(0,Rk.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{setSuperscript:()=>({commands:e})=>e.setMark(this.name),toggleSuperscript:()=>({commands:e})=>e.toggleMark(this.name),unsetSuperscript:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-.":()=>this.editor.commands.toggleSuperscript()}}}),aL=Ik});var td=S((RH,Uk)=>{"use strict";var ed=Object.defineProperty,lL=Object.getOwnPropertyDescriptor,uL=Object.getOwnPropertyNames,cL=Object.prototype.hasOwnProperty,fL=(e,r)=>{for(var t in r)ed(e,t,{get:r[t],enumerable:!0})},dL=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of uL(r))!cL.call(e,i)&&i!==t&&ed(e,i,{get:()=>r[i],enumerable:!(n=lL(r,i))||n.enumerable});return e},hL=e=>dL(ed({},"__esModule",{value:!0}),e),Bk={};fL(Bk,{BackgroundColor:()=>jk,Color:()=>Hk,FontFamily:()=>$k,FontSize:()=>Wk,LineHeight:()=>Vk,TextStyle:()=>qk,TextStyleKit:()=>SL});Uk.exports=hL(Bk);var Fk=P(),pL=20,zk=(e,r=0)=>{let t=[];return!e.children.length||r>pL||Array.from(e.children).forEach(n=>{n.tagName==="SPAN"?t.push(n):n.children.length&&t.push(...zk(n,r+1))}),t},mL=e=>{if(!e.children.length)return;let r=zk(e);r&&r.forEach(t=>{var n,i;let o=t.getAttribute("style"),s=(i=(n=t.parentElement)==null?void 0:n.closest("span"))==null?void 0:i.getAttribute("style");t.setAttribute("style",`${s};${o}`)})},qk=Fk.Mark.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:e=>e.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&mL(e),{}):!1}]},renderHTML({HTMLAttributes:e}){return["span",(0,Fk.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleTextStyle:e=>({commands:r})=>r.toggleMark(this.name,e),removeEmptyTextStyle:()=>({tr:e})=>{let{selection:r}=e;return e.doc.nodesBetween(r.from,r.to,(t,n)=>{if(t.isTextblock)return!0;t.marks.filter(i=>i.type===this.type).some(i=>Object.values(i.attrs).some(o=>!!o))||e.removeMark(n,n+t.nodeSize,this.type)}),!0}}}}),gL=P(),jk=gL.Extension.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:e=>{var r;let t=e.getAttribute("style");if(t){let n=t.split(";").map(i=>i.trim()).filter(Boolean);for(let i=n.length-1;i>=0;i-=1){let o=n[i].split(":");if(o.length>=2){let s=o[0].trim().toLowerCase(),a=o.slice(1).join(":").trim();if(s==="background-color")return a.replace(/['"]+/g,"")}}}return(r=e.style.backgroundColor)==null?void 0:r.replace(/['"]+/g,"")},renderHTML:e=>e.backgroundColor?{style:`background-color: ${e.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:e=>({chain:r})=>r().setMark("textStyle",{backgroundColor:e}).run(),unsetBackgroundColor:()=>({chain:e})=>e().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),vL=P(),Hk=vL.Extension.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:e=>{var r;let t=e.getAttribute("style");if(t){let n=t.split(";").map(i=>i.trim()).filter(Boolean);for(let i=n.length-1;i>=0;i-=1){let o=n[i].split(":");if(o.length>=2){let s=o[0].trim().toLowerCase(),a=o.slice(1).join(":").trim();if(s==="color")return a.replace(/['"]+/g,"")}}}return(r=e.style.color)==null?void 0:r.replace(/['"]+/g,"")},renderHTML:e=>e.color?{style:`color: ${e.color}`}:{}}}}]},addCommands(){return{setColor:e=>({chain:r})=>r().setMark("textStyle",{color:e}).run(),unsetColor:()=>({chain:e})=>e().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),yL=P(),$k=yL.Extension.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:e=>e.style.fontFamily,renderHTML:e=>e.fontFamily?{style:`font-family: ${e.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:e=>({chain:r})=>r().setMark("textStyle",{fontFamily:e}).run(),unsetFontFamily:()=>({chain:e})=>e().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),bL=P(),Wk=bL.Extension.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:e=>e.style.fontSize,renderHTML:e=>e.fontSize?{style:`font-size: ${e.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:e=>({chain:r})=>r().setMark("textStyle",{fontSize:e}).run(),unsetFontSize:()=>({chain:e})=>e().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),kL=P(),Vk=kL.Extension.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:e=>e.style.lineHeight,renderHTML:e=>e.lineHeight?{style:`line-height: ${e.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:e=>({chain:r})=>r().setMark("textStyle",{lineHeight:e}).run(),unsetLineHeight:()=>({chain:e})=>e().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}}),wL=P(),SL=wL.Extension.create({name:"textStyleKit",addExtensions(){let e=[];return this.options.backgroundColor!==!1&&e.push(jk.configure(this.options.backgroundColor)),this.options.color!==!1&&e.push(Hk.configure(this.options.color)),this.options.fontFamily!==!1&&e.push($k.configure(this.options.fontFamily)),this.options.fontSize!==!1&&e.push(Wk.configure(this.options.fontSize)),this.options.lineHeight!==!1&&e.push(Vk.configure(this.options.lineHeight)),this.options.textStyle!==!1&&e.push(qk.configure(this.options.textStyle)),e}})});var Jk=S((DH,Kk)=>{var{Node:xL,mergeAttributes:_L}=P(),TL=xL.create({name:"footnote",group:"inline",inline:!0,atom:!0,addAttributes(){return{id:{default:null,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>({"data-id":e.id})},number:{default:null}}},parseHTML(){return[{tag:'span[data-type="footnote"]'}]},renderHTML({HTMLAttributes:e}){return["span",_L(e,{"data-type":"footnote",class:"colophon-footnote"}),["sup",{class:"footnote-symbol"},e.number||"#"]]},addCommands(){return{addFootnote:()=>({commands:e})=>{let r=`fn-${Date.now()}`;return e.insertContent({type:this.name,attrs:{id:r,number:"#"}})}}}});Kk.exports=TL});var rd=S((IH,Zk)=>{var{Extension:EL,InputRule:Gn}=P(),CL=EL.create({name:"substitutions",addOptions(){return{smartQuotes:!0,smartDashes:!0,doubleQuoteStyle:"\u201C|\u201D",singleQuoteStyle:"\u2018|\u2019"}},addInputRules(){let e=[];if(this.options.smartDashes&&(e.push(new Gn({find:/---\s$/,handler:({state:r,range:t})=>r.tr.insertText("\u2014 ",t.from,t.to)})),e.push(new Gn({find:/--\s$/,handler:({state:r,range:t})=>r.tr.insertText("\u2013 ",t.from,t.to)}))),this.options.smartQuotes){let[r,t]=this.options.doubleQuoteStyle.split("|"),[n,i]=this.options.singleQuoteStyle.split("|");e.push(new Gn({find:/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,handler:({state:o,range:s,match:a})=>{let l=a[0],u=l.substring(0,l.length-1);return o.tr.insertText(u+r,s.from,s.to)}})),e.push(new Gn({find:/"$/,handler:({state:o,range:s})=>o.tr.insertText(t,s.from,s.to)})),e.push(new Gn({find:/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,handler:({state:o,range:s,match:a})=>{let l=a[0],u=l.substring(0,l.length-1);return o.tr.insertText(u+n,s.from,s.to)}})),e.push(new Gn({find:/'$/,handler:({state:o,range:s})=>o.tr.insertText(i,s.from,s.to)}))}return e}});Zk.exports=CL});var Xk=S((FH,Gk)=>{var{SuggestModal:OL}=require("obsidian"),{TextSelection:LH}=I(),nd=class extends OL{constructor(r,t,n){super(r),this.app=r,this.editor=t,this.range=n,this.updateListener=()=>this.updateAndFilterSuggestions()}onOpen(){super.onOpen(),this.editor.on("update",this.updateListener),this.updateAndFilterSuggestions()}onClose(){super.onClose(),this.editor.off("update",this.updateListener)}updateAndFilterSuggestions(){let r=this.getEditorQuery();if(r===null){this.close();return}this.inputEl.value=r,this.onInput()}getEditorQuery(){try{let r=this.editor.state,t=r.selection.from;return t<this.range.from+2||r.doc.textBetween(this.range.from,this.range.from+2)!=="[["?null:r.doc.textBetween(this.range.from+2,t)}catch{return null}}getSuggestions(r){let t=this.app.vault.getMarkdownFiles();if(!r)return t;let n=r.toLowerCase();return t.filter(i=>i.path.toLowerCase().includes(n)||i.basename.toLowerCase().includes(n))}renderSuggestion(r,t){t.createEl("div",{text:r.basename}),t.createEl("small",{text:r.path})}onChooseSuggestion(r,t){let n=r.basename;if(this.editor&&!this.editor.isDestroyed){let{schema:i,tr:o}=this.editor.state,s=this.range.from,a=this.editor.state.selection.from;o.replaceWith(s,a,i.text(n,[i.marks.internallink.create({href:n})])),this.editor.view.dispatch(o)}}};Gk.exports=nd});var id=S((BH,Qk)=>{var{Mark:ML,InputRule:AL,mergeAttributes:NL}=P(),{Plugin:Yk,PluginKey:PL}=I(),RL=Xk(),DL=ML.create({name:"internallink",inclusive:!1,addOptions(){return{app:null,HTMLAttributes:{class:"internal-link"}}},parseHTML(){return[{tag:"a.internal-link"}]},addAttributes(){return{href:{default:null},text:{default:null}}},renderHTML({HTMLAttributes:e}){return["a",NL(this.options.HTMLAttributes,e),0]},addInputRules(){return[new AL({find:/\[\[([^|\]]+)(?:\|([^\]]+))?\]\]$/,handler:({state:e,range:r,match:t})=>{let{tr:n}=e,i=r.from,o=r.to,s=t[1],a=t[2],l=a||s;return n.replaceWith(i,o,e.schema.text(l,[e.schema.marks.internallink.create({href:s,text:a})])),n}})]},addProseMirrorPlugins(){let e=this,r=e.editor,t=(o,s)=>{let a=o.marks().find(f=>f.type===s);if(!a)return null;let l=o.pos,u=o.pos,c=o.index();for(let f=c;f>=0;f--){let d=o.parent.child(f);if(a.isInSet(d.marks))l=o.start()+d.content.findIndex(d).offset;else break}for(let f=c;f<o.parent.childCount;f++){let d=o.parent.child(f);if(a.isInSet(d.marks))u=o.start()+d.content.findIndex(d).offset+d.nodeSize;else break}return{from:l,to:u,mark:a}},n=new Yk({key:new PL("internallink-live-preview"),state:{init(){return{activeLink:null}},apply(o,s,a,l){let{selection:u}=o,c=s.activeLink,f=null;if(c){let{from:d,to:h}=c,p=o.mapping.map(d),m=o.mapping.map(h);u.from>=p&&u.to<=m&&(f={from:p,to:m,text:l.doc.textBetween(p,m)})}if(u.empty){let d=t(u.$from,l.schema.marks.internallink);if(d){let{from:h,to:p,mark:m}=d,v=m.attrs.text,g=v?`[[${m.attrs.href}|${v}]]`:`[[${m.attrs.href}]]`;f={from:h,to:p,text:g,mark:m}}}return JSON.stringify(f)===JSON.stringify(c)?s:{activeLink:f}}},view(o){return{update:(s,a)=>{let l=this.key.getState(s.state),u=this.key.getState(a);if(l.activeLink&&!u.activeLink){let{from:c,to:f,text:d}=l.activeLink;s.dispatch(s.state.tr.removeMark(c,f).replaceWith(c,f,s.state.schema.text(d)).setMeta("addToHistory",!1))}else if(!l.activeLink&&u.activeLink){let{from:c,to:f}=u.activeLink,h=a.doc.textBetween(c,f).match(/\[\[([^|\]]+)(?:\|([^\]]+))?\]\]/),p=s.state.tr;if(h){let m=h[1],v=h[2],g=v||m;p.replaceWith(c,f,s.state.schema.text(g,[s.state.schema.marks.internallink.create({href:m,text:v})]))}p.docChanged&&s.dispatch(p)}}}}});return[new Yk({props:{handleDOMEvents:{click(o,s){let a=s.target.closest(".internal-link");if(!a)return!1;let l=a.getAttribute("href");if(l&&e.options.app){s.preventDefault(),s.stopPropagation();let u=e.options.getFilePath?e.options.getFilePath():"",c=navigator.platform.toUpperCase().indexOf("MAC")>=0?s.metaKey:s.ctrlKey,f=s.altKey;return c&&f?e.options.app.workspace.openLinkText(l,u,"split"):c?e.options.app.workspace.openLinkText(l,u,"tab"):e.options.app.workspace.openLinkText(l,u,!1),!0}return!1}},handleTextInput(o,s,a,l){return l==="["&&e.options.app&&o.state.doc.textBetween(s-1,s)==="["&&setTimeout(()=>{new RL(e.options.app,e.editor,{from:s-1,to:s+1}).open()},0),!1}}}),n]}});Qk.exports=DL});var tw=S((zH,ew)=>{var{Mark:IL,InputRule:LL,mergeAttributes:FL}=P(),{Plugin:BL}=I(),zL=IL.create({name:"standardLink",inclusive:!1,addOptions(){return{app:null,HTMLAttributes:{class:"standard-link"}}},addAttributes(){return{href:{default:null}}},parseHTML(){return[{tag:"a[href]:not(.internal-link)"}]},renderHTML({HTMLAttributes:e}){return["a",FL(this.options.HTMLAttributes,e),0]},addInputRules(){return[new LL({find:/\[([^\]]+)\]\(([^)]+)\)$/,handler:({state:e,range:r,match:t})=>{let{tr:n}=e,i=r.from,o=r.to,s=t[1],a=t[2];return n.replaceWith(i,o,e.schema.text(s,[e.schema.marks.standardLink.create({href:a})])),n}})]},addProseMirrorPlugins(){let e=this;return[new BL({props:{handleDOMEvents:{click(r,t){let n=t.target.closest("a.standard-link");if(!n)return!1;let i=n.getAttribute("href");if(i&&e.options.app){if(t.preventDefault(),t.stopPropagation(),/^(http|https|mailto|tel):/.test(i))return window.open(i,"_blank"),!0;let s=e.options.getFilePath?e.options.getFilePath():"",a=navigator.platform.toUpperCase().indexOf("MAC")>=0?t.metaKey:t.ctrlKey,l=t.altKey;return a&&l?e.options.app.workspace.openLinkText(i,s,"split"):a?e.options.app.workspace.openLinkText(i,s,"tab"):e.options.app.workspace.openLinkText(i,s,!1),!0}return!1}}}})]}});ew.exports=zL});var Eo=S((qH,od)=>{"use strict";typeof process>"u"||!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0?od.exports={nextTick:qL}:od.exports=process;function qL(e,r,t,n){if(typeof e!="function")throw new TypeError('"callback" argument must be a function');var i=arguments.length,o,s;switch(i){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,r)});case 3:return process.nextTick(function(){e.call(null,r,t)});case 4:return process.nextTick(function(){e.call(null,r,t,n)});default:for(o=new Array(i-1),s=0;s<o.length;)o[s++]=arguments[s];return process.nextTick(function(){e.apply(null,o)})}}});var nw=S((jH,rw)=>{var jL={}.toString;rw.exports=Array.isArray||function(e){return jL.call(e)=="[object Array]"}});var sd=S((HH,iw)=>{iw.exports=require("stream")});var Co=S((ad,sw)=>{var dl=require("buffer"),Xt=dl.Buffer;function ow(e,r){for(var t in e)r[t]=e[t]}Xt.from&&Xt.alloc&&Xt.allocUnsafe&&Xt.allocUnsafeSlow?sw.exports=dl:(ow(dl,ad),ad.Buffer=Xn);function Xn(e,r,t){return Xt(e,r,t)}ow(Xt,Xn);Xn.from=function(e,r,t){if(typeof e=="number")throw new TypeError("Argument must not be a number");return Xt(e,r,t)};Xn.alloc=function(e,r,t){if(typeof e!="number")throw new TypeError("Argument must be a number");var n=Xt(e);return r!==void 0?typeof t=="string"?n.fill(r,t):n.fill(r):n.fill(0),n};Xn.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return Xt(e)};Xn.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return dl.SlowBuffer(e)}});var Yn=S(Ae=>{function HL(e){return Array.isArray?Array.isArray(e):hl(e)==="[object Array]"}Ae.isArray=HL;function $L(e){return typeof e=="boolean"}Ae.isBoolean=$L;function WL(e){return e===null}Ae.isNull=WL;function VL(e){return e==null}Ae.isNullOrUndefined=VL;function UL(e){return typeof e=="number"}Ae.isNumber=UL;function KL(e){return typeof e=="string"}Ae.isString=KL;function JL(e){return typeof e=="symbol"}Ae.isSymbol=JL;function ZL(e){return e===void 0}Ae.isUndefined=ZL;function GL(e){return hl(e)==="[object RegExp]"}Ae.isRegExp=GL;function XL(e){return typeof e=="object"&&e!==null}Ae.isObject=XL;function YL(e){return hl(e)==="[object Date]"}Ae.isDate=YL;function QL(e){return hl(e)==="[object Error]"||e instanceof Error}Ae.isError=QL;function eF(e){return typeof e=="function"}Ae.isFunction=eF;function tF(e){return e===null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||typeof e=="symbol"||typeof e>"u"}Ae.isPrimitive=tF;Ae.isBuffer=require("buffer").Buffer.isBuffer;function hl(e){return Object.prototype.toString.call(e)}});var aw=S((WH,ld)=>{typeof Object.create=="function"?ld.exports=function(r,t){t&&(r.super_=t,r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:ld.exports=function(r,t){if(t){r.super_=t;var n=function(){};n.prototype=t.prototype,r.prototype=new n,r.prototype.constructor=r}}});var Qn=S((VH,cd)=>{try{if(ud=require("util"),typeof ud.inherits!="function")throw"";cd.exports=ud.inherits}catch{cd.exports=aw()}var ud});var uw=S((UH,fd)=>{"use strict";function rF(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var lw=Co().Buffer,Oo=require("util");function nF(e,r,t){e.copy(r,t)}fd.exports=(function(){function e(){rF(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(t){var n={data:t,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length},e.prototype.unshift=function(t){var n={data:t,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length},e.prototype.shift=function(){if(this.length!==0){var t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(t){if(this.length===0)return"";for(var n=this.head,i=""+n.data;n=n.next;)i+=t+n.data;return i},e.prototype.concat=function(t){if(this.length===0)return lw.alloc(0);for(var n=lw.allocUnsafe(t>>>0),i=this.head,o=0;i;)nF(i.data,n,o),o+=i.data.length,i=i.next;return n},e})();Oo&&Oo.inspect&&Oo.inspect.custom&&(fd.exports.prototype[Oo.inspect.custom]=function(){var e=Oo.inspect({length:this.length});return this.constructor.name+" "+e})});var dd=S((KH,cw)=>{"use strict";var pl=Eo();function iF(e,r){var t=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(r?r(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,pl.nextTick(ml,this,e)):pl.nextTick(ml,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(o){!r&&o?t._writableState?t._writableState.errorEmitted||(t._writableState.errorEmitted=!0,pl.nextTick(ml,t,o)):pl.nextTick(ml,t,o):r&&r(o)}),this)}function oF(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function ml(e,r){e.emit("error",r)}cw.exports={destroy:iF,undestroy:oF}});var dw=S((JH,fw)=>{fw.exports=require("util").deprecate});var pd=S((ZH,kw)=>{"use strict";var rn=Eo();kw.exports=ue;function pw(e){var r=this;this.next=null,this.entry=null,this.finish=function(){xF(r,e)}}var sF=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:rn.nextTick,ei;ue.WritableState=Ao;var mw=Object.create(Yn());mw.inherits=Qn();var aF={deprecate:dw()},gw=sd(),vl=Co().Buffer,lF=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function uF(e){return vl.from(e)}function cF(e){return vl.isBuffer(e)||e instanceof lF}var vw=dd();mw.inherits(ue,gw);function fF(){}function Ao(e,r){ei=ei||nn(),e=e||{};var t=r instanceof ei;this.objectMode=!!e.objectMode,t&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,i=e.writableHighWaterMark,o=this.objectMode?16:16*1024;n||n===0?this.highWaterMark=n:t&&(i||i===0)?this.highWaterMark=i:this.highWaterMark=o,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=e.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){yF(r,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new pw(this)}Ao.prototype.getBuffer=function(){for(var r=this.bufferedRequest,t=[];r;)t.push(r),r=r.next;return t};(function(){try{Object.defineProperty(Ao.prototype,"buffer",{get:aF.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var gl;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(gl=Function.prototype[Symbol.hasInstance],Object.defineProperty(ue,Symbol.hasInstance,{value:function(e){return gl.call(this,e)?!0:this!==ue?!1:e&&e._writableState instanceof Ao}})):gl=function(e){return e instanceof this};function ue(e){if(ei=ei||nn(),!gl.call(ue,this)&&!(this instanceof ei))return new ue(e);this._writableState=new Ao(e,this),this.writable=!0,e&&(typeof e.write=="function"&&(this._write=e.write),typeof e.writev=="function"&&(this._writev=e.writev),typeof e.destroy=="function"&&(this._destroy=e.destroy),typeof e.final=="function"&&(this._final=e.final)),gw.call(this)}ue.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function dF(e,r){var t=new Error("write after end");e.emit("error",t),rn.nextTick(r,t)}function hF(e,r,t,n){var i=!0,o=!1;return t===null?o=new TypeError("May not write null values to stream"):typeof t!="string"&&t!==void 0&&!r.objectMode&&(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),rn.nextTick(n,o),i=!1),i}ue.prototype.write=function(e,r,t){var n=this._writableState,i=!1,o=!n.objectMode&&cF(e);return o&&!vl.isBuffer(e)&&(e=uF(e)),typeof r=="function"&&(t=r,r=null),o?r="buffer":r||(r=n.defaultEncoding),typeof t!="function"&&(t=fF),n.ended?dF(this,t):(o||hF(this,n,e,t))&&(n.pendingcb++,i=mF(this,n,o,e,r,t)),i};ue.prototype.cork=function(){var e=this._writableState;e.corked++};ue.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,!e.writing&&!e.corked&&!e.bufferProcessing&&e.bufferedRequest&&yw(this,e))};ue.prototype.setDefaultEncoding=function(r){if(typeof r=="string"&&(r=r.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((r+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+r);return this._writableState.defaultEncoding=r,this};function pF(e,r,t){return!e.objectMode&&e.decodeStrings!==!1&&typeof r=="string"&&(r=vl.from(r,t)),r}Object.defineProperty(ue.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function mF(e,r,t,n,i,o){if(!t){var s=pF(r,n,i);n!==s&&(t=!0,i="buffer",n=s)}var a=r.objectMode?1:n.length;r.length+=a;var l=r.length<r.highWaterMark;if(l||(r.needDrain=!0),r.writing||r.corked){var u=r.lastBufferedRequest;r.lastBufferedRequest={chunk:n,encoding:i,isBuf:t,callback:o,next:null},u?u.next=r.lastBufferedRequest:r.bufferedRequest=r.lastBufferedRequest,r.bufferedRequestCount+=1}else hd(e,r,!1,a,n,i,o);return l}function hd(e,r,t,n,i,o,s){r.writelen=n,r.writecb=s,r.writing=!0,r.sync=!0,t?e._writev(i,r.onwrite):e._write(i,o,r.onwrite),r.sync=!1}function gF(e,r,t,n,i){--r.pendingcb,t?(rn.nextTick(i,n),rn.nextTick(Mo,e,r),e._writableState.errorEmitted=!0,e.emit("error",n)):(i(n),e._writableState.errorEmitted=!0,e.emit("error",n),Mo(e,r))}function vF(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function yF(e,r){var t=e._writableState,n=t.sync,i=t.writecb;if(vF(t),r)gF(e,t,n,r,i);else{var o=bw(t);!o&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&yw(e,t),n?sF(hw,e,t,o,i):hw(e,t,o,i)}}function hw(e,r,t,n){t||bF(e,r),r.pendingcb--,n(),Mo(e,r)}function bF(e,r){r.length===0&&r.needDrain&&(r.needDrain=!1,e.emit("drain"))}function yw(e,r){r.bufferProcessing=!0;var t=r.bufferedRequest;if(e._writev&&t&&t.next){var n=r.bufferedRequestCount,i=new Array(n),o=r.corkedRequestsFree;o.entry=t;for(var s=0,a=!0;t;)i[s]=t,t.isBuf||(a=!1),t=t.next,s+=1;i.allBuffers=a,hd(e,r,!0,r.length,i,"",o.finish),r.pendingcb++,r.lastBufferedRequest=null,o.next?(r.corkedRequestsFree=o.next,o.next=null):r.corkedRequestsFree=new pw(r),r.bufferedRequestCount=0}else{for(;t;){var l=t.chunk,u=t.encoding,c=t.callback,f=r.objectMode?1:l.length;if(hd(e,r,!1,f,l,u,c),t=t.next,r.bufferedRequestCount--,r.writing)break}t===null&&(r.lastBufferedRequest=null)}r.bufferedRequest=t,r.bufferProcessing=!1}ue.prototype._write=function(e,r,t){t(new Error("_write() is not implemented"))};ue.prototype._writev=null;ue.prototype.end=function(e,r,t){var n=this._writableState;typeof e=="function"?(t=e,e=null,r=null):typeof r=="function"&&(t=r,r=null),e!=null&&this.write(e,r),n.corked&&(n.corked=1,this.uncork()),n.ending||SF(this,n,t)};function bw(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function kF(e,r){e._final(function(t){r.pendingcb--,t&&e.emit("error",t),r.prefinished=!0,e.emit("prefinish"),Mo(e,r)})}function wF(e,r){!r.prefinished&&!r.finalCalled&&(typeof e._final=="function"?(r.pendingcb++,r.finalCalled=!0,rn.nextTick(kF,e,r)):(r.prefinished=!0,e.emit("prefinish")))}function Mo(e,r){var t=bw(r);return t&&(wF(e,r),r.pendingcb===0&&(r.finished=!0,e.emit("finish"))),t}function SF(e,r,t){r.ending=!0,Mo(e,r),t&&(r.finished?rn.nextTick(t):e.once("finish",t)),r.ended=!0,e.writable=!1}function xF(e,r,t){var n=e.entry;for(e.entry=null;n;){var i=n.callback;r.pendingcb--,i(t),n=n.next}r.corkedRequestsFree.next=e}Object.defineProperty(ue.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}});ue.prototype.destroy=vw.destroy;ue.prototype._undestroy=vw.undestroy;ue.prototype._destroy=function(e,r){this.end(),r(e)}});var nn=S((GH,_w)=>{"use strict";var ww=Eo(),_F=Object.keys||function(e){var r=[];for(var t in e)r.push(t);return r};_w.exports=Yt;var Sw=Object.create(Yn());Sw.inherits=Qn();var xw=vd(),gd=pd();Sw.inherits(Yt,xw);for(md=_F(gd.prototype),yl=0;yl<md.length;yl++)bl=md[yl],Yt.prototype[bl]||(Yt.prototype[bl]=gd.prototype[bl]);var md,bl,yl;function Yt(e){if(!(this instanceof Yt))return new Yt(e);xw.call(this,e),gd.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",TF)}Object.defineProperty(Yt.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function TF(){this.allowHalfOpen||this._writableState.ended||ww.nextTick(EF,this)}function EF(e){e.end()}Object.defineProperty(Yt.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}});Yt.prototype._destroy=function(e,r){this.push(null),this.end(),ww.nextTick(r,e)}});var kd=S(Ew=>{"use strict";var bd=Co().Buffer,Tw=bd.isEncoding||function(e){switch(e=""+e,e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function CF(e){if(!e)return"utf8";for(var r;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(r)return;e=(""+e).toLowerCase(),r=!0}}function OF(e){var r=CF(e);if(typeof r!="string"&&(bd.isEncoding===Tw||!Tw(e)))throw new Error("Unknown encoding: "+e);return r||e}Ew.StringDecoder=No;function No(e){this.encoding=OF(e);var r;switch(this.encoding){case"utf16le":this.text=DF,this.end=IF,r=4;break;case"utf8":this.fillLast=NF,r=4;break;case"base64":this.text=LF,this.end=FF,r=3;break;default:this.write=BF,this.end=zF;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=bd.allocUnsafe(r)}No.prototype.write=function(e){if(e.length===0)return"";var r,t;if(this.lastNeed){if(r=this.fillLast(e),r===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<e.length?r?r+this.text(e,t):this.text(e,t):r||""};No.prototype.end=RF;No.prototype.text=PF;No.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length};function yd(e){return e<=127?0:e>>5===6?2:e>>4===14?3:e>>3===30?4:e>>6===2?-1:-2}function MF(e,r,t){var n=r.length-1;if(n<t)return 0;var i=yd(r[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<t||i===-2?0:(i=yd(r[n]),i>=0?(i>0&&(e.lastNeed=i-2),i):--n<t||i===-2?0:(i=yd(r[n]),i>=0?(i>0&&(i===2?i=0:e.lastNeed=i-3),i):0))}function AF(e,r,t){if((r[0]&192)!==128)return e.lastNeed=0,"\uFFFD";if(e.lastNeed>1&&r.length>1){if((r[1]&192)!==128)return e.lastNeed=1,"\uFFFD";if(e.lastNeed>2&&r.length>2&&(r[2]&192)!==128)return e.lastNeed=2,"\uFFFD"}}function NF(e){var r=this.lastTotal-this.lastNeed,t=AF(this,e,r);if(t!==void 0)return t;if(this.lastNeed<=e.length)return e.copy(this.lastChar,r,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,r,0,e.length),this.lastNeed-=e.length}function PF(e,r){var t=MF(this,e,r);if(!this.lastNeed)return e.toString("utf8",r);this.lastTotal=t;var n=e.length-(t-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",r,n)}function RF(e){var r=e&&e.length?this.write(e):"";return this.lastNeed?r+"\uFFFD":r}function DF(e,r){if((e.length-r)%2===0){var t=e.toString("utf16le",r);if(t){var n=t.charCodeAt(t.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",r,e.length-1)}function IF(e){var r=e&&e.length?this.write(e):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return r+this.lastChar.toString("utf16le",0,t)}return r}function LF(e,r){var t=(e.length-r)%3;return t===0?e.toString("base64",r):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",r,e.length-t))}function FF(e){var r=e&&e.length?this.write(e):"";return this.lastNeed?r+this.lastChar.toString("base64",0,3-this.lastNeed):r}function BF(e){return e.toString(this.encoding)}function zF(e){return e&&e.length?this.write(e):""}});var vd=S((QH,Bw)=>{"use strict";var ri=Eo();Bw.exports=X;var qF=nw(),Po;X.ReadableState=Rw;var YH=require("events").EventEmitter,Aw=function(e,r){return e.listeners(r).length},Td=sd(),Ro=Co().Buffer,jF=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function HF(e){return Ro.from(e)}function $F(e){return Ro.isBuffer(e)||e instanceof jF}var Nw=Object.create(Yn());Nw.inherits=Qn();var wd=require("util"),H=void 0;wd&&wd.debuglog?H=wd.debuglog("stream"):H=function(){};var WF=uw(),Pw=dd(),ti;Nw.inherits(X,Td);var Sd=["error","close","destroy","pause","resume"];function VF(e,r,t){if(typeof e.prependListener=="function")return e.prependListener(r,t);!e._events||!e._events[r]?e.on(r,t):qF(e._events[r])?e._events[r].unshift(t):e._events[r]=[t,e._events[r]]}function Rw(e,r){Po=Po||nn(),e=e||{};var t=r instanceof Po;this.objectMode=!!e.objectMode,t&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,i=e.readableHighWaterMark,o=this.objectMode?16:16*1024;n||n===0?this.highWaterMark=n:t&&(i||i===0)?this.highWaterMark=i:this.highWaterMark=o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new WF,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(ti||(ti=kd().StringDecoder),this.decoder=new ti(e.encoding),this.encoding=e.encoding)}function X(e){if(Po=Po||nn(),!(this instanceof X))return new X(e);this._readableState=new Rw(e,this),this.readable=!0,e&&(typeof e.read=="function"&&(this._read=e.read),typeof e.destroy=="function"&&(this._destroy=e.destroy)),Td.call(this)}Object.defineProperty(X.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}});X.prototype.destroy=Pw.destroy;X.prototype._undestroy=Pw.undestroy;X.prototype._destroy=function(e,r){this.push(null),r(e)};X.prototype.push=function(e,r){var t=this._readableState,n;return t.objectMode?n=!0:typeof e=="string"&&(r=r||t.defaultEncoding,r!==t.encoding&&(e=Ro.from(e,r),r=""),n=!0),Dw(this,e,r,!1,n)};X.prototype.unshift=function(e){return Dw(this,e,null,!0,!1)};function Dw(e,r,t,n,i){var o=e._readableState;if(r===null)o.reading=!1,ZF(e,o);else{var s;i||(s=UF(o,r)),s?e.emit("error",s):o.objectMode||r&&r.length>0?(typeof r!="string"&&!o.objectMode&&Object.getPrototypeOf(r)!==Ro.prototype&&(r=HF(r)),n?o.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):xd(e,o,r,!0):o.ended?e.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!t?(r=o.decoder.write(r),o.objectMode||r.length!==0?xd(e,o,r,!1):Iw(e,o)):xd(e,o,r,!1))):n||(o.reading=!1)}return KF(o)}function xd(e,r,t,n){r.flowing&&r.length===0&&!r.sync?(e.emit("data",t),e.read(0)):(r.length+=r.objectMode?1:t.length,n?r.buffer.unshift(t):r.buffer.push(t),r.needReadable&&kl(e)),Iw(e,r)}function UF(e,r){var t;return!$F(r)&&typeof r!="string"&&r!==void 0&&!e.objectMode&&(t=new TypeError("Invalid non-string/buffer chunk")),t}function KF(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||e.length===0)}X.prototype.isPaused=function(){return this._readableState.flowing===!1};X.prototype.setEncoding=function(e){return ti||(ti=kd().StringDecoder),this._readableState.decoder=new ti(e),this._readableState.encoding=e,this};var Cw=8388608;function JF(e){return e>=Cw?e=Cw:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function Ow(e,r){return e<=0||r.length===0&&r.ended?0:r.objectMode?1:e!==e?r.flowing&&r.length?r.buffer.head.data.length:r.length:(e>r.highWaterMark&&(r.highWaterMark=JF(e)),e<=r.length?e:r.ended?r.length:(r.needReadable=!0,0))}X.prototype.read=function(e){H("read",e),e=parseInt(e,10);var r=this._readableState,t=e;if(e!==0&&(r.emittedReadable=!1),e===0&&r.needReadable&&(r.length>=r.highWaterMark||r.ended))return H("read: emitReadable",r.length,r.ended),r.length===0&&r.ended?_d(this):kl(this),null;if(e=Ow(e,r),e===0&&r.ended)return r.length===0&&_d(this),null;var n=r.needReadable;H("need readable",n),(r.length===0||r.length-e<r.highWaterMark)&&(n=!0,H("length less than watermark",n)),r.ended||r.reading?(n=!1,H("reading or ended",n)):n&&(H("do read"),r.reading=!0,r.sync=!0,r.length===0&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,r.reading||(e=Ow(t,r)));var i;return e>0?i=Lw(e,r):i=null,i===null?(r.needReadable=!0,e=0):r.length-=e,r.length===0&&(r.ended||(r.needReadable=!0),t!==e&&r.ended&&_d(this)),i!==null&&this.emit("data",i),i};function ZF(e,r){if(!r.ended){if(r.decoder){var t=r.decoder.end();t&&t.length&&(r.buffer.push(t),r.length+=r.objectMode?1:t.length)}r.ended=!0,kl(e)}}function kl(e){var r=e._readableState;r.needReadable=!1,r.emittedReadable||(H("emitReadable",r.flowing),r.emittedReadable=!0,r.sync?ri.nextTick(Mw,e):Mw(e))}function Mw(e){H("emit readable"),e.emit("readable"),Ed(e)}function Iw(e,r){r.readingMore||(r.readingMore=!0,ri.nextTick(GF,e,r))}function GF(e,r){for(var t=r.length;!r.reading&&!r.flowing&&!r.ended&&r.length<r.highWaterMark&&(H("maybeReadMore read 0"),e.read(0),t!==r.length);)t=r.length;r.readingMore=!1}X.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))};X.prototype.pipe=function(e,r){var t=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e);break}n.pipesCount+=1,H("pipe count=%d opts=%j",n.pipesCount,r);var i=(!r||r.end!==!1)&&e!==process.stdout&&e!==process.stderr,o=i?a:v;n.endEmitted?ri.nextTick(o):t.once("end",o),e.on("unpipe",s);function s(g,y){H("onunpipe"),g===t&&y&&y.hasUnpiped===!1&&(y.hasUnpiped=!0,c())}function a(){H("onend"),e.end()}var l=XF(t);e.on("drain",l);var u=!1;function c(){H("cleanup"),e.removeListener("close",p),e.removeListener("finish",m),e.removeListener("drain",l),e.removeListener("error",h),e.removeListener("unpipe",s),t.removeListener("end",a),t.removeListener("end",v),t.removeListener("data",d),u=!0,n.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&l()}var f=!1;t.on("data",d);function d(g){H("ondata"),f=!1;var y=e.write(g);y===!1&&!f&&((n.pipesCount===1&&n.pipes===e||n.pipesCount>1&&Fw(n.pipes,e)!==-1)&&!u&&(H("false write response, pause",n.awaitDrain),n.awaitDrain++,f=!0),t.pause())}function h(g){H("onerror",g),v(),e.removeListener("error",h),Aw(e,"error")===0&&e.emit("error",g)}VF(e,"error",h);function p(){e.removeListener("finish",m),v()}e.once("close",p);function m(){H("onfinish"),e.removeListener("close",p),v()}e.once("finish",m);function v(){H("unpipe"),t.unpipe(e)}return e.emit("pipe",t),n.flowing||(H("pipe resume"),t.resume()),e};function XF(e){return function(){var r=e._readableState;H("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&Aw(e,"data")&&(r.flowing=!0,Ed(e))}}X.prototype.unpipe=function(e){var r=this._readableState,t={hasUnpiped:!1};if(r.pipesCount===0)return this;if(r.pipesCount===1)return e&&e!==r.pipes?this:(e||(e=r.pipes),r.pipes=null,r.pipesCount=0,r.flowing=!1,e&&e.emit("unpipe",this,t),this);if(!e){var n=r.pipes,i=r.pipesCount;r.pipes=null,r.pipesCount=0,r.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=Fw(r.pipes,e);return s===-1?this:(r.pipes.splice(s,1),r.pipesCount-=1,r.pipesCount===1&&(r.pipes=r.pipes[0]),e.emit("unpipe",this,t),this)};X.prototype.on=function(e,r){var t=Td.prototype.on.call(this,e,r);if(e==="data")this._readableState.flowing!==!1&&this.resume();else if(e==="readable"){var n=this._readableState;!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&kl(this):ri.nextTick(YF,this))}return t};X.prototype.addListener=X.prototype.on;function YF(e){H("readable nexttick read 0"),e.read(0)}X.prototype.resume=function(){var e=this._readableState;return e.flowing||(H("resume"),e.flowing=!0,QF(this,e)),this};function QF(e,r){r.resumeScheduled||(r.resumeScheduled=!0,ri.nextTick(eB,e,r))}function eB(e,r){r.reading||(H("resume read 0"),e.read(0)),r.resumeScheduled=!1,r.awaitDrain=0,e.emit("resume"),Ed(e),r.flowing&&!r.reading&&e.read(0)}X.prototype.pause=function(){return H("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(H("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function Ed(e){var r=e._readableState;for(H("flow",r.flowing);r.flowing&&e.read()!==null;);}X.prototype.wrap=function(e){var r=this,t=this._readableState,n=!1;e.on("end",function(){if(H("wrapped end"),t.decoder&&!t.ended){var s=t.decoder.end();s&&s.length&&r.push(s)}r.push(null)}),e.on("data",function(s){if(H("wrapped data"),t.decoder&&(s=t.decoder.write(s)),!(t.objectMode&&s==null)&&!(!t.objectMode&&(!s||!s.length))){var a=r.push(s);a||(n=!0,e.pause())}});for(var i in e)this[i]===void 0&&typeof e[i]=="function"&&(this[i]=(function(s){return function(){return e[s].apply(e,arguments)}})(i));for(var o=0;o<Sd.length;o++)e.on(Sd[o],this.emit.bind(this,Sd[o]));return this._read=function(s){H("wrapped _read",s),n&&(n=!1,e.resume())},this};Object.defineProperty(X.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});X._fromList=Lw;function Lw(e,r){if(r.length===0)return null;var t;return r.objectMode?t=r.buffer.shift():!e||e>=r.length?(r.decoder?t=r.buffer.join(""):r.buffer.length===1?t=r.buffer.head.data:t=r.buffer.concat(r.length),r.buffer.clear()):t=tB(e,r.buffer,r.decoder),t}function tB(e,r,t){var n;return e<r.head.data.length?(n=r.head.data.slice(0,e),r.head.data=r.head.data.slice(e)):e===r.head.data.length?n=r.shift():n=t?rB(e,r):nB(e,r),n}function rB(e,r){var t=r.head,n=1,i=t.data;for(e-=i.length;t=t.next;){var o=t.data,s=e>o.length?o.length:e;if(s===o.length?i+=o:i+=o.slice(0,e),e-=s,e===0){s===o.length?(++n,t.next?r.head=t.next:r.head=r.tail=null):(r.head=t,t.data=o.slice(s));break}++n}return r.length-=n,i}function nB(e,r){var t=Ro.allocUnsafe(e),n=r.head,i=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(o.copy(t,t.length-e,0,s),e-=s,e===0){s===o.length?(++i,n.next?r.head=n.next:r.head=r.tail=null):(r.head=n,n.data=o.slice(s));break}++i}return r.length-=i,t}function _d(e){var r=e._readableState;if(r.length>0)throw new Error('"endReadable()" called on non-empty stream');r.endEmitted||(r.ended=!0,ri.nextTick(iB,r,e))}function iB(e,r){!e.endEmitted&&e.length===0&&(e.endEmitted=!0,r.readable=!1,r.emit("end"))}function Fw(e,r){for(var t=0,n=e.length;t<n;t++)if(e[t]===r)return t;return-1}});var Cd=S((e4,jw)=>{"use strict";jw.exports=Qt;var wl=nn(),qw=Object.create(Yn());qw.inherits=Qn();qw.inherits(Qt,wl);function oB(e,r){var t=this._transformState;t.transforming=!1;var n=t.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));t.writechunk=null,t.writecb=null,r!=null&&this.push(r),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function Qt(e){if(!(this instanceof Qt))return new Qt(e);wl.call(this,e),this._transformState={afterTransform:oB.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.on("prefinish",sB)}function sB(){var e=this;typeof this._flush=="function"?this._flush(function(r,t){zw(e,r,t)}):zw(this,null,null)}Qt.prototype.push=function(e,r){return this._transformState.needTransform=!1,wl.prototype.push.call(this,e,r)};Qt.prototype._transform=function(e,r,t){throw new Error("_transform() is not implemented")};Qt.prototype._write=function(e,r,t){var n=this._transformState;if(n.writecb=t,n.writechunk=e,n.writeencoding=r,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};Qt.prototype._read=function(e){var r=this._transformState;r.writechunk!==null&&r.writecb&&!r.transforming?(r.transforming=!0,this._transform(r.writechunk,r.writeencoding,r.afterTransform)):r.needTransform=!0};Qt.prototype._destroy=function(e,r){var t=this;wl.prototype._destroy.call(this,e,function(n){r(n),t.emit("close")})};function zw(e,r,t){if(r)return e.emit("error",r);if(t!=null&&e.push(t),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}});var Vw=S((t4,Ww)=>{"use strict";Ww.exports=Do;var Hw=Cd(),$w=Object.create(Yn());$w.inherits=Qn();$w.inherits(Do,Hw);function Do(e){if(!(this instanceof Do))return new Do(e);Hw.call(this,e)}Do.prototype._transform=function(e,r,t){t(null,e)}});var Od=S((Se,Sl)=>{var Pt=require("stream");process.env.READABLE_STREAM==="disable"&&Pt?(Sl.exports=Pt,Se=Sl.exports=Pt.Readable,Se.Readable=Pt.Readable,Se.Writable=Pt.Writable,Se.Duplex=Pt.Duplex,Se.Transform=Pt.Transform,Se.PassThrough=Pt.PassThrough,Se.Stream=Pt):(Se=Sl.exports=vd(),Se.Stream=Pt||Se,Se.Readable=Se,Se.Writable=pd(),Se.Duplex=nn(),Se.Transform=Cd(),Se.PassThrough=Vw())});var er=S(Ke=>{"use strict";Ke.base64=!0;Ke.array=!0;Ke.string=!0;Ke.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u";Ke.nodebuffer=typeof Buffer<"u";Ke.uint8array=typeof Uint8Array<"u";if(typeof ArrayBuffer>"u")Ke.blob=!1;else{Md=new ArrayBuffer(0);try{Ke.blob=new Blob([Md],{type:"application/zip"}).size===0}catch{try{Uw=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,Ad=new Uw,Ad.append(Md),Ke.blob=Ad.getBlob("application/zip").size===0}catch{Ke.blob=!1}}}var Md,Uw,Ad;try{Ke.nodestream=!!Od().Readable}catch{Ke.nodestream=!1}});var Pd=S(Nd=>{"use strict";var aB=te(),lB=er(),Rt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";Nd.encode=function(e){for(var r=[],t,n,i,o,s,a,l,u=0,c=e.length,f=c,d=aB.getTypeOf(e)!=="string";u<e.length;)f=c-u,d?(t=e[u++],n=u<c?e[u++]:0,i=u<c?e[u++]:0):(t=e.charCodeAt(u++),n=u<c?e.charCodeAt(u++):0,i=u<c?e.charCodeAt(u++):0),o=t>>2,s=(t&3)<<4|n>>4,a=f>1?(n&15)<<2|i>>6:64,l=f>2?i&63:64,r.push(Rt.charAt(o)+Rt.charAt(s)+Rt.charAt(a)+Rt.charAt(l));return r.join("")};Nd.decode=function(e){var r,t,n,i,o,s,a,l=0,u=0,c="data:";if(e.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");e=e.replace(/[^A-Za-z0-9+/=]/g,"");var f=e.length*3/4;if(e.charAt(e.length-1)===Rt.charAt(64)&&f--,e.charAt(e.length-2)===Rt.charAt(64)&&f--,f%1!==0)throw new Error("Invalid base64 input, bad content length.");var d;for(lB.uint8array?d=new Uint8Array(f|0):d=new Array(f|0);l<e.length;)i=Rt.indexOf(e.charAt(l++)),o=Rt.indexOf(e.charAt(l++)),s=Rt.indexOf(e.charAt(l++)),a=Rt.indexOf(e.charAt(l++)),r=i<<2|o>>4,t=(o&15)<<4|s>>2,n=(s&3)<<6|a,d[u++]=r,s!==64&&(d[u++]=t),a!==64&&(d[u++]=n);return d}});var Io=S((i4,Kw)=>{"use strict";Kw.exports={isNode:typeof Buffer<"u",newBufferFrom:function(e,r){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,r);if(typeof e=="number")throw new Error('The "data" argument must not be a number');return new Buffer(e,r)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var r=new Buffer(e);return r.fill(0),r},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&typeof e.on=="function"&&typeof e.pause=="function"&&typeof e.resume=="function"}}});var Xw=S((o4,Gw)=>{"use strict";var Jw=global.MutationObserver||global.WebKitMutationObserver,ni;process.browser?Jw?(Rd=0,Zw=new Jw(Lo),Dd=global.document.createTextNode(""),Zw.observe(Dd,{characterData:!0}),ni=function(){Dd.data=Rd=++Rd%2}):!global.setImmediate&&typeof global.MessageChannel<"u"?(Id=new global.MessageChannel,Id.port1.onmessage=Lo,ni=function(){Id.port2.postMessage(0)}):"document"in global&&"onreadystatechange"in global.document.createElement("script")?ni=function(){var e=global.document.createElement("script");e.onreadystatechange=function(){Lo(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},global.document.documentElement.appendChild(e)}:ni=function(){setTimeout(Lo,0)}:ni=function(){process.nextTick(Lo)};var Rd,Zw,Dd,Id,Ld,Fo=[];function Lo(){Ld=!0;for(var e,r,t=Fo.length;t;){for(r=Fo,Fo=[],e=-1;++e<t;)r[e]();t=Fo.length}Ld=!1}Gw.exports=uB;function uB(e){Fo.push(e)===1&&!Ld&&ni()}});var iS=S((s4,nS)=>{"use strict";var Yw=Xw();function ii(){}var Ne={},Qw=["REJECTED"],Fd=["FULFILLED"],eS=["PENDING"];process.browser||(Bo=["UNHANDLED"]);var Bo;nS.exports=Tr;function Tr(e){if(typeof e!="function")throw new TypeError("resolver must be a function");this.state=eS,this.queue=[],this.outcome=void 0,process.browser||(this.handled=Bo),e!==ii&&tS(this,e)}Tr.prototype.finally=function(e){if(typeof e!="function")return this;var r=this.constructor;return this.then(t,n);function t(i){function o(){return i}return r.resolve(e()).then(o)}function n(i){function o(){throw i}return r.resolve(e()).then(o)}};Tr.prototype.catch=function(e){return this.then(null,e)};Tr.prototype.then=function(e,r){if(typeof e!="function"&&this.state===Fd||typeof r!="function"&&this.state===Qw)return this;var t=new this.constructor(ii);if(process.browser||this.handled===Bo&&(this.handled=null),this.state!==eS){var n=this.state===Fd?e:r;Bd(t,n,this.outcome)}else this.queue.push(new zo(t,e,r));return t};function zo(e,r,t){this.promise=e,typeof r=="function"&&(this.onFulfilled=r,this.callFulfilled=this.otherCallFulfilled),typeof t=="function"&&(this.onRejected=t,this.callRejected=this.otherCallRejected)}zo.prototype.callFulfilled=function(e){Ne.resolve(this.promise,e)};zo.prototype.otherCallFulfilled=function(e){Bd(this.promise,this.onFulfilled,e)};zo.prototype.callRejected=function(e){Ne.reject(this.promise,e)};zo.prototype.otherCallRejected=function(e){Bd(this.promise,this.onRejected,e)};function Bd(e,r,t){Yw(function(){var n;try{n=r(t)}catch(i){return Ne.reject(e,i)}n===e?Ne.reject(e,new TypeError("Cannot resolve promise with itself")):Ne.resolve(e,n)})}Ne.resolve=function(e,r){var t=rS(cB,r);if(t.status==="error")return Ne.reject(e,t.value);var n=t.value;if(n)tS(e,n);else{e.state=Fd,e.outcome=r;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(r)}return e};Ne.reject=function(e,r){e.state=Qw,e.outcome=r,process.browser||e.handled===Bo&&Yw(function(){e.handled===Bo&&process.emit("unhandledRejection",r,e)});for(var t=-1,n=e.queue.length;++t<n;)e.queue[t].callRejected(r);return e};function cB(e){var r=e&&e.then;if(e&&(typeof e=="object"||typeof e=="function")&&typeof r=="function")return function(){r.apply(e,arguments)}}function tS(e,r){var t=!1;function n(a){t||(t=!0,Ne.reject(e,a))}function i(a){t||(t=!0,Ne.resolve(e,a))}function o(){r(i,n)}var s=rS(o);s.status==="error"&&n(s.value)}function rS(e,r){var t={};try{t.value=e(r),t.status="success"}catch(n){t.status="error",t.value=n}return t}Tr.resolve=fB;function fB(e){return e instanceof this?e:Ne.resolve(new this(ii),e)}Tr.reject=dB;function dB(e){var r=new this(ii);return Ne.reject(r,e)}Tr.all=hB;function hB(e){var r=this;if(Object.prototype.toString.call(e)!=="[object Array]")return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var i=new Array(t),o=0,s=-1,a=new this(ii);++s<t;)l(e[s],s);return a;function l(u,c){r.resolve(u).then(f,function(d){n||(n=!0,Ne.reject(a,d))});function f(d){i[c]=d,++o===t&&!n&&(n=!0,Ne.resolve(a,i))}}}Tr.race=pB;function pB(e){var r=this;if(Object.prototype.toString.call(e)!=="[object Array]")return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var i=-1,o=new this(ii);++i<t;)s(e[i]);return o;function s(a){r.resolve(a).then(function(l){n||(n=!0,Ne.resolve(o,l))},function(l){n||(n=!0,Ne.reject(o,l))})}}});var oi=S((a4,oS)=>{"use strict";var zd=null;typeof Promise<"u"?zd=Promise:zd=iS();oS.exports={Promise:zd}});var aS=S(sS=>{(function(e,r){"use strict";if(e.setImmediate)return;var t=1,n={},i=!1,o=e.document,s;function a(y){typeof y!="function"&&(y=new Function(""+y));for(var w=new Array(arguments.length-1),b=0;b<w.length;b++)w[b]=arguments[b+1];var k={callback:y,args:w};return n[t]=k,s(t),t++}function l(y){delete n[y]}function u(y){var w=y.callback,b=y.args;switch(b.length){case 0:w();break;case 1:w(b[0]);break;case 2:w(b[0],b[1]);break;case 3:w(b[0],b[1],b[2]);break;default:w.apply(r,b);break}}function c(y){if(i)setTimeout(c,0,y);else{var w=n[y];if(w){i=!0;try{u(w)}finally{l(y),i=!1}}}}function f(){s=function(y){process.nextTick(function(){c(y)})}}function d(){if(e.postMessage&&!e.importScripts){var y=!0,w=e.onmessage;return e.onmessage=function(){y=!1},e.postMessage("","*"),e.onmessage=w,y}}function h(){var y="setImmediate$"+Math.random()+"$",w=function(b){b.source===e&&typeof b.data=="string"&&b.data.indexOf(y)===0&&c(+b.data.slice(y.length))};e.addEventListener?e.addEventListener("message",w,!1):e.attachEvent("onmessage",w),s=function(b){e.postMessage(y+b,"*")}}function p(){var y=new MessageChannel;y.port1.onmessage=function(w){var b=w.data;c(b)},s=function(w){y.port2.postMessage(w)}}function m(){var y=o.documentElement;s=function(w){var b=o.createElement("script");b.onreadystatechange=function(){c(w),b.onreadystatechange=null,y.removeChild(b),b=null},y.appendChild(b)}}function v(){s=function(y){setTimeout(c,0,y)}}var g=Object.getPrototypeOf&&Object.getPrototypeOf(e);g=g&&g.setTimeout?g:e,{}.toString.call(e.process)==="[object process]"?f():d()?h():e.MessageChannel?p():o&&"onreadystatechange"in o.createElement("script")?m():v(),g.setImmediate=a,g.clearImmediate=l})(typeof self>"u"?typeof global>"u"?sS:global:self)});var te=S(ce=>{"use strict";var Er=er(),mB=Pd(),si=Io(),qd=oi();aS();function gB(e){var r=null;return Er.uint8array?r=new Uint8Array(e.length):r=new Array(e.length),_l(e,r)}ce.newBlob=function(e,r){ce.checkSupport("blob");try{return new Blob([e],{type:r})}catch{try{var t=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,n=new t;return n.append(e),n.getBlob(r)}catch{throw new Error("Bug : can't construct the Blob.")}}};function qo(e){return e}function _l(e,r){for(var t=0;t<e.length;++t)r[t]=e.charCodeAt(t)&255;return r}var xl={stringifyByChunk:function(e,r,t){var n=[],i=0,o=e.length;if(o<=t)return String.fromCharCode.apply(null,e);for(;i<o;)r==="array"||r==="nodebuffer"?n.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+t,o)))):n.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+t,o)))),i+=t;return n.join("")},stringifyByChar:function(e){for(var r="",t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r},applyCanBeUsed:{uint8array:(function(){try{return Er.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return Er.nodebuffer&&String.fromCharCode.apply(null,si.allocBuffer(1)).length===1}catch{return!1}})()}};function jo(e){var r=65536,t=ce.getTypeOf(e),n=!0;if(t==="uint8array"?n=xl.applyCanBeUsed.uint8array:t==="nodebuffer"&&(n=xl.applyCanBeUsed.nodebuffer),n)for(;r>1;)try{return xl.stringifyByChunk(e,t,r)}catch{r=Math.floor(r/2)}return xl.stringifyByChar(e)}ce.applyFromCharCode=jo;function Tl(e,r){for(var t=0;t<e.length;t++)r[t]=e[t];return r}var Cr={};Cr.string={string:qo,array:function(e){return _l(e,new Array(e.length))},arraybuffer:function(e){return Cr.string.uint8array(e).buffer},uint8array:function(e){return _l(e,new Uint8Array(e.length))},nodebuffer:function(e){return _l(e,si.allocBuffer(e.length))}};Cr.array={string:jo,array:qo,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return si.newBufferFrom(e)}};Cr.arraybuffer={string:function(e){return jo(new Uint8Array(e))},array:function(e){return Tl(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:qo,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return si.newBufferFrom(new Uint8Array(e))}};Cr.uint8array={string:jo,array:function(e){return Tl(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:qo,nodebuffer:function(e){return si.newBufferFrom(e)}};Cr.nodebuffer={string:jo,array:function(e){return Tl(e,new Array(e.length))},arraybuffer:function(e){return Cr.nodebuffer.uint8array(e).buffer},uint8array:function(e){return Tl(e,new Uint8Array(e.length))},nodebuffer:qo};ce.transformTo=function(e,r){if(r||(r=""),!e)return r;ce.checkSupport(e);var t=ce.getTypeOf(r),n=Cr[t][e](r);return n};ce.resolve=function(e){for(var r=e.split("/"),t=[],n=0;n<r.length;n++){var i=r[n];i==="."||i===""&&n!==0&&n!==r.length-1||(i===".."?t.pop():t.push(i))}return t.join("/")};ce.getTypeOf=function(e){if(typeof e=="string")return"string";if(Object.prototype.toString.call(e)==="[object Array]")return"array";if(Er.nodebuffer&&si.isBuffer(e))return"nodebuffer";if(Er.uint8array&&e instanceof Uint8Array)return"uint8array";if(Er.arraybuffer&&e instanceof ArrayBuffer)return"arraybuffer"};ce.checkSupport=function(e){var r=Er[e.toLowerCase()];if(!r)throw new Error(e+" is not supported by this platform")};ce.MAX_VALUE_16BITS=65535;ce.MAX_VALUE_32BITS=-1;ce.pretty=function(e){var r="",t,n;for(n=0;n<(e||"").length;n++)t=e.charCodeAt(n),r+="\\x"+(t<16?"0":"")+t.toString(16).toUpperCase();return r};ce.delay=function(e,r,t){setImmediate(function(){e.apply(t||null,r||[])})};ce.inherits=function(e,r){var t=function(){};t.prototype=r.prototype,e.prototype=new t};ce.extend=function(){var e={},r,t;for(r=0;r<arguments.length;r++)for(t in arguments[r])Object.prototype.hasOwnProperty.call(arguments[r],t)&&typeof e[t]>"u"&&(e[t]=arguments[r][t]);return e};ce.prepareContent=function(e,r,t,n,i){var o=qd.Promise.resolve(r).then(function(s){var a=Er.blob&&(s instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(s))!==-1);return a&&typeof FileReader<"u"?new qd.Promise(function(l,u){var c=new FileReader;c.onload=function(f){l(f.target.result)},c.onerror=function(f){u(f.target.error)},c.readAsArrayBuffer(s)}):s});return o.then(function(s){var a=ce.getTypeOf(s);return a?(a==="arraybuffer"?s=ce.transformTo("uint8array",s):a==="string"&&(i?s=mB.decode(s):t&&n!==!0&&(s=gB(s))),s):qd.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}});var Je=S((c4,uS)=>{"use strict";function lS(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}lS.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return this.isFinished?!1:(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,r){return this._listeners[e].push(r),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,r){if(this._listeners[e])for(var t=0;t<this._listeners[e].length;t++)this._listeners[e][t].call(this,r)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var r=this;return e.on("data",function(t){r.processChunk(t)}),e.on("end",function(){r.end()}),e.on("error",function(t){r.error(t)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,r){return this.extraStreamInfo[e]=r,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}};uS.exports=lS});var li=S(Or=>{"use strict";var ai=te(),on=er(),vB=Io(),El=Je(),Ho=new Array(256);for(tr=0;tr<256;tr++)Ho[tr]=tr>=252?6:tr>=248?5:tr>=240?4:tr>=224?3:tr>=192?2:1;var tr;Ho[254]=Ho[254]=1;var yB=function(e){var r,t,n,i,o,s=e.length,a=0;for(i=0;i<s;i++)t=e.charCodeAt(i),(t&64512)===55296&&i+1<s&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),i++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(on.uint8array?r=new Uint8Array(a):r=new Array(a),o=0,i=0;o<a;i++)t=e.charCodeAt(i),(t&64512)===55296&&i+1<s&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),i++)),t<128?r[o++]=t:t<2048?(r[o++]=192|t>>>6,r[o++]=128|t&63):t<65536?(r[o++]=224|t>>>12,r[o++]=128|t>>>6&63,r[o++]=128|t&63):(r[o++]=240|t>>>18,r[o++]=128|t>>>12&63,r[o++]=128|t>>>6&63,r[o++]=128|t&63);return r},bB=function(e,r){var t;for(r=r||e.length,r>e.length&&(r=e.length),t=r-1;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?r:t+Ho[e[t]]>r?t:r},kB=function(e){var r,t,n,i,o=e.length,s=new Array(o*2);for(t=0,r=0;r<o;){if(n=e[r++],n<128){s[t++]=n;continue}if(i=Ho[n],i>4){s[t++]=65533,r+=i-1;continue}for(n&=i===2?31:i===3?15:7;i>1&&r<o;)n=n<<6|e[r++]&63,i--;if(i>1){s[t++]=65533;continue}n<65536?s[t++]=n:(n-=65536,s[t++]=55296|n>>10&1023,s[t++]=56320|n&1023)}return s.length!==t&&(s.subarray?s=s.subarray(0,t):s.length=t),ai.applyFromCharCode(s)};Or.utf8encode=function(r){return on.nodebuffer?vB.newBufferFrom(r,"utf-8"):yB(r)};Or.utf8decode=function(r){return on.nodebuffer?ai.transformTo("nodebuffer",r).toString("utf-8"):(r=ai.transformTo(on.uint8array?"uint8array":"array",r),kB(r))};function Cl(){El.call(this,"utf-8 decode"),this.leftOver=null}ai.inherits(Cl,El);Cl.prototype.processChunk=function(e){var r=ai.transformTo(on.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(on.uint8array){var t=r;r=new Uint8Array(t.length+this.leftOver.length),r.set(this.leftOver,0),r.set(t,this.leftOver.length)}else r=this.leftOver.concat(r);this.leftOver=null}var n=bB(r),i=r;n!==r.length&&(on.uint8array?(i=r.subarray(0,n),this.leftOver=r.subarray(n,r.length)):(i=r.slice(0,n),this.leftOver=r.slice(n,r.length))),this.push({data:Or.utf8decode(i),meta:e.meta})};Cl.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:Or.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)};Or.Utf8DecodeWorker=Cl;function jd(){El.call(this,"utf-8 encode")}ai.inherits(jd,El);jd.prototype.processChunk=function(e){this.push({data:Or.utf8encode(e.data),meta:e.meta})};Or.Utf8EncodeWorker=jd});var hS=S((d4,dS)=>{"use strict";var cS=Je(),fS=te();function Hd(e){cS.call(this,"ConvertWorker to "+e),this.destType=e}fS.inherits(Hd,cS);Hd.prototype.processChunk=function(e){this.push({data:fS.transformTo(this.destType,e.data),meta:e.meta})};dS.exports=Hd});var gS=S((h4,mS)=>{"use strict";var pS=Od().Readable,wB=te();wB.inherits($d,pS);function $d(e,r,t){pS.call(this,r),this._helper=e;var n=this;e.on("data",function(i,o){n.push(i)||n._helper.pause(),t&&t(o)}).on("error",function(i){n.emit("error",i)}).on("end",function(){n.push(null)})}$d.prototype._read=function(){this._helper.resume()};mS.exports=$d});var Wd=S((p4,bS)=>{"use strict";var sn=te(),SB=hS(),xB=Je(),_B=Pd(),TB=er(),EB=oi(),vS=null;if(TB.nodestream)try{vS=gS()}catch{}function CB(e,r,t){switch(e){case"blob":return sn.newBlob(sn.transformTo("arraybuffer",r),t);case"base64":return _B.encode(r);default:return sn.transformTo(e,r)}}function OB(e,r){var t,n=0,i=null,o=0;for(t=0;t<r.length;t++)o+=r[t].length;switch(e){case"string":return r.join("");case"array":return Array.prototype.concat.apply([],r);case"uint8array":for(i=new Uint8Array(o),t=0;t<r.length;t++)i.set(r[t],n),n+=r[t].length;return i;case"nodebuffer":return Buffer.concat(r);default:throw new Error("concat : unsupported type '"+e+"'")}}function MB(e,r){return new EB.Promise(function(t,n){var i=[],o=e._internalType,s=e._outputType,a=e._mimeType;e.on("data",function(l,u){i.push(l),r&&r(u)}).on("error",function(l){i=[],n(l)}).on("end",function(){try{var l=CB(s,OB(o,i),a);t(l)}catch(u){n(u)}i=[]}).resume()})}function yS(e,r,t){var n=r;switch(r){case"blob":case"arraybuffer":n="uint8array";break;case"base64":n="string";break}try{this._internalType=n,this._outputType=r,this._mimeType=t,sn.checkSupport(n),this._worker=e.pipe(new SB(n)),e.lock()}catch(i){this._worker=new xB("error"),this._worker.error(i)}}yS.prototype={accumulate:function(e){return MB(this,e)},on:function(e,r){var t=this;return e==="data"?this._worker.on(e,function(n){r.call(t,n.data,n.meta)}):this._worker.on(e,function(){sn.delay(r,arguments,t)}),this},resume:function(){return sn.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(sn.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new vS(this,{objectMode:this._outputType!=="nodebuffer"},e)}};bS.exports=yS});var Vd=S(ht=>{"use strict";ht.base64=!1;ht.binary=!1;ht.dir=!1;ht.createFolders=!0;ht.date=null;ht.compression=null;ht.compressionOptions=null;ht.comment=null;ht.unixPermissions=null;ht.dosPermissions=null});var Ud=S((g4,kS)=>{"use strict";var Ol=te(),Ml=Je(),AB=16*1024;function ui(e){Ml.call(this,"DataWorker");var r=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(t){r.dataIsReady=!0,r.data=t,r.max=t&&t.length||0,r.type=Ol.getTypeOf(t),r.isPaused||r._tickAndRepeat()},function(t){r.error(t)})}Ol.inherits(ui,Ml);ui.prototype.cleanUp=function(){Ml.prototype.cleanUp.call(this),this.data=null};ui.prototype.resume=function(){return Ml.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,Ol.delay(this._tickAndRepeat,[],this)),!0):!1};ui.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(Ol.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))};ui.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=AB,r=null,t=Math.min(this.max,this.index+e);if(this.index>=this.max)return this.end();switch(this.type){case"string":r=this.data.substring(this.index,t);break;case"uint8array":r=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":r=this.data.slice(this.index,t);break}return this.index=t,this.push({data:r,meta:{percent:this.max?this.index/this.max*100:0}})};kS.exports=ui});var Al=S((v4,SS)=>{"use strict";var NB=te();function PB(){for(var e,r=[],t=0;t<256;t++){e=t;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;r[t]=e}return r}var wS=PB();function RB(e,r,t,n){var i=wS,o=n+t;e=e^-1;for(var s=n;s<o;s++)e=e>>>8^i[(e^r[s])&255];return e^-1}function DB(e,r,t,n){var i=wS,o=n+t;e=e^-1;for(var s=n;s<o;s++)e=e>>>8^i[(e^r.charCodeAt(s))&255];return e^-1}SS.exports=function(r,t){if(typeof r>"u"||!r.length)return 0;var n=NB.getTypeOf(r)!=="string";return n?RB(t|0,r,r.length,0):DB(t|0,r,r.length,0)}});var Jd=S((y4,_S)=>{"use strict";var xS=Je(),IB=Al(),LB=te();function Kd(){xS.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}LB.inherits(Kd,xS);Kd.prototype.processChunk=function(e){this.streamInfo.crc32=IB(e.data,this.streamInfo.crc32||0),this.push(e)};_S.exports=Kd});var ES=S((b4,TS)=>{"use strict";var FB=te(),Zd=Je();function Gd(e){Zd.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}FB.inherits(Gd,Zd);Gd.prototype.processChunk=function(e){if(e){var r=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=r+e.data.length}Zd.prototype.processChunk.call(this,e)};TS.exports=Gd});var Nl=S((k4,MS)=>{"use strict";var CS=oi(),OS=Ud(),BB=Jd(),Xd=ES();function Yd(e,r,t,n,i){this.compressedSize=e,this.uncompressedSize=r,this.crc32=t,this.compression=n,this.compressedContent=i}Yd.prototype={getContentWorker:function(){var e=new OS(CS.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new Xd("data_length")),r=this;return e.on("end",function(){if(this.streamInfo.data_length!==r.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new OS(CS.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}};Yd.createWorkerFrom=function(e,r,t){return e.pipe(new BB).pipe(new Xd("uncompressedSize")).pipe(r.compressWorker(t)).pipe(new Xd("compressedSize")).withStreamInfo("compression",r)};MS.exports=Yd});var RS=S((w4,PS)=>{"use strict";var zB=Wd(),qB=Ud(),Qd=li(),eh=Nl(),AS=Je(),th=function(e,r,t){this.name=e,this.dir=t.dir,this.date=t.date,this.comment=t.comment,this.unixPermissions=t.unixPermissions,this.dosPermissions=t.dosPermissions,this._data=r,this._dataBinary=t.binary,this.options={compression:t.compression,compressionOptions:t.compressionOptions}};th.prototype={internalStream:function(e){var r=null,t="string";try{if(!e)throw new Error("No output type specified.");t=e.toLowerCase();var n=t==="string"||t==="text";(t==="binarystring"||t==="text")&&(t="string"),r=this._decompressWorker();var i=!this._dataBinary;i&&!n&&(r=r.pipe(new Qd.Utf8EncodeWorker)),!i&&n&&(r=r.pipe(new Qd.Utf8DecodeWorker))}catch(o){r=new AS("error"),r.error(o)}return new zB(r,t,"")},async:function(e,r){return this.internalStream(e).accumulate(r)},nodeStream:function(e,r){return this.internalStream(e||"nodebuffer").toNodejsStream(r)},_compressWorker:function(e,r){if(this._data instanceof eh&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var t=this._decompressWorker();return this._dataBinary||(t=t.pipe(new Qd.Utf8EncodeWorker)),eh.createWorkerFrom(t,e,r)},_decompressWorker:function(){return this._data instanceof eh?this._data.getContentWorker():this._data instanceof AS?this._data:new qB(this._data)}};var NS=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],jB=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")};for(Pl=0;Pl<NS.length;Pl++)th.prototype[NS[Pl]]=jB;var Pl;PS.exports=th});var rr=S(qe=>{"use strict";var HB=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function $B(e,r){return Object.prototype.hasOwnProperty.call(e,r)}qe.assign=function(e){for(var r=Array.prototype.slice.call(arguments,1);r.length;){var t=r.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(var n in t)$B(t,n)&&(e[n]=t[n])}}return e};qe.shrinkBuf=function(e,r){return e.length===r?e:e.subarray?e.subarray(0,r):(e.length=r,e)};var WB={arraySet:function(e,r,t,n,i){if(r.subarray&&e.subarray){e.set(r.subarray(t,t+n),i);return}for(var o=0;o<n;o++)e[i+o]=r[t+o]},flattenChunks:function(e){var r,t,n,i,o,s;for(n=0,r=0,t=e.length;r<t;r++)n+=e[r].length;for(s=new Uint8Array(n),i=0,r=0,t=e.length;r<t;r++)o=e[r],s.set(o,i),i+=o.length;return s}},VB={arraySet:function(e,r,t,n,i){for(var o=0;o<n;o++)e[i+o]=r[t+o]},flattenChunks:function(e){return[].concat.apply([],e)}};qe.setTyped=function(e){e?(qe.Buf8=Uint8Array,qe.Buf16=Uint16Array,qe.Buf32=Int32Array,qe.assign(qe,WB)):(qe.Buf8=Array,qe.Buf16=Array,qe.Buf32=Array,qe.assign(qe,VB))};qe.setTyped(HB)});var rx=S(di=>{"use strict";var UB=rr(),KB=4,DS=0,IS=1,JB=2;function fi(e){for(var r=e.length;--r>=0;)e[r]=0}var ZB=0,jS=1,GB=2,XB=3,YB=258,lh=29,Jo=256,Wo=Jo+1+lh,ci=30,uh=19,HS=2*Wo+1,an=15,rh=16,QB=7,ch=256,$S=16,WS=17,VS=18,sh=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Rl=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ez=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],US=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],tz=512,nr=new Array((Wo+2)*2);fi(nr);var $o=new Array(ci*2);fi($o);var Vo=new Array(tz);fi(Vo);var Uo=new Array(YB-XB+1);fi(Uo);var fh=new Array(lh);fi(fh);var Dl=new Array(ci);fi(Dl);function nh(e,r,t,n,i){this.static_tree=e,this.extra_bits=r,this.extra_base=t,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}var KS,JS,ZS;function ih(e,r){this.dyn_tree=e,this.max_code=0,this.stat_desc=r}function GS(e){return e<256?Vo[e]:Vo[256+(e>>>7)]}function Ko(e,r){e.pending_buf[e.pending++]=r&255,e.pending_buf[e.pending++]=r>>>8&255}function We(e,r,t){e.bi_valid>rh-t?(e.bi_buf|=r<<e.bi_valid&65535,Ko(e,e.bi_buf),e.bi_buf=r>>rh-e.bi_valid,e.bi_valid+=t-rh):(e.bi_buf|=r<<e.bi_valid&65535,e.bi_valid+=t)}function Dt(e,r,t){We(e,t[r*2],t[r*2+1])}function XS(e,r){var t=0;do t|=e&1,e>>>=1,t<<=1;while(--r>0);return t>>>1}function rz(e){e.bi_valid===16?(Ko(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function nz(e,r){var t=r.dyn_tree,n=r.max_code,i=r.stat_desc.static_tree,o=r.stat_desc.has_stree,s=r.stat_desc.extra_bits,a=r.stat_desc.extra_base,l=r.stat_desc.max_length,u,c,f,d,h,p,m=0;for(d=0;d<=an;d++)e.bl_count[d]=0;for(t[e.heap[e.heap_max]*2+1]=0,u=e.heap_max+1;u<HS;u++)c=e.heap[u],d=t[t[c*2+1]*2+1]+1,d>l&&(d=l,m++),t[c*2+1]=d,!(c>n)&&(e.bl_count[d]++,h=0,c>=a&&(h=s[c-a]),p=t[c*2],e.opt_len+=p*(d+h),o&&(e.static_len+=p*(i[c*2+1]+h)));if(m!==0){do{for(d=l-1;e.bl_count[d]===0;)d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[l]--,m-=2}while(m>0);for(d=l;d!==0;d--)for(c=e.bl_count[d];c!==0;)f=e.heap[--u],!(f>n)&&(t[f*2+1]!==d&&(e.opt_len+=(d-t[f*2+1])*t[f*2],t[f*2+1]=d),c--)}}function YS(e,r,t){var n=new Array(an+1),i=0,o,s;for(o=1;o<=an;o++)n[o]=i=i+t[o-1]<<1;for(s=0;s<=r;s++){var a=e[s*2+1];a!==0&&(e[s*2]=XS(n[a]++,a))}}function iz(){var e,r,t,n,i,o=new Array(an+1);for(t=0,n=0;n<lh-1;n++)for(fh[n]=t,e=0;e<1<<sh[n];e++)Uo[t++]=n;for(Uo[t-1]=n,i=0,n=0;n<16;n++)for(Dl[n]=i,e=0;e<1<<Rl[n];e++)Vo[i++]=n;for(i>>=7;n<ci;n++)for(Dl[n]=i<<7,e=0;e<1<<Rl[n]-7;e++)Vo[256+i++]=n;for(r=0;r<=an;r++)o[r]=0;for(e=0;e<=143;)nr[e*2+1]=8,e++,o[8]++;for(;e<=255;)nr[e*2+1]=9,e++,o[9]++;for(;e<=279;)nr[e*2+1]=7,e++,o[7]++;for(;e<=287;)nr[e*2+1]=8,e++,o[8]++;for(YS(nr,Wo+1,o),e=0;e<ci;e++)$o[e*2+1]=5,$o[e*2]=XS(e,5);KS=new nh(nr,sh,Jo+1,Wo,an),JS=new nh($o,Rl,0,ci,an),ZS=new nh(new Array(0),ez,0,uh,QB)}function QS(e){var r;for(r=0;r<Wo;r++)e.dyn_ltree[r*2]=0;for(r=0;r<ci;r++)e.dyn_dtree[r*2]=0;for(r=0;r<uh;r++)e.bl_tree[r*2]=0;e.dyn_ltree[ch*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function ex(e){e.bi_valid>8?Ko(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function oz(e,r,t,n){ex(e),n&&(Ko(e,t),Ko(e,~t)),UB.arraySet(e.pending_buf,e.window,r,t,e.pending),e.pending+=t}function LS(e,r,t,n){var i=r*2,o=t*2;return e[i]<e[o]||e[i]===e[o]&&n[r]<=n[t]}function oh(e,r,t){for(var n=e.heap[t],i=t<<1;i<=e.heap_len&&(i<e.heap_len&&LS(r,e.heap[i+1],e.heap[i],e.depth)&&i++,!LS(r,n,e.heap[i],e.depth));)e.heap[t]=e.heap[i],t=i,i<<=1;e.heap[t]=n}function FS(e,r,t){var n,i,o=0,s,a;if(e.last_lit!==0)do n=e.pending_buf[e.d_buf+o*2]<<8|e.pending_buf[e.d_buf+o*2+1],i=e.pending_buf[e.l_buf+o],o++,n===0?Dt(e,i,r):(s=Uo[i],Dt(e,s+Jo+1,r),a=sh[s],a!==0&&(i-=fh[s],We(e,i,a)),n--,s=GS(n),Dt(e,s,t),a=Rl[s],a!==0&&(n-=Dl[s],We(e,n,a)));while(o<e.last_lit);Dt(e,ch,r)}function ah(e,r){var t=r.dyn_tree,n=r.stat_desc.static_tree,i=r.stat_desc.has_stree,o=r.stat_desc.elems,s,a,l=-1,u;for(e.heap_len=0,e.heap_max=HS,s=0;s<o;s++)t[s*2]!==0?(e.heap[++e.heap_len]=l=s,e.depth[s]=0):t[s*2+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=l<2?++l:0,t[u*2]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=n[u*2+1]);for(r.max_code=l,s=e.heap_len>>1;s>=1;s--)oh(e,t,s);u=o;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],oh(e,t,1),a=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=a,t[u*2]=t[s*2]+t[a*2],e.depth[u]=(e.depth[s]>=e.depth[a]?e.depth[s]:e.depth[a])+1,t[s*2+1]=t[a*2+1]=u,e.heap[1]=u++,oh(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],nz(e,r),YS(t,l,e.bl_count)}function BS(e,r,t){var n,i=-1,o,s=r[1],a=0,l=7,u=4;for(s===0&&(l=138,u=3),r[(t+1)*2+1]=65535,n=0;n<=t;n++)o=s,s=r[(n+1)*2+1],!(++a<l&&o===s)&&(a<u?e.bl_tree[o*2]+=a:o!==0?(o!==i&&e.bl_tree[o*2]++,e.bl_tree[$S*2]++):a<=10?e.bl_tree[WS*2]++:e.bl_tree[VS*2]++,a=0,i=o,s===0?(l=138,u=3):o===s?(l=6,u=3):(l=7,u=4))}function zS(e,r,t){var n,i=-1,o,s=r[1],a=0,l=7,u=4;for(s===0&&(l=138,u=3),n=0;n<=t;n++)if(o=s,s=r[(n+1)*2+1],!(++a<l&&o===s)){if(a<u)do Dt(e,o,e.bl_tree);while(--a!==0);else o!==0?(o!==i&&(Dt(e,o,e.bl_tree),a--),Dt(e,$S,e.bl_tree),We(e,a-3,2)):a<=10?(Dt(e,WS,e.bl_tree),We(e,a-3,3)):(Dt(e,VS,e.bl_tree),We(e,a-11,7));a=0,i=o,s===0?(l=138,u=3):o===s?(l=6,u=3):(l=7,u=4)}}function sz(e){var r;for(BS(e,e.dyn_ltree,e.l_desc.max_code),BS(e,e.dyn_dtree,e.d_desc.max_code),ah(e,e.bl_desc),r=uh-1;r>=3&&e.bl_tree[US[r]*2+1]===0;r--);return e.opt_len+=3*(r+1)+5+5+4,r}function az(e,r,t,n){var i;for(We(e,r-257,5),We(e,t-1,5),We(e,n-4,4),i=0;i<n;i++)We(e,e.bl_tree[US[i]*2+1],3);zS(e,e.dyn_ltree,r-1),zS(e,e.dyn_dtree,t-1)}function lz(e){var r=4093624447,t;for(t=0;t<=31;t++,r>>>=1)if(r&1&&e.dyn_ltree[t*2]!==0)return DS;if(e.dyn_ltree[18]!==0||e.dyn_ltree[20]!==0||e.dyn_ltree[26]!==0)return IS;for(t=32;t<Jo;t++)if(e.dyn_ltree[t*2]!==0)return IS;return DS}var qS=!1;function uz(e){qS||(iz(),qS=!0),e.l_desc=new ih(e.dyn_ltree,KS),e.d_desc=new ih(e.dyn_dtree,JS),e.bl_desc=new ih(e.bl_tree,ZS),e.bi_buf=0,e.bi_valid=0,QS(e)}function tx(e,r,t,n){We(e,(ZB<<1)+(n?1:0),3),oz(e,r,t,!0)}function cz(e){We(e,jS<<1,3),Dt(e,ch,nr),rz(e)}function fz(e,r,t,n){var i,o,s=0;e.level>0?(e.strm.data_type===JB&&(e.strm.data_type=lz(e)),ah(e,e.l_desc),ah(e,e.d_desc),s=sz(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=t+5,t+4<=i&&r!==-1?tx(e,r,t,n):e.strategy===KB||o===i?(We(e,(jS<<1)+(n?1:0),3),FS(e,nr,$o)):(We(e,(GB<<1)+(n?1:0),3),az(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),FS(e,e.dyn_ltree,e.dyn_dtree)),QS(e),n&&ex(e)}function dz(e,r,t){return e.pending_buf[e.d_buf+e.last_lit*2]=r>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=r&255,e.pending_buf[e.l_buf+e.last_lit]=t&255,e.last_lit++,r===0?e.dyn_ltree[t*2]++:(e.matches++,r--,e.dyn_ltree[(Uo[t]+Jo+1)*2]++,e.dyn_dtree[GS(r)*2]++),e.last_lit===e.lit_bufsize-1}di._tr_init=uz;di._tr_stored_block=tx;di._tr_flush_block=fz;di._tr_tally=dz;di._tr_align=cz});var dh=S((_4,nx)=>{"use strict";function hz(e,r,t,n){for(var i=e&65535|0,o=e>>>16&65535|0,s=0;t!==0;){s=t>2e3?2e3:t,t-=s;do i=i+r[n++]|0,o=o+i|0;while(--s);i%=65521,o%=65521}return i|o<<16|0}nx.exports=hz});var hh=S((T4,ix)=>{"use strict";function pz(){for(var e,r=[],t=0;t<256;t++){e=t;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;r[t]=e}return r}var mz=pz();function gz(e,r,t,n){var i=mz,o=n+t;e^=-1;for(var s=n;s<o;s++)e=e>>>8^i[(e^r[s])&255];return e^-1}ix.exports=gz});var Il=S((E4,ox)=>{"use strict";ox.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var px=S(Ft=>{"use strict";var je=rr(),rt=rx(),ux=dh(),Mr=hh(),vz=Il(),fn=0,yz=1,bz=3,Dr=4,sx=5,Lt=0,ax=1,nt=-2,kz=-3,ph=-5,wz=-1,Sz=1,Ll=2,xz=3,_z=4,Tz=0,Ez=2,ql=8,Cz=9,Oz=15,Mz=8,Az=29,Nz=256,gh=Nz+1+Az,Pz=30,Rz=19,Dz=2*gh+1,Iz=15,F=3,Pr=258,pt=Pr+F+1,Lz=32,jl=42,vh=69,Fl=73,Bl=91,zl=103,ln=113,Go=666,me=1,Xo=2,un=3,mi=4,Fz=3;function Rr(e,r){return e.msg=vz[r],r}function lx(e){return(e<<1)-(e>4?9:0)}function Nr(e){for(var r=e.length;--r>=0;)e[r]=0}function Ar(e){var r=e.state,t=r.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(je.arraySet(e.output,r.pending_buf,r.pending_out,t,e.next_out),e.next_out+=t,r.pending_out+=t,e.total_out+=t,e.avail_out-=t,r.pending-=t,r.pending===0&&(r.pending_out=0))}function xe(e,r){rt._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,r),e.block_start=e.strstart,Ar(e.strm)}function q(e,r){e.pending_buf[e.pending++]=r}function Zo(e,r){e.pending_buf[e.pending++]=r>>>8&255,e.pending_buf[e.pending++]=r&255}function Bz(e,r,t,n){var i=e.avail_in;return i>n&&(i=n),i===0?0:(e.avail_in-=i,je.arraySet(r,e.input,e.next_in,i,t),e.state.wrap===1?e.adler=ux(e.adler,r,i,t):e.state.wrap===2&&(e.adler=Mr(e.adler,r,i,t)),e.next_in+=i,e.total_in+=i,i)}function cx(e,r){var t=e.max_chain_length,n=e.strstart,i,o,s=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-pt?e.strstart-(e.w_size-pt):0,u=e.window,c=e.w_mask,f=e.prev,d=e.strstart+Pr,h=u[n+s-1],p=u[n+s];e.prev_length>=e.good_match&&(t>>=2),a>e.lookahead&&(a=e.lookahead);do if(i=r,!(u[i+s]!==p||u[i+s-1]!==h||u[i]!==u[n]||u[++i]!==u[n+1])){n+=2,i++;do;while(u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&n<d);if(o=Pr-(d-n),n=d-Pr,o>s){if(e.match_start=r,s=o,o>=a)break;h=u[n+s-1],p=u[n+s]}}while((r=f[r&c])>l&&--t!==0);return s<=e.lookahead?s:e.lookahead}function cn(e){var r=e.w_size,t,n,i,o,s;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=r+(r-pt)){je.arraySet(e.window,e.window,r,r,0),e.match_start-=r,e.strstart-=r,e.block_start-=r,n=e.hash_size,t=n;do i=e.head[--t],e.head[t]=i>=r?i-r:0;while(--n);n=r,t=n;do i=e.prev[--t],e.prev[t]=i>=r?i-r:0;while(--n);o+=r}if(e.strm.avail_in===0)break;if(n=Bz(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=n,e.lookahead+e.insert>=F)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+F-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<F)););}while(e.lookahead<pt&&e.strm.avail_in!==0)}function zz(e,r){var t=65535;for(t>e.pending_buf_size-5&&(t=e.pending_buf_size-5);;){if(e.lookahead<=1){if(cn(e),e.lookahead===0&&r===fn)return me;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+t;if((e.strstart===0||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,xe(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-pt&&(xe(e,!1),e.strm.avail_out===0))return me}return e.insert=0,r===Dr?(xe(e,!0),e.strm.avail_out===0?un:mi):(e.strstart>e.block_start&&(xe(e,!1),e.strm.avail_out===0),me)}function mh(e,r){for(var t,n;;){if(e.lookahead<pt){if(cn(e),e.lookahead<pt&&r===fn)return me;if(e.lookahead===0)break}if(t=0,e.lookahead>=F&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+F-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-pt&&(e.match_length=cx(e,t)),e.match_length>=F)if(n=rt._tr_tally(e,e.strstart-e.match_start,e.match_length-F),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=F){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+F-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=rt._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(xe(e,!1),e.strm.avail_out===0))return me}return e.insert=e.strstart<F-1?e.strstart:F-1,r===Dr?(xe(e,!0),e.strm.avail_out===0?un:mi):e.last_lit&&(xe(e,!1),e.strm.avail_out===0)?me:Xo}function hi(e,r){for(var t,n,i;;){if(e.lookahead<pt){if(cn(e),e.lookahead<pt&&r===fn)return me;if(e.lookahead===0)break}if(t=0,e.lookahead>=F&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+F-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=F-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-pt&&(e.match_length=cx(e,t),e.match_length<=5&&(e.strategy===Sz||e.match_length===F&&e.strstart-e.match_start>4096)&&(e.match_length=F-1)),e.prev_length>=F&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-F,n=rt._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-F),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+F-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=F-1,e.strstart++,n&&(xe(e,!1),e.strm.avail_out===0))return me}else if(e.match_available){if(n=rt._tr_tally(e,0,e.window[e.strstart-1]),n&&xe(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return me}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=rt._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<F-1?e.strstart:F-1,r===Dr?(xe(e,!0),e.strm.avail_out===0?un:mi):e.last_lit&&(xe(e,!1),e.strm.avail_out===0)?me:Xo}function qz(e,r){for(var t,n,i,o,s=e.window;;){if(e.lookahead<=Pr){if(cn(e),e.lookahead<=Pr&&r===fn)return me;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=F&&e.strstart>0&&(i=e.strstart-1,n=s[i],n===s[++i]&&n===s[++i]&&n===s[++i])){o=e.strstart+Pr;do;while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<o);e.match_length=Pr-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=F?(t=rt._tr_tally(e,1,e.match_length-F),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=rt._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(xe(e,!1),e.strm.avail_out===0))return me}return e.insert=0,r===Dr?(xe(e,!0),e.strm.avail_out===0?un:mi):e.last_lit&&(xe(e,!1),e.strm.avail_out===0)?me:Xo}function jz(e,r){for(var t;;){if(e.lookahead===0&&(cn(e),e.lookahead===0)){if(r===fn)return me;break}if(e.match_length=0,t=rt._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(xe(e,!1),e.strm.avail_out===0))return me}return e.insert=0,r===Dr?(xe(e,!0),e.strm.avail_out===0?un:mi):e.last_lit&&(xe(e,!1),e.strm.avail_out===0)?me:Xo}function It(e,r,t,n,i){this.good_length=e,this.max_lazy=r,this.nice_length=t,this.max_chain=n,this.func=i}var pi;pi=[new It(0,0,0,0,zz),new It(4,4,8,4,mh),new It(4,5,16,8,mh),new It(4,6,32,32,mh),new It(4,4,16,16,hi),new It(8,16,32,32,hi),new It(8,16,128,128,hi),new It(8,32,128,256,hi),new It(32,128,258,1024,hi),new It(32,258,258,4096,hi)];function Hz(e){e.window_size=2*e.w_size,Nr(e.head),e.max_lazy_match=pi[e.level].max_lazy,e.good_match=pi[e.level].good_length,e.nice_match=pi[e.level].nice_length,e.max_chain_length=pi[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=F-1,e.match_available=0,e.ins_h=0}function $z(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ql,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new je.Buf16(Dz*2),this.dyn_dtree=new je.Buf16((2*Pz+1)*2),this.bl_tree=new je.Buf16((2*Rz+1)*2),Nr(this.dyn_ltree),Nr(this.dyn_dtree),Nr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new je.Buf16(Iz+1),this.heap=new je.Buf16(2*gh+1),Nr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new je.Buf16(2*gh+1),Nr(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function fx(e){var r;return!e||!e.state?Rr(e,nt):(e.total_in=e.total_out=0,e.data_type=Ez,r=e.state,r.pending=0,r.pending_out=0,r.wrap<0&&(r.wrap=-r.wrap),r.status=r.wrap?jl:ln,e.adler=r.wrap===2?0:1,r.last_flush=fn,rt._tr_init(r),Lt)}function dx(e){var r=fx(e);return r===Lt&&Hz(e.state),r}function Wz(e,r){return!e||!e.state||e.state.wrap!==2?nt:(e.state.gzhead=r,Lt)}function hx(e,r,t,n,i,o){if(!e)return nt;var s=1;if(r===wz&&(r=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),i<1||i>Cz||t!==ql||n<8||n>15||r<0||r>9||o<0||o>_z)return Rr(e,nt);n===8&&(n=9);var a=new $z;return e.state=a,a.strm=e,a.wrap=s,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+F-1)/F),a.window=new je.Buf8(a.w_size*2),a.head=new je.Buf16(a.hash_size),a.prev=new je.Buf16(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new je.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=r,a.strategy=o,a.method=t,dx(e)}function Vz(e,r){return hx(e,r,ql,Oz,Mz,Tz)}function Uz(e,r){var t,n,i,o;if(!e||!e.state||r>sx||r<0)return e?Rr(e,nt):nt;if(n=e.state,!e.output||!e.input&&e.avail_in!==0||n.status===Go&&r!==Dr)return Rr(e,e.avail_out===0?ph:nt);if(n.strm=e,t=n.last_flush,n.last_flush=r,n.status===jl)if(n.wrap===2)e.adler=0,q(n,31),q(n,139),q(n,8),n.gzhead?(q(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),q(n,n.gzhead.time&255),q(n,n.gzhead.time>>8&255),q(n,n.gzhead.time>>16&255),q(n,n.gzhead.time>>24&255),q(n,n.level===9?2:n.strategy>=Ll||n.level<2?4:0),q(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(q(n,n.gzhead.extra.length&255),q(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Mr(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=vh):(q(n,0),q(n,0),q(n,0),q(n,0),q(n,0),q(n,n.level===9?2:n.strategy>=Ll||n.level<2?4:0),q(n,Fz),n.status=ln);else{var s=ql+(n.w_bits-8<<4)<<8,a=-1;n.strategy>=Ll||n.level<2?a=0:n.level<6?a=1:n.level===6?a=2:a=3,s|=a<<6,n.strstart!==0&&(s|=Lz),s+=31-s%31,n.status=ln,Zo(n,s),n.strstart!==0&&(Zo(n,e.adler>>>16),Zo(n,e.adler&65535)),e.adler=1}if(n.status===vh)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(n.gzhead.extra.length&65535)&&!(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=Mr(e.adler,n.pending_buf,n.pending-i,i)),Ar(e),i=n.pending,n.pending===n.pending_buf_size));)q(n,n.gzhead.extra[n.gzindex]&255),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=Mr(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=Fl)}else n.status=Fl;if(n.status===Fl)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=Mr(e.adler,n.pending_buf,n.pending-i,i)),Ar(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}n.gzindex<n.gzhead.name.length?o=n.gzhead.name.charCodeAt(n.gzindex++)&255:o=0,q(n,o)}while(o!==0);n.gzhead.hcrc&&n.pending>i&&(e.adler=Mr(e.adler,n.pending_buf,n.pending-i,i)),o===0&&(n.gzindex=0,n.status=Bl)}else n.status=Bl;if(n.status===Bl)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=Mr(e.adler,n.pending_buf,n.pending-i,i)),Ar(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}n.gzindex<n.gzhead.comment.length?o=n.gzhead.comment.charCodeAt(n.gzindex++)&255:o=0,q(n,o)}while(o!==0);n.gzhead.hcrc&&n.pending>i&&(e.adler=Mr(e.adler,n.pending_buf,n.pending-i,i)),o===0&&(n.status=zl)}else n.status=zl;if(n.status===zl&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&Ar(e),n.pending+2<=n.pending_buf_size&&(q(n,e.adler&255),q(n,e.adler>>8&255),e.adler=0,n.status=ln)):n.status=ln),n.pending!==0){if(Ar(e),e.avail_out===0)return n.last_flush=-1,Lt}else if(e.avail_in===0&&lx(r)<=lx(t)&&r!==Dr)return Rr(e,ph);if(n.status===Go&&e.avail_in!==0)return Rr(e,ph);if(e.avail_in!==0||n.lookahead!==0||r!==fn&&n.status!==Go){var l=n.strategy===Ll?jz(n,r):n.strategy===xz?qz(n,r):pi[n.level].func(n,r);if((l===un||l===mi)&&(n.status=Go),l===me||l===un)return e.avail_out===0&&(n.last_flush=-1),Lt;if(l===Xo&&(r===yz?rt._tr_align(n):r!==sx&&(rt._tr_stored_block(n,0,0,!1),r===bz&&(Nr(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),Ar(e),e.avail_out===0))return n.last_flush=-1,Lt}return r!==Dr?Lt:n.wrap<=0?ax:(n.wrap===2?(q(n,e.adler&255),q(n,e.adler>>8&255),q(n,e.adler>>16&255),q(n,e.adler>>24&255),q(n,e.total_in&255),q(n,e.total_in>>8&255),q(n,e.total_in>>16&255),q(n,e.total_in>>24&255)):(Zo(n,e.adler>>>16),Zo(n,e.adler&65535)),Ar(e),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?Lt:ax)}function Kz(e){var r;return!e||!e.state?nt:(r=e.state.status,r!==jl&&r!==vh&&r!==Fl&&r!==Bl&&r!==zl&&r!==ln&&r!==Go?Rr(e,nt):(e.state=null,r===ln?Rr(e,kz):Lt))}function Jz(e,r){var t=r.length,n,i,o,s,a,l,u,c;if(!e||!e.state||(n=e.state,s=n.wrap,s===2||s===1&&n.status!==jl||n.lookahead))return nt;for(s===1&&(e.adler=ux(e.adler,r,t,0)),n.wrap=0,t>=n.w_size&&(s===0&&(Nr(n.head),n.strstart=0,n.block_start=0,n.insert=0),c=new je.Buf8(n.w_size),je.arraySet(c,r,t-n.w_size,n.w_size,0),r=c,t=n.w_size),a=e.avail_in,l=e.next_in,u=e.input,e.avail_in=t,e.next_in=0,e.input=r,cn(n);n.lookahead>=F;){i=n.strstart,o=n.lookahead-(F-1);do n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+F-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++;while(--o);n.strstart=i,n.lookahead=F-1,cn(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=F-1,n.match_available=0,e.next_in=l,e.input=u,e.avail_in=a,n.wrap=s,Lt}Ft.deflateInit=Vz;Ft.deflateInit2=hx;Ft.deflateReset=dx;Ft.deflateResetKeep=fx;Ft.deflateSetHeader=Wz;Ft.deflate=Uz;Ft.deflateEnd=Kz;Ft.deflateSetDictionary=Jz;Ft.deflateInfo="pako deflate (from Nodeca project)"});var yh=S(gi=>{"use strict";var Hl=rr(),mx=!0,gx=!0;try{String.fromCharCode.apply(null,[0])}catch{mx=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{gx=!1}var Yo=new Hl.Buf8(256);for(ir=0;ir<256;ir++)Yo[ir]=ir>=252?6:ir>=248?5:ir>=240?4:ir>=224?3:ir>=192?2:1;var ir;Yo[254]=Yo[254]=1;gi.string2buf=function(e){var r,t,n,i,o,s=e.length,a=0;for(i=0;i<s;i++)t=e.charCodeAt(i),(t&64512)===55296&&i+1<s&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),i++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(r=new Hl.Buf8(a),o=0,i=0;o<a;i++)t=e.charCodeAt(i),(t&64512)===55296&&i+1<s&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),i++)),t<128?r[o++]=t:t<2048?(r[o++]=192|t>>>6,r[o++]=128|t&63):t<65536?(r[o++]=224|t>>>12,r[o++]=128|t>>>6&63,r[o++]=128|t&63):(r[o++]=240|t>>>18,r[o++]=128|t>>>12&63,r[o++]=128|t>>>6&63,r[o++]=128|t&63);return r};function vx(e,r){if(r<65534&&(e.subarray&&gx||!e.subarray&&mx))return String.fromCharCode.apply(null,Hl.shrinkBuf(e,r));for(var t="",n=0;n<r;n++)t+=String.fromCharCode(e[n]);return t}gi.buf2binstring=function(e){return vx(e,e.length)};gi.binstring2buf=function(e){for(var r=new Hl.Buf8(e.length),t=0,n=r.length;t<n;t++)r[t]=e.charCodeAt(t);return r};gi.buf2string=function(e,r){var t,n,i,o,s=r||e.length,a=new Array(s*2);for(n=0,t=0;t<s;){if(i=e[t++],i<128){a[n++]=i;continue}if(o=Yo[i],o>4){a[n++]=65533,t+=o-1;continue}for(i&=o===2?31:o===3?15:7;o>1&&t<s;)i=i<<6|e[t++]&63,o--;if(o>1){a[n++]=65533;continue}i<65536?a[n++]=i:(i-=65536,a[n++]=55296|i>>10&1023,a[n++]=56320|i&1023)}return vx(a,n)};gi.utf8border=function(e,r){var t;for(r=r||e.length,r>e.length&&(r=e.length),t=r-1;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?r:t+Yo[e[t]]>r?t:r}});var bh=S((M4,yx)=>{"use strict";function Zz(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}yx.exports=Zz});var Sx=S(ts=>{"use strict";var Qo=px(),es=rr(),wh=yh(),Sh=Il(),Gz=bh(),wx=Object.prototype.toString,Xz=0,kh=4,vi=0,bx=1,kx=2,Yz=-1,Qz=0,e3=8;function dn(e){if(!(this instanceof dn))return new dn(e);this.options=es.assign({level:Yz,method:e3,chunkSize:16384,windowBits:15,memLevel:8,strategy:Qz,to:""},e||{});var r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Gz,this.strm.avail_out=0;var t=Qo.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(t!==vi)throw new Error(Sh[t]);if(r.header&&Qo.deflateSetHeader(this.strm,r.header),r.dictionary){var n;if(typeof r.dictionary=="string"?n=wh.string2buf(r.dictionary):wx.call(r.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(r.dictionary):n=r.dictionary,t=Qo.deflateSetDictionary(this.strm,n),t!==vi)throw new Error(Sh[t]);this._dict_set=!0}}dn.prototype.push=function(e,r){var t=this.strm,n=this.options.chunkSize,i,o;if(this.ended)return!1;o=r===~~r?r:r===!0?kh:Xz,typeof e=="string"?t.input=wh.string2buf(e):wx.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new es.Buf8(n),t.next_out=0,t.avail_out=n),i=Qo.deflate(t,o),i!==bx&&i!==vi)return this.onEnd(i),this.ended=!0,!1;(t.avail_out===0||t.avail_in===0&&(o===kh||o===kx))&&(this.options.to==="string"?this.onData(wh.buf2binstring(es.shrinkBuf(t.output,t.next_out))):this.onData(es.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||t.avail_out===0)&&i!==bx);return o===kh?(i=Qo.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===vi):(o===kx&&(this.onEnd(vi),t.avail_out=0),!0)};dn.prototype.onData=function(e){this.chunks.push(e)};dn.prototype.onEnd=function(e){e===vi&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=es.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function xh(e,r){var t=new dn(r);if(t.push(e,!0),t.err)throw t.msg||Sh[t.err];return t.result}function t3(e,r){return r=r||{},r.raw=!0,xh(e,r)}function r3(e,r){return r=r||{},r.gzip=!0,xh(e,r)}ts.Deflate=dn;ts.deflate=xh;ts.deflateRaw=t3;ts.gzip=r3});var _x=S((N4,xx)=>{"use strict";var $l=30,n3=12;xx.exports=function(r,t){var n,i,o,s,a,l,u,c,f,d,h,p,m,v,g,y,w,b,k,x,T,_,C,A,O;n=r.state,i=r.next_in,A=r.input,o=i+(r.avail_in-5),s=r.next_out,O=r.output,a=s-(t-r.avail_out),l=s+(r.avail_out-257),u=n.dmax,c=n.wsize,f=n.whave,d=n.wnext,h=n.window,p=n.hold,m=n.bits,v=n.lencode,g=n.distcode,y=(1<<n.lenbits)-1,w=(1<<n.distbits)-1;e:do{m<15&&(p+=A[i++]<<m,m+=8,p+=A[i++]<<m,m+=8),b=v[p&y];t:for(;;){if(k=b>>>24,p>>>=k,m-=k,k=b>>>16&255,k===0)O[s++]=b&65535;else if(k&16){x=b&65535,k&=15,k&&(m<k&&(p+=A[i++]<<m,m+=8),x+=p&(1<<k)-1,p>>>=k,m-=k),m<15&&(p+=A[i++]<<m,m+=8,p+=A[i++]<<m,m+=8),b=g[p&w];r:for(;;){if(k=b>>>24,p>>>=k,m-=k,k=b>>>16&255,k&16){if(T=b&65535,k&=15,m<k&&(p+=A[i++]<<m,m+=8,m<k&&(p+=A[i++]<<m,m+=8)),T+=p&(1<<k)-1,T>u){r.msg="invalid distance too far back",n.mode=$l;break e}if(p>>>=k,m-=k,k=s-a,T>k){if(k=T-k,k>f&&n.sane){r.msg="invalid distance too far back",n.mode=$l;break e}if(_=0,C=h,d===0){if(_+=c-k,k<x){x-=k;do O[s++]=h[_++];while(--k);_=s-T,C=O}}else if(d<k){if(_+=c+d-k,k-=d,k<x){x-=k;do O[s++]=h[_++];while(--k);if(_=0,d<x){k=d,x-=k;do O[s++]=h[_++];while(--k);_=s-T,C=O}}}else if(_+=d-k,k<x){x-=k;do O[s++]=h[_++];while(--k);_=s-T,C=O}for(;x>2;)O[s++]=C[_++],O[s++]=C[_++],O[s++]=C[_++],x-=3;x&&(O[s++]=C[_++],x>1&&(O[s++]=C[_++]))}else{_=s-T;do O[s++]=O[_++],O[s++]=O[_++],O[s++]=O[_++],x-=3;while(x>2);x&&(O[s++]=O[_++],x>1&&(O[s++]=O[_++]))}}else if((k&64)===0){b=g[(b&65535)+(p&(1<<k)-1)];continue r}else{r.msg="invalid distance code",n.mode=$l;break e}break}}else if((k&64)===0){b=v[(b&65535)+(p&(1<<k)-1)];continue t}else if(k&32){n.mode=n3;break e}else{r.msg="invalid literal/length code",n.mode=$l;break e}break}}while(i<o&&s<l);x=m>>3,i-=x,m-=x<<3,p&=(1<<m)-1,r.next_in=i,r.next_out=s,r.avail_in=i<o?5+(o-i):5-(i-o),r.avail_out=s<l?257+(l-s):257-(s-l),n.hold=p,n.bits=m}});var Nx=S((P4,Ax)=>{"use strict";var Tx=rr(),yi=15,Ex=852,Cx=592,Ox=0,_h=1,Mx=2,i3=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o3=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s3=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a3=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Ax.exports=function(r,t,n,i,o,s,a,l){var u=l.bits,c=0,f=0,d=0,h=0,p=0,m=0,v=0,g=0,y=0,w=0,b,k,x,T,_,C=null,A=0,O,B=new Tx.Buf16(yi+1),U=new Tx.Buf16(yi+1),V=null,Z=0,Pe,z,ar;for(c=0;c<=yi;c++)B[c]=0;for(f=0;f<i;f++)B[t[n+f]]++;for(p=u,h=yi;h>=1&&B[h]===0;h--);if(p>h&&(p=h),h===0)return o[s++]=1<<24|64<<16|0,o[s++]=1<<24|64<<16|0,l.bits=1,0;for(d=1;d<h&&B[d]===0;d++);for(p<d&&(p=d),g=1,c=1;c<=yi;c++)if(g<<=1,g-=B[c],g<0)return-1;if(g>0&&(r===Ox||h!==1))return-1;for(U[1]=0,c=1;c<yi;c++)U[c+1]=U[c]+B[c];for(f=0;f<i;f++)t[n+f]!==0&&(a[U[t[n+f]]++]=f);if(r===Ox?(C=V=a,O=19):r===_h?(C=i3,A-=257,V=o3,Z-=257,O=256):(C=s3,V=a3,O=-1),w=0,f=0,c=d,_=s,m=p,v=0,x=-1,y=1<<p,T=y-1,r===_h&&y>Ex||r===Mx&&y>Cx)return 1;for(;;){Pe=c-v,a[f]<O?(z=0,ar=a[f]):a[f]>O?(z=V[Z+a[f]],ar=C[A+a[f]]):(z=96,ar=0),b=1<<c-v,k=1<<m,d=k;do k-=b,o[_+(w>>v)+k]=Pe<<24|z<<16|ar|0;while(k!==0);for(b=1<<c-1;w&b;)b>>=1;if(b!==0?(w&=b-1,w+=b):w=0,f++,--B[c]===0){if(c===h)break;c=t[n+a[f]]}if(c>p&&(w&T)!==x){for(v===0&&(v=p),_+=d,m=c-v,g=1<<m;m+v<h&&(g-=B[m+v],!(g<=0));)m++,g<<=1;if(y+=1<<m,r===_h&&y>Ex||r===Mx&&y>Cx)return 1;x=w&T,o[x]=p<<24|m<<16|_-s|0}}return w!==0&&(o[_+w]=c-v<<24|64<<16|0),l.bits=p,0}});var d1=S(mt=>{"use strict";var Ze=rr(),Ah=dh(),Bt=hh(),l3=_x(),rs=Nx(),u3=0,n1=1,i1=2,Px=4,c3=5,Wl=6,hn=0,f3=1,d3=2,it=-2,o1=-3,Nh=-4,h3=-5,Rx=8,s1=1,Dx=2,Ix=3,Lx=4,Fx=5,Bx=6,zx=7,qx=8,jx=9,Hx=10,Kl=11,or=12,Th=13,$x=14,Eh=15,Wx=16,Vx=17,Ux=18,Kx=19,Vl=20,Ul=21,Jx=22,Zx=23,Gx=24,Xx=25,Yx=26,Ch=27,Qx=28,e1=29,Q=30,Ph=31,p3=32,m3=852,g3=592,v3=15,y3=v3;function t1(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function b3(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Ze.Buf16(320),this.work=new Ze.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function a1(e){var r;return!e||!e.state?it:(r=e.state,e.total_in=e.total_out=r.total=0,e.msg="",r.wrap&&(e.adler=r.wrap&1),r.mode=s1,r.last=0,r.havedict=0,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Ze.Buf32(m3),r.distcode=r.distdyn=new Ze.Buf32(g3),r.sane=1,r.back=-1,hn)}function l1(e){var r;return!e||!e.state?it:(r=e.state,r.wsize=0,r.whave=0,r.wnext=0,a1(e))}function u1(e,r){var t,n;return!e||!e.state||(n=e.state,r<0?(t=0,r=-r):(t=(r>>4)+1,r<48&&(r&=15)),r&&(r<8||r>15))?it:(n.window!==null&&n.wbits!==r&&(n.window=null),n.wrap=t,n.wbits=r,l1(e))}function c1(e,r){var t,n;return e?(n=new b3,e.state=n,n.window=null,t=u1(e,r),t!==hn&&(e.state=null),t):it}function k3(e){return c1(e,y3)}var r1=!0,Oh,Mh;function w3(e){if(r1){var r;for(Oh=new Ze.Buf32(512),Mh=new Ze.Buf32(32),r=0;r<144;)e.lens[r++]=8;for(;r<256;)e.lens[r++]=9;for(;r<280;)e.lens[r++]=7;for(;r<288;)e.lens[r++]=8;for(rs(n1,e.lens,0,288,Oh,0,e.work,{bits:9}),r=0;r<32;)e.lens[r++]=5;rs(i1,e.lens,0,32,Mh,0,e.work,{bits:5}),r1=!1}e.lencode=Oh,e.lenbits=9,e.distcode=Mh,e.distbits=5}function f1(e,r,t,n){var i,o=e.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Ze.Buf8(o.wsize)),n>=o.wsize?(Ze.arraySet(o.window,r,t-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),Ze.arraySet(o.window,r,t-n,i,o.wnext),n-=i,n?(Ze.arraySet(o.window,r,t-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}function S3(e,r){var t,n,i,o,s,a,l,u,c,f,d,h,p,m,v=0,g,y,w,b,k,x,T,_,C=new Ze.Buf8(4),A,O,B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return it;t=e.state,t.mode===or&&(t.mode=Th),s=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,a=e.avail_in,u=t.hold,c=t.bits,f=a,d=l,_=hn;e:for(;;)switch(t.mode){case s1:if(t.wrap===0){t.mode=Th;break}for(;c<16;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}if(t.wrap&2&&u===35615){t.check=0,C[0]=u&255,C[1]=u>>>8&255,t.check=Bt(t.check,C,2,0),u=0,c=0,t.mode=Dx;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",t.mode=Q;break}if((u&15)!==Rx){e.msg="unknown compression method",t.mode=Q;break}if(u>>>=4,c-=4,T=(u&15)+8,t.wbits===0)t.wbits=T;else if(T>t.wbits){e.msg="invalid window size",t.mode=Q;break}t.dmax=1<<T,e.adler=t.check=1,t.mode=u&512?Hx:or,u=0,c=0;break;case Dx:for(;c<16;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}if(t.flags=u,(t.flags&255)!==Rx){e.msg="unknown compression method",t.mode=Q;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=Q;break}t.head&&(t.head.text=u>>8&1),t.flags&512&&(C[0]=u&255,C[1]=u>>>8&255,t.check=Bt(t.check,C,2,0)),u=0,c=0,t.mode=Ix;case Ix:for(;c<32;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}t.head&&(t.head.time=u),t.flags&512&&(C[0]=u&255,C[1]=u>>>8&255,C[2]=u>>>16&255,C[3]=u>>>24&255,t.check=Bt(t.check,C,4,0)),u=0,c=0,t.mode=Lx;case Lx:for(;c<16;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}t.head&&(t.head.xflags=u&255,t.head.os=u>>8),t.flags&512&&(C[0]=u&255,C[1]=u>>>8&255,t.check=Bt(t.check,C,2,0)),u=0,c=0,t.mode=Fx;case Fx:if(t.flags&1024){for(;c<16;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}t.length=u,t.head&&(t.head.extra_len=u),t.flags&512&&(C[0]=u&255,C[1]=u>>>8&255,t.check=Bt(t.check,C,2,0)),u=0,c=0}else t.head&&(t.head.extra=null);t.mode=Bx;case Bx:if(t.flags&1024&&(h=t.length,h>a&&(h=a),h&&(t.head&&(T=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),Ze.arraySet(t.head.extra,n,o,h,T)),t.flags&512&&(t.check=Bt(t.check,n,h,o)),a-=h,o+=h,t.length-=h),t.length))break e;t.length=0,t.mode=zx;case zx:if(t.flags&2048){if(a===0)break e;h=0;do T=n[o+h++],t.head&&T&&t.length<65536&&(t.head.name+=String.fromCharCode(T));while(T&&h<a);if(t.flags&512&&(t.check=Bt(t.check,n,h,o)),a-=h,o+=h,T)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=qx;case qx:if(t.flags&4096){if(a===0)break e;h=0;do T=n[o+h++],t.head&&T&&t.length<65536&&(t.head.comment+=String.fromCharCode(T));while(T&&h<a);if(t.flags&512&&(t.check=Bt(t.check,n,h,o)),a-=h,o+=h,T)break e}else t.head&&(t.head.comment=null);t.mode=jx;case jx:if(t.flags&512){for(;c<16;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}if(u!==(t.check&65535)){e.msg="header crc mismatch",t.mode=Q;break}u=0,c=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=or;break;case Hx:for(;c<32;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}e.adler=t.check=t1(u),u=0,c=0,t.mode=Kl;case Kl:if(t.havedict===0)return e.next_out=s,e.avail_out=l,e.next_in=o,e.avail_in=a,t.hold=u,t.bits=c,d3;e.adler=t.check=1,t.mode=or;case or:if(r===c3||r===Wl)break e;case Th:if(t.last){u>>>=c&7,c-=c&7,t.mode=Ch;break}for(;c<3;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}switch(t.last=u&1,u>>>=1,c-=1,u&3){case 0:t.mode=$x;break;case 1:if(w3(t),t.mode=Vl,r===Wl){u>>>=2,c-=2;break e}break;case 2:t.mode=Vx;break;case 3:e.msg="invalid block type",t.mode=Q}u>>>=2,c-=2;break;case $x:for(u>>>=c&7,c-=c&7;c<32;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",t.mode=Q;break}if(t.length=u&65535,u=0,c=0,t.mode=Eh,r===Wl)break e;case Eh:t.mode=Wx;case Wx:if(h=t.length,h){if(h>a&&(h=a),h>l&&(h=l),h===0)break e;Ze.arraySet(i,n,o,h,s),a-=h,o+=h,l-=h,s+=h,t.length-=h;break}t.mode=or;break;case Vx:for(;c<14;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}if(t.nlen=(u&31)+257,u>>>=5,c-=5,t.ndist=(u&31)+1,u>>>=5,c-=5,t.ncode=(u&15)+4,u>>>=4,c-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=Q;break}t.have=0,t.mode=Ux;case Ux:for(;t.have<t.ncode;){for(;c<3;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}t.lens[B[t.have++]]=u&7,u>>>=3,c-=3}for(;t.have<19;)t.lens[B[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,A={bits:t.lenbits},_=rs(u3,t.lens,0,19,t.lencode,0,t.work,A),t.lenbits=A.bits,_){e.msg="invalid code lengths set",t.mode=Q;break}t.have=0,t.mode=Kx;case Kx:for(;t.have<t.nlen+t.ndist;){for(;v=t.lencode[u&(1<<t.lenbits)-1],g=v>>>24,y=v>>>16&255,w=v&65535,!(g<=c);){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}if(w<16)u>>>=g,c-=g,t.lens[t.have++]=w;else{if(w===16){for(O=g+2;c<O;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}if(u>>>=g,c-=g,t.have===0){e.msg="invalid bit length repeat",t.mode=Q;break}T=t.lens[t.have-1],h=3+(u&3),u>>>=2,c-=2}else if(w===17){for(O=g+3;c<O;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}u>>>=g,c-=g,T=0,h=3+(u&7),u>>>=3,c-=3}else{for(O=g+7;c<O;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}u>>>=g,c-=g,T=0,h=11+(u&127),u>>>=7,c-=7}if(t.have+h>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=Q;break}for(;h--;)t.lens[t.have++]=T}}if(t.mode===Q)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=Q;break}if(t.lenbits=9,A={bits:t.lenbits},_=rs(n1,t.lens,0,t.nlen,t.lencode,0,t.work,A),t.lenbits=A.bits,_){e.msg="invalid literal/lengths set",t.mode=Q;break}if(t.distbits=6,t.distcode=t.distdyn,A={bits:t.distbits},_=rs(i1,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,A),t.distbits=A.bits,_){e.msg="invalid distances set",t.mode=Q;break}if(t.mode=Vl,r===Wl)break e;case Vl:t.mode=Ul;case Ul:if(a>=6&&l>=258){e.next_out=s,e.avail_out=l,e.next_in=o,e.avail_in=a,t.hold=u,t.bits=c,l3(e,d),s=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,a=e.avail_in,u=t.hold,c=t.bits,t.mode===or&&(t.back=-1);break}for(t.back=0;v=t.lencode[u&(1<<t.lenbits)-1],g=v>>>24,y=v>>>16&255,w=v&65535,!(g<=c);){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}if(y&&(y&240)===0){for(b=g,k=y,x=w;v=t.lencode[x+((u&(1<<b+k)-1)>>b)],g=v>>>24,y=v>>>16&255,w=v&65535,!(b+g<=c);){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}u>>>=b,c-=b,t.back+=b}if(u>>>=g,c-=g,t.back+=g,t.length=w,y===0){t.mode=Yx;break}if(y&32){t.back=-1,t.mode=or;break}if(y&64){e.msg="invalid literal/length code",t.mode=Q;break}t.extra=y&15,t.mode=Jx;case Jx:if(t.extra){for(O=t.extra;c<O;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}t.length+=u&(1<<t.extra)-1,u>>>=t.extra,c-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Zx;case Zx:for(;v=t.distcode[u&(1<<t.distbits)-1],g=v>>>24,y=v>>>16&255,w=v&65535,!(g<=c);){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}if((y&240)===0){for(b=g,k=y,x=w;v=t.distcode[x+((u&(1<<b+k)-1)>>b)],g=v>>>24,y=v>>>16&255,w=v&65535,!(b+g<=c);){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}u>>>=b,c-=b,t.back+=b}if(u>>>=g,c-=g,t.back+=g,y&64){e.msg="invalid distance code",t.mode=Q;break}t.offset=w,t.extra=y&15,t.mode=Gx;case Gx:if(t.extra){for(O=t.extra;c<O;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}t.offset+=u&(1<<t.extra)-1,u>>>=t.extra,c-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=Q;break}t.mode=Xx;case Xx:if(l===0)break e;if(h=d-l,t.offset>h){if(h=t.offset-h,h>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=Q;break}h>t.wnext?(h-=t.wnext,p=t.wsize-h):p=t.wnext-h,h>t.length&&(h=t.length),m=t.window}else m=i,p=s-t.offset,h=t.length;h>l&&(h=l),l-=h,t.length-=h;do i[s++]=m[p++];while(--h);t.length===0&&(t.mode=Ul);break;case Yx:if(l===0)break e;i[s++]=t.length,l--,t.mode=Ul;break;case Ch:if(t.wrap){for(;c<32;){if(a===0)break e;a--,u|=n[o++]<<c,c+=8}if(d-=l,e.total_out+=d,t.total+=d,d&&(e.adler=t.check=t.flags?Bt(t.check,i,d,s-d):Ah(t.check,i,d,s-d)),d=l,(t.flags?u:t1(u))!==t.check){e.msg="incorrect data check",t.mode=Q;break}u=0,c=0}t.mode=Qx;case Qx:if(t.wrap&&t.flags){for(;c<32;){if(a===0)break e;a--,u+=n[o++]<<c,c+=8}if(u!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=Q;break}u=0,c=0}t.mode=e1;case e1:_=f3;break e;case Q:_=o1;break e;case Ph:return Nh;case p3:default:return it}return e.next_out=s,e.avail_out=l,e.next_in=o,e.avail_in=a,t.hold=u,t.bits=c,(t.wsize||d!==e.avail_out&&t.mode<Q&&(t.mode<Ch||r!==Px))&&f1(e,e.output,e.next_out,d-e.avail_out)?(t.mode=Ph,Nh):(f-=e.avail_in,d-=e.avail_out,e.total_in+=f,e.total_out+=d,t.total+=d,t.wrap&&d&&(e.adler=t.check=t.flags?Bt(t.check,i,d,e.next_out-d):Ah(t.check,i,d,e.next_out-d)),e.data_type=t.bits+(t.last?64:0)+(t.mode===or?128:0)+(t.mode===Vl||t.mode===Eh?256:0),(f===0&&d===0||r===Px)&&_===hn&&(_=h3),_)}function x3(e){if(!e||!e.state)return it;var r=e.state;return r.window&&(r.window=null),e.state=null,hn}function _3(e,r){var t;return!e||!e.state||(t=e.state,(t.wrap&2)===0)?it:(t.head=r,r.done=!1,hn)}function T3(e,r){var t=r.length,n,i,o;return!e||!e.state||(n=e.state,n.wrap!==0&&n.mode!==Kl)?it:n.mode===Kl&&(i=1,i=Ah(i,r,t,0),i!==n.check)?o1:(o=f1(e,r,t,t),o?(n.mode=Ph,Nh):(n.havedict=1,hn))}mt.inflateReset=l1;mt.inflateReset2=u1;mt.inflateResetKeep=a1;mt.inflateInit=k3;mt.inflateInit2=c1;mt.inflate=S3;mt.inflateEnd=x3;mt.inflateGetHeader=_3;mt.inflateSetDictionary=T3;mt.inflateInfo="pako inflate (from Nodeca project)"});var Rh=S((D4,h1)=>{"use strict";h1.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var m1=S((I4,p1)=>{"use strict";function E3(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}p1.exports=E3});var v1=S(is=>{"use strict";var bi=d1(),ns=rr(),Jl=yh(),ae=Rh(),Dh=Il(),C3=bh(),O3=m1(),g1=Object.prototype.toString;function pn(e){if(!(this instanceof pn))return new pn(e);this.options=ns.assign({chunkSize:16384,windowBits:0,to:""},e||{});var r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(e&&e.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15)===0&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new C3,this.strm.avail_out=0;var t=bi.inflateInit2(this.strm,r.windowBits);if(t!==ae.Z_OK)throw new Error(Dh[t]);if(this.header=new O3,bi.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=Jl.string2buf(r.dictionary):g1.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(t=bi.inflateSetDictionary(this.strm,r.dictionary),t!==ae.Z_OK)))throw new Error(Dh[t])}pn.prototype.push=function(e,r){var t=this.strm,n=this.options.chunkSize,i=this.options.dictionary,o,s,a,l,u,c=!1;if(this.ended)return!1;s=r===~~r?r:r===!0?ae.Z_FINISH:ae.Z_NO_FLUSH,typeof e=="string"?t.input=Jl.binstring2buf(e):g1.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new ns.Buf8(n),t.next_out=0,t.avail_out=n),o=bi.inflate(t,ae.Z_NO_FLUSH),o===ae.Z_NEED_DICT&&i&&(o=bi.inflateSetDictionary(this.strm,i)),o===ae.Z_BUF_ERROR&&c===!0&&(o=ae.Z_OK,c=!1),o!==ae.Z_STREAM_END&&o!==ae.Z_OK)return this.onEnd(o),this.ended=!0,!1;t.next_out&&(t.avail_out===0||o===ae.Z_STREAM_END||t.avail_in===0&&(s===ae.Z_FINISH||s===ae.Z_SYNC_FLUSH))&&(this.options.to==="string"?(a=Jl.utf8border(t.output,t.next_out),l=t.next_out-a,u=Jl.buf2string(t.output,a),t.next_out=l,t.avail_out=n-l,l&&ns.arraySet(t.output,t.output,a,l,0),this.onData(u)):this.onData(ns.shrinkBuf(t.output,t.next_out))),t.avail_in===0&&t.avail_out===0&&(c=!0)}while((t.avail_in>0||t.avail_out===0)&&o!==ae.Z_STREAM_END);return o===ae.Z_STREAM_END&&(s=ae.Z_FINISH),s===ae.Z_FINISH?(o=bi.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===ae.Z_OK):(s===ae.Z_SYNC_FLUSH&&(this.onEnd(ae.Z_OK),t.avail_out=0),!0)};pn.prototype.onData=function(e){this.chunks.push(e)};pn.prototype.onEnd=function(e){e===ae.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ns.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Ih(e,r){var t=new pn(r);if(t.push(e,!0),t.err)throw t.msg||Dh[t.err];return t.result}function M3(e,r){return r=r||{},r.raw=!0,Ih(e,r)}is.Inflate=pn;is.inflate=Ih;is.inflateRaw=M3;is.ungzip=Ih});var k1=S((F4,b1)=>{"use strict";var A3=rr().assign,N3=Sx(),P3=v1(),R3=Rh(),y1={};A3(y1,N3,P3,R3);b1.exports=y1});var S1=S(Gl=>{"use strict";var D3=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",I3=k1(),w1=te(),Zl=Je(),L3=D3?"uint8array":"array";Gl.magic="\b\0";function mn(e,r){Zl.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=r,this.meta={}}w1.inherits(mn,Zl);mn.prototype.processChunk=function(e){this.meta=e.meta,this._pako===null&&this._createPako(),this._pako.push(w1.transformTo(L3,e.data),!1)};mn.prototype.flush=function(){Zl.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)};mn.prototype.cleanUp=function(){Zl.prototype.cleanUp.call(this),this._pako=null};mn.prototype._createPako=function(){this._pako=new I3[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(r){e.push({data:r,meta:e.meta})}};Gl.compressWorker=function(e){return new mn("Deflate",e)};Gl.uncompressWorker=function(){return new mn("Inflate",{})}});var Fh=S(Lh=>{"use strict";var x1=Je();Lh.STORE={magic:"\0\0",compressWorker:function(){return new x1("STORE compression")},uncompressWorker:function(){return new x1("STORE decompression")}};Lh.DEFLATE=S1()});var Bh=S(gn=>{"use strict";gn.LOCAL_FILE_HEADER="PK";gn.CENTRAL_FILE_HEADER="PK";gn.CENTRAL_DIRECTORY_END="PK";gn.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07";gn.ZIP64_CENTRAL_DIRECTORY_END="PK";gn.DATA_DESCRIPTOR="PK\x07\b"});var C1=S((j4,E1)=>{"use strict";var ki=te(),wi=Je(),zh=li(),_1=Al(),Xl=Bh(),J=function(e,r){var t="",n;for(n=0;n<r;n++)t+=String.fromCharCode(e&255),e=e>>>8;return t},F3=function(e,r){var t=e;return e||(t=r?16893:33204),(t&65535)<<16},B3=function(e){return(e||0)&63},T1=function(e,r,t,n,i,o){var s=e.file,a=e.compression,l=o!==zh.utf8encode,u=ki.transformTo("string",o(s.name)),c=ki.transformTo("string",zh.utf8encode(s.name)),f=s.comment,d=ki.transformTo("string",o(f)),h=ki.transformTo("string",zh.utf8encode(f)),p=c.length!==s.name.length,m=h.length!==f.length,v,g,y="",w="",b="",k=s.dir,x=s.date,T={crc32:0,compressedSize:0,uncompressedSize:0};(!r||t)&&(T.crc32=e.crc32,T.compressedSize=e.compressedSize,T.uncompressedSize=e.uncompressedSize);var _=0;r&&(_|=8),!l&&(p||m)&&(_|=2048);var C=0,A=0;k&&(C|=16),i==="UNIX"?(A=798,C|=F3(s.unixPermissions,k)):(A=20,C|=B3(s.dosPermissions,k)),v=x.getUTCHours(),v=v<<6,v=v|x.getUTCMinutes(),v=v<<5,v=v|x.getUTCSeconds()/2,g=x.getUTCFullYear()-1980,g=g<<4,g=g|x.getUTCMonth()+1,g=g<<5,g=g|x.getUTCDate(),p&&(w=J(1,1)+J(_1(u),4)+c,y+="up"+J(w.length,2)+w),m&&(b=J(1,1)+J(_1(d),4)+h,y+="uc"+J(b.length,2)+b);var O="";O+=`
\0`,O+=J(_,2),O+=a.magic,O+=J(v,2),O+=J(g,2),O+=J(T.crc32,4),O+=J(T.compressedSize,4),O+=J(T.uncompressedSize,4),O+=J(u.length,2),O+=J(y.length,2);var B=Xl.LOCAL_FILE_HEADER+O+u+y,U=Xl.CENTRAL_FILE_HEADER+J(A,2)+O+J(d.length,2)+"\0\0\0\0"+J(C,4)+J(n,4)+u+y+d;return{fileRecord:B,dirRecord:U}},z3=function(e,r,t,n,i){var o="",s=ki.transformTo("string",i(n));return o=Xl.CENTRAL_DIRECTORY_END+"\0\0\0\0"+J(e,2)+J(e,2)+J(r,4)+J(t,4)+J(s.length,2)+s,o},q3=function(e){var r="";return r=Xl.DATA_DESCRIPTOR+J(e.crc32,4)+J(e.compressedSize,4)+J(e.uncompressedSize,4),r};function gt(e,r,t,n){wi.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=r,this.zipPlatform=t,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}ki.inherits(gt,wi);gt.prototype.push=function(e){var r=e.meta.percent||0,t=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,wi.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:t?(r+100*(t-n-1))/t:100}}))};gt.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var r=this.streamFiles&&!e.file.dir;if(r){var t=T1(e,r,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:t.fileRecord,meta:{percent:0}})}else this.accumulate=!0};gt.prototype.closedSource=function(e){this.accumulate=!1;var r=this.streamFiles&&!e.file.dir,t=T1(e,r,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(t.dirRecord),r)this.push({data:q3(e),meta:{percent:100}});else for(this.push({data:t.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null};gt.prototype.flush=function(){for(var e=this.bytesWritten,r=0;r<this.dirRecords.length;r++)this.push({data:this.dirRecords[r],meta:{percent:100}});var t=this.bytesWritten-e,n=z3(this.dirRecords.length,t,e,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})};gt.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()};gt.prototype.registerPrevious=function(e){this._sources.push(e);var r=this;return e.on("data",function(t){r.processChunk(t)}),e.on("end",function(){r.closedSource(r.previous.streamInfo),r._sources.length?r.prepareNextSource():r.end()}),e.on("error",function(t){r.error(t)}),this};gt.prototype.resume=function(){if(!wi.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0};gt.prototype.error=function(e){var r=this._sources;if(!wi.prototype.error.call(this,e))return!1;for(var t=0;t<r.length;t++)try{r[t].error(e)}catch{}return!0};gt.prototype.lock=function(){wi.prototype.lock.call(this);for(var e=this._sources,r=0;r<e.length;r++)e[r].lock()};E1.exports=gt});var M1=S(O1=>{"use strict";var j3=Fh(),H3=C1(),$3=function(e,r){var t=e||r,n=j3[t];if(!n)throw new Error(t+" is not a valid compression method !");return n};O1.generateWorker=function(e,r,t){var n=new H3(r.streamFiles,t,r.platform,r.encodeFileName),i=0;try{e.forEach(function(o,s){i++;var a=$3(s.options.compression,r.compression),l=s.options.compressionOptions||r.compressionOptions||{},u=s.dir,c=s.date;s._compressWorker(a,l).withStreamInfo("file",{name:o,dir:u,date:c,comment:s.comment||"",unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions}).pipe(n)}),n.entriesCount=i}catch(o){n.error(o)}return n}});var N1=S(($4,A1)=>{"use strict";var W3=te(),Yl=Je();function ss(e,r){Yl.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(r)}W3.inherits(ss,Yl);ss.prototype._bindStream=function(e){var r=this;this._stream=e,e.pause(),e.on("data",function(t){r.push({data:t,meta:{percent:0}})}).on("error",function(t){r.isPaused?this.generatedError=t:r.error(t)}).on("end",function(){r.isPaused?r._upstreamEnded=!0:r.end()})};ss.prototype.pause=function(){return Yl.prototype.pause.call(this)?(this._stream.pause(),!0):!1};ss.prototype.resume=function(){return Yl.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1};A1.exports=ss});var j1=S((W4,q1)=>{"use strict";var V3=li(),as=te(),I1=Je(),U3=Wd(),L1=Vd(),P1=Nl(),K3=RS(),J3=M1(),R1=Io(),Z3=N1(),F1=function(e,r,t){var n=as.getTypeOf(r),i,o=as.extend(t||{},L1);o.date=o.date||new Date,o.compression!==null&&(o.compression=o.compression.toUpperCase()),typeof o.unixPermissions=="string"&&(o.unixPermissions=parseInt(o.unixPermissions,8)),o.unixPermissions&&o.unixPermissions&16384&&(o.dir=!0),o.dosPermissions&&o.dosPermissions&16&&(o.dir=!0),o.dir&&(e=B1(e)),o.createFolders&&(i=G3(e))&&z1.call(this,i,!0);var s=n==="string"&&o.binary===!1&&o.base64===!1;(!t||typeof t.binary>"u")&&(o.binary=!s);var a=r instanceof P1&&r.uncompressedSize===0;(a||o.dir||!r||r.length===0)&&(o.base64=!1,o.binary=!0,r="",o.compression="STORE",n="string");var l=null;r instanceof P1||r instanceof I1?l=r:R1.isNode&&R1.isStream(r)?l=new Z3(e,r):l=as.prepareContent(e,r,o.binary,o.optimizedBinaryString,o.base64);var u=new K3(e,l,o);this.files[e]=u},G3=function(e){e.slice(-1)==="/"&&(e=e.substring(0,e.length-1));var r=e.lastIndexOf("/");return r>0?e.substring(0,r):""},B1=function(e){return e.slice(-1)!=="/"&&(e+="/"),e},z1=function(e,r){return r=typeof r<"u"?r:L1.createFolders,e=B1(e),this.files[e]||F1.call(this,e,null,{dir:!0,createFolders:r}),this.files[e]};function D1(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var X3={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var r,t,n;for(r in this.files)n=this.files[r],t=r.slice(this.root.length,r.length),t&&r.slice(0,this.root.length)===this.root&&e(t,n)},filter:function(e){var r=[];return this.forEach(function(t,n){e(t,n)&&r.push(n)}),r},file:function(e,r,t){if(arguments.length===1)if(D1(e)){var n=e;return this.filter(function(o,s){return!s.dir&&n.test(o)})}else{var i=this.files[this.root+e];return i&&!i.dir?i:null}else e=this.root+e,F1.call(this,e,r,t);return this},folder:function(e){if(!e)return this;if(D1(e))return this.filter(function(i,o){return o.dir&&e.test(i)});var r=this.root+e,t=z1.call(this,r),n=this.clone();return n.root=t.name,n},remove:function(e){e=this.root+e;var r=this.files[e];if(r||(e.slice(-1)!=="/"&&(e+="/"),r=this.files[e]),r&&!r.dir)delete this.files[e];else for(var t=this.filter(function(i,o){return o.name.slice(0,e.length)===e}),n=0;n<t.length;n++)delete this.files[t[n].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var r,t={};try{if(t=as.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:V3.utf8encode}),t.type=t.type.toLowerCase(),t.compression=t.compression.toUpperCase(),t.type==="binarystring"&&(t.type="string"),!t.type)throw new Error("No output type specified.");as.checkSupport(t.type),(t.platform==="darwin"||t.platform==="freebsd"||t.platform==="linux"||t.platform==="sunos")&&(t.platform="UNIX"),t.platform==="win32"&&(t.platform="DOS");var n=t.comment||this.comment||"";r=J3.generateWorker(this,t,n)}catch(i){r=new I1("error"),r.error(i)}return new U3(r,t.type||"string",t.mimeType)},generateAsync:function(e,r){return this.generateInternalStream(e).accumulate(r)},generateNodeStream:function(e,r){return e=e||{},e.type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(r)}};q1.exports=X3});var qh=S((V4,$1)=>{"use strict";var Y3=te();function H1(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}H1.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var r=0,t;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return Y3.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(e&31)<<1))}};$1.exports=H1});var jh=S((U4,V1)=>{"use strict";var W1=qh(),Q3=te();function Si(e){W1.call(this,e);for(var r=0;r<this.data.length;r++)e[r]=e[r]&255}Q3.inherits(Si,W1);Si.prototype.byteAt=function(e){return this.data[this.zero+e]};Si.prototype.lastIndexOfSignature=function(e){for(var r=e.charCodeAt(0),t=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===r&&this.data[o+1]===t&&this.data[o+2]===n&&this.data[o+3]===i)return o-this.zero;return-1};Si.prototype.readAndCheckSignature=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),o=this.readData(4);return r===o[0]&&t===o[1]&&n===o[2]&&i===o[3]};Si.prototype.readData=function(e){if(this.checkOffset(e),e===0)return[];var r=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};V1.exports=Si});var J1=S((K4,K1)=>{"use strict";var U1=qh(),eq=te();function xi(e){U1.call(this,e)}eq.inherits(xi,U1);xi.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)};xi.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero};xi.prototype.readAndCheckSignature=function(e){var r=this.readData(4);return e===r};xi.prototype.readData=function(e){this.checkOffset(e);var r=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};K1.exports=xi});var $h=S((J4,G1)=>{"use strict";var Z1=jh(),tq=te();function Hh(e){Z1.call(this,e)}tq.inherits(Hh,Z1);Hh.prototype.readData=function(e){if(this.checkOffset(e),e===0)return new Uint8Array(0);var r=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};G1.exports=Hh});var Q1=S((Z4,Y1)=>{"use strict";var X1=$h(),rq=te();function Wh(e){X1.call(this,e)}rq.inherits(Wh,X1);Wh.prototype.readData=function(e){this.checkOffset(e);var r=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};Y1.exports=Wh});var Vh=S((G4,t_)=>{"use strict";var Ql=te(),e_=er(),nq=jh(),iq=J1(),oq=Q1(),sq=$h();t_.exports=function(e){var r=Ql.getTypeOf(e);return Ql.checkSupport(r),r==="string"&&!e_.uint8array?new iq(e):r==="nodebuffer"?new oq(e):e_.uint8array?new sq(Ql.transformTo("uint8array",e)):new nq(Ql.transformTo("array",e))}});var o_=S((X4,i_)=>{"use strict";var Uh=Vh(),Ir=te(),aq=Nl(),r_=Al(),eu=li(),tu=Fh(),lq=er(),uq=0,cq=3,fq=function(e){for(var r in tu)if(Object.prototype.hasOwnProperty.call(tu,r)&&tu[r].magic===e)return tu[r];return null};function n_(e,r){this.options=e,this.loadOptions=r}n_.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(e){var r,t;if(e.skip(22),this.fileNameLength=e.readInt(2),t=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(t),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(r=fq(this.compressionMethod),r===null)throw new Error("Corrupted zip : compression "+Ir.pretty(this.compressionMethod)+" unknown (inner file : "+Ir.transformTo("string",this.fileName)+")");this.decompressed=new aq(this.compressedSize,this.uncompressedSize,this.crc32,r,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var r=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(r),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),e===uq&&(this.dosPermissions=this.externalFileAttributes&63),e===cq&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=Uh(this.extraFields[1].value);this.uncompressedSize===Ir.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===Ir.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===Ir.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===Ir.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var r=e.index+this.extraFieldsLength,t,n,i;for(this.extraFields||(this.extraFields={});e.index+4<r;)t=e.readInt(2),n=e.readInt(2),i=e.readData(n),this.extraFields[t]={id:t,length:n,value:i};e.setIndex(r)},handleUTF8:function(){var e=lq.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=eu.utf8decode(this.fileName),this.fileCommentStr=eu.utf8decode(this.fileComment);else{var r=this.findExtraFieldUnicodePath();if(r!==null)this.fileNameStr=r;else{var t=Ir.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(t)}var n=this.findExtraFieldUnicodeComment();if(n!==null)this.fileCommentStr=n;else{var i=Ir.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var r=Uh(e.value);return r.readInt(1)!==1||r_(this.fileName)!==r.readInt(4)?null:eu.utf8decode(r.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var r=Uh(e.value);return r.readInt(1)!==1||r_(this.fileComment)!==r.readInt(4)?null:eu.utf8decode(r.readData(e.length-5))}return null}};i_.exports=n_});var l_=S((Y4,a_)=>{"use strict";var dq=Vh(),sr=te(),vt=Bh(),hq=o_(),pq=er();function s_(e){this.files=[],this.loadOptions=e}s_.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var r=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+sr.pretty(r)+", expected "+sr.pretty(e)+")")}},isSignature:function(e,r){var t=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4),i=n===r;return this.reader.setIndex(t),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),r=pq.uint8array?"uint8array":"array",t=sr.transformTo(r,e);this.zipComment=this.loadOptions.decodeFileName(t)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e=this.zip64EndOfCentralSize-44,r=0,t,n,i;r<e;)t=this.reader.readInt(2),n=this.reader.readInt(4),i=this.reader.readData(n),this.zip64ExtensibleData[t]={id:t,length:n,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,r;for(e=0;e<this.files.length;e++)r=this.files[e],this.reader.setIndex(r.localHeaderOffset),this.checkSignature(vt.LOCAL_FILE_HEADER),r.readLocalPart(this.reader),r.handleUTF8(),r.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(vt.CENTRAL_FILE_HEADER);)e=new hq({zip64:this.zip64},this.loadOptions),e.readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(vt.CENTRAL_DIRECTORY_END);if(e<0){var r=!this.isSignature(0,vt.LOCAL_FILE_HEADER);throw r?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(e);var t=e;if(this.checkSignature(vt.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===sr.MAX_VALUE_16BITS||this.diskWithCentralDirStart===sr.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===sr.MAX_VALUE_16BITS||this.centralDirRecords===sr.MAX_VALUE_16BITS||this.centralDirSize===sr.MAX_VALUE_32BITS||this.centralDirOffset===sr.MAX_VALUE_32BITS){if(this.zip64=!0,e=this.reader.lastIndexOfSignature(vt.ZIP64_CENTRAL_DIRECTORY_LOCATOR),e<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(vt.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,vt.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(vt.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(vt.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var i=t-n;if(i>0)this.isSignature(t,vt.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(e){this.reader=dq(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};a_.exports=s_});var f_=S((Q4,c_)=>{"use strict";var Kh=te(),ru=oi(),mq=li(),gq=l_(),vq=Jd(),u_=Io();function yq(e){return new ru.Promise(function(r,t){var n=e.decompressed.getContentWorker().pipe(new vq);n.on("error",function(i){t(i)}).on("end",function(){n.streamInfo.crc32!==e.decompressed.crc32?t(new Error("Corrupted zip : CRC32 mismatch")):r()}).resume()})}c_.exports=function(e,r){var t=this;return r=Kh.extend(r||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:mq.utf8decode}),u_.isNode&&u_.isStream(e)?ru.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):Kh.prepareContent("the loaded zip file",e,!0,r.optimizedBinaryString,r.base64).then(function(n){var i=new gq(r);return i.load(n),i}).then(function(i){var o=[ru.Promise.resolve(i)],s=i.files;if(r.checkCRC32)for(var a=0;a<s.length;a++)o.push(yq(s[a]));return ru.Promise.all(o)}).then(function(i){for(var o=i.shift(),s=o.files,a=0;a<s.length;a++){var l=s[a],u=l.fileNameStr,c=Kh.resolve(l.fileNameStr);t.file(c,l.decompressed,{binary:!0,optimizedBinaryString:!0,date:l.date,dir:l.dir,comment:l.fileCommentStr.length?l.fileCommentStr:null,unixPermissions:l.unixPermissions,dosPermissions:l.dosPermissions,createFolders:r.createFolders}),l.dir||(t.file(c).unsafeOriginalName=u)}return o.zipComment.length&&(t.comment=o.zipComment),t})}});var h_=S((e$,d_)=>{"use strict";function ot(){if(!(this instanceof ot))return new ot;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new ot;for(var r in this)typeof this[r]!="function"&&(e[r]=this[r]);return e}}ot.prototype=j1();ot.prototype.loadAsync=f_();ot.support=er();ot.defaults=Vd();ot.version="3.10.1";ot.loadAsync=function(e,r){return new ot().loadAsync(e,r)};ot.external=oi();d_.exports=ot});var m_=S((t$,p_)=>{var bq=h_(),Jh=class{constructor(r={}){this.paragraphs=r.paragraphs||[],this.styles=r.styles||[],this.fonts=r.fonts||["Times New Roman","Arial"],this.footnotes=r.footnotes||{},this.pageSize=r.pageSize||{width:"Letter"},this.margins=r.margins||{top:1,bottom:1,left:1,right:1},this.stylesConfig=r.stylesConfig||{}}async generate(){let r=new bq;r.file("[Content_Types].xml",this.createContentTypesXml()),r.folder("_rels").file(".rels",this.createRelsXml());let t=r.folder("word");return t.file("document.xml",this.createDocumentXml()),t.file("styles.xml",this.createStylesXml()),t.file("fontTable.xml",this.createFontTableXml()),t.file("footnotes.xml",this.createFootnotesXml()),t.file("settings.xml",this.createSettingsXml()),t.folder("_rels").file("document.xml.rels",this.createDocumentRelsXml()),r.generateAsync({type:"nodebuffer"})}createContentTypesXml(){return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
    <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>
    <Default Extension="xml" ContentType="application/xml"/>
    <Override PartName="/word/document.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"/>
    <Override PartName="/word/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml"/>
    <Override PartName="/word/fontTable.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml"/>
    <Override PartName="/word/footnotes.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml"/>
    <Override PartName="/word/settings.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml"/>
</Types>`}createRelsXml(){return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
    <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="word/document.xml"/>
</Relationships>`}createDocumentRelsXml(){return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
    <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>
    <Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable" Target="fontTable.xml"/>
    <Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes" Target="footnotes.xml"/>
    <Relationship Id="rId4" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings" Target="settings.xml"/>
</Relationships>`}createFontTableXml(){return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:fonts xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
    ${this.fonts.map(t=>`
    <w:font w:name="${t}">
        <w:charset w:val="00"/>
        <w:family w:val="auto"/>
        <w:pitch w:val="variable"/>
    </w:font>`).join("")}
</w:fonts>`}createSettingsXml(){return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:settings xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
    <w:zoom w:percent="100"/>
    <w:defaultTabStop w:val="720"/>
    <w:compat>
        <w:compatSetting w:name="compatibilityMode" w:uri="http://schemas.microsoft.com/office/word" w:val="15"/>
    </w:compat>
</w:settings>`}createStylesXml(){let r=new Set,t="";for(let[i,o]of Object.entries(this.stylesConfig)){if(i==="scale"||i==="footnote-number")continue;let{id:s,name:a,basedOn:l}=this.getDocxStyleInfo(i,o),u=this.cssToParaProps(null,s),c=this.cssToRunProps(null,s);t+=`
    <w:style w:type="paragraph" w:styleId="${s}">
        <w:name w:val="${a}"/>
        ${l?`<w:basedOn w:val="${l}"/>`:""}
        <w:pPr>
            ${u}
        </w:pPr>
        <w:rPr>
            ${c}
        </w:rPr>
    </w:style>`,r.add(s)}return this.styles.forEach(i=>{if(!r.has(i.id)){let o=i.computed,s=this.cssToParaProps(o,i.id),a=this.cssToRunProps(o,i.id);t+=`
    <w:style w:type="paragraph" w:styleId="${i.id}">
        <w:name w:val="${i.name}"/>
        ${i.basedOn?`<w:basedOn w:val="${i.basedOn}"/>`:""}
        <w:pPr>
            ${s}
        </w:pPr>
        <w:rPr>
            ${a}
        </w:rPr>
    </w:style>`,r.add(i.id)}}),`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:styles xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
    <w:docDefaults>
        <w:rPrDefault>
            <w:rPr>
                <w:rFonts w:asciiTheme="minorHAnsi" w:eastAsiaTheme="minorEastAsia" w:hAnsiTheme="minorHAnsi" w:cstheme="minorBidi"/>
                <w:sz w:val="24"/>
                <w:szCs w:val="24"/>
                <w:lang w:val="en-US" w:eastAsia="en-US" w:bidi="ar-SA"/>
            </w:rPr>
        </w:rPrDefault>
        <w:pPrDefault/>
    </w:docDefaults>
    ${t}
    
    <w:style w:type="character" w:styleId="FootnoteReference">
        <w:name w:val="Footnote Reference"/>
        <w:rPr>
            <w:vertAlign w:val="superscript"/>
        </w:rPr>
    </w:style>
</w:styles>`}createDocumentXml(){let r=this.paragraphs.map(o=>this.createParagraphXml(o)).join(""),t=this.pageSize.width==="A4"?11906:12240,n=this.pageSize.width==="A4"?16838:15840,i={top:Math.round(this.margins.top*1440),bottom:Math.round(this.margins.bottom*1440),left:Math.round(this.margins.left*1440),right:Math.round(this.margins.right*1440)};return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
    <w:body>
        ${r}
        <w:sectPr>
            <w:pgSz w:w="${t}" w:h="${n}"/>
            <w:pgMar w:top="${i.top}" w:right="${i.right}" w:bottom="${i.bottom}" w:left="${i.left}" w:header="720" w:footer="720" w:gutter="0"/>
        </w:sectPr>
    </w:body>
</w:document>`}createFootnotesXml(){return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:footnotes xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
    <w:footnote w:type="separator" w:id="-1">
        <w:p><w:r><w:separator/></w:r></w:p>
    </w:footnote>
    <w:footnote w:type="continuationSeparator" w:id="0">
        <w:p><w:r><w:continuationSeparator/></w:r></w:p>
    </w:footnote>
    ${Object.entries(this.footnotes).map(([t,n])=>{let i=n.paragraphs.map(o=>this.createParagraphXml(o)).join("");return`<w:footnote w:id="${t}">${i}</w:footnote>`}).join("")}
</w:footnotes>`}createParagraphXml(r){let t=`
        <w:pPr>
            <w:pStyle w:val="${r.styleId}"/>
            ${this.cssToParaProps(r.computed,r.styleId)}
        </w:pPr>`,n=r.runs.map(i=>this.createRunXml(i,r.styleId)).join("");return`<w:p>${t}${n}</w:p>`}createRunXml(r,t){return r.type==="footnote"?`<w:r><w:rPr><w:rStyle w:val="FootnoteReference"/></w:rPr><w:footnoteReference w:id="${r.attrs.id}"/></w:r>`:`<w:r>${`
        <w:rPr>
            ${this.cssToRunProps(r.style,t)}
            ${this.marksToRunProps(r.marks)}
        </w:rPr>`}<w:t xml:space="preserve">${this.escapeXml(r.text)}</w:t></w:r>`}getDocxStyleInfo(r,t){let n=r,i=t.name||r,o="Normal";if(r==="body")n="Normal",i="Normal",o=null;else if(r==="title")n="Title",i="Title",o="Normal";else if(r==="subtitle")n="Subtitle",i="Subtitle",o="Title";else if(r.startsWith("heading-")){let s=r.replace("heading-","");n=`Heading${s}`,i=`Heading ${s}`,o="Normal"}else r==="footnote"&&(n="FootnoteText",i="Footnote Text",o="Normal");return{id:n,name:i,basedOn:o}}cssToParaProps(r,t){let n=null;t==="Normal"?n="body":t==="Title"?n="title":t==="Subtitle"?n="subtitle":t==="FootnoteText"?n="footnote":t&&t.startsWith("Heading")?n=`heading-${t.replace("Heading","")}`:n=t;let i=n?this.stylesConfig[n]:null,o="left";i&&i["text-align"]?o=i["text-align"]:r&&r.textAlign&&(r.textAlign==="center"&&(o="center"),r.textAlign==="right"&&(o="right"),r.textAlign==="justify"&&(o="both"));let s=0,a=0,l=240,u="auto";if(i&&(i["margin-top"]||i["before-paragraph"])?s=this.parseUnit(i["margin-top"]||i["before-paragraph"],"twips"):r&&(s=this.parseUnit(r.marginTop,"twips")),i&&(i["margin-bottom"]||i["after-paragraph"])?a=this.parseUnit(i["margin-bottom"]||i["after-paragraph"],"twips"):r&&(a=this.parseUnit(r.marginBottom,"twips")),i&&(i["line-height"]||i["line-spacing"])){let h=i["line-height"]||i["line-spacing"];String(h).match(/^[0-9.]+$/)?(l=Math.round(parseFloat(h)*240),u="auto"):(l=this.parseUnit(h,"twips"),u="exact")}else r&&r.lineHeight!=="normal"&&(r.lineHeight.endsWith("px")?(l=this.parseUnit(r.lineHeight,"twips"),u="exact"):isNaN(parseFloat(r.lineHeight))||(l=Math.round(parseFloat(r.lineHeight)*240)));let c=0,f=0,d=0;return i&&(i["margin-left"]||i["left-indent"])?c=this.parseUnit(i["margin-left"]||i["left-indent"],"twips"):r&&(c=this.parseUnit(r.marginLeft,"twips")+this.parseUnit(r.paddingLeft,"twips")),i&&(i["margin-right"]||i["right-indent"])?f=this.parseUnit(i["margin-right"]||i["right-indent"],"twips"):r&&(f=this.parseUnit(r.marginRight,"twips")+this.parseUnit(r.paddingRight,"twips")),i&&(i["text-indent"]||i["first-indent"])?d=this.parseUnit(i["text-indent"]||i["first-indent"],"twips"):r&&(d=this.parseUnit(r.textIndent,"twips")),`
            <w:jc w:val="${o}"/>
            <w:spacing w:before="${s}" w:after="${a}" w:line="${l}" w:lineRule="${u}"/>
            <w:ind w:left="${c}" w:right="${f}" w:firstLine="${d}"/>
        `}cssToRunProps(r,t){let n=null;t==="Normal"?n="body":t==="Title"?n="title":t==="Subtitle"?n="subtitle":t==="FootnoteText"?n="footnote":t&&t.startsWith("Heading")?n=`heading-${t.replace("Heading","")}`:n=t;let i=n?this.stylesConfig[n]:null,o="Times New Roman";i&&i["font-family"]?o=Zh(i["font-family"]):r&&r.fontFamily&&(o=Zh(r.fontFamily));let s=24;return i&&i["font-size"]?s=this.parseUnit(i["font-size"],"half-points"):r&&r.fontSize&&(s=this.parseUnit(r.fontSize,"half-points")),`
            <w:rFonts w:ascii="${o}" w:hAnsi="${o}"/>
            <w:sz w:val="${s}"/>
            <w:szCs w:val="${s}"/>
            <w:color w:val="auto"/>
        `}marksToRunProps(r){if(!r)return"";let t="";return r.forEach(n=>{n.type==="bold"&&(t+="<w:b/>"),n.type==="italic"&&(t+="<w:i/>"),n.type==="underline"&&(t+='<w:u w:val="single"/>'),n.type==="strike"&&(t+="<w:strike/>"),n.type==="superscript"&&(t+='<w:vertAlign w:val="superscript"/>'),n.type==="subscript"&&(t+='<w:vertAlign w:val="subscript"/>'),n.type==="smallCaps"&&(t+="<w:smallCaps/>")}),t}escapeXml(r){return r.replace(/[<>&'"]/g,function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}})}parseUnit(r,t="twips"){if(!r)return 0;let n=String(r).trim(),i=parseFloat(n);if(isNaN(i))return 0;let o=0;return n.endsWith("pt")?o=i:n.endsWith("in")?o=i*72:n.endsWith("mm")?o=i*2.835:n.endsWith("cm")?o=i*28.35:n.endsWith("px")?o=i*.75:n.endsWith("pc")?o=i*12:o=i,Math.round(t==="twips"?o*20:o*2)}};function Zh(e){return e?(typeof window<"u"&&typeof document<"u"&&e.includes("var(")&&(e=e.replace(/var\((--[^)]+)\)/g,(n,i)=>getComputedStyle(document.body).getPropertyValue(i).trim()||"")),e.split(",").map(n=>n.trim().replace(/['"]/g,"")).find(n=>n&&n!=="??"&&n.toLowerCase()!=="undefined"&&n!=="")||"Times New Roman"):"Times New Roman"}p_.exports={MinimalDocxGenerator:Jh,cleanFont:Zh}});var b_=S((r$,y_)=>{var{Extension:kq}=P(),{MinimalDocxGenerator:wq,cleanFont:g_}=m_(),{Notice:ls}=require("obsidian"),Sq=require("electron"),xq=require("fs"),_q=kq.create({name:"docxSerializer",addCommands(){return{exportToDocx:e=>async({editor:r,view:t})=>{let{settings:n,footnoteView:i,stylesConfig:o}=e;try{new ls("Preparing DOCX export...");let{paragraphs:s,styles:a,fonts:l}=v_(t,r.state.doc,o),u=Tq(i,r),f=await new wq({paragraphs:s,styles:a,fonts:l,footnotes:u,pageSize:n.pageSize,margins:n.margins,stylesConfig:o}).generate(),d=(t.props.file?.basename||"Untitled")+".docx",h=await Sq.remote.dialog.showSaveDialog({title:"Export to Word (.docx)",defaultPath:d,filters:[{name:"Word Document",extensions:["docx"]}]});return h.canceled||!h.filePath?(new ls("Export cancelled."),!0):(xq.writeFile(h.filePath,f,p=>{p?(console.error("Colophon: Failed to save Word (.docx) file.",p),new ls("Failed to save file.")):new ls("File saved successfully!")}),!0)}catch(s){return console.error("DOCX Export Error:",s),new ls(`Export failed: ${s.message}`),!1}}}}});function v_(e,r,t){let n=[],i=new Map,o=new Set(["Times New Roman","Arial","Symbol"]);return r.forEach((s,a)=>{let l=e.nodeDOM(a);if(!l||!(l instanceof Element))return;let u=getComputedStyle(l),c=Eq(i,u,s.type.name,s.attrs,t),f=g_(u.fontFamily);f&&o.add(f);let d=[];s.content&&s.content.size>0&&s.content.forEach((h,p)=>{let m=a+1+p,g=e.domAtPos(m).node;g.nodeType===3&&(g=g.parentElement);let y=getComputedStyle(g),w=g_(y.fontFamily);w&&o.add(w),d.push({text:h.text,style:y,marks:h.marks,type:h.type.name,attrs:h.attrs})}),n.push({type:s.type.name,styleId:c,computed:u,runs:d,attrs:s.attrs})}),{paragraphs:n,styles:Array.from(i.values()),fonts:Array.from(o)}}function Tq(e,r){let t={};return e&&e.editors.forEach((n,i)=>{let o=n.view,s=n.state.doc,{paragraphs:a}=v_(o,s,{});t[i]={paragraphs:a}}),t}function Eq(e,r,t,n,i){let o="Normal",s="Normal",a=null;if(n&&n.class){let l=n.class;if(l==="body")o="Normal",s="Normal";else if(l==="title")o="Title",s="Title",a="Normal";else if(l==="subtitle")o="Subtitle",s="Subtitle",a="Title";else if(l.startsWith("heading-")){let u=l.replace("heading-","");o=`Heading${u}`,s=`Heading ${u}`,a="Normal"}else l==="footnote"?(o="FootnoteText",s="Footnote Text",a="Normal"):i&&i[l]&&(o=l,s=i[l].name||l,a="Normal")}return o==="Normal"&&(!n||!n.class||n.class==="body")&&t==="heading"&&(o=`Heading${n.level}`,s=`Heading ${n.level}`,a="Normal"),e.has(o)||e.set(o,{id:o,name:s,type:"paragraph",basedOn:a,computed:r}),o}y_.exports=_q});var w_=S((n$,k_)=>{var Gh=class{constructor(){this.styles={}}generateCSS(r){this.styles=r;let t="",n=1;if(r.scale){let i=String(r.scale);i.endsWith("%")?n=parseFloat(i)/100:n=parseFloat(i),isNaN(n)&&(n=1)}for(let[i,o]of Object.entries(r))if(i!=="scale")if(o.type==="list"){let s=this.generateListCSS(i,o,n);s&&(t+=s)}else if(o.type==="footnote"){let s=this.generateFootnoteCSS(i,o,n);s&&(t+=s)}else{let s=this.getSelector(i),a=this.mapStyleToCSS(o,n);a&&(t+=`${s} {
${a}
}
`)}return t}getSelector(r){let t=".colophon-workspace .ProseMirror";if(r&&r.startsWith("heading-")){let n=r.split("-")[1];return`${t} h${n}.${r}`}else return r==="title"?`${t} h1.title`:r==="supertitle"?`${t} p.supertitle`:r==="footnote"?".colophon-footnote-view .colophon-footnote-editor-content p":r==="footnote-number"?"span.colophon-footnote-number":`${t} p.${r}`}mapStyleToCSS(r,t=1){let n=[];if(r["font-family"]&&n.push(`    font-family: ${this.formatFontFamily(r["font-family"])};`),r["font-size"]&&n.push(`    font-size: ${this.convertValue(r["font-size"],"font-size",t)};`),r["text-align"]&&n.push(`    text-align: ${r["text-align"]};`),r["line-spacing"]&&n.push(`    line-height: ${this.convertValue(r["line-spacing"],"line-spacing",t)};`),r["before-paragraph"]&&n.push(`    margin-top: ${this.convertValue(r["before-paragraph"],"spacing",t)};`),r["after-paragraph"]&&n.push(`    margin-bottom: ${this.convertValue(r["after-paragraph"],"spacing",t)};`),r["first-indent"]&&n.push(`    text-indent: ${this.convertValue(r["first-indent"],"indent",t)};`),r["left-indent"]&&n.push(`    margin-left: ${this.convertValue(r["left-indent"],"indent",t)};`),r["right-indent"]&&n.push(`    margin-right: ${this.convertValue(r["right-indent"],"indent",t)};`),r["font-variant"]){let i=r["font-variant"].toLowerCase();i==="italic"?n.push("    font-style: italic;"):i==="bold"?n.push("    font-weight: bold;"):i==="small-caps"?n.push("    font-variant: small-caps;"):(n.push("    font-style: normal;"),n.push("    font-weight: normal;"),n.push("    font-variant: normal;"))}return r.capitalization&&(r.capitalization==="small-caps"?n.push("    font-variant: small-caps;"):n.push(`    text-transform: ${r.capitalization};`)),r["character-spacing"]&&n.push(`    letter-spacing: ${r["character-spacing"]};`),r["keep-with-next"]&&(n.push("    page-break-after: avoid;"),n.push("    break-after: avoid;")),r.color&&n.push(`    color: ${r.color};`),r["font-weight"]&&n.push(`    font-weight: ${r["font-weight"]};`),n.join(`
`)}generateListCSS(r,t,n=1){let i="",o=t.defaults||{},s=t.levels||{};for(let a=1;a<=9;a++){let l={...o,...s[a]||{}},u=`.colophon-workspace .ProseMirror :is(ul, ol).${r}`;if(a>1){let g=a-1;for(let y=0;y<g;y++)u+=" > li > :is(ul, ol)"}let c=`    list-style-type: none;
    padding-left: 0;
    margin-left: 0;
    margin-top: 0;
    margin-bottom: 0;
`;(l["list-type"]==="ordered"||l.type==="ordered")&&(c+=`    counter-reset: colophon-list-item;
`),i+=`${u} {
${c}}
`;let f=`${u} > li`,d=this.convertValue(l["text-indent"],"indent",n),h=this.convertValue(l["marker-indent"],"indent",n),p=`    position: relative;
`;p+=`    padding-left: ${d};
`,p+=`    margin-left: 0;
`,i+=`${f} {
${p}}
`,i+=`${f} > p {
    position: relative;
    text-indent: 0;
    margin: 0;
}
`;let m=`    position: absolute;
`;if(m+=`    left: calc(${h} - ${d});
`,m+=`    top: 0;
`,l.align){let g=this.convertValue(l.align,"indent",n);m+=`    transform: translateY(calc(-1 * ${g}));
`}if(l.color&&l.color!=="inherit"&&(m+=`    color: ${l.color};
`),l.size&&(m+=`    font-size: ${l.size};
`),l["font-weight"]&&(m+=`    font-weight: ${l["font-weight"]};
`),l["list-type"]==="ordered"||l.type==="ordered"){let g=l.marker||"decimal",y=l.suffix||".";m+=`    counter-increment: colophon-list-item;
`,m+=`    content: counter(colophon-list-item, ${g}) "${y}";
`}else{let y=(l.marker||"\u2022").replace(/"/g,'\\"');m+=`    content: "${y}";
`}i+=`${f} > p:first-child::before {
${m}}
`}return i}generateFootnoteCSS(r,t,n=1){let i=".colophon-workspace .ProseMirror .footnote-symbol",o=[];if(t["font-family"]&&o.push(`    font-family: ${t["font-family"]};`),t["font-size"]){let s=this.convertValue(t["font-size"],"font-size",n);o.push(`    font-size: ${s};`)}if(t.color&&o.push(`    color: ${t.color};`),t["font-weight"]&&o.push(`    font-weight: ${t["font-weight"]};`),o.push("    line-height: 0;"),t.align){let s=this.convertValue(t.align,"indent",n);o.push("    position: relative;"),o.push(`    top: calc(-1 * ${s});`),o.push("    vertical-align: baseline;")}return`${i} {
${o.join(`
`)}
}
`}convertValue(r,t,n=1){if(typeof r!="string"&&typeof r!="number")return r;let i=String(r),o=parseFloat(i);if(isNaN(o))return r;let s=o*n;if(i.endsWith("in"))return`${(s*6).toFixed(3)}rem`;if(t==="font-size"){if(i.endsWith("pt"))return`${(s/12).toFixed(3)}rem`}else if(t!=="indent"){if(t==="line-spacing"){if(i.endsWith("pt"))return`${(s/12).toFixed(3)}rem`;if(!i.match(/[a-z%]/i))return i}else if(t==="spacing"&&i.endsWith("pt"))return`${(s/12).toFixed(3)}rem`}return r}formatFontFamily(r){let t=String(r).trim();return t.includes("var(")||t.includes(",")||t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t:t.includes(" ")?`"${t}"`:t}getStyleOptions(r){let t=[],n=[];n.push({label:"None",value:"none",type:"list"});for(let[i,o]of Object.entries(r)){if(i==="scale"||i==="footnote"||i==="footnote-number")continue;let s=o.type||"paragraph",a={label:o.name||i,value:i,type:s,listType:o.defaults?.["list-type"]||"unordered"};s==="list"?n.push(a):(s==="paragraph"||!s)&&t.push(a)}return{paragraphOptions:t,listOptions:n}}};k_.exports=Gh});var x_=S((i$,S_)=>{var Cq={scale:"100%",supertitle:{name:"Supertitle",type:"paragraph","font-size":"11.5pt","text-align":"center","line-spacing":"14pt","before-paragraph":"0pt","after-paragraph":"18pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular"},title:{name:"Title",type:"paragraph","font-size":"18pt","text-align":"center","line-spacing":"18pt","before-paragraph":"0pt","after-paragraph":"4pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular"},subtitle:{name:"Subtitle",type:"paragraph","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular","font-size":"14pt","line-spacing":"18pt","after-paragraph":"28pt","text-align":"center"},epigraph:{name:"Epigraph",type:"paragraph","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular","font-size":"11.5pt","line-spacing":"16pt","left-indent":"1in","right-indent":"1in","before-paragraph":"48pt","after-paragraph":"56pt"},"body-first":{name:"Body First",type:"paragraph","font-size":"11.5pt","text-align":"left","first-indent":"0in","left-indent":"0in","right-indent":"0in","line-spacing":"16pt","before-paragraph":"0pt","after-paragraph":"0pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular","following-style":"body"},body:{name:"Body",type:"paragraph","font-size":"11.5pt","text-align":"left","first-indent":"0.3in","left-indent":"0in","right-indent":"0in","line-spacing":"16pt","before-paragraph":"0pt","after-paragraph":"0pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular"},footnote:{name:"Footnote",type:"paragraph","font-size":"7pt","text-align":"left","first-indent":"0in","left-indent":"0in","right-indent":"0in","line-spacing":"9pt","before-paragraph":"0pt","after-paragraph":"0pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular","space-between-notes":"10pt",format:"integer",numbering:"continuous"},"footnote-number":{name:"Footnote Number",type:"pararaph","font-weight":"bold","font-family":"var(--font-text-theme), var(--font-text-override)","font-size":"7pt","line-spacing":"9pt"},"heading-1":{name:"Heading 1",type:"paragraph","font-size":"11.5pt","text-align":"left","first-indent":"0in","left-indent":"0in","right-indent":"0in","line-spacing":"28pt","before-paragraph":"28pt","after-paragraph":"14pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Italic","keep-with-next":!0,"following-style":"body-first"},"heading-2":{name:"Heading 2",type:"paragraph","font-size":"11.5pt","text-align":"left","first-indent":"0in","left-indent":"0in","right-indent":"0in","line-spacing":"28pt","before-paragraph":"28pt","after-paragraph":"14pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular",capitalization:"small-caps","character-spacing":"2%","keep-with-next":!0,"following-style":"body-first"},"heading-3":{name:"Heading 3",type:"paragraph","font-size":"11.5pt","text-align":"center","first-indent":"0in","left-indent":"0in","right-indent":"0in","line-spacing":"28pt","before-paragraph":"28pt","after-paragraph":"14pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular","keep-with-next":!0,"following-style":"body-first"},bullet:{name:"Bullet",type:"list",defaults:{"list-type":"unordered",marker:"\u2022",color:"inherit",size:"100%",align:"0pt","marker-indent":"0in","text-indent":"0.25in"}},numbered:{name:"Numbered",type:"list",defaults:{"list-type":"ordered",marker:"decimal",suffix:".",color:"inherit",size:"100%",align:"0pt","marker-indent":"0in","text-indent":"0.25in"}},"footnote-symbol":{name:"Footnote Symbol",type:"footnote",format:"integer",align:"4pt","font-size":"7pt","line-height":"0","font-family":"var(--font-text-theme), var(--font-text-override)",color:"var(--text-normal)"}};S_.exports=Cq});var E_=S((s$,T_)=>{var{Editor:Oq,Mark:Mq,Extension:Aq,mergeAttributes:Nq}=P(),{StarterKit:Pq}=Uf(),{Paragraph:Rq}=Af(),{Heading:Dq}=Jc(),{BulletList:Iq}=Sk(),{OrderedList:Lq}=Tk(),{ListItem:Fq}=Ok(),Bq=el(),{Subscript:zq}=Xf(),{Superscript:qq}=Qf(),jq=td(),{InputRule:o$}=P(),Hq=Jk(),$q=rd(),Wq=id(),Vq=tw(),Uq=b_(),Kq=w_(),__=x_(),{parseYaml:Jq}=require("obsidian"),Zq=Aq.create({name:"enterKeyHandler",addKeyboardShortcuts(){return{Enter:()=>{let{state:e}=this.editor,{$from:r}=e.selection;return r.parent.attrs.class!=="body"?this.editor.chain().focus().splitBlock().setNode("paragraph",{class:"body"}).run():this.editor.commands.splitBlock()}}}}),Gq=Rq.extend({addAttributes(){return{class:{default:"body",parseHTML:e=>e.getAttribute("class"),renderHTML:e=>e.class?{class:e.class}:{}}}}}),Xq=Dq.extend({addAttributes(){return{...this.parent?.(),level:{default:1,keepOnSplit:!1},class:{default:"heading-1",parseHTML:e=>e.getAttribute("class"),renderHTML:e=>e.class?{class:e.class}:{}}}}}),Yq=Iq.extend({addAttributes(){return{class:{default:"bullet",parseHTML:e=>e.getAttribute("class"),renderHTML:e=>({class:e.class})}}}}),Qq=Lq.extend({addAttributes(){return{class:{default:"ordered",parseHTML:e=>e.getAttribute("class"),renderHTML:e=>({class:e.class})}}}}),ej=Fq.extend({}),tj=Mq.create({name:"smallCaps",parseHTML(){return[{style:"font-variant",getAttrs:e=>e==="small-caps"?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",Nq(e,{style:"font-variant: small-caps"}),0]},addCommands(){return{toggleSmallCaps:()=>({commands:e})=>e.toggleMark(this.name)}}}),Xh=class{constructor(r,t,n,i,o,s){this.app=r,this.containerEl=t,this.toolbar=n,this.isSpellcheckEnabled=i,this.settings=o,this.onUpdate=s,this.editor=null,this.isLoaded=!1,this.footnotes=[],this.listeners=[],this.styleManager=new Kq,this.styles={...__},this.paragraphOptions=[],this.listOptions=[]}normalizeDoc(r){return!r||!r.content||r.content.forEach(t=>{if(t.type==="paragraph")(!t.attrs||t.attrs.class===null||t.attrs.class===void 0)&&(t.attrs={...t.attrs,class:"body"});else if(t.type==="heading"&&(!t.attrs||t.attrs.class===null||t.attrs.class===void 0)){let n=t.attrs?.level||1;t.attrs={...t.attrs,class:`heading-${n}`}}}),r}subscribe(r){return this.listeners.push(r),()=>{this.listeners=this.listeners.filter(t=>t!==r)}}updateSettings(r){this.settings=r,this.loadStyles(),this.editor&&this.handleScroll()}load(r,t,n){this.filePath=n,this.editor&&this.editor.destroy();let i=null;t&&(t.doc?(i=t.doc,this.footnotes=t.footnotes||[]):(i=t,this.footnotes=[])),i||(i={type:"doc",content:r.split(`

`).map(o=>({type:"paragraph",content:o.trim()?[{type:"text",text:o.trim()}]:[]}))},this.footnotes=[]),i=this.normalizeDoc(i),this.initEditor(i),this.isLoaded=!0}initEditor(r){let t=this.containerEl.createDiv("colophon-editor-host");this.loadStyles().then(()=>{}),this.editor=new Oq({element:t,extensions:[Pq.configure({paragraph:!1,heading:!1,bulletList:!1,orderedList:!1,listItem:!1}),Zq,Gq,Xq,Yq,Qq,ej,Bq,zq,qq,jq,tj,Hq,$q.configure({smartQuotes:this.settings.smartQuotes,smartDashes:this.settings.smartDashes,doubleQuoteStyle:this.settings.doubleQuoteStyle,singleQuoteStyle:this.settings.singleQuoteStyle}),Wq.configure({app:this.app,getFilePath:()=>this.filePath}),Vq.configure({app:this.app,getFilePath:()=>this.filePath}),Uq],editorProps:{attributes:{spellcheck:this.isSpellcheckEnabled?"true":"false"}},content:r,onUpdate:({editor:n})=>{this.triggerUpdate()},onSelectionUpdate:({editor:n})=>{this.handleScroll(),this.toolbar&&this.toolbar.update()},onFocus:({editor:n})=>{this.toolbar&&this.toolbar.setActiveEditor(n)}}),this.toolbar&&(this.toolbar.setActiveEditor(this.editor),this.toolbar.updateStyleOptions(this.paragraphOptions||[],this.listOptions||[]))}async loadStyles(){try{let r={...__},t=this.settings.stylesFolder||"snippets",n=`${this.app.vault.configDir}/${t}`;if(await this.app.vault.adapter.exists(n))for(let a of this.settings.enabledStyles||[]){let l=`${n}/${a}`;if(await this.app.vault.adapter.exists(l))try{let u=await this.app.vault.adapter.read(l),c=Jq(u);for(let[f,d]of Object.entries(c))r[f]&&typeof r[f]=="object"&&!Array.isArray(r[f])&&d&&typeof d=="object"&&!Array.isArray(d)?r[f]={...r[f],...d}:r[f]=d}catch(u){console.error(`Colophon: Failed to load style file ${a}`,u)}}this.styles=r;let i=this.styleManager.generateCSS(r);this.injectStyles(i);let{paragraphOptions:o,listOptions:s}=this.styleManager.getStyleOptions(r);this.paragraphOptions=o,this.listOptions=s,this.toolbar&&this.toolbar.updateStyleOptions(this.paragraphOptions,this.listOptions),this.triggerUpdate()}catch(r){console.error("Colophon: Failed to load styles",r)}}injectStyles(r){let t="colophon-dynamic-styles",n=document.getElementById(t);n||(n=document.createElement("style"),n.id=t,document.head.appendChild(n)),n.textContent=r}handleScroll(){if(!this.editor||!this.editor.view.hasFocus())return;let{state:r}=this.editor;if(!r.selection.empty)return;let t=this.editor.view,n=r.selection.from,i=t.coordsAtPos(n),o=this.containerEl.getBoundingClientRect();if(this.settings.fixedFeedPosition){let a=1-(this.settings.feedPadding||0)/100,l=o.height*a,u=o.top+l,f=i.bottom-u;Math.abs(f)>2&&this.containerEl.scrollBy({top:f,behavior:"smooth"})}else if(i.top<o.top+20){let a=i.top-(o.top+20);this.containerEl.scrollBy({top:a,behavior:"auto"})}else if(i.bottom>o.bottom-20){let a=i.bottom-(o.bottom-20);this.containerEl.scrollBy({top:a,behavior:"auto"})}}triggerUpdate(){if(!this.editor)return;let r=[],t=1,n=!1;this.editor.state.doc.descendants((o,s)=>{if(o.type.name==="footnote"){let a=this.getFootnoteSymbol(t++);r.push({id:o.attrs.id,number:a,pos:s}),o.attrs.number!==a&&(n=!0)}});let i=r.map(o=>{let s=this.footnotes.find(a=>a.id===o.id);return{id:o.id,number:o.number,content:s?s.content:""}});this.footnotes=i,n&&Promise.resolve().then(()=>{if(!this.editor||this.editor.isDestroyed)return;let o=this.editor.state.tr,s=!1;this.editor.state.doc.descendants((a,l)=>{if(a.type.name==="footnote"){let u=r.find(c=>c.id===a.attrs.id)?.number;u&&a.attrs.number!==u&&(o.setNodeMarkup(l,null,{...a.attrs,number:u}),s=!0)}}),s&&this.editor.view.dispatch(o)}),this.onUpdate&&this.onUpdate({doc:this.editor.getJSON(),footnotes:this.footnotes}),this.listeners.forEach(o=>o())}addFootnote(){if(this.editor){let r=`fn-${Date.now()}`;return this.editor.chain().focus().insertContent({type:"footnote",attrs:{id:r,number:"#"}}).run(),r}}updateFootnote(r,t){let n=this.footnotes.find(i=>i.id===r);n&&(n.content=t,this.onUpdate&&this.onUpdate({doc:this.editor.getJSON(),footnotes:this.footnotes}))}getFootnotes(){return this.footnotes}destroy(){this.editor&&(this.editor.destroy(),this.editor=null)}focus(){this.editor&&this.editor.commands.focus()}getFootnoteSymbol(r){let t=this.styleManager.styles["footnote-symbol"],n=t?t.format:"integer";if(Array.isArray(n))return n.length===0?String(r):n[(r-1)%n.length];switch(n){case"lower-roman":return this.toRoman(r).toLowerCase();case"upper-roman":return this.toRoman(r);case"lower-alpha":return this.toAlpha(r).toLowerCase();case"upper-alpha":return this.toAlpha(r);case"integer":default:return String(r)}}toRoman(r){let t={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},n="";for(let i in t)for(;r>=t[i];)n+=i,r-=t[i];return n}toAlpha(r){let t="";for(;r>0;){let n=(r-1)%26;t=String.fromCharCode(65+n)+t,r=(r-n)/26|0}return t}getWordCounts(){if(!this.editor)return{main:0,footnotes:0};let r=this.countWordsInDoc(this.editor.state.doc),t=0;return this.footnotes.forEach(n=>{typeof n.content=="string"?t+=this.countWordsInText(n.content):typeof n.content=="object"&&(t+=this.countWordsInDocNode(n.content))}),{main:r,footnotes:t}}countWordsInDoc(r){let t=0;return r.descendants(n=>{n.isText&&(t+=this.countWordsInText(n.text))}),t}countWordsInDocNode(r){let t=0;return r.type==="text"&&r.text&&(t+=this.countWordsInText(r.text)),r.content&&Array.isArray(r.content)&&r.content.forEach(n=>{t+=this.countWordsInDocNode(n)}),t}countWordsInText(r){if(!r)return 0;let t=r.match(/\S+/g);return t?t.length:0}};T_.exports=Xh});var O_=S((a$,C_)=>{function rj(e){let r=e,t="",n=null,i=/^---\n[\s\S]*?\n---\n/,o=e.match(i);o&&(t=o[0],r=r.substring(t.length));let s=/%% colophon:data\s*(\{[\s\S]*?\})\s*%%$/,a=r.match(s);if(a)try{n=JSON.parse(a[1]),r=r.replace(s,"").trimEnd()}catch(l){console.error("Colophon: Failed to parse sidecar data",l)}return{markdown:r,data:n,frontmatter:t}}function nj(e,r,t=""){let n=t+e;if(r){let i=JSON.stringify(r,null,2);n=`${n.trimEnd()}

%% colophon:data ${i} %%`}return n}C_.exports={parseFile:rj,serializeFile:nj}});var R_=S((c$,P_)=>{var{FileView:ij,WorkspaceLeaf:l$,Notice:u$,debounce:M_}=require("obsidian"),A_=sp(),oj=E_(),{parseFile:sj,serializeFile:aj}=O_(),N_="colophon-view",Yh=class extends ij{constructor(r,t,n){super(r),this.plugin=n,this.settings=t||{textColumnWidth:1080},this.adapter=null,this.toolbar=null,this.data=null,this.markdownBody="",this.frontmatter="",this.themeToggleBtn=null,this.loaderEl=null,this.scrollEl=null,this.isForcedLight=!1,this.wordCountEl=null,this.save=M_(this.save.bind(this),1e3,!0),this.updateWordCount=M_(this.updateWordCount.bind(this),500,!1)}getViewType(){return N_}getDisplayText(){return this.file?this.file.basename:"No File"}getIcon(){return"feather"}async onOpen(){this.contentEl.empty(),this.contentEl.addClass("colophon-workspace"),this.applySettings();let r=this.containerEl.querySelector(".view-header");if(r){let n=r.querySelector(".view-header-center");if(!n){n=createDiv({cls:"view-header-center"});let i=r.querySelector(".view-actions");i?r.insertBefore(n,i):r.appendChild(n)}this.toolbar=new A_(n),this.toolbar.create()}else this.toolbar=new A_(this.contentEl),this.toolbar.create();this.scrollEl=this.contentEl.createDiv("colophon-scroll-container"),this.themeToggleBtn=this.addAction("sun-moon","Enable white canvas mode for this note",()=>{this.toggleTheme()}),this.showLoader();let t=this.app.vault.getConfig("spellcheck");this.adapter=new oj(this.app,this.scrollEl,this.toolbar,t,this.settings,n=>{this.data=n,this.save(),this.updateWordCount(),this.plugin.activateFootnoteView()}),this.plugin.settings.showWordCount&&this.toggleWordCount(!0),this.registerEvent(this.app.workspace.on("css-change",()=>{this.isForcedLight&&this.updateCanvasTheme()}))}onPaneMenu(r,t){super.onPaneMenu(r,t),r.addItem(n=>{n.setTitle("Export to Word (.docx)").setIcon("document").onClick(async()=>{this.plugin.exportToDocx(this)})}),r.addItem(n=>{n.setTitle("Show word count").setIcon("calculator").setChecked(this.plugin.settings.showWordCount).onClick(async()=>{this.plugin.settings.showWordCount=!this.plugin.settings.showWordCount,await this.plugin.saveSettings(),this.toggleWordCount(this.plugin.settings.showWordCount)})})}showLoader(){this.loaderEl||(this.loaderEl=this.contentEl.createDiv("colophon-loader"),this.loaderEl.createDiv("colophon-loader-spinner"),this.loaderEl.createSpan({text:"Loading Manuscript..."}))}hideLoader(){this.loaderEl&&(this.loaderEl.remove(),this.loaderEl=null)}toggleTheme(){this.isForcedLight=!this.isForcedLight,this.themeToggleBtn&&(this.themeToggleBtn.classList.toggle("is-active",this.isForcedLight),this.isForcedLight?this.themeToggleBtn.setAttribute("aria-label","Disable white canvas mode for this note"):this.themeToggleBtn.setAttribute("aria-label","Enable white canvas mode for this note")),this.updateCanvasTheme()}updateCanvasTheme(){let r=["--background-primary","--text-normal","--text-muted","--text-accent","--text-selection","--background-modifier-border"];if(this.isForcedLight){let t=this.extractThemeVars("theme-light");for(let[n,i]of Object.entries(t))i&&this.contentEl.style.setProperty(n,i);this.contentEl.classList.add("colophon-forced-theme")}else{for(let t of r)this.contentEl.style.removeProperty(t);this.contentEl.classList.remove("colophon-forced-theme")}}toggleWordCount(r){r?this.wordCountEl||(this.wordCountEl=this.contentEl.createDiv("colophon-word-count-indicator"),this.updateWordCount()):this.wordCountEl&&(this.wordCountEl.remove(),this.wordCountEl=null)}updateWordCount(){if(!this.wordCountEl||!this.adapter)return;let r=this.adapter.getWordCounts(),t=r.main+r.footnotes;this.wordCountEl.setText(`${r.main} / ${t} (with footnotes)`)}extractThemeVars(r){let t=document.createElement("div");t.classList.add(r),t.style.display="none",document.body.appendChild(t);let n=window.getComputedStyle(t),i={"--background-primary":n.getPropertyValue("--background-primary").trim(),"--text-normal":n.getPropertyValue("--text-normal").trim(),"--text-muted":n.getPropertyValue("--text-muted").trim(),"--text-accent":n.getPropertyValue("--text-accent").trim(),"--text-selection":n.getPropertyValue("--text-selection").trim(),"--background-modifier-border":n.getPropertyValue("--background-modifier-border").trim()};return document.body.removeChild(t),i}updateSettings(r){this.settings=r,this.applySettings(),this.adapter&&this.adapter.updateSettings(this.settings)}applySettings(){this.contentEl&&this.contentEl.style.setProperty("--colophon-editor-width",`${this.settings.textColumnWidth}px`)}async onClose(){if(this.toolbar){this.toolbar.destroy();let r=this.containerEl.querySelector(".view-header");if(r){let t=r.querySelector(".view-header-center");t&&t.remove()}}this.adapter&&this.adapter.destroy()}async onLoadFile(r){!this.loaderEl&&!this.adapter?.isLoaded&&this.showLoader();let t=await this.app.vault.read(r),{markdown:n,data:i,frontmatter:o}=sj(t);this.markdownBody=n,this.data=i,this.frontmatter=o,this.adapter&&(this.adapter.load(n,i,this.file.path),this.hideLoader())}async onUnloadFile(r){this.adapter}async save(){if(!this.file||!this.data)return;let r=aj(this.markdownBody,this.data,this.frontmatter);await this.app.vault.modify(this.file,r)}async insertFootnote(){if(this.adapter){let r=this.adapter.addFootnote();if(r){await this.plugin.activateFootnoteView();let t=this.app.workspace.getLeavesOfType("colophon-footnote-view");if(t.length>0){let n=t[0].view;n&&(n.render(),setTimeout(()=>{n.focusFootnote(r)},50))}}}}};P_.exports={ColophonView:Yh,VIEW_TYPE:N_}});var L_=S((m$,I_)=>{var{ItemView:lj,WorkspaceLeaf:f$,Notice:d$,setIcon:h$}=require("obsidian"),{Editor:uj,mergeAttributes:p$}=P(),{StarterKit:cj}=Uf(),fj=el(),{Subscript:dj}=Xf(),{Superscript:hj}=Qf(),pj=td(),mj=rd(),gj=id(),D_="colophon-footnote-view",Qh=class extends lj{constructor(r,t,n){super(r),this.settings=t||{smartQuotes:!0,smartDashes:!0,doubleQuoteStyle:"\u201C|\u201D",singleQuoteStyle:"\u2018|\u2019"},this.isSpellcheckEnabled=n,this.adapter=null,this.editors=new Map}getViewType(){return D_}getDisplayText(){return"Footnotes"}getIcon(){return"list-ordered"}async onOpen(){let r=this.contentEl;r.empty(),r.addClass("colophon-footnote-view"),this.render()}async onClose(){this.editors.forEach(r=>r.destroy()),this.editors.clear(),this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}updateSettings(r){this.settings=r,this.render(!0)}setAdapter(r){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),this.adapter=r,this.adapter&&(this.unsubscribe=this.adapter.subscribe(()=>{this.render()})),this.render()}render(r=!1){let t=this.contentEl;if(!this.adapter){t.empty(),this.editors.forEach(s=>s.destroy()),this.editors.clear(),t.createEl("div",{text:"No active manuscript.",cls:"colophon-footnote-empty"});return}let n=this.adapter.getFootnotes();if(!n||n.length===0){t.empty(),this.editors.forEach(s=>s.destroy()),this.editors.clear(),t.createEl("div",{text:"No footnotes yet.",cls:"colophon-footnote-empty"});return}let i=t.querySelector(".colophon-footnote-list");i||(t.empty(),i=t.createEl("div",{cls:"colophon-footnote-list"}));let o=new Set(n.map(s=>s.id));for(let[s,a]of this.editors)if(!o.has(s)||r){a.destroy(),this.editors.delete(s);let l=i.querySelector(`[data-footnote-id="${s}"]`);l&&l.remove()}n.forEach((s,a)=>{let l=i.querySelector(`[data-footnote-id="${s.id}"]`);if(l){let u=l.querySelector(".colophon-footnote-number");u&&(u.innerText=`${s.number||a+1}. `)}else{l=i.createEl("div",{cls:"colophon-footnote-item"}),l.dataset.footnoteId=s.id,l.createEl("div",{cls:"colophon-footnote-header"}).createSpan({text:`${s.number||a+1}. `,cls:"colophon-footnote-number"});let c=l.createEl("div",{cls:"colophon-footnote-editor-container"}),f=new uj({element:c,extensions:[cj,fj,dj,hj,pj,mj.configure({smartQuotes:this.settings.smartQuotes,smartDashes:this.settings.smartDashes,doubleQuoteStyle:this.settings.doubleQuoteStyle,singleQuoteStyle:this.settings.singleQuoteStyle}),gj.configure({app:this.app})],content:s.content,onUpdate:({editor:d})=>{this.adapter.updateFootnote(s.id,d.getJSON())},editorProps:{attributes:{class:"colophon-footnote-editor-content",spellcheck:this.isSpellcheckEnabled?"true":"false"}},onFocus:({editor:d})=>{this.adapter&&this.adapter.toolbar&&this.adapter.toolbar.setActiveEditor(d,!0)},onSelectionUpdate:({editor:d})=>{this.adapter&&this.adapter.toolbar&&this.adapter.toolbar.update()}});this.editors.set(s.id,f)}}),n.forEach(s=>{let a=i.querySelector(`[data-footnote-id="${s.id}"]`);a&&i.appendChild(a)})}focusFootnote(r){let t=this.editors.get(r);if(t){t.commands.focus();let n=this.contentEl.querySelector(`[data-footnote-id="${r}"]`);n&&n.scrollIntoView({behavior:"smooth",block:"center"})}}getFocusedEditor(){for(let r of this.editors.values())if(r.isFocused)return r;return null}};I_.exports={FootnoteView:Qh,FOOTNOTE_VIEW_TYPE:D_}});var B_=S((g$,F_)=>{var{Modal:vj,Setting:_i}=require("obsidian"),ep=class extends vj{constructor(r,t){super(r),this.onExport=t,this.settings={pageSize:"Letter",margins:{top:1,bottom:1,left:1,right:1},scale:100}}onOpen(){let{contentEl:r}=this;r.empty(),new _i(r).setName("Export to Word (.docx)").setHeading();let t=()=>void this.saveSettings();new _i(r).setName("Page size").setDesc("Select the page size for the exported document.").addDropdown(s=>{s.addOption("Letter",'Letter (8.5" x 11")').addOption("Legal",'Legal (8.5" x 14")').addOption("A1","A1 (210mm x 297mm").setValue(this.settings.pageSize).onChange(a=>{this.settings.pageSize=a})}),new _i(r).setName("Margins").setHeading();let n=new _i(r).setName("Margins (inches)");n.settingEl.addClass("colophon-export-margins");let i=n.controlEl.createDiv({cls:"colophon-export-margins__grid"}),o=(s,a)=>{let l=i.createDiv({cls:"colophon-export-margins__field"});l.createDiv({text:s,cls:"colophon-export-margins__label"});let u=l.createEl("input",{type:"number"});u.addClass("colophon-export-margins__input"),u.step="0.1",u.value=String(this.settings.margins?.[a]??1),u.addEventListener("change",()=>{let c=Number.parseFloat(u.value);Number.isFinite(c)&&(this.settings.margins[a]=c,t())})};o("Top","top"),o("Right","right"),o("Bottom","bottom"),o("Left","left"),new _i(r).setName("Scale (%)").setDesc("Adjust the font size scale for the exported document.").addSlider(s=>{s.setLimits(50,200,5).setValue(this.settings.scale).setDynamicTooltip().onChange(a=>{this.settings.scale=a,t()})}),new _i(r).setName("Export").setDesc("Generate a .docx using the settings above.").addButton(s=>{s.setButtonText("Export").setCta().onClick(()=>{this.close(),this.onExport(this.settings)})})}onClose(){let{contentEl:r}=this;r.empty()}};F_.exports=ep});var{Plugin:yj,TFolder:bj,Notice:nu,normalizePath:kj,WorkspaceLeaf:tp,PluginSettingTab:wj,Setting:zt}=require("obsidian"),{ColophonView:Lr,VIEW_TYPE:vn}=R_(),{FootnoteView:iu,FOOTNOTE_VIEW_TYPE:yn}=L_(),Sj=B_(),xj={textColumnWidth:1080,fixedFeedPosition:!1,feedPadding:50,smartQuotes:!0,smartDashes:!0,doubleQuoteStyle:"\u201C|\u201D",singleQuoteStyle:"\u2018|\u2019",stylesFolder:"snippets",enabledStyles:[],showWordCount:!1},v$=require("fs"),_j=require("electron");module.exports=class extends yj{async onload(){await this.loadSettings(),this.registerView(vn,t=>new Lr(t,this.settings,this));let r=this.app.vault.getConfig("spellcheck");this.registerView(yn,t=>new iu(t,this.settings,r)),this.addSettingTab(new rp(this.app,this)),this.patchOpenFile(),this.registerEvent(this.app.workspace.on("file-open",this.handleFileOpen.bind(this))),this.registerEvent(this.app.workspace.on("active-leaf-change",this.handleActiveLeafChange.bind(this))),this.addRibbonIcon("feather","New manuscript",async()=>{await this.createNewManuscript()}),this.registerEvent(this.app.workspace.on("file-menu",(t,n)=>{let o=n instanceof bj?n.path:n.parent.path;t.addItem(s=>{s.setTitle("New manuscript").setIcon("feather").onClick(async()=>{await this.createNewManuscript(o)})})})),this.addCommand({id:"create-new-colophon-manuscript",name:"New manuscript",callback:()=>this.createNewManuscript()}),this.addCommand({id:"export-to-docx",name:"Export to Word (.docx)",callback:()=>this.exportToDocx()}),this.addCommand({id:"open-colophon-footnotes",name:"Open Footnotes Sidebar",callback:async()=>{this.activateFootnoteView()}}),this.addCommand({id:"insert-colophon-footnote",name:"Insert Footnote",checkCallback:t=>{let n=this.app.workspace.getActiveViewOfType(Lr);return n?(t||n.insertFootnote(),!0):!1}}),this.app.workspace.onLayoutReady(()=>{let t=(n,i)=>{let o=this.app.commands.commands[n];if(o){let s=o.checkCallback;o.checkCallback=a=>{let l=this.app.workspace.getLeavesOfType(vn),u=l.length>0?l[0].view:null;if(u){let c=this.app.workspace.getLeavesOfType(yn)[0]?.view,f=null,d=this.app.workspace.activeLeaf;if(c&&c instanceof iu&&d.view===c){let h=c.getFocusedEditor();h&&(f=h)}if(!f&&u.adapter&&u.adapter.editor&&u.adapter.editor.isFocused&&(f=u.adapter.editor),f)return a||i(f),!0}return s?s(a):!1}}};t("editor:insert-footnote",n=>{let i=this.app.workspace.getActiveViewOfType(Lr);i&&i.insertFootnote()}),t("editor:toggle-bold",n=>n.chain().focus().toggleBold().run()),t("editor:toggle-italics",n=>n.chain().focus().toggleItalic().run()),t("editor:toggle-strikethrough",n=>n.chain().focus().toggleStrike().run())})}async exportToDocx(r){if(r||(r=this.app.workspace.getActiveViewOfType(Lr)),!r||!(r instanceof Lr)){new nu("No active Colophon editor found.");return}new Sj(this.app,t=>{this.performDocxExport(r,t)}).open()}async performDocxExport(r,t){if(!r||!r.adapter.editor){new nu("No active Colophon editor found.");return}let n=r.adapter.editor,i=this.app.workspace.getLeavesOfType(yn),o=i.length>0?i[0].view:null;n.commands.exportToDocx({settings:t,footnoteView:o,stylesConfig:r.adapter.styles})}async activateFootnoteView(){let{workspace:r}=this.app,t=null,n=r.getLeavesOfType(yn);n.length>0?t=n[0]:(t=r.getRightLeaf(!1),await t.setViewState({type:yn,active:!0})),r.revealLeaf(t)}async loadSettings(){this.settings=Object.assign({},xj,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.app.workspace.getLeavesOfType(vn).forEach(r=>{r.view instanceof Lr&&r.view.updateSettings(this.settings)}),this.app.workspace.getLeavesOfType(yn).forEach(r=>{r.view instanceof iu&&r.view.updateSettings(this.settings)})}patchOpenFile(){let r=this,t=tp.prototype.openFile;tp.prototype.openFile=async function(n,i){let s=(this.app||r.app).metadataCache.getFileCache(n);if(s?.frontmatter&&s.frontmatter["colophon-plugin"]==="manuscript"&&(this.view.getViewType()!==vn&&await this.setViewState({type:vn,state:i,active:!0}),this.view instanceof Lr)){await this.view.loadFile(n),i&&i.eState&&this.view.setEphemeralState(i.eState);return}return t.call(this,n,i)},this.register(()=>{tp.prototype.openFile=t})}async handleActiveLeafChange(r){if(!r)return;this.updateFootnoteView(r.view);let t=r.view.file;t&&await this.ensureCorrectView(r,t)}async handleFileOpen(r){if(!r)return;let t=this.app.workspace.activeLeaf;t&&(this.updateFootnoteView(t.view),await this.ensureCorrectView(t,r))}updateFootnoteView(r){let t=this.app.workspace.getLeavesOfType(yn);if(t.length===0)return;let n=t[0].view;if(typeof n.setAdapter!="function"){console.error("Colophon: FootnoteView instance does not have setAdapter method."),console.log("FootnoteView keys:",Object.keys(n)),console.log("FootnoteView prototype keys:",Object.getOwnPropertyNames(Object.getPrototypeOf(n))),console.log("FootnoteView constructor:",n.constructor.name);return}r instanceof iu||(r instanceof Lr&&r.adapter?n.setAdapter(r.adapter):n.setAdapter(null))}async ensureCorrectView(r,t){let n=this.app.metadataCache.getFileCache(t),i=n?.frontmatter&&n.frontmatter["colophon-plugin"]==="manuscript",o=r.view.getViewType();if(i&&o==="markdown"){let s=r.view.getState();await r.setViewState({type:vn,state:s,active:!0})}else if(!i&&o===vn){let s=r.view.getState();await r.setViewState({type:"markdown",state:s,active:!0})}}async createNewManuscript(r){let t;if(r?t=typeof r=="string"?this.app.vault.getAbstractFileByPath(r):r:t=this.app.fileManager.getNewFileParent(this.app.workspace.getActiveFile()?.path||""),!t||!t.path){new nu("Invalid folder location");return}let n=`---
colophon-plugin: manuscript
---
`,i=await this.getUniqueFilePath(t);try{let o=await this.app.vault.create(i,n);await this.app.workspace.getLeaf(!1).openFile(o)}catch(o){new nu(`Failed to create manuscript: ${o.toString()}`)}}async getUniqueFilePath(r){let t=0;for(;;){let i=`Untitled${t===0?"":` ${t}`}.md`,o=kj(`${r.path}/${i}`);if(!await this.app.vault.exists(o))return o;t++}}onunload(){}};var rp=class extends wj{constructor(r,t){super(r,t),this.plugin=t}display(){let{containerEl:r}=this;r.empty(),new zt(r).setName("Text column width").setDesc("Adjust the width of the writing canvas (500px - 1240px).").addSlider(t=>t.setLimits(500,1240,10).setValue(this.plugin.settings.textColumnWidth).setDynamicTooltip().onChange(async n=>{this.plugin.settings.textColumnWidth=n,await this.plugin.saveSettings()})),new zt(r).setName("Fixed feed position").setDesc("Enforce a typewriter-style fixed active line position.").addToggle(t=>t.setValue(this.plugin.settings.fixedFeedPosition).onChange(async n=>{this.plugin.settings.fixedFeedPosition=n,await this.plugin.saveSettings(),this.display()})),this.plugin.settings.fixedFeedPosition&&new zt(r).setName("Feed padding").setDesc("Vertical position of the active line (0% = bottom, 75% = top quarter).").addSlider(t=>t.setLimits(0,75,1).setValue(this.plugin.settings.feedPadding).setDynamicTooltip().onChange(async n=>{this.plugin.settings.feedPadding=n,await this.plugin.saveSettings()})),new zt(r).setName("Smart quotes").setDesc("Automatically replace straight quotes with smart quotes.").addToggle(t=>t.setValue(this.plugin.settings.smartQuotes).onChange(async n=>{this.plugin.settings.smartQuotes=n,await this.plugin.saveSettings(),this.display()})),this.plugin.settings.smartQuotes&&(new zt(r).setName("Double quote style").setDesc("Choose the style for double quotes.").addDropdown(t=>t.addOption("\u201C|\u201D","\u201Cabc\u201D").addOption("\u201E|\u201C","\u201Eabc\u201C").addOption("\u201E|\u201D","\u201Eabc\u201D").addOption("\u201D|\u201D","\u201Dabc\u201D").addOption("\xAB|\xBB","\xABabc\xBB").addOption("\xBB|\xAB","\xBBabc\xAB").addOption('"|"','"abc"').setValue(this.plugin.settings.doubleQuoteStyle).onChange(async n=>{this.plugin.settings.doubleQuoteStyle=n,await this.plugin.saveSettings()})),new zt(r).setName("Single quote style").setDesc("Choose the style for single quotes.").addDropdown(t=>t.addOption("\u2018|\u2019","\u2018abc\u2019").addOption("\u201A|\u2018","\u201Aabc\u2018").addOption("\u201A|\u2019","\u201Aabc\u2019").addOption("\u2019|\u2019","\u2019abc\u2019").addOption("\u2039|\u203A","\u2039abc\u203A").addOption("\u203A|\u2039","\u203Aabc\u2039").addOption("'|'","'abc'").setValue(this.plugin.settings.singleQuoteStyle).onChange(async n=>{this.plugin.settings.singleQuoteStyle=n,await this.plugin.saveSettings()}))),new zt(r).setName("Smart dashes").setDesc("Replace -- with em-dash (\u2014) and --- with en-dash (\u2013).").addToggle(t=>t.setValue(this.plugin.settings.smartDashes).onChange(async n=>{this.plugin.settings.smartDashes=n,await this.plugin.saveSettings()})),new zt(r).setName("Styles folder").setDesc("Folder containing YAML style definitions (relative to vault config directory).").addText(t=>t.setPlaceholder("snippets").setValue(this.plugin.settings.stylesFolder).onChange(async n=>{this.plugin.settings.stylesFolder=n,await this.plugin.saveSettings(),this.display()})).addExtraButton(t=>t.setIcon("folder-open").setTooltip("Open folder").onClick(()=>{let n=this.plugin.app.vault.adapter.getBasePath()+"/"+this.plugin.app.vault.configDir+"/"+this.plugin.settings.stylesFolder;_j.shell.openPath(n)})),this.displayStyleFiles(r)}async displayStyleFiles(r){let{app:t,settings:n}=this.plugin,i=t.vault.adapter,o=t.vault.configDir,s=n.stylesFolder||"snippets",a=`${o}/${s}`;if(!await i.exists(a)){new zt(r).setName("Folder not found").setDesc(`The folder "${a}" does not exist.`).addButton(f=>f.setButtonText("Create folder").onClick(async()=>{await i.mkdir(a),this.display()}));return}let u=(await i.list(a)).files.filter(f=>f.endsWith(".yaml")||f.endsWith(".yml"));if(u.length===0){r.createDiv({text:"No YAML files found in this folder.",cls:"setting-item-description"});return}let c=r.createDiv();c.style.marginTop="20px",c.style.marginBottom="10px",c.createEl("strong",{text:"Enabled Styles"});for(let f of u){let d=f.split("/").pop(),h=n.enabledStyles.includes(d);new zt(r).setName(d).addToggle(p=>p.setValue(h).onChange(async m=>{m?n.enabledStyles.includes(d)||n.enabledStyles.push(d):n.enabledStyles=n.enabledStyles.filter(v=>v!==d),await this.plugin.saveSettings()}))}}};
