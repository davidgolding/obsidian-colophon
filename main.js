var Id=Object.defineProperty;var v4=Object.getOwnPropertyDescriptor;var y4=Object.getOwnPropertyNames;var w4=Object.prototype.hasOwnProperty;var jt=(r,e)=>()=>(r&&(e=r(r=0)),e);var xe=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),b4=(r,e)=>{for(var t in e)Id(r,t,{get:e[t],enumerable:!0})},_4=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of y4(e))!w4.call(r,i)&&i!==t&&Id(r,i,{get:()=>e[i],enumerable:!(n=v4(e,i))||n.enumerable});return r};var x4=r=>_4(Id({},"__esModule",{value:!0}),r);var CT=xe((lQ,RT)=>{var{setIcon:Pd}=require("obsidian"),Dd=class{constructor(e){this.containerEl=e,this.editor=null,this.el=null,this.paragraphOptions=[],this.listOptions=[],this.update=this.update.bind(this)}create(){this.el=this.containerEl.createDiv("colophon-toolbar");let e=this.el.createDiv("colophon-toolbar-row");this.paragraphSelect=this.createDropdown(e,"Paragraph",[]),this.listSelect=this.createDropdown(e,"List",[]);let t=e.createDiv("colophon-btn-group");this.createButton(t,null,"Bold",()=>this.toggleMark("bold"),"isActive","bold","<strong>B</strong>"),this.createButton(t,null,"Italic",()=>this.toggleMark("italic"),"isActive","italic","<em>I</em>"),this.createButton(t,null,"Underline",()=>this.toggleMark("underline"),"isActive","underline","<u>U</u>"),this.createButton(t,null,"Strikethrough",()=>this.toggleMark("strike"),"isActive","strike","<s>S</s>"),this.createButton(t,"superscript","Superscript",()=>this.toggleMark("superscript"),"isActive","superscript"),this.createButton(t,"subscript","Subscript",()=>this.toggleMark("subscript"),"isActive","subscript"),this.createButton(t,"type","Small Caps",()=>this.toggleMark("smallCaps"),"isActive","smallCaps")}createDropdown(e,t,n){let i=e.createDiv({cls:"colophon-dropdown-wrapper",style:"position: relative;"}),s=i.createEl("button",{cls:"colophon-ui-btn colophon-dropdown-trigger"}),a=s.createSpan({text:t}),o=s.createSpan();Pd(o,"chevron-down");let l=i.createDiv("colophon-dropdown-menu");return l.style.display="none",l.style.top="100%",l.style.left="0",l.style.marginTop="4px",s.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),this.closeAllDropdowns(),l.style.display="block"}),document.addEventListener("click",u=>{!s.contains(u.target)&&!l.contains(u.target)&&(l.style.display="none")}),{trigger:s,labelSpan:a,dropdown:l,options:n}}closeAllDropdowns(){this.el.querySelectorAll(".colophon-dropdown-menu").forEach(e=>e.style.display="none"),this.el.querySelectorAll(".colophon-context-menu").forEach(e=>e.style.display="none")}createButton(e,t,n,i,s,a,o){let l=e.createEl("button",{cls:"colophon-ui-btn colophon-icon-only"});if(l.setAttribute("aria-label",n),o)l.innerHTML=o;else if(t){let u=l.createSpan();Pd(u,t)}return l.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),this.editor&&(i(),this.editor.commands.focus())}),l._checkState=()=>{this.editor&&s==="isActive"&&a&&(this.editor.isActive(a)?l.addClass("colophon-active"):l.removeClass("colophon-active"))},l}createContextMenu(e,t){let n=e.createDiv("colophon-context-menu");n.style.display="none",n.style.top="100%",n.style.left="0",n.style.marginTop="4px",this.createMenuItem(n,"table","Table",()=>{}),this.createMenuItem(n,"minus","Divider",()=>{this.editor&&this.editor.chain().focus().setHorizontalRule().run()}),this.createMenuItem(n,"image","Image",()=>{}),t.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation();let s=n.style.display==="block";this.closeAllDropdowns(),s||(n.style.display="block")})}createMenuItem(e,t,n,i){let s=e.createDiv("colophon-menu-item");s.createSpan({cls:"colophon-drag-handle",text:"\u22EE\u22EE"});let a=s.createSpan({cls:"colophon-icon"});Pd(a,t),s.createSpan({cls:"colophon-label",text:n}),s.addEventListener("click",o=>{o.preventDefault(),o.stopPropagation(),i(),e.style.display="none"})}setActiveEditor(e,t=!1){this.editor=e,this.isFootnote=t,this.update()}updateStyleOptions(e,t){this.paragraphOptions=e,this.listOptions=t,this.rebuildDropdowns()}rebuildDropdowns(){this.paragraphSelect.dropdown.empty(),this.paragraphOptions.forEach(e=>{let t=this.paragraphSelect.dropdown.createDiv("colophon-menu-item");t.createSpan({cls:"colophon-label",text:e.label}),t.addEventListener("click",()=>{this.applyStyle(e.value,e.type,e.listType),this.paragraphSelect.dropdown.style.display="none"})}),this.listSelect.dropdown.empty(),this.listOptions.forEach(e=>{let t=this.listSelect.dropdown.createDiv("colophon-menu-item");t.createSpan({cls:"colophon-label",text:e.label}),t.addEventListener("click",()=>{this.applyStyle(e.value,e.type,e.listType),this.listSelect.dropdown.style.display="none"})})}applyStyle(e,t,n){if(!this.editor)return;if(t==="list"){if(e==="none"){this.editor.chain().focus().liftListItem("listItem").run();return}n==="ordered"?this.editor.chain().focus().toggleOrderedList().updateAttributes("orderedList",{class:e}).run():this.editor.chain().focus().toggleBulletList().updateAttributes("bulletList",{class:e}).run();return}let i=!1,s=1;e&&(e.startsWith("heading-")||e==="title")&&(i=!0,e.startsWith("heading-")&&(s=parseInt(e.split("-")[1],10))),i?this.editor.chain().focus().toggleHeading({level:s}).updateAttributes("heading",{class:e}).run():this.editor.chain().focus().setParagraph().updateAttributes("paragraph",{class:e}).run()}toggleMark(e){this.editor&&(e==="bold"&&this.editor.chain().focus().toggleBold().run(),e==="italic"&&this.editor.chain().focus().toggleItalic().run(),e==="underline"&&this.editor.chain().focus().toggleUnderline().run(),e==="strike"&&this.editor.chain().focus().toggleStrike().run(),e==="superscript"&&this.editor.chain().focus().toggleSuperscript().run(),e==="subscript"&&this.editor.chain().focus().toggleSubscript().run(),e==="smallCaps"&&this.editor.chain().focus().toggleSmallCaps().run())}update(){if(!this.el)return;this.el.querySelectorAll(".colophon-ui-btn").forEach(t=>{t._checkState&&t._checkState()}),this.isFootnote?this.paragraphSelect&&(this.paragraphSelect.trigger.setAttribute("disabled","true"),this.paragraphSelect.trigger.addClass("colophon-disabled"),this.paragraphSelect.labelSpan.innerText="Footnote"):this.paragraphSelect&&(this.paragraphSelect.trigger.removeAttribute("disabled"),this.paragraphSelect.trigger.removeClass("colophon-disabled"),this.updateParagraphLabel()),this.updateListLabel()}updateParagraphLabel(){if(!this.editor||!this.paragraphSelect)return;let e="Paragraph";for(let t of this.paragraphOptions){let n=t.value;if(!n)continue;let i=!1;if(n.startsWith("heading-")||n==="title"?this.editor.isActive("heading",{class:n})&&(i=!0):this.editor.isActive("paragraph",{class:n})&&(i=!0),i){e=t.label;break}}this.paragraphSelect.labelSpan.innerText=e}updateListLabel(){if(!this.editor||!this.listSelect)return;let e="List";for(let t of this.listOptions){let n=t.value;if(n==="none")continue;let s=(t.listType||"unordered")==="ordered"?"orderedList":"bulletList";if(this.editor.isActive(s,{class:n})){e=t.label;break}}this.listSelect.labelSpan.innerText=e}destroy(){this.el&&this.el.remove()}};RT.exports=Dd});var PT=xe((uQ,IT)=>{"use strict";function kt(r){this.content=r}kt.prototype={constructor:kt,find:function(r){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===r)return e;return-1},get:function(r){var e=this.find(r);return e==-1?void 0:this.content[e+1]},update:function(r,e,t){var n=t&&t!=r?this.remove(t):this,i=n.find(r),s=n.content.slice();return i==-1?s.push(t||r,e):(s[i+1]=e,t&&(s[i]=t)),new kt(s)},remove:function(r){var e=this.find(r);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new kt(t)},addToStart:function(r,e){return new kt([r,e].concat(this.remove(r).content))},addToEnd:function(r,e){var t=this.remove(r).content.slice();return t.push(r,e),new kt(t)},addBefore:function(r,e,t){var n=this.remove(e),i=n.content.slice(),s=n.find(r);return i.splice(s==-1?i.length:s,0,e,t),new kt(i)},forEach:function(r){for(var e=0;e<this.content.length;e+=2)r(this.content[e],this.content[e+1])},prepend:function(r){return r=kt.from(r),r.size?new kt(r.content.concat(this.subtract(r).content)):this},append:function(r){return r=kt.from(r),r.size?new kt(this.subtract(r).content.concat(r.content)):this},subtract:function(r){var e=this;r=kt.from(r);for(var t=0;t<r.content.length;t+=2)e=e.remove(r.content[t]);return e},toObject:function(){var r={};return this.forEach(function(e,t){r[e]=t}),r},get size(){return this.content.length>>1}};kt.from=function(r){if(r instanceof kt)return r;var e=[];if(r)for(var t in r)e.push(t,r[t]);return new kt(e)};IT.exports=kt});var Ln=xe(Wt=>{"use strict";function E4(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=S4(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(u){throw u},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){t=t.call(r)},n:function(){var u=t.next();return s=u.done,u},e:function(u){a=!0,o=u},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(a)throw o}}}}function S4(r,e){if(r){if(typeof r=="string")return DT(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return DT(r,e)}}function DT(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Fl(){return typeof Reflect<"u"&&Reflect.get?Fl=Reflect.get.bind():Fl=function(e,t,n){var i=k4(e,t);if(i){var s=Object.getOwnPropertyDescriptor(i,t);return s.get?s.get.call(arguments.length<3?e:n):s.value}},Fl.apply(this,arguments)}function k4(r,e){for(;!Object.prototype.hasOwnProperty.call(r,e)&&(r=hi(r),r!==null););return r}function GT(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Eo(r,e)}function $T(r){var e=JT();return function(){var n=hi(r),i;if(e){var s=hi(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return T4(this,i)}}function T4(r,e){if(e&&(dr(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return A4(r)}function A4(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Fd(r){var e=typeof Map=="function"?new Map:void 0;return Fd=function(n){if(n===null||!O4(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,i)}function i(){return Bl(n,arguments,hi(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Eo(i,n)},Fd(r)}function Bl(r,e,t){return JT()?Bl=Reflect.construct.bind():Bl=function(i,s,a){var o=[null];o.push.apply(o,s);var l=Function.bind.apply(i,o),u=new l;return a&&Eo(u,a.prototype),u},Bl.apply(null,arguments)}function JT(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function O4(r){try{return Function.toString.call(r).indexOf("[native code]")!==-1}catch{return typeof r=="function"}}function Eo(r,e){return Eo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Eo(r,e)}function hi(r){return hi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hi(r)}function dr(r){"@babel/helpers - typeof";return dr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dr(r)}function ht(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function MT(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,N4(n.key),n)}}function dt(r,e,t){return e&&MT(r.prototype,e),t&&MT(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function N4(r){var e=R4(r,"string");return dr(e)==="symbol"?e:String(e)}function R4(r,e){if(dr(r)!=="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(dr(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var LT=PT();function XT(r,e,t){for(var n=0;;n++){if(n==r.childCount||n==e.childCount)return r.childCount==e.childCount?null:t;var i=r.child(n),s=e.child(n);if(i==s){t+=i.nodeSize;continue}if(!i.sameMarkup(s))return t;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)t++;return t}if(i.content.size||s.content.size){var o=XT(i.content,s.content,t+1);if(o!=null)return o}t+=i.nodeSize}}function YT(r,e,t,n){for(var i=r.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:t,b:n};var a=r.child(--i),o=e.child(--s),l=a.nodeSize;if(a==o){t-=l,n-=l;continue}if(!a.sameMarkup(o))return{a:t,b:n};if(a.isText&&a.text!=o.text){for(var u=0,c=Math.min(a.text.length,o.text.length);u<c&&a.text[a.text.length-u-1]==o.text[o.text.length-u-1];)u++,t--,n--;return{a:t,b:n}}if(a.content.size||o.content.size){var f=YT(a.content,o.content,t-1,n-1);if(f)return f}t-=l,n-=l}}var ft=(function(){function r(e,t){if(ht(this,r),this.content=e,this.size=t||0,t==null)for(var n=0;n<e.length;n++)this.size+=e[n].nodeSize}return dt(r,[{key:"nodesBetween",value:function(t,n,i){for(var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4?arguments[4]:void 0,o=0,l=0;l<n;o++){var u=this.content[o],c=l+u.nodeSize;if(c>t&&i(u,s+l,a||null,o)!==!1&&u.content.size){var f=l+1;u.nodesBetween(Math.max(0,t-f),Math.min(u.content.size,n-f),i,s+f)}l=c}}},{key:"descendants",value:function(t){this.nodesBetween(0,this.size,t)}},{key:"textBetween",value:function(t,n,i,s){var a="",o=!0;return this.nodesBetween(t,n,function(l,u){var c=l.isText?l.text.slice(Math.max(t,u)-u,n-u):l.isLeaf?s?typeof s=="function"?s(l):s:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&c||l.isTextblock)&&i&&(o?o=!1:a+=i),a+=c},0),a}},{key:"append",value:function(t){if(!t.size)return this;if(!this.size)return t;var n=this.lastChild,i=t.firstChild,s=this.content.slice(),a=0;for(n.isText&&n.sameMarkup(i)&&(s[s.length-1]=n.withText(n.text+i.text),a=1);a<t.content.length;a++)s.push(t.content[a]);return new r(s,this.size+t.size)}},{key:"cut",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.size;if(t==0&&n==this.size)return this;var i=[],s=0;if(n>t)for(var a=0,o=0;o<n;a++){var l=this.content[a],u=o+l.nodeSize;u>t&&((o<t||u>n)&&(l.isText?l=l.cut(Math.max(0,t-o),Math.min(l.text.length,n-o)):l=l.cut(Math.max(0,t-o-1),Math.min(l.content.size,n-o-1))),i.push(l),s+=l.nodeSize),o=u}return new r(i,s)}},{key:"cutByIndex",value:function(t,n){return t==n?r.empty:t==0&&n==this.content.length?this:new r(this.content.slice(t,n))}},{key:"replaceChild",value:function(t,n){var i=this.content[t];if(i==n)return this;var s=this.content.slice(),a=this.size+n.nodeSize-i.nodeSize;return s[t]=n,new r(s,a)}},{key:"addToStart",value:function(t){return new r([t].concat(this.content),this.size+t.nodeSize)}},{key:"addToEnd",value:function(t){return new r(this.content.concat(t),this.size+t.nodeSize)}},{key:"eq",value:function(t){if(this.content.length!=t.content.length)return!1;for(var n=0;n<this.content.length;n++)if(!this.content[n].eq(t.content[n]))return!1;return!0}},{key:"firstChild",get:function(){return this.content.length?this.content[0]:null}},{key:"lastChild",get:function(){return this.content.length?this.content[this.content.length-1]:null}},{key:"childCount",get:function(){return this.content.length}},{key:"child",value:function(t){var n=this.content[t];if(!n)throw new RangeError("Index "+t+" out of range for "+this);return n}},{key:"maybeChild",value:function(t){return this.content[t]||null}},{key:"forEach",value:function(t){for(var n=0,i=0;n<this.content.length;n++){var s=this.content[n];t(s,i,n),i+=s.nodeSize}}},{key:"findDiffStart",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return XT(this,t,n)}},{key:"findDiffEnd",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.size,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.size;return YT(this,t,n,i)}},{key:"findIndex",value:function(t){if(t==0)return Ml(0,t);if(t==this.size)return Ml(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position ".concat(t," outside of fragment (").concat(this,")"));for(var n=0,i=0;;n++){var s=this.child(n),a=i+s.nodeSize;if(a>=t)return a==t?Ml(n+1,a):Ml(n,i);i=a}}},{key:"toString",value:function(){return"<"+this.toStringInner()+">"}},{key:"toStringInner",value:function(){return this.content.join(", ")}},{key:"toJSON",value:function(){return this.content.length?this.content.map(function(t){return t.toJSON()}):null}}],[{key:"fromJSON",value:function(t,n){if(!n)return r.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new r(n.map(t.nodeFromJSON))}},{key:"fromArray",value:function(t){if(!t.length)return r.empty;for(var n,i=0,s=0;s<t.length;s++){var a=t[s];i+=a.nodeSize,s&&a.isText&&t[s-1].sameMarkup(a)?(n||(n=t.slice(0,s)),n[n.length-1]=a.withText(n[n.length-1].text+a.text)):n&&n.push(a)}return new r(n||t,i)}},{key:"from",value:function(t){if(!t)return r.empty;if(t instanceof r)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new r([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}]),r})();ft.empty=new ft([],0);var Md={index:0,offset:0};function Ml(r,e){return Md.index=r,Md.offset=e,Md}function Hl(r,e){if(r===e)return!0;if(!(r&&dr(r)=="object")||!(e&&dr(e)=="object"))return!1;var t=Array.isArray(r);if(Array.isArray(e)!=t)return!1;if(t){if(r.length!=e.length)return!1;for(var n=0;n<r.length;n++)if(!Hl(r[n],e[n]))return!1}else{for(var i in r)if(!(i in e)||!Hl(r[i],e[i]))return!1;for(var s in e)if(!(s in r))return!1}return!0}var Ge=(function(){function r(e,t){ht(this,r),this.type=e,this.attrs=t}return dt(r,[{key:"addToSet",value:function(t){for(var n,i=!1,s=0;s<t.length;s++){var a=t[s];if(this.eq(a))return t;if(this.type.excludes(a.type))n||(n=t.slice(0,s));else{if(a.type.excludes(this.type))return t;!i&&a.type.rank>this.type.rank&&(n||(n=t.slice(0,s)),n.push(this),i=!0),n&&n.push(a)}}return n||(n=t.slice()),i||n.push(this),n}},{key:"removeFromSet",value:function(t){for(var n=0;n<t.length;n++)if(this.eq(t[n]))return t.slice(0,n).concat(t.slice(n+1));return t}},{key:"isInSet",value:function(t){for(var n=0;n<t.length;n++)if(this.eq(t[n]))return!0;return!1}},{key:"eq",value:function(t){return this==t||this.type==t.type&&Hl(this.attrs,t.attrs)}},{key:"toJSON",value:function(){var t={type:this.type.name};for(var n in this.attrs){t.attrs=this.attrs;break}return t}}],[{key:"fromJSON",value:function(t,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");var i=t.marks[n.type];if(!i)throw new RangeError("There is no mark type ".concat(n.type," in this schema"));var s=i.create(n.attrs);return i.checkAttrs(s.attrs),s}},{key:"sameSet",value:function(t,n){if(t==n)return!0;if(t.length!=n.length)return!1;for(var i=0;i<t.length;i++)if(!t[i].eq(n[i]))return!1;return!0}},{key:"setFrom",value:function(t){if(!t||Array.isArray(t)&&t.length==0)return r.none;if(t instanceof r)return[t];var n=t.slice();return n.sort(function(i,s){return i.type.rank-s.type.rank}),n}}]),r})();Ge.none=[];var zl=(function(r){GT(t,r);var e=$T(t);function t(){return ht(this,t),e.apply(this,arguments)}return dt(t)})(Fd(Error)),rs=(function(){function r(e,t,n){ht(this,r),this.content=e,this.openStart=t,this.openEnd=n}return dt(r,[{key:"size",get:function(){return this.content.size-this.openStart-this.openEnd}},{key:"insertAt",value:function(t,n){var i=QT(this.content,t+this.openStart,n);return i&&new r(i,this.openStart,this.openEnd)}},{key:"removeBetween",value:function(t,n){return new r(ZT(this.content,t+this.openStart,n+this.openStart),this.openStart,this.openEnd)}},{key:"eq",value:function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}},{key:"toString",value:function(){return this.content+"("+this.openStart+","+this.openEnd+")"}},{key:"toJSON",value:function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}}],[{key:"fromJSON",value:function(t,n){if(!n)return r.empty;var i=n.openStart||0,s=n.openEnd||0;if(typeof i!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new r(ft.fromJSON(t,n.content),i,s)}},{key:"maxOpen",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=0,s=0,a=t.firstChild;a&&!a.isLeaf&&(n||!a.type.spec.isolating);a=a.firstChild)i++;for(var o=t.lastChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.lastChild)s++;return new r(t,i,s)}}]),r})();rs.empty=new rs(ft.empty,0,0);function ZT(r,e,t){var n=r.findIndex(e),i=n.index,s=n.offset,a=r.maybeChild(i),o=r.findIndex(t),l=o.index,u=o.offset;if(s==e||a.isText){if(u!=t&&!r.child(l).isText)throw new RangeError("Removing non-flat range");return r.cut(0,e).append(r.cut(t))}if(i!=l)throw new RangeError("Removing non-flat range");return r.replaceChild(i,a.copy(ZT(a.content,e-s-1,t-s-1)))}function QT(r,e,t,n){var i=r.findIndex(e),s=i.index,a=i.offset,o=r.maybeChild(s);if(a==e||o.isText)return n&&!n.canReplace(s,s,t)?null:r.cut(0,e).append(t).append(r.cut(e));var l=QT(o.content,e-a-1,t,o);return l&&r.replaceChild(s,o.copy(l))}function C4(r,e,t){if(t.openStart>r.depth)throw new zl("Inserted content deeper than insertion position");if(r.depth-t.openStart!=e.depth-t.openEnd)throw new zl("Inconsistent open depths");return eA(r,e,t,0)}function eA(r,e,t,n){var i=r.index(n),s=r.node(n);if(i==e.index(n)&&n<r.depth-t.openStart){var a=eA(r,e,t,n+1);return s.copy(s.content.replaceChild(i,a))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&r.depth==n&&e.depth==n){var o=r.parent,l=o.content;return ci(o,l.cut(0,r.parentOffset).append(t.content).append(l.cut(e.parentOffset)))}else{var u=I4(t,r),c=u.start,f=u.end;return ci(s,rA(r,c,f,e,n))}else return ci(s,jl(r,e,n))}function tA(r,e){if(!e.type.compatibleContent(r.type))throw new zl("Cannot join "+e.type.name+" onto "+r.type.name)}function Bd(r,e,t){var n=r.node(t);return tA(n,e.node(t)),n}function ui(r,e){var t=e.length-1;t>=0&&r.isText&&r.sameMarkup(e[t])?e[t]=r.withText(e[t].text+r.text):e.push(r)}function _o(r,e,t,n){var i=(e||r).node(t),s=0,a=e?e.index(t):i.childCount;r&&(s=r.index(t),r.depth>t?s++:r.textOffset&&(ui(r.nodeAfter,n),s++));for(var o=s;o<a;o++)ui(i.child(o),n);e&&e.depth==t&&e.textOffset&&ui(e.nodeBefore,n)}function ci(r,e){return r.type.checkContent(e),r.copy(e)}function rA(r,e,t,n,i){var s=r.depth>i&&Bd(r,e,i+1),a=n.depth>i&&Bd(t,n,i+1),o=[];return _o(null,r,i,o),s&&a&&e.index(i)==t.index(i)?(tA(s,a),ui(ci(s,rA(r,e,t,n,i+1)),o)):(s&&ui(ci(s,jl(r,e,i+1)),o),_o(e,t,i,o),a&&ui(ci(a,jl(t,n,i+1)),o)),_o(n,null,i,o),new ft(o)}function jl(r,e,t){var n=[];if(_o(null,r,t,n),r.depth>t){var i=Bd(r,e,t+1);ui(ci(i,jl(r,e,t+1)),n)}return _o(e,null,t,n),new ft(n)}function I4(r,e){for(var t=e.depth-r.openStart,n=e.node(t),i=n.copy(r.content),s=t-1;s>=0;s--)i=e.node(s).copy(ft.from(i));return{start:i.resolveNoCache(r.openStart+t),end:i.resolveNoCache(i.content.size-r.openEnd-t)}}var Ud=(function(){function r(e,t,n){ht(this,r),this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}return dt(r,[{key:"resolveDepth",value:function(t){return t==null?this.depth:t<0?this.depth+t:t}},{key:"parent",get:function(){return this.node(this.depth)}},{key:"doc",get:function(){return this.node(0)}},{key:"node",value:function(t){return this.path[this.resolveDepth(t)*3]}},{key:"index",value:function(t){return this.path[this.resolveDepth(t)*3+1]}},{key:"indexAfter",value:function(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}},{key:"start",value:function(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}},{key:"end",value:function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}},{key:"before",value:function(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}},{key:"after",value:function(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}},{key:"textOffset",get:function(){return this.pos-this.path[this.path.length-1]}},{key:"nodeAfter",get:function(){var t=this.parent,n=this.index(this.depth);if(n==t.childCount)return null;var i=this.pos-this.path[this.path.length-1],s=t.child(n);return i?t.child(n).cut(i):s}},{key:"nodeBefore",get:function(){var t=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(t).cut(0,n):t==0?null:this.parent.child(t-1)}},{key:"posAtIndex",value:function(t,n){n=this.resolveDepth(n);for(var i=this.path[n*3],s=n==0?0:this.path[n*3-1]+1,a=0;a<t;a++)s+=i.child(a).nodeSize;return s}},{key:"marks",value:function(){var t=this.parent,n=this.index();if(t.content.size==0)return Ge.none;if(this.textOffset)return t.child(n).marks;var i=t.maybeChild(n-1),s=t.maybeChild(n);if(!i){var a=i;i=s,s=a}for(var o=i.marks,l=0;l<o.length;l++)o[l].type.spec.inclusive===!1&&(!s||!o[l].isInSet(s.marks))&&(o=o[l--].removeFromSet(o));return o}},{key:"marksAcross",value:function(t){var n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;for(var i=n.marks,s=t.parent.maybeChild(t.index()),a=0;a<i.length;a++)i[a].type.spec.inclusive===!1&&(!s||!i[a].isInSet(s.marks))&&(i=i[a--].removeFromSet(i));return i}},{key:"sharedDepth",value:function(t){for(var n=this.depth;n>0;n--)if(this.start(n)<=t&&this.end(n)>=t)return n;return 0}},{key:"blockRange",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=arguments.length>1?arguments[1]:void 0;if(t.pos<this.pos)return t.blockRange(this);for(var i=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);i>=0;i--)if(t.pos<=this.end(i)&&(!n||n(this.node(i))))return new nA(this,t,i);return null}},{key:"sameParent",value:function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}},{key:"max",value:function(t){return t.pos>this.pos?t:this}},{key:"min",value:function(t){return t.pos<this.pos?t:this}},{key:"toString",value:function(){for(var t="",n=1;n<=this.depth;n++)t+=(t?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return t+":"+this.parentOffset}}],[{key:"resolve",value:function(t,n){if(!(n>=0&&n<=t.content.size))throw new RangeError("Position "+n+" out of range");for(var i=[],s=0,a=n,o=t;;){var l=o.content.findIndex(a),u=l.index,c=l.offset,f=a-c;if(i.push(o,u,s+c),!f||(o=o.child(u),o.isText))break;a=f-1,s+=c+1}return new r(n,i,a)}},{key:"resolveCached",value:function(t,n){var i=FT.get(t);if(i)for(var s=0;s<i.elts.length;s++){var a=i.elts[s];if(a.pos==n)return a}else FT.set(t,i=new P4);var o=i.elts[i.i]=r.resolve(t,n);return i.i=(i.i+1)%D4,o}}]),r})(),P4=dt(function r(){ht(this,r),this.elts=[],this.i=0}),D4=12,FT=new WeakMap,nA=(function(){function r(e,t,n){ht(this,r),this.$from=e,this.$to=t,this.depth=n}return dt(r,[{key:"start",get:function(){return this.$from.before(this.depth+1)}},{key:"end",get:function(){return this.$to.after(this.depth+1)}},{key:"parent",get:function(){return this.$from.node(this.depth)}},{key:"startIndex",get:function(){return this.$from.index(this.depth)}},{key:"endIndex",get:function(){return this.$to.indexAfter(this.depth)}}]),r})(),M4=Object.create(null),fi=(function(){function r(e,t,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ge.none;ht(this,r),this.type=e,this.attrs=t,this.marks=i,this.content=n||ft.empty}return dt(r,[{key:"children",get:function(){return this.content.content}},{key:"nodeSize",get:function(){return this.isLeaf?1:2+this.content.size}},{key:"childCount",get:function(){return this.content.childCount}},{key:"child",value:function(t){return this.content.child(t)}},{key:"maybeChild",value:function(t){return this.content.maybeChild(t)}},{key:"forEach",value:function(t){this.content.forEach(t)}},{key:"nodesBetween",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;this.content.nodesBetween(t,n,i,s,this)}},{key:"descendants",value:function(t){this.nodesBetween(0,this.content.size,t)}},{key:"textContent",get:function(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}},{key:"textBetween",value:function(t,n,i,s){return this.content.textBetween(t,n,i,s)}},{key:"firstChild",get:function(){return this.content.firstChild}},{key:"lastChild",get:function(){return this.content.lastChild}},{key:"eq",value:function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}},{key:"sameMarkup",value:function(t){return this.hasMarkup(t.type,t.attrs,t.marks)}},{key:"hasMarkup",value:function(t,n,i){return this.type==t&&Hl(this.attrs,n||t.defaultAttrs||M4)&&Ge.sameSet(this.marks,i||Ge.none)}},{key:"copy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return t==this.content?this:new r(this.type,this.attrs,t,this.marks)}},{key:"mark",value:function(t){return t==this.marks?this:new r(this.type,this.attrs,this.content,t)}},{key:"cut",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.content.size;return t==0&&n==this.content.size?this:this.copy(this.content.cut(t,n))}},{key:"slice",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.content.size,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(t==n)return rs.empty;var s=this.resolve(t),a=this.resolve(n),o=i?0:s.sharedDepth(n),l=s.start(o),u=s.node(o),c=u.content.cut(s.pos-l,a.pos-l);return new rs(c,s.depth-o,a.depth-o)}},{key:"replace",value:function(t,n,i){return C4(this.resolve(t),this.resolve(n),i)}},{key:"nodeAt",value:function(t){for(var n=this;;){var i=n.content.findIndex(t),s=i.index,a=i.offset;if(n=n.maybeChild(s),!n)return null;if(a==t||n.isText)return n;t-=a+1}}},{key:"childAfter",value:function(t){var n=this.content.findIndex(t),i=n.index,s=n.offset;return{node:this.content.maybeChild(i),index:i,offset:s}}},{key:"childBefore",value:function(t){if(t==0)return{node:null,index:0,offset:0};var n=this.content.findIndex(t),i=n.index,s=n.offset;if(s<t)return{node:this.content.child(i),index:i,offset:s};var a=this.content.child(i-1);return{node:a,index:i-1,offset:s-a.nodeSize}}},{key:"resolve",value:function(t){return Ud.resolveCached(this,t)}},{key:"resolveNoCache",value:function(t){return Ud.resolve(this,t)}},{key:"rangeHasMark",value:function(t,n,i){var s=!1;return n>t&&this.nodesBetween(t,n,function(a){return i.isInSet(a.marks)&&(s=!0),!s}),s}},{key:"isBlock",get:function(){return this.type.isBlock}},{key:"isTextblock",get:function(){return this.type.isTextblock}},{key:"inlineContent",get:function(){return this.type.inlineContent}},{key:"isInline",get:function(){return this.type.isInline}},{key:"isText",get:function(){return this.type.isText}},{key:"isLeaf",get:function(){return this.type.isLeaf}},{key:"isAtom",get:function(){return this.type.isAtom}},{key:"toString",value:function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),iA(this.marks,t)}},{key:"contentMatchAt",value:function(t){var n=this.type.contentMatch.matchFragment(this.content,0,t);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}},{key:"canReplace",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ft.empty,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:i.childCount,o=this.contentMatchAt(t).matchFragment(i,s,a),l=o&&o.matchFragment(this.content,n);if(!l||!l.validEnd)return!1;for(var u=s;u<a;u++)if(!this.type.allowsMarks(i.child(u).marks))return!1;return!0}},{key:"canReplaceWith",value:function(t,n,i,s){if(s&&!this.type.allowsMarks(s))return!1;var a=this.contentMatchAt(t).matchType(i),o=a&&a.matchFragment(this.content,n);return o?o.validEnd:!1}},{key:"canAppend",value:function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}},{key:"check",value:function(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);for(var t=Ge.none,n=0;n<this.marks.length;n++){var i=this.marks[n];i.type.checkAttrs(i.attrs),t=i.addToSet(t)}if(!Ge.sameSet(t,this.marks))throw new RangeError("Invalid collection of marks for node ".concat(this.type.name,": ").concat(this.marks.map(function(s){return s.type.name})));this.content.forEach(function(s){return s.check()})}},{key:"toJSON",value:function(){var t={type:this.type.name};for(var n in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(function(i){return i.toJSON()})),t}}],[{key:"fromJSON",value:function(t,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");var i=void 0;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");i=n.marks.map(t.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(n.text,i)}var s=ft.fromJSON(t,n.content),a=t.nodeType(n.type).create(n.attrs,s,i);return a.type.checkAttrs(a.attrs),a}}]),r})();fi.prototype.text=void 0;var L4=(function(r){GT(t,r);var e=$T(t);function t(n,i,s,a){var o;if(ht(this,t),o=e.call(this,n,i,null,a),!s)throw new RangeError("Empty text nodes are not allowed");return o.text=s,o}return dt(t,[{key:"toString",value:function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):iA(this.marks,JSON.stringify(this.text))}},{key:"textContent",get:function(){return this.text}},{key:"textBetween",value:function(i,s){return this.text.slice(i,s)}},{key:"nodeSize",get:function(){return this.text.length}},{key:"mark",value:function(i){return i==this.marks?this:new t(this.type,this.attrs,this.text,i)}},{key:"withText",value:function(i){return i==this.text?this:new t(this.type,this.attrs,i,this.marks)}},{key:"cut",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.text.length;return i==0&&s==this.text.length?this:this.withText(this.text.slice(i,s))}},{key:"eq",value:function(i){return this.sameMarkup(i)&&this.text==i.text}},{key:"toJSON",value:function(){var i=Fl(hi(t.prototype),"toJSON",this).call(this);return i.text=this.text,i}}]),t})(fi);function iA(r,e){for(var t=r.length-1;t>=0;t--)e=r[t].type.name+"("+e+")";return e}var ns=(function(){function r(e){ht(this,r),this.validEnd=e,this.next=[],this.wrapCache=[]}return dt(r,[{key:"matchType",value:function(t){for(var n=0;n<this.next.length;n++)if(this.next[n].type==t)return this.next[n].next;return null}},{key:"matchFragment",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.childCount,s=this,a=n;s&&a<i;a++)s=s.matchType(t.child(a).type);return s}},{key:"inlineContent",get:function(){return this.next.length!=0&&this.next[0].type.isInline}},{key:"defaultType",get:function(){for(var t=0;t<this.next.length;t++){var n=this.next[t].type;if(!(n.isText||n.hasRequiredAttrs()))return n}return null}},{key:"compatible",value:function(t){for(var n=0;n<this.next.length;n++)for(var i=0;i<t.next.length;i++)if(this.next[n].type==t.next[i].type)return!0;return!1}},{key:"fillBefore",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=[this];function a(o,l){var u=o.matchFragment(t,i);if(u&&(!n||u.validEnd))return ft.from(l.map(function(v){return v.createAndFill()}));for(var c=0;c<o.next.length;c++){var f=o.next[c],d=f.type,h=f.next;if(!(d.isText||d.hasRequiredAttrs())&&s.indexOf(h)==-1){s.push(h);var y=a(h,l.concat(d));if(y)return y}}return null}return a(this,[])}},{key:"findWrapping",value:function(t){for(var n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==t)return this.wrapCache[n+1];var i=this.computeWrapping(t);return this.wrapCache.push(t,i),i}},{key:"computeWrapping",value:function(t){for(var n=Object.create(null),i=[{match:this,type:null,via:null}];i.length;){var s=i.shift(),a=s.match;if(a.matchType(t)){for(var o=[],l=s;l.type;l=l.via)o.push(l.type);return o.reverse()}for(var u=0;u<a.next.length;u++){var c=a.next[u],f=c.type,d=c.next;!f.isLeaf&&!f.hasRequiredAttrs()&&!(f.name in n)&&(!s.type||d.validEnd)&&(i.push({match:f.contentMatch,type:f,via:s}),n[f.name]=!0)}}return null}},{key:"edgeCount",get:function(){return this.next.length}},{key:"edge",value:function(t){if(t>=this.next.length)throw new RangeError("There's no ".concat(t,"th edge in this content match"));return this.next[t]}},{key:"toString",value:function(){var t=[];function n(i){t.push(i);for(var s=0;s<i.next.length;s++)t.indexOf(i.next[s].next)==-1&&n(i.next[s].next)}return n(this),t.map(function(i,s){for(var a=s+(i.validEnd?"*":" ")+" ",o=0;o<i.next.length;o++)a+=(o?", ":"")+i.next[o].type.name+"->"+t.indexOf(i.next[o].next);return a}).join(`
`)}}],[{key:"parse",value:function(t,n){var i=new F4(t,n);if(i.next==null)return r.empty;var s=sA(i);i.next&&i.err("Unexpected trailing text");var a=q4(W4(s));return V4(a,i),a}}]),r})();ns.empty=new ns(!0);var F4=(function(){function r(e,t){ht(this,r),this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}return dt(r,[{key:"next",get:function(){return this.tokens[this.pos]}},{key:"eat",value:function(t){return this.next==t&&(this.pos++||!0)}},{key:"err",value:function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}]),r})();function sA(r){var e=[];do e.push(B4(r));while(r.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function B4(r){var e=[];do e.push(U4(r));while(r.next&&r.next!=")"&&r.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function U4(r){for(var e=j4(r);;)if(r.eat("+"))e={type:"plus",expr:e};else if(r.eat("*"))e={type:"star",expr:e};else if(r.eat("?"))e={type:"opt",expr:e};else if(r.eat("{"))e=H4(r,e);else break;return e}function BT(r){/\D/.test(r.next)&&r.err("Expected number, got '"+r.next+"'");var e=Number(r.next);return r.pos++,e}function H4(r,e){var t=BT(r),n=t;return r.eat(",")&&(r.next!="}"?n=BT(r):n=-1),r.eat("}")||r.err("Unclosed braced range"),{type:"range",min:t,max:n,expr:e}}function z4(r,e){var t=r.nodeTypes,n=t[e];if(n)return[n];var i=[];for(var s in t){var a=t[s];a.isInGroup(e)&&i.push(a)}return i.length==0&&r.err("No node type or group '"+e+"' found"),i}function j4(r){if(r.eat("(")){var e=sA(r);return r.eat(")")||r.err("Missing closing paren"),e}else if(/\W/.test(r.next))r.err("Unexpected token '"+r.next+"'");else{var t=z4(r,r.next).map(function(n){return r.inline==null?r.inline=n.isInline:r.inline!=n.isInline&&r.err("Mixing inline and block content"),{type:"name",value:n}});return r.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function W4(r){var e=[[]];return i(s(r,0),t()),e;function t(){return e.push([])-1}function n(a,o,l){var u={term:l,to:o};return e[a].push(u),u}function i(a,o){a.forEach(function(l){return l.to=o})}function s(a,o){if(a.type=="choice")return a.exprs.reduce(function(m,_){return m.concat(s(_,o))},[]);if(a.type=="seq")for(var l=0;;l++){var u=s(a.exprs[l],o);if(l==a.exprs.length-1)return u;i(u,o=t())}else if(a.type=="star"){var c=t();return n(o,c),i(s(a.expr,c),c),[n(c)]}else if(a.type=="plus"){var f=t();return i(s(a.expr,o),f),i(s(a.expr,f),f),[n(f)]}else{if(a.type=="opt")return[n(o)].concat(s(a.expr,o));if(a.type=="range"){for(var d=o,h=0;h<a.min;h++){var y=t();i(s(a.expr,d),y),d=y}if(a.max==-1)i(s(a.expr,d),d);else for(var v=a.min;v<a.max;v++){var x=t();n(d,x),i(s(a.expr,d),x),d=x}return[n(d)]}else{if(a.type=="name")return[n(o,void 0,a.value)];throw new Error("Unknown expr type")}}}}function oA(r,e){return e-r}function UT(r,e){var t=[];return n(e),t.sort(oA);function n(i){var s=r[i];if(s.length==1&&!s[0].term)return n(s[0].to);t.push(i);for(var a=0;a<s.length;a++){var o=s[a],l=o.term,u=o.to;!l&&t.indexOf(u)==-1&&n(u)}}}function q4(r){var e=Object.create(null);return t(UT(r,0));function t(n){var i=[];n.forEach(function(l){r[l].forEach(function(u){var c=u.term,f=u.to;if(c){for(var d,h=0;h<i.length;h++)i[h][0]==c&&(d=i[h][1]);UT(r,f).forEach(function(y){d||i.push([c,d=[]]),d.indexOf(y)==-1&&d.push(y)})}})});for(var s=e[n.join(",")]=new ns(n.indexOf(r.length-1)>-1),a=0;a<i.length;a++){var o=i[a][1].sort(oA);s.next.push({type:i[a][0],next:e[o.join(",")]||t(o)})}return s}}function V4(r,e){for(var t=0,n=[r];t<n.length;t++){for(var i=n[t],s=!i.validEnd,a=[],o=0;o<i.next.length;o++){var l=i.next[o],u=l.type,c=l.next;a.push(u.name),s&&!(u.isText||u.hasRequiredAttrs())&&(s=!1),n.indexOf(c)==-1&&n.push(c)}s&&e.err("Only non-generatable nodes ("+a.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function aA(r){var e=Object.create(null);for(var t in r){var n=r[t];if(!n.hasDefault)return null;e[t]=n.default}return e}function lA(r,e){var t=Object.create(null);for(var n in r){var i=e&&e[n];if(i===void 0){var s=r[n];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+n)}t[n]=i}return t}function uA(r,e,t,n){for(var i in e)if(!(i in r))throw new RangeError("Unsupported attribute ".concat(i," for ").concat(t," of type ").concat(i));for(var s in r){var a=r[s];a.validate&&a.validate(e[s])}}function cA(r,e){var t=Object.create(null);if(e)for(var n in e)t[n]=new G4(r,n,e[n]);return t}var Hd=(function(){function r(e,t,n){ht(this,r),this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=cA(e,n.attrs),this.defaultAttrs=aA(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||e=="text"),this.isText=e=="text"}return dt(r,[{key:"isInline",get:function(){return!this.isBlock}},{key:"isTextblock",get:function(){return this.isBlock&&this.inlineContent}},{key:"isLeaf",get:function(){return this.contentMatch==ns.empty}},{key:"isAtom",get:function(){return this.isLeaf||!!this.spec.atom}},{key:"isInGroup",value:function(t){return this.groups.indexOf(t)>-1}},{key:"whitespace",get:function(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}},{key:"hasRequiredAttrs",value:function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}},{key:"compatibleContent",value:function(t){return this==t||this.contentMatch.compatible(t.contentMatch)}},{key:"computeAttrs",value:function(t){return!t&&this.defaultAttrs?this.defaultAttrs:lA(this.attrs,t)}},{key:"create",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new fi(this,this.computeAttrs(t),ft.from(n),Ge.setFrom(i))}},{key:"createChecked",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return n=ft.from(n),this.checkContent(n),new fi(this,this.computeAttrs(t),n,Ge.setFrom(i))}},{key:"createAndFill",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;if(t=this.computeAttrs(t),n=ft.from(n),n.size){var s=this.contentMatch.fillBefore(n);if(!s)return null;n=s.append(n)}var a=this.contentMatch.matchFragment(n),o=a&&a.fillBefore(ft.empty,!0);return o?new fi(this,t,n.append(o),Ge.setFrom(i)):null}},{key:"validContent",value:function(t){var n=this.contentMatch.matchFragment(t);if(!n||!n.validEnd)return!1;for(var i=0;i<t.childCount;i++)if(!this.allowsMarks(t.child(i).marks))return!1;return!0}},{key:"checkContent",value:function(t){if(!this.validContent(t))throw new RangeError("Invalid content for node ".concat(this.name,": ").concat(t.toString().slice(0,50)))}},{key:"checkAttrs",value:function(t){uA(this.attrs,t,"node",this.name)}},{key:"allowsMarkType",value:function(t){return this.markSet==null||this.markSet.indexOf(t)>-1}},{key:"allowsMarks",value:function(t){if(this.markSet==null)return!0;for(var n=0;n<t.length;n++)if(!this.allowsMarkType(t[n].type))return!1;return!0}},{key:"allowedMarks",value:function(t){if(this.markSet==null)return t;for(var n,i=0;i<t.length;i++)this.allowsMarkType(t[i].type)?n&&n.push(t[i]):n||(n=t.slice(0,i));return n?n.length?n:Ge.none:t}}],[{key:"compile",value:function(t,n){var i=Object.create(null);t.forEach(function(o,l){return i[o]=new r(o,n,l)});var s=n.spec.topNode||"doc";if(!i[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!i.text)throw new RangeError("Every schema needs a 'text' type");for(var a in i.text.attrs)throw new RangeError("The text node type should not have attributes");return i}}]),r})();function K4(r,e,t){var n=t.split("|");return function(i){var s=i===null?"null":dr(i);if(n.indexOf(s)<0)throw new RangeError("Expected value of type ".concat(n," for attribute ").concat(e," on type ").concat(r,", got ").concat(s))}}var G4=(function(){function r(e,t,n){ht(this,r),this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?K4(e,t,n.validate):n.validate}return dt(r,[{key:"isRequired",get:function(){return!this.hasDefault}}]),r})(),fA=(function(){function r(e,t,n,i){ht(this,r),this.name=e,this.rank=t,this.schema=n,this.spec=i,this.attrs=cA(e,i.attrs),this.excluded=null;var s=aA(this.attrs);this.instance=s?new Ge(this,s):null}return dt(r,[{key:"create",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return!t&&this.instance?this.instance:new Ge(this,lA(this.attrs,t))}},{key:"removeFromSet",value:function(t){for(var n=0;n<t.length;n++)t[n].type==this&&(t=t.slice(0,n).concat(t.slice(n+1)),n--);return t}},{key:"isInSet",value:function(t){for(var n=0;n<t.length;n++)if(t[n].type==this)return t[n]}},{key:"checkAttrs",value:function(t){uA(this.attrs,t,"mark",this.name)}},{key:"excludes",value:function(t){return this.excluded.indexOf(t)>-1}}],[{key:"compile",value:function(t,n){var i=Object.create(null),s=0;return t.forEach(function(a,o){return i[a]=new r(a,s++,n,o)}),i}}]),r})(),$4=(function(){function r(e){var t=this;ht(this,r),this.linebreakReplacement=null,this.cached=Object.create(null);var n=this.spec={};for(var i in e)n[i]=e[i];n.nodes=LT.from(e.nodes),n.marks=LT.from(e.marks||{}),this.nodes=Hd.compile(this.spec.nodes,this),this.marks=fA.compile(this.spec.marks,this);var s=Object.create(null);for(var a in this.nodes){if(a in this.marks)throw new RangeError(a+" can not be both a node and a mark");var o=this.nodes[a],l=o.spec.content||"",u=o.spec.marks;if(o.contentMatch=s[l]||(s[l]=ns.parse(l,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=u=="_"?null:u?HT(this,u.split(" ")):u==""||!o.inlineContent?[]:null}for(var c in this.marks){var f=this.marks[c],d=f.spec.excludes;f.excluded=d==null?[f]:d==""?[]:HT(this,d.split(" "))}this.nodeFromJSON=function(h){return fi.fromJSON(t,h)},this.markFromJSON=function(h){return Ge.fromJSON(t,h)},this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}return dt(r,[{key:"node",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;if(typeof t=="string")t=this.nodeType(t);else if(t instanceof Hd){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(n,i,s)}},{key:"text",value:function(t,n){var i=this.nodes.text;return new L4(i,i.defaultAttrs,t,Ge.setFrom(n))}},{key:"mark",value:function(t,n){return typeof t=="string"&&(t=this.marks[t]),t.create(n)}},{key:"nodeType",value:function(t){var n=this.nodes[t];if(!n)throw new RangeError("Unknown node type: "+t);return n}}]),r})();function HT(r,e){for(var t=[],n=0;n<e.length;n++){var i=e[n],s=r.marks[i],a=s;if(s)t.push(s);else for(var o in r.marks){var l=r.marks[o];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&t.push(a=l)}if(!a)throw new SyntaxError("Unknown mark type: '"+e[n]+"'")}return t}function J4(r){return r.tag!=null}function X4(r){return r.style!=null}var Y4=(function(){function r(e,t){var n=this;ht(this,r),this.schema=e,this.rules=t,this.tags=[],this.styles=[];var i=this.matchedStyles=[];t.forEach(function(s){if(J4(s))n.tags.push(s);else if(X4(s)){var a=/[^=]*/.exec(s.style)[0];i.indexOf(a)<0&&i.push(a),n.styles.push(s)}}),this.normalizeLists=!this.tags.some(function(s){if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;var a=e.nodes[s.node];return a.contentMatch.matchType(a)})}return dt(r,[{key:"parse",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=new jT(this,n,!1);return i.addAll(t,Ge.none,n.from,n.to),i.finish()}},{key:"parseSlice",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=new jT(this,n,!0);return i.addAll(t,Ge.none,n.from,n.to),rs.maxOpen(i.finish())}},{key:"matchTag",value:function(t,n,i){for(var s=i?this.tags.indexOf(i)+1:0;s<this.tags.length;s++){var a=this.tags[s];if(e8(t,a.tag)&&(a.namespace===void 0||t.namespaceURI==a.namespace)&&(!a.context||n.matchesContext(a.context))){if(a.getAttrs){var o=a.getAttrs(t);if(o===!1)continue;a.attrs=o||void 0}return a}}}},{key:"matchStyle",value:function(t,n,i,s){for(var a=s?this.styles.indexOf(s)+1:0;a<this.styles.length;a++){var o=this.styles[a],l=o.style;if(!(l.indexOf(t)!=0||o.context&&!i.matchesContext(o.context)||l.length>t.length&&(l.charCodeAt(t.length)!=61||l.slice(t.length+1)!=n))){if(o.getAttrs){var u=o.getAttrs(n);if(u===!1)continue;o.attrs=u||void 0}return o}}}}],[{key:"schemaRules",value:function(t){var n=[];function i(u){for(var c=u.priority==null?50:u.priority,f=0;f<n.length;f++){var d=n[f],h=d.priority==null?50:d.priority;if(h<c)break}n.splice(f,0,u)}var s=function(c){var f=t.marks[c].spec.parseDOM;f&&f.forEach(function(d){i(d=WT(d)),d.mark||d.ignore||d.clearMark||(d.mark=c)})};for(var a in t.marks)s(a);var o=function(c){var f=t.nodes[c].spec.parseDOM;f&&f.forEach(function(d){i(d=WT(d)),d.node||d.ignore||d.mark||(d.node=c)})};for(var l in t.nodes)o(l);return n}},{key:"fromSchema",value:function(t){return t.cached.domParser||(t.cached.domParser=new r(t,r.schemaRules(t)))}}]),r})(),hA={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Z4={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},dA={ol:!0,ul:!0},So=1,zd=2,xo=4;function zT(r,e,t){return e!=null?(e?So:0)|(e==="full"?zd:0):r&&r.whitespace=="pre"?So|zd:t&~xo}var Ll=(function(){function r(e,t,n,i,s,a){ht(this,r),this.type=e,this.attrs=t,this.marks=n,this.solid=i,this.options=a,this.content=[],this.activeMarks=Ge.none,this.match=s||(a&xo?null:e.contentMatch)}return dt(r,[{key:"findWrapping",value:function(t){if(!this.match){if(!this.type)return[];var n=this.type.contentMatch.fillBefore(ft.from(t));if(n)this.match=this.type.contentMatch.matchFragment(n);else{var i=this.type.contentMatch,s;return(s=i.findWrapping(t.type))?(this.match=i,s):null}}return this.match.findWrapping(t.type)}},{key:"finish",value:function(t){if(!(this.options&So)){var n=this.content[this.content.length-1],i;if(n&&n.isText&&(i=/[ \t\r\n\u000c]+$/.exec(n.text))){var s=n;n.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}var a=ft.from(this.content);return!t&&this.match&&(a=a.append(this.match.fillBefore(ft.empty,!0))),this.type?this.type.create(this.attrs,a,this.marks):a}},{key:"inlineContext",value:function(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!hA.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}]),r})(),jT=(function(){function r(e,t,n){ht(this,r),this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;var i=t.topNode,s,a=zT(null,t.preserveWhitespace,0)|(n?xo:0);i?s=new Ll(i.type,i.attrs,Ge.none,!0,t.topMatch||i.type.contentMatch,a):n?s=new Ll(null,null,Ge.none,!0,null,a):s=new Ll(e.schema.topNodeType,null,Ge.none,!0,null,a),this.nodes=[s],this.find=t.findPositions,this.needsBlock=!1}return dt(r,[{key:"top",get:function(){return this.nodes[this.open]}},{key:"addDOM",value:function(t,n){t.nodeType==3?this.addTextNode(t,n):t.nodeType==1&&this.addElement(t,n)}},{key:"addTextNode",value:function(t,n){var i=t.nodeValue,s=this.top,a=s.options&zd?"full":this.localPreserveWS||(s.options&So)>0,o=this.parser.schema;if(a==="full"||s.inlineContext(t)||/[^ \t\r\n\u000c]/.test(i)){if(a)if(a==="full")i=i.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(i)&&this.top.findWrapping(o.linebreakReplacement.create())){for(var c=i.split(/\r?\n|\r/),f=0;f<c.length;f++)f&&this.insertNode(o.linebreakReplacement.create(),n,!0),c[f]&&this.insertNode(o.text(c[f]),n,!/\S/.test(c[f]));i=""}else i=i.replace(/\r?\n|\r/g," ");else if(i=i.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(i)&&this.open==this.nodes.length-1){var l=s.content[s.content.length-1],u=t.previousSibling;(!l||u&&u.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(i=i.slice(1))}i&&this.insertNode(o.text(i),n,!/\S/.test(i)),this.findInText(t)}else this.findInside(t)}},{key:"addElement",value:function(t,n,i){var s=this.localPreserveWS,a=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);var o=t.nodeName.toLowerCase(),l;dA.hasOwnProperty(o)&&this.parser.normalizeLists&&Q4(t);var u=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(l=this.parser.matchTag(t,this,i));e:if(u?u.ignore:Z4.hasOwnProperty(o))this.findInside(t),this.ignoreFallback(t,n);else if(!u||u.skip||u.closeParent){u&&u.closeParent?this.open=Math.max(0,this.open-1):u&&u.skip.nodeType&&(t=u.skip);var c,f=this.needsBlock;if(hA.hasOwnProperty(o))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),c=!0,a.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,n);break e}var d=u&&u.skip?n:this.readStyles(t,n);d&&this.addAll(t,d),c&&this.sync(a),this.needsBlock=f}else{var h=this.readStyles(t,n);h&&this.addElementByRule(t,u,h,u.consuming===!1?l:void 0)}this.localPreserveWS=s}},{key:"leafFallback",value:function(t,n){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),n)}},{key:"ignoreFallback",value:function(t,n){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}},{key:"readStyles",value:function(t,n){var i=this,s=t.style;if(s&&s.length)for(var a=0;a<this.parser.matchedStyles.length;a++){var o=this.parser.matchedStyles[a],l=s.getPropertyValue(o);if(l){for(var u=function(h){var y=i.parser.matchStyle(o,l,i,h);if(!y)return f=h,0;if(y.ignore)return{v:null};if(y.clearMark?n=n.filter(function(v){return!y.clearMark(v)}):n=n.concat(i.parser.schema.marks[y.mark].create(y.attrs)),y.consuming===!1)h=y;else return f=h,0;f=h},c,f=void 0;c=u(f),c!==0;)if(c)return c.v}}return n}},{key:"addElementByRule",value:function(t,n,i,s){var a=this,o,l;if(n.node)if(l=this.parser.schema.nodes[n.node],l.isLeaf)this.insertNode(l.create(n.attrs),i,t.nodeName=="BR")||this.leafFallback(t,i);else{var u=this.enter(l,n.attrs||null,i,n.preserveWhitespace);u&&(o=!0,i=u)}else{var c=this.parser.schema.marks[n.mark];i=i.concat(c.create(n.attrs))}var f=this.top;if(l&&l.isLeaf)this.findInside(t);else if(s)this.addElement(t,i,s);else if(n.getContent)this.findInside(t),n.getContent(t,this.parser.schema).forEach(function(h){return a.insertNode(h,i,!1)});else{var d=t;typeof n.contentElement=="string"?d=t.querySelector(n.contentElement):typeof n.contentElement=="function"?d=n.contentElement(t):n.contentElement&&(d=n.contentElement),this.findAround(t,d,!0),this.addAll(d,i),this.findAround(t,d,!1)}o&&this.sync(f)&&this.open--}},{key:"addAll",value:function(t,n,i,s){for(var a=i||0,o=i?t.childNodes[i]:t.firstChild,l=s==null?null:t.childNodes[s];o!=l;o=o.nextSibling,++a)this.findAtPoint(t,a),this.addDOM(o,n);this.findAtPoint(t,a)}},{key:"findPlace",value:function(t,n,i){for(var s,a,o=this.open,l=0;o>=0;o--){var u=this.nodes[o],c=u.findWrapping(t);if(c&&(!s||s.length>c.length+l)&&(s=c,a=u,!c.length))break;if(u.solid){if(i)break;l+=2}}if(!s)return null;this.sync(a);for(var f=0;f<s.length;f++)n=this.enterInner(s[f],null,n,!1);return n}},{key:"insertNode",value:function(t,n,i){if(t.isInline&&this.needsBlock&&!this.top.type){var s=this.textblockFromContext();s&&(n=this.enterInner(s,null,n))}var a=this.findPlace(t,n,i);if(a){this.closeExtra();var o=this.top;o.match&&(o.match=o.match.matchType(t.type));var l=Ge.none,u=E4(a.concat(t.marks)),c;try{for(u.s();!(c=u.n()).done;){var f=c.value;(o.type?o.type.allowsMarkType(f.type):qT(f.type,t.type))&&(l=f.addToSet(l))}}catch(d){u.e(d)}finally{u.f()}return o.content.push(t.mark(l)),!0}return!1}},{key:"enter",value:function(t,n,i,s){var a=this.findPlace(t.create(n),i,!1);return a&&(a=this.enterInner(t,n,i,!0,s)),a}},{key:"enterInner",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=arguments.length>4?arguments[4]:void 0;this.closeExtra();var o=this.top;o.match=o.match&&o.match.matchType(t);var l=zT(t,a,o.options);o.options&xo&&o.content.length==0&&(l|=xo);var u=Ge.none;return i=i.filter(function(c){return(o.type?o.type.allowsMarkType(c.type):qT(c.type,t))?(u=c.addToSet(u),!1):!0}),this.nodes.push(new Ll(t,n,u,s,null,l)),this.open++,i}},{key:"closeExtra",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(t));this.nodes.length=this.open+1}}},{key:"finish",value:function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}},{key:"sync",value:function(t){for(var n=this.open;n>=0;n--){if(this.nodes[n]==t)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=So)}return!1}},{key:"currentPos",get:function(){this.closeExtra();for(var t=0,n=this.open;n>=0;n--){for(var i=this.nodes[n].content,s=i.length-1;s>=0;s--)t+=i[s].nodeSize;n&&t++}return t}},{key:"findAtPoint",value:function(t,n){if(this.find)for(var i=0;i<this.find.length;i++)this.find[i].node==t&&this.find[i].offset==n&&(this.find[i].pos=this.currentPos)}},{key:"findInside",value:function(t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].pos==null&&t.nodeType==1&&t.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}},{key:"findAround",value:function(t,n,i){if(t!=n&&this.find){for(var s=0;s<this.find.length;s++)if(this.find[s].pos==null&&t.nodeType==1&&t.contains(this.find[s].node)){var a=n.compareDocumentPosition(this.find[s].node);a&(i?2:4)&&(this.find[s].pos=this.currentPos)}}}},{key:"findInText",value:function(t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&(this.find[n].pos=this.currentPos-(t.nodeValue.length-this.find[n].offset))}},{key:"matchesContext",value:function(t){var n=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var i=t.split("/"),s=this.options.context,a=!this.isOpen&&(!s||s.parent.type==this.nodes[0].type),o=-(s?s.depth+1:0)+(a?0:1),l=function u(c,f){for(;c>=0;c--){var d=i[c];if(d==""){if(c==i.length-1||c==0)continue;for(;f>=o;f--)if(u(c-1,f))return!0;return!1}else{var h=f>0||f==0&&a?n.nodes[f].type:s&&f>=o?s.node(f-o).type:null;if(!h||h.name!=d&&!h.isInGroup(d))return!1;f--}}return!0};return l(i.length-1,this.open)}},{key:"textblockFromContext",value:function(){var t=this.options.context;if(t)for(var n=t.depth;n>=0;n--){var i=t.node(n).contentMatchAt(t.indexAfter(n)).defaultType;if(i&&i.isTextblock&&i.defaultAttrs)return i}for(var s in this.parser.schema.nodes){var a=this.parser.schema.nodes[s];if(a.isTextblock&&a.defaultAttrs)return a}}}]),r})();function Q4(r){for(var e=r.firstChild,t=null;e;e=e.nextSibling){var n=e.nodeType==1?e.nodeName.toLowerCase():null;n&&dA.hasOwnProperty(n)&&t?(t.appendChild(e),e=t):n=="li"?t=e:n&&(t=null)}}function e8(r,e){return(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,e)}function WT(r){var e={};for(var t in r)e[t]=r[t];return e}function qT(r,e){var t=e.schema.nodes,n=function(){var o=t[s];if(!o.allowsMarkType(r))return 0;var l=[],u=function c(f){l.push(f);for(var d=0;d<f.edgeCount;d++){var h=f.edge(d),y=h.type,v=h.next;if(y==e||l.indexOf(v)<0&&c(v))return!0}};if(u(o.contentMatch))return{v:!0}},i;for(var s in t)if(i=n(),i!==0&&i)return i.v}var t8=(function(){function r(e,t){ht(this,r),this.nodes=e,this.marks=t}return dt(r,[{key:"serializeFragment",value:function(t){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;s||(s=Ld(i).createDocumentFragment());var a=s,o=[];return t.forEach(function(l){if(o.length||l.marks.length){for(var u=0,c=0;u<o.length&&c<l.marks.length;){var f=l.marks[c];if(!n.marks[f.type.name]){c++;continue}if(!f.eq(o[u][0])||f.type.spec.spanning===!1)break;u++,c++}for(;u<o.length;)a=o.pop()[1];for(;c<l.marks.length;){var d=l.marks[c++],h=n.serializeMark(d,l.isInline,i);h&&(o.push([d,a]),a.appendChild(h.dom),a=h.contentDOM||h.dom)}}a.appendChild(n.serializeNodeInner(l,i))}),s}},{key:"serializeNodeInner",value:function(t,n){var i=Ul(Ld(n),this.nodes[t.type.name](t),null,t.attrs),s=i.dom,a=i.contentDOM;if(a){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,n,a)}return s}},{key:"serializeNode",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=this.serializeNodeInner(t,n),s=t.marks.length-1;s>=0;s--){var a=this.serializeMark(t.marks[s],t.isInline,n);a&&((a.contentDOM||a.dom).appendChild(i),i=a.dom)}return i}},{key:"serializeMark",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=this.marks[t.type.name];return s&&Ul(Ld(i),s(t,n),null,t.attrs)}}],[{key:"renderSpec",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0;return Ul(t,n,i,s)}},{key:"fromSchema",value:function(t){return t.cached.domSerializer||(t.cached.domSerializer=new r(this.nodesFromSchema(t),this.marksFromSchema(t)))}},{key:"nodesFromSchema",value:function(t){var n=VT(t.nodes);return n.text||(n.text=function(i){return i.text}),n}},{key:"marksFromSchema",value:function(t){return VT(t.marks)}}]),r})();function VT(r){var e={};for(var t in r){var n=r[t].spec.toDOM;n&&(e[t]=n)}return e}function Ld(r){return r.document||window.document}var KT=new WeakMap;function r8(r){var e=KT.get(r);return e===void 0&&KT.set(r,e=n8(r)),e}function n8(r){var e=null;function t(n){if(n&&dr(n)=="object")if(Array.isArray(n))if(typeof n[0]=="string")e||(e=[]),e.push(n);else for(var i=0;i<n.length;i++)t(n[i]);else for(var s in n)t(n[s])}return t(r),e}function Ul(r,e,t,n){if(typeof e=="string")return{dom:r.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;var i=e[0],s;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(s=r8(n))&&s.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");var a=i.indexOf(" ");a>0&&(t=i.slice(0,a),i=i.slice(a+1));var o,l=t?r.createElementNS(t,i):r.createElement(i),u=e[1],c=1;if(u&&dr(u)=="object"&&u.nodeType==null&&!Array.isArray(u)){c=2;for(var f in u)if(u[f]!=null){var d=f.indexOf(" ");d>0?l.setAttributeNS(f.slice(0,d),f.slice(d+1),u[f]):f=="style"&&l.style?l.style.cssText=u[f]:l.setAttribute(f,u[f])}}for(var h=c;h<e.length;h++){var y=e[h];if(y===0){if(h<e.length-1||h>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{var v=Ul(r,y,t,n),x=v.dom,m=v.contentDOM;if(l.appendChild(x),m){if(o)throw new RangeError("Multiple content holes");o=m}}}return{dom:l,contentDOM:o}}Wt.ContentMatch=ns;Wt.DOMParser=Y4;Wt.DOMSerializer=t8;Wt.Fragment=ft;Wt.Mark=Ge;Wt.MarkType=fA;Wt.Node=fi;Wt.NodeRange=nA;Wt.NodeType=Hd;Wt.ReplaceError=zl;Wt.ResolvedPos=Ud;Wt.Schema=$4;Wt.Slice=rs});var Bn=xe(Ue=>{"use strict";function Vd(r){var e=typeof Map=="function"?new Map:void 0;return Vd=function(n){if(n===null||!i8(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,i)}function i(){return Wl(n,arguments,Oo(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Ao(i,n)},Vd(r)}function Wl(r,e,t){return vA()?Wl=Reflect.construct.bind():Wl=function(i,s,a){var o=[null];o.push.apply(o,s);var l=Function.bind.apply(i,o),u=new l;return a&&Ao(u,a.prototype),u},Wl.apply(null,arguments)}function i8(r){try{return Function.toString.call(r).indexOf("[native code]")!==-1}catch{return typeof r=="function"}}function fn(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Ao(r,e)}function Ao(r,e){return Ao=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ao(r,e)}function hn(r){var e=vA();return function(){var n=Oo(r),i;if(e){var s=Oo(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return s8(this,i)}}function s8(r,e){if(e&&(is(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o8(r)}function o8(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function vA(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oo(r){return Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Oo(r)}function is(r){"@babel/helpers - typeof";return is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},is(r)}function At(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function pA(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,a8(n.key),n)}}function Ot(r,e,t){return e&&pA(r.prototype,e),t&&pA(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function a8(r){var e=l8(r,"string");return is(e)==="symbol"?e:String(e)}function l8(r,e){if(is(r)!=="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(is(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var _e=Ln(),yA=65535,wA=Math.pow(2,16);function u8(r,e){return r+e*wA}function mA(r){return r&yA}function c8(r){return(r-(r&yA))/wA}var bA=1,_A=2,ql=4,xA=8,Vl=(function(){function r(e,t,n){At(this,r),this.pos=e,this.delInfo=t,this.recover=n}return Ot(r,[{key:"deleted",get:function(){return(this.delInfo&xA)>0}},{key:"deletedBefore",get:function(){return(this.delInfo&(bA|ql))>0}},{key:"deletedAfter",get:function(){return(this.delInfo&(_A|ql))>0}},{key:"deletedAcross",get:function(){return(this.delInfo&ql)>0}}]),r})(),Fn=(function(){function r(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(At(this,r),this.ranges=e,this.inverted=t,!e.length&&r.empty)return r.empty}return Ot(r,[{key:"recover",value:function(t){var n=0,i=mA(t);if(!this.inverted)for(var s=0;s<i;s++)n+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[i*3]+n+c8(t)}},{key:"mapResult",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._map(t,n,!1)}},{key:"map",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._map(t,n,!0)}},{key:"_map",value:function(t,n,i){for(var s=0,a=this.inverted?2:1,o=this.inverted?1:2,l=0;l<this.ranges.length;l+=3){var u=this.ranges[l]-(this.inverted?s:0);if(u>t)break;var c=this.ranges[l+a],f=this.ranges[l+o],d=u+c;if(t<=d){var h=c?t==u?-1:t==d?1:n:n,y=u+s+(h<0?0:f);if(i)return y;var v=t==(n<0?u:d)?null:u8(l/3,t-u),x=t==u?_A:t==d?bA:ql;return(n<0?t!=u:t!=d)&&(x|=xA),new Vl(y,x,v)}s+=f-c}return i?t+s:new Vl(t+s,0,null)}},{key:"touches",value:function(t,n){for(var i=0,s=mA(n),a=this.inverted?2:1,o=this.inverted?1:2,l=0;l<this.ranges.length;l+=3){var u=this.ranges[l]-(this.inverted?i:0);if(u>t)break;var c=this.ranges[l+a],f=u+c;if(t<=f&&l==s*3)return!0;i+=this.ranges[l+o]-c}return!1}},{key:"forEach",value:function(t){for(var n=this.inverted?2:1,i=this.inverted?1:2,s=0,a=0;s<this.ranges.length;s+=3){var o=this.ranges[s],l=o-(this.inverted?a:0),u=o+(this.inverted?0:a),c=this.ranges[s+n],f=this.ranges[s+i];t(l,l+c,u,u+f),a+=f-c}}},{key:"invert",value:function(){return new r(this.ranges,!this.inverted)}},{key:"toString",value:function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}}],[{key:"offset",value:function(t){return t==0?r.empty:new r(t<0?[0,-t,0]:[0,0,t])}}]),r})();Fn.empty=new Fn([]);var EA=(function(){function r(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e?e.length:0;At(this,r),this.mirror=t,this.from=n,this.to=i,this._maps=e||[],this.ownData=!(e||t)}return Ot(r,[{key:"maps",get:function(){return this._maps}},{key:"slice",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.maps.length;return new r(this._maps,this.mirror,t,n)}},{key:"appendMap",value:function(t,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),n!=null&&this.setMirror(this._maps.length-1,n)}},{key:"appendMapping",value:function(t){for(var n=0,i=this._maps.length;n<t._maps.length;n++){var s=t.getMirror(n);this.appendMap(t._maps[n],s!=null&&s<n?i+s:void 0)}}},{key:"getMirror",value:function(t){if(this.mirror){for(var n=0;n<this.mirror.length;n++)if(this.mirror[n]==t)return this.mirror[n+(n%2?-1:1)]}}},{key:"setMirror",value:function(t,n){this.mirror||(this.mirror=[]),this.mirror.push(t,n)}},{key:"appendMappingInverted",value:function(t){for(var n=t.maps.length-1,i=this._maps.length+t._maps.length;n>=0;n--){var s=t.getMirror(n);this.appendMap(t._maps[n].invert(),s!=null&&s>n?i-s-1:void 0)}}},{key:"invert",value:function(){var t=new r;return t.appendMappingInverted(this),t}},{key:"map",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(this.mirror)return this._map(t,n,!0);for(var i=this.from;i<this.to;i++)t=this._maps[i].map(t,n);return t}},{key:"mapResult",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._map(t,n,!1)}},{key:"_map",value:function(t,n,i){for(var s=0,a=this.from;a<this.to;a++){var o=this._maps[a],l=o.mapResult(t,n);if(l.recover!=null){var u=this.getMirror(a);if(u!=null&&u>a&&u<this.to){a=u,t=this._maps[u].recover(l.recover);continue}}s|=l.delInfo,t=l.pos}return i?t:new Vl(t,s,null)}}]),r})(),jd=Object.create(null),wt=(function(){function r(){At(this,r)}return Ot(r,[{key:"getMap",value:function(){return Fn.empty}},{key:"merge",value:function(t){return null}}],[{key:"fromJSON",value:function(t,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");var i=jd[n.stepType];if(!i)throw new RangeError("No step type ".concat(n.stepType," defined"));return i.fromJSON(t,n)}},{key:"jsonID",value:function(t,n){if(t in jd)throw new RangeError("Duplicate use of step JSON ID "+t);return jd[t]=n,n.prototype.jsonID=t,n}}]),r})(),Tt=(function(){function r(e,t){At(this,r),this.doc=e,this.failed=t}return Ot(r,null,[{key:"ok",value:function(t){return new r(t,null)}},{key:"fail",value:function(t){return new r(null,t)}},{key:"fromReplace",value:function(t,n,i,s){try{return r.ok(t.replace(n,i,s))}catch(a){if(a instanceof _e.ReplaceError)return r.fail(a.message);throw a}}}]),r})();function Gd(r,e,t){for(var n=[],i=0;i<r.childCount;i++){var s=r.child(i);s.content.size&&(s=s.copy(Gd(s.content,e,s))),s.isInline&&(s=e(s,t,i)),n.push(s)}return _e.Fragment.fromArray(n)}var Kl=(function(r){fn(t,r);var e=hn(t);function t(n,i,s){var a;return At(this,t),a=e.call(this),a.from=n,a.to=i,a.mark=s,a}return Ot(t,[{key:"apply",value:function(i){var s=this,a=i.slice(this.from,this.to),o=i.resolve(this.from),l=o.node(o.sharedDepth(this.to)),u=new _e.Slice(Gd(a.content,function(c,f){return!c.isAtom||!f.type.allowsMarkType(s.mark.type)?c:c.mark(s.mark.addToSet(c.marks))},l),a.openStart,a.openEnd);return Tt.fromReplace(i,this.from,this.to,u)}},{key:"invert",value:function(){return new ss(this.from,this.to,this.mark)}},{key:"map",value:function(i){var s=i.mapResult(this.from,1),a=i.mapResult(this.to,-1);return s.deleted&&a.deleted||s.pos>=a.pos?null:new t(s.pos,a.pos,this.mark)}},{key:"merge",value:function(i){return i instanceof t&&i.mark.eq(this.mark)&&this.from<=i.to&&this.to>=i.from?new t(Math.min(this.from,i.from),Math.max(this.to,i.to),this.mark):null}},{key:"toJSON",value:function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}}],[{key:"fromJSON",value:function(i,s){if(typeof s.from!="number"||typeof s.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new t(s.from,s.to,i.markFromJSON(s.mark))}}]),t})(wt);wt.jsonID("addMark",Kl);var ss=(function(r){fn(t,r);var e=hn(t);function t(n,i,s){var a;return At(this,t),a=e.call(this),a.from=n,a.to=i,a.mark=s,a}return Ot(t,[{key:"apply",value:function(i){var s=this,a=i.slice(this.from,this.to),o=new _e.Slice(Gd(a.content,function(l){return l.mark(s.mark.removeFromSet(l.marks))},i),a.openStart,a.openEnd);return Tt.fromReplace(i,this.from,this.to,o)}},{key:"invert",value:function(){return new Kl(this.from,this.to,this.mark)}},{key:"map",value:function(i){var s=i.mapResult(this.from,1),a=i.mapResult(this.to,-1);return s.deleted&&a.deleted||s.pos>=a.pos?null:new t(s.pos,a.pos,this.mark)}},{key:"merge",value:function(i){return i instanceof t&&i.mark.eq(this.mark)&&this.from<=i.to&&this.to>=i.from?new t(Math.min(this.from,i.from),Math.max(this.to,i.to),this.mark):null}},{key:"toJSON",value:function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}}],[{key:"fromJSON",value:function(i,s){if(typeof s.from!="number"||typeof s.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new t(s.from,s.to,i.markFromJSON(s.mark))}}]),t})(wt);wt.jsonID("removeMark",ss);var Gl=(function(r){fn(t,r);var e=hn(t);function t(n,i){var s;return At(this,t),s=e.call(this),s.pos=n,s.mark=i,s}return Ot(t,[{key:"apply",value:function(i){var s=i.nodeAt(this.pos);if(!s)return Tt.fail("No node at mark step's position");var a=s.type.create(s.attrs,null,this.mark.addToSet(s.marks));return Tt.fromReplace(i,this.pos,this.pos+1,new _e.Slice(_e.Fragment.from(a),0,s.isLeaf?0:1))}},{key:"invert",value:function(i){var s=i.nodeAt(this.pos);if(s){var a=this.mark.addToSet(s.marks);if(a.length==s.marks.length){for(var o=0;o<s.marks.length;o++)if(!s.marks[o].isInSet(a))return new t(this.pos,s.marks[o]);return new t(this.pos,this.mark)}}return new No(this.pos,this.mark)}},{key:"map",value:function(i){var s=i.mapResult(this.pos,1);return s.deletedAfter?null:new t(s.pos,this.mark)}},{key:"toJSON",value:function(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}}],[{key:"fromJSON",value:function(i,s){if(typeof s.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new t(s.pos,i.markFromJSON(s.mark))}}]),t})(wt);wt.jsonID("addNodeMark",Gl);var No=(function(r){fn(t,r);var e=hn(t);function t(n,i){var s;return At(this,t),s=e.call(this),s.pos=n,s.mark=i,s}return Ot(t,[{key:"apply",value:function(i){var s=i.nodeAt(this.pos);if(!s)return Tt.fail("No node at mark step's position");var a=s.type.create(s.attrs,null,this.mark.removeFromSet(s.marks));return Tt.fromReplace(i,this.pos,this.pos+1,new _e.Slice(_e.Fragment.from(a),0,s.isLeaf?0:1))}},{key:"invert",value:function(i){var s=i.nodeAt(this.pos);return!s||!this.mark.isInSet(s.marks)?this:new Gl(this.pos,this.mark)}},{key:"map",value:function(i){var s=i.mapResult(this.pos,1);return s.deletedAfter?null:new t(s.pos,this.mark)}},{key:"toJSON",value:function(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}}],[{key:"fromJSON",value:function(i,s){if(typeof s.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new t(s.pos,i.markFromJSON(s.mark))}}]),t})(wt);wt.jsonID("removeNodeMark",No);var cn=(function(r){fn(t,r);var e=hn(t);function t(n,i,s){var a,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return At(this,t),a=e.call(this),a.from=n,a.to=i,a.slice=s,a.structure=o,a}return Ot(t,[{key:"apply",value:function(i){return this.structure&&Kd(i,this.from,this.to)?Tt.fail("Structure replace would overwrite content"):Tt.fromReplace(i,this.from,this.to,this.slice)}},{key:"getMap",value:function(){return new Fn([this.from,this.to-this.from,this.slice.size])}},{key:"invert",value:function(i){return new t(this.from,this.from+this.slice.size,i.slice(this.from,this.to))}},{key:"map",value:function(i){var s=i.mapResult(this.from,1),a=i.mapResult(this.to,-1);return s.deletedAcross&&a.deletedAcross?null:new t(s.pos,Math.max(s.pos,a.pos),this.slice,this.structure)}},{key:"merge",value:function(i){if(!(i instanceof t)||i.structure||this.structure)return null;if(this.from+this.slice.size==i.from&&!this.slice.openEnd&&!i.slice.openStart){var s=this.slice.size+i.slice.size==0?_e.Slice.empty:new _e.Slice(this.slice.content.append(i.slice.content),this.slice.openStart,i.slice.openEnd);return new t(this.from,this.to+(i.to-i.from),s,this.structure)}else if(i.to==this.from&&!this.slice.openStart&&!i.slice.openEnd){var a=this.slice.size+i.slice.size==0?_e.Slice.empty:new _e.Slice(i.slice.content.append(this.slice.content),i.slice.openStart,this.slice.openEnd);return new t(i.from,this.to,a,this.structure)}else return null}},{key:"toJSON",value:function(){var i={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(i.slice=this.slice.toJSON()),this.structure&&(i.structure=!0),i}}],[{key:"fromJSON",value:function(i,s){if(typeof s.from!="number"||typeof s.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new t(s.from,s.to,_e.Slice.fromJSON(i,s.slice),!!s.structure)}}]),t})(wt);wt.jsonID("replace",cn);var di=(function(r){fn(t,r);var e=hn(t);function t(n,i,s,a,o,l){var u,c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1;return At(this,t),u=e.call(this),u.from=n,u.to=i,u.gapFrom=s,u.gapTo=a,u.slice=o,u.insert=l,u.structure=c,u}return Ot(t,[{key:"apply",value:function(i){if(this.structure&&(Kd(i,this.from,this.gapFrom)||Kd(i,this.gapTo,this.to)))return Tt.fail("Structure gap-replace would overwrite content");var s=i.slice(this.gapFrom,this.gapTo);if(s.openStart||s.openEnd)return Tt.fail("Gap is not a flat range");var a=this.slice.insertAt(this.insert,s.content);return a?Tt.fromReplace(i,this.from,this.to,a):Tt.fail("Content does not fit in gap")}},{key:"getMap",value:function(){return new Fn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}},{key:"invert",value:function(i){var s=this.gapTo-this.gapFrom;return new t(this.from,this.from+this.slice.size+s,this.from+this.insert,this.from+this.insert+s,i.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}},{key:"map",value:function(i){var s=i.mapResult(this.from,1),a=i.mapResult(this.to,-1),o=this.from==this.gapFrom?s.pos:i.map(this.gapFrom,-1),l=this.to==this.gapTo?a.pos:i.map(this.gapTo,1);return s.deletedAcross&&a.deletedAcross||o<s.pos||l>a.pos?null:new t(s.pos,a.pos,o,l,this.slice,this.insert,this.structure)}},{key:"toJSON",value:function(){var i={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(i.slice=this.slice.toJSON()),this.structure&&(i.structure=!0),i}}],[{key:"fromJSON",value:function(i,s){if(typeof s.from!="number"||typeof s.to!="number"||typeof s.gapFrom!="number"||typeof s.gapTo!="number"||typeof s.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new t(s.from,s.to,s.gapFrom,s.gapTo,_e.Slice.fromJSON(i,s.slice),s.insert,!!s.structure)}}]),t})(wt);wt.jsonID("replaceAround",di);function Kd(r,e,t){for(var n=r.resolve(e),i=t-e,s=n.depth;i>0&&s>0&&n.indexAfter(s)==n.node(s).childCount;)s--,i--;if(i>0)for(var a=n.node(s).maybeChild(n.indexAfter(s));i>0;){if(!a||a.isLeaf)return!0;a=a.firstChild,i--}return!1}function f8(r,e,t,n){var i=[],s=[],a,o;r.doc.nodesBetween(e,t,function(l,u,c){if(l.isInline){var f=l.marks;if(!n.isInSet(f)&&c.type.allowsMarkType(n.type)){for(var d=Math.max(u,e),h=Math.min(u+l.nodeSize,t),y=n.addToSet(f),v=0;v<f.length;v++)f[v].isInSet(y)||(a&&a.to==d&&a.mark.eq(f[v])?a.to=h:i.push(a=new ss(d,h,f[v])));o&&o.to==d?o.to=h:s.push(o=new Kl(d,h,n))}}}),i.forEach(function(l){return r.step(l)}),s.forEach(function(l){return r.step(l)})}function h8(r,e,t,n){var i=[],s=0;r.doc.nodesBetween(e,t,function(a,o){if(a.isInline){s++;var l=null;if(n instanceof _e.MarkType)for(var u=a.marks,c;c=n.isInSet(u);)(l||(l=[])).push(c),u=c.removeFromSet(u);else n?n.isInSet(a.marks)&&(l=[n]):l=a.marks;if(l&&l.length)for(var f=Math.min(o+a.nodeSize,t),d=0;d<l.length;d++){for(var h=l[d],y=void 0,v=0;v<i.length;v++){var x=i[v];x.step==s-1&&h.eq(i[v].style)&&(y=x)}y?(y.to=f,y.step=s):i.push({style:h,from:Math.max(o,e),to:f,step:s})}}}),i.forEach(function(a){return r.step(new ss(a.from,a.to,a.style))})}function $d(r,e,t){for(var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:t.contentMatch,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=r.doc.nodeAt(e),a=[],o=e+1,l=0;l<s.childCount;l++){var u=s.child(l),c=o+u.nodeSize,f=n.matchType(u.type);if(!f)a.push(new cn(o,c,_e.Slice.empty));else{n=f;for(var d=0;d<u.marks.length;d++)t.allowsMarkType(u.marks[d].type)||r.step(new ss(o,c,u.marks[d]));if(i&&u.isText&&t.whitespace!="pre")for(var h=void 0,y=/\r?\n|\r/g,v=void 0;h=y.exec(u.text);)v||(v=new _e.Slice(_e.Fragment.from(t.schema.text(" ",t.allowedMarks(u.marks))),0,0)),a.push(new cn(o+h.index,o+h.index+h[0].length,v))}o=c}if(!n.validEnd){var x=n.fillBefore(_e.Fragment.empty,!0);r.replace(o,o,new _e.Slice(x,0,0))}for(var m=a.length-1;m>=0;m--)r.step(a[m])}function d8(r,e,t){return(e==0||r.canReplace(e,r.childCount))&&(t==r.childCount||r.canReplace(0,t))}function p8(r){for(var e=r.parent,t=e.content.cutByIndex(r.startIndex,r.endIndex),n=r.depth,i=0,s=0;;--n){var a=r.$from.node(n),o=r.$from.index(n)+i,l=r.$to.indexAfter(n)-s;if(n<r.depth&&a.canReplace(o,l,t))return n;if(n==0||a.type.spec.isolating||!d8(a,o,l))break;o&&(i=1),l<a.childCount&&(s=1)}return null}function m8(r,e,t){for(var n=e.$from,i=e.$to,s=e.depth,a=n.before(s+1),o=i.after(s+1),l=a,u=o,c=_e.Fragment.empty,f=0,d=s,h=!1;d>t;d--)h||n.index(d)>0?(h=!0,c=_e.Fragment.from(n.node(d).copy(c)),f++):l--;for(var y=_e.Fragment.empty,v=0,x=s,m=!1;x>t;x--)m||i.after(x+1)<i.end(x)?(m=!0,y=_e.Fragment.from(i.node(x).copy(y)),v++):u++;r.step(new di(l,u,a,o,new _e.Slice(c.append(y),f,v),c.size-f,!0))}function g8(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r,i=v8(r,e),s=i&&y8(n,e);return s?i.map(gA).concat({type:e,attrs:t}).concat(s.map(gA)):null}function gA(r){return{type:r,attrs:null}}function v8(r,e){var t=r.parent,n=r.startIndex,i=r.endIndex,s=t.contentMatchAt(n).findWrapping(e);if(!s)return null;var a=s.length?s[0]:e;return t.canReplaceWith(n,i,a)?s:null}function y8(r,e){var t=r.parent,n=r.startIndex,i=r.endIndex,s=t.child(n),a=e.contentMatch.findWrapping(s.type);if(!a)return null;for(var o=a.length?a[a.length-1]:e,l=o.contentMatch,u=n;l&&u<i;u++)l=l.matchType(t.child(u).type);return!l||!l.validEnd?null:a}function w8(r,e,t){for(var n=_e.Fragment.empty,i=t.length-1;i>=0;i--){if(n.size){var s=t[i].type.contentMatch.matchFragment(n);if(!s||!s.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=_e.Fragment.from(t[i].type.create(t[i].attrs,n))}var a=e.start,o=e.end;r.step(new di(a,o,a,o,new _e.Slice(n,0,0),t.length,!0))}function b8(r,e,t,n,i){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var s=r.steps.length;r.doc.nodesBetween(e,t,function(a,o){var l=typeof i=="function"?i(a):i;if(a.isTextblock&&!a.hasMarkup(n,l)&&_8(r.doc,r.mapping.slice(s).map(o),n)){var u=null;if(n.schema.linebreakReplacement){var c=n.whitespace=="pre",f=!!n.contentMatch.matchType(n.schema.linebreakReplacement);c&&!f?u=!1:!c&&f&&(u=!0)}u===!1&&kA(r,a,o,s),$d(r,r.mapping.slice(s).map(o,1),n,void 0,u===null);var d=r.mapping.slice(s),h=d.map(o,1),y=d.map(o+a.nodeSize,1);return r.step(new di(h,y,h+1,y-1,new _e.Slice(_e.Fragment.from(n.create(l,null,a.marks)),0,0),1,!0)),u===!0&&SA(r,a,o,s),!1}})}function SA(r,e,t,n){e.forEach(function(i,s){if(i.isText)for(var a,o=/\r?\n|\r/g;a=o.exec(i.text);){var l=r.mapping.slice(n).map(t+1+s+a.index);r.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}})}function kA(r,e,t,n){e.forEach(function(i,s){if(i.type==i.type.schema.linebreakReplacement){var a=r.mapping.slice(n).map(t+1+s);r.replaceWith(a,a+1,e.type.schema.text(`
`))}})}function _8(r,e,t){var n=r.resolve(e),i=n.index();return n.parent.canReplaceWith(i,i+1,t)}function x8(r,e,t,n,i){var s=r.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");t||(t=s.type);var a=t.create(n,null,i||s.marks);if(s.isLeaf)return r.replaceWith(e,e+s.nodeSize,a);if(!t.validContent(s.content))throw new RangeError("Invalid content for node type "+t.name);r.step(new di(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new _e.Slice(_e.Fragment.from(a),0,0),1,!0))}function E8(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0,i=r.resolve(e),s=i.depth-t,a=n&&n[n.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!a.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(var o=i.depth-1,l=t-2;o>s;o--,l--){var u=i.node(o),c=i.index(o);if(u.type.spec.isolating)return!1;var f=u.content.cutByIndex(c,u.childCount),d=n&&n[l+1];d&&(f=f.replaceChild(0,d.type.create(d.attrs)));var h=n&&n[l]||u;if(!u.canReplace(c+1,u.childCount)||!h.type.validContent(f))return!1}var y=i.indexAfter(s),v=n&&n[0];return i.node(s).canReplaceWith(y,y,v?v.type:i.node(s+1).type)}function S8(r,e){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0,i=r.doc.resolve(e),s=_e.Fragment.empty,a=_e.Fragment.empty,o=i.depth,l=i.depth-t,u=t-1;o>l;o--,u--){s=_e.Fragment.from(i.node(o).copy(s));var c=n&&n[u];a=_e.Fragment.from(c?c.type.create(c.attrs,a):i.node(o).copy(a))}r.step(new cn(e,e,new _e.Slice(s.append(a),t,t),!0))}function k8(r,e){var t=r.resolve(e),n=t.index();return TA(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(n,n+1)}function T8(r,e){e.content.size||r.type.compatibleContent(e.type);for(var t=r.contentMatchAt(r.childCount),n=r.type.schema.linebreakReplacement,i=0;i<e.childCount;i++){var s=e.child(i),a=s.type==n?r.type.schema.nodes.text:s.type;if(t=t.matchType(a),!t||!r.type.allowsMarks(s.marks))return!1}return t.validEnd}function TA(r,e){return!!(r&&e&&!r.isLeaf&&T8(r,e))}function A8(r,e){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,n=r.resolve(e),i=n.depth;;i--){var s=void 0,a=void 0,o=n.index(i);if(i==n.depth?(s=n.nodeBefore,a=n.nodeAfter):t>0?(s=n.node(i+1),o++,a=n.node(i).maybeChild(o)):(s=n.node(i).maybeChild(o-1),a=n.node(i+1)),s&&!s.isTextblock&&TA(s,a)&&n.node(i).canReplace(o,o+1))return e;if(i==0)break;e=t<0?n.before(i):n.after(i)}}function O8(r,e,t){var n=null,i=r.doc.type.schema.linebreakReplacement,s=r.doc.resolve(e-t),a=s.node().type;if(i&&a.inlineContent){var o=a.whitespace=="pre",l=!!a.contentMatch.matchType(i);o&&!l?n=!1:!o&&l&&(n=!0)}var u=r.steps.length;if(n===!1){var c=r.doc.resolve(e+t);kA(r,c.node(),c.before(),u)}a.inlineContent&&$d(r,e+t-1,a,s.node().contentMatchAt(s.index()),n==null);var f=r.mapping.slice(u),d=f.map(e-t);if(r.step(new cn(d,f.map(e+t,-1),_e.Slice.empty,!0)),n===!0){var h=r.doc.resolve(d);SA(r,h.node(),h.before(),r.steps.length)}return r}function AA(r,e,t){var n=r.resolve(e);if(n.parent.canReplaceWith(n.index(),n.index(),t))return e;if(n.parentOffset==0)for(var i=n.depth-1;i>=0;i--){var s=n.index(i);if(n.node(i).canReplaceWith(s,s,t))return n.before(i+1);if(s>0)return null}if(n.parentOffset==n.parent.content.size)for(var a=n.depth-1;a>=0;a--){var o=n.indexAfter(a);if(n.node(a).canReplaceWith(o,o,t))return n.after(a+1);if(o<n.node(a).childCount)return null}return null}function N8(r,e,t){var n=r.resolve(e);if(!t.content.size)return e;for(var i=t.content,s=0;s<t.openStart;s++)i=i.firstChild.content;for(var a=1;a<=(t.openStart==0&&t.size?2:1);a++)for(var o=n.depth;o>=0;o--){var l=o==n.depth?0:n.pos<=(n.start(o+1)+n.end(o+1))/2?-1:1,u=n.index(o)+(l>0?1:0),c=n.node(o),f=!1;if(a==1)f=c.canReplace(u,u,i);else{var d=c.contentMatchAt(u).findWrapping(i.firstChild.type);f=d&&c.canReplaceWith(u,u,d[0])}if(f)return l==0?n.pos:l<0?n.before(o+1):n.after(o+1)}return null}function OA(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:_e.Slice.empty;if(e==t&&!n.size)return null;var i=r.resolve(e),s=r.resolve(t);return NA(i,s,n)?new cn(e,t,n):new R8(i,s,n).fit()}function NA(r,e,t){return!t.openStart&&!t.openEnd&&r.start()==e.start()&&r.parent.canReplace(r.index(),e.index(),t.content)}var R8=(function(){function r(e,t,n){At(this,r),this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=_e.Fragment.empty;for(var i=0;i<=e.depth;i++){var s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(var a=e.depth;a>0;a--)this.placed=_e.Fragment.from(e.node(a).copy(this.placed))}return Ot(r,[{key:"depth",get:function(){return this.frontier.length-1}},{key:"fit",value:function(){for(;this.unplaced.size;){var t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}var n=this.mustMoveInline(),i=this.placed.size-this.depth-this.$from.depth,s=this.$from,a=this.close(n<0?this.$to:s.doc.resolve(n));if(!a)return null;for(var o=this.placed,l=s.depth,u=a.depth;l&&u&&o.childCount==1;)o=o.firstChild.content,l--,u--;var c=new _e.Slice(o,l,u);return n>-1?new di(s.pos,n,this.$to.pos,this.$to.end(),c,i):c.size||s.pos!=this.$to.pos?new cn(s.pos,a.pos,c):null}},{key:"findFittable",value:function(){for(var t=this.unplaced.openStart,n=this.unplaced.content,i=0,s=this.unplaced.openEnd;i<t;i++){var a=n.firstChild;if(n.childCount>1&&(s=0),a.type.spec.isolating&&s<=i){t=i;break}n=a.content}for(var o=1;o<=2;o++)for(var l=o==1?t:this.unplaced.openStart;l>=0;l--){var u=void 0,c=null;l?(c=Wd(this.unplaced.content,l-1).firstChild,u=c.content):u=this.unplaced.content;for(var f=u.firstChild,d=this.depth;d>=0;d--){var h=this.frontier[d],y=h.type,v=h.match,x=void 0,m=null;if(o==1&&(f?v.matchType(f.type)||(m=v.fillBefore(_e.Fragment.from(f),!1)):c&&y.compatibleContent(c.type)))return{sliceDepth:l,frontierDepth:d,parent:c,inject:m};if(o==2&&f&&(x=v.findWrapping(f.type)))return{sliceDepth:l,frontierDepth:d,parent:c,wrap:x};if(c&&v.matchType(c.type))break}}}},{key:"openMore",value:function(){var t=this.unplaced,n=t.content,i=t.openStart,s=t.openEnd,a=Wd(n,i);return!a.childCount||a.firstChild.isLeaf?!1:(this.unplaced=new _e.Slice(n,i+1,Math.max(s,a.size+i>=n.size-s?i+1:0)),!0)}},{key:"dropNode",value:function(){var t=this.unplaced,n=t.content,i=t.openStart,s=t.openEnd,a=Wd(n,i);if(a.childCount<=1&&i>0){var o=n.size-i<=i+a.size;this.unplaced=new _e.Slice(ko(n,i-1,1),i-1,o?i-1:s)}else this.unplaced=new _e.Slice(ko(n,i,1),i,s)}},{key:"placeNodes",value:function(t){for(var n=t.sliceDepth,i=t.frontierDepth,s=t.parent,a=t.inject,o=t.wrap;this.depth>i;)this.closeFrontierNode();if(o)for(var l=0;l<o.length;l++)this.openFrontierNode(o[l]);var u=this.unplaced,c=s?s.content:u.content,f=u.openStart-n,d=0,h=[],y=this.frontier[i],v=y.match,x=y.type;if(a){for(var m=0;m<a.childCount;m++)h.push(a.child(m));v=v.matchFragment(a)}for(var _=c.size+n-(u.content.size-u.openEnd);d<c.childCount;){var b=c.child(d),w=v.matchType(b.type);if(!w)break;d++,(d>1||f==0||b.content.size)&&(v=w,h.push(RA(b.mark(x.allowedMarks(b.marks)),d==1?f:0,d==c.childCount?_:-1)))}var T=d==c.childCount;T||(_=-1),this.placed=To(this.placed,i,_e.Fragment.from(h)),this.frontier[i].match=v,T&&_<0&&s&&s.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var P=0,M=c;P<_;P++){var U=M.lastChild;this.frontier.push({type:U.type,match:U.contentMatchAt(U.childCount)}),M=U.content}this.unplaced=T?n==0?_e.Slice.empty:new _e.Slice(ko(u.content,n-1,1),n-1,_<0?u.openEnd:n-1):new _e.Slice(ko(u.content,n,d),u.openStart,u.openEnd)}},{key:"mustMoveInline",value:function(){if(!this.$to.parent.isTextblock)return-1;var t=this.frontier[this.depth],n;if(!t.type.isTextblock||!qd(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;for(var i=this.$to.depth,s=this.$to.after(i);i>1&&s==this.$to.end(--i);)++s;return s}},{key:"findCloseLevel",value:function(t){e:for(var n=Math.min(this.depth,t.depth);n>=0;n--){var i=this.frontier[n],s=i.match,a=i.type,o=n<t.depth&&t.end(n+1)==t.pos+(t.depth-(n+1)),l=qd(t,n,a,s,o);if(l){for(var u=n-1;u>=0;u--){var c=this.frontier[u],f=c.match,d=c.type,h=qd(t,u,d,f,!0);if(!h||h.childCount)continue e}return{depth:n,fit:l,move:o?t.doc.resolve(t.after(n+1)):t}}}}},{key:"close",value:function(t){var n=this.findCloseLevel(t);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=To(this.placed,n.depth,n.fit)),t=n.move;for(var i=n.depth+1;i<=t.depth;i++){var s=t.node(i),a=s.type.contentMatch.fillBefore(s.content,!0,t.index(i));this.openFrontierNode(s.type,s.attrs,a)}return t}},{key:"openFrontierNode",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0,s=this.frontier[this.depth];s.match=s.match.matchType(t),this.placed=To(this.placed,this.depth,_e.Fragment.from(t.create(n,i))),this.frontier.push({type:t,match:t.contentMatch})}},{key:"closeFrontierNode",value:function(){var t=this.frontier.pop(),n=t.match.fillBefore(_e.Fragment.empty,!0);n.childCount&&(this.placed=To(this.placed,this.frontier.length,n))}}]),r})();function ko(r,e,t){return e==0?r.cutByIndex(t,r.childCount):r.replaceChild(0,r.firstChild.copy(ko(r.firstChild.content,e-1,t)))}function To(r,e,t){return e==0?r.append(t):r.replaceChild(r.childCount-1,r.lastChild.copy(To(r.lastChild.content,e-1,t)))}function Wd(r,e){for(var t=0;t<e;t++)r=r.firstChild.content;return r}function RA(r,e,t){if(e<=0)return r;var n=r.content;return e>1&&(n=n.replaceChild(0,RA(n.firstChild,e-1,n.childCount==1?t-1:0))),e>0&&(n=r.type.contentMatch.fillBefore(n).append(n),t<=0&&(n=n.append(r.type.contentMatch.matchFragment(n).fillBefore(_e.Fragment.empty,!0)))),r.copy(n)}function qd(r,e,t,n,i){var s=r.node(e),a=i?r.indexAfter(e):r.index(e);if(a==s.childCount&&!t.compatibleContent(s.type))return null;var o=n.fillBefore(s.content,!0,a);return o&&!C8(t,s.content,a)?o:null}function C8(r,e,t){for(var n=t;n<e.childCount;n++)if(!r.allowsMarks(e.child(n).marks))return!0;return!1}function I8(r){return r.spec.defining||r.spec.definingForContent}function P8(r,e,t,n){if(!n.size)return r.deleteRange(e,t);var i=r.doc.resolve(e),s=r.doc.resolve(t);if(NA(i,s,n))return r.step(new cn(e,t,n));var a=IA(i,s);a[a.length-1]==0&&a.pop();var o=-(i.depth+1);a.unshift(o);for(var l=i.depth,u=i.pos-1;l>0;l--,u--){var c=i.node(l).type.spec;if(c.defining||c.definingAsContext||c.isolating)break;a.indexOf(l)>-1?o=l:i.before(l)==u&&a.splice(1,0,-l)}for(var f=a.indexOf(o),d=[],h=n.openStart,y=n.content,v=0;;v++){var x=y.firstChild;if(d.push(x),v==n.openStart)break;y=x.content}for(var m=h-1;m>=0;m--){var _=d[m],b=I8(_.type);if(b&&!_.sameMarkup(i.node(Math.abs(o)-1)))h=m;else if(b||!_.type.isTextblock)break}for(var w=n.openStart;w>=0;w--){var T=(w+h+1)%(n.openStart+1),P=d[T];if(P)for(var M=0;M<a.length;M++){var U=a[(M+f)%a.length],R=!0;U<0&&(R=!1,U=-U);var J=i.node(U-1),oe=i.index(U-1);if(J.canReplaceWith(oe,oe,P.type,P.marks))return r.replace(i.before(U),R?s.after(U):t,new _e.Slice(CA(n.content,0,n.openStart,T),T,n.openEnd))}}for(var C=r.steps.length,H=a.length-1;H>=0&&(r.replace(e,t,n),!(r.steps.length>C));H--){var k=a[H];k<0||(e=i.before(k),t=s.after(k))}}function CA(r,e,t,n,i){if(e<t){var s=r.firstChild;r=r.replaceChild(0,s.copy(CA(s.content,e+1,t,n,s)))}if(e>n){var a=i.contentMatchAt(0),o=a.fillBefore(r).append(r);r=o.append(a.matchFragment(o).fillBefore(_e.Fragment.empty,!0))}return r}function D8(r,e,t,n){if(!n.isInline&&e==t&&r.doc.resolve(e).parent.content.size){var i=AA(r.doc,e,n.type);i!=null&&(e=t=i)}r.replaceRange(e,t,new _e.Slice(_e.Fragment.from(n),0,0))}function M8(r,e,t){for(var n=r.doc.resolve(e),i=r.doc.resolve(t),s=IA(n,i),a=0;a<s.length;a++){var o=s[a],l=a==s.length-1;if(l&&o==0||n.node(o).type.contentMatch.validEnd)return r.delete(n.start(o),i.end(o));if(o>0&&(l||n.node(o-1).canReplace(n.index(o-1),i.indexAfter(o-1))))return r.delete(n.before(o),i.after(o))}for(var u=1;u<=n.depth&&u<=i.depth;u++)if(e-n.start(u)==n.depth-u&&t>n.end(u)&&i.end(u)-t!=i.depth-u&&n.start(u-1)==i.start(u-1)&&n.node(u-1).canReplace(n.index(u-1),i.index(u-1)))return r.delete(n.before(u),t);r.delete(e,t)}function IA(r,e){for(var t=[],n=Math.min(r.depth,e.depth),i=n;i>=0;i--){var s=r.start(i);if(s<r.pos-(r.depth-i)||e.end(i)>e.pos+(e.depth-i)||r.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==r.depth&&i==e.depth&&r.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&t.push(i)}return t}var Jd=(function(r){fn(t,r);var e=hn(t);function t(n,i,s){var a;return At(this,t),a=e.call(this),a.pos=n,a.attr=i,a.value=s,a}return Ot(t,[{key:"apply",value:function(i){var s=i.nodeAt(this.pos);if(!s)return Tt.fail("No node at attribute step's position");var a=Object.create(null);for(var o in s.attrs)a[o]=s.attrs[o];a[this.attr]=this.value;var l=s.type.create(a,null,s.marks);return Tt.fromReplace(i,this.pos,this.pos+1,new _e.Slice(_e.Fragment.from(l),0,s.isLeaf?0:1))}},{key:"getMap",value:function(){return Fn.empty}},{key:"invert",value:function(i){return new t(this.pos,this.attr,i.nodeAt(this.pos).attrs[this.attr])}},{key:"map",value:function(i){var s=i.mapResult(this.pos,1);return s.deletedAfter?null:new t(s.pos,this.attr,this.value)}},{key:"toJSON",value:function(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}}],[{key:"fromJSON",value:function(i,s){if(typeof s.pos!="number"||typeof s.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new t(s.pos,s.attr,s.value)}}]),t})(wt);wt.jsonID("attr",Jd);var Xd=(function(r){fn(t,r);var e=hn(t);function t(n,i){var s;return At(this,t),s=e.call(this),s.attr=n,s.value=i,s}return Ot(t,[{key:"apply",value:function(i){var s=Object.create(null);for(var a in i.attrs)s[a]=i.attrs[a];s[this.attr]=this.value;var o=i.type.create(s,i.content,i.marks);return Tt.ok(o)}},{key:"getMap",value:function(){return Fn.empty}},{key:"invert",value:function(i){return new t(this.attr,i.attrs[this.attr])}},{key:"map",value:function(i){return this}},{key:"toJSON",value:function(){return{stepType:"docAttr",attr:this.attr,value:this.value}}}],[{key:"fromJSON",value:function(i,s){if(typeof s.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new t(s.attr,s.value)}}]),t})(wt);wt.jsonID("docAttr",Xd);Ue.TransformError=(function(r){fn(t,r);var e=hn(t);function t(){return At(this,t),e.apply(this,arguments)}return Ot(t)})(Vd(Error));Ue.TransformError=function r(e){var t=Error.call(this,e);return t.__proto__=r.prototype,t};Ue.TransformError.prototype=Object.create(Error.prototype);Ue.TransformError.prototype.constructor=Ue.TransformError;Ue.TransformError.prototype.name="TransformError";var L8=(function(){function r(e){At(this,r),this.doc=e,this.steps=[],this.docs=[],this.mapping=new EA}return Ot(r,[{key:"before",get:function(){return this.docs.length?this.docs[0]:this.doc}},{key:"step",value:function(t){var n=this.maybeStep(t);if(n.failed)throw new Ue.TransformError(n.failed);return this}},{key:"maybeStep",value:function(t){var n=t.apply(this.doc);return n.failed||this.addStep(t,n.doc),n}},{key:"docChanged",get:function(){return this.steps.length>0}},{key:"addStep",value:function(t,n){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=n}},{key:"replace",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_e.Slice.empty,s=OA(this.doc,t,n,i);return s&&this.step(s),this}},{key:"replaceWith",value:function(t,n,i){return this.replace(t,n,new _e.Slice(_e.Fragment.from(i),0,0))}},{key:"delete",value:function(t,n){return this.replace(t,n,_e.Slice.empty)}},{key:"insert",value:function(t,n){return this.replaceWith(t,t,n)}},{key:"replaceRange",value:function(t,n,i){return P8(this,t,n,i),this}},{key:"replaceRangeWith",value:function(t,n,i){return D8(this,t,n,i),this}},{key:"deleteRange",value:function(t,n){return M8(this,t,n),this}},{key:"lift",value:function(t,n){return m8(this,t,n),this}},{key:"join",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return O8(this,t,n),this}},{key:"wrap",value:function(t,n){return w8(this,t,n),this}},{key:"setBlockType",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return b8(this,t,n,i,s),this}},{key:"setNodeMarkup",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0;return x8(this,t,n,i,s),this}},{key:"setNodeAttribute",value:function(t,n,i){return this.step(new Jd(t,n,i)),this}},{key:"setDocAttribute",value:function(t,n){return this.step(new Xd(t,n)),this}},{key:"addNodeMark",value:function(t,n){return this.step(new Gl(t,n)),this}},{key:"removeNodeMark",value:function(t,n){var i=this.doc.nodeAt(t);if(!i)throw new RangeError("No node at position "+t);if(n instanceof _e.Mark)n.isInSet(i.marks)&&this.step(new No(t,n));else{for(var s=i.marks,a,o=[];a=n.isInSet(s);)o.push(new No(t,a)),s=a.removeFromSet(s);for(var l=o.length-1;l>=0;l--)this.step(o[l])}return this}},{key:"split",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;return S8(this,t,n,i),this}},{key:"addMark",value:function(t,n,i){return f8(this,t,n,i),this}},{key:"removeMark",value:function(t,n,i){return h8(this,t,n,i),this}},{key:"clearIncompatible",value:function(t,n,i){return $d(this,t,n,i),this}}]),r})();Ue.AddMarkStep=Kl;Ue.AddNodeMarkStep=Gl;Ue.AttrStep=Jd;Ue.DocAttrStep=Xd;Ue.MapResult=Vl;Ue.Mapping=EA;Ue.RemoveMarkStep=ss;Ue.RemoveNodeMarkStep=No;Ue.ReplaceAroundStep=di;Ue.ReplaceStep=cn;Ue.Step=wt;Ue.StepMap=Fn;Ue.StepResult=Tt;Ue.Transform=L8;Ue.canJoin=k8;Ue.canSplit=E8;Ue.dropPoint=N8;Ue.findWrapping=g8;Ue.insertPoint=AA;Ue.joinPoint=A8;Ue.liftTarget=p8;Ue.replaceStep=OA});var pr=xe($l=>{"use strict";Object.defineProperty($l,"__esModule",{value:!0});function F8(r){Object.keys(r).filter(e=>e!=="default"&&e!=="__esModule").forEach(e=>{$l.hasOwnProperty(e)||Object.defineProperty($l,e,{enumerable:!0,configurable:!0,get:()=>r[e]})})}var B8=Bn();F8(B8)});var dn=xe(Or=>{"use strict";function ls(){return typeof Reflect<"u"&&Reflect.get?ls=Reflect.get.bind():ls=function(e,t,n){var i=U8(e,t);if(i){var s=Object.getOwnPropertyDescriptor(i,t);return s.get?s.get.call(arguments.length<3?e:n):s.value}},ls.apply(this,arguments)}function U8(r,e){for(;!Object.prototype.hasOwnProperty.call(r,e)&&(r=Un(r),r!==null););return r}function Xl(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&ep(r,e)}function ep(r,e){return ep=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ep(r,e)}function Yl(r){var e=j8();return function(){var n=Un(r),i;if(e){var s=Un(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return H8(this,i)}}function H8(r,e){if(e&&(pi(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z8(r)}function z8(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function j8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Un(r){return Un=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Un(r)}function pi(r){"@babel/helpers - typeof";return pi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pi(r)}function Zt(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function PA(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,W8(n.key),n)}}function Qt(r,e,t){return e&&PA(r.prototype,e),t&&PA(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function W8(r){var e=q8(r,"string");return pi(e)==="symbol"?e:String(e)}function q8(r,e){if(pi(r)!=="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(pi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var mr=Ln(),tp=Bn(),Yd=Object.create(null),rt=(function(){function r(e,t,n){Zt(this,r),this.$anchor=e,this.$head=t,this.ranges=n||[new HA(e.min(t),e.max(t))]}return Qt(r,[{key:"anchor",get:function(){return this.$anchor.pos}},{key:"head",get:function(){return this.$head.pos}},{key:"from",get:function(){return this.$from.pos}},{key:"to",get:function(){return this.$to.pos}},{key:"$from",get:function(){return this.ranges[0].$from}},{key:"$to",get:function(){return this.ranges[0].$to}},{key:"empty",get:function(){for(var t=this.ranges,n=0;n<t.length;n++)if(t[n].$from.pos!=t[n].$to.pos)return!1;return!0}},{key:"content",value:function(){return this.$from.doc.slice(this.from,this.to,!0)}},{key:"replace",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mr.Slice.empty,i=n.content.lastChild,s=null,a=0;a<n.openEnd;a++)s=i,i=i.lastChild;for(var o=t.steps.length,l=this.ranges,u=0;u<l.length;u++){var c=l[u],f=c.$from,d=c.$to,h=t.mapping.slice(o);t.replaceRange(h.map(f.pos),h.map(d.pos),u?mr.Slice.empty:n),u==0&&LA(t,o,(i?i.isInline:s&&s.isTextblock)?-1:1)}}},{key:"replaceWith",value:function(t,n){for(var i=t.steps.length,s=this.ranges,a=0;a<s.length;a++){var o=s[a],l=o.$from,u=o.$to,c=t.mapping.slice(i),f=c.map(l.pos),d=c.map(u.pos);a?t.deleteRange(f,d):(t.replaceRangeWith(f,d,n),LA(t,i,n.isInline?-1:1))}}},{key:"getBookmark",value:function(){return cs.between(this.$anchor,this.$head).getBookmark()}}],[{key:"findFrom",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=t.parent.inlineContent?new cs(t):as(t.node(0),t.parent,t.pos,t.index(),n,i);if(s)return s;for(var a=t.depth-1;a>=0;a--){var o=n<0?as(t.node(0),t.node(a),t.before(a+1),t.index(a),n,i):as(t.node(0),t.node(a),t.after(a+1),t.index(a)+1,n,i);if(o)return o}return null}},{key:"near",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this.findFrom(t,n)||this.findFrom(t,-n)||new us(t.node(0))}},{key:"atStart",value:function(t){return as(t,t,0,0,1)||new us(t)}},{key:"atEnd",value:function(t){return as(t,t,t.content.size,t.childCount,-1)||new us(t)}},{key:"fromJSON",value:function(t,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");var i=Yd[n.type];if(!i)throw new RangeError("No selection type ".concat(n.type," defined"));return i.fromJSON(t,n)}},{key:"jsonID",value:function(t,n){if(t in Yd)throw new RangeError("Duplicate use of selection JSON ID "+t);return Yd[t]=n,n.prototype.jsonID=t,n}}]),r})();rt.prototype.visible=!0;var HA=Qt(function r(e,t){Zt(this,r),this.$from=e,this.$to=t}),DA=!1;function MA(r){!DA&&!r.parent.inlineContent&&(DA=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+r.parent.type.name+")"))}var cs=(function(r){Xl(t,r);var e=Yl(t);function t(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n;return Zt(this,t),MA(n),MA(i),e.call(this,n,i)}return Qt(t,[{key:"$cursor",get:function(){return this.$anchor.pos==this.$head.pos?this.$head:null}},{key:"map",value:function(i,s){var a=i.resolve(s.map(this.head));if(!a.parent.inlineContent)return rt.near(a);var o=i.resolve(s.map(this.anchor));return new t(o.parent.inlineContent?o:a,a)}},{key:"replace",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mr.Slice.empty;if(ls(Un(t.prototype),"replace",this).call(this,i,s),s==mr.Slice.empty){var a=this.$from.marksAcross(this.$to);a&&i.ensureMarks(a)}}},{key:"eq",value:function(i){return i instanceof t&&i.anchor==this.anchor&&i.head==this.head}},{key:"getBookmark",value:function(){return new zA(this.anchor,this.head)}},{key:"toJSON",value:function(){return{type:"text",anchor:this.anchor,head:this.head}}}],[{key:"fromJSON",value:function(i,s){if(typeof s.anchor!="number"||typeof s.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(i.resolve(s.anchor),i.resolve(s.head))}},{key:"create",value:function(i,s){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:s,o=i.resolve(s);return new this(o,a==s?o:i.resolve(a))}},{key:"between",value:function(i,s,a){var o=i.pos-s.pos;if((!a||o)&&(a=o>=0?1:-1),!s.parent.inlineContent){var l=rt.findFrom(s,a,!0)||rt.findFrom(s,-a,!0);if(l)s=l.$head;else return rt.near(s,a)}return i.parent.inlineContent||(o==0?i=s:(i=(rt.findFrom(i,-a,!0)||rt.findFrom(i,a,!0)).$anchor,i.pos<s.pos!=o<0&&(i=s))),new t(i,s)}}]),t})(rt);rt.jsonID("text",cs);var zA=(function(){function r(e,t){Zt(this,r),this.anchor=e,this.head=t}return Qt(r,[{key:"map",value:function(t){return new r(t.map(this.anchor),t.map(this.head))}},{key:"resolve",value:function(t){return cs.between(t.resolve(this.anchor),t.resolve(this.head))}}]),r})(),mi=(function(r){Xl(t,r);var e=Yl(t);function t(n){var i;Zt(this,t);var s=n.nodeAfter,a=n.node(0).resolve(n.pos+s.nodeSize);return i=e.call(this,n,a),i.node=s,i}return Qt(t,[{key:"map",value:function(i,s){var a=s.mapResult(this.anchor),o=a.deleted,l=a.pos,u=i.resolve(l);return o?rt.near(u):new t(u)}},{key:"content",value:function(){return new mr.Slice(mr.Fragment.from(this.node),0,0)}},{key:"eq",value:function(i){return i instanceof t&&i.anchor==this.anchor}},{key:"toJSON",value:function(){return{type:"node",anchor:this.anchor}}},{key:"getBookmark",value:function(){return new V8(this.anchor)}}],[{key:"fromJSON",value:function(i,s){if(typeof s.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(i.resolve(s.anchor))}},{key:"create",value:function(i,s){return new t(i.resolve(s))}},{key:"isSelectable",value:function(i){return!i.isText&&i.type.spec.selectable!==!1}}]),t})(rt);mi.prototype.visible=!1;rt.jsonID("node",mi);var V8=(function(){function r(e){Zt(this,r),this.anchor=e}return Qt(r,[{key:"map",value:function(t){var n=t.mapResult(this.anchor),i=n.deleted,s=n.pos;return i?new zA(s,s):new r(s)}},{key:"resolve",value:function(t){var n=t.resolve(this.anchor),i=n.nodeAfter;return i&&mi.isSelectable(i)?new mi(n):rt.near(n)}}]),r})(),us=(function(r){Xl(t,r);var e=Yl(t);function t(n){return Zt(this,t),e.call(this,n.resolve(0),n.resolve(n.content.size))}return Qt(t,[{key:"replace",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mr.Slice.empty;if(s==mr.Slice.empty){i.delete(0,i.doc.content.size);var a=rt.atStart(i.doc);a.eq(i.selection)||i.setSelection(a)}else ls(Un(t.prototype),"replace",this).call(this,i,s)}},{key:"toJSON",value:function(){return{type:"all"}}},{key:"map",value:function(i){return new t(i)}},{key:"eq",value:function(i){return i instanceof t}},{key:"getBookmark",value:function(){return K8}}],[{key:"fromJSON",value:function(i){return new t(i)}}]),t})(rt);rt.jsonID("all",us);var K8={map:function(){return this},resolve:function(e){return new us(e)}};function as(r,e,t,n,i){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(e.inlineContent)return cs.create(r,t);for(var a=n-(i>0?0:1);i>0?a<e.childCount:a>=0;a+=i){var o=e.child(a);if(o.isAtom){if(!s&&mi.isSelectable(o))return mi.create(r,t-(i<0?o.nodeSize:0))}else{var l=as(r,o,t+i,i<0?o.childCount:0,i,s);if(l)return l}t+=o.nodeSize*i}return null}function LA(r,e,t){var n=r.steps.length-1;if(!(n<e)){var i=r.steps[n];if(i instanceof tp.ReplaceStep||i instanceof tp.ReplaceAroundStep){var s=r.mapping.maps[n],a;s.forEach(function(o,l,u,c){a==null&&(a=c)}),r.setSelection(rt.near(r.doc.resolve(a),t))}}}var FA=1,Jl=2,BA=4,jA=(function(r){Xl(t,r);var e=Yl(t);function t(n){var i;return Zt(this,t),i=e.call(this,n.doc),i.curSelectionFor=0,i.updated=0,i.meta=Object.create(null),i.time=Date.now(),i.curSelection=n.selection,i.storedMarks=n.storedMarks,i}return Qt(t,[{key:"selection",get:function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}},{key:"setSelection",value:function(i){if(i.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=i,this.curSelectionFor=this.steps.length,this.updated=(this.updated|FA)&~Jl,this.storedMarks=null,this}},{key:"selectionSet",get:function(){return(this.updated&FA)>0}},{key:"setStoredMarks",value:function(i){return this.storedMarks=i,this.updated|=Jl,this}},{key:"ensureMarks",value:function(i){return mr.Mark.sameSet(this.storedMarks||this.selection.$from.marks(),i)||this.setStoredMarks(i),this}},{key:"addStoredMark",value:function(i){return this.ensureMarks(i.addToSet(this.storedMarks||this.selection.$head.marks()))}},{key:"removeStoredMark",value:function(i){return this.ensureMarks(i.removeFromSet(this.storedMarks||this.selection.$head.marks()))}},{key:"storedMarksSet",get:function(){return(this.updated&Jl)>0}},{key:"addStep",value:function(i,s){ls(Un(t.prototype),"addStep",this).call(this,i,s),this.updated=this.updated&~Jl,this.storedMarks=null}},{key:"setTime",value:function(i){return this.time=i,this}},{key:"replaceSelection",value:function(i){return this.selection.replace(this,i),this}},{key:"replaceSelectionWith",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=this.selection;return s&&(i=i.mark(this.storedMarks||(a.empty?a.$from.marks():a.$from.marksAcross(a.$to)||mr.Mark.none))),a.replaceWith(this,i),this}},{key:"deleteSelection",value:function(){return this.selection.replace(this),this}},{key:"insertText",value:function(i,s,a){var o=this.doc.type.schema;if(s==null)return i?this.replaceSelectionWith(o.text(i),!0):this.deleteSelection();if(a==null&&(a=s),!i)return this.deleteRange(s,a);var l=this.storedMarks;if(!l){var u=this.doc.resolve(s);l=a==s?u.marks():u.marksAcross(this.doc.resolve(a))}return this.replaceRangeWith(s,a,o.text(i,l)),!this.selection.empty&&this.selection.to==s+i.length&&this.setSelection(rt.near(this.selection.$to)),this}},{key:"setMeta",value:function(i,s){return this.meta[typeof i=="string"?i:i.key]=s,this}},{key:"getMeta",value:function(i){return this.meta[typeof i=="string"?i:i.key]}},{key:"isGeneric",get:function(){for(var i in this.meta)return!1;return!0}},{key:"scrollIntoView",value:function(){return this.updated|=BA,this}},{key:"scrolledIntoView",get:function(){return(this.updated&BA)>0}}]),t})(tp.Transform);function UA(r,e){return!e||!r?r:r.bind(e)}var Ro=Qt(function r(e,t,n){Zt(this,r),this.name=e,this.init=UA(t.init,n),this.apply=UA(t.apply,n)}),G8=[new Ro("doc",{init:function(e){return e.doc||e.schema.topNodeType.createAndFill()},apply:function(e){return e.doc}}),new Ro("selection",{init:function(e,t){return e.selection||rt.atStart(t.doc)},apply:function(e){return e.selection}}),new Ro("storedMarks",{init:function(e){return e.storedMarks||null},apply:function(e,t,n,i){return i.selection.$cursor?e.storedMarks:null}}),new Ro("scrollToSelection",{init:function(){return 0},apply:function(e,t){return e.scrolledIntoView?t+1:t}})],Zd=Qt(function r(e,t){var n=this;Zt(this,r),this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=G8.slice(),t&&t.forEach(function(i){if(n.pluginsByKey[i.key])throw new RangeError("Adding different instances of a keyed plugin ("+i.key+")");n.plugins.push(i),n.pluginsByKey[i.key]=i,i.spec.state&&n.fields.push(new Ro(i.key,i.spec.state,i))})}),$8=(function(){function r(e){Zt(this,r),this.config=e}return Qt(r,[{key:"schema",get:function(){return this.config.schema}},{key:"plugins",get:function(){return this.config.plugins}},{key:"apply",value:function(t){return this.applyTransaction(t).state}},{key:"filterTransaction",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,i=0;i<this.config.plugins.length;i++)if(i!=n){var s=this.config.plugins[i];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,t,this))return!1}return!0}},{key:"applyTransaction",value:function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var n=[t],i=this.applyInner(t),s=null;;){for(var a=!1,o=0;o<this.config.plugins.length;o++){var l=this.config.plugins[o];if(l.spec.appendTransaction){var u=s?s[o].n:0,c=s?s[o].state:this,f=u<n.length&&l.spec.appendTransaction.call(l,u?n.slice(u):n,c,i);if(f&&i.filterTransaction(f,o)){if(f.setMeta("appendedTransaction",t),!s){s=[];for(var d=0;d<this.config.plugins.length;d++)s.push(d<o?{state:i,n:n.length}:{state:this,n:0})}n.push(f),i=i.applyInner(f),a=!0}s&&(s[o]={state:i,n:n.length})}}if(!a)return{state:i,transactions:n}}}},{key:"applyInner",value:function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var n=new r(this.config),i=this.config.fields,s=0;s<i.length;s++){var a=i[s];n[a.name]=a.apply(t,this[a.name],this,n)}return n}},{key:"tr",get:function(){return new jA(this)}},{key:"reconfigure",value:function(t){for(var n=new Zd(this.schema,t.plugins),i=n.fields,s=new r(n),a=0;a<i.length;a++){var o=i[a].name;s[o]=this.hasOwnProperty(o)?this[o]:i[a].init(t,s)}return s}},{key:"toJSON",value:function(t){var n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(function(o){return o.toJSON()})),t&&pi(t)=="object")for(var i in t){if(i=="doc"||i=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");var s=t[i],a=s.spec.state;a&&a.toJSON&&(n[i]=a.toJSON.call(s,this[s.key]))}return n}}],[{key:"create",value:function(t){for(var n=new Zd(t.doc?t.doc.type.schema:t.schema,t.plugins),i=new r(n),s=0;s<n.fields.length;s++)i[n.fields[s].name]=n.fields[s].init(t,i);return i}},{key:"fromJSON",value:function(t,n,i){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var s=new Zd(t.schema,t.plugins),a=new r(s);return s.fields.forEach(function(o){if(o.name=="doc")a.doc=mr.Node.fromJSON(t.schema,n.doc);else if(o.name=="selection")a.selection=rt.fromJSON(a.doc,n.selection);else if(o.name=="storedMarks")n.storedMarks&&(a.storedMarks=n.storedMarks.map(t.schema.markFromJSON));else{if(i)for(var l in i){var u=i[l],c=u.spec.state;if(u.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(n,l)){a[o.name]=c.fromJSON.call(u,t,n[l],a);return}}a[o.name]=o.init(t,a)}}),a}}]),r})();function WA(r,e,t){for(var n in r){var i=r[n];i instanceof Function?i=i.bind(e):n=="handleDOMEvents"&&(i=WA(i,e,{})),t[n]=i}return t}var J8=(function(){function r(e){Zt(this,r),this.spec=e,this.props={},e.props&&WA(e.props,this,this.props),this.key=e.key?e.key.key:qA("plugin")}return Qt(r,[{key:"getState",value:function(t){return t[this.key]}}]),r})(),Qd=Object.create(null);function qA(r){return r in Qd?r+"$"+ ++Qd[r]:(Qd[r]=0,r+"$")}var X8=(function(){function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"key";Zt(this,r),this.key=qA(e)}return Qt(r,[{key:"get",value:function(t){return t.config.pluginsByKey[this.key]}},{key:"getState",value:function(t){return t[this.key]}}]),r})();Or.AllSelection=us;Or.EditorState=$8;Or.NodeSelection=mi;Or.Plugin=J8;Or.PluginKey=X8;Or.Selection=rt;Or.SelectionRange=HA;Or.TextSelection=cs;Or.Transaction=jA});var uO=xe(He=>{"use strict";var Ye=Bn(),Nr=Ln(),qe=dn(),ip=function(e,t){return e.selection.empty?!1:(t&&t(e.tr.deleteSelection().scrollIntoView()),!0)};function KA(r,e){var t=r.selection.$cursor;return!t||(e?!e.endOfTextblock("backward",r):t.parentOffset>0)?null:t}var GA=function(e,t,n){var i=KA(e,n);if(!i)return!1;var s=sp(i);if(!s){var a=i.blockRange(),o=a&&Ye.liftTarget(a);return o==null?!1:(t&&t(e.tr.lift(a,o).scrollIntoView()),!0)}var l=s.nodeBefore;if(sO(e,s,t,-1))return!0;if(i.parent.content.size==0&&(fs(l,"end")||qe.NodeSelection.isSelectable(l)))for(var u=i.depth;;u--){var c=Ye.replaceStep(e.doc,i.before(u),i.after(u),Nr.Slice.empty);if(c&&c.slice.size<c.to-c.from){if(t){var f=e.tr.step(c);f.setSelection(fs(l,"end")?qe.Selection.findFrom(f.doc.resolve(f.mapping.map(s.pos,-1)),-1):qe.NodeSelection.create(f.doc,s.pos-l.nodeSize)),t(f.scrollIntoView())}return!0}if(u==1||i.node(u-1).childCount>1)break}return l.isAtom&&s.depth==i.depth-1?(t&&t(e.tr.delete(s.pos-l.nodeSize,s.pos).scrollIntoView()),!0):!1},Y8=function(e,t,n){var i=KA(e,n);if(!i)return!1;var s=sp(i);return s?$A(e,s,t):!1},Z8=function(e,t,n){var i=XA(e,n);if(!i)return!1;var s=op(i);return s?$A(e,s,t):!1};function $A(r,e,t){for(var n=e.nodeBefore,i=n,s=e.pos-1;!i.isTextblock;s--){if(i.type.spec.isolating)return!1;var a=i.lastChild;if(!a)return!1;i=a}for(var o=e.nodeAfter,l=o,u=e.pos+1;!l.isTextblock;u++){if(l.type.spec.isolating)return!1;var c=l.firstChild;if(!c)return!1;l=c}var f=Ye.replaceStep(r.doc,s,u,Nr.Slice.empty);if(!f||f.from!=s||f instanceof Ye.ReplaceStep&&f.slice.size>=u-s)return!1;if(t){var d=r.tr.step(f);d.setSelection(qe.TextSelection.create(d.doc,s)),t(d.scrollIntoView())}return!0}function fs(r,e){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=r;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(t&&n.childCount!=1)return!1}return!1}var JA=function(e,t,n){var i=e.selection,s=i.$head,a=i.empty,o=s;if(!a)return!1;if(s.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):s.parentOffset>0)return!1;o=sp(s)}var l=o&&o.nodeBefore;return!l||!qe.NodeSelection.isSelectable(l)?!1:(t&&t(e.tr.setSelection(qe.NodeSelection.create(e.doc,o.pos-l.nodeSize)).scrollIntoView()),!0)};function sp(r){if(!r.parent.type.spec.isolating)for(var e=r.depth-1;e>=0;e--){if(r.index(e)>0)return r.doc.resolve(r.before(e+1));if(r.node(e).type.spec.isolating)break}return null}function XA(r,e){var t=r.selection.$cursor;return!t||(e?!e.endOfTextblock("forward",r):t.parentOffset<t.parent.content.size)?null:t}var YA=function(e,t,n){var i=XA(e,n);if(!i)return!1;var s=op(i);if(!s)return!1;var a=s.nodeAfter;if(sO(e,s,t,1))return!0;if(i.parent.content.size==0&&(fs(a,"start")||qe.NodeSelection.isSelectable(a))){var o=Ye.replaceStep(e.doc,i.before(),i.after(),Nr.Slice.empty);if(o&&o.slice.size<o.to-o.from){if(t){var l=e.tr.step(o);l.setSelection(fs(a,"start")?qe.Selection.findFrom(l.doc.resolve(l.mapping.map(s.pos)),1):qe.NodeSelection.create(l.doc,l.mapping.map(s.pos))),t(l.scrollIntoView())}return!0}}return a.isAtom&&s.depth==i.depth-1?(t&&t(e.tr.delete(s.pos,s.pos+a.nodeSize).scrollIntoView()),!0):!1},ZA=function(e,t,n){var i=e.selection,s=i.$head,a=i.empty,o=s;if(!a)return!1;if(s.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):s.parentOffset<s.parent.content.size)return!1;o=op(s)}var l=o&&o.nodeAfter;return!l||!qe.NodeSelection.isSelectable(l)?!1:(t&&t(e.tr.setSelection(qe.NodeSelection.create(e.doc,o.pos)).scrollIntoView()),!0)};function op(r){if(!r.parent.type.spec.isolating)for(var e=r.depth-1;e>=0;e--){var t=r.node(e);if(r.index(e)+1<t.childCount)return r.doc.resolve(r.after(e+1));if(t.type.spec.isolating)break}return null}var Q8=function(e,t){var n=e.selection,i=n instanceof qe.NodeSelection,s;if(i){if(n.node.isTextblock||!Ye.canJoin(e.doc,n.from))return!1;s=n.from}else if(s=Ye.joinPoint(e.doc,n.from,-1),s==null)return!1;if(t){var a=e.tr.join(s);i&&a.setSelection(qe.NodeSelection.create(a.doc,s-e.doc.resolve(s).nodeBefore.nodeSize)),t(a.scrollIntoView())}return!0},eF=function(e,t){var n=e.selection,i;if(n instanceof qe.NodeSelection){if(n.node.isTextblock||!Ye.canJoin(e.doc,n.to))return!1;i=n.to}else if(i=Ye.joinPoint(e.doc,n.to,1),i==null)return!1;return t&&t(e.tr.join(i).scrollIntoView()),!0},tF=function(e,t){var n=e.selection,i=n.$from,s=n.$to,a=i.blockRange(s),o=a&&Ye.liftTarget(a);return o==null?!1:(t&&t(e.tr.lift(a,o).scrollIntoView()),!0)},QA=function(e,t){var n=e.selection,i=n.$head,s=n.$anchor;return!i.parent.type.spec.code||!i.sameParent(s)?!1:(t&&t(e.tr.insertText(`
`).scrollIntoView()),!0)};function ap(r){for(var e=0;e<r.edgeCount;e++){var t=r.edge(e),n=t.type;if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}var eO=function(e,t){var n=e.selection,i=n.$head,s=n.$anchor;if(!i.parent.type.spec.code||!i.sameParent(s))return!1;var a=i.node(-1),o=i.indexAfter(-1),l=ap(a.contentMatchAt(o));if(!l||!a.canReplaceWith(o,o,l))return!1;if(t){var u=i.after(),c=e.tr.replaceWith(u,u,l.createAndFill());c.setSelection(qe.Selection.near(c.doc.resolve(u),1)),t(c.scrollIntoView())}return!0},tO=function(e,t){var n=e.selection,i=n.$from,s=n.$to;if(n instanceof qe.AllSelection||i.parent.inlineContent||s.parent.inlineContent)return!1;var a=ap(s.parent.contentMatchAt(s.indexAfter()));if(!a||!a.isTextblock)return!1;if(t){var o=(!i.parentOffset&&s.index()<s.parent.childCount?i:s).pos,l=e.tr.insert(o,a.createAndFill());l.setSelection(qe.TextSelection.create(l.doc,o+1)),t(l.scrollIntoView())}return!0},rO=function(e,t){var n=e.selection.$cursor;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){var i=n.before();if(Ye.canSplit(e.doc,i))return t&&t(e.tr.split(i).scrollIntoView()),!0}var s=n.blockRange(),a=s&&Ye.liftTarget(s);return a==null?!1:(t&&t(e.tr.lift(s,a).scrollIntoView()),!0)};function nO(r){return function(e,t){var n=e.selection,i=n.$from,s=n.$to;if(e.selection instanceof qe.NodeSelection&&e.selection.node.isBlock)return!i.parentOffset||!Ye.canSplit(e.doc,i.pos)?!1:(t&&t(e.tr.split(i.pos).scrollIntoView()),!0);if(!i.depth)return!1;for(var a=[],o,l,u=!1,c=!1,f=i.depth;;f--){var d=i.node(f);if(d.isBlock){u=i.end(f)==i.pos+(i.depth-f),c=i.start(f)==i.pos-(i.depth-f),l=ap(i.node(f-1).contentMatchAt(i.indexAfter(f-1)));var h=r&&r(s.parent,u,i);a.unshift(h||(u&&l?{type:l}:null)),o=f;break}else{if(f==1)return!1;a.unshift(null)}}var y=e.tr;(e.selection instanceof qe.TextSelection||e.selection instanceof qe.AllSelection)&&y.deleteSelection();var v=y.mapping.map(i.pos),x=Ye.canSplit(y.doc,v,a.length,a);if(x||(a[0]=l?{type:l}:null,x=Ye.canSplit(y.doc,v,a.length,a)),!x)return!1;if(y.split(v,a.length,a),!u&&c&&i.node(o).type!=l){var m=y.mapping.map(i.before(o)),_=y.doc.resolve(m);l&&i.node(o-1).canReplaceWith(_.index(),_.index()+1,l)&&y.setNodeMarkup(y.mapping.map(i.before(o)),l)}return t&&t(y.scrollIntoView()),!0}}var lp=nO(),rF=function(e,t){return lp(e,t&&function(n){var i=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();i&&n.ensureMarks(i),t(n)})},nF=function(e,t){var n=e.selection,i=n.$from,s=n.to,a,o=i.sharedDepth(s);return o==0?!1:(a=i.before(o),t&&t(e.tr.setSelection(qe.NodeSelection.create(e.doc,a))),!0)},iO=function(e,t){return t&&t(e.tr.setSelection(new qe.AllSelection(e.doc))),!0};function iF(r,e,t){var n=e.nodeBefore,i=e.nodeAfter,s=e.index();return!n||!i||!n.type.compatibleContent(i.type)?!1:!n.content.size&&e.parent.canReplace(s-1,s)?(t&&t(r.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||Ye.canJoin(r.doc,e.pos))?!1:(t&&t(r.tr.join(e.pos).scrollIntoView()),!0)}function sO(r,e,t,n){var i=e.nodeBefore,s=e.nodeAfter,a,o,l=i.type.spec.isolating||s.type.spec.isolating;if(!l&&iF(r,e,t))return!0;var u=!l&&e.parent.canReplace(e.index(),e.index()+1);if(u&&(a=(o=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&o.matchType(a[0]||s.type).validEnd){if(t){for(var c=e.pos+s.nodeSize,f=Nr.Fragment.empty,d=a.length-1;d>=0;d--)f=Nr.Fragment.from(a[d].create(null,f));f=Nr.Fragment.from(i.copy(f));var h=r.tr.step(new Ye.ReplaceAroundStep(e.pos-1,c,e.pos,c,new Nr.Slice(f,1,0),a.length,!0)),y=h.doc.resolve(c+2*a.length);y.nodeAfter&&y.nodeAfter.type==i.type&&Ye.canJoin(h.doc,y.pos)&&h.join(y.pos),t(h.scrollIntoView())}return!0}var v=s.type.spec.isolating||n>0&&l?null:qe.Selection.findFrom(e,1),x=v&&v.$from.blockRange(v.$to),m=x&&Ye.liftTarget(x);if(m!=null&&m>=e.depth)return t&&t(r.tr.lift(x,m).scrollIntoView()),!0;if(u&&fs(s,"start",!0)&&fs(i,"end")){for(var _=i,b=[];b.push(_),!_.isTextblock;)_=_.lastChild;for(var w=s,T=1;!w.isTextblock;w=w.firstChild)T++;if(_.canReplace(_.childCount,_.childCount,w.content)){if(t){for(var P=Nr.Fragment.empty,M=b.length-1;M>=0;M--)P=Nr.Fragment.from(b[M].copy(P));var U=r.tr.step(new Ye.ReplaceAroundStep(e.pos-b.length,e.pos+s.nodeSize,e.pos+T,e.pos+s.nodeSize-T,new Nr.Slice(P,b.length,0),0,!0));t(U.scrollIntoView())}return!0}}return!1}function oO(r){return function(e,t){for(var n=e.selection,i=r<0?n.$from:n.$to,s=i.depth;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(t&&t(e.tr.setSelection(qe.TextSelection.create(e.doc,r<0?i.start(s):i.end(s)))),!0):!1}}var aO=oO(-1),lO=oO(1);function sF(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return function(t,n){var i=t.selection,s=i.$from,a=i.$to,o=s.blockRange(a),l=o&&Ye.findWrapping(o,r,e);return l?(n&&n(t.tr.wrap(o,l).scrollIntoView()),!0):!1}}function oF(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return function(t,n){for(var i=!1,s=0;s<t.selection.ranges.length&&!i;s++){var a=t.selection.ranges[s],o=a.$from.pos,l=a.$to.pos;t.doc.nodesBetween(o,l,function(y,v){if(i)return!1;if(!(!y.isTextblock||y.hasMarkup(r,e)))if(y.type==r)i=!0;else{var x=t.doc.resolve(v),m=x.index();i=x.parent.canReplaceWith(m,m+1,r)}})}if(!i)return!1;if(n){for(var u=t.tr,c=0;c<t.selection.ranges.length;c++){var f=t.selection.ranges[c],d=f.$from.pos,h=f.$to.pos;u.setBlockType(d,h,r,e)}n(u.scrollIntoView())}return!0}}function aF(r,e,t,n){for(var i=function(){var l=e[a],u=l.$from,c=l.$to,f=u.depth==0?r.inlineContent&&r.type.allowsMarkType(t):!1;if(r.nodesBetween(u.pos,c.pos,function(d,h){if(f||!n&&d.isAtom&&d.isInline&&h>=u.pos&&h+d.nodeSize<=c.pos)return!1;f=d.inlineContent&&d.type.allowsMarkType(t)}),f)return{v:!0}},s,a=0;a<e.length;a++)if(s=i(),s)return s.v;return!1}function lF(r){for(var e=[],t=function(){var s=r[n],a=s.$from,o=s.$to;a.doc.nodesBetween(a.pos,o.pos,function(l,u){if(l.isAtom&&l.content.size&&l.isInline&&u>=a.pos&&u+l.nodeSize<=o.pos)return u+1>a.pos&&e.push(new qe.SelectionRange(a,a.doc.resolve(u+1))),a=a.doc.resolve(u+1+l.content.size),!1}),a.pos<o.pos&&e.push(new qe.SelectionRange(a,o))},n=0;n<r.length;n++)t();return e}function uF(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2?arguments[2]:void 0,n=(t&&t.removeWhenPresent)!==!1,i=(t&&t.enterInlineAtoms)!==!1,s=!(t&&t.includeWhitespace);return function(a,o){var l=a.selection,u=l.empty,c=l.$cursor,f=l.ranges;if(u&&!c||!aF(a.doc,f,r,i))return!1;if(o)if(c)r.isInSet(a.storedMarks||c.marks())?o(a.tr.removeStoredMark(r)):o(a.tr.addStoredMark(r.create(e)));else{var d,h=a.tr;i||(f=lF(f)),n?d=!f.some(function(U){return a.doc.rangeHasMark(U.$from.pos,U.$to.pos,r)}):d=!f.every(function(U){var R=!1;return h.doc.nodesBetween(U.$from.pos,U.$to.pos,function(J,oe,C){if(R)return!1;R=!r.isInSet(J.marks)&&!!C&&C.type.allowsMarkType(r)&&!(J.isText&&/^\s*$/.test(J.textBetween(Math.max(0,U.$from.pos-oe),Math.min(J.nodeSize,U.$to.pos-oe))))}),!R});for(var y=0;y<f.length;y++){var v=f[y],x=v.$from,m=v.$to;if(!d)h.removeMark(x.pos,m.pos,r);else{var _=x.pos,b=m.pos,w=x.nodeAfter,T=m.nodeBefore,P=s&&w&&w.isText?/^\s*/.exec(w.text)[0].length:0,M=s&&T&&T.isText?/\s*$/.exec(T.text)[0].length:0;_+P<b&&(_+=P,b-=M),h.addMark(_,b,r.create(e))}}o(h.scrollIntoView())}return!0}}function cF(r,e){return function(t){if(!t.isGeneric)return r(t);for(var n=[],i=0;i<t.mapping.maps.length;i++){for(var s=t.mapping.maps[i],a=0;a<n.length;a++)n[a]=s.map(n[a]);s.forEach(function(b,w,T,P){return n.push(T,P)})}for(var o=[],l=0;l<n.length;l+=2)for(var u=n[l],c=n[l+1],f=t.doc.resolve(u),d=f.sharedDepth(c),h=f.node(d),y=f.indexAfter(d),v=f.after(d+1);v<=c;++y){var x=h.maybeChild(y);if(!x)break;if(y&&o.indexOf(v)==-1){var m=h.child(y-1);m.type==x.type&&e(m,x)&&o.push(v)}v+=x.nodeSize}o.sort(function(b,w){return b-w});for(var _=o.length-1;_>=0;_--)Ye.canJoin(t.doc,o[_])&&t.join(o[_]);r(t)}}function fF(r,e){var t=Array.isArray(e)?function(n){return e.indexOf(n.type.name)>-1}:e;return function(n,i,s){return r(n,i&&cF(i,t),s)}}function Zl(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return function(n,i,s){for(var a=0;a<e.length;a++)if(e[a](n,i,s))return!0;return!1}}var rp=Zl(ip,GA,JA),VA=Zl(ip,YA,ZA),Rr={Enter:Zl(QA,tO,rO,lp),"Mod-Enter":eO,Backspace:rp,"Mod-Backspace":rp,"Shift-Backspace":rp,Delete:VA,"Mod-Delete":VA,"Mod-a":iO},up={"Ctrl-h":Rr.Backspace,"Alt-Backspace":Rr["Mod-Backspace"],"Ctrl-d":Rr.Delete,"Ctrl-Alt-Backspace":Rr["Mod-Delete"],"Alt-Delete":Rr["Mod-Delete"],"Alt-d":Rr["Mod-Delete"],"Ctrl-a":aO,"Ctrl-e":lO};for(np in Rr)up[np]=Rr[np];var np,hF=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,dF=hF?up:Rr;He.autoJoin=fF;He.baseKeymap=dF;He.chainCommands=Zl;He.createParagraphNear=tO;He.deleteSelection=ip;He.exitCode=eO;He.joinBackward=GA;He.joinDown=eF;He.joinForward=YA;He.joinTextblockBackward=Y8;He.joinTextblockForward=Z8;He.joinUp=Q8;He.lift=tF;He.liftEmptyBlock=rO;He.macBaseKeymap=up;He.newlineInCode=QA;He.pcBaseKeymap=Rr;He.selectAll=iO;He.selectNodeBackward=JA;He.selectNodeForward=ZA;He.selectParentNode=nF;He.selectTextblockEnd=lO;He.selectTextblockStart=aO;He.setBlockType=oF;He.splitBlock=lp;He.splitBlockAs=nO;He.splitBlockKeepMarks=rF;He.toggleMark=uF;He.wrapIn=sF});var bt=xe(Ql=>{"use strict";Object.defineProperty(Ql,"__esModule",{value:!0});function pF(r){Object.keys(r).filter(e=>e!=="default"&&e!=="__esModule").forEach(e=>{Ql.hasOwnProperty(e)||Object.defineProperty(Ql,e,{enumerable:!0,configurable:!0,get:()=>r[e]})})}var mF=uO();pF(mF)});var Pe=xe(eu=>{"use strict";Object.defineProperty(eu,"__esModule",{value:!0});function gF(r){Object.keys(r).filter(e=>e!=="default"&&e!=="__esModule").forEach(e=>{eu.hasOwnProperty(e)||Object.defineProperty(eu,e,{enumerable:!0,configurable:!0,get:()=>r[e]})})}var vF=dn();gF(vF)});var gr=xe(tu=>{"use strict";Object.defineProperty(tu,"__esModule",{value:!0});function yF(r){Object.keys(r).filter(e=>e!=="default"&&e!=="__esModule").forEach(e=>{tu.hasOwnProperty(e)||Object.defineProperty(tu,e,{enumerable:!0,configurable:!0,get:()=>r[e]})})}var wF=Ln();yF(wF)});var mO=xe(vr=>{"use strict";var pn=Bn(),Ke=Ln(),bF=dn(),_F=["ol",0],xF=["ul",0],EF=["li",0],cO={attrs:{order:{default:1,validate:"number"}},parseDOM:[{tag:"ol",getAttrs:function(e){return{order:e.hasAttribute("start")?+e.getAttribute("start"):1}}}],toDOM:function(e){return e.attrs.order==1?_F:["ol",{start:e.attrs.order},0]}},fO={parseDOM:[{tag:"ul"}],toDOM:function(){return xF}},hO={parseDOM:[{tag:"li"}],toDOM:function(){return EF},defining:!0};function cp(r,e){var t={};for(var n in r)t[n]=r[n];for(var i in e)t[i]=e[i];return t}function SF(r,e,t){return r.append({ordered_list:cp(cO,{content:"list_item+",group:t}),bullet_list:cp(fO,{content:"list_item+",group:t}),list_item:cp(hO,{content:e})})}function kF(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return function(t,n){var i=t.selection,s=i.$from,a=i.$to,o=s.blockRange(a);if(!o)return!1;var l=n?t.tr:null;return dO(l,o,r,e)?(n&&n(l.scrollIntoView()),!0):!1}}function dO(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=!1,s=e,a=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;var o=a.resolve(e.start-2);s=new Ke.NodeRange(o,o,e.depth),e.endIndex<e.parent.childCount&&(e=new Ke.NodeRange(e.$from,a.resolve(e.$to.end(e.depth)),e.depth)),i=!0}var l=pn.findWrapping(s,t,n,e);return l?(r&&TF(r,e,l,i,t),!0):!1}function TF(r,e,t,n,i){for(var s=Ke.Fragment.empty,a=t.length-1;a>=0;a--)s=Ke.Fragment.from(t[a].type.create(t[a].attrs,s));r.step(new pn.ReplaceAroundStep(e.start-(n?2:0),e.end,e.start,e.end,new Ke.Slice(s,0,0),t.length,!0));for(var o=0,l=0;l<t.length;l++)t[l].type==i&&(o=l+1);for(var u=t.length-o,c=e.start+t.length-(n?2:0),f=e.parent,d=e.startIndex,h=e.endIndex,y=!0;d<h;d++,y=!1)!y&&pn.canSplit(r.doc,c,u)&&(r.split(c,u),c+=2*u),c+=f.child(d).nodeSize;return r}function pO(r,e){return function(t,n){var i=t.selection,s=i.$from,a=i.$to,o=i.node;if(o&&o.isBlock||s.depth<2||!s.sameParent(a))return!1;var l=s.node(-1);if(l.type!=r)return!1;if(s.parent.content.size==0&&s.node(-1).childCount==s.indexAfter(-1)){if(s.depth==3||s.node(-3).type!=r||s.index(-2)!=s.node(-2).childCount-1)return!1;if(n){for(var u=Ke.Fragment.empty,c=s.index(-1)?1:s.index(-2)?2:3,f=s.depth-c;f>=s.depth-3;f--)u=Ke.Fragment.from(s.node(f).copy(u));var d=s.indexAfter(-1)<s.node(-2).childCount?1:s.indexAfter(-2)<s.node(-3).childCount?2:3;u=u.append(Ke.Fragment.from(r.createAndFill()));var h=s.before(s.depth-(c-1)),y=t.tr.replace(h,s.after(-d),new Ke.Slice(u,4-c,0)),v=-1;y.doc.nodesBetween(h,y.doc.content.size,function(b,w){if(v>-1)return!1;b.isTextblock&&b.content.size==0&&(v=w+1)}),v>-1&&y.setSelection(bF.Selection.near(y.doc.resolve(v))),n(y.scrollIntoView())}return!0}var x=a.pos==s.end()?l.contentMatchAt(0).defaultType:null,m=t.tr.delete(s.pos,a.pos),_=x?[e?{type:r,attrs:e}:null,{type:x}]:void 0;return pn.canSplit(m.doc,s.pos,2,_)?(n&&n(m.split(s.pos,2,_).scrollIntoView()),!0):!1}}function AF(r,e){var t=pO(r,e);return function(n,i){return t(n,i&&function(s){var a=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();a&&s.ensureMarks(a),i(s)})}}function OF(r){return function(e,t){var n=e.selection,i=n.$from,s=n.$to,a=i.blockRange(s,function(o){return o.childCount>0&&o.firstChild.type==r});return a?t?i.node(a.depth-1).type==r?NF(e,t,r,a):RF(e,t,a):!0:!1}}function NF(r,e,t,n){var i=r.tr,s=n.end,a=n.$to.end(n.depth);s<a&&(i.step(new pn.ReplaceAroundStep(s-1,a,s,a,new Ke.Slice(Ke.Fragment.from(t.create(null,n.parent.copy())),1,0),1,!0)),n=new Ke.NodeRange(i.doc.resolve(n.$from.pos),i.doc.resolve(a),n.depth));var o=pn.liftTarget(n);if(o==null)return!1;i.lift(n,o);var l=i.doc.resolve(i.mapping.map(s,-1)-1);return pn.canJoin(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),e(i.scrollIntoView()),!0}function RF(r,e,t){for(var n=r.tr,i=t.parent,s=t.end,a=t.endIndex-1,o=t.startIndex;a>o;a--)s-=i.child(a).nodeSize,n.delete(s-1,s+1);var l=n.doc.resolve(t.start),u=l.nodeAfter;if(n.mapping.map(t.end)!=t.start+l.nodeAfter.nodeSize)return!1;var c=t.startIndex==0,f=t.endIndex==i.childCount,d=l.node(-1),h=l.index(-1);if(!d.canReplace(h+(c?0:1),h+1,u.content.append(f?Ke.Fragment.empty:Ke.Fragment.from(i))))return!1;var y=l.pos,v=y+u.nodeSize;return n.step(new pn.ReplaceAroundStep(y-(c?1:0),v+(f?1:0),y+1,v-1,new Ke.Slice((c?Ke.Fragment.empty:Ke.Fragment.from(i.copy(Ke.Fragment.empty))).append(f?Ke.Fragment.empty:Ke.Fragment.from(i.copy(Ke.Fragment.empty))),c?0:1,f?0:1),c?0:1)),e(n.scrollIntoView()),!0}function CF(r){return function(e,t){var n=e.selection,i=n.$from,s=n.$to,a=i.blockRange(s,function(v){return v.childCount>0&&v.firstChild.type==r});if(!a)return!1;var o=a.startIndex;if(o==0)return!1;var l=a.parent,u=l.child(o-1);if(u.type!=r)return!1;if(t){var c=u.lastChild&&u.lastChild.type==l.type,f=Ke.Fragment.from(c?r.create():null),d=new Ke.Slice(Ke.Fragment.from(r.create(null,Ke.Fragment.from(l.type.create(null,f)))),c?3:1,0),h=a.start,y=a.end;t(e.tr.step(new pn.ReplaceAroundStep(h-(c?3:1),y,h,y,d,1,!0)).scrollIntoView())}return!0}}vr.addListNodes=SF;vr.bulletList=fO;vr.liftListItem=OF;vr.listItem=hO;vr.orderedList=cO;vr.sinkListItem=CF;vr.splitListItem=pO;vr.splitListItemKeepMarks=AF;vr.wrapInList=kF;vr.wrapRangeInList=dO});var nu=xe(ru=>{"use strict";Object.defineProperty(ru,"__esModule",{value:!0});function IF(r){Object.keys(r).filter(e=>e!=="default"&&e!=="__esModule").forEach(e=>{ru.hasOwnProperty(e)||Object.defineProperty(ru,e,{enumerable:!0,configurable:!0,get:()=>r[e]})})}var PF=mO();IF(PF)});var Bp=xe(bs=>{"use strict";function ZO(r,e){return LF(r)||MF(r,e)||QO(r,e)||DF()}function DF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MF(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,i,s,a,o=[],l=!0,u=!1;try{if(s=(t=t.call(r)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=s.call(t)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function LF(r){if(Array.isArray(r))return r}function vp(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=QO(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(u){throw u},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){t=t.call(r)},n:function(){var u=t.next();return s=u.done,u},e:function(u){a=!0,o=u},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(a)throw o}}}}function QO(r,e){if(r){if(typeof r=="string")return gO(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return gO(r,e)}}function gO(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Dt(){return typeof Reflect<"u"&&Reflect.get?Dt=Reflect.get.bind():Dt=function(e,t,n){var i=FF(e,t);if(i){var s=Object.getOwnPropertyDescriptor(i,t);return s.get?s.get.call(arguments.length<3?e:n):s.value}},Dt.apply(this,arguments)}function FF(r,e){for(;!Object.prototype.hasOwnProperty.call(r,e)&&(r=_t(r),r!==null););return r}function xi(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&yp(r,e)}function yp(r,e){return yp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yp(r,e)}function Ei(r){var e=UF();return function(){var n=_t(r),i;if(e){var s=_t(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return BF(this,i)}}function BF(r,e){if(e&&(vs(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eN(r)}function eN(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function UF(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _t(r){return _t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_t(r)}function vs(r){"@babel/helpers - typeof";return vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vs(r)}function nt(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function vO(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,HF(n.key),n)}}function it(r,e,t){return e&&vO(r.prototype,e),t&&vO(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function HF(r){var e=zF(r,"string");return vs(e)==="symbol"?e:String(e)}function zF(r,e){if(vs(r)!=="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(vs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Ae=dn(),Xe=Ln(),jF=Bn(),xt=function(e){for(var t=0;;t++)if(e=e.previousSibling,!e)return t},ys=function(e){var t=e.assignedSlot||e.parentNode;return t&&t.nodeType==11?t.host:t},wp=null,gn=function(e,t,n){var i=wp||(wp=document.createRange());return i.setEnd(e,n??e.nodeValue.length),i.setStart(e,t||0),i},WF=function(){wp=null},_i=function(e,t,n,i){return n&&(yO(e,t,n,i,-1)||yO(e,t,n,i,1))},qF=/^(img|br|input|textarea|hr)$/i;function yO(r,e,t,n,i){for(var s;;){if(r==t&&e==n)return!0;if(e==(i<0?0:rr(r))){var a=r.parentNode;if(!a||a.nodeType!=1||Uo(r)||qF.test(r.nodeName)||r.contentEditable=="false")return!1;e=xt(r)+(i<0?0:1),r=a}else if(r.nodeType==1){var o=r.childNodes[e+(i<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((s=o.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)e+=i;else return!1;else r=o,e=i<0?rr(r):0}else return!1}}function rr(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function VF(r,e){for(;;){if(r.nodeType==3&&e)return r;if(r.nodeType==1&&e>0){if(r.contentEditable=="false")return null;r=r.childNodes[e-1],e=rr(r)}else if(r.parentNode&&!Uo(r))e=xt(r),r=r.parentNode;else return null}}function KF(r,e){for(;;){if(r.nodeType==3&&e<r.nodeValue.length)return r;if(r.nodeType==1&&e<r.childNodes.length){if(r.contentEditable=="false")return null;r=r.childNodes[e],e=0}else if(r.parentNode&&!Uo(r))e=xt(r)+1,r=r.parentNode;else return null}}function GF(r,e,t){for(var n=e==0,i=e==rr(r);n||i;){if(r==t)return!0;var s=xt(r);if(r=r.parentNode,!r)return!1;n=n&&s==0,i=i&&s==rr(r)}}function Uo(r){for(var e,t=r;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==r||e.contentDOM==r)}var lu=function(e){return e.focusNode&&_i(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function gi(r,e){var t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=r,t.key=t.code=e,t}function $F(r){for(var e=r.activeElement;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function JF(r,e,t){if(r.caretPositionFromPoint)try{var n=r.caretPositionFromPoint(e,t);if(n)return{node:n.offsetNode,offset:Math.min(rr(n.offsetNode),n.offset)}}catch{}if(r.caretRangeFromPoint){var i=r.caretRangeFromPoint(e,t);if(i)return{node:i.startContainer,offset:Math.min(rr(i.startContainer),i.startOffset)}}}var Cr=typeof navigator<"u"?navigator:null,wO=typeof document<"u"?document:null,qn=Cr&&Cr.userAgent||"",bp=/Edge\/(\d+)/.exec(qn),tN=/MSIE \d/.exec(qn),_p=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(qn),qt=!!(tN||_p||bp),Wn=tN?document.documentMode:_p?+_p[1]:bp?+bp[1]:0,nr=!qt&&/gecko\/(\d+)/i.test(qn);nr&&+(/Firefox\/(\d+)/.exec(qn)||[0,0])[1];var xp=!qt&&/Chrome\/(\d+)/.exec(qn),Rt=!!xp,rN=xp?+xp[1]:0,Mt=!qt&&!!Cr&&/Apple Computer/.test(Cr.vendor),ws=Mt&&(/Mobile\/\w+/.test(qn)||!!Cr&&Cr.maxTouchPoints>2),tr=ws||(Cr?/Mac/.test(Cr.platform):!1),XF=Cr?/Win/.test(Cr.platform):!1,vn=/Android \d/.test(qn),Ho=!!wO&&"webkitFontSmoothing"in wO.documentElement.style,YF=Ho?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function ZF(r){var e=r.defaultView&&r.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:r.documentElement.clientWidth,top:0,bottom:r.documentElement.clientHeight}}function mn(r,e){return typeof r=="number"?r:r[e]}function QF(r){var e=r.getBoundingClientRect(),t=e.width/r.offsetWidth||1,n=e.height/r.offsetHeight||1;return{left:e.left,right:e.left+r.clientWidth*t,top:e.top,bottom:e.top+r.clientHeight*n}}function bO(r,e,t){for(var n=r.someProp("scrollThreshold")||0,i=r.someProp("scrollMargin")||5,s=r.dom.ownerDocument,a=t||r.dom;a;){if(a.nodeType!=1){a=ys(a);continue}var o=a,l=o==s.body,u=l?ZF(s):QF(o),c=0,f=0;if(e.top<u.top+mn(n,"top")?f=-(u.top-e.top+mn(i,"top")):e.bottom>u.bottom-mn(n,"bottom")&&(f=e.bottom-e.top>u.bottom-u.top?e.top+mn(i,"top")-u.top:e.bottom-u.bottom+mn(i,"bottom")),e.left<u.left+mn(n,"left")?c=-(u.left-e.left+mn(i,"left")):e.right>u.right-mn(n,"right")&&(c=e.right-u.right+mn(i,"right")),c||f)if(l)s.defaultView.scrollBy(c,f);else{var d=o.scrollLeft,h=o.scrollTop;f&&(o.scrollTop+=f),c&&(o.scrollLeft+=c);var y=o.scrollLeft-d,v=o.scrollTop-h;e={left:e.left-y,top:e.top-v,right:e.right-y,bottom:e.bottom-v}}var x=l?"fixed":getComputedStyle(a).position;if(/^(fixed|sticky)$/.test(x))break;a=x=="absolute"?a.offsetParent:ys(a)}}function eB(r){for(var e=r.dom.getBoundingClientRect(),t=Math.max(0,e.top),n,i,s=(e.left+e.right)/2,a=t+1;a<Math.min(innerHeight,e.bottom);a+=5){var o=r.root.elementFromPoint(s,a);if(!(!o||o==r.dom||!r.dom.contains(o))){var l=o.getBoundingClientRect();if(l.top>=t-20){n=o,i=l.top;break}}}return{refDOM:n,refTop:i,stack:nN(r.dom)}}function nN(r){for(var e=[],t=r.ownerDocument,n=r;n&&(e.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),r!=t);n=ys(n));return e}function tB(r){var e=r.refDOM,t=r.refTop,n=r.stack,i=e?e.getBoundingClientRect().top:0;iN(n,i==0?0:i-t)}function iN(r,e){for(var t=0;t<r.length;t++){var n=r[t],i=n.dom,s=n.top,a=n.left;i.scrollTop!=s+e&&(i.scrollTop=s+e),i.scrollLeft!=a&&(i.scrollLeft=a)}}var hs=null;function rB(r){if(r.setActive)return r.setActive();if(hs)return r.focus(hs);var e=nN(r);r.focus(hs==null?{get preventScroll(){return hs={preventScroll:!0},!0}}:void 0),hs||(hs=!1,iN(e,0))}function sN(r,e){for(var t,n=2e8,i,s=0,a=e.top,o=e.top,l,u,c=r.firstChild,f=0;c;c=c.nextSibling,f++){var d=void 0;if(c.nodeType==1)d=c.getClientRects();else if(c.nodeType==3)d=gn(c).getClientRects();else continue;for(var h=0;h<d.length;h++){var y=d[h];if(y.top<=a&&y.bottom>=o){a=Math.max(y.bottom,a),o=Math.min(y.top,o);var v=y.left>e.left?y.left-e.left:y.right<e.left?e.left-y.right:0;if(v<n){t=c,n=v,i=v&&t.nodeType==3?{left:y.right<e.left?y.right:y.left,top:e.top}:e,c.nodeType==1&&v&&(s=f+(e.left>=(y.left+y.right)/2?1:0));continue}}else y.top>e.top&&!l&&y.left<=e.left&&y.right>=e.left&&(l=c,u={left:Math.max(y.left,Math.min(y.right,e.left)),top:y.top});!t&&(e.left>=y.right&&e.top>=y.top||e.left>=y.left&&e.top>=y.bottom)&&(s=f+1)}}return!t&&l&&(t=l,i=u,n=0),t&&t.nodeType==3?nB(t,i):!t||n&&t.nodeType==1?{node:r,offset:s}:sN(t,i)}function nB(r,e){for(var t=r.nodeValue.length,n=document.createRange(),i=0;i<t;i++){n.setEnd(r,i+1),n.setStart(r,i);var s=Hn(n,1);if(s.top!=s.bottom&&Np(e,s))return{node:r,offset:i+(e.left>=(s.left+s.right)/2?1:0)}}return{node:r,offset:0}}function Np(r,e){return r.left>=e.left-1&&r.left<=e.right+1&&r.top>=e.top-1&&r.top<=e.bottom+1}function iB(r,e){var t=r.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<r.getBoundingClientRect().left?t:r}function sB(r,e,t){var n=sN(e,t),i=n.node,s=n.offset,a=-1;if(i.nodeType==1&&!i.firstChild){var o=i.getBoundingClientRect();a=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return r.docView.posFromDOM(i,s,a)}function oB(r,e,t,n){for(var i=-1,s=e,a=!1;s!=r.dom;){var o=r.docView.nearestDesc(s,!0),l=void 0;if(!o)return null;if(o.dom.nodeType==1&&(o.node.isBlock&&o.parent||!o.contentDOM)&&((l=o.dom.getBoundingClientRect()).width||l.height)&&(o.node.isBlock&&o.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(o.dom.nodeName)&&(!a&&l.left>n.left||l.top>n.top?i=o.posBefore:(!a&&l.right<n.left||l.bottom<n.top)&&(i=o.posAfter),a=!0),!o.contentDOM&&i<0&&!o.node.isText)){var u=o.node.isBlock?n.top<(l.top+l.bottom)/2:n.left<(l.left+l.right)/2;return u?o.posBefore:o.posAfter}s=o.dom.parentNode}return i>-1?i:r.docView.posFromDOM(e,t,-1)}function oN(r,e,t){var n=r.childNodes.length;if(n&&t.top<t.bottom)for(var i=Math.max(0,Math.min(n-1,Math.floor(n*(e.top-t.top)/(t.bottom-t.top))-2)),s=i;;){var a=r.childNodes[s];if(a.nodeType==1)for(var o=a.getClientRects(),l=0;l<o.length;l++){var u=o[l];if(Np(e,u))return oN(a,e,u)}if((s=(s+1)%n)==i)break}return r}function aB(r,e){var t=r.dom.ownerDocument,n,i=0,s=JF(t,e.left,e.top);s&&(n=s.node,i=s.offset);var a=(r.root.elementFromPoint?r.root:t).elementFromPoint(e.left,e.top),o;if(!a||!r.dom.contains(a.nodeType!=1?a.parentNode:a)){var l=r.dom.getBoundingClientRect();if(!Np(e,l)||(a=oN(r.dom,e,l),!a))return null}if(Mt)for(var u=a;n&&u;u=ys(u))u.draggable&&(n=void 0);if(a=iB(a,e),n){if(nr&&n.nodeType==1&&(i=Math.min(i,n.childNodes.length),i<n.childNodes.length)){var c=n.childNodes[i],f;c.nodeName=="IMG"&&(f=c.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&i++}var d;Ho&&i&&n.nodeType==1&&(d=n.childNodes[i-1]).nodeType==1&&d.contentEditable=="false"&&d.getBoundingClientRect().top>=e.top&&i--,n==r.dom&&i==n.childNodes.length-1&&n.lastChild.nodeType==1&&e.top>n.lastChild.getBoundingClientRect().bottom?o=r.state.doc.content.size:(i==0||n.nodeType!=1||n.childNodes[i-1].nodeName!="BR")&&(o=oB(r,n,i,e))}o==null&&(o=sB(r,a,e));var h=r.docView.nearestDesc(a,!0);return{pos:o,inside:h?h.posAtStart-h.border:-1}}function _O(r){return r.top<r.bottom||r.left<r.right}function Hn(r,e){var t=r.getClientRects();if(t.length){var n=t[e<0?0:t.length-1];if(_O(n))return n}return Array.prototype.find.call(t,_O)||r.getBoundingClientRect()}var lB=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function aN(r,e,t){var n=r.docView.domFromPos(e,t<0?-1:1),i=n.node,s=n.offset,a=n.atom,o=Ho||nr;if(i.nodeType==3)if(o&&(lB.test(i.nodeValue)||(t<0?!s:s==i.nodeValue.length))){var l=Hn(gn(i,s,s),t);if(nr&&s&&/\s/.test(i.nodeValue[s-1])&&s<i.nodeValue.length){var u=Hn(gn(i,s-1,s-1),-1);if(u.top==l.top){var c=Hn(gn(i,s,s+1),-1);if(c.top!=l.top)return Co(c,c.left<u.left)}}return l}else{var f=s,d=s,h=t<0?1:-1;return t<0&&!s?(d++,h=-1):t>=0&&s==i.nodeValue.length?(f--,h=1):t<0?f--:d++,Co(Hn(gn(i,f,d),h),h<0)}var y=r.state.doc.resolve(e-(a||0));if(!y.parent.inlineContent){if(a==null&&s&&(t<0||s==rr(i))){var v=i.childNodes[s-1];if(v.nodeType==1)return fp(v.getBoundingClientRect(),!1)}if(a==null&&s<rr(i)){var x=i.childNodes[s];if(x.nodeType==1)return fp(x.getBoundingClientRect(),!0)}return fp(i.getBoundingClientRect(),t>=0)}if(a==null&&s&&(t<0||s==rr(i))){var m=i.childNodes[s-1],_=m.nodeType==3?gn(m,rr(m)-(o?0:1)):m.nodeType==1&&(m.nodeName!="BR"||!m.nextSibling)?m:null;if(_)return Co(Hn(_,1),!1)}if(a==null&&s<rr(i)){for(var b=i.childNodes[s];b.pmViewDesc&&b.pmViewDesc.ignoreForCoords;)b=b.nextSibling;var w=b?b.nodeType==3?gn(b,0,o?0:1):b.nodeType==1?b:null:null;if(w)return Co(Hn(w,-1),!0)}return Co(Hn(i.nodeType==3?gn(i):i,-t),t>=0)}function Co(r,e){if(r.width==0)return r;var t=e?r.left:r.right;return{top:r.top,bottom:r.bottom,left:t,right:t}}function fp(r,e){if(r.height==0)return r;var t=e?r.top:r.bottom;return{top:t,bottom:t,left:r.left,right:r.right}}function lN(r,e,t){var n=r.state,i=r.root.activeElement;n!=e&&r.updateState(e),i!=r.dom&&r.focus();try{return t()}finally{n!=e&&r.updateState(n),i!=r.dom&&i&&i.focus()}}function uB(r,e,t){var n=e.selection,i=t=="up"?n.$from:n.$to;return lN(r,e,function(){for(var s=r.docView.domFromPos(i.pos,t=="up"?-1:1),a=s.node;;){var o=r.docView.nearestDesc(a,!0);if(!o)break;if(o.node.isBlock){a=o.contentDOM||o.dom;break}a=o.dom.parentNode}for(var l=aN(r,i.pos,1),u=a.firstChild;u;u=u.nextSibling){var c=void 0;if(u.nodeType==1)c=u.getClientRects();else if(u.nodeType==3)c=gn(u,0,u.nodeValue.length).getClientRects();else continue;for(var f=0;f<c.length;f++){var d=c[f];if(d.bottom>d.top+1&&(t=="up"?l.top-d.top>(d.bottom-l.top)*2:d.bottom-l.bottom>(l.bottom-d.top)*2))return!1}}return!0})}var cB=/[\u0590-\u08ac]/;function fB(r,e,t){var n=e.selection.$head;if(!n.parent.isTextblock)return!1;var i=n.parentOffset,s=!i,a=i==n.parent.content.size,o=r.domSelection();return o?!cB.test(n.parent.textContent)||!o.modify?t=="left"||t=="backward"?s:a:lN(r,e,function(){var l=r.domSelectionRange(),u=l.focusNode,c=l.focusOffset,f=l.anchorNode,d=l.anchorOffset,h=o.caretBidiLevel;o.modify("move",t,"character");var y=n.depth?r.docView.domAfterPos(n.before()):r.dom,v=r.domSelectionRange(),x=v.focusNode,m=v.focusOffset,_=x&&!y.contains(x.nodeType==1?x:x.parentNode)||u==x&&c==m;try{o.collapse(f,d),u&&(u!=f||c!=d)&&o.extend&&o.extend(u,c)}catch{}return h!=null&&(o.caretBidiLevel=h),_}):n.pos==n.start()||n.pos==n.end()}var xO=null,EO=null,SO=!1;function hB(r,e,t){return xO==e&&EO==t?SO:(xO=e,EO=t,SO=t=="up"||t=="down"?uB(r,e,t):fB(r,e,t))}var ir=0,kO=1,vi=2,Ir=3,zo=(function(){function r(e,t,n,i){nt(this,r),this.parent=e,this.children=t,this.dom=n,this.contentDOM=i,this.dirty=ir,n.pmViewDesc=this}return it(r,[{key:"matchesWidget",value:function(t){return!1}},{key:"matchesMark",value:function(t){return!1}},{key:"matchesNode",value:function(t,n,i){return!1}},{key:"matchesHack",value:function(t){return!1}},{key:"parseRule",value:function(){return null}},{key:"stopEvent",value:function(t){return!1}},{key:"size",get:function(){for(var t=0,n=0;n<this.children.length;n++)t+=this.children[n].size;return t}},{key:"border",get:function(){return 0}},{key:"destroy",value:function(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(var t=0;t<this.children.length;t++)this.children[t].destroy()}},{key:"posBeforeChild",value:function(t){for(var n=0,i=this.posAtStart;;n++){var s=this.children[n];if(s==t)return i;i+=s.size}}},{key:"posBefore",get:function(){return this.parent.posBeforeChild(this)}},{key:"posAtStart",get:function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}},{key:"posAfter",get:function(){return this.posBefore+this.size}},{key:"posAtEnd",get:function(){return this.posAtStart+this.size-2*this.border}},{key:"localPosFromDOM",value:function(t,n,i){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(i<0){var s,a;if(t==this.contentDOM)s=t.childNodes[n-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.previousSibling}for(;s&&!((a=s.pmViewDesc)&&a.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(a)+a.size:this.posAtStart}else{var o,l;if(t==this.contentDOM)o=t.childNodes[n];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;o=t.nextSibling}for(;o&&!((l=o.pmViewDesc)&&l.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(l):this.posAtEnd}var u;if(t==this.dom&&this.contentDOM)u=n>xt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))u=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(var c=t;;c=c.parentNode){if(c==this.dom){u=!1;break}if(c.previousSibling)break}if(u==null&&n==t.childNodes.length)for(var f=t;;f=f.parentNode){if(f==this.dom){u=!0;break}if(f.nextSibling)break}}return u??i>0?this.posAtEnd:this.posAtStart}},{key:"nearestDesc",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=!0,s=t;s;s=s.parentNode){var a=this.getDesc(s),o=void 0;if(a&&(!n||a.node))if(i&&(o=a.nodeDOM)&&!(o.nodeType==1?o.contains(t.nodeType==1?t:t.parentNode):o==t))i=!1;else return a}}},{key:"getDesc",value:function(t){for(var n=t.pmViewDesc,i=n;i;i=i.parent)if(i==this)return n}},{key:"posFromDOM",value:function(t,n,i){for(var s=t;s;s=s.parentNode){var a=this.getDesc(s);if(a)return a.localPosFromDOM(t,n,i)}return-1}},{key:"descAt",value:function(t){for(var n=0,i=0;n<this.children.length;n++){var s=this.children[n],a=i+s.size;if(i==t&&a!=i){for(;!s.border&&s.children.length;)for(var o=0;o<s.children.length;o++){var l=s.children[o];if(l.size){s=l;break}}return s}if(t<a)return s.descAt(t-i-s.border);i=a}}},{key:"domFromPos",value:function(t,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};for(var i=0,s=0,a=0;i<this.children.length;i++){var o=this.children[i],l=a+o.size;if(l>t||o instanceof fN){s=t-a;break}a=l}if(s)return this.children[i].domFromPos(s-this.children[i].border,n);for(var u;i&&!(u=this.children[i-1]).size&&u instanceof uN&&u.side>=0;i--);if(n<=0){for(var c,f=!0;c=i?this.children[i-1]:null,!(!c||c.dom.parentNode==this.contentDOM);i--,f=!1);return c&&n&&f&&!c.border&&!c.domAtom?c.domFromPos(c.size,n):{node:this.contentDOM,offset:c?xt(c.dom)+1:0}}else{for(var d,h=!0;d=i<this.children.length?this.children[i]:null,!(!d||d.dom.parentNode==this.contentDOM);i++,h=!1);return d&&h&&!d.border&&!d.domAtom?d.domFromPos(0,n):{node:this.contentDOM,offset:d?xt(d.dom):this.contentDOM.childNodes.length}}}},{key:"parseRange",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.children.length==0)return{node:this.contentDOM,from:t,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var s=-1,a=-1,o=i,l=0;;l++){var u=this.children[l],c=o+u.size;if(s==-1&&t<=c){var f=o+u.border;if(t>=f&&n<=c-u.border&&u.node&&u.contentDOM&&this.contentDOM.contains(u.contentDOM))return u.parseRange(t,n,f);t=o;for(var d=l;d>0;d--){var h=this.children[d-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){s=xt(h.dom)+1;break}t-=h.size}s==-1&&(s=0)}if(s>-1&&(c>n||l==this.children.length-1)){n=c;for(var y=l+1;y<this.children.length;y++){var v=this.children[y];if(v.size&&v.dom.parentNode==this.contentDOM&&!v.emptyChildAt(-1)){a=xt(v.dom);break}n+=v.size}a==-1&&(a=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:t,to:n,fromOffset:s,toOffset:a}}},{key:"emptyChildAt",value:function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var n=this.children[t<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(t)}},{key:"domAfterPos",value:function(t){var n=this.domFromPos(t,0),i=n.node,s=n.offset;if(i.nodeType!=1||s==i.childNodes.length)throw new RangeError("No node after pos "+t);return i.childNodes[s]}},{key:"setSelection",value:function(t,n,i){for(var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=Math.min(t,n),o=Math.max(t,n),l=0,u=0;l<this.children.length;l++){var c=this.children[l],f=u+c.size;if(a>u&&o<f)return c.setSelection(t-u-c.border,n-u-c.border,i,s);u=f}var d=this.domFromPos(t,t?-1:1),h=n==t?d:this.domFromPos(n,n?-1:1),y=i.root.getSelection(),v=i.domSelectionRange(),x=!1;if((nr||Mt)&&t==n){var m=d,_=m.node,b=m.offset;if(_.nodeType==3){if(x=!!(b&&_.nodeValue[b-1]==`
`),x&&b==_.nodeValue.length)for(var w=_,T;w;w=w.parentNode){if(T=w.nextSibling){T.nodeName=="BR"&&(d=h={node:T.parentNode,offset:xt(T)+1});break}var P=w.pmViewDesc;if(P&&P.node&&P.node.isBlock)break}}else{var M=_.childNodes[b-1];x=M&&(M.nodeName=="BR"||M.contentEditable=="false")}}if(nr&&v.focusNode&&v.focusNode!=h.node&&v.focusNode.nodeType==1){var U=v.focusNode.childNodes[v.focusOffset];U&&U.contentEditable=="false"&&(s=!0)}if(!(!(s||x&&Mt)&&_i(d.node,d.offset,v.anchorNode,v.anchorOffset)&&_i(h.node,h.offset,v.focusNode,v.focusOffset))){var R=!1;if((y.extend||t==n)&&!(x&&nr)){y.collapse(d.node,d.offset);try{t!=n&&y.extend(h.node,h.offset),R=!0}catch{}}if(!R){if(t>n){var J=d;d=h,h=J}var oe=document.createRange();oe.setEnd(h.node,h.offset),oe.setStart(d.node,d.offset),y.removeAllRanges(),y.addRange(oe)}}}},{key:"ignoreMutation",value:function(t){return!this.contentDOM&&t.type!="selection"}},{key:"contentLost",get:function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}},{key:"markDirty",value:function(t,n){for(var i=0,s=0;s<this.children.length;s++){var a=this.children[s],o=i+a.size;if(i==o?t<=o&&n>=i:t<o&&n>i){var l=i+a.border,u=o-a.border;if(t>=l&&n<=u){this.dirty=t==i||n==o?vi:kO,t==l&&n==u&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=Ir:a.markDirty(t-l,n-l);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?vi:Ir}i=o}this.dirty=vi}},{key:"markParentsDirty",value:function(){for(var t=1,n=this.parent;n;n=n.parent,t++){var i=t==1?vi:kO;n.dirty<i&&(n.dirty=i)}}},{key:"domAtom",get:function(){return!1}},{key:"ignoreForCoords",get:function(){return!1}},{key:"ignoreForSelection",get:function(){return!1}},{key:"isText",value:function(t){return!1}}]),r})(),uN=(function(r){xi(t,r);var e=Ei(t);function t(n,i,s,a){var o;nt(this,t);var l,u=i.type.toDOM;if(typeof u=="function"&&(u=u(s,function(){if(!l)return a;if(l.parent)return l.parent.posBeforeChild(l)})),!i.type.spec.raw){if(u.nodeType!=1){var c=document.createElement("span");c.appendChild(u),u=c}u.contentEditable="false",u.classList.add("ProseMirror-widget")}return o=e.call(this,n,[],u,null),o.widget=i,o.widget=i,l=eN(o),o}return it(t,[{key:"matchesWidget",value:function(i){return this.dirty==ir&&i.type.eq(this.widget.type)}},{key:"parseRule",value:function(){return{ignore:!0}}},{key:"stopEvent",value:function(i){var s=this.widget.spec.stopEvent;return s?s(i):!1}},{key:"ignoreMutation",value:function(i){return i.type!="selection"||this.widget.spec.ignoreSelection}},{key:"destroy",value:function(){this.widget.type.destroy(this.dom),Dt(_t(t.prototype),"destroy",this).call(this)}},{key:"domAtom",get:function(){return!0}},{key:"ignoreForSelection",get:function(){return!!this.widget.type.spec.relaxedSide}},{key:"side",get:function(){return this.widget.type.side}}]),t})(zo),dB=(function(r){xi(t,r);var e=Ei(t);function t(n,i,s,a){var o;return nt(this,t),o=e.call(this,n,[],i,null),o.textDOM=s,o.text=a,o}return it(t,[{key:"size",get:function(){return this.text.length}},{key:"localPosFromDOM",value:function(i,s){return i!=this.textDOM?this.posAtStart+(s?this.size:0):this.posAtStart+s}},{key:"domFromPos",value:function(i){return{node:this.textDOM,offset:i}}},{key:"ignoreMutation",value:function(i){return i.type==="characterData"&&i.target.nodeValue==i.oldValue}}]),t})(zo),iu=(function(r){xi(t,r);var e=Ei(t);function t(n,i,s,a,o){var l;return nt(this,t),l=e.call(this,n,[],s,a),l.mark=i,l.spec=o,l}return it(t,[{key:"parseRule",value:function(){return this.dirty&Ir||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}},{key:"matchesMark",value:function(i){return this.dirty!=Ir&&this.mark.eq(i)}},{key:"markDirty",value:function(i,s){if(Dt(_t(t.prototype),"markDirty",this).call(this,i,s),this.dirty!=ir){for(var a=this.parent;!a.node;)a=a.parent;a.dirty<this.dirty&&(a.dirty=this.dirty),this.dirty=ir}}},{key:"slice",value:function(i,s,a){var o=t.create(this.parent,this.mark,!0,a),l=this.children,u=this.size;s<u&&(l=Sp(l,s,u,a)),i>0&&(l=Sp(l,0,i,a));for(var c=0;c<l.length;c++)l[c].parent=o;return o.children=l,o}},{key:"ignoreMutation",value:function(i){return this.spec.ignoreMutation?this.spec.ignoreMutation(i):Dt(_t(t.prototype),"ignoreMutation",this).call(this,i)}},{key:"destroy",value:function(){this.spec.destroy&&this.spec.destroy(),Dt(_t(t.prototype),"destroy",this).call(this)}}],[{key:"create",value:function(i,s,a,o){var l=o.nodeViews[s.type.name],u=l&&l(s,o,a);return(!u||!u.dom)&&(u=Xe.DOMSerializer.renderSpec(document,s.type.spec.toDOM(s,a),null,s.attrs)),new t(i,s,u.dom,u.contentDOM||u.dom,u)}}]),t})(zo),ms=(function(r){xi(t,r);var e=Ei(t);function t(n,i,s,a,o,l,u,c,f){var d;return nt(this,t),d=e.call(this,n,[],o,l),d.node=i,d.outerDeco=s,d.innerDeco=a,d.nodeDOM=u,d}return it(t,[{key:"parseRule",value:function(){var i=this;if(this.node.type.spec.reparseInView)return null;var s={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(s.preserveWhitespace="full"),!this.contentDOM)s.getContent=function(){return i.node.content};else if(!this.contentLost)s.contentElement=this.contentDOM;else{for(var a=this.children.length-1;a>=0;a--){var o=this.children[a];if(this.dom.contains(o.dom.parentNode)){s.contentElement=o.dom.parentNode;break}}s.contentElement||(s.getContent=function(){return Xe.Fragment.empty})}return s}},{key:"matchesNode",value:function(i,s,a){return this.dirty==ir&&i.eq(this.node)&&su(s,this.outerDeco)&&a.eq(this.innerDeco)}},{key:"size",get:function(){return this.node.nodeSize}},{key:"border",get:function(){return this.node.isLeaf?0:1}},{key:"updateChildren",value:function(i,s){var a=this,o=this.node.inlineContent,l=s,u=i.composing?this.localCompositionInfo(i,s):null,c=u&&u.pos>-1?u:null,f=u&&u.pos<0,d=new gB(this,c&&c.node,i);wB(this.node,this.innerDeco,function(h,y,v){h.spec.marks?d.syncToMarks(h.spec.marks,o,i):h.type.side>=0&&!v&&d.syncToMarks(y==a.node.childCount?Xe.Mark.none:a.node.child(y).marks,o,i),d.placeWidget(h,i,l)},function(h,y,v,x){d.syncToMarks(h.marks,o,i);var m;d.findNodeMatch(h,y,v,x)||f&&i.state.selection.from>l&&i.state.selection.to<l+h.nodeSize&&(m=d.findIndexWithChild(u.node))>-1&&d.updateNodeAt(h,y,v,m,i)||d.updateNextNode(h,y,v,i,x,l)||d.addNode(h,y,v,i,l),l+=h.nodeSize}),d.syncToMarks([],o,i),this.node.isTextblock&&d.addTextblockHacks(),d.destroyRest(),(d.changed||this.dirty==vi)&&(c&&this.protectLocalComposition(i,c),hN(this.contentDOM,this.children,i),ws&&bB(this.dom))}},{key:"localCompositionInfo",value:function(i,s){var a=i.state.selection,o=a.from,l=a.to;if(!(i.state.selection instanceof Ae.TextSelection)||o<s||l>s+this.node.content.size)return null;var u=i.input.compositionNode;if(!u||!this.dom.contains(u.parentNode))return null;if(this.node.inlineContent){var c=u.nodeValue,f=_B(this.node.content,c,o-s,l-s);return f<0?null:{node:u,pos:f,text:c}}else return{node:u,pos:-1,text:""}}},{key:"protectLocalComposition",value:function(i,s){var a=s.node,o=s.pos,l=s.text;if(!this.getDesc(a)){for(var u=a;u.parentNode!=this.contentDOM;u=u.parentNode){for(;u.previousSibling;)u.parentNode.removeChild(u.previousSibling);for(;u.nextSibling;)u.parentNode.removeChild(u.nextSibling);u.pmViewDesc&&(u.pmViewDesc=void 0)}var c=new dB(this,u,a,l);i.input.compositionNodes.push(c),this.children=Sp(this.children,o,o+l.length,i,c)}}},{key:"update",value:function(i,s,a,o){return this.dirty==Ir||!i.sameMarkup(this.node)?!1:(this.updateInner(i,s,a,o),!0)}},{key:"updateInner",value:function(i,s,a,o){this.updateOuterDeco(s),this.node=i,this.innerDeco=a,this.contentDOM&&this.updateChildren(o,this.posAtStart),this.dirty=ir}},{key:"updateOuterDeco",value:function(i){if(!su(i,this.outerDeco)){var s=this.nodeDOM.nodeType!=1,a=this.dom;this.dom=dN(this.dom,this.nodeDOM,Ep(this.outerDeco,this.node,s),Ep(i,this.node,s)),this.dom!=a&&(a.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=i}}},{key:"selectNode",value:function(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}},{key:"deselectNode",value:function(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}},{key:"domAtom",get:function(){return this.node.isAtom}}],[{key:"create",value:function(i,s,a,o,l,u){var c=l.nodeViews[s.type.name],f,d=c&&c(s,l,function(){if(!f)return u;if(f.parent)return f.parent.posBeforeChild(f)},a,o),h=d&&d.dom,y=d&&d.contentDOM;if(s.isText){if(!h)h=document.createTextNode(s.text);else if(h.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else if(!h){var v=Xe.DOMSerializer.renderSpec(document,s.type.spec.toDOM(s),null,s.attrs);h=v.dom,y=v.contentDOM}!y&&!s.isText&&h.nodeName!="BR"&&(h.hasAttribute("contenteditable")||(h.contentEditable="false"),s.type.spec.draggable&&(h.draggable=!0));var x=h;return h=pN(h,a,s),d?f=new pB(i,s,a,o,h,y||null,x,d,l,u+1):s.isText?new cN(i,s,a,o,h,x,l):new t(i,s,a,o,h,y||null,x,l,u+1)}}]),t})(zo);function TO(r,e,t,n,i){pN(n,e,r);var s=new ms(void 0,r,e,t,n,n,n,i,0);return s.contentDOM&&s.updateChildren(i,0),s}var cN=(function(r){xi(t,r);var e=Ei(t);function t(n,i,s,a,o,l,u){return nt(this,t),e.call(this,n,i,s,a,o,null,l,u,0)}return it(t,[{key:"parseRule",value:function(){for(var i=this.nodeDOM.parentNode;i&&i!=this.dom&&!i.pmIsDeco;)i=i.parentNode;return{skip:i||!0}}},{key:"update",value:function(i,s,a,o){return this.dirty==Ir||this.dirty!=ir&&!this.inParent()||!i.sameMarkup(this.node)?!1:(this.updateOuterDeco(s),(this.dirty!=ir||i.text!=this.node.text)&&i.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=i.text,o.trackWrites==this.nodeDOM&&(o.trackWrites=null)),this.node=i,this.dirty=ir,!0)}},{key:"inParent",value:function(){for(var i=this.parent.contentDOM,s=this.nodeDOM;s;s=s.parentNode)if(s==i)return!0;return!1}},{key:"domFromPos",value:function(i){return{node:this.nodeDOM,offset:i}}},{key:"localPosFromDOM",value:function(i,s,a){return i==this.nodeDOM?this.posAtStart+Math.min(s,this.node.text.length):Dt(_t(t.prototype),"localPosFromDOM",this).call(this,i,s,a)}},{key:"ignoreMutation",value:function(i){return i.type!="characterData"&&i.type!="selection"}},{key:"slice",value:function(i,s,a){var o=this.node.cut(i,s),l=document.createTextNode(o.text);return new t(this.parent,o,this.outerDeco,this.innerDeco,l,l,a)}},{key:"markDirty",value:function(i,s){Dt(_t(t.prototype),"markDirty",this).call(this,i,s),this.dom!=this.nodeDOM&&(i==0||s==this.nodeDOM.nodeValue.length)&&(this.dirty=Ir)}},{key:"domAtom",get:function(){return!1}},{key:"isText",value:function(i){return this.node.text==i}}]),t})(ms),fN=(function(r){xi(t,r);var e=Ei(t);function t(){return nt(this,t),e.apply(this,arguments)}return it(t,[{key:"parseRule",value:function(){return{ignore:!0}}},{key:"matchesHack",value:function(i){return this.dirty==ir&&this.dom.nodeName==i}},{key:"domAtom",get:function(){return!0}},{key:"ignoreForCoords",get:function(){return this.dom.nodeName=="IMG"}}]),t})(zo),pB=(function(r){xi(t,r);var e=Ei(t);function t(n,i,s,a,o,l,u,c,f,d){var h;return nt(this,t),h=e.call(this,n,i,s,a,o,l,u,f,d),h.spec=c,h}return it(t,[{key:"update",value:function(i,s,a,o){if(this.dirty==Ir)return!1;if(this.spec.update&&(this.node.type==i.type||this.spec.multiType)){var l=this.spec.update(i,s,a);return l&&this.updateInner(i,s,a,o),l}else return!this.contentDOM&&!i.isLeaf?!1:Dt(_t(t.prototype),"update",this).call(this,i,s,a,o)}},{key:"selectNode",value:function(){this.spec.selectNode?this.spec.selectNode():Dt(_t(t.prototype),"selectNode",this).call(this)}},{key:"deselectNode",value:function(){this.spec.deselectNode?this.spec.deselectNode():Dt(_t(t.prototype),"deselectNode",this).call(this)}},{key:"setSelection",value:function(i,s,a,o){this.spec.setSelection?this.spec.setSelection(i,s,a.root):Dt(_t(t.prototype),"setSelection",this).call(this,i,s,a,o)}},{key:"destroy",value:function(){this.spec.destroy&&this.spec.destroy(),Dt(_t(t.prototype),"destroy",this).call(this)}},{key:"stopEvent",value:function(i){return this.spec.stopEvent?this.spec.stopEvent(i):!1}},{key:"ignoreMutation",value:function(i){return this.spec.ignoreMutation?this.spec.ignoreMutation(i):Dt(_t(t.prototype),"ignoreMutation",this).call(this,i)}}]),t})(ms);function hN(r,e,t){for(var n=r.firstChild,i=!1,s=0;s<e.length;s++){var a=e[s],o=a.dom;if(o.parentNode==r){for(;o!=n;)n=AO(n),i=!0;n=n.nextSibling}else i=!0,r.insertBefore(o,n);if(a instanceof iu){var l=n?n.previousSibling:r.lastChild;hN(a.contentDOM,a.children,t),n=l?l.nextSibling:r.firstChild}}for(;n;)n=AO(n),i=!0;i&&t.trackWrites==r&&(t.trackWrites=null)}var Io=function(e){e&&(this.nodeName=e)};Io.prototype=Object.create(null);var yi=[new Io];function Ep(r,e,t){if(r.length==0)return yi;for(var n=t?yi[0]:new Io,i=[n],s=0;s<r.length;s++){var a=r[s].type.attrs;if(a){a.nodeName&&i.push(n=new Io(a.nodeName));for(var o in a){var l=a[o];l!=null&&(t&&i.length==1&&i.push(n=new Io(e.isInline?"span":"div")),o=="class"?n.class=(n.class?n.class+" ":"")+l:o=="style"?n.style=(n.style?n.style+";":"")+l:o!="nodeName"&&(n[o]=l))}}}return i}function dN(r,e,t,n){if(t==yi&&n==yi)return e;for(var i=e,s=0;s<n.length;s++){var a=n[s],o=t[s];if(s){var l=void 0;o&&o.nodeName==a.nodeName&&i!=r&&(l=i.parentNode)&&l.nodeName.toLowerCase()==a.nodeName||(l=document.createElement(a.nodeName),l.pmIsDeco=!0,l.appendChild(i),o=yi[0]),i=l}mB(i,o||yi[0],a)}return i}function mB(r,e,t){for(var n in e)n!="class"&&n!="style"&&n!="nodeName"&&!(n in t)&&r.removeAttribute(n);for(var i in t)i!="class"&&i!="style"&&i!="nodeName"&&t[i]!=e[i]&&r.setAttribute(i,t[i]);if(e.class!=t.class){for(var s=e.class?e.class.split(" ").filter(Boolean):[],a=t.class?t.class.split(" ").filter(Boolean):[],o=0;o<s.length;o++)a.indexOf(s[o])==-1&&r.classList.remove(s[o]);for(var l=0;l<a.length;l++)s.indexOf(a[l])==-1&&r.classList.add(a[l]);r.classList.length==0&&r.removeAttribute("class")}if(e.style!=t.style){if(e.style)for(var u=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,c;c=u.exec(e.style);)r.style.removeProperty(c[1]);t.style&&(r.style.cssText+=t.style)}}function pN(r,e,t){return dN(r,r,yi,Ep(e,t,r.nodeType!=1))}function su(r,e){if(r.length!=e.length)return!1;for(var t=0;t<r.length;t++)if(!r[t].type.eq(e[t].type))return!1;return!0}function AO(r){var e=r.nextSibling;return r.parentNode.removeChild(r),e}var gB=(function(){function r(e,t,n){nt(this,r),this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=vB(e.node.content,e)}return it(r,[{key:"destroyBetween",value:function(t,n){if(t!=n){for(var i=t;i<n;i++)this.top.children[i].destroy();this.top.children.splice(t,n-t),this.changed=!0}}},{key:"destroyRest",value:function(){this.destroyBetween(this.index,this.top.children.length)}},{key:"syncToMarks",value:function(t,n,i){for(var s=0,a=this.stack.length>>1,o=Math.min(a,t.length);s<o&&(s==a-1?this.top:this.stack[s+1<<1]).matchesMark(t[s])&&t[s].type.spec.spanning!==!1;)s++;for(;s<a;)this.destroyRest(),this.top.dirty=ir,this.index=this.stack.pop(),this.top=this.stack.pop(),a--;for(;a<t.length;){this.stack.push(this.top,this.index+1);for(var l=-1,u=this.index;u<Math.min(this.index+3,this.top.children.length);u++){var c=this.top.children[u];if(c.matchesMark(t[a])&&!this.isLocked(c.dom)){l=u;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{var f=iu.create(this.top,t[a],n,i);this.top.children.splice(this.index,0,f),this.top=f,this.changed=!0}this.index=0,a++}}},{key:"findNodeMatch",value:function(t,n,i,s){var a=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(t,n,i))a=this.top.children.indexOf(o,this.index);else for(var l=this.index,u=Math.min(this.top.children.length,l+5);l<u;l++){var c=this.top.children[l];if(c.matchesNode(t,n,i)&&!this.preMatch.matched.has(c)){a=l;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}},{key:"updateNodeAt",value:function(t,n,i,s,a){var o=this.top.children[s];return o.dirty==Ir&&o.dom==o.contentDOM&&(o.dirty=vi),o.update(t,n,i,a)?(this.destroyBetween(this.index,s),this.index++,!0):!1}},{key:"findIndexWithChild",value:function(t){for(;;){var n=t.parentNode;if(!n)return-1;if(n==this.top.contentDOM){var i=t.pmViewDesc;if(i){for(var s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==i)return s}return-1}t=n}}},{key:"updateNextNode",value:function(t,n,i,s,a,o){for(var l=this.index;l<this.top.children.length;l++){var u=this.top.children[l];if(u instanceof ms){var c=this.preMatch.matched.get(u);if(c!=null&&c!=a)return!1;var f=u.dom,d=void 0,h=this.isLocked(f)&&!(t.isText&&u.node&&u.node.isText&&u.nodeDOM.nodeValue==t.text&&u.dirty!=Ir&&su(n,u.outerDeco));if(!h&&u.update(t,n,i,s))return this.destroyBetween(this.index,l),u.dom!=f&&(this.changed=!0),this.index++,!0;if(!h&&(d=this.recreateWrapper(u,t,n,i,s,o)))return this.destroyBetween(this.index,l),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=vi,d.updateChildren(s,o+1),d.dirty=ir),this.changed=!0,this.index++,!0;break}}return!1}},{key:"recreateWrapper",value:function(t,n,i,s,a,o){if(t.dirty||n.isAtom||!t.children.length||!t.node.content.eq(n.content)||!su(i,t.outerDeco)||!s.eq(t.innerDeco))return null;var l=ms.create(this.top,n,i,s,a,o);if(l.contentDOM){l.children=t.children,t.children=[];var u=vp(l.children),c;try{for(u.s();!(c=u.n()).done;){var f=c.value;f.parent=l}}catch(d){u.e(d)}finally{u.f()}}return t.destroy(),l}},{key:"addNode",value:function(t,n,i,s,a){var o=ms.create(this.top,t,n,i,s,a);o.contentDOM&&o.updateChildren(s,a+1),this.top.children.splice(this.index++,0,o),this.changed=!0}},{key:"placeWidget",value:function(t,n,i){var s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(t)&&(t==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{var a=new uN(this.top,t,n,i);this.top.children.splice(this.index++,0,a),this.changed=!0}}},{key:"addTextblockHacks",value:function(){for(var t=this.top.children[this.index-1],n=this.top;t instanceof iu;)n=t,t=n.children[n.children.length-1];(!t||!(t instanceof cN)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((Mt||Rt)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}},{key:"addHackNode",value:function(t,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(t))this.index++;else{var i=document.createElement(t);t=="IMG"&&(i.className="ProseMirror-separator",i.alt=""),t=="BR"&&(i.className="ProseMirror-trailingBreak");var s=new fN(this.top,[],i,null);n!=this.top?n.children.push(s):n.children.splice(this.index++,0,s),this.changed=!0}}},{key:"isLocked",value:function(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}]),r})();function vB(r,e){var t=e,n=t.children.length,i=r.childCount,s=new Map,a=[];e:for(;i>0;){for(var o=void 0;;)if(n){var l=t.children[n-1];if(l instanceof iu)t=l,n=l.children.length;else{o=l,n--;break}}else{if(t==e)break e;n=t.parent.children.indexOf(t),t=t.parent}var u=o.node;if(u){if(u!=r.child(i-1))break;--i,s.set(o,i),a.push(o)}}return{index:i,matched:s,matches:a.reverse()}}function yB(r,e){return r.type.side-e.type.side}function wB(r,e,t,n){var i=e.locals(r),s=0;if(i.length==0){for(var a=0;a<r.childCount;a++){var o=r.child(a);n(o,i,e.forChild(s,o),a),s+=o.nodeSize}return}for(var l=0,u=[],c=null,f=0;;){for(var d=void 0,h=void 0;l<i.length&&i[l].to==s;){var y=i[l++];y.widget&&(d?(h||(h=[d])).push(y):d=y)}if(d)if(h){h.sort(yB);for(var v=0;v<h.length;v++)t(h[v],f,!!c)}else t(d,f,!!c);var x=void 0,m=void 0;if(c)m=-1,x=c,c=null;else if(f<r.childCount)m=f,x=r.child(f++);else break;for(var _=0;_<u.length;_++)u[_].to<=s&&u.splice(_--,1);for(;l<i.length&&i[l].from<=s&&i[l].to>s;)u.push(i[l++]);var b=s+x.nodeSize;if(x.isText){var w=b;l<i.length&&i[l].from<w&&(w=i[l].from);for(var T=0;T<u.length;T++)u[T].to<w&&(w=u[T].to);w<b&&(c=x.cut(w-s),x=x.cut(0,w-s),b=w,m=-1)}else for(;l<i.length&&i[l].to<b;)l++;var P=x.isInline&&!x.isLeaf?u.filter(function(M){return!M.inline}):u.slice();n(x,P,e.forChild(s,x),m),s=b}}function bB(r){if(r.nodeName=="UL"||r.nodeName=="OL"){var e=r.style.cssText;r.style.cssText=e+"; list-style: square !important",window.getComputedStyle(r).listStyle,r.style.cssText=e}}function _B(r,e,t,n){for(var i=0,s=0;i<r.childCount&&s<=n;){var a=r.child(i++),o=s;if(s+=a.nodeSize,!!a.isText){for(var l=a.text;i<r.childCount;){var u=r.child(i++);if(s+=u.nodeSize,!u.isText)break;l+=u.text}if(s>=t){if(s>=n&&l.slice(n-e.length-o,n-o)==e)return n-e.length;var c=o<n?l.lastIndexOf(e,n-o-1):-1;if(c>=0&&c+e.length+o>=t)return o+c;if(t==n&&l.length>=n+e.length-o&&l.slice(n-o,n-o+e.length)==e)return n}}}return-1}function Sp(r,e,t,n,i){for(var s=[],a=0,o=0;a<r.length;a++){var l=r[a],u=o,c=o+=l.size;u>=t||c<=e?s.push(l):(u<e&&s.push(l.slice(0,e-u,n)),i&&(s.push(i),i=void 0),c>t&&s.push(l.slice(t-u,l.size,n)))}return s}function Rp(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=r.domSelectionRange(),n=r.state.doc;if(!t.focusNode)return null;var i=r.docView.nearestDesc(t.focusNode),s=i&&i.size==0,a=r.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(a<0)return null;var o=n.resolve(a),l,u;if(lu(t)){for(l=a;i&&!i.node;)i=i.parent;var c=i.node;if(i&&c.isAtom&&Ae.NodeSelection.isSelectable(c)&&i.parent&&!(c.isInline&&GF(t.focusNode,t.focusOffset,i.dom))){var f=i.posBefore;u=new Ae.NodeSelection(a==f?o:n.resolve(f))}}else{if(t instanceof r.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){for(var d=a,h=a,y=0;y<t.rangeCount;y++){var v=t.getRangeAt(y);d=Math.min(d,r.docView.posFromDOM(v.startContainer,v.startOffset,1)),h=Math.max(h,r.docView.posFromDOM(v.endContainer,v.endOffset,-1))}if(d<0)return null;var x=h==r.state.selection.anchor?[h,d]:[d,h],m=ZO(x,2);l=m[0],a=m[1],o=n.resolve(a)}else l=r.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(l<0)return null}var _=n.resolve(l);if(!u){var b=e=="pointer"||r.state.selection.head<o.pos&&!s?1:-1;u=Cp(r,_,o,b)}return u}function mN(r){return r.editable?r.hasFocus():vN(r)&&document.activeElement&&document.activeElement.contains(r.dom)}function yn(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=r.state.selection;if(gN(r,t),!!mN(r)){if(!e&&r.input.mouseDown&&r.input.mouseDown.allowDefault&&Rt){var n=r.domSelectionRange(),i=r.domObserver.currentSelection;if(n.anchorNode&&i.anchorNode&&_i(n.anchorNode,n.anchorOffset,i.anchorNode,i.anchorOffset)){r.input.mouseDown.delayedSelectionSync=!0,r.domObserver.setCurSelection();return}}if(r.domObserver.disconnectSelection(),r.cursorWrapper)EB(r);else{var s=t.anchor,a=t.head,o,l;OO&&!(t instanceof Ae.TextSelection)&&(t.$from.parent.inlineContent||(o=NO(r,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(l=NO(r,t.to))),r.docView.setSelection(s,a,r,e),OO&&(o&&RO(o),l&&RO(l)),t.visible?r.dom.classList.remove("ProseMirror-hideselection"):(r.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&xB(r))}r.domObserver.setCurSelection(),r.domObserver.connectSelection()}}var OO=Mt||Rt&&rN<63;function NO(r,e){var t=r.docView.domFromPos(e,0),n=t.node,i=t.offset,s=i<n.childNodes.length?n.childNodes[i]:null,a=i?n.childNodes[i-1]:null;if(Mt&&s&&s.contentEditable=="false")return hp(s);if((!s||s.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(s)return hp(s);if(a)return hp(a)}}function hp(r){return r.contentEditable="true",Mt&&r.draggable&&(r.draggable=!1,r.wasDraggable=!0),r}function RO(r){r.contentEditable="false",r.wasDraggable&&(r.draggable=!0,r.wasDraggable=null)}function xB(r){var e=r.dom.ownerDocument;e.removeEventListener("selectionchange",r.input.hideSelectionGuard);var t=r.domSelectionRange(),n=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",r.input.hideSelectionGuard=function(){(t.anchorNode!=n||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",r.input.hideSelectionGuard),setTimeout(function(){(!mN(r)||r.state.selection.visible)&&r.dom.classList.remove("ProseMirror-hideselection")},20))})}function EB(r){var e=r.domSelection();if(e){var t=r.cursorWrapper.dom,n=t.nodeName=="IMG";n?e.collapse(t.parentNode,xt(t)+1):e.collapse(t,0),!n&&!r.state.selection.visible&&qt&&Wn<=11&&(t.disabled=!0,t.disabled=!1)}}function gN(r,e){if(e instanceof Ae.NodeSelection){var t=r.docView.descAt(e.from);t!=r.lastSelectedViewDesc&&(CO(r),t&&t.selectNode(),r.lastSelectedViewDesc=t)}else CO(r)}function CO(r){r.lastSelectedViewDesc&&(r.lastSelectedViewDesc.parent&&r.lastSelectedViewDesc.deselectNode(),r.lastSelectedViewDesc=void 0)}function Cp(r,e,t,n){return r.someProp("createSelectionBetween",function(i){return i(r,e,t)})||Ae.TextSelection.between(e,t,n)}function IO(r){return r.editable&&!r.hasFocus()?!1:vN(r)}function vN(r){var e=r.domSelectionRange();if(!e.anchorNode)return!1;try{return r.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(r.editable||r.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function SB(r){var e=r.docView.domFromPos(r.state.selection.anchor,0),t=r.domSelectionRange();return _i(e.node,e.offset,t.anchorNode,t.anchorOffset)}function kp(r,e){var t=r.selection,n=t.$anchor,i=t.$head,s=e>0?n.max(i):n.min(i),a=s.parent.inlineContent?s.depth?r.doc.resolve(e>0?s.after():s.before()):null:s;return a&&Ae.Selection.findFrom(a,e)}function zn(r,e){return r.dispatch(r.state.tr.setSelection(e).scrollIntoView()),!0}function PO(r,e,t){var n=r.state.selection;if(n instanceof Ae.TextSelection)if(t.indexOf("s")>-1){var i=n.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;var a=r.state.doc.resolve(i.pos+s.nodeSize*(e<0?-1:1));return zn(r,new Ae.TextSelection(n.$anchor,a))}else if(n.empty){if(r.endOfTextblock(e>0?"forward":"backward")){var o=kp(r.state,e);return o&&o instanceof Ae.NodeSelection?zn(r,o):!1}else if(!(tr&&t.indexOf("m")>-1)){var l=n.$head,u=l.textOffset?null:e<0?l.nodeBefore:l.nodeAfter,c;if(!u||u.isText)return!1;var f=e<0?l.pos-u.nodeSize:l.pos;return u.isAtom||(c=r.docView.descAt(f))&&!c.contentDOM?Ae.NodeSelection.isSelectable(u)?zn(r,new Ae.NodeSelection(e<0?r.state.doc.resolve(l.pos-u.nodeSize):l)):Ho?zn(r,new Ae.TextSelection(r.state.doc.resolve(e<0?f:f+u.nodeSize))):!1:!1}}else return!1;else{if(n instanceof Ae.NodeSelection&&n.node.isInline)return zn(r,new Ae.TextSelection(e>0?n.$to:n.$from));var d=kp(r.state,e);return d?zn(r,d):!1}}function ou(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function Po(r,e){var t=r.pmViewDesc;return t&&t.size==0&&(e<0||r.nextSibling||r.nodeName!="BR")}function ds(r,e){return e<0?kB(r):TB(r)}function kB(r){var e=r.domSelectionRange(),t=e.focusNode,n=e.focusOffset;if(t){var i,s,a=!1;for(nr&&t.nodeType==1&&n<ou(t)&&Po(t.childNodes[n],-1)&&(a=!0);;)if(n>0){if(t.nodeType!=1)break;var o=t.childNodes[n-1];if(Po(o,-1))i=t,s=--n;else if(o.nodeType==3)t=o,n=t.nodeValue.length;else break}else{if(yN(t))break;for(var l=t.previousSibling;l&&Po(l,-1);)i=t.parentNode,s=xt(l),l=l.previousSibling;if(l)t=l,n=ou(t);else{if(t=t.parentNode,t==r.dom)break;n=0}}a?Tp(r,t,n):i&&Tp(r,i,s)}}function TB(r){var e=r.domSelectionRange(),t=e.focusNode,n=e.focusOffset;if(t){for(var i=ou(t),s,a;;)if(n<i){if(t.nodeType!=1)break;var o=t.childNodes[n];if(Po(o,1))s=t,a=++n;else break}else{if(yN(t))break;for(var l=t.nextSibling;l&&Po(l,1);)s=l.parentNode,a=xt(l)+1,l=l.nextSibling;if(l)t=l,n=0,i=ou(t);else{if(t=t.parentNode,t==r.dom)break;n=i=0}}s&&Tp(r,s,a)}}function yN(r){var e=r.pmViewDesc;return e&&e.node&&e.node.isBlock}function AB(r,e){for(;r&&e==r.childNodes.length&&!Uo(r);)e=xt(r)+1,r=r.parentNode;for(;r&&e<r.childNodes.length;){var t=r.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;r=t,e=0}}function OB(r,e){for(;r&&!e&&!Uo(r);)e=xt(r),r=r.parentNode;for(;r&&e;){var t=r.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;r=t,e=r.childNodes.length}}function Tp(r,e,t){if(e.nodeType!=3){var n,i;(i=AB(e,t))?(e=i,t=0):(n=OB(e,t))&&(e=n,t=n.nodeValue.length)}var s=r.domSelection();if(s){if(lu(s)){var a=document.createRange();a.setEnd(e,t),a.setStart(e,t),s.removeAllRanges(),s.addRange(a)}else s.extend&&s.extend(e,t);r.domObserver.setCurSelection();var o=r.state;setTimeout(function(){r.state==o&&yn(r)},50)}}function DO(r,e){var t=r.state.doc.resolve(e);if(!(Rt||XF)&&t.parent.inlineContent){var n=r.coordsAtPos(e);if(e>t.start()){var i=r.coordsAtPos(e-1),s=(i.top+i.bottom)/2;if(s>n.top&&s<n.bottom&&Math.abs(i.left-n.left)>1)return i.left<n.left?"ltr":"rtl"}if(e<t.end()){var a=r.coordsAtPos(e+1),o=(a.top+a.bottom)/2;if(o>n.top&&o<n.bottom&&Math.abs(a.left-n.left)>1)return a.left>n.left?"ltr":"rtl"}}var l=getComputedStyle(r.dom).direction;return l=="rtl"?"rtl":"ltr"}function MO(r,e,t){var n=r.state.selection;if(n instanceof Ae.TextSelection&&!n.empty||t.indexOf("s")>-1||tr&&t.indexOf("m")>-1)return!1;var i=n.$from,s=n.$to;if(!i.parent.inlineContent||r.endOfTextblock(e<0?"up":"down")){var a=kp(r.state,e);if(a&&a instanceof Ae.NodeSelection)return zn(r,a)}if(!i.parent.inlineContent){var o=e<0?i:s,l=n instanceof Ae.AllSelection?Ae.Selection.near(o,e):Ae.Selection.findFrom(o,e);return l?zn(r,l):!1}return!1}function LO(r,e){if(!(r.state.selection instanceof Ae.TextSelection))return!0;var t=r.state.selection,n=t.$head,i=t.$anchor,s=t.empty;if(!n.sameParent(i))return!0;if(!s)return!1;if(r.endOfTextblock(e>0?"forward":"backward"))return!0;var a=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(a&&!a.isText){var o=r.state.tr;return e<0?o.delete(n.pos-a.nodeSize,n.pos):o.delete(n.pos,n.pos+a.nodeSize),r.dispatch(o),!0}return!1}function FO(r,e,t){r.domObserver.stop(),e.contentEditable=t,r.domObserver.start()}function NB(r){if(!Mt||r.state.selection.$head.parentOffset>0)return!1;var e=r.domSelectionRange(),t=e.focusNode,n=e.focusOffset;if(t&&t.nodeType==1&&n==0&&t.firstChild&&t.firstChild.contentEditable=="false"){var i=t.firstChild;FO(r,i,"true"),setTimeout(function(){return FO(r,i,"false")},20)}return!1}function RB(r){var e="";return r.ctrlKey&&(e+="c"),r.metaKey&&(e+="m"),r.altKey&&(e+="a"),r.shiftKey&&(e+="s"),e}function CB(r,e){var t=e.keyCode,n=RB(e);if(t==8||tr&&t==72&&n=="c")return LO(r,-1)||ds(r,-1);if(t==46&&!e.shiftKey||tr&&t==68&&n=="c")return LO(r,1)||ds(r,1);if(t==13||t==27)return!0;if(t==37||tr&&t==66&&n=="c"){var i=t==37?DO(r,r.state.selection.from)=="ltr"?-1:1:-1;return PO(r,i,n)||ds(r,i)}else if(t==39||tr&&t==70&&n=="c"){var s=t==39?DO(r,r.state.selection.from)=="ltr"?1:-1:1;return PO(r,s,n)||ds(r,s)}else{if(t==38||tr&&t==80&&n=="c")return MO(r,-1,n)||ds(r,-1);if(t==40||tr&&t==78&&n=="c")return NB(r)||MO(r,1,n)||ds(r,1);if(n==(tr?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Ip(r,e){r.someProp("transformCopied",function(m){e=m(e,r)});for(var t=[],n=e,i=n.content,s=n.openStart,a=n.openEnd;s>1&&a>1&&i.childCount==1&&i.firstChild.childCount==1;){s--,a--;var o=i.firstChild;t.push(o.type.name,o.attrs!=o.type.defaultAttrs?o.attrs:null),i=o.content}var l=r.someProp("clipboardSerializer")||Xe.DOMSerializer.fromSchema(r.state.schema),u=EN(),c=u.createElement("div");c.appendChild(l.serializeFragment(i,{document:u}));for(var f=c.firstChild,d,h=0;f&&f.nodeType==1&&(d=xN[f.nodeName.toLowerCase()]);){for(var y=d.length-1;y>=0;y--){for(var v=u.createElement(d[y]);c.firstChild;)v.appendChild(c.firstChild);c.appendChild(v),h++}f=c.firstChild}f&&f.nodeType==1&&f.setAttribute("data-pm-slice","".concat(s," ").concat(a).concat(h?" -".concat(h):""," ").concat(JSON.stringify(t)));var x=r.someProp("clipboardTextSerializer",function(m){return m(e,r)})||e.content.textBetween(0,e.content.size,`

`);return{dom:c,text:x,slice:e}}function Pp(r,e,t,n,i){var s=i.parent.type.spec.code,a,o;if(!t&&!e)return null;var l=!!e&&(n||s||!t);if(l){if(r.someProp("transformPastedText",function(P){e=P(e,s||n,r)}),s)return o=new Xe.Slice(Xe.Fragment.from(r.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),r.someProp("transformPasted",function(P){o=P(o,r,!0)}),o;var u=r.someProp("clipboardTextParser",function(P){return P(e,i,n,r)});if(u)o=u;else{var c=i.marks(),f=r.state.schema,d=Xe.DOMSerializer.fromSchema(f);a=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(function(P){var M=a.appendChild(document.createElement("p"));P&&M.appendChild(d.serializeNode(f.text(P,c)))})}}else r.someProp("transformPastedHTML",function(P){t=P(t,r)}),a=MB(t),Ho&&LB(a);var h=a&&a.querySelector("[data-pm-slice]"),y=h&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(h.getAttribute("data-pm-slice")||"");if(y&&y[3])for(var v=+y[3];v>0;v--){for(var x=a.firstChild;x&&x.nodeType!=1;)x=x.nextSibling;if(!x)break;a=x}if(!o){var m=r.someProp("clipboardParser")||r.someProp("domParser")||Xe.DOMParser.fromSchema(r.state.schema);o=m.parseSlice(a,{preserveWhitespace:!!(l||y),context:i,ruleFromNode:function(M){return M.nodeName=="BR"&&!M.nextSibling&&M.parentNode&&!IB.test(M.parentNode.nodeName)?{ignore:!0}:null}})}if(y)o=FB(BO(o,+y[1],+y[2]),y[4]);else if(o=Xe.Slice.maxOpen(PB(o.content,i),!0),o.openStart||o.openEnd){for(var _=0,b=0,w=o.content.firstChild;_<o.openStart&&!w.type.spec.isolating;_++,w=w.firstChild);for(var T=o.content.lastChild;b<o.openEnd&&!T.type.spec.isolating;b++,T=T.lastChild);o=BO(o,_,b)}return r.someProp("transformPasted",function(P){o=P(o,r,l)}),o}var IB=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function PB(r,e){if(r.childCount<2)return r;for(var t=function(){var a=e.node(i),o=a.contentMatchAt(e.index(i)),l,u=[];if(r.forEach(function(c){if(u){var f=o.findWrapping(c.type),d;if(!f)return u=null;if(d=u.length&&l.length&&bN(f,l,c,u[u.length-1],0))u[u.length-1]=d;else{u.length&&(u[u.length-1]=_N(u[u.length-1],l.length));var h=wN(c,f);u.push(h),o=o.matchType(h.type),l=f}}}),u)return{v:Xe.Fragment.from(u)}},n,i=e.depth;i>=0;i--)if(n=t(),n)return n.v;return r}function wN(r,e){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=e.length-1;n>=t;n--)r=e[n].create(null,Xe.Fragment.from(r));return r}function bN(r,e,t,n,i){if(i<r.length&&i<e.length&&r[i]==e[i]){var s=bN(r,e,t,n.lastChild,i+1);if(s)return n.copy(n.content.replaceChild(n.childCount-1,s));var a=n.contentMatchAt(n.childCount);if(a.matchType(i==r.length-1?t.type:r[i+1]))return n.copy(n.content.append(Xe.Fragment.from(wN(t,r,i+1))))}}function _N(r,e){if(e==0)return r;var t=r.content.replaceChild(r.childCount-1,_N(r.lastChild,e-1)),n=r.contentMatchAt(r.childCount).fillBefore(Xe.Fragment.empty,!0);return r.copy(t.append(n))}function Ap(r,e,t,n,i,s){var a=e<0?r.firstChild:r.lastChild,o=a.content;return r.childCount>1&&(s=0),i<n-1&&(o=Ap(o,e,t,n,i+1,s)),i>=t&&(o=e<0?a.contentMatchAt(0).fillBefore(o,s<=i).append(o):o.append(a.contentMatchAt(a.childCount).fillBefore(Xe.Fragment.empty,!0))),r.replaceChild(e<0?0:r.childCount-1,a.copy(o))}function BO(r,e,t){return e<r.openStart&&(r=new Xe.Slice(Ap(r.content,-1,e,r.openStart,0,r.openEnd),e,r.openEnd)),t<r.openEnd&&(r=new Xe.Slice(Ap(r.content,1,t,r.openEnd,0,0),r.openStart,t)),r}var xN={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},UO=null;function EN(){return UO||(UO=document.implementation.createHTMLDocument("title"))}var dp=null;function DB(r){var e=window.trustedTypes;return e?(dp||(dp=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:function(n){return n}})),dp.createHTML(r)):r}function MB(r){var e=/^(\s*<meta [^>]*>)*/.exec(r);e&&(r=r.slice(e[0].length));var t=EN().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(r),i;if((i=n&&xN[n[1].toLowerCase()])&&(r=i.map(function(a){return"<"+a+">"}).join("")+r+i.map(function(a){return"</"+a+">"}).reverse().join("")),t.innerHTML=DB(r),i)for(var s=0;s<i.length;s++)t=t.querySelector(i[s])||t;return t}function LB(r){for(var e=r.querySelectorAll(Rt?"span:not([class]):not([style])":"span.Apple-converted-space"),t=0;t<e.length;t++){var n=e[t];n.childNodes.length==1&&n.textContent=="\xA0"&&n.parentNode&&n.parentNode.replaceChild(r.ownerDocument.createTextNode(" "),n)}}function FB(r,e){if(!r.size)return r;var t=r.content.firstChild.type.schema,n;try{n=JSON.parse(e)}catch{return r}for(var i=r.content,s=r.openStart,a=r.openEnd,o=n.length-2;o>=0;o-=2){var l=t.nodes[n[o]];if(!l||l.hasRequiredAttrs())break;i=Xe.Fragment.from(l.create(n[o+1],i)),s++,a++}return new Xe.Slice(i,s,a)}var Lt={},Ft={},BB={touchstart:!0,touchmove:!0},UB=it(function r(){nt(this,r),this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null});function HB(r){var e=function(){var i=Lt[t];r.dom.addEventListener(t,r.input.eventHandlers[t]=function(s){jB(r,s)&&!Dp(r,s)&&(r.editable||!(s.type in Ft))&&i(r,s)},BB[t]?{passive:!0}:void 0)};for(var t in Lt)e();Mt&&r.dom.addEventListener("input",function(){return null}),Op(r)}function jn(r,e){r.input.lastSelectionOrigin=e,r.input.lastSelectionTime=Date.now()}function zB(r){r.domObserver.stop();for(var e in r.input.eventHandlers)r.dom.removeEventListener(e,r.input.eventHandlers[e]);clearTimeout(r.input.composingTimeout),clearTimeout(r.input.lastIOSEnterFallbackTimeout)}function Op(r){r.someProp("handleDOMEvents",function(e){for(var t in e)r.input.eventHandlers[t]||r.dom.addEventListener(t,r.input.eventHandlers[t]=function(n){return Dp(r,n)})})}function Dp(r,e){return r.someProp("handleDOMEvents",function(t){var n=t[e.type];return n?n(r,e)||e.defaultPrevented:!1})}function jB(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(var t=e.target;t!=r.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function WB(r,e){!Dp(r,e)&&Lt[e.type]&&(r.editable||!(e.type in Ft))&&Lt[e.type](r,e)}Ft.keydown=function(r,e){var t=e;if(r.input.shiftKey=t.keyCode==16||t.shiftKey,!kN(r,t)&&(r.input.lastKeyCode=t.keyCode,r.input.lastKeyCodeTime=Date.now(),!(vn&&Rt&&t.keyCode==13)))if(t.keyCode!=229&&r.domObserver.forceFlush(),ws&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){var n=Date.now();r.input.lastIOSEnter=n,r.input.lastIOSEnterFallbackTimeout=setTimeout(function(){r.input.lastIOSEnter==n&&(r.someProp("handleKeyDown",function(i){return i(r,gi(13,"Enter"))}),r.input.lastIOSEnter=0)},200)}else r.someProp("handleKeyDown",function(i){return i(r,t)})||CB(r,t)?t.preventDefault():jn(r,"key")};Ft.keyup=function(r,e){e.keyCode==16&&(r.input.shiftKey=!1)};Ft.keypress=function(r,e){var t=e;if(!(kN(r,t)||!t.charCode||t.ctrlKey&&!t.altKey||tr&&t.metaKey)){if(r.someProp("handleKeyPress",function(a){return a(r,t)})){t.preventDefault();return}var n=r.state.selection;if(!(n instanceof Ae.TextSelection)||!n.$from.sameParent(n.$to)){var i=String.fromCharCode(t.charCode),s=function(){return r.state.tr.insertText(i).scrollIntoView()};!/[\r\n]/.test(i)&&!r.someProp("handleTextInput",function(a){return a(r,n.$from.pos,n.$to.pos,i,s)})&&r.dispatch(s()),t.preventDefault()}}};function uu(r){return{left:r.clientX,top:r.clientY}}function qB(r,e){var t=e.x-r.clientX,n=e.y-r.clientY;return t*t+n*n<100}function Mp(r,e,t,n,i){if(n==-1)return!1;for(var s=r.state.doc.resolve(n),a=function(c){if(r.someProp(e,function(f){return c>s.depth?f(r,t,s.nodeAfter,s.before(c),i,!0):f(r,t,s.node(c),s.before(c),i,!1)}))return{v:!0}},o,l=s.depth+1;l>0;l--)if(o=a(l),o)return o.v;return!1}function gs(r,e,t){if(r.focused||r.focus(),!r.state.selection.eq(e)){var n=r.state.tr.setSelection(e);t=="pointer"&&n.setMeta("pointer",!0),r.dispatch(n)}}function VB(r,e){if(e==-1)return!1;var t=r.state.doc.resolve(e),n=t.nodeAfter;return n&&n.isAtom&&Ae.NodeSelection.isSelectable(n)?(gs(r,new Ae.NodeSelection(t),"pointer"),!0):!1}function KB(r,e){if(e==-1)return!1;var t=r.state.selection,n,i;t instanceof Ae.NodeSelection&&(n=t.node);for(var s=r.state.doc.resolve(e),a=s.depth+1;a>0;a--){var o=a>s.depth?s.nodeAfter:s.node(a);if(Ae.NodeSelection.isSelectable(o)){n&&t.$from.depth>0&&a>=t.$from.depth&&s.before(t.$from.depth+1)==t.$from.pos?i=s.before(t.$from.depth):i=s.before(a);break}}return i!=null?(gs(r,Ae.NodeSelection.create(r.state.doc,i),"pointer"),!0):!1}function GB(r,e,t,n,i){return Mp(r,"handleClickOn",e,t,n)||r.someProp("handleClick",function(s){return s(r,e,n)})||(i?KB(r,t):VB(r,t))}function $B(r,e,t,n){return Mp(r,"handleDoubleClickOn",e,t,n)||r.someProp("handleDoubleClick",function(i){return i(r,e,n)})}function JB(r,e,t,n){return Mp(r,"handleTripleClickOn",e,t,n)||r.someProp("handleTripleClick",function(i){return i(r,e,n)})||XB(r,t,n)}function XB(r,e,t){if(t.button!=0)return!1;var n=r.state.doc;if(e==-1)return n.inlineContent?(gs(r,Ae.TextSelection.create(n,0,n.content.size),"pointer"),!0):!1;for(var i=n.resolve(e),s=i.depth+1;s>0;s--){var a=s>i.depth?i.nodeAfter:i.node(s),o=i.before(s);if(a.inlineContent)gs(r,Ae.TextSelection.create(n,o+1,o+1+a.content.size),"pointer");else if(Ae.NodeSelection.isSelectable(a))gs(r,Ae.NodeSelection.create(n,o),"pointer");else continue;return!0}}function Lp(r){return Mo(r)}var SN=tr?"metaKey":"ctrlKey";Lt.mousedown=function(r,e){var t=e;r.input.shiftKey=t.shiftKey;var n=Lp(r),i=Date.now(),s="singleClick";i-r.input.lastClick.time<500&&qB(t,r.input.lastClick)&&!t[SN]&&r.input.lastClick.button==t.button&&(r.input.lastClick.type=="singleClick"?s="doubleClick":r.input.lastClick.type=="doubleClick"&&(s="tripleClick")),r.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:s,button:t.button};var a=r.posAtCoords(uu(t));a&&(s=="singleClick"?(r.input.mouseDown&&r.input.mouseDown.done(),r.input.mouseDown=new YB(r,a,t,!!n)):(s=="doubleClick"?$B:JB)(r,a.pos,a.inside,t)?t.preventDefault():jn(r,"pointer"))};var YB=(function(){function r(e,t,n,i){var s=this;nt(this,r),this.view=e,this.pos=t,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[SN],this.allowDefault=n.shiftKey;var a,o;if(t.inside>-1)a=e.state.doc.nodeAt(t.inside),o=t.inside;else{var l=e.state.doc.resolve(t.pos);a=l.parent,o=l.depth?l.before():0}var u=i?null:n.target,c=u?e.docView.nearestDesc(u,!0):null;this.target=c&&c.nodeDOM.nodeType==1?c.nodeDOM:null;var f=e.state.selection;(n.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||f instanceof Ae.NodeSelection&&f.from<=o&&f.to>o)&&(this.mightDrag={node:a,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&nr&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(function(){s.view.input.mouseDown==s&&s.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),jn(e,"pointer")}return it(r,[{key:"done",value:function(){var t=this;this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(function(){return yn(t.view)}),this.view.input.mouseDown=null}},{key:"up",value:function(t){if(this.done(),!!this.view.dom.contains(t.target)){var n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(uu(t))),this.updateAllowDefault(t),this.allowDefault||!n?jn(this.view,"pointer"):GB(this.view,n.pos,n.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||Mt&&this.mightDrag&&!this.mightDrag.node.isAtom||Rt&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(gs(this.view,Ae.Selection.near(this.view.state.doc.resolve(n.pos)),"pointer"),t.preventDefault()):jn(this.view,"pointer")}}},{key:"move",value:function(t){this.updateAllowDefault(t),jn(this.view,"pointer"),t.buttons==0&&this.done()}},{key:"updateAllowDefault",value:function(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}]),r})();Lt.touchstart=function(r){r.input.lastTouch=Date.now(),Lp(r),jn(r,"pointer")};Lt.touchmove=function(r){r.input.lastTouch=Date.now(),jn(r,"pointer")};Lt.contextmenu=function(r){return Lp(r)};function kN(r,e){return r.composing?!0:Mt&&Math.abs(e.timeStamp-r.input.compositionEndedAt)<500?(r.input.compositionEndedAt=-2e8,!0):!1}var ZB=vn?5e3:-1;Ft.compositionstart=Ft.compositionupdate=function(r){if(!r.composing){r.domObserver.flush();var e=r.state,t=e.selection.$to;if(e.selection instanceof Ae.TextSelection&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(function(l){return l.type.spec.inclusive===!1})))r.markCursor=r.state.storedMarks||t.marks(),Mo(r,!0),r.markCursor=null;else if(Mo(r,!e.selection.empty),nr&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length)for(var n=r.domSelectionRange(),i=n.focusNode,s=n.focusOffset;i&&i.nodeType==1&&s!=0;){var a=s<0?i.lastChild:i.childNodes[s-1];if(!a)break;if(a.nodeType==3){var o=r.domSelection();o&&o.collapse(a,a.nodeValue.length);break}else i=a,s=-1}r.input.composing=!0}TN(r,ZB)};Ft.compositionend=function(r,e){r.composing&&(r.input.composing=!1,r.input.compositionEndedAt=e.timeStamp,r.input.compositionPendingChanges=r.domObserver.pendingRecords().length?r.input.compositionID:0,r.input.compositionNode=null,r.input.compositionPendingChanges&&Promise.resolve().then(function(){return r.domObserver.flush()}),r.input.compositionID++,TN(r,20))};function TN(r,e){clearTimeout(r.input.composingTimeout),e>-1&&(r.input.composingTimeout=setTimeout(function(){return Mo(r)},e))}function AN(r){for(r.composing&&(r.input.composing=!1,r.input.compositionEndedAt=eU());r.input.compositionNodes.length>0;)r.input.compositionNodes.pop().markParentsDirty()}function QB(r){var e=r.domSelectionRange();if(!e.focusNode)return null;var t=VF(e.focusNode,e.focusOffset),n=KF(e.focusNode,e.focusOffset);if(t&&n&&t!=n){var i=n.pmViewDesc,s=r.domObserver.lastChangedTextNode;if(t==s||n==s)return s;if(!i||!i.isText(n.nodeValue))return n;if(r.input.compositionNode==n){var a=t.pmViewDesc;if(!(!a||!a.isText(t.nodeValue)))return n}}return t||n}function eU(){var r=document.createEvent("Event");return r.initEvent("event",!0,!0),r.timeStamp}function Mo(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!(vn&&r.domObserver.flushingSoon>=0)){if(r.domObserver.forceFlush(),AN(r),e||r.docView&&r.docView.dirty){var t=Rp(r),n=r.state.selection;return t&&!t.eq(n)?r.dispatch(r.state.tr.setSelection(t)):(r.markCursor||e)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?r.dispatch(r.state.tr.deleteSelection()):r.updateState(r.state),!0}return!1}}function tU(r,e){if(r.dom.parentNode){var t=r.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";var n=getSelection(),i=document.createRange();i.selectNodeContents(e),r.dom.blur(),n.removeAllRanges(),n.addRange(i),setTimeout(function(){t.parentNode&&t.parentNode.removeChild(t),r.focus()},50)}}var Lo=qt&&Wn<15||ws&&YF<604;Lt.copy=Ft.cut=function(r,e){var t=e,n=r.state.selection,i=t.type=="cut";if(!n.empty){var s=Lo?null:t.clipboardData,a=n.content(),o=Ip(r,a),l=o.dom,u=o.text;s?(t.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",u)):tU(r,l),i&&r.dispatch(r.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}};function rU(r){return r.openStart==0&&r.openEnd==0&&r.content.childCount==1?r.content.firstChild:null}function nU(r,e){if(r.dom.parentNode){var t=r.input.shiftKey||r.state.selection.$from.parent.type.spec.code,n=r.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();var i=r.input.shiftKey&&r.input.lastKeyCode!=45;setTimeout(function(){r.focus(),n.parentNode&&n.parentNode.removeChild(n),t?Fo(r,n.value,null,i,e):Fo(r,n.textContent,n.innerHTML,i,e)},50)}}function Fo(r,e,t,n,i){var s=Pp(r,e,t,n,r.state.selection.$from);if(r.someProp("handlePaste",function(l){return l(r,i,s||Xe.Slice.empty)}))return!0;if(!s)return!1;var a=rU(s),o=a?r.state.tr.replaceSelectionWith(a,n):r.state.tr.replaceSelection(s);return r.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function ON(r){var e=r.getData("text/plain")||r.getData("Text");if(e)return e;var t=r.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Ft.paste=function(r,e){var t=e;if(!(r.composing&&!vn)){var n=Lo?null:t.clipboardData,i=r.input.shiftKey&&r.input.lastKeyCode!=45;n&&Fo(r,ON(n),n.getData("text/html"),i,t)?t.preventDefault():nU(r,t)}};var NN=it(function r(e,t,n){nt(this,r),this.slice=e,this.move=t,this.node=n}),iU=tr?"altKey":"ctrlKey";function RN(r,e){var t=r.someProp("dragCopies",function(n){return!n(e)});return t??!e[iU]}Lt.dragstart=function(r,e){var t=e,n=r.input.mouseDown;if(n&&n.done(),!!t.dataTransfer){var i=r.state.selection,s=i.empty?null:r.posAtCoords(uu(t)),a;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof Ae.NodeSelection?i.to-1:i.to))){if(n&&n.mightDrag)a=Ae.NodeSelection.create(r.state.doc,n.mightDrag.pos);else if(t.target&&t.target.nodeType==1){var o=r.docView.nearestDesc(t.target,!0);o&&o.node.type.spec.draggable&&o!=r.docView&&(a=Ae.NodeSelection.create(r.state.doc,o.posBefore))}}var l=(a||r.state.selection).content(),u=Ip(r,l),c=u.dom,f=u.text,d=u.slice;(!t.dataTransfer.files.length||!Rt||rN>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(Lo?"Text":"text/html",c.innerHTML),t.dataTransfer.effectAllowed="copyMove",Lo||t.dataTransfer.setData("text/plain",f),r.dragging=new NN(d,RN(r,t),a)}};Lt.dragend=function(r){var e=r.dragging;window.setTimeout(function(){r.dragging==e&&(r.dragging=null)},50)};Ft.dragover=Ft.dragenter=function(r,e){return e.preventDefault()};Ft.drop=function(r,e){var t=e,n=r.dragging;if(r.dragging=null,!!t.dataTransfer){var i=r.posAtCoords(uu(t));if(i){var s=r.state.doc.resolve(i.pos),a=n&&n.slice;a?r.someProp("transformPasted",function(x){a=x(a,r,!1)}):a=Pp(r,ON(t.dataTransfer),Lo?null:t.dataTransfer.getData("text/html"),!1,s);var o=!!(n&&RN(r,t));if(r.someProp("handleDrop",function(x){return x(r,t,a||Xe.Slice.empty,o)})){t.preventDefault();return}if(a){t.preventDefault();var l=a?jF.dropPoint(r.state.doc,s.pos,a):s.pos;l==null&&(l=s.pos);var u=r.state.tr;if(o){var c=n.node;c?c.replace(u):u.deleteSelection()}var f=u.mapping.map(l),d=a.openStart==0&&a.openEnd==0&&a.content.childCount==1,h=u.doc;if(d?u.replaceRangeWith(f,f,a.content.firstChild):u.replaceRange(f,f,a),!u.doc.eq(h)){var y=u.doc.resolve(f);if(d&&Ae.NodeSelection.isSelectable(a.content.firstChild)&&y.nodeAfter&&y.nodeAfter.sameMarkup(a.content.firstChild))u.setSelection(new Ae.NodeSelection(y));else{var v=u.mapping.map(l);u.mapping.maps[u.mapping.maps.length-1].forEach(function(x,m,_,b){return v=b}),u.setSelection(Cp(r,y,u.doc.resolve(v)))}r.focus(),r.dispatch(u.setMeta("uiEvent","drop"))}}}}};Lt.focus=function(r){r.input.lastFocus=Date.now(),r.focused||(r.domObserver.stop(),r.dom.classList.add("ProseMirror-focused"),r.domObserver.start(),r.focused=!0,setTimeout(function(){r.docView&&r.hasFocus()&&!r.domObserver.currentSelection.eq(r.domSelectionRange())&&yn(r)},20))};Lt.blur=function(r,e){var t=e;r.focused&&(r.domObserver.stop(),r.dom.classList.remove("ProseMirror-focused"),r.domObserver.start(),t.relatedTarget&&r.dom.contains(t.relatedTarget)&&r.domObserver.currentSelection.clear(),r.focused=!1)};Lt.beforeinput=function(r,e){var t=e;if(Rt&&vn&&t.inputType=="deleteContentBackward"){r.domObserver.flushSoon();var n=r.input.domChangeCount;setTimeout(function(){if(r.input.domChangeCount==n&&(r.dom.blur(),r.focus(),!r.someProp("handleKeyDown",function(s){return s(r,gi(8,"Backspace"))}))){var i=r.state.selection.$cursor;i&&i.pos>0&&r.dispatch(r.state.tr.delete(i.pos-1,i.pos).scrollIntoView())}},50)}};for(pp in Ft)Lt[pp]=Ft[pp];var pp;function Bo(r,e){if(r==e)return!0;for(var t in r)if(r[t]!==e[t])return!1;for(var n in e)if(!(n in r))return!1;return!0}var HO=(function(){function r(e,t){nt(this,r),this.toDOM=e,this.spec=t||wi,this.side=this.spec.side||0}return it(r,[{key:"map",value:function(t,n,i,s){var a=t.mapResult(n.from+s,this.side<0?-1:1),o=a.pos,l=a.deleted;return l?null:new Si(o-i,o-i,this)}},{key:"valid",value:function(){return!0}},{key:"eq",value:function(t){return this==t||t instanceof r&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Bo(this.spec,t.spec))}},{key:"destroy",value:function(t){this.spec.destroy&&this.spec.destroy(t)}}]),r})(),Do=(function(){function r(e,t){nt(this,r),this.attrs=e,this.spec=t||wi}return it(r,[{key:"map",value:function(t,n,i,s){var a=t.map(n.from+s,this.spec.inclusiveStart?-1:1)-i,o=t.map(n.to+s,this.spec.inclusiveEnd?1:-1)-i;return a>=o?null:new Si(a,o,this)}},{key:"valid",value:function(t,n){return n.from<n.to}},{key:"eq",value:function(t){return this==t||t instanceof r&&Bo(this.attrs,t.attrs)&&Bo(this.spec,t.spec)}},{key:"destroy",value:function(){}}],[{key:"is",value:function(t){return t.type instanceof r}}]),r})(),sU=(function(){function r(e,t){nt(this,r),this.attrs=e,this.spec=t||wi}return it(r,[{key:"map",value:function(t,n,i,s){var a=t.mapResult(n.from+s,1);if(a.deleted)return null;var o=t.mapResult(n.to+s,-1);return o.deleted||o.pos<=a.pos?null:new Si(a.pos-i,o.pos-i,this)}},{key:"valid",value:function(t,n){var i=t.content.findIndex(n.from),s=i.index,a=i.offset,o;return a==n.from&&!(o=t.child(s)).isText&&a+o.nodeSize==n.to}},{key:"eq",value:function(t){return this==t||t instanceof r&&Bo(this.attrs,t.attrs)&&Bo(this.spec,t.spec)}},{key:"destroy",value:function(){}}]),r})(),Si=(function(){function r(e,t,n){nt(this,r),this.from=e,this.to=t,this.type=n}return it(r,[{key:"copy",value:function(t,n){return new r(t,n,this.type)}},{key:"eq",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this.type.eq(t.type)&&this.from+n==t.from&&this.to+n==t.to}},{key:"map",value:function(t,n,i){return this.type.map(t,this,n,i)}},{key:"spec",get:function(){return this.type.spec}},{key:"inline",get:function(){return this.type instanceof Do}},{key:"widget",get:function(){return this.type instanceof HO}}],[{key:"widget",value:function(t,n,i){return new r(t,t,new HO(n,i))}},{key:"inline",value:function(t,n,i,s){return new r(t,n,new Do(i,s))}},{key:"node",value:function(t,n,i,s){return new r(t,n,new sU(i,s))}}]),r})(),ps=[],wi={},yr=(function(){function r(e,t){nt(this,r),this.local=e.length?e:ps,this.children=t.length?t:ps}return it(r,[{key:"find",value:function(t,n,i){var s=[];return this.findInner(t??0,n??1e9,s,0,i),s}},{key:"findInner",value:function(t,n,i,s,a){for(var o=0;o<this.local.length;o++){var l=this.local[o];l.from<=n&&l.to>=t&&(!a||a(l.spec))&&i.push(l.copy(l.from+s,l.to+s))}for(var u=0;u<this.children.length;u+=3)if(this.children[u]<n&&this.children[u+1]>t){var c=this.children[u]+1;this.children[u+2].findInner(t-c,n-c,i,s+c,a)}}},{key:"map",value:function(t,n,i){return this==Nt||t.maps.length==0?this:this.mapInner(t,n,0,0,i||wi)}},{key:"mapInner",value:function(t,n,i,s,a){for(var o,l=0;l<this.local.length;l++){var u=this.local[l].map(t,i,s);u&&u.type.valid(n,u)?(o||(o=[])).push(u):a.onRemove&&a.onRemove(this.local[l].spec)}return this.children.length?oU(this.children,o||[],t,n,i,s,a):o?new r(o.sort(bi),ps):Nt}},{key:"add",value:function(t,n){return n.length?this==Nt?r.create(t,n):this.addInner(t,n,0):this}},{key:"addInner",value:function(t,n,i){var s=this,a,o=0;t.forEach(function(c,f){var d=f+i,h;if(h=PN(n,c,d)){for(a||(a=s.children.slice());o<a.length&&a[o]<f;)o+=3;a[o]==f?a[o+2]=a[o+2].addInner(c,h,d+1):a.splice(o,0,f,f+c.nodeSize,au(h,c,d+1,wi)),o+=3}});for(var l=IN(o?DN(n):n,-i),u=0;u<l.length;u++)l[u].type.valid(t,l[u])||l.splice(u--,1);return new r(l.length?this.local.concat(l).sort(bi):this.local,a||this.children)}},{key:"remove",value:function(t){return t.length==0||this==Nt?this:this.removeInner(t,0)}},{key:"removeInner",value:function(t,n){for(var i=this.children,s=this.local,a=0;a<i.length;a+=3){for(var o=void 0,l=i[a]+n,u=i[a+1]+n,c=0,f;c<t.length;c++)(f=t[c])&&f.from>l&&f.to<u&&(t[c]=null,(o||(o=[])).push(f));if(o){i==this.children&&(i=this.children.slice());var d=i[a+2].removeInner(o,l+1);d!=Nt?i[a+2]=d:(i.splice(a,3),a-=3)}}if(s.length){for(var h=0,y;h<t.length;h++)if(y=t[h])for(var v=0;v<s.length;v++)s[v].eq(y,n)&&(s==this.local&&(s=this.local.slice()),s.splice(v--,1))}return i==this.children&&s==this.local?this:s.length||i.length?new r(s,i):Nt}},{key:"forChild",value:function(t,n){if(this==Nt)return this;if(n.isLeaf)return r.empty;for(var i,s,a=0;a<this.children.length;a+=3)if(this.children[a]>=t){this.children[a]==t&&(i=this.children[a+2]);break}for(var o=t+1,l=o+n.content.size,u=0;u<this.local.length;u++){var c=this.local[u];if(c.from<l&&c.to>o&&c.type instanceof Do){var f=Math.max(o,c.from)-o,d=Math.min(l,c.to)-o;f<d&&(s||(s=[])).push(c.copy(f,d))}}if(s){var h=new r(s.sort(bi),ps);return i?new CN([h,i]):h}return i||Nt}},{key:"eq",value:function(t){if(this==t)return!0;if(!(t instanceof r)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var n=0;n<this.local.length;n++)if(!this.local[n].eq(t.local[n]))return!1;for(var i=0;i<this.children.length;i+=3)if(this.children[i]!=t.children[i]||this.children[i+1]!=t.children[i+1]||!this.children[i+2].eq(t.children[i+2]))return!1;return!0}},{key:"locals",value:function(t){return Fp(this.localsInner(t))}},{key:"localsInner",value:function(t){if(this==Nt)return ps;if(t.inlineContent||!this.local.some(Do.is))return this.local;for(var n=[],i=0;i<this.local.length;i++)this.local[i].type instanceof Do||n.push(this.local[i]);return n}},{key:"forEachSet",value:function(t){t(this)}}],[{key:"create",value:function(t,n){return n.length?au(n,t,0,wi):Nt}}]),r})();yr.empty=new yr([],[]);yr.removeOverlap=Fp;var Nt=yr.empty,CN=(function(){function r(e){nt(this,r),this.members=e}return it(r,[{key:"map",value:function(t,n){var i=this.members.map(function(s){return s.map(t,n,wi)});return r.from(i)}},{key:"forChild",value:function(t,n){if(n.isLeaf)return yr.empty;for(var i=[],s=0;s<this.members.length;s++){var a=this.members[s].forChild(t,n);a!=Nt&&(a instanceof r?i=i.concat(a.members):i.push(a))}return r.from(i)}},{key:"eq",value:function(t){if(!(t instanceof r)||t.members.length!=this.members.length)return!1;for(var n=0;n<this.members.length;n++)if(!this.members[n].eq(t.members[n]))return!1;return!0}},{key:"locals",value:function(t){for(var n,i=!0,s=0;s<this.members.length;s++){var a=this.members[s].localsInner(t);if(a.length)if(!n)n=a;else{i&&(n=n.slice(),i=!1);for(var o=0;o<a.length;o++)n.push(a[o])}}return n?Fp(i?n:n.sort(bi)):ps}},{key:"forEachSet",value:function(t){for(var n=0;n<this.members.length;n++)this.members[n].forEachSet(t)}}],[{key:"from",value:function(t){switch(t.length){case 0:return Nt;case 1:return t[0];default:return new r(t.every(function(n){return n instanceof yr})?t:t.reduce(function(n,i){return n.concat(i instanceof yr?i:i.members)},[]))}}}]),r})();function oU(r,e,t,n,i,s,a){for(var o=r.slice(),l=function(H){var k=0;t.maps[u].forEach(function(V,Q,j,ie){for(var ee=ie-j-(Q-V),le=0;le<o.length;le+=3){var G=o[le+1];if(!(G<0||V>G+H-k)){var D=o[le]+H-k;Q>=D?o[le+1]=V<=D?-2:-1:V>=H&&ee&&(o[le]+=ee,o[le+1]+=ee)}}k+=ee}),H=t.maps[u].map(H,-1),c=H},u=0,c=s;u<t.maps.length;u++)l(c);for(var f=!1,d=0;d<o.length;d+=3)if(o[d+1]<0){if(o[d+1]==-2){f=!0,o[d+1]=-1;continue}var h=t.map(r[d]+s),y=h-i;if(y<0||y>=n.content.size){f=!0;continue}var v=t.map(r[d+1]+s,-1),x=v-i,m=n.content.findIndex(y),_=m.index,b=m.offset,w=n.maybeChild(_);if(w&&b==y&&b+w.nodeSize==x){var T=o[d+2].mapInner(t,w,h+1,r[d]+s+1,a);T!=Nt?(o[d]=y,o[d+1]=x,o[d+2]=T):(o[d+1]=-2,f=!0)}else f=!0}if(f){var P=aU(o,r,e,t,i,s,a),M=au(P,n,0,a);e=M.local;for(var U=0;U<o.length;U+=3)o[U+1]<0&&(o.splice(U,3),U-=3);for(var R=0,J=0;R<M.children.length;R+=3){for(var oe=M.children[R];J<o.length&&o[J]<oe;)J+=3;o.splice(J,0,M.children[R],M.children[R+1],M.children[R+2])}}return new yr(e.sort(bi),o)}function IN(r,e){if(!e||!r.length)return r;for(var t=[],n=0;n<r.length;n++){var i=r[n];t.push(new Si(i.from+e,i.to+e,i.type))}return t}function aU(r,e,t,n,i,s,a){function o(u,c){for(var f=0;f<u.local.length;f++){var d=u.local[f].map(n,i,c);d?t.push(d):a.onRemove&&a.onRemove(u.local[f].spec)}for(var h=0;h<u.children.length;h+=3)o(u.children[h+2],u.children[h]+c+1)}for(var l=0;l<r.length;l+=3)r[l+1]==-1&&o(r[l+2],e[l]+s+1);return t}function PN(r,e,t){if(e.isLeaf)return null;for(var n=t+e.nodeSize,i=null,s=0,a;s<r.length;s++)(a=r[s])&&a.from>t&&a.to<n&&((i||(i=[])).push(a),r[s]=null);return i}function DN(r){for(var e=[],t=0;t<r.length;t++)r[t]!=null&&e.push(r[t]);return e}function au(r,e,t,n){var i=[],s=!1;e.forEach(function(l,u){var c=PN(r,l,u+t);if(c){s=!0;var f=au(c,l,t+u+1,n);f!=Nt&&i.push(u,u+l.nodeSize,f)}});for(var a=IN(s?DN(r):r,-t).sort(bi),o=0;o<a.length;o++)a[o].type.valid(e,a[o])||(n.onRemove&&n.onRemove(a[o].spec),a.splice(o--,1));return a.length||i.length?new yr(a,i):Nt}function bi(r,e){return r.from-e.from||r.to-e.to}function Fp(r){for(var e=r,t=0;t<e.length-1;t++){var n=e[t];if(n.from!=n.to)for(var i=t+1;i<e.length;i++){var s=e[i];if(s.from==n.from){s.to!=n.to&&(e==r&&(e=r.slice()),e[i]=s.copy(s.from,n.to),zO(e,i+1,s.copy(n.to,s.to)));continue}else{s.from<n.to&&(e==r&&(e=r.slice()),e[t]=n.copy(n.from,s.from),zO(e,i,n.copy(s.from,n.to)));break}}}return e}function zO(r,e,t){for(;e<r.length&&bi(t,r[e])>0;)e++;r.splice(e,0,t)}function mp(r){var e=[];return r.someProp("decorations",function(t){var n=t(r.state);n&&n!=Nt&&e.push(n)}),r.cursorWrapper&&e.push(yr.create(r.state.doc,[r.cursorWrapper.deco])),CN.from(e)}var lU={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},uU=qt&&Wn<=11,cU=(function(){function r(){nt(this,r),this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}return it(r,[{key:"set",value:function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}},{key:"clear",value:function(){this.anchorNode=this.focusNode=null}},{key:"eq",value:function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}]),r})(),fU=(function(){function r(e,t){var n=this;nt(this,r),this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new cU,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(function(i){for(var s=0;s<i.length;s++)n.queue.push(i[s]);qt&&Wn<=11&&i.some(function(a){return a.type=="childList"&&a.removedNodes.length||a.type=="characterData"&&a.oldValue.length>a.target.nodeValue.length})?n.flushSoon():n.flush()}),uU&&(this.onCharData=function(i){n.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}return it(r,[{key:"flushSoon",value:function(){var t=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(function(){t.flushingSoon=-1,t.flush()},20))}},{key:"forceFlush",value:function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}},{key:"start",value:function(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,lU)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}},{key:"stop",value:function(){var t=this;if(this.observer){var n=this.observer.takeRecords();if(n.length){for(var i=0;i<n.length;i++)this.queue.push(n[i]);window.setTimeout(function(){return t.flush()},20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}},{key:"connectSelection",value:function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}},{key:"disconnectSelection",value:function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}},{key:"suppressSelectionUpdates",value:function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout(function(){return t.suppressingSelectionUpdates=!1},50)}},{key:"onSelectionChange",value:function(){if(IO(this.view)){if(this.suppressingSelectionUpdates)return yn(this.view);if(qt&&Wn<=11&&!this.view.state.selection.empty){var t=this.view.domSelectionRange();if(t.focusNode&&_i(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}},{key:"setCurSelection",value:function(){this.currentSelection.set(this.view.domSelectionRange())}},{key:"ignoreSelectionChange",value:function(t){if(!t.focusNode)return!0;for(var n=new Set,i,s=t.focusNode;s;s=ys(s))n.add(s);for(var a=t.anchorNode;a;a=ys(a))if(n.has(a)){i=a;break}var o=i&&this.view.docView.nearestDesc(i);if(o&&o.ignoreMutation({type:"selection",target:i.nodeType==3?i.parentNode:i}))return this.setCurSelection(),!0}},{key:"pendingRecords",value:function(){if(this.observer){var t=vp(this.observer.takeRecords()),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;this.queue.push(i)}}catch(s){t.e(s)}finally{t.f()}}return this.queue}},{key:"flush",value:function(){var t=this.view;if(!(!t.docView||this.flushingSoon>-1)){var n=this.pendingRecords();n.length&&(this.queue=[]);var i=t.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(i)&&IO(t)&&!this.ignoreSelectionChange(i),a=-1,o=-1,l=!1,u=[];if(t.editable)for(var c=0;c<n.length;c++){var f=this.registerMutation(n[c],u);f&&(a=a<0?f.from:Math.min(f.from,a),o=o<0?f.to:Math.max(f.to,o),f.typeOver&&(l=!0))}if(nr&&u.length){var d=u.filter(function(P){return P.nodeName=="BR"});if(d.length==2){var h=ZO(d,2),y=h[0],v=h[1];y.parentNode&&y.parentNode.parentNode==v.parentNode?v.remove():y.remove()}else{var x=this.currentSelection.focusNode,m=vp(d),_;try{for(m.s();!(_=m.n()).done;){var b=_.value,w=b.parentNode;w&&w.nodeName=="LI"&&(!x||pU(t,x)!=w)&&b.remove()}}catch(P){m.e(P)}finally{m.f()}}}var T=null;a<0&&s&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&lu(i)&&(T=Rp(t))&&T.eq(Ae.Selection.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,yn(t),this.currentSelection.set(i),t.scrollToSelection()):(a>-1||s)&&(a>-1&&(t.docView.markDirty(a,o),hU(t)),this.handleDOMChange(a,o,l,u),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(i)||yn(t),this.currentSelection.set(i))}}},{key:"registerMutation",value:function(t,n){if(n.indexOf(t.target)>-1)return null;var i=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(i==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!i||i.ignoreMutation(t))return null;if(t.type=="childList"){for(var s=0;s<t.addedNodes.length;s++){var a=t.addedNodes[s];n.push(a),a.nodeType==3&&(this.lastChangedTextNode=a)}if(i.contentDOM&&i.contentDOM!=i.dom&&!i.contentDOM.contains(t.target))return{from:i.posBefore,to:i.posAfter};var o=t.previousSibling,l=t.nextSibling;if(qt&&Wn<=11&&t.addedNodes.length)for(var u=0;u<t.addedNodes.length;u++){var c=t.addedNodes[u],f=c.previousSibling,d=c.nextSibling;(!f||Array.prototype.indexOf.call(t.addedNodes,f)<0)&&(o=f),(!d||Array.prototype.indexOf.call(t.addedNodes,d)<0)&&(l=d)}var h=o&&o.parentNode==t.target?xt(o)+1:0,y=i.localPosFromDOM(t.target,h,-1),v=l&&l.parentNode==t.target?xt(l):t.target.childNodes.length,x=i.localPosFromDOM(t.target,v,1);return{from:y,to:x}}else return t.type=="attributes"?{from:i.posAtStart-i.border,to:i.posAtEnd+i.border}:(this.lastChangedTextNode=t.target,{from:i.posAtStart,to:i.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}]),r})(),jO=new WeakMap,WO=!1;function hU(r){if(!jO.has(r)&&(jO.set(r,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(r.dom).whiteSpace)!==-1)){if(r.requiresGeckoHackNode=nr,WO)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),WO=!0}}function qO(r,e){var t=e.startContainer,n=e.startOffset,i=e.endContainer,s=e.endOffset,a=r.domAtPos(r.state.selection.anchor);if(_i(a.node,a.offset,i,s)){var o=[i,s,t,n];t=o[0],n=o[1],i=o[2],s=o[3]}return{anchorNode:t,anchorOffset:n,focusNode:i,focusOffset:s}}function dU(r,e){if(e.getComposedRanges){var t=e.getComposedRanges(r.root)[0];if(t)return qO(r,t)}var n;function i(s){s.preventDefault(),s.stopImmediatePropagation(),n=s.getTargetRanges()[0]}return r.dom.addEventListener("beforeinput",i,!0),document.execCommand("indent"),r.dom.removeEventListener("beforeinput",i,!0),n?qO(r,n):null}function pU(r,e){for(var t=e.parentNode;t&&t!=r.dom;t=t.parentNode){var n=r.docView.nearestDesc(t,!0);if(n&&n.node.isBlock)return t}return null}function mU(r,e,t){var n=r.docView.parseRange(e,t),i=n.node,s=n.fromOffset,a=n.toOffset,o=n.from,l=n.to,u=r.domSelectionRange(),c,f=u.anchorNode;if(f&&r.dom.contains(f.nodeType==1?f:f.parentNode)&&(c=[{node:f,offset:u.anchorOffset}],lu(u)||c.push({node:u.focusNode,offset:u.focusOffset})),Rt&&r.input.lastKeyCode===8)for(var d=a;d>s;d--){var h=i.childNodes[d-1],y=h.pmViewDesc;if(h.nodeName=="BR"&&!y){a=d;break}if(!y||y.size)break}var v=r.state.doc,x=r.someProp("domParser")||Xe.DOMParser.fromSchema(r.state.schema),m=v.resolve(o),_=null,b=x.parse(i,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:s,to:a,preserveWhitespace:m.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:gU,context:m});if(c&&c[0].pos!=null){var w=c[0].pos,T=c[1]&&c[1].pos;T==null&&(T=w),_={anchor:w+o,head:T+o}}return{doc:b,sel:_,from:o,to:l}}function gU(r){var e=r.pmViewDesc;if(e)return e.parseRule();if(r.nodeName=="BR"&&r.parentNode){if(Mt&&/^(ul|ol)$/i.test(r.parentNode.nodeName)){var t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(r.parentNode.lastChild==r||Mt&&/^(tr|table)$/i.test(r.parentNode.nodeName))return{ignore:!0}}else if(r.nodeName=="IMG"&&r.getAttribute("mark-placeholder"))return{ignore:!0};return null}var vU=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function yU(r,e,t,n,i){var s=r.input.compositionPendingChanges||(r.composing?r.input.compositionID:0);if(r.input.compositionPendingChanges=0,e<0){var a=r.input.lastSelectionTime>Date.now()-50?r.input.lastSelectionOrigin:null,o=Rp(r,a);if(o&&!r.state.selection.eq(o)){if(Rt&&vn&&r.input.lastKeyCode===13&&Date.now()-100<r.input.lastKeyCodeTime&&r.someProp("handleKeyDown",function(j){return j(r,gi(13,"Enter"))}))return;var l=r.state.tr.setSelection(o);a=="pointer"?l.setMeta("pointer",!0):a=="key"&&l.scrollIntoView(),s&&l.setMeta("composition",s),r.dispatch(l)}return}var u=r.state.doc.resolve(e),c=u.sharedDepth(t);e=u.before(c+1),t=r.state.doc.resolve(t).after(c+1);var f=r.state.selection,d=mU(r,e,t),h=r.state.doc,y=h.slice(d.from,d.to),v,x;r.input.lastKeyCode===8&&Date.now()-100<r.input.lastKeyCodeTime?(v=r.state.selection.to,x="end"):(v=r.state.selection.from,x="start"),r.input.lastKeyCode=null;var m=_U(y.content,d.doc.content,d.from,v,x);if(m&&r.input.domChangeCount++,(ws&&r.input.lastIOSEnter>Date.now()-225||vn)&&i.some(function(j){return j.nodeType==1&&!vU.test(j.nodeName)})&&(!m||m.endA>=m.endB)&&r.someProp("handleKeyDown",function(j){return j(r,gi(13,"Enter"))})){r.input.lastIOSEnter=0;return}if(!m)if(n&&f instanceof Ae.TextSelection&&!f.empty&&f.$head.sameParent(f.$anchor)&&!r.composing&&!(d.sel&&d.sel.anchor!=d.sel.head))m={start:f.from,endA:f.to,endB:f.to};else{if(d.sel){var _=VO(r,r.state.doc,d.sel);if(_&&!_.eq(r.state.selection)){var b=r.state.tr.setSelection(_);s&&b.setMeta("composition",s),r.dispatch(b)}}return}r.state.selection.from<r.state.selection.to&&m.start==m.endB&&r.state.selection instanceof Ae.TextSelection&&(m.start>r.state.selection.from&&m.start<=r.state.selection.from+2&&r.state.selection.from>=d.from?m.start=r.state.selection.from:m.endA<r.state.selection.to&&m.endA>=r.state.selection.to-2&&r.state.selection.to<=d.to&&(m.endB+=r.state.selection.to-m.endA,m.endA=r.state.selection.to)),qt&&Wn<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>d.from&&d.doc.textBetween(m.start-d.from-1,m.start-d.from+1)==" \xA0"&&(m.start--,m.endA--,m.endB--);var w=d.doc.resolveNoCache(m.start-d.from),T=d.doc.resolveNoCache(m.endB-d.from),P=h.resolve(m.start),M=w.sameParent(T)&&w.parent.inlineContent&&P.end()>=m.endA;if((ws&&r.input.lastIOSEnter>Date.now()-225&&(!M||i.some(function(j){return j.nodeName=="DIV"||j.nodeName=="P"}))||!M&&w.pos<d.doc.content.size&&(!w.sameParent(T)||!w.parent.inlineContent)&&w.pos<T.pos&&!/\S/.test(d.doc.textBetween(w.pos,T.pos,"","")))&&r.someProp("handleKeyDown",function(j){return j(r,gi(13,"Enter"))})){r.input.lastIOSEnter=0;return}if(r.state.selection.anchor>m.start&&bU(h,m.start,m.endA,w,T)&&r.someProp("handleKeyDown",function(j){return j(r,gi(8,"Backspace"))})){vn&&Rt&&r.domObserver.suppressSelectionUpdates();return}Rt&&m.endB==m.start&&(r.input.lastChromeDelete=Date.now()),vn&&!M&&w.start()!=T.start()&&T.parentOffset==0&&w.depth==T.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==m.endA&&(m.endB-=2,T=d.doc.resolveNoCache(m.endB-d.from),setTimeout(function(){r.someProp("handleKeyDown",function(j){return j(r,gi(13,"Enter"))})},20));var U=m.start,R=m.endA,J=function(ie){var ee=ie||r.state.tr.replace(U,R,d.doc.slice(m.start-d.from,m.endB-d.from));if(d.sel){var le=VO(r,ee.doc,d.sel);le&&!(Rt&&r.composing&&le.empty&&(m.start!=m.endB||r.input.lastChromeDelete<Date.now()-100)&&(le.head==U||le.head==ee.mapping.map(R)-1)||qt&&le.empty&&le.head==U)&&ee.setSelection(le)}return s&&ee.setMeta("composition",s),ee.scrollIntoView()},oe;if(M)if(w.pos==T.pos){qt&&Wn<=11&&w.parentOffset==0&&(r.domObserver.suppressSelectionUpdates(),setTimeout(function(){return yn(r)},20));var C=J(r.state.tr.delete(U,R)),H=h.resolve(m.start).marksAcross(h.resolve(m.endA));H&&C.ensureMarks(H),r.dispatch(C)}else if(m.endA==m.endB&&(oe=wU(w.parent.content.cut(w.parentOffset,T.parentOffset),P.parent.content.cut(P.parentOffset,m.endA-P.start())))){var k=J(r.state.tr);oe.type=="add"?k.addMark(U,R,oe.mark):k.removeMark(U,R,oe.mark),r.dispatch(k)}else if(w.parent.child(w.index()).isText&&w.index()==T.index()-(T.textOffset?0:1)){var V=w.parent.textBetween(w.parentOffset,T.parentOffset),Q=function(){return J(r.state.tr.insertText(V,U,R))};r.someProp("handleTextInput",function(j){return j(r,U,R,V,Q)})||r.dispatch(Q())}else r.dispatch(J());else r.dispatch(J())}function VO(r,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:Cp(r,e.resolve(t.anchor),e.resolve(t.head))}function wU(r,e){for(var t=r.firstChild.marks,n=e.firstChild.marks,i=t,s=n,a,o,l,u=0;u<n.length;u++)i=n[u].removeFromSet(i);for(var c=0;c<t.length;c++)s=t[c].removeFromSet(s);if(i.length==1&&s.length==0)o=i[0],a="add",l=function(y){return y.mark(o.addToSet(y.marks))};else if(i.length==0&&s.length==1)o=s[0],a="remove",l=function(y){return y.mark(o.removeFromSet(y.marks))};else return null;for(var f=[],d=0;d<e.childCount;d++)f.push(l(e.child(d)));if(Xe.Fragment.from(f).eq(r))return{mark:o,type:a}}function bU(r,e,t,n,i){if(t-e<=i.pos-n.pos||gp(n,!0,!1)<i.pos)return!1;var s=r.resolve(e);if(!n.parent.isTextblock){var a=s.nodeAfter;return a!=null&&t==e+a.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;var o=r.resolve(gp(s,!0,!0));return!o.parent.isTextblock||o.pos>t||gp(o,!0,!1)<t?!1:n.parent.content.cut(n.parentOffset).eq(o.parent.content)}function gp(r,e,t){for(var n=r.depth,i=e?r.end():r.pos;n>0&&(e||r.indexAfter(n)==r.node(n).childCount);)n--,i++,e=!1;if(t)for(var s=r.node(n).maybeChild(r.indexAfter(n));s&&!s.isLeaf;)s=s.firstChild,i++;return i}function _U(r,e,t,n,i){var s=r.findDiffStart(e,t);if(s==null)return null;var a=r.findDiffEnd(e,t+r.size,t+e.size),o=a.a,l=a.b;if(i=="end"){var u=Math.max(0,s-Math.min(o,l));n-=o+u-s}if(o<s&&r.size<e.size){var c=n<=s&&n>=o?s-n:0;s-=c,s&&s<e.size&&KO(e.textBetween(s-1,s+1))&&(s+=c?1:-1),l=s+(l-o),o=s}else if(l<s){var f=n<=s&&n>=l?s-n:0;s-=f,s&&s<r.size&&KO(r.textBetween(s-1,s+1))&&(s+=f?1:-1),o=s+(o-l),l=s}return{start:s,endA:o,endB:l}}function KO(r){if(r.length!=2)return!1;var e=r.charCodeAt(0),t=r.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}var xU=Pp,EU=Mo,MN=(function(){function r(e,t){var n=this;nt(this,r),this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new UB,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(YO),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=JO(this),$O(this),this.nodeViews=XO(this),this.docView=TO(this.state.doc,GO(this),mp(this),this.dom,this),this.domObserver=new fU(this,function(i,s,a,o){return yU(n,i,s,a,o)}),this.domObserver.start(),HB(this),this.updatePluginViews()}return it(r,[{key:"composing",get:function(){return this.input.composing}},{key:"props",get:function(){if(this._props.state!=this.state){var t=this._props;this._props={};for(var n in t)this._props[n]=t[n];this._props.state=this.state}return this._props}},{key:"update",value:function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Op(this);var n=this._props;this._props=t,t.plugins&&(t.plugins.forEach(YO),this.directPlugins=t.plugins),this.updateStateInner(t.state,n)}},{key:"setProps",value:function(t){var n={};for(var i in this._props)n[i]=this._props[i];n.state=this.state;for(var s in t)n[s]=t[s];this.update(n)}},{key:"updateState",value:function(t){this.updateStateInner(t,this._props)}},{key:"updateStateInner",value:function(t,n){var i,s=this.state,a=!1,o=!1;t.storedMarks&&this.composing&&(AN(this),o=!0),this.state=t;var l=s.plugins!=t.plugins||this._props.plugins!=n.plugins;if(l||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){var u=XO(this);kU(u,this.nodeViews)&&(this.nodeViews=u,a=!0)}(l||n.handleDOMEvents!=this._props.handleDOMEvents)&&Op(this),this.editable=JO(this),$O(this);var c=mp(this),f=GO(this),d=s.plugins!=t.plugins&&!s.doc.eq(t.doc)?"reset":t.scrollToSelection>s.scrollToSelection?"to selection":"preserve",h=a||!this.docView.matchesNode(t.doc,f,c);(h||!t.selection.eq(s.selection))&&(o=!0);var y=d=="preserve"&&o&&this.dom.style.overflowAnchor==null&&eB(this);if(o){this.domObserver.stop();var v=h&&(qt||Rt)&&!this.composing&&!s.selection.empty&&!t.selection.empty&&SU(s.selection,t.selection);if(h){var x=Rt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=QB(this)),(a||!this.docView.update(t.doc,f,c,this))&&(this.docView.updateOuterDeco(f),this.docView.destroy(),this.docView=TO(t.doc,f,c,this.dom,this)),x&&!this.trackWrites&&(v=!0)}v||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&SB(this))?yn(this,v):(gN(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((i=this.dragging)===null||i===void 0)&&i.node&&!s.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,s),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():y&&tB(y)}},{key:"scrollToSelection",value:function(){var t=this,n=this.domSelectionRange().focusNode;if(!(!n||!this.dom.contains(n.nodeType==1?n:n.parentNode))){if(!this.someProp("handleScrollToSelection",function(s){return s(t)}))if(this.state.selection instanceof Ae.NodeSelection){var i=this.docView.domAfterPos(this.state.selection.from);i.nodeType==1&&bO(this,i.getBoundingClientRect(),n)}else bO(this,this.coordsAtPos(this.state.selection.head,1),n)}}},{key:"destroyPluginViews",value:function(){for(var t;t=this.pluginViews.pop();)t.destroy&&t.destroy()}},{key:"updatePluginViews",value:function(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(var n=0;n<this.directPlugins.length;n++){var i=this.directPlugins[n];i.spec.view&&this.pluginViews.push(i.spec.view(this))}for(var s=0;s<this.state.plugins.length;s++){var a=this.state.plugins[s];a.spec.view&&this.pluginViews.push(a.spec.view(this))}}else for(var o=0;o<this.pluginViews.length;o++){var l=this.pluginViews[o];l.update&&l.update(this,t)}}},{key:"updateDraggedNode",value:function(t,n){var i=t.node,s=-1;if(this.state.doc.nodeAt(i.from)==i.node)s=i.from;else{var a=i.from+(this.state.doc.content.size-n.doc.content.size),o=a>0&&this.state.doc.nodeAt(a);o==i.node&&(s=a)}this.dragging=new NN(t.slice,t.move,s<0?void 0:Ae.NodeSelection.create(this.state.doc,s))}},{key:"someProp",value:function(t,n){var i=this._props&&this._props[t],s;if(i!=null&&(s=n?n(i):i))return s;for(var a=0;a<this.directPlugins.length;a++){var o=this.directPlugins[a].props[t];if(o!=null&&(s=n?n(o):o))return s}var l=this.state.plugins;if(l)for(var u=0;u<l.length;u++){var c=l[u].props[t];if(c!=null&&(s=n?n(c):c))return s}}},{key:"hasFocus",value:function(){if(qt){var t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}},{key:"focus",value:function(){this.domObserver.stop(),this.editable&&rB(this.dom),yn(this),this.domObserver.start()}},{key:"root",get:function(){var t=this,n=this._root;if(n==null){for(var i=function(l){if(l.nodeType==9||l.nodeType==11&&l.host)return l.getSelection||(Object.getPrototypeOf(l).getSelection=function(){return l.ownerDocument.getSelection()}),{v:t._root=l}},s,a=this.dom.parentNode;a;a=a.parentNode)if(s=i(a),s)return s.v}return n||document}},{key:"updateRoot",value:function(){this._root=null}},{key:"posAtCoords",value:function(t){return aB(this,t)}},{key:"coordsAtPos",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return aN(this,t,n)}},{key:"domAtPos",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this.docView.domFromPos(t,n)}},{key:"nodeDOM",value:function(t){var n=this.docView.descAt(t);return n?n.nodeDOM:null}},{key:"posAtDOM",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,s=this.docView.posFromDOM(t,n,i);if(s==null)throw new RangeError("DOM position not inside the editor");return s}},{key:"endOfTextblock",value:function(t,n){return hB(this,n||this.state,t)}},{key:"pasteHTML",value:function(t,n){return Fo(this,"",t,!1,n||new ClipboardEvent("paste"))}},{key:"pasteText",value:function(t,n){return Fo(this,t,null,!0,n||new ClipboardEvent("paste"))}},{key:"serializeForClipboard",value:function(t){return Ip(this,t)}},{key:"destroy",value:function(){this.docView&&(zB(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],mp(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,WF())}},{key:"isDestroyed",get:function(){return this.docView==null}},{key:"dispatchEvent",value:function(t){return WB(this,t)}},{key:"domSelectionRange",value:function(){var t=this.domSelection();return t?Mt&&this.root.nodeType===11&&$F(this.dom.ownerDocument)==this.dom&&dU(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}},{key:"domSelection",value:function(){return this.root.getSelection()}}]),r})();MN.prototype.dispatch=function(r){var e=this._props.dispatchTransaction;e?e.call(this,r):this.updateState(this.state.apply(r))};function GO(r){var e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(r.editable),r.someProp("attributes",function(t){if(typeof t=="function"&&(t=t(r.state)),t)for(var n in t)n=="class"?e.class+=" "+t[n]:n=="style"?e.style=(e.style?e.style+";":"")+t[n]:!e[n]&&n!="contenteditable"&&n!="nodeName"&&(e[n]=String(t[n]))}),e.translate||(e.translate="no"),[Si.node(0,r.state.doc.content.size,e)]}function $O(r){if(r.markCursor){var e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),r.cursorWrapper={dom:e,deco:Si.widget(r.state.selection.from,e,{raw:!0,marks:r.markCursor})}}else r.cursorWrapper=null}function JO(r){return!r.someProp("editable",function(e){return e(r.state)===!1})}function SU(r,e){var t=Math.min(r.$anchor.sharedDepth(r.head),e.$anchor.sharedDepth(e.head));return r.$anchor.start(t)!=e.$anchor.start(t)}function XO(r){var e=Object.create(null);function t(n){for(var i in n)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=n[i])}return r.someProp("nodeViews",t),r.someProp("markViews",t),e}function kU(r,e){var t=0,n=0;for(var i in r){if(r[i]!=e[i])return!0;t++}for(var s in e)n++;return t!=n}function YO(r){if(r.spec.state||r.spec.filterTransaction||r.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}bs.Decoration=Si;bs.DecorationSet=yr;bs.EditorView=MN;bs.__endComposition=EU;bs.__parseFromClipboard=xU});var jo=xe(cu=>{"use strict";Object.defineProperty(cu,"__esModule",{value:!0});function TU(r){Object.keys(r).filter(e=>e!=="default"&&e!=="__esModule").forEach(e=>{cu.hasOwnProperty(e)||Object.defineProperty(cu,e,{enumerable:!0,configurable:!0,get:()=>r[e]})})}var AU=Bp();TU(AU)});var LN=xe(qo=>{"use strict";Object.defineProperty(qo,"__esModule",{value:!0});var Vn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Wo={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},OU=typeof navigator<"u"&&/Mac/.test(navigator.platform),NU=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(at=0;at<10;at++)Vn[48+at]=Vn[96+at]=String(at);var at;for(at=1;at<=24;at++)Vn[at+111]="F"+at;var at;for(at=65;at<=90;at++)Vn[at]=String.fromCharCode(at+32),Wo[at]=String.fromCharCode(at);var at;for(fu in Vn)Wo.hasOwnProperty(fu)||(Wo[fu]=Vn[fu]);var fu;function RU(r){var e=OU&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||NU&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",t=!e&&r.key||(r.shiftKey?Wo:Vn)[r.keyCode]||r.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}qo.base=Vn;qo.keyName=RU;qo.shift=Wo});var zp=xe(Hp=>{"use strict";var FN=LN(),CU=dn(),IU=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),PU=typeof navigator<"u"&&/Win/.test(navigator.platform);function DU(r){var e=r.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");for(var n,i,s,a,o=0;o<e.length-1;o++){var l=e[o];if(/^(cmd|meta|m)$/i.test(l))a=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))IU?a=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return n&&(t="Alt-"+t),i&&(t="Ctrl-"+t),a&&(t="Meta-"+t),s&&(t="Shift-"+t),t}function MU(r){var e=Object.create(null);for(var t in r)e[DU(t)]=r[t];return e}function Up(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),t&&e.shiftKey&&(r="Shift-"+r),r}function LU(r){return new CU.Plugin({props:{handleKeyDown:BN(r)}})}function BN(r){var e=MU(r);return function(t,n){var i=FN.keyName(n),s,a=e[Up(i,n)];if(a&&a(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(n.shiftKey){var o=e[Up(i,n,!1)];if(o&&o(t.state,t.dispatch,t))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(PU&&n.ctrlKey&&n.altKey)&&(s=FN.base[n.keyCode])&&s!=i){var l=e[Up(s,n)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}Hp.keydownHandler=BN;Hp.keymap=LU});var UN=xe(hu=>{"use strict";Object.defineProperty(hu,"__esModule",{value:!0});function FU(r){Object.keys(r).filter(e=>e!=="default"&&e!=="__esModule").forEach(e=>{hu.hasOwnProperty(e)||Object.defineProperty(hu,e,{enumerable:!0,configurable:!0,get:()=>r[e]})})}var BU=zp();FU(BU)});var Se=xe((kQ,YR)=>{"use strict";var Xp=Object.defineProperty,UU=Object.getOwnPropertyDescriptor,HU=Object.getOwnPropertyNames,zU=Object.prototype.hasOwnProperty,bu=(r,e)=>{for(var t in e)Xp(r,t,{get:e[t],enumerable:!0})},jU=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of HU(e))!zU.call(r,i)&&i!==t&&Xp(r,i,{get:()=>e[i],enumerable:!(n=UU(e,i))||n.enumerable});return r},WU=r=>jU(Xp({},"__esModule",{value:!0}),r),rR={};bu(rR,{CommandManager:()=>Yo,Editor:()=>lz,Extendable:()=>Cu,Extension:()=>wr,Fragment:()=>pz,InputRule:()=>Ts,Mark:()=>ER,MarkView:()=>Ez,Node:()=>Sz,NodePos:()=>zR,NodeView:()=>kz,PasteRule:()=>Iu,ResizableNodeView:()=>WR,ResizableNodeview:()=>gz,Tracker:()=>Nz,callOrReturn:()=>Le,canInsertNode:()=>yz,combineTransactionSteps:()=>oR,commands:()=>Yp,createAtomBlockMarkdownSpec:()=>VR,createBlockMarkdownSpec:()=>KR,createChainableState:()=>Xo,createDocument:()=>yu,createElement:()=>eR,createInlineMarkdownSpec:()=>GR,createNodeFromContent:()=>Es,createStyleTag:()=>jR,defaultBlockAt:()=>aR,deleteProps:()=>Kp,elementFromString:()=>xs,escapeForRegEx:()=>wz,extensions:()=>AR,findChildren:()=>r9,findChildrenInRange:()=>n9,findDuplicates:()=>hR,findParentNode:()=>Qo,findParentNodeClosestToPos:()=>lR,flattenExtensions:()=>ku,fromString:()=>fR,generateHTML:()=>a9,generateJSON:()=>u9,generateText:()=>f9,getAttributes:()=>pR,getAttributesFromExtensions:()=>nm,getChangedRanges:()=>gR,getDebugJSON:()=>vR,getExtensionField:()=>Ee,getHTMLFromFragment:()=>ea,getMarkAttributes:()=>tm,getMarkRange:()=>xu,getMarkType:()=>Dr,getMarksBetween:()=>am,getNodeAtPosition:()=>d9,getNodeAttributes:()=>dR,getNodeType:()=>pt,getRenderedAttributes:()=>Jo,getSchema:()=>Ou,getSchemaByResolvedExtensions:()=>im,getSchemaTypeByName:()=>vu,getSchemaTypeNameByName:()=>Zo,getSplittedAttributes:()=>Go,getText:()=>om,getTextBetween:()=>sm,getTextContentFromNodes:()=>yR,getTextSerializersFromSchema:()=>Nu,h:()=>eR,injectExtensionAttributesToParseRule:()=>Gp,inputRulesPlugin:()=>xR,isActive:()=>wR,isAndroid:()=>Eu,isAtEndOfNode:()=>p9,isAtStartOfNode:()=>m9,isEmptyObject:()=>uR,isExtensionRulesEnabled:()=>$p,isFunction:()=>rm,isList:()=>Jp,isMacOS:()=>em,isMarkActive:()=>wu,isNodeActive:()=>Ss,isNodeEmpty:()=>Ru,isNodeSelection:()=>v9,isNumber:()=>kR,isPlainObject:()=>Ko,isRegExp:()=>_u,isString:()=>bz,isTextSelection:()=>Zp,isiOS:()=>ks,markInputRule:()=>uz,markPasteRule:()=>Tz,markdown:()=>qR,mergeAttributes:()=>cR,mergeDeep:()=>lm,minMax:()=>Pr,nodeInputRule:()=>cz,nodePasteRule:()=>Az,objectIncludes:()=>$o,parseAttributes:()=>Du,parseIndentedBlocks:()=>$R,pasteRulesPlugin:()=>TR,posToDOMRect:()=>y9,removeDuplicates:()=>mR,renderNestedMarkdownContent:()=>JR,resolveExtensions:()=>Au,resolveFocusPosition:()=>Qp,rewriteUnknownContent:()=>w9,selectionToInsertionEnd:()=>sR,serializeAttributes:()=>Mu,sortExtensions:()=>Tu,splitExtensions:()=>Ti,textInputRule:()=>hz,textPasteRule:()=>Oz,textblockTypeInputRule:()=>fz,updateMarkViewAttributes:()=>um,wrappingInputRule:()=>dz});YR.exports=WU(rR);function Xo(r){let{state:e,transaction:t}=r,{selection:n}=t,{doc:i}=t,{storedMarks:s}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return n},get doc(){return i},get tr(){return n=t.selection,i=t.doc,s=t.storedMarks,t}}}var Yo=class{constructor(r){this.editor=r.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=r.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){let{rawCommands:r,editor:e,state:t}=this,{view:n}=e,{tr:i}=t,s=this.buildProps(i);return Object.fromEntries(Object.entries(r).map(([a,o])=>[a,(...u)=>{let c=o(...u)(s);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(i),c}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(r,e=!0){let{rawCommands:t,editor:n,state:i}=this,{view:s}=n,a=[],o=!!r,l=r||i.tr,u=()=>(!o&&e&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(l),a.every(f=>f===!0)),c={...Object.fromEntries(Object.entries(t).map(([f,d])=>[f,(...y)=>{let v=this.buildProps(l,e),x=d(...y)(v);return a.push(x),c}])),run:u};return c}createCan(r){let{rawCommands:e,state:t}=this,n=!1,i=r||t.tr,s=this.buildProps(i,n);return{...Object.fromEntries(Object.entries(e).map(([o,l])=>[o,(...u)=>l(...u)({...s,dispatch:void 0})])),chain:()=>this.createChain(i,n)}}buildProps(r,e=!0){let{rawCommands:t,editor:n,state:i}=this,{view:s}=n,a={tr:r,editor:n,view:s,state:Xo({state:i,transaction:r}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(r,e),can:()=>this.createCan(r),get commands(){return Object.fromEntries(Object.entries(t).map(([o,l])=>[o,(...u)=>l(...u)(a)]))}};return a}},Yp={};bu(Yp,{blur:()=>qU,clearContent:()=>VU,clearNodes:()=>GU,command:()=>$U,createParagraphNear:()=>XU,cut:()=>ZU,deleteCurrentNode:()=>QU,deleteNode:()=>eH,deleteRange:()=>tH,deleteSelection:()=>nH,enter:()=>iH,exitCode:()=>oH,extendMarkRange:()=>lH,first:()=>uH,focus:()=>fH,forEach:()=>hH,insertContent:()=>dH,insertContentAt:()=>vH,joinBackward:()=>bH,joinDown:()=>wH,joinForward:()=>_H,joinItemBackward:()=>EH,joinItemForward:()=>kH,joinTextblockBackward:()=>AH,joinTextblockForward:()=>NH,joinUp:()=>yH,keyboardShortcut:()=>CH,lift:()=>PH,liftEmptyBlock:()=>MH,liftListItem:()=>FH,newlineInCode:()=>UH,resetAttributes:()=>HH,scrollIntoView:()=>zH,selectAll:()=>WH,selectNodeBackward:()=>VH,selectNodeForward:()=>GH,selectParentNode:()=>JH,selectTextblockEnd:()=>YH,selectTextblockStart:()=>QH,setContent:()=>e9,setMark:()=>_9,setMeta:()=>x9,setNode:()=>E9,setNodeSelection:()=>k9,setTextDirection:()=>T9,setTextSelection:()=>A9,sinkListItem:()=>N9,splitBlock:()=>R9,splitListItem:()=>P9,toggleList:()=>D9,toggleMark:()=>M9,toggleNode:()=>L9,toggleWrap:()=>F9,undoInputRule:()=>B9,unsetAllMarks:()=>U9,unsetMark:()=>H9,unsetTextDirection:()=>z9,updateAttributes:()=>j9,wrapIn:()=>q9,wrapInList:()=>K9});var qU=()=>({editor:r,view:e})=>(requestAnimationFrame(()=>{var t;r.isDestroyed||(e.dom.blur(),(t=window?.getSelection())==null||t.removeAllRanges())}),!0),VU=(r=!0)=>({commands:e})=>e.setContent("",{emitUpdate:r}),KU=pr(),GU=()=>({state:r,tr:e,dispatch:t})=>{let{selection:n}=e,{ranges:i}=n;return t&&i.forEach(({$from:s,$to:a})=>{r.doc.nodesBetween(s.pos,a.pos,(o,l)=>{if(o.type.isText)return;let{doc:u,mapping:c}=e,f=u.resolve(c.map(l)),d=u.resolve(c.map(l+o.nodeSize)),h=f.blockRange(d);if(!h)return;let y=(0,KU.liftTarget)(h);if(o.type.isTextblock){let{defaultType:v}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(h.start,v)}(y||y===0)&&e.lift(h,y)})}),!0},$U=r=>e=>r(e),JU=bt(),XU=()=>({state:r,dispatch:e})=>(0,JU.createParagraphNear)(r,e),YU=Pe(),ZU=(r,e)=>({editor:t,tr:n})=>{let{state:i}=t,s=i.doc.slice(r.from,r.to);n.deleteRange(r.from,r.to);let a=n.mapping.map(e);return n.insert(a,s.content),n.setSelection(new YU.TextSelection(n.doc.resolve(Math.max(a-1,0)))),!0},QU=()=>({tr:r,dispatch:e})=>{let{selection:t}=r,n=t.$anchor.node();if(n.content.size>0)return!1;let i=r.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===n.type){if(e){let o=i.before(s),l=i.after(s);r.delete(o,l).scrollIntoView()}return!0}return!1};function pt(r,e){if(typeof r=="string"){if(!e.nodes[r])throw Error(`There is no node type named '${r}'. Maybe you forgot to add the extension?`);return e.nodes[r]}return r}var eH=r=>({tr:e,state:t,dispatch:n})=>{let i=pt(r,t.schema),s=e.selection.$anchor;for(let a=s.depth;a>0;a-=1)if(s.node(a).type===i){if(n){let l=s.before(a),u=s.after(a);e.delete(l,u).scrollIntoView()}return!0}return!1},tH=r=>({tr:e,dispatch:t})=>{let{from:n,to:i}=r;return t&&e.delete(n,i),!0},rH=bt(),nH=()=>({state:r,dispatch:e})=>(0,rH.deleteSelection)(r,e),iH=()=>({commands:r})=>r.keyboardShortcut("Enter"),sH=bt(),oH=()=>({state:r,dispatch:e})=>(0,sH.exitCode)(r,e),aH=Pe();function _u(r){return Object.prototype.toString.call(r)==="[object RegExp]"}function $o(r,e,t={strict:!0}){let n=Object.keys(e);return n.length?n.every(i=>t.strict?e[i]===r[i]:_u(e[i])?e[i].test(r[i]):e[i]===r[i]):!0}function nR(r,e,t={}){return r.find(n=>n.type===e&&$o(Object.fromEntries(Object.keys(t).map(i=>[i,n.attrs[i]])),t))}function HN(r,e,t={}){return!!nR(r,e,t)}function xu(r,e,t){var n;if(!r||!e)return;let i=r.parent.childAfter(r.parentOffset);if((!i.node||!i.node.marks.some(c=>c.type===e))&&(i=r.parent.childBefore(r.parentOffset)),!i.node||!i.node.marks.some(c=>c.type===e)||(t=t||((n=i.node.marks[0])==null?void 0:n.attrs),!nR([...i.node.marks],e,t)))return;let a=i.index,o=r.start()+i.offset,l=a+1,u=o+i.node.nodeSize;for(;a>0&&HN([...r.parent.child(a-1).marks],e,t);)a-=1,o-=r.parent.child(a).nodeSize;for(;l<r.parent.childCount&&HN([...r.parent.child(l).marks],e,t);)u+=r.parent.child(l).nodeSize,l+=1;return{from:o,to:u}}function Dr(r,e){if(typeof r=="string"){if(!e.marks[r])throw Error(`There is no mark type named '${r}'. Maybe you forgot to add the extension?`);return e.marks[r]}return r}var lH=(r,e={})=>({tr:t,state:n,dispatch:i})=>{let s=Dr(r,n.schema),{doc:a,selection:o}=t,{$from:l,from:u,to:c}=o;if(i){let f=xu(l,s,e);if(f&&f.from<=u&&f.to>=c){let d=aH.TextSelection.create(a,f.from,f.to);t.setSelection(d)}}return!0},uH=r=>e=>{let t=typeof r=="function"?r(e):r;for(let n=0;n<t.length;n+=1)if(t[n](e))return!0;return!1},cH=Pe();function Zp(r){return r instanceof cH.TextSelection}var du=Pe();function Pr(r=0,e=0,t=0){return Math.min(Math.max(r,e),t)}function Qp(r,e=null){if(!e)return null;let t=du.Selection.atStart(r),n=du.Selection.atEnd(r);if(e==="start"||e===!0)return t;if(e==="end")return n;let i=t.from,s=n.to;return e==="all"?du.TextSelection.create(r,Pr(0,i,s),Pr(r.content.size,i,s)):du.TextSelection.create(r,Pr(e,i,s),Pr(e,i,s))}function Eu(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function ks(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var fH=(r=null,e={})=>({editor:t,view:n,tr:i,dispatch:s})=>{e={scrollIntoView:!0,...e};let a=()=>{(ks()||Eu())&&n.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(n.focus(),e?.scrollIntoView&&t.commands.scrollIntoView())})};if(n.hasFocus()&&r===null||r===!1)return!0;if(s&&r===null&&!Zp(t.state.selection))return a(),!0;let o=Qp(i.doc,r)||t.state.selection,l=t.state.selection.eq(o);return s&&(l||i.setSelection(o),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),a()),!0},hH=(r,e)=>t=>r.every((n,i)=>e(n,{...t,index:i})),dH=(r,e)=>({tr:t,commands:n})=>n.insertContentAt({from:t.selection.from,to:t.selection.to},r,e),pH=gr(),ki=gr(),iR=r=>{let e=r.childNodes;for(let t=e.length-1;t>=0;t-=1){let n=e[t];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?r.removeChild(n):n.nodeType===1&&iR(n)}return r};function xs(r){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");let e=`<body>${r}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return iR(t)}function Es(r,e,t){if(r instanceof ki.Node||r instanceof ki.Fragment)return r;t={slice:!0,parseOptions:{},...t};let n=typeof r=="object"&&r!==null,i=typeof r=="string";if(n)try{if(Array.isArray(r)&&r.length>0)return ki.Fragment.fromArray(r.map(o=>e.nodeFromJSON(o)));let a=e.nodeFromJSON(r);return t.errorOnInvalidContent&&a.check(),a}catch(s){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",r,"Error:",s),Es("",e,t)}if(i){if(t.errorOnInvalidContent){let a=!1,o="",l=new ki.Schema({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(a=!0,o=typeof u=="string"?u:u.outerHTML,null)}]}})});if(t.slice?ki.DOMParser.fromSchema(l).parseSlice(xs(r),t.parseOptions):ki.DOMParser.fromSchema(l).parse(xs(r),t.parseOptions),t.errorOnInvalidContent&&a)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${o}`)})}let s=ki.DOMParser.fromSchema(e);return t.slice?s.parseSlice(xs(r),t.parseOptions).content:s.parse(xs(r),t.parseOptions)}return Es("",e,t)}var mH=Pe(),zN=pr();function sR(r,e,t){let n=r.steps.length-1;if(n<e)return;let i=r.steps[n];if(!(i instanceof zN.ReplaceStep||i instanceof zN.ReplaceAroundStep))return;let s=r.mapping.maps[n],a=0;s.forEach((o,l,u,c)=>{a===0&&(a=c)}),r.setSelection(mH.Selection.near(r.doc.resolve(a),t))}var gH=r=>!("type"in r),vH=(r,e,t)=>({tr:n,dispatch:i,editor:s})=>{var a;if(i){t={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let o,l=x=>{s.emit("contentError",{editor:s,error:x,disableCollaboration:()=>{"collaboration"in s.storage&&typeof s.storage.collaboration=="object"&&s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...t.parseOptions};if(!t.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{Es(e,s.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(x){l(x)}try{o=Es(e,s.schema,{parseOptions:u,errorOnInvalidContent:(a=t.errorOnInvalidContent)!=null?a:s.options.enableContentCheck})}catch(x){return l(x),!1}let{from:c,to:f}=typeof r=="number"?{from:r,to:r}:{from:r.from,to:r.to},d=!0,h=!0;if((gH(o)?o:[o]).forEach(x=>{x.check(),d=d?x.isText&&x.marks.length===0:!1,h=h?x.isBlock:!1}),c===f&&h){let{parent:x}=n.doc.resolve(c);x.isTextblock&&!x.type.spec.code&&!x.childCount&&(c-=1,f+=1)}let v;if(d){if(Array.isArray(e))v=e.map(x=>x.text||"").join("");else if(e instanceof pH.Fragment){let x="";e.forEach(m=>{m.text&&(x+=m.text)}),v=x}else typeof e=="object"&&e&&e.text?v=e.text:v=e;n.insertText(v,c,f)}else{v=o;let x=n.doc.resolve(c),m=x.node(),_=x.parentOffset===0,b=m.isText||m.isTextblock,w=m.content.size>0;_&&b&&w&&(c=Math.max(0,c-1)),n.replaceWith(c,f,v)}t.updateSelection&&sR(n,n.steps.length-1,-1),t.applyInputRules&&n.setMeta("applyInputRules",{from:c,text:v}),t.applyPasteRules&&n.setMeta("applyPasteRules",{from:c,text:v})}return!0},Su=bt(),yH=()=>({state:r,dispatch:e})=>(0,Su.joinUp)(r,e),wH=()=>({state:r,dispatch:e})=>(0,Su.joinDown)(r,e),bH=()=>({state:r,dispatch:e})=>(0,Su.joinBackward)(r,e),_H=()=>({state:r,dispatch:e})=>(0,Su.joinForward)(r,e),xH=pr(),EH=()=>({state:r,dispatch:e,tr:t})=>{try{let n=(0,xH.joinPoint)(r.doc,r.selection.$from.pos,-1);return n==null?!1:(t.join(n,2),e&&e(t),!0)}catch{return!1}},SH=pr(),kH=()=>({state:r,dispatch:e,tr:t})=>{try{let n=(0,SH.joinPoint)(r.doc,r.selection.$from.pos,1);return n==null?!1:(t.join(n,2),e&&e(t),!0)}catch{return!1}},TH=bt(),AH=()=>({state:r,dispatch:e})=>(0,TH.joinTextblockBackward)(r,e),OH=bt(),NH=()=>({state:r,dispatch:e})=>(0,OH.joinTextblockForward)(r,e);function em(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function RH(r){let e=r.split(/-(?!$)/),t=e[e.length-1];t==="Space"&&(t=" ");let n,i,s,a;for(let o=0;o<e.length-1;o+=1){let l=e[o];if(/^(cmd|meta|m)$/i.test(l))a=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))ks()||em()?a=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return n&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),a&&(t=`Meta-${t}`),s&&(t=`Shift-${t}`),t}var CH=r=>({editor:e,view:t,tr:n,dispatch:i})=>{let s=RH(r).split(/-(?!$)/),a=s.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),o=new KeyboardEvent("keydown",{key:a==="Space"?" ":a,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",u=>u(t,o))});return l?.steps.forEach(u=>{let c=u.map(n.mapping);c&&i&&n.maybeStep(c)}),!0},IH=bt();function Ss(r,e,t={}){let{from:n,to:i,empty:s}=r.selection,a=e?pt(e,r.schema):null,o=[];r.doc.nodesBetween(n,i,(f,d)=>{if(f.isText)return;let h=Math.max(n,d),y=Math.min(i,d+f.nodeSize);o.push({node:f,from:h,to:y})});let l=i-n,u=o.filter(f=>a?a.name===f.node.type.name:!0).filter(f=>$o(f.node.attrs,t,{strict:!1}));return s?!!u.length:u.reduce((f,d)=>f+d.to-d.from,0)>=l}var PH=(r,e={})=>({state:t,dispatch:n})=>{let i=pt(r,t.schema);return Ss(t,i,e)?(0,IH.lift)(t,n):!1},DH=bt(),MH=()=>({state:r,dispatch:e})=>(0,DH.liftEmptyBlock)(r,e),LH=nu(),FH=r=>({state:e,dispatch:t})=>{let n=pt(r,e.schema);return(0,LH.liftListItem)(n)(e,t)},BH=bt(),UH=()=>({state:r,dispatch:e})=>(0,BH.newlineInCode)(r,e);function Zo(r,e){return e.nodes[r]?"node":e.marks[r]?"mark":null}function Kp(r,e){let t=typeof e=="string"?[e]:e;return Object.keys(r).reduce((n,i)=>(t.includes(i)||(n[i]=r[i]),n),{})}var HH=(r,e)=>({tr:t,state:n,dispatch:i})=>{let s=null,a=null,o=Zo(typeof r=="string"?r:r.name,n.schema);if(!o)return!1;o==="node"&&(s=pt(r,n.schema)),o==="mark"&&(a=Dr(r,n.schema));let l=!1;return t.selection.ranges.forEach(u=>{n.doc.nodesBetween(u.$from.pos,u.$to.pos,(c,f)=>{s&&s===c.type&&(l=!0,i&&t.setNodeMarkup(f,void 0,Kp(c.attrs,e))),a&&c.marks.length&&c.marks.forEach(d=>{a===d.type&&(l=!0,i&&t.addMark(f,f+c.nodeSize,a.create(Kp(d.attrs,e))))})})}),l},zH=()=>({tr:r,dispatch:e})=>(e&&r.scrollIntoView(),!0),jH=Pe(),WH=()=>({tr:r,dispatch:e})=>{if(e){let t=new jH.AllSelection(r.doc);r.setSelection(t)}return!0},qH=bt(),VH=()=>({state:r,dispatch:e})=>(0,qH.selectNodeBackward)(r,e),KH=bt(),GH=()=>({state:r,dispatch:e})=>(0,KH.selectNodeForward)(r,e),$H=bt(),JH=()=>({state:r,dispatch:e})=>(0,$H.selectParentNode)(r,e),XH=bt(),YH=()=>({state:r,dispatch:e})=>(0,XH.selectTextblockEnd)(r,e),ZH=bt(),QH=()=>({state:r,dispatch:e})=>(0,ZH.selectTextblockStart)(r,e);function yu(r,e,t={},n={}){return Es(r,e,{slice:!1,parseOptions:t,errorOnInvalidContent:n.errorOnInvalidContent})}var e9=(r,{errorOnInvalidContent:e,emitUpdate:t=!0,parseOptions:n={}}={})=>({editor:i,tr:s,dispatch:a,commands:o})=>{let{doc:l}=s;if(n.preserveWhitespace!=="full"){let u=yu(r,i.schema,n,{errorOnInvalidContent:e??i.options.enableContentCheck});return a&&s.replaceWith(0,l.content.size,u).setMeta("preventUpdate",!t),!0}return a&&s.setMeta("preventUpdate",!t),o.insertContentAt({from:0,to:l.content.size},r,{parseOptions:n,errorOnInvalidContent:e??i.options.enableContentCheck})};function tm(r,e){let t=Dr(e,r.schema),{from:n,to:i,empty:s}=r.selection,a=[];s?(r.storedMarks&&a.push(...r.storedMarks),a.push(...r.selection.$head.marks())):r.doc.nodesBetween(n,i,l=>{a.push(...l.marks)});let o=a.find(l=>l.type.name===t.name);return o?{...o.attrs}:{}}var t9=pr();function oR(r,e){let t=new t9.Transform(r);return e.forEach(n=>{n.steps.forEach(i=>{t.step(i)})}),t}function aR(r){for(let e=0;e<r.edgeCount;e+=1){let{type:t}=r.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function r9(r,e){let t=[];return r.descendants((n,i)=>{e(n)&&t.push({node:n,pos:i})}),t}function n9(r,e,t){let n=[];return r.nodesBetween(e.from,e.to,(i,s)=>{t(i)&&n.push({node:i,pos:s})}),n}function lR(r,e){for(let t=r.depth;t>0;t-=1){let n=r.node(t);if(e(n))return{pos:t>0?r.before(t):0,start:r.start(t),depth:t,node:n}}}function Qo(r){return e=>lR(e.$from,r)}function Ee(r,e,t){return r.config[e]===void 0&&r.parent?Ee(r.parent,e,t):typeof r.config[e]=="function"?r.config[e].bind({...t,parent:r.parent?Ee(r.parent,e,t):null}):r.config[e]}function ku(r){return r.map(e=>{let t={name:e.name,options:e.options,storage:e.storage},n=Ee(e,"addExtensions",t);return n?[e,...ku(n())]:e}).flat(10)}var i9=gr(),s9=gr();function ea(r,e){let t=s9.DOMSerializer.fromSchema(e).serializeFragment(r),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(t),i.innerHTML}var o9=gr();function rm(r){return typeof r=="function"}function Le(r,e=void 0,...t){return rm(r)?e?r.bind(e)(...t):r(...t):r}function uR(r={}){return Object.keys(r).length===0&&r.constructor===Object}function Ti(r){let e=r.filter(i=>i.type==="extension"),t=r.filter(i=>i.type==="node"),n=r.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:n}}function nm(r){let e=[],{nodeExtensions:t,markExtensions:n}=Ti(r),i=[...t,...n],s={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return r.forEach(a=>{let o={name:a.name,options:a.options,storage:a.storage,extensions:i},l=Ee(a,"addGlobalAttributes",o);if(!l)return;l().forEach(c=>{c.types.forEach(f=>{Object.entries(c.attributes).forEach(([d,h])=>{e.push({type:f,name:d,attribute:{...s,...h}})})})})}),i.forEach(a=>{let o={name:a.name,options:a.options,storage:a.storage},l=Ee(a,"addAttributes",o);if(!l)return;let u=l();Object.entries(u).forEach(([c,f])=>{let d={...s,...f};typeof d?.default=="function"&&(d.default=d.default()),d?.isRequired&&d?.default===void 0&&delete d.default,e.push({type:a.name,name:c,attribute:d})})}),e}function cR(...r){return r.filter(e=>!!e).reduce((e,t)=>{let n={...e};return Object.entries(t).forEach(([i,s])=>{if(!n[i]){n[i]=s;return}if(i==="class"){let o=s?String(s).split(" "):[],l=n[i]?n[i].split(" "):[],u=o.filter(c=>!l.includes(c));n[i]=[...l,...u].join(" ")}else if(i==="style"){let o=s?s.split(";").map(c=>c.trim()).filter(Boolean):[],l=n[i]?n[i].split(";").map(c=>c.trim()).filter(Boolean):[],u=new Map;l.forEach(c=>{let[f,d]=c.split(":").map(h=>h.trim());u.set(f,d)}),o.forEach(c=>{let[f,d]=c.split(":").map(h=>h.trim());u.set(f,d)}),n[i]=Array.from(u.entries()).map(([c,f])=>`${c}: ${f}`).join("; ")}else n[i]=s}),n},{})}function Jo(r,e){return e.filter(t=>t.type===r.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(r.attrs)||{}:{[t.name]:r.attrs[t.name]}).reduce((t,n)=>cR(t,n),{})}function fR(r){return typeof r!="string"?r:r.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(r):r==="true"?!0:r==="false"?!1:r}function Gp(r,e){return"style"in r?r:{...r,getAttrs:t=>{let n=r.getAttrs?r.getAttrs(t):r.attrs;if(n===!1)return!1;let i=e.reduce((s,a)=>{let o=a.attribute.parseHTML?a.attribute.parseHTML(t):fR(t.getAttribute(a.name));return o==null?s:{...s,[a.name]:o}},{});return{...n,...i}}}}function jN(r){return Object.fromEntries(Object.entries(r).filter(([e,t])=>e==="attrs"&&uR(t)?!1:t!=null))}function WN(r){var e,t;let n={};return!((e=r?.attribute)!=null&&e.isRequired)&&"default"in(r?.attribute||{})&&(n.default=r.attribute.default),((t=r?.attribute)==null?void 0:t.validate)!==void 0&&(n.validate=r.attribute.validate),[r.name,n]}function im(r,e){var t;let n=nm(r),{nodeExtensions:i,markExtensions:s}=Ti(r),a=(t=i.find(u=>Ee(u,"topNode")))==null?void 0:t.name,o=Object.fromEntries(i.map(u=>{let c=n.filter(m=>m.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:e},d=r.reduce((m,_)=>{let b=Ee(_,"extendNodeSchema",f);return{...m,...b?b(u):{}}},{}),h=jN({...d,content:Le(Ee(u,"content",f)),marks:Le(Ee(u,"marks",f)),group:Le(Ee(u,"group",f)),inline:Le(Ee(u,"inline",f)),atom:Le(Ee(u,"atom",f)),selectable:Le(Ee(u,"selectable",f)),draggable:Le(Ee(u,"draggable",f)),code:Le(Ee(u,"code",f)),whitespace:Le(Ee(u,"whitespace",f)),linebreakReplacement:Le(Ee(u,"linebreakReplacement",f)),defining:Le(Ee(u,"defining",f)),isolating:Le(Ee(u,"isolating",f)),attrs:Object.fromEntries(c.map(WN))}),y=Le(Ee(u,"parseHTML",f));y&&(h.parseDOM=y.map(m=>Gp(m,c)));let v=Ee(u,"renderHTML",f);v&&(h.toDOM=m=>v({node:m,HTMLAttributes:Jo(m,c)}));let x=Ee(u,"renderText",f);return x&&(h.toText=x),[u.name,h]})),l=Object.fromEntries(s.map(u=>{let c=n.filter(x=>x.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:e},d=r.reduce((x,m)=>{let _=Ee(m,"extendMarkSchema",f);return{...x,..._?_(u):{}}},{}),h=jN({...d,inclusive:Le(Ee(u,"inclusive",f)),excludes:Le(Ee(u,"excludes",f)),group:Le(Ee(u,"group",f)),spanning:Le(Ee(u,"spanning",f)),code:Le(Ee(u,"code",f)),attrs:Object.fromEntries(c.map(WN))}),y=Le(Ee(u,"parseHTML",f));y&&(h.parseDOM=y.map(x=>Gp(x,c)));let v=Ee(u,"renderHTML",f);return v&&(h.toDOM=x=>v({mark:x,HTMLAttributes:Jo(x,c)})),[u.name,h]}));return new o9.Schema({topNode:a,nodes:o,marks:l})}function hR(r){let e=r.filter((t,n)=>r.indexOf(t)!==n);return Array.from(new Set(e))}function Tu(r){return r.sort((t,n)=>{let i=Ee(t,"priority")||100,s=Ee(n,"priority")||100;return i>s?-1:i<s?1:0})}function Au(r){let e=Tu(ku(r)),t=hR(e.map(n=>n.name));return t.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${t.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),e}function Ou(r,e){let t=Au(r);return im(t,e)}function a9(r,e){let t=Ou(e),n=i9.Node.fromJSON(t,r);return ea(n.content,t)}var l9=gr();function u9(r,e){let t=Ou(e),n=xs(r);return l9.DOMParser.fromSchema(t).parse(n).toJSON()}var c9=gr();function sm(r,e,t){let{from:n,to:i}=e,{blockSeparator:s=`

`,textSerializers:a={}}=t||{},o="";return r.nodesBetween(n,i,(l,u,c,f)=>{var d;l.isBlock&&u>n&&(o+=s);let h=a?.[l.type.name];if(h)return c&&(o+=h({node:l,pos:u,parent:c,index:f,range:e})),!1;l.isText&&(o+=(d=l?.text)==null?void 0:d.slice(Math.max(n,u)-u,i-u))}),o}function om(r,e){let t={from:0,to:r.content.size};return sm(r,t,e)}function Nu(r){return Object.fromEntries(Object.entries(r.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}function f9(r,e,t){let{blockSeparator:n=`

`,textSerializers:i={}}=t||{},s=Ou(e),a=c9.Node.fromJSON(s,r);return om(a,{blockSeparator:n,textSerializers:{...Nu(s),...i}})}function dR(r,e){let t=pt(e,r.schema),{from:n,to:i}=r.selection,s=[];r.doc.nodesBetween(n,i,o=>{s.push(o)});let a=s.reverse().find(o=>o.type.name===t.name);return a?{...a.attrs}:{}}function pR(r,e){let t=Zo(typeof e=="string"?e:e.name,r.schema);return t==="node"?dR(r,e):t==="mark"?tm(r,e):{}}function mR(r,e=JSON.stringify){let t={};return r.filter(n=>{let i=e(n);return Object.prototype.hasOwnProperty.call(t,i)?!1:t[i]=!0})}function h9(r){let e=mR(r);return e.length===1?e:e.filter((t,n)=>!e.filter((s,a)=>a!==n).some(s=>t.oldRange.from>=s.oldRange.from&&t.oldRange.to<=s.oldRange.to&&t.newRange.from>=s.newRange.from&&t.newRange.to<=s.newRange.to))}function gR(r){let{mapping:e,steps:t}=r,n=[];return e.maps.forEach((i,s)=>{let a=[];if(i.ranges.length)i.forEach((o,l)=>{a.push({from:o,to:l})});else{let{from:o,to:l}=t[s];if(o===void 0||l===void 0)return;a.push({from:o,to:l})}a.forEach(({from:o,to:l})=>{let u=e.slice(s).map(o,-1),c=e.slice(s).map(l),f=e.invert().map(u,-1),d=e.invert().map(c);n.push({oldRange:{from:f,to:d},newRange:{from:u,to:c}})})}),h9(n)}function vR(r,e=0){let n=r.type===r.type.schema.topNodeType?0:1,i=e,s=i+r.nodeSize,a=r.marks.map(u=>{let c={type:u.type.name};return Object.keys(u.attrs).length&&(c.attrs={...u.attrs}),c}),o={...r.attrs},l={type:r.type.name,from:i,to:s};return Object.keys(o).length&&(l.attrs=o),a.length&&(l.marks=a),r.content.childCount&&(l.content=[],r.forEach((u,c)=>{var f;(f=l.content)==null||f.push(vR(u,e+c+n))})),r.text&&(l.text=r.text),l}function am(r,e,t){let n=[];return r===e?t.resolve(r).marks().forEach(i=>{let s=t.resolve(r),a=xu(s,i.type);a&&n.push({mark:i,...a})}):t.nodesBetween(r,e,(i,s)=>{!i||i?.nodeSize===void 0||n.push(...i.marks.map(a=>({from:s,to:s+i.nodeSize,mark:a})))}),n}var d9=(r,e,t,n=20)=>{let i=r.doc.resolve(t),s=n,a=null;for(;s>0&&a===null;){let o=i.node(s);o?.type.name===e?a=o:s-=1}return[a,s]};function vu(r,e){return e.nodes[r]||e.marks[r]||null}function Go(r,e,t){return Object.fromEntries(Object.entries(t).filter(([n])=>{let i=r.find(s=>s.type===e&&s.name===n);return i?i.attribute.keepOnSplit:!1}))}var yR=(r,e=500)=>{let t="",n=r.parentOffset;return r.parent.nodesBetween(Math.max(0,n-e),n,(i,s,a,o)=>{var l,u;let c=((u=(l=i.type.spec).toText)==null?void 0:u.call(l,{node:i,pos:s,parent:a,index:o}))||i.textContent||"%leaf%";t+=i.isAtom&&!i.isText?c:c.slice(0,Math.max(0,n-s))}),t};function wu(r,e,t={}){let{empty:n,ranges:i}=r.selection,s=e?Dr(e,r.schema):null;if(n)return!!(r.storedMarks||r.selection.$from.marks()).filter(f=>s?s.name===f.type.name:!0).find(f=>$o(f.attrs,t,{strict:!1}));let a=0,o=[];if(i.forEach(({$from:f,$to:d})=>{let h=f.pos,y=d.pos;r.doc.nodesBetween(h,y,(v,x)=>{if(!v.isText&&!v.marks.length)return;let m=Math.max(h,x),_=Math.min(y,x+v.nodeSize),b=_-m;a+=b,o.push(...v.marks.map(w=>({mark:w,from:m,to:_})))})}),a===0)return!1;let l=o.filter(f=>s?s.name===f.mark.type.name:!0).filter(f=>$o(f.mark.attrs,t,{strict:!1})).reduce((f,d)=>f+d.to-d.from,0),u=o.filter(f=>s?f.mark.type!==s&&f.mark.type.excludes(s):!0).reduce((f,d)=>f+d.to-d.from,0);return(l>0?l+u:l)>=a}function wR(r,e,t={}){if(!e)return Ss(r,null,t)||wu(r,null,t);let n=Zo(e,r.schema);return n==="node"?Ss(r,e,t):n==="mark"?wu(r,e,t):!1}var p9=(r,e)=>{let{$from:t,$to:n,$anchor:i}=r.selection;if(e){let s=Qo(o=>o.type.name===e)(r.selection);if(!s)return!1;let a=r.doc.resolve(s.pos+1);return i.pos+1===a.end()}return!(n.parentOffset<n.parent.nodeSize-2||t.pos!==n.pos)},m9=r=>{let{$from:e,$to:t}=r.selection;return!(e.parentOffset>0||e.pos!==t.pos)};function $p(r,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===r.name):e}function Jp(r,e){let{nodeExtensions:t}=Ti(e),n=t.find(a=>a.name===r);if(!n)return!1;let i={name:n.name,options:n.options,storage:n.storage},s=Le(Ee(n,"group",i));return typeof s!="string"?!1:s.split(" ").includes("list")}function Ru(r,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var n;if(t){if(r.type.name==="hardBreak")return!0;if(r.isText)return/^\s*$/m.test((n=r.text)!=null?n:"")}if(r.isText)return!r.text;if(r.isAtom||r.isLeaf)return!1;if(r.content.childCount===0)return!0;if(e){let i=!0;return r.content.forEach(s=>{i!==!1&&(Ru(s,{ignoreWhitespace:t,checkChildren:e})||(i=!1))}),i}return!1}var g9=Pe();function v9(r){return r instanceof g9.NodeSelection}function y9(r,e,t){let i=r.state.doc.content.size,s=Pr(e,0,i),a=Pr(t,0,i),o=r.coordsAtPos(s),l=r.coordsAtPos(a,-1),u=Math.min(o.top,l.top),c=Math.max(o.bottom,l.bottom),f=Math.min(o.left,l.left),d=Math.max(o.right,l.right),h=d-f,y=c-u,m={top:u,bottom:c,left:f,right:d,width:h,height:y,x:f,y:u};return{...m,toJSON:()=>m}}function bR({json:r,validMarks:e,validNodes:t,options:n,rewrittenContent:i=[]}){return r.marks&&Array.isArray(r.marks)&&(r.marks=r.marks.filter(s=>{let a=typeof s=="string"?s:s.type;return e.has(a)?!0:(i.push({original:JSON.parse(JSON.stringify(s)),unsupported:a}),!1)})),r.content&&Array.isArray(r.content)&&(r.content=r.content.map(s=>bR({json:s,validMarks:e,validNodes:t,options:n,rewrittenContent:i}).json).filter(s=>s!=null)),r.type&&!t.has(r.type)?(i.push({original:JSON.parse(JSON.stringify(r)),unsupported:r.type}),r.content&&Array.isArray(r.content)&&n?.fallbackToParagraph!==!1?(r.type="paragraph",{json:r,rewrittenContent:i}):{json:null,rewrittenContent:i}):{json:r,rewrittenContent:i}}function w9(r,e,t){return bR({json:r,validNodes:new Set(Object.keys(e.nodes)),validMarks:new Set(Object.keys(e.marks)),options:t})}function b9(r,e,t){var n;let{selection:i}=e,s=null;if(Zp(i)&&(s=i.$cursor),s){let o=(n=r.storedMarks)!=null?n:s.marks();return s.parent.type.allowsMarkType(t)&&(!!t.isInSet(o)||!o.some(u=>u.type.excludes(t)))}let{ranges:a}=i;return a.some(({$from:o,$to:l})=>{let u=o.depth===0?r.doc.inlineContent&&r.doc.type.allowsMarkType(t):!1;return r.doc.nodesBetween(o.pos,l.pos,(c,f,d)=>{if(u)return!1;if(c.isInline){let h=!d||d.type.allowsMarkType(t),y=!!t.isInSet(c.marks)||!c.marks.some(v=>v.type.excludes(t));u=h&&y}return!u}),u})}var _9=(r,e={})=>({tr:t,state:n,dispatch:i})=>{let{selection:s}=t,{empty:a,ranges:o}=s,l=Dr(r,n.schema);if(i)if(a){let u=tm(n,l);t.addStoredMark(l.create({...u,...e}))}else o.forEach(u=>{let c=u.$from.pos,f=u.$to.pos;n.doc.nodesBetween(c,f,(d,h)=>{let y=Math.max(h,c),v=Math.min(h+d.nodeSize,f);d.marks.find(m=>m.type===l)?d.marks.forEach(m=>{l===m.type&&t.addMark(y,v,l.create({...m.attrs,...e}))}):t.addMark(y,v,l.create(e))})});return b9(n,t,l)},x9=(r,e)=>({tr:t})=>(t.setMeta(r,e),!0),qN=bt(),E9=(r,e={})=>({state:t,dispatch:n,chain:i})=>{let s=pt(r,t.schema),a;return t.selection.$anchor.sameParent(t.selection.$head)&&(a=t.selection.$anchor.parent.attrs),s.isTextblock?i().command(({commands:o})=>(0,qN.setBlockType)(s,{...a,...e})(t)?!0:o.clearNodes()).command(({state:o})=>(0,qN.setBlockType)(s,{...a,...e})(o,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},S9=Pe(),k9=r=>({tr:e,dispatch:t})=>{if(t){let{doc:n}=e,i=Pr(r,0,n.content.size),s=S9.NodeSelection.create(n,i);e.setSelection(s)}return!0},T9=(r,e)=>({tr:t,state:n,dispatch:i})=>{let{selection:s}=n,a,o;return typeof e=="number"?(a=e,o=e):e&&"from"in e&&"to"in e?(a=e.from,o=e.to):(a=s.from,o=s.to),i&&t.doc.nodesBetween(a,o,(l,u)=>{l.isText||t.setNodeMarkup(u,void 0,{...l.attrs,dir:r})}),!0},jp=Pe(),A9=r=>({tr:e,dispatch:t})=>{if(t){let{doc:n}=e,{from:i,to:s}=typeof r=="number"?{from:r,to:r}:r,a=jp.TextSelection.atStart(n).from,o=jp.TextSelection.atEnd(n).to,l=Pr(i,a,o),u=Pr(s,a,o),c=jp.TextSelection.create(n,l,u);e.setSelection(c)}return!0},O9=nu(),N9=r=>({state:e,dispatch:t})=>{let n=pt(r,e.schema);return(0,O9.sinkListItem)(n)(e,t)},VN=Pe(),Wp=pr();function KN(r,e){let t=r.storedMarks||r.selection.$to.parentOffset&&r.selection.$from.marks();if(t){let n=t.filter(i=>e?.includes(i.type.name));r.tr.ensureMarks(n)}}var R9=({keepMarks:r=!0}={})=>({tr:e,state:t,dispatch:n,editor:i})=>{let{selection:s,doc:a}=e,{$from:o,$to:l}=s,u=i.extensionManager.attributes,c=Go(u,o.node().type.name,o.node().attrs);if(s instanceof VN.NodeSelection&&s.node.isBlock)return!o.parentOffset||!(0,Wp.canSplit)(a,o.pos)?!1:(n&&(r&&KN(t,i.extensionManager.splittableMarks),e.split(o.pos).scrollIntoView()),!0);if(!o.parent.isBlock)return!1;let f=l.parentOffset===l.parent.content.size,d=o.depth===0?void 0:aR(o.node(-1).contentMatchAt(o.indexAfter(-1))),h=f&&d?[{type:d,attrs:c}]:void 0,y=(0,Wp.canSplit)(e.doc,e.mapping.map(o.pos),1,h);if(!h&&!y&&(0,Wp.canSplit)(e.doc,e.mapping.map(o.pos),1,d?[{type:d}]:void 0)&&(y=!0,h=d?[{type:d,attrs:c}]:void 0),n){if(y&&(s instanceof VN.TextSelection&&e.deleteSelection(),e.split(e.mapping.map(o.pos),1,h),d&&!f&&!o.parentOffset&&o.parent.type!==d)){let v=e.mapping.map(o.before()),x=e.doc.resolve(v);o.node(-1).canReplaceWith(x.index(),x.index()+1,d)&&e.setNodeMarkup(e.mapping.map(o.before()),d)}r&&KN(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return y},pu=gr(),C9=Pe(),I9=pr(),P9=(r,e={})=>({tr:t,state:n,dispatch:i,editor:s})=>{var a;let o=pt(r,n.schema),{$from:l,$to:u}=n.selection,c=n.selection.node;if(c&&c.isBlock||l.depth<2||!l.sameParent(u))return!1;let f=l.node(-1);if(f.type!==o)return!1;let d=s.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==o||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let m=pu.Fragment.empty,_=l.index(-1)?1:l.index(-2)?2:3;for(let U=l.depth-_;U>=l.depth-3;U-=1)m=pu.Fragment.from(l.node(U).copy(m));let b=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,w={...Go(d,l.node().type.name,l.node().attrs),...e},T=((a=o.contentMatch.defaultType)==null?void 0:a.createAndFill(w))||void 0;m=m.append(pu.Fragment.from(o.createAndFill(null,T)||void 0));let P=l.before(l.depth-(_-1));t.replace(P,l.after(-b),new pu.Slice(m,4-_,0));let M=-1;t.doc.nodesBetween(P,t.doc.content.size,(U,R)=>{if(M>-1)return!1;U.isTextblock&&U.content.size===0&&(M=R+1)}),M>-1&&t.setSelection(C9.TextSelection.near(t.doc.resolve(M))),t.scrollIntoView()}return!0}let h=u.pos===l.end()?f.contentMatchAt(0).defaultType:null,y={...Go(d,f.type.name,f.attrs),...e},v={...Go(d,l.node().type.name,l.node().attrs),...e};t.delete(l.pos,u.pos);let x=h?[{type:o,attrs:y},{type:h,attrs:v}]:[{type:o,attrs:y}];if(!(0,I9.canSplit)(t.doc,l.pos,2))return!1;if(i){let{selection:m,storedMarks:_}=n,{splittableMarks:b}=s.extensionManager,w=_||m.$to.parentOffset&&m.$from.marks();if(t.split(l.pos,2,x).scrollIntoView(),!w||!i)return!0;let T=w.filter(P=>b.includes(P.type.name));t.ensureMarks(T)}return!0},_R=pr(),qp=(r,e)=>{let t=Qo(a=>a.type===e)(r.selection);if(!t)return!0;let n=r.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(n===void 0)return!0;let i=r.doc.nodeAt(n);return t.node.type===i?.type&&(0,_R.canJoin)(r.doc,t.pos)&&r.join(t.pos),!0},Vp=(r,e)=>{let t=Qo(a=>a.type===e)(r.selection);if(!t)return!0;let n=r.doc.resolve(t.start).after(t.depth);if(n===void 0)return!0;let i=r.doc.nodeAt(n);return t.node.type===i?.type&&(0,_R.canJoin)(r.doc,n)&&r.join(n),!0},D9=(r,e,t,n={})=>({editor:i,tr:s,state:a,dispatch:o,chain:l,commands:u,can:c})=>{let{extensions:f,splittableMarks:d}=i.extensionManager,h=pt(r,a.schema),y=pt(e,a.schema),{selection:v,storedMarks:x}=a,{$from:m,$to:_}=v,b=m.blockRange(_),w=x||v.$to.parentOffset&&v.$from.marks();if(!b)return!1;let T=Qo(P=>Jp(P.type.name,f))(v);if(b.depth>=1&&T&&b.depth-T.depth<=1){if(T.node.type===h)return u.liftListItem(y);if(Jp(T.node.type.name,f)&&h.validContent(T.node.content)&&o)return l().command(()=>(s.setNodeMarkup(T.pos,h),!0)).command(()=>qp(s,h)).command(()=>Vp(s,h)).run()}return!t||!w||!o?l().command(()=>c().wrapInList(h,n)?!0:u.clearNodes()).wrapInList(h,n).command(()=>qp(s,h)).command(()=>Vp(s,h)).run():l().command(()=>{let P=c().wrapInList(h,n),M=w.filter(U=>d.includes(U.type.name));return s.ensureMarks(M),P?!0:u.clearNodes()}).wrapInList(h,n).command(()=>qp(s,h)).command(()=>Vp(s,h)).run()},M9=(r,e={},t={})=>({state:n,commands:i})=>{let{extendEmptyMarkRange:s=!1}=t,a=Dr(r,n.schema);return wu(n,a,e)?i.unsetMark(a,{extendEmptyMarkRange:s}):i.setMark(a,e)},L9=(r,e,t={})=>({state:n,commands:i})=>{let s=pt(r,n.schema),a=pt(e,n.schema),o=Ss(n,s,t),l;return n.selection.$anchor.sameParent(n.selection.$head)&&(l=n.selection.$anchor.parent.attrs),o?i.setNode(a,l):i.setNode(s,{...l,...t})},F9=(r,e={})=>({state:t,commands:n})=>{let i=pt(r,t.schema);return Ss(t,i,e)?n.lift(i):n.wrapIn(i,e)},B9=()=>({state:r,dispatch:e})=>{let t=r.plugins;for(let n=0;n<t.length;n+=1){let i=t[n],s;if(i.spec.isInputRules&&(s=i.getState(r))){if(e){let a=r.tr,o=s.transform;for(let l=o.steps.length-1;l>=0;l-=1)a.step(o.steps[l].invert(o.docs[l]));if(s.text){let l=a.doc.resolve(s.from).marks();a.replaceWith(s.from,s.to,r.schema.text(s.text,l))}else a.delete(s.from,s.to)}return!0}}return!1},U9=()=>({tr:r,dispatch:e})=>{let{selection:t}=r,{empty:n,ranges:i}=t;return n||e&&i.forEach(s=>{r.removeMark(s.$from.pos,s.$to.pos)}),!0},H9=(r,e={})=>({tr:t,state:n,dispatch:i})=>{var s;let{extendEmptyMarkRange:a=!1}=e,{selection:o}=t,l=Dr(r,n.schema),{$from:u,empty:c,ranges:f}=o;if(!i)return!0;if(c&&a){let{from:d,to:h}=o,y=(s=u.marks().find(x=>x.type===l))==null?void 0:s.attrs,v=xu(u,l,y);v&&(d=v.from,h=v.to),t.removeMark(d,h,l)}else f.forEach(d=>{t.removeMark(d.$from.pos,d.$to.pos,l)});return t.removeStoredMark(l),!0},z9=r=>({tr:e,state:t,dispatch:n})=>{let{selection:i}=t,s,a;return typeof r=="number"?(s=r,a=r):r&&"from"in r&&"to"in r?(s=r.from,a=r.to):(s=i.from,a=i.to),n&&e.doc.nodesBetween(s,a,(o,l)=>{if(o.isText)return;let u={...o.attrs};delete u.dir,e.setNodeMarkup(l,void 0,u)}),!0},j9=(r,e={})=>({tr:t,state:n,dispatch:i})=>{let s=null,a=null,o=Zo(typeof r=="string"?r:r.name,n.schema);if(!o)return!1;o==="node"&&(s=pt(r,n.schema)),o==="mark"&&(a=Dr(r,n.schema));let l=!1;return t.selection.ranges.forEach(u=>{let c=u.$from.pos,f=u.$to.pos,d,h,y,v;t.selection.empty?n.doc.nodesBetween(c,f,(x,m)=>{s&&s===x.type&&(l=!0,y=Math.max(m,c),v=Math.min(m+x.nodeSize,f),d=m,h=x)}):n.doc.nodesBetween(c,f,(x,m)=>{m<c&&s&&s===x.type&&(l=!0,y=Math.max(m,c),v=Math.min(m+x.nodeSize,f),d=m,h=x),m>=c&&m<=f&&(s&&s===x.type&&(l=!0,i&&t.setNodeMarkup(m,void 0,{...x.attrs,...e})),a&&x.marks.length&&x.marks.forEach(_=>{if(a===_.type&&(l=!0,i)){let b=Math.max(m,c),w=Math.min(m+x.nodeSize,f);t.addMark(b,w,a.create({..._.attrs,...e}))}}))}),h&&(d!==void 0&&i&&t.setNodeMarkup(d,void 0,{...h.attrs,...e}),a&&h.marks.length&&h.marks.forEach(x=>{a===x.type&&i&&t.addMark(y,v,a.create({...x.attrs,...e}))}))}),l},W9=bt(),q9=(r,e={})=>({state:t,dispatch:n})=>{let i=pt(r,t.schema);return(0,W9.wrapIn)(i,e)(t,n)},V9=nu(),K9=(r,e={})=>({state:t,dispatch:n})=>{let i=pt(r,t.schema);return(0,V9.wrapInList)(i,e)(t,n)},G9=Pe(),$9=jo(),J9=class{constructor(){this.callbacks={}}on(r,e){return this.callbacks[r]||(this.callbacks[r]=[]),this.callbacks[r].push(e),this}emit(r,...e){let t=this.callbacks[r];return t&&t.forEach(n=>n.apply(this,e)),this}off(r,e){let t=this.callbacks[r];return t&&(e?this.callbacks[r]=t.filter(n=>n!==e):delete this.callbacks[r]),this}once(r,e){let t=(...n)=>{this.off(r,t),e.apply(this,n)};return this.on(r,t)}removeAllListeners(){this.callbacks={}}},X9=UN(),Y9=gr(),Z9=Pe(),Ts=class{constructor(r){var e;this.find=r.find,this.handler=r.handler,this.undoable=(e=r.undoable)!=null?e:!0}},Q9=(r,e)=>{if(_u(e))return e.exec(r);let t=e(r);if(!t)return null;let n=[t.text];return n.index=t.index,n.input=r,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(t.replaceWith)),n};function mu(r){var e;let{editor:t,from:n,to:i,text:s,rules:a,plugin:o}=r,{view:l}=t;if(l.composing)return!1;let u=l.state.doc.resolve(n);if(u.parent.type.spec.code||(e=u.nodeBefore||u.nodeAfter)!=null&&e.marks.find(d=>d.type.spec.code))return!1;let c=!1,f=yR(u)+s;return a.forEach(d=>{if(c)return;let h=Q9(f,d.find);if(!h)return;let y=l.state.tr,v=Xo({state:l.state,transaction:y}),x={from:n-(h[0].length-s.length),to:i},{commands:m,chain:_,can:b}=new Yo({editor:t,state:v});d.handler({state:v,range:x,match:h,commands:m,chain:_,can:b})===null||!y.steps.length||(d.undoable&&y.setMeta(o,{transform:y,from:n,to:i,text:s}),l.dispatch(y),c=!0)}),c}function xR(r){let{editor:e,rules:t}=r,n=new Z9.Plugin({state:{init(){return null},apply(i,s,a){let o=i.getMeta(n);if(o)return o;let l=i.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:c}=l;typeof c=="string"?c=c:c=ea(Y9.Fragment.from(c),a.schema);let{from:f}=l,d=f+c.length;mu({editor:e,from:f,to:d,text:c,rules:t,plugin:n})}),i.selectionSet||i.docChanged?null:s}},props:{handleTextInput(i,s,a,o){return mu({editor:e,from:s,to:a,text:o,rules:t,plugin:n})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{let{$cursor:s}=i.state.selection;s&&mu({editor:e,from:s.pos,to:s.pos,text:"",rules:t,plugin:n})}),!1)},handleKeyDown(i,s){if(s.key!=="Enter")return!1;let{$cursor:a}=i.state.selection;return a?mu({editor:e,from:a.pos,to:a.pos,text:`
`,rules:t,plugin:n}):!1}},isInputRules:!0});return n}function ez(r){return Object.prototype.toString.call(r).slice(8,-1)}function Ko(r){return ez(r)!=="Object"?!1:r.constructor===Object&&Object.getPrototypeOf(r)===Object.prototype}function lm(r,e){let t={...r};return Ko(r)&&Ko(e)&&Object.keys(e).forEach(n=>{Ko(e[n])&&Ko(r[n])?t[n]=lm(r[n],e[n]):t[n]=e[n]}),t}var Cu=class{constructor(r={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...r},this.name=this.config.name}get options(){return{...Le(Ee(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Le(Ee(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(r={}){let e=this.extend({...this.config,addOptions:()=>lm(this.options,r)});return e.name=this.name,e.parent=this.parent,e}extend(r={}){let e=new this.constructor({...this.config,...r});return e.parent=this,this.child=e,e.name="name"in r?r.name:e.parent.name,e}},ER=class SR extends Cu{constructor(){super(...arguments),this.type="mark"}static create(e={}){let t=typeof e=="function"?e():e;return new SR(t)}static handleExit({editor:e,mark:t}){let{tr:n}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){let a=i.marks();if(!!!a.find(u=>u?.type.name===t.name))return!1;let l=a.find(u=>u?.type.name===t.name);return l&&n.removeStoredMark(l),n.insertText(" ",i.pos),e.view.dispatch(n),!0}return!1}configure(e){return super.configure(e)}extend(e){let t=typeof e=="function"?e():e;return super.extend(t)}},tz=gr(),rz=Pe();function kR(r){return typeof r=="number"}var Iu=class{constructor(r){this.find=r.find,this.handler=r.handler}},nz=(r,e,t)=>{if(_u(e))return[...r.matchAll(e)];let n=e(r,t);return n?n.map(i=>{let s=[i.text];return s.index=i.index,s.input=r,s.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(i.replaceWith)),s}):[]};function iz(r){let{editor:e,state:t,from:n,to:i,rule:s,pasteEvent:a,dropEvent:o}=r,{commands:l,chain:u,can:c}=new Yo({editor:e,state:t}),f=[];return t.doc.nodesBetween(n,i,(h,y)=>{var v,x,m,_,b;if((x=(v=h.type)==null?void 0:v.spec)!=null&&x.code||!(h.isText||h.isTextblock||h.isInline))return;let w=(b=(_=(m=h.content)==null?void 0:m.size)!=null?_:h.nodeSize)!=null?b:0,T=Math.max(n,y),P=Math.min(i,y+w);if(T>=P)return;let M=h.isText?h.text||"":h.textBetween(T-y,P-y,void 0,"\uFFFC");nz(M,s.find,a).forEach(R=>{if(R.index===void 0)return;let J=T+R.index+1,oe=J+R[0].length,C={from:t.tr.mapping.map(J),to:t.tr.mapping.map(oe)},H=s.handler({state:t,range:C,match:R,commands:l,chain:u,can:c,pasteEvent:a,dropEvent:o});f.push(H)})}),f.every(h=>h!==null)}var gu=null,sz=r=>{var e;let t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)==null||e.setData("text/html",r),t};function TR(r){let{editor:e,rules:t}=r,n=null,i=!1,s=!1,a=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,o;try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}let l=({state:c,from:f,to:d,rule:h,pasteEvt:y})=>{let v=c.tr,x=Xo({state:c,transaction:v});if(!(!iz({editor:e,state:x,from:Math.max(f-1,0),to:d.b-1,rule:h,pasteEvent:y,dropEvent:o})||!v.steps.length)){try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}return a=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,v}};return t.map(c=>new rz.Plugin({view(f){let d=y=>{var v;n=(v=f.dom.parentElement)!=null&&v.contains(y.target)?f.dom.parentElement:null,n&&(gu=e)},h=()=>{gu&&(gu=null)};return window.addEventListener("dragstart",d),window.addEventListener("dragend",h),{destroy(){window.removeEventListener("dragstart",d),window.removeEventListener("dragend",h)}}},props:{handleDOMEvents:{drop:(f,d)=>{if(s=n===f.dom.parentElement,o=d,!s){let h=gu;h?.isEditable&&setTimeout(()=>{let y=h.state.selection;y&&h.commands.deleteRange({from:y.from,to:y.to})},10)}return!1},paste:(f,d)=>{var h;let y=(h=d.clipboardData)==null?void 0:h.getData("text/html");return a=d,i=!!y?.includes("data-pm-slice"),!1}}},appendTransaction:(f,d,h)=>{let y=f[0],v=y.getMeta("uiEvent")==="paste"&&!i,x=y.getMeta("uiEvent")==="drop"&&!s,m=y.getMeta("applyPasteRules"),_=!!m;if(!v&&!x&&!_)return;if(_){let{text:T}=m;typeof T=="string"?T=T:T=ea(tz.Fragment.from(T),h.schema);let{from:P}=m,M=P+T.length,U=sz(T);return l({rule:c,state:h,from:P,to:{b:M},pasteEvt:U})}let b=d.doc.content.findDiffStart(h.doc.content),w=d.doc.content.findDiffEnd(h.doc.content);if(!(!kR(b)||!w||b===w.b))return l({rule:c,state:h,from:b,to:w,pasteEvt:a})}}))}var Pu=class{constructor(r,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=r,this.extensions=Au(r),this.schema=im(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((r,e)=>{let t={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:vu(e.name,this.schema)},n=Ee(e,"addCommands",t);return n?{...r,...n()}:r},{})}get plugins(){let{editor:r}=this;return Tu([...this.extensions].reverse()).flatMap(n=>{let i={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:r,type:vu(n.name,this.schema)},s=[],a=Ee(n,"addKeyboardShortcuts",i),o={};if(n.type==="mark"&&Ee(n,"exitable",i)&&(o.ArrowRight=()=>ER.handleExit({editor:r,mark:n})),a){let d=Object.fromEntries(Object.entries(a()).map(([h,y])=>[h,()=>y({editor:r})]));o={...o,...d}}let l=(0,X9.keymap)(o);s.push(l);let u=Ee(n,"addInputRules",i);if($p(n,r.options.enableInputRules)&&u){let d=u();if(d&&d.length){let h=xR({editor:r,rules:d}),y=Array.isArray(h)?h:[h];s.push(...y)}}let c=Ee(n,"addPasteRules",i);if($p(n,r.options.enablePasteRules)&&c){let d=c();if(d&&d.length){let h=TR({editor:r,rules:d});s.push(...h)}}let f=Ee(n,"addProseMirrorPlugins",i);if(f){let d=f();s.push(...d)}return s})}get attributes(){return nm(this.extensions)}get nodeViews(){let{editor:r}=this,{nodeExtensions:e}=Ti(this.extensions);return Object.fromEntries(e.filter(t=>!!Ee(t,"addNodeView")).map(t=>{let n=this.attributes.filter(l=>l.type===t.name),i={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:r,type:pt(t.name,this.schema)},s=Ee(t,"addNodeView",i);if(!s)return[];let a=s();if(!a)return[];let o=(l,u,c,f,d)=>{let h=Jo(l,n);return a({node:l,view:u,getPos:c,decorations:f,innerDecorations:d,editor:r,extension:t,HTMLAttributes:h})};return[t.name,o]}))}get markViews(){let{editor:r}=this,{markExtensions:e}=Ti(this.extensions);return Object.fromEntries(e.filter(t=>!!Ee(t,"addMarkView")).map(t=>{let n=this.attributes.filter(o=>o.type===t.name),i={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:r,type:Dr(t.name,this.schema)},s=Ee(t,"addMarkView",i);if(!s)return[];let a=(o,l,u)=>{let c=Jo(o,n);return s()({mark:o,view:l,inline:u,editor:r,extension:t,HTMLAttributes:c,updateAttributes:f=>{um(o,r,f)}})};return[t.name,a]}))}setupExtensions(){let r=this.extensions;this.editor.extensionStorage=Object.fromEntries(r.map(e=>[e.name,e.storage])),r.forEach(e=>{var t;let n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:vu(e.name,this.schema)};e.type==="mark"&&((t=Le(Ee(e,"keepOnSplit",n)))==null||t)&&this.splittableMarks.push(e.name);let i=Ee(e,"onBeforeCreate",n),s=Ee(e,"onCreate",n),a=Ee(e,"onUpdate",n),o=Ee(e,"onSelectionUpdate",n),l=Ee(e,"onTransaction",n),u=Ee(e,"onFocus",n),c=Ee(e,"onBlur",n),f=Ee(e,"onDestroy",n);i&&this.editor.on("beforeCreate",i),s&&this.editor.on("create",s),a&&this.editor.on("update",a),o&&this.editor.on("selectionUpdate",o),l&&this.editor.on("transaction",l),u&&this.editor.on("focus",u),c&&this.editor.on("blur",c),f&&this.editor.on("destroy",f)})}};Pu.resolve=Au;Pu.sort=Tu;Pu.flatten=ku;var AR={};bu(AR,{ClipboardTextSerializer:()=>NR,Commands:()=>RR,Delete:()=>CR,Drop:()=>IR,Editable:()=>PR,FocusEvents:()=>LR,Keymap:()=>FR,Paste:()=>BR,Tabindex:()=>UR,TextDirection:()=>HR,focusEventsPluginKey:()=>MR});var GN=Pe(),wr=class OR extends Cu{constructor(){super(...arguments),this.type="extension"}static create(e={}){let t=typeof e=="function"?e():e;return new OR(t)}configure(e){return super.configure(e)}extend(e){let t=typeof e=="function"?e():e;return super.extend(t)}},NR=wr.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new GN.Plugin({key:new GN.PluginKey("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{let{editor:r}=this,{state:e,schema:t}=r,{doc:n,selection:i}=e,{ranges:s}=i,a=Math.min(...s.map(c=>c.$from.pos)),o=Math.max(...s.map(c=>c.$to.pos)),l=Nu(t);return sm(n,{from:a,to:o},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),RR=wr.create({name:"commands",addCommands(){return{...Yp}}}),oz=pr(),CR=wr.create({name:"delete",onUpdate({transaction:r,appendedTransactions:e}){var t,n,i;let s=()=>{var a,o,l,u;if((u=(l=(o=(a=this.editor.options.coreExtensionOptions)==null?void 0:a.delete)==null?void 0:o.filterTransaction)==null?void 0:l.call(o,r))!=null?u:r.getMeta("y-sync$"))return;let c=oR(r.before,[r,...e]);gR(c).forEach(h=>{c.mapping.mapResult(h.oldRange.from).deletedAfter&&c.mapping.mapResult(h.oldRange.to).deletedBefore&&c.before.nodesBetween(h.oldRange.from,h.oldRange.to,(y,v)=>{let x=v+y.nodeSize-2,m=h.oldRange.from<=v&&x<=h.oldRange.to;this.editor.emit("delete",{type:"node",node:y,from:v,to:x,newFrom:c.mapping.map(v),newTo:c.mapping.map(x),deletedRange:h.oldRange,newRange:h.newRange,partial:!m,editor:this.editor,transaction:r,combinedTransform:c})})});let d=c.mapping;c.steps.forEach((h,y)=>{var v,x;if(h instanceof oz.RemoveMarkStep){let m=d.slice(y).map(h.from,-1),_=d.slice(y).map(h.to),b=d.invert().map(m,-1),w=d.invert().map(_),T=(v=c.doc.nodeAt(m-1))==null?void 0:v.marks.some(M=>M.eq(h.mark)),P=(x=c.doc.nodeAt(_))==null?void 0:x.marks.some(M=>M.eq(h.mark));this.editor.emit("delete",{type:"mark",mark:h.mark,from:h.from,to:h.to,deletedRange:{from:b,to:w},newRange:{from:m,to:_},partial:!!(P||T),editor:this.editor,transaction:r,combinedTransform:c})}})};(i=(n=(t=this.editor.options.coreExtensionOptions)==null?void 0:t.delete)==null?void 0:n.async)==null||i?setTimeout(s,0):s()}}),$N=Pe(),IR=wr.create({name:"drop",addProseMirrorPlugins(){return[new $N.Plugin({key:new $N.PluginKey("tiptapDrop"),props:{handleDrop:(r,e,t,n)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:n})}}})]}}),JN=Pe(),PR=wr.create({name:"editable",addProseMirrorPlugins(){return[new JN.Plugin({key:new JN.PluginKey("editable"),props:{editable:()=>this.editor.options.editable}})]}}),DR=Pe(),MR=new DR.PluginKey("focusEvents"),LR=wr.create({name:"focusEvents",addProseMirrorPlugins(){let{editor:r}=this;return[new DR.Plugin({key:MR,props:{handleDOMEvents:{focus:(e,t)=>{r.isFocused=!0;let n=r.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(n),!1},blur:(e,t)=>{r.isFocused=!1;let n=r.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(n),!1}}}})]}}),Vo=Pe(),FR=wr.create({name:"keymap",addKeyboardShortcuts(){let r=()=>this.editor.commands.first(({commands:a})=>[()=>a.undoInputRule(),()=>a.command(({tr:o})=>{let{selection:l,doc:u}=o,{empty:c,$anchor:f}=l,{pos:d,parent:h}=f,y=f.parent.isTextblock&&d>0?o.doc.resolve(d-1):f,v=y.parent.type.spec.isolating,x=f.pos-f.parentOffset,m=v&&y.parent.childCount===1?x===f.pos:Vo.Selection.atStart(u).from===d;return!c||!h.type.isTextblock||h.textContent.length||!m||m&&f.parent.type.name==="paragraph"?!1:a.clearNodes()}),()=>a.deleteSelection(),()=>a.joinBackward(),()=>a.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:a})=>[()=>a.deleteSelection(),()=>a.deleteCurrentNode(),()=>a.joinForward(),()=>a.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:a})=>[()=>a.newlineInCode(),()=>a.createParagraphNear(),()=>a.liftEmptyBlock(),()=>a.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:r,"Mod-Backspace":r,"Shift-Backspace":r,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},s={...n,"Ctrl-h":r,"Alt-Backspace":r,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return ks()||em()?s:i},addProseMirrorPlugins(){return[new Vo.Plugin({key:new Vo.PluginKey("clearDocument"),appendTransaction:(r,e,t)=>{if(r.some(v=>v.getMeta("composition")))return;let n=r.some(v=>v.docChanged)&&!e.doc.eq(t.doc),i=r.some(v=>v.getMeta("preventClearDocument"));if(!n||i)return;let{empty:s,from:a,to:o}=e.selection,l=Vo.Selection.atStart(e.doc).from,u=Vo.Selection.atEnd(e.doc).to;if(s||!(a===l&&o===u)||!Ru(t.doc))return;let d=t.tr,h=Xo({state:t,transaction:d}),{commands:y}=new Yo({editor:this.editor,state:h});if(y.clearNodes(),!!d.steps.length)return d}})]}}),XN=Pe(),BR=wr.create({name:"paste",addProseMirrorPlugins(){return[new XN.Plugin({key:new XN.PluginKey("tiptapPaste"),props:{handlePaste:(r,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),YN=Pe(),UR=wr.create({name:"tabindex",addProseMirrorPlugins(){return[new YN.Plugin({key:new YN.PluginKey("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),ZN=Pe(),HR=wr.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];let{nodeExtensions:r}=Ti(this.extensions);return[{types:r.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{let t=e.getAttribute("dir");return t&&(t==="ltr"||t==="rtl"||t==="auto")?t:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new ZN.Plugin({key:new ZN.PluginKey("textDirection"),props:{attributes:()=>{let r=this.options.direction;return r?{dir:r}:{}}}})]}}),zR=class _s{constructor(e,t,n=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can\u2019t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;let e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new _s(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new _s(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new _s(e,this.editor)}get children(){let e=[];return this.node.content.forEach((t,n)=>{let i=t.isBlock&&!t.isTextblock,s=t.isAtom&&!t.isText,a=this.pos+n+(s?0:1);if(a<0||a>this.resolvedPos.doc.nodeSize-2)return;let o=this.resolvedPos.doc.resolve(a);if(!i&&o.depth<=this.depth)return;let l=new _s(o,this.editor,i,i?t:null);i&&(l.actualDepth=this.depth+1),e.push(new _s(o,this.editor,i,i?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){let e=this.children;return e[e.length-1]||null}closest(e,t={}){let n=null,i=this.parent;for(;i&&!n;){if(i.node.type.name===e)if(Object.keys(t).length>0){let s=i.node.attrs,a=Object.keys(t);for(let o=0;o<a.length;o+=1){let l=a[o];if(s[l]!==t[l])break}}else n=i;i=i.parent}return n}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},n=!1){let i=[];if(!this.children||this.children.length===0)return i;let s=Object.keys(t);return this.children.forEach(a=>{n&&i.length>0||(a.node.type.name===e&&s.every(l=>t[l]===a.node.attrs[l])&&i.push(a),!(n&&i.length>0)&&(i=i.concat(a.querySelectorAll(e,t,n))))}),i}setAttribute(e){let{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}},az=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function jR(r,e,t){let n=document.querySelector(`style[data-tiptap-style${t?`-${t}`:""}]`);if(n!==null)return n;let i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute(`data-tiptap-style${t?`-${t}`:""}`,""),i.innerHTML=r,document.getElementsByTagName("head")[0].appendChild(i),i}var lz=class extends J9{constructor(r={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(r),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:i,moved:s})=>this.options.onDrop(n,i,s)),this.on("paste",({event:n,slice:i})=>this.options.onPaste(n,i)),this.on("delete",this.options.onDelete);let e=this.createDoc(),t=Qp(e,this.options.autofocus);this.editorState=G9.EditorState.create({doc:e,schema:this.schema,selection:t||void 0}),this.options.element&&this.mount(this.options.element)}mount(r){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(r),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){let r=this.editorView.dom;r?.editor&&delete r.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(r){console.warn("Failed to remove CSS element:",r)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=jR(az,this.options.injectNonce))}setOptions(r={}){this.options={...this.options,...r},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(r,e=!0){this.setOptions({editable:r}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:r=>{this.editorState=r},dispatch:r=>{this.dispatchTransaction(r)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(r,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in r)return Reflect.get(r,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(r,e){let t=rm(e)?e(r,[...this.state.plugins]):[...this.state.plugins,r],n=this.state.reconfigure({plugins:t});return this.view.updateState(n),n}unregisterPlugin(r){if(this.isDestroyed)return;let e=this.state.plugins,t=e;if([].concat(r).forEach(i=>{let s=typeof i=="string"?`${i}$`:i.key;t=t.filter(a=>!a.key.startsWith(s))}),e.length===t.length)return;let n=this.state.reconfigure({plugins:t});return this.view.updateState(n),n}createExtensionManager(){var r,e;let n=[...this.options.enableCoreExtensions?[PR,NR.configure({blockSeparator:(e=(r=this.options.coreExtensionOptions)==null?void 0:r.clipboardTextSerializer)==null?void 0:e.blockSeparator}),RR,LR,FR,UR,IR,BR,CR,HR.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i?.type));this.extensionManager=new Pu(n,this)}createCommandManager(){this.commandManager=new Yo({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let r;try{r=yu(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(t=>t.name!=="collaboration"),this.createExtensionManager()}}),r=yu(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return r}createView(r){var e;this.editorView=new $9.EditorView(r,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)==null?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});let t=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(t),this.prependClass(),this.injectCSS();let n=this.view.dom;n.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(r){this.isCapturingTransaction=!0,r(),this.isCapturingTransaction=!1;let e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(r){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=r;return}r.steps.forEach(u=>{var c;return(c=this.capturedTransaction)==null?void 0:c.step(u)});return}let{state:e,transactions:t}=this.state.applyTransaction(r),n=!this.state.selection.eq(e.selection),i=t.includes(r),s=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:r,nextState:e}),!i)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:r,appendedTransactions:t.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:r});let a=t.findLast(u=>u.getMeta("focus")||u.getMeta("blur")),o=a?.getMeta("focus"),l=a?.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:a}),l&&this.emit("blur",{editor:this,event:l.event,transaction:a}),!(r.getMeta("preventUpdate")||!t.some(u=>u.docChanged)||s.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:r,appendedTransactions:t.slice(1)})}getAttributes(r){return pR(this.state,r)}isActive(r,e){let t=typeof r=="string"?r:null,n=typeof r=="string"?e:r;return wR(this.state,t,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return ea(this.state.doc.content,this.schema)}getText(r){let{blockSeparator:e=`

`,textSerializers:t={}}=r||{};return om(this.state.doc,{blockSeparator:e,textSerializers:{...Nu(this.schema),...t}})}get isEmpty(){return Ru(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var r,e;return(e=(r=this.editorView)==null?void 0:r.isDestroyed)!=null?e:!0}$node(r,e){var t;return((t=this.$doc)==null?void 0:t.querySelector(r,e))||null}$nodes(r,e){var t;return((t=this.$doc)==null?void 0:t.querySelectorAll(r,e))||null}$pos(r){let e=this.state.doc.resolve(r);return new zR(e,this)}get $doc(){return this.$pos(0)}};function uz(r){return new Ts({find:r.find,handler:({state:e,range:t,match:n})=>{let i=Le(r.getAttributes,void 0,n);if(i===!1||i===null)return null;let{tr:s}=e,a=n[n.length-1],o=n[0];if(a){let l=o.search(/\S/),u=t.from+o.indexOf(a),c=u+a.length;if(am(t.from,t.to,e.doc).filter(h=>h.mark.type.excluded.find(v=>v===r.type&&v!==h.mark.type)).filter(h=>h.to>u).length)return null;c<t.to&&s.delete(c,t.to),u>t.from&&s.delete(t.from+l,u);let d=t.from+l+a.length;s.addMark(t.from+l,d,r.type.create(i||{})),s.removeStoredMark(r.type)}},undoable:r.undoable})}function cz(r){return new Ts({find:r.find,handler:({state:e,range:t,match:n})=>{let i=Le(r.getAttributes,void 0,n)||{},{tr:s}=e,a=t.from,o=t.to,l=r.type.create(i);if(n[1]){let u=n[0].lastIndexOf(n[1]),c=a+u;c>o?c=o:o=c+n[1].length;let f=n[0][n[0].length-1];s.insertText(f,a+n[0].length-1),s.replaceWith(c,o,l)}else if(n[0]){let u=r.type.isInline?a:a-1;s.insert(u,r.type.create(i)).delete(s.mapping.map(a),s.mapping.map(o))}s.scrollIntoView()},undoable:r.undoable})}function fz(r){return new Ts({find:r.find,handler:({state:e,range:t,match:n})=>{let i=e.doc.resolve(t.from),s=Le(r.getAttributes,void 0,n)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),r.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,r.type,s)},undoable:r.undoable})}function hz(r){return new Ts({find:r.find,handler:({state:e,range:t,match:n})=>{let i=r.replace,s=t.from,a=t.to;if(n[1]){let o=n[0].lastIndexOf(n[1]);i+=n[0].slice(o+n[1].length),s+=o;let l=s-a;l>0&&(i=n[0].slice(o-l,o)+i,s=a)}e.tr.insertText(i,s,a)},undoable:r.undoable})}var QN=pr();function dz(r){return new Ts({find:r.find,handler:({state:e,range:t,match:n,chain:i})=>{let s=Le(r.getAttributes,void 0,n)||{},a=e.tr.delete(t.from,t.to),l=a.doc.resolve(t.from).blockRange(),u=l&&(0,QN.findWrapping)(l,r.type,s);if(!u)return null;if(a.wrap(l,u),r.keepMarks&&r.editor){let{selection:f,storedMarks:d}=e,{splittableMarks:h}=r.editor.extensionManager,y=d||f.$to.parentOffset&&f.$from.marks();if(y){let v=y.filter(x=>h.includes(x.type.name));a.ensureMarks(v)}}if(r.keepAttributes){let f=r.type.name==="bulletList"||r.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(f,s).run()}let c=a.doc.resolve(t.from-1).nodeBefore;c&&c.type===r.type&&(0,QN.canJoin)(a.doc,t.from-1)&&(!r.joinPredicate||r.joinPredicate(n,c))&&a.join(t.from-1)},undoable:r.undoable})}function pz(r){return r.children}var eR=(r,e)=>{if(r==="slot")return 0;if(r instanceof Function)return r(e);let{children:t,...n}=e??{};if(r==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[r,n,t]},mz=r=>"touches"in r,WR=class{constructor(r){this.directions=["bottom-left","bottom-right","top-left","top-right"],this.minSize={height:8,width:8},this.preserveAspectRatio=!1,this.classNames={container:"",wrapper:"",handle:"",resizing:""},this.initialWidth=0,this.initialHeight=0,this.aspectRatio=1,this.isResizing=!1,this.activeHandle=null,this.startX=0,this.startY=0,this.startWidth=0,this.startHeight=0,this.isShiftKeyPressed=!1,this.handleMouseMove=a=>{if(!this.isResizing||!this.activeHandle)return;let o=a.clientX-this.startX,l=a.clientY-this.startY;this.handleResize(o,l)},this.handleTouchMove=a=>{if(!this.isResizing||!this.activeHandle)return;let o=a.touches[0];if(!o)return;let l=o.clientX-this.startX,u=o.clientY-this.startY;this.handleResize(l,u)},this.handleMouseUp=()=>{if(!this.isResizing)return;let a=this.element.offsetWidth,o=this.element.offsetHeight;this.onCommit(a,o),this.isResizing=!1,this.activeHandle=null,this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)},this.handleKeyDown=a=>{a.key==="Shift"&&(this.isShiftKeyPressed=!0)},this.handleKeyUp=a=>{a.key==="Shift"&&(this.isShiftKeyPressed=!1)};var e,t,n,i,s;this.node=r.node,this.element=r.element,this.contentElement=r.contentElement,this.getPos=r.getPos,this.onResize=r.onResize,this.onCommit=r.onCommit,this.onUpdate=r.onUpdate,(e=r.options)!=null&&e.min&&(this.minSize={...this.minSize,...r.options.min}),(t=r.options)!=null&&t.max&&(this.maxSize=r.options.max),(n=r?.options)!=null&&n.directions&&(this.directions=r.options.directions),(i=r.options)!=null&&i.preserveAspectRatio&&(this.preserveAspectRatio=r.options.preserveAspectRatio),(s=r.options)!=null&&s.className&&(this.classNames={container:r.options.className.container||"",wrapper:r.options.className.wrapper||"",handle:r.options.className.handle||"",resizing:r.options.className.resizing||""}),this.wrapper=this.createWrapper(),this.container=this.createContainer(),this.applyInitialSize(),this.attachHandles()}get dom(){return this.container}get contentDOM(){return this.contentElement}update(r,e,t){return r.type!==this.node.type?!1:(this.node=r,this.onUpdate?this.onUpdate(r,e,t):!0)}destroy(){this.isResizing&&(this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp),this.isResizing=!1,this.activeHandle=null),this.container.remove()}createContainer(){let r=document.createElement("div");return r.dataset.resizeContainer="",r.dataset.node=this.node.type.name,r.style.display="flex",r.style.justifyContent="flex-start",r.style.alignItems="flex-start",this.classNames.container&&(r.className=this.classNames.container),r.appendChild(this.wrapper),r}createWrapper(){let r=document.createElement("div");return r.style.position="relative",r.style.display="block",r.dataset.resizeWrapper="",this.classNames.wrapper&&(r.className=this.classNames.wrapper),r.appendChild(this.element),r}createHandle(r){let e=document.createElement("div");return e.dataset.resizeHandle=r,e.style.position="absolute",this.classNames.handle&&(e.className=this.classNames.handle),e}positionHandle(r,e){let t=e.includes("top"),n=e.includes("bottom"),i=e.includes("left"),s=e.includes("right");t&&(r.style.top="0"),n&&(r.style.bottom="0"),i&&(r.style.left="0"),s&&(r.style.right="0"),(e==="top"||e==="bottom")&&(r.style.left="0",r.style.right="0"),(e==="left"||e==="right")&&(r.style.top="0",r.style.bottom="0")}attachHandles(){this.directions.forEach(r=>{let e=this.createHandle(r);this.positionHandle(e,r),e.addEventListener("mousedown",t=>this.handleResizeStart(t,r)),e.addEventListener("touchstart",t=>this.handleResizeStart(t,r)),this.wrapper.appendChild(e)})}applyInitialSize(){let r=this.node.attrs.width,e=this.node.attrs.height;r?(this.element.style.width=`${r}px`,this.initialWidth=r):this.initialWidth=this.element.offsetWidth,e?(this.element.style.height=`${e}px`,this.initialHeight=e):this.initialHeight=this.element.offsetHeight,this.initialWidth>0&&this.initialHeight>0&&(this.aspectRatio=this.initialWidth/this.initialHeight)}handleResizeStart(r,e){r.preventDefault(),r.stopPropagation(),this.isResizing=!0,this.activeHandle=e,mz(r)?(this.startX=r.touches[0].clientX,this.startY=r.touches[0].clientY):(this.startX=r.clientX,this.startY=r.clientY),this.startWidth=this.element.offsetWidth,this.startHeight=this.element.offsetHeight,this.startWidth>0&&this.startHeight>0&&(this.aspectRatio=this.startWidth/this.startHeight);let t=this.getPos();this.container.dataset.resizeState="true",this.classNames.resizing&&this.container.classList.add(this.classNames.resizing),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}handleResize(r,e){if(!this.activeHandle)return;let t=this.preserveAspectRatio||this.isShiftKeyPressed,{width:n,height:i}=this.calculateNewDimensions(this.activeHandle,r,e),s=this.applyConstraints(n,i,t);this.element.style.width=`${s.width}px`,this.element.style.height=`${s.height}px`,this.onResize&&this.onResize(s.width,s.height)}calculateNewDimensions(r,e,t){let n=this.startWidth,i=this.startHeight,s=r.includes("right"),a=r.includes("left"),o=r.includes("bottom"),l=r.includes("top");return s?n=this.startWidth+e:a&&(n=this.startWidth-e),o?i=this.startHeight+t:l&&(i=this.startHeight-t),(r==="right"||r==="left")&&(n=this.startWidth+(s?e:-e)),(r==="top"||r==="bottom")&&(i=this.startHeight+(o?t:-t)),this.preserveAspectRatio||this.isShiftKeyPressed?this.applyAspectRatio(n,i,r):{width:n,height:i}}applyConstraints(r,e,t){var n,i,s,a;if(!t){let u=Math.max(this.minSize.width,r),c=Math.max(this.minSize.height,e);return(n=this.maxSize)!=null&&n.width&&(u=Math.min(this.maxSize.width,u)),(i=this.maxSize)!=null&&i.height&&(c=Math.min(this.maxSize.height,c)),{width:u,height:c}}let o=r,l=e;return o<this.minSize.width&&(o=this.minSize.width,l=o/this.aspectRatio),l<this.minSize.height&&(l=this.minSize.height,o=l*this.aspectRatio),(s=this.maxSize)!=null&&s.width&&o>this.maxSize.width&&(o=this.maxSize.width,l=o/this.aspectRatio),(a=this.maxSize)!=null&&a.height&&l>this.maxSize.height&&(l=this.maxSize.height,o=l*this.aspectRatio),{width:o,height:l}}applyAspectRatio(r,e,t){let n=t==="left"||t==="right",i=t==="top"||t==="bottom";return n?{width:r,height:r/this.aspectRatio}:i?{width:e*this.aspectRatio,height:e}:{width:r,height:r/this.aspectRatio}}},gz=WR,vz=Pe();function yz(r,e){let{selection:t}=r,{$from:n}=t;if(t instanceof vz.NodeSelection){let s=n.index();return n.parent.canReplaceWith(s,s+1,e)}let i=n.depth;for(;i>=0;){let s=n.index(i);if(n.node(i).contentMatchAt(s).matchType(e))return!0;i-=1}return!1}function wz(r){return r.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function bz(r){return typeof r=="string"}var qR={};bu(qR,{createAtomBlockMarkdownSpec:()=>VR,createBlockMarkdownSpec:()=>KR,createInlineMarkdownSpec:()=>GR,parseAttributes:()=>Du,parseIndentedBlocks:()=>$R,renderNestedMarkdownContent:()=>JR,serializeAttributes:()=>Mu});function Du(r){if(!r?.trim())return{};let e={},t=[],n=r.replace(/["']([^"']*)["']/g,u=>(t.push(u),`__QUOTED_${t.length-1}__`)),i=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){let u=i.map(c=>c.trim().slice(1));e.class=u.join(" ")}let s=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);s&&(e.id=s[1]);let a=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(a)).forEach(([,u,c])=>{var f;let d=parseInt(((f=c.match(/__QUOTED_(\d+)__/))==null?void 0:f[1])||"0",10),h=t[d];h&&(e[u]=h.slice(1,-1))});let l=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(c=>{c.match(/^[a-zA-Z][\w-]*$/)&&(e[c]=!0)}),e}function Mu(r){if(!r||Object.keys(r).length===0)return"";let e=[];return r.class&&String(r.class).split(/\s+/).filter(Boolean).forEach(n=>e.push(`.${n}`)),r.id&&e.push(`#${r.id}`),Object.entries(r).forEach(([t,n])=>{t==="class"||t==="id"||(n===!0?e.push(t):n!==!1&&n!=null&&e.push(`${t}="${String(n)}"`))}),e.join(" ")}function VR(r){let{nodeName:e,name:t,parseAttributes:n=Du,serializeAttributes:i=Mu,defaultAttributes:s={},requiredAttributes:a=[],allowedAttributes:o}=r,l=t||e,u=c=>{if(!o)return c;let f={};return o.forEach(d=>{d in c&&(f[d]=c[d])}),f};return{parseMarkdown:(c,f)=>{let d={...s,...c.attributes};return f.createNode(e,d,[])},markdownTokenizer:{name:e,level:"block",start(c){var f;let d=new RegExp(`^:::${l}(?:\\s|$)`,"m"),h=(f=c.match(d))==null?void 0:f.index;return h!==void 0?h:-1},tokenize(c,f,d){let h=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),y=c.match(h);if(!y)return;let v=y[1]||"",x=n(v);if(!a.find(_=>!(_ in x)))return{type:e,raw:y[0],attributes:x}}},renderMarkdown:c=>{let f=u(c.attrs||{}),d=i(f),h=d?` {${d}}`:"";return`:::${l}${h} :::`}}}function KR(r){let{nodeName:e,name:t,getContent:n,parseAttributes:i=Du,serializeAttributes:s=Mu,defaultAttributes:a={},content:o="block",allowedAttributes:l}=r,u=t||e,c=f=>{if(!l)return f;let d={};return l.forEach(h=>{h in f&&(d[h]=f[h])}),d};return{parseMarkdown:(f,d)=>{let h;if(n){let v=n(f);h=typeof v=="string"?[{type:"text",text:v}]:v}else o==="block"?h=d.parseChildren(f.tokens||[]):h=d.parseInline(f.tokens||[]);let y={...a,...f.attributes};return d.createNode(e,y,h)},markdownTokenizer:{name:e,level:"block",start(f){var d;let h=new RegExp(`^:::${u}`,"m"),y=(d=f.match(h))==null?void 0:d.index;return y!==void 0?y:-1},tokenize(f,d,h){var y;let v=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),x=f.match(v);if(!x)return;let[m,_=""]=x,b=i(_),w=1,T=m.length,P="",M=/^:::([\w-]*)(\s.*)?/gm,U=f.slice(T);for(M.lastIndex=0;;){let R=M.exec(U);if(R===null)break;let J=R.index,oe=R[1];if(!((y=R[2])!=null&&y.endsWith(":::"))){if(oe)w+=1;else if(w-=1,w===0){let C=U.slice(0,J);P=C.trim();let H=f.slice(0,T+J+R[0].length),k=[];if(P)if(o==="block")for(k=h.blockTokens(C),k.forEach(V=>{V.text&&(!V.tokens||V.tokens.length===0)&&(V.tokens=h.inlineTokens(V.text))});k.length>0;){let V=k[k.length-1];if(V.type==="paragraph"&&(!V.text||V.text.trim()===""))k.pop();else break}else k=h.inlineTokens(P);return{type:e,raw:H,attributes:b,content:P,tokens:k}}}}}},renderMarkdown:(f,d)=>{let h=c(f.attrs||{}),y=s(h),v=y?` {${y}}`:"",x=d.renderChildren(f.content||[],`

`);return`:::${u}${v}

${x}

:::`}}}function _z(r){if(!r.trim())return{};let e={},t=/(\w+)=(?:"([^"]*)"|'([^']*)')/g,n=t.exec(r);for(;n!==null;){let[,i,s,a]=n;e[i]=s||a,n=t.exec(r)}return e}function xz(r){return Object.entries(r).filter(([,e])=>e!=null).map(([e,t])=>`${e}="${t}"`).join(" ")}function GR(r){let{nodeName:e,name:t,getContent:n,parseAttributes:i=_z,serializeAttributes:s=xz,defaultAttributes:a={},selfClosing:o=!1,allowedAttributes:l}=r,u=t||e,c=d=>{if(!l)return d;let h={};return l.forEach(y=>{y in d&&(h[y]=d[y])}),h},f=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(d,h)=>{let y={...a,...d.attributes};if(o)return h.createNode(e,y);let v=n?n(d):d.content||"";return v?h.createNode(e,y,[h.createTextNode(v)]):h.createNode(e,y,[])},markdownTokenizer:{name:e,level:"inline",start(d){let h=o?new RegExp(`\\[${f}\\s*[^\\]]*\\]`):new RegExp(`\\[${f}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${f}\\]`),y=d.match(h),v=y?.index;return v!==void 0?v:-1},tokenize(d,h,y){let v=o?new RegExp(`^\\[${f}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${f}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${f}\\]`),x=d.match(v);if(!x)return;let m="",_="";if(o){let[,w]=x;_=w}else{let[,w,T]=x;_=w,m=T||""}let b=i(_.trim());return{type:e,raw:x[0],content:m.trim(),attributes:b}}},renderMarkdown:d=>{let h="";n?h=n(d):d.content&&d.content.length>0&&(h=d.content.filter(m=>m.type==="text").map(m=>m.text).join(""));let y=c(d.attrs||{}),v=s(y),x=v?` ${v}`:"";return o?`[${u}${x}]`:`[${u}${x}]${h}[/${u}]`}}}function $R(r,e,t){var n,i,s,a;let o=r.split(`
`),l=[],u="",c=0,f=e.baseIndentSize||2;for(;c<o.length;){let d=o[c],h=d.match(e.itemPattern);if(!h){if(l.length>0)break;if(d.trim()===""){c+=1,u=`${u}${d}
`;continue}else return}let y=e.extractItemData(h),{indentLevel:v,mainContent:x}=y;u=`${u}${d}
`;let m=[x];for(c+=1;c<o.length;){let T=o[c];if(T.trim()===""){let M=o.slice(c+1).findIndex(J=>J.trim()!=="");if(M===-1)break;if((((i=(n=o[c+1+M].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:i.length)||0)>v){m.push(T),u=`${u}${T}
`,c+=1;continue}else break}if((((a=(s=T.match(/^(\s*)/))==null?void 0:s[1])==null?void 0:a.length)||0)>v)m.push(T),u=`${u}${T}
`,c+=1;else break}let _,b=m.slice(1);if(b.length>0){let T=b.map(P=>P.slice(v+f)).join(`
`);T.trim()&&(e.customNestedParser?_=e.customNestedParser(T):_=t.blockTokens(T))}let w=e.createToken(y,_);l.push(w)}if(l.length!==0)return{items:l,raw:u}}function JR(r,e,t,n){if(!r||!Array.isArray(r.content))return"";let i=typeof t=="function"?t(n):t,[s,...a]=r.content,o=e.renderChildren([s]),l=[`${i}${o}`];return a&&a.length>0&&a.forEach(u=>{let c=e.renderChildren([u]);if(c){let f=c.split(`
`).map(d=>d?e.indent(d):"").join(`
`);l.push(f)}}),l.join(`
`)}function um(r,e,t={}){let{state:n}=e,{doc:i,tr:s}=n,a=r;i.descendants((o,l)=>{let u=s.mapping.map(l),c=s.mapping.map(l)+o.nodeSize,f=null;if(o.marks.forEach(h=>{if(h!==a)return!1;f=h}),!f)return;let d=!1;if(Object.keys(t).forEach(h=>{t[h]!==f.attrs[h]&&(d=!0)}),d){let h=r.type.create({...r.attrs,...t});s.removeMark(u,c,r.type),s.addMark(u,c,h)}}),s.docChanged&&e.view.dispatch(s)}var Ez=class{constructor(r,e,t){this.component=r,this.editor=e.editor,this.options={...t},this.mark=e.mark,this.HTMLAttributes=e.HTMLAttributes}get dom(){return this.editor.view.dom}get contentDOM(){return null}updateAttributes(r,e){um(e||this.mark,this.editor,r)}ignoreMutation(r){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:r}):r.type==="selection"||this.dom.contains(r.target)&&r.type==="childList"&&(ks()||Eu())&&this.editor.isFocused&&[...Array.from(r.addedNodes),...Array.from(r.removedNodes)].every(t=>t.isContentEditable)?!1:this.contentDOM===r.target&&r.type==="attributes"?!0:!this.contentDOM.contains(r.target)}},Sz=class XR extends Cu{constructor(){super(...arguments),this.type="node"}static create(e={}){let t=typeof e=="function"?e():e;return new XR(t)}configure(e){return super.configure(e)}extend(e){let t=typeof e=="function"?e():e;return super.extend(t)}},tR=Pe(),kz=class{constructor(r,e,t){this.isDragging=!1,this.component=r,this.editor=e.editor,this.options={stopEvent:null,ignoreMutation:null,...t},this.extension=e.extension,this.node=e.node,this.decorations=e.decorations,this.innerDecorations=e.innerDecorations,this.view=e.view,this.HTMLAttributes=e.HTMLAttributes,this.getPos=e.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(r){var e,t,n,i,s,a,o;let{view:l}=this.editor,u=r.target,c=u.nodeType===3?(e=u.parentElement)==null?void 0:e.closest("[data-drag-handle]"):u.closest("[data-drag-handle]");if(!this.dom||(t=this.contentDOM)!=null&&t.contains(u)||!c)return;let f=0,d=0;if(this.dom!==c){let _=this.dom.getBoundingClientRect(),b=c.getBoundingClientRect(),w=(i=r.offsetX)!=null?i:(n=r.nativeEvent)==null?void 0:n.offsetX,T=(a=r.offsetY)!=null?a:(s=r.nativeEvent)==null?void 0:s.offsetY;f=b.x-_.x+w,d=b.y-_.y+T}let h=this.dom.cloneNode(!0);try{let _=this.dom.getBoundingClientRect();h.style.width=`${Math.round(_.width)}px`,h.style.height=`${Math.round(_.height)}px`,h.style.boxSizing="border-box",h.style.pointerEvents="none"}catch{}let y=null;try{y=document.createElement("div"),y.style.position="absolute",y.style.top="-9999px",y.style.left="-9999px",y.style.pointerEvents="none",y.appendChild(h),document.body.appendChild(y),(o=r.dataTransfer)==null||o.setDragImage(h,f,d)}finally{y&&setTimeout(()=>{try{y?.remove()}catch{}},0)}let v=this.getPos();if(typeof v!="number")return;let x=tR.NodeSelection.create(l.state.doc,v),m=l.state.tr.setSelection(x);l.dispatch(m)}stopEvent(r){var e;if(!this.dom)return!1;if(typeof this.options.stopEvent=="function")return this.options.stopEvent({event:r});let t=r.target;if(!(this.dom.contains(t)&&!((e=this.contentDOM)!=null&&e.contains(t))))return!1;let i=r.type.startsWith("drag"),s=r.type==="drop";if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(t.tagName)||t.isContentEditable)&&!s&&!i)return!0;let{isEditable:o}=this.editor,{isDragging:l}=this,u=!!this.node.type.spec.draggable,c=tR.NodeSelection.isSelectable(this.node),f=r.type==="copy",d=r.type==="paste",h=r.type==="cut",y=r.type==="mousedown";if(!u&&c&&i&&r.target===this.dom&&r.preventDefault(),u&&i&&!l&&r.target===this.dom)return r.preventDefault(),!1;if(u&&o&&!l&&y){let v=t.closest("[data-drag-handle]");v&&(this.dom===v||this.dom.contains(v))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(l||s||f||d||h||y&&c)}ignoreMutation(r){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:r}):this.node.isLeaf||this.node.isAtom?!0:r.type==="selection"||this.dom.contains(r.target)&&r.type==="childList"&&(ks()||Eu())&&this.editor.isFocused&&[...Array.from(r.addedNodes),...Array.from(r.removedNodes)].every(t=>t.isContentEditable)?!1:this.contentDOM===r.target&&r.type==="attributes"?!0:!this.contentDOM.contains(r.target)}updateAttributes(r){this.editor.commands.command(({tr:e})=>{let t=this.getPos();return typeof t!="number"?!1:(e.setNodeMarkup(t,void 0,{...this.node.attrs,...r}),!0)})}deleteNode(){let r=this.getPos();if(typeof r!="number")return;let e=r+this.node.nodeSize;this.editor.commands.deleteRange({from:r,to:e})}};function Tz(r){return new Iu({find:r.find,handler:({state:e,range:t,match:n,pasteEvent:i})=>{let s=Le(r.getAttributes,void 0,n,i);if(s===!1||s===null)return null;let{tr:a}=e,o=n[n.length-1],l=n[0],u=t.to;if(o){let c=l.search(/\S/),f=t.from+l.indexOf(o),d=f+o.length;if(am(t.from,t.to,e.doc).filter(y=>y.mark.type.excluded.find(x=>x===r.type&&x!==y.mark.type)).filter(y=>y.to>f).length)return null;d<t.to&&a.delete(d,t.to),f>t.from&&a.delete(t.from+c,f),u=t.from+c+o.length,a.addMark(t.from+c,u,r.type.create(s||{})),a.removeStoredMark(r.type)}}})}function Az(r){return new Iu({find:r.find,handler({match:e,chain:t,range:n,pasteEvent:i}){let s=Le(r.getAttributes,void 0,e,i),a=Le(r.getContent,void 0,s);if(s===!1||s===null)return null;let o={type:r.type.name,attrs:s};a&&(o.content=a),e.input&&t().deleteRange(n).insertContentAt(n.from,o)}})}function Oz(r){return new Iu({find:r.find,handler:({state:e,range:t,match:n})=>{let i=r.replace,s=t.from,a=t.to;if(n[1]){let o=n[0].lastIndexOf(n[1]);i+=n[0].slice(o+n[1].length),s+=o;let l=s-a;l>0&&(i=n[0].slice(o-l,o)+i,s=a)}e.tr.insertText(i,s,a)}})}var Nz=class{constructor(r){this.transaction=r,this.currentStep=this.transaction.steps.length}map(r){let e=!1;return{position:this.transaction.steps.slice(this.currentStep).reduce((n,i)=>{let s=i.getMap().mapResult(n);return s.deleted&&(e=!0),s.pos},r),deleted:e}}}});var eC=xe((FQ,QR)=>{"use strict";var cm=Object.defineProperty,Rz=Object.getOwnPropertyDescriptor,Cz=Object.getOwnPropertyNames,Iz=Object.prototype.hasOwnProperty,Pz=(r,e)=>{for(var t in e)cm(r,t,{get:e[t],enumerable:!0})},Dz=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Cz(e))!Iz.call(r,i)&&i!==t&&cm(r,i,{get:()=>e[i],enumerable:!(n=Rz(e,i))||n.enumerable});return r},Mz=r=>Dz(cm({},"__esModule",{value:!0}),r),ZR={};Pz(ZR,{Fragment:()=>Lz,createElement:()=>ta,h:()=>ta,jsx:()=>ta,jsxDEV:()=>ta,jsxs:()=>ta});QR.exports=Mz(ZR);function Lz(r){return r.children}var ta=(r,e)=>{if(r==="slot")return 0;if(r instanceof Function)return r(e);let{children:t,...n}=e??{};if(r==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[r,n,t]}});var fm=xe((BQ,tC)=>{tC.exports=eC()});var aC=xe((UQ,oC)=>{"use strict";var dm=Object.defineProperty,Fz=Object.getOwnPropertyDescriptor,Bz=Object.getOwnPropertyNames,Uz=Object.prototype.hasOwnProperty,Hz=(r,e)=>{for(var t in e)dm(r,t,{get:e[t],enumerable:!0})},zz=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Bz(e))!Uz.call(r,i)&&i!==t&&dm(r,i,{get:()=>e[i],enumerable:!(n=Fz(e,i))||n.enumerable});return r},jz=r=>zz(dm({},"__esModule",{value:!0}),r),nC={};Hz(nC,{Blockquote:()=>sC,default:()=>Wz,inputRegex:()=>iC});oC.exports=jz(nC);var hm=Se(),rC=fm(),iC=/^\s*>\s$/,sC=hm.Node.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:r}){return(0,rC.jsx)("blockquote",{...(0,hm.mergeAttributes)(this.options.HTMLAttributes,r),children:(0,rC.jsx)("slot",{})})},parseMarkdown:(r,e)=>e.createNode("blockquote",void 0,e.parseChildren(r.tokens||[])),renderMarkdown:(r,e)=>{if(!r.content)return"";let t=">",n=[];return r.content.forEach(i=>{let o=e.renderChildren([i]).split(`
`).map(l=>l.trim()===""?t:`${t} ${l}`);n.push(o.join(`
`))}),n.join(`
${t}
`)},addCommands(){return{setBlockquote:()=>({commands:r})=>r.wrapIn(this.name),toggleBlockquote:()=>({commands:r})=>r.toggleWrap(this.name),unsetBlockquote:()=>({commands:r})=>r.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[(0,hm.wrappingInputRule)({find:iC,type:this.type})]}}),Wz=sC});var gC=xe((HQ,mC)=>{"use strict";var pm=Object.defineProperty,qz=Object.getOwnPropertyDescriptor,Vz=Object.getOwnPropertyNames,Kz=Object.prototype.hasOwnProperty,Gz=(r,e)=>{for(var t in e)pm(r,t,{get:e[t],enumerable:!0})},$z=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Vz(e))!Kz.call(r,i)&&i!==t&&pm(r,i,{get:()=>e[i],enumerable:!(n=qz(e,i))||n.enumerable});return r},Jz=r=>$z(pm({},"__esModule",{value:!0}),r),uC={};Gz(uC,{Bold:()=>pC,default:()=>Xz,starInputRegex:()=>cC,starPasteRegex:()=>fC,underscoreInputRegex:()=>hC,underscorePasteRegex:()=>dC});mC.exports=Jz(uC);var As=Se(),lC=fm(),cC=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,fC=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,hC=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,dC=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,pC=As.Mark.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:r=>r.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:r=>r.type.name===this.name},{style:"font-weight",getAttrs:r=>/^(bold(er)?|[5-9]\d{2,})$/.test(r)&&null}]},renderHTML({HTMLAttributes:r}){return(0,lC.jsx)("strong",{...(0,As.mergeAttributes)(this.options.HTMLAttributes,r),children:(0,lC.jsx)("slot",{})})},markdownTokenName:"strong",parseMarkdown:(r,e)=>e.applyMark("bold",e.parseInline(r.tokens||[])),renderMarkdown:(r,e)=>`**${e.renderChildren(r)}**`,addCommands(){return{setBold:()=>({commands:r})=>r.setMark(this.name),toggleBold:()=>({commands:r})=>r.toggleMark(this.name),unsetBold:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[(0,As.markInputRule)({find:cC,type:this.type}),(0,As.markInputRule)({find:hC,type:this.type})]},addPasteRules(){return[(0,As.markPasteRule)({find:fC,type:this.type}),(0,As.markPasteRule)({find:dC,type:this.type})]}}),Xz=pC});var xC=xe((zQ,_C)=>{"use strict";var mm=Object.defineProperty,Yz=Object.getOwnPropertyDescriptor,Zz=Object.getOwnPropertyNames,Qz=Object.prototype.hasOwnProperty,e7=(r,e)=>{for(var t in e)mm(r,t,{get:e[t],enumerable:!0})},t7=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Zz(e))!Qz.call(r,i)&&i!==t&&mm(r,i,{get:()=>e[i],enumerable:!(n=Yz(e,i))||n.enumerable});return r},r7=r=>t7(mm({},"__esModule",{value:!0}),r),vC={};e7(vC,{Code:()=>bC,default:()=>n7,inputRegex:()=>yC,pasteRegex:()=>wC});_C.exports=r7(vC);var Lu=Se(),yC=/(^|[^`])`([^`]+)`(?!`)$/,wC=/(^|[^`])`([^`]+)`(?!`)/g,bC=Lu.Mark.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:r}){return["code",(0,Lu.mergeAttributes)(this.options.HTMLAttributes,r),0]},markdownTokenName:"codespan",parseMarkdown:(r,e)=>e.applyMark("code",[{type:"text",text:r.text||""}]),renderMarkdown:(r,e)=>r.content?`\`${e.renderChildren(r.content)}\``:"",addCommands(){return{setCode:()=>({commands:r})=>r.setMark(this.name),toggleCode:()=>({commands:r})=>r.toggleMark(this.name),unsetCode:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[(0,Lu.markInputRule)({find:yC,type:this.type})]},addPasteRules(){return[(0,Lu.markPasteRule)({find:wC,type:this.type})]}}),n7=bC});var OC=xe((jQ,AC)=>{"use strict";var vm=Object.defineProperty,i7=Object.getOwnPropertyDescriptor,s7=Object.getOwnPropertyNames,o7=Object.prototype.hasOwnProperty,a7=(r,e)=>{for(var t in e)vm(r,t,{get:e[t],enumerable:!0})},l7=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of s7(e))!o7.call(r,i)&&i!==t&&vm(r,i,{get:()=>e[i],enumerable:!(n=i7(e,i))||n.enumerable});return r},u7=r=>l7(vm({},"__esModule",{value:!0}),r),EC={};a7(EC,{CodeBlock:()=>TC,backtickInputRegex:()=>SC,default:()=>c7,tildeInputRegex:()=>kC});AC.exports=u7(EC);var Fu=Se(),ra=Pe(),gm=4,SC=/^```([a-z]+)?[\s\n]$/,kC=/^~~~([a-z]+)?[\s\n]$/,TC=Fu.Node.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:gm,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:r=>{var e;let{languageClassPrefix:t}=this.options;if(!t)return null;let s=[...((e=r.firstElementChild)==null?void 0:e.classList)||[]].filter(a=>a.startsWith(t)).map(a=>a.replace(t,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:r,HTMLAttributes:e}){return["pre",(0,Fu.mergeAttributes)(this.options.HTMLAttributes,e),["code",{class:r.attrs.language?this.options.languageClassPrefix+r.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(r,e)=>{var t;return((t=r.raw)==null?void 0:t.startsWith("```"))===!1&&r.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:r.lang||null},r.text?[e.createTextNode(r.text)]:[])},renderMarkdown:(r,e)=>{var t;let n="",i=((t=r.attrs)==null?void 0:t.language)||"";return r.content?n=[`\`\`\`${i}`,e.renderChildren(r.content),"```"].join(`
`):n=`\`\`\`${i}

\`\`\``,n},addCommands(){return{setCodeBlock:r=>({commands:e})=>e.setNode(this.name,r),toggleCodeBlock:r=>({commands:e})=>e.toggleNode(this.name,"paragraph",r)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{let{empty:r,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!r||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:r})=>{var e;if(!this.options.enableTabIndentation)return!1;let t=(e=this.options.tabSize)!=null?e:gm,{state:n}=r,{selection:i}=n,{$from:s,empty:a}=i;if(s.parent.type!==this.type)return!1;let o=" ".repeat(t);return a?r.commands.insertContent(o):r.commands.command(({tr:l})=>{let{from:u,to:c}=i,h=n.doc.textBetween(u,c,`
`,`
`).split(`
`).map(y=>o+y).join(`
`);return l.replaceWith(u,c,n.schema.text(h)),!0})},"Shift-Tab":({editor:r})=>{var e;if(!this.options.enableTabIndentation)return!1;let t=(e=this.options.tabSize)!=null?e:gm,{state:n}=r,{selection:i}=n,{$from:s,empty:a}=i;return s.parent.type!==this.type?!1:a?r.commands.command(({tr:o})=>{var l;let{pos:u}=s,c=s.start(),f=s.end(),h=n.doc.textBetween(c,f,`
`,`
`).split(`
`),y=0,v=0,x=u-c;for(let P=0;P<h.length;P+=1){if(v+h[P].length>=x){y=P;break}v+=h[P].length+1}let _=((l=h[y].match(/^ */))==null?void 0:l[0])||"",b=Math.min(_.length,t);if(b===0)return!0;let w=c;for(let P=0;P<y;P+=1)w+=h[P].length+1;return o.delete(w,w+b),u-w<=b&&o.setSelection(ra.TextSelection.create(o.doc,w)),!0}):r.commands.command(({tr:o})=>{let{from:l,to:u}=i,d=n.doc.textBetween(l,u,`
`,`
`).split(`
`).map(h=>{var y;let v=((y=h.match(/^ */))==null?void 0:y[0])||"",x=Math.min(v.length,t);return h.slice(x)}).join(`
`);return o.replaceWith(l,u,n.schema.text(d)),!0})},Enter:({editor:r})=>{if(!this.options.exitOnTripleEnter)return!1;let{state:e}=r,{selection:t}=e,{$from:n,empty:i}=t;if(!i||n.parent.type!==this.type)return!1;let s=n.parentOffset===n.parent.nodeSize-2,a=n.parent.textContent.endsWith(`

`);return!s||!a?!1:r.chain().command(({tr:o})=>(o.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:r})=>{if(!this.options.exitOnArrowDown)return!1;let{state:e}=r,{selection:t,doc:n}=e,{$from:i,empty:s}=t;if(!s||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;let o=i.after();return o===void 0?!1:n.nodeAt(o)?r.commands.command(({tr:u})=>(u.setSelection(ra.Selection.near(n.resolve(o))),!0)):r.commands.exitCode()}}},addInputRules(){return[(0,Fu.textblockTypeInputRule)({find:SC,type:this.type,getAttributes:r=>({language:r[1]})}),(0,Fu.textblockTypeInputRule)({find:kC,type:this.type,getAttributes:r=>({language:r[1]})})]},addProseMirrorPlugins(){return[new ra.Plugin({key:new ra.PluginKey("codeBlockVSCodeHandler"),props:{handlePaste:(r,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;let t=e.clipboardData.getData("text/plain"),n=e.clipboardData.getData("vscode-editor-data"),i=n?JSON.parse(n):void 0,s=i?.mode;if(!t||!s)return!1;let{tr:a,schema:o}=r.state,l=o.text(t.replace(/\r\n?/g,`
`));return a.replaceSelectionWith(this.type.create({language:s},l)),a.selection.$from.parent.type!==this.type&&a.setSelection(ra.TextSelection.near(a.doc.resolve(Math.max(0,a.selection.from-2)))),a.setMeta("paste",!0),r.dispatch(a),!0}}})]}}),c7=TC});var IC=xe((WQ,CC)=>{"use strict";var ym=Object.defineProperty,f7=Object.getOwnPropertyDescriptor,h7=Object.getOwnPropertyNames,d7=Object.prototype.hasOwnProperty,p7=(r,e)=>{for(var t in e)ym(r,t,{get:e[t],enumerable:!0})},m7=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of h7(e))!d7.call(r,i)&&i!==t&&ym(r,i,{get:()=>e[i],enumerable:!(n=f7(e,i))||n.enumerable});return r},g7=r=>m7(ym({},"__esModule",{value:!0}),r),NC={};p7(NC,{Document:()=>RC,default:()=>y7});CC.exports=g7(NC);var v7=Se(),RC=v7.Node.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(r,e)=>r.content?e.renderChildren(r.content,`

`):""}),y7=RC});var FC=xe((qQ,LC)=>{"use strict";var wm=Object.defineProperty,w7=Object.getOwnPropertyDescriptor,b7=Object.getOwnPropertyNames,_7=Object.prototype.hasOwnProperty,x7=(r,e)=>{for(var t in e)wm(r,t,{get:e[t],enumerable:!0})},E7=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of b7(e))!_7.call(r,i)&&i!==t&&wm(r,i,{get:()=>e[i],enumerable:!(n=w7(e,i))||n.enumerable});return r},S7=r=>E7(wm({},"__esModule",{value:!0}),r),DC={};x7(DC,{HardBreak:()=>MC,default:()=>k7});LC.exports=S7(DC);var PC=Se(),MC=PC.Node.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:r}){return["br",(0,PC.mergeAttributes)(this.options.HTMLAttributes,r)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:r,chain:e,state:t,editor:n})=>r.first([()=>r.exitCode(),()=>r.command(()=>{let{selection:i,storedMarks:s}=t;if(i.$from.parent.type.spec.isolating)return!1;let{keepMarks:a}=this.options,{splittableMarks:o}=n.extensionManager,l=s||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:u,dispatch:c})=>{if(c&&l&&a){let f=l.filter(d=>o.includes(d.type.name));u.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),k7=MC});var xm=xe((VQ,HC)=>{"use strict";var _m=Object.defineProperty,T7=Object.getOwnPropertyDescriptor,A7=Object.getOwnPropertyNames,O7=Object.prototype.hasOwnProperty,N7=(r,e)=>{for(var t in e)_m(r,t,{get:e[t],enumerable:!0})},R7=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of A7(e))!O7.call(r,i)&&i!==t&&_m(r,i,{get:()=>e[i],enumerable:!(n=T7(e,i))||n.enumerable});return r},C7=r=>R7(_m({},"__esModule",{value:!0}),r),BC={};N7(BC,{Heading:()=>UC,default:()=>I7});HC.exports=C7(BC);var bm=Se(),UC=bm.Node.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(r=>({tag:`h${r}`,attrs:{level:r}}))},renderHTML({node:r,HTMLAttributes:e}){return[`h${this.options.levels.includes(r.attrs.level)?r.attrs.level:this.options.levels[0]}`,(0,bm.mergeAttributes)(this.options.HTMLAttributes,e),0]},parseMarkdown:(r,e)=>e.createNode("heading",{level:r.depth||1},e.parseInline(r.tokens||[])),renderMarkdown:(r,e)=>{var t;let n=(t=r.attrs)!=null&&t.level?parseInt(r.attrs.level,10):1,i="#".repeat(n);return r.content?`${i} ${e.renderChildren(r.content)}`:""},addCommands(){return{setHeading:r=>({commands:e})=>this.options.levels.includes(r.level)?e.setNode(this.name,r):!1,toggleHeading:r=>({commands:e})=>this.options.levels.includes(r.level)?e.toggleNode(this.name,"paragraph",r):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((r,e)=>({...r,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(r=>(0,bm.textblockTypeInputRule)({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${r}})\\s$`),type:this.type,getAttributes:{level:r}}))}}),I7=UC});var qC=xe((KQ,WC)=>{"use strict";var Em=Object.defineProperty,P7=Object.getOwnPropertyDescriptor,D7=Object.getOwnPropertyNames,M7=Object.prototype.hasOwnProperty,L7=(r,e)=>{for(var t in e)Em(r,t,{get:e[t],enumerable:!0})},F7=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of D7(e))!M7.call(r,i)&&i!==t&&Em(r,i,{get:()=>e[i],enumerable:!(n=P7(e,i))||n.enumerable});return r},B7=r=>F7(Em({},"__esModule",{value:!0}),r),zC={};L7(zC,{HorizontalRule:()=>jC,default:()=>U7});WC.exports=B7(zC);var na=Se(),Bu=Pe(),jC=na.Node.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:r}){return["hr",(0,na.mergeAttributes)(this.options.HTMLAttributes,r)]},markdownTokenName:"hr",parseMarkdown:(r,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:r,state:e})=>{if(!(0,na.canInsertNode)(e,e.schema.nodes[this.name]))return!1;let{selection:t}=e,{$to:n}=t,i=r();return(0,na.isNodeSelection)(t)?i.insertContentAt(n.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:s,tr:a,dispatch:o})=>{if(o){let{$to:l}=a.selection,u=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?a.setSelection(Bu.TextSelection.create(a.doc,l.pos+1)):l.nodeAfter.isBlock?a.setSelection(Bu.NodeSelection.create(a.doc,l.pos)):a.setSelection(Bu.TextSelection.create(a.doc,l.pos));else{let c=s.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,f=c?.create();f&&(a.insert(u,f),a.setSelection(Bu.TextSelection.create(a.doc,u+1)))}a.scrollIntoView()}return!0}).run()}}},addInputRules(){return[(0,na.nodeInputRule)({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),U7=jC});var ZC=xe((GQ,YC)=>{"use strict";var Sm=Object.defineProperty,H7=Object.getOwnPropertyDescriptor,z7=Object.getOwnPropertyNames,j7=Object.prototype.hasOwnProperty,W7=(r,e)=>{for(var t in e)Sm(r,t,{get:e[t],enumerable:!0})},q7=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of z7(e))!j7.call(r,i)&&i!==t&&Sm(r,i,{get:()=>e[i],enumerable:!(n=H7(e,i))||n.enumerable});return r},V7=r=>q7(Sm({},"__esModule",{value:!0}),r),VC={};W7(VC,{Italic:()=>XC,default:()=>K7,starInputRegex:()=>KC,starPasteRegex:()=>GC,underscoreInputRegex:()=>$C,underscorePasteRegex:()=>JC});YC.exports=V7(VC);var Os=Se(),KC=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,GC=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,$C=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,JC=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,XC=Os.Mark.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:r=>r.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:r=>r.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:r}){return["em",(0,Os.mergeAttributes)(this.options.HTMLAttributes,r),0]},addCommands(){return{setItalic:()=>({commands:r})=>r.setMark(this.name),toggleItalic:()=>({commands:r})=>r.toggleMark(this.name),unsetItalic:()=>({commands:r})=>r.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(r,e)=>e.applyMark("italic",e.parseInline(r.tokens||[])),renderMarkdown:(r,e)=>`*${e.renderChildren(r)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[(0,Os.markInputRule)({find:KC,type:this.type}),(0,Os.markInputRule)({find:$C,type:this.type})]},addPasteRules(){return[(0,Os.markPasteRule)({find:GC,type:this.type}),(0,Os.markPasteRule)({find:JC,type:this.type})]}}),K7=XC});var yc=xe(gt=>{"use strict";var G7="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5m\xF6gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",$7="\u03B5\u03BB1\u03C52\u0431\u04331\u0435\u043B3\u0434\u0435\u0442\u04384\u0435\u044E2\u043A\u0430\u0442\u043E\u043B\u0438\u043A6\u043E\u043C3\u043C\u043A\u04342\u043E\u043D1\u0441\u043A\u0432\u04306\u043E\u043D\u043B\u0430\u0439\u043D5\u0440\u04333\u0440\u0443\u04412\u04442\u0441\u0430\u0439\u04423\u0440\u04313\u0443\u043A\u04403\u049B\u0430\u04373\u0570\u0561\u05753\u05D9\u05E9\u05E8\u05D0\u05DC5\u05E7\u05D5\u05DD3\u0627\u0628\u0648\u0638\u0628\u064A5\u0631\u0627\u0645\u0643\u06485\u0644\u0627\u0631\u062F\u06464\u0628\u062D\u0631\u064A\u06465\u062C\u0632\u0627\u0626\u06315\u0633\u0639\u0648\u062F\u064A\u06296\u0639\u0644\u064A\u0627\u06465\u0645\u063A\u0631\u06285\u0645\u0627\u0631\u0627\u062A5\u06CC\u0631\u0627\u06465\u0628\u0627\u0631\u062A2\u0632\u0627\u06314\u064A\u062A\u06433\u06BE\u0627\u0631\u062A5\u062A\u0648\u0646\u06334\u0633\u0648\u062F\u0627\u06463\u0631\u064A\u06295\u0634\u0628\u0643\u06294\u0639\u0631\u0627\u06422\u06282\u0645\u0627\u06464\u0641\u0644\u0633\u0637\u064A\u06466\u0642\u0637\u06313\u0643\u0627\u062B\u0648\u0644\u064A\u06436\u0648\u06453\u0645\u0635\u06312\u0644\u064A\u0633\u064A\u06275\u0648\u0631\u064A\u062A\u0627\u0646\u064A\u06277\u0642\u06394\u0647\u0645\u0631\u0627\u06475\u067E\u0627\u06A9\u0633\u062A\u0627\u06467\u0680\u0627\u0631\u062A4\u0915\u0949\u092E3\u0928\u0947\u091F3\u092D\u093E\u0930\u09240\u092E\u094D3\u094B\u09245\u0938\u0902\u0917\u0920\u09285\u09AC\u09BE\u0982\u09B2\u09BE5\u09AD\u09BE\u09B0\u09A42\u09F0\u09A44\u0A2D\u0A3E\u0A30\u0A244\u0AAD\u0ABE\u0AB0\u0AA44\u0B2D\u0B3E\u0B30\u0B244\u0B87\u0BA8\u0BCD\u0BA4\u0BBF\u0BAF\u0BBE6\u0BB2\u0B99\u0BCD\u0B95\u0BC86\u0B9A\u0BBF\u0B99\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0BC2\u0BB0\u0BCD11\u0C2D\u0C3E\u0C30\u0C24\u0C4D5\u0CAD\u0CBE\u0CB0\u0CA44\u0D2D\u0D3E\u0D30\u0D24\u0D025\u0DBD\u0D82\u0D9A\u0DCF4\u0E04\u0E2D\u0E213\u0E44\u0E17\u0E223\u0EA5\u0EB2\u0EA73\u10D2\u10D42\u307F\u3093\u306A3\u30A2\u30DE\u30BE\u30F34\u30AF\u30E9\u30A6\u30C94\u30B0\u30FC\u30B0\u30EB4\u30B3\u30E02\u30B9\u30C8\u30A23\u30BB\u30FC\u30EB3\u30D5\u30A1\u30C3\u30B7\u30E7\u30F36\u30DD\u30A4\u30F3\u30C84\u4E16\u754C2\u4E2D\u4FE11\u56FD1\u570B1\u6587\u7F513\u4E9A\u9A6C\u900A3\u4F01\u4E1A2\u4F5B\u5C712\u4FE1\u606F2\u5065\u5EB72\u516B\u53662\u516C\u53F81\u76CA2\u53F0\u6E7E1\u70632\u5546\u57CE1\u5E971\u68072\u5609\u91CC0\u5927\u9152\u5E975\u5728\u7EBF2\u5927\u62FF2\u5929\u4E3B\u65593\u5A31\u4E502\u5BB6\u96FB2\u5E7F\u4E1C2\u5FAE\u535A2\u6148\u55842\u6211\u7231\u4F603\u624B\u673A2\u62DB\u80582\u653F\u52A11\u5E9C2\u65B0\u52A0\u57612\u95FB2\u65F6\u5C1A2\u66F8\u7C4D2\u673A\u67842\u6DE1\u9A6C\u95213\u6E38\u620F2\u6FB3\u95802\u70B9\u770B2\u79FB\u52A82\u7EC4\u7EC7\u673A\u67844\u7F51\u57401\u5E971\u7AD91\u7EDC2\u8054\u901A2\u8C37\u6B4C2\u8D2D\u72692\u901A\u8CA92\u96C6\u56E22\u96FB\u8A0A\u76C8\u79D14\u98DE\u5229\u6D663\u98DF\u54C12\u9910\u53852\u9999\u683C\u91CC\u62C93\u6E2F2\uB2F7\uB1371\uCEF42\uC0BC\uC1312\uD55C\uAD6D2",Nm="numeric",Rm="ascii",Cm="alpha",oa="asciinumeric",ia="alphanumeric",Im="domain",nI="emoji",J7="scheme",X7="slashscheme",km="whitespace";function Y7(r,e){return r in e||(e[r]=[]),e[r]}function Ai(r,e,t){e[Nm]&&(e[oa]=!0,e[ia]=!0),e[Rm]&&(e[oa]=!0,e[Cm]=!0),e[oa]&&(e[ia]=!0),e[Cm]&&(e[ia]=!0),e[ia]&&(e[Im]=!0),e[nI]&&(e[Im]=!0);for(let n in e){let i=Y7(n,t);i.indexOf(r)<0&&i.push(r)}}function Z7(r,e){let t={};for(let n in e)e[n].indexOf(r)>=0&&(t[n]=!0);return t}function Bt(r=null){this.j={},this.jr=[],this.jd=null,this.t=r}Bt.groups={};Bt.prototype={accepts(){return!!this.t},go(r){let e=this,t=e.j[r];if(t)return t;for(let n=0;n<e.jr.length;n++){let i=e.jr[n][0],s=e.jr[n][1];if(s&&i.test(r))return s}return e.jd},has(r,e=!1){return e?r in this.j:!!this.go(r)},ta(r,e,t,n){for(let i=0;i<r.length;i++)this.tt(r[i],e,t,n)},tr(r,e,t,n){n=n||Bt.groups;let i;return e&&e.j?i=e:(i=new Bt(e),t&&n&&Ai(e,t,n)),this.jr.push([r,i]),i},ts(r,e,t,n){let i=this,s=r.length;if(!s)return i;for(let a=0;a<s-1;a++)i=i.tt(r[a]);return i.tt(r[s-1],e,t,n)},tt(r,e,t,n){n=n||Bt.groups;let i=this;if(e&&e.j)return i.j[r]=e,e;let s=e,a,o=i.go(r);if(o?(a=new Bt,Object.assign(a.j,o.j),a.jr.push.apply(a.jr,o.jr),a.jd=o.jd,a.t=o.t):a=new Bt,s){if(n)if(a.t&&typeof a.t=="string"){let l=Object.assign(Z7(a.t,n),t);Ai(s,l,n)}else t&&Ai(s,t,n);a.t=s}return i.j[r]=a,a}};var Ne=(r,e,t,n,i)=>r.ta(e,t,n,i),Ze=(r,e,t,n,i)=>r.tr(e,t,n,i),QC=(r,e,t,n,i)=>r.ts(e,t,n,i),ye=(r,e,t,n,i)=>r.tt(e,t,n,i),wn="WORD",Pm="UWORD",iI="ASCIINUMERICAL",sI="ALPHANUMERICAL",ha="LOCALHOST",Dm="TLD",Mm="UTLD",zu="SCHEME",Ns="SLASH_SCHEME",Um="NUM",Lm="WS",Hm="NL",aa="OPENBRACE",la="CLOSEBRACE",qu="OPENBRACKET",Vu="CLOSEBRACKET",Ku="OPENPAREN",Gu="CLOSEPAREN",$u="OPENANGLEBRACKET",Ju="CLOSEANGLEBRACKET",Xu="FULLWIDTHLEFTPAREN",Yu="FULLWIDTHRIGHTPAREN",Zu="LEFTCORNERBRACKET",Qu="RIGHTCORNERBRACKET",ec="LEFTWHITECORNERBRACKET",tc="RIGHTWHITECORNERBRACKET",rc="FULLWIDTHLESSTHAN",nc="FULLWIDTHGREATERTHAN",ic="AMPERSAND",sc="APOSTROPHE",oc="ASTERISK",Gn="AT",ac="BACKSLASH",lc="BACKTICK",uc="CARET",$n="COLON",zm="COMMA",cc="DOLLAR",Fr="DOT",fc="EQUALS",jm="EXCLAMATION",or="HYPHEN",ua="PERCENT",hc="PIPE",dc="PLUS",pc="POUND",ca="QUERY",Wm="QUOTE",oI="FULLWIDTHMIDDLEDOT",qm="SEMI",Br="SLASH",fa="TILDE",mc="UNDERSCORE",aI="EMOJI",gc="SYM",lI=Object.freeze({__proto__:null,ALPHANUMERICAL:sI,AMPERSAND:ic,APOSTROPHE:sc,ASCIINUMERICAL:iI,ASTERISK:oc,AT:Gn,BACKSLASH:ac,BACKTICK:lc,CARET:uc,CLOSEANGLEBRACKET:Ju,CLOSEBRACE:la,CLOSEBRACKET:Vu,CLOSEPAREN:Gu,COLON:$n,COMMA:zm,DOLLAR:cc,DOT:Fr,EMOJI:aI,EQUALS:fc,EXCLAMATION:jm,FULLWIDTHGREATERTHAN:nc,FULLWIDTHLEFTPAREN:Xu,FULLWIDTHLESSTHAN:rc,FULLWIDTHMIDDLEDOT:oI,FULLWIDTHRIGHTPAREN:Yu,HYPHEN:or,LEFTCORNERBRACKET:Zu,LEFTWHITECORNERBRACKET:ec,LOCALHOST:ha,NL:Hm,NUM:Um,OPENANGLEBRACKET:$u,OPENBRACE:aa,OPENBRACKET:qu,OPENPAREN:Ku,PERCENT:ua,PIPE:hc,PLUS:dc,POUND:pc,QUERY:ca,QUOTE:Wm,RIGHTCORNERBRACKET:Qu,RIGHTWHITECORNERBRACKET:tc,SCHEME:zu,SEMI:qm,SLASH:Br,SLASH_SCHEME:Ns,SYM:gc,TILDE:fa,TLD:Dm,UNDERSCORE:mc,UTLD:Mm,UWORD:Pm,WORD:wn,WS:Lm}),Mr=/[a-z]/,Rs=/\p{L}/u,ju=/\p{Emoji}/u,Q7=/\ufe0f/,Lr=/\d/,Wu=/\s/,ej=Object.freeze({__proto__:null,ASCII_LETTER:Mr,DIGIT:Lr,EMOJI:ju,EMOJI_VARIATION:Q7,LETTER:Rs,SPACE:Wu}),eI="\r",Tm=`
`,tj="\uFE0F",rj="\u200D",Am="\uFFFC",Uu=null,Hu=null;function nj(r=[]){let e={};Bt.groups=e;let t=new Bt;Uu==null&&(Uu=tI(G7)),Hu==null&&(Hu=tI($7)),ye(t,"'",sc),ye(t,"{",aa),ye(t,"}",la),ye(t,"[",qu),ye(t,"]",Vu),ye(t,"(",Ku),ye(t,")",Gu),ye(t,"<",$u),ye(t,">",Ju),ye(t,"\uFF08",Xu),ye(t,"\uFF09",Yu),ye(t,"\u300C",Zu),ye(t,"\u300D",Qu),ye(t,"\u300E",ec),ye(t,"\u300F",tc),ye(t,"\uFF1C",rc),ye(t,"\uFF1E",nc),ye(t,"&",ic),ye(t,"*",oc),ye(t,"@",Gn),ye(t,"`",lc),ye(t,"^",uc),ye(t,":",$n),ye(t,",",zm),ye(t,"$",cc),ye(t,".",Fr),ye(t,"=",fc),ye(t,"!",jm),ye(t,"-",or),ye(t,"%",ua),ye(t,"|",hc),ye(t,"+",dc),ye(t,"#",pc),ye(t,"?",ca),ye(t,'"',Wm),ye(t,"/",Br),ye(t,";",qm),ye(t,"~",fa),ye(t,"_",mc),ye(t,"\\",ac),ye(t,"\u30FB",oI);let n=Ze(t,Lr,Um,{[Nm]:!0});Ze(n,Lr,n);let i=Ze(n,Mr,iI,{[oa]:!0}),s=Ze(n,Rs,sI,{[ia]:!0}),a=Ze(t,Mr,wn,{[Rm]:!0});Ze(a,Lr,i),Ze(a,Mr,a),Ze(i,Lr,i),Ze(i,Mr,i);let o=Ze(t,Rs,Pm,{[Cm]:!0});Ze(o,Mr),Ze(o,Lr,s),Ze(o,Rs,o),Ze(s,Lr,s),Ze(s,Mr),Ze(s,Rs,s);let l=ye(t,Tm,Hm,{[km]:!0}),u=ye(t,eI,Lm,{[km]:!0}),c=Ze(t,Wu,Lm,{[km]:!0});ye(t,Am,c),ye(u,Tm,l),ye(u,Am,c),Ze(u,Wu,c),ye(c,eI),ye(c,Tm),Ze(c,Wu,c),ye(c,Am,c);let f=Ze(t,ju,aI,{[nI]:!0});ye(f,"#"),Ze(f,ju,f),ye(f,tj,f);let d=ye(f,rj);ye(d,"#"),Ze(d,ju,f);let h=[[Mr,a],[Lr,i]],y=[[Mr,null],[Rs,o],[Lr,s]];for(let v=0;v<Uu.length;v++)Kn(t,Uu[v],Dm,wn,h);for(let v=0;v<Hu.length;v++)Kn(t,Hu[v],Mm,Pm,y);Ai(Dm,{tld:!0,ascii:!0},e),Ai(Mm,{utld:!0,alpha:!0},e),Kn(t,"file",zu,wn,h),Kn(t,"mailto",zu,wn,h),Kn(t,"http",Ns,wn,h),Kn(t,"https",Ns,wn,h),Kn(t,"ftp",Ns,wn,h),Kn(t,"ftps",Ns,wn,h),Ai(zu,{scheme:!0,ascii:!0},e),Ai(Ns,{slashscheme:!0,ascii:!0},e),r=r.sort((v,x)=>v[0]>x[0]?1:-1);for(let v=0;v<r.length;v++){let x=r[v][0],_=r[v][1]?{[J7]:!0}:{[X7]:!0};x.indexOf("-")>=0?_[Im]=!0:Mr.test(x)?Lr.test(x)?_[oa]=!0:_[Rm]=!0:_[Nm]=!0,QC(t,x,x,_)}return QC(t,"localhost",ha,{ascii:!0}),t.jd=new Bt(gc),{start:t,tokens:Object.assign({groups:e},lI)}}function uI(r,e){let t=cI(e.replace(/[A-Z]/g,o=>o.toLowerCase())),n=t.length,i=[],s=0,a=0;for(;a<n;){let o=r,l=null,u=0,c=null,f=-1,d=-1;for(;a<n&&(l=o.go(t[a]));)o=l,o.accepts()?(f=0,d=0,c=o):f>=0&&(f+=t[a].length,d++),u+=t[a].length,s+=t[a].length,a++;s-=f,a-=d,u-=f,i.push({t:c.t,v:e.slice(s-u,s),s:s-u,e:s})}return i}function cI(r){let e=[],t=r.length,n=0;for(;n<t;){let i=r.charCodeAt(n),s,a=i<55296||i>56319||n+1===t||(s=r.charCodeAt(n+1))<56320||s>57343?r[n]:r.slice(n,n+2);e.push(a),n+=a.length}return e}function Kn(r,e,t,n,i){let s,a=e.length;for(let o=0;o<a-1;o++){let l=e[o];r.j[l]?s=r.j[l]:(s=new Bt(n),s.jr=i.slice(),r.j[l]=s),r=s}return s=new Bt(t),s.jr=i.slice(),r.j[e[a-1]]=s,s}function tI(r){let e=[],t=[],n=0,i="0123456789";for(;n<r.length;){let s=0;for(;i.indexOf(r[n+s])>=0;)s++;if(s>0){e.push(t.join(""));for(let a=parseInt(r.substring(n,n+s),10);a>0;a--)t.pop();n+=s}else t.push(r[n]),n++}return e}var Cs={defaultProtocol:"http",events:null,format:rI,formatHref:rI,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function ma(r,e=null){let t=Object.assign({},Cs);r&&(t=Object.assign(t,r instanceof ma?r.o:r));let n=t.ignoreTags,i=[];for(let s=0;s<n.length;s++)i.push(n[s].toUpperCase());this.o=t,e&&(this.defaultRender=e),this.ignoreTags=i}ma.prototype={o:Cs,ignoreTags:[],defaultRender(r){return r},check(r){return this.get("validate",r.toString(),r)},get(r,e,t){let n=e!=null,i=this.o[r];return i&&(typeof i=="object"?(i=t.t in i?i[t.t]:Cs[r],typeof i=="function"&&n&&(i=i(e,t))):typeof i=="function"&&n&&(i=i(e,t.t,t)),i)},getObj(r,e,t){let n=this.o[r];return typeof n=="function"&&e!=null&&(n=n(e,t.t,t)),n},render(r){let e=r.render(this);return(this.get("render",null,r)||this.defaultRender)(e,r.t,r)}};function rI(r){return r}var ij=Object.freeze({__proto__:null,Options:ma,defaults:Cs});function da(r,e){this.t="token",this.v=r,this.tk=e}da.prototype={isLink:!1,toString(){return this.v},toHref(r){return this.toString()},toFormattedString(r){let e=this.toString(),t=r.get("truncate",e,this),n=r.get("format",e,this);return t&&n.length>t?n.substring(0,t)+"\u2026":n},toFormattedHref(r){return r.get("formatHref",this.toHref(r.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(r=Cs.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(r),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(r){return{type:this.t,value:this.toFormattedString(r),isLink:this.isLink,href:this.toFormattedHref(r),start:this.startIndex(),end:this.endIndex()}},validate(r){return r.get("validate",this.toString(),this)},render(r){let e=this,t=this.toHref(r.get("defaultProtocol")),n=r.get("formatHref",t,this),i=r.get("tagName",t,e),s=this.toFormattedString(r),a={},o=r.get("className",t,e),l=r.get("target",t,e),u=r.get("rel",t,e),c=r.getObj("attributes",t,e),f=r.getObj("events",t,e);return a.href=n,o&&(a.class=o),l&&(a.target=l),u&&(a.rel=u),c&&Object.assign(a,c),{tagName:i,attributes:a,content:s,eventListeners:f}}};function Is(r,e){class t extends da{constructor(i,s){super(i,s),this.t=r}}for(let n in e)t.prototype[n]=e[n];return t.t=r,t}var Fm=Is("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Bm=Is("text"),fI=Is("nl"),sa=Is("url",{isLink:!0,toHref(r=Cs.defaultProtocol){return this.hasProtocol()?this.v:`${r}://${this.v}`},hasProtocol(){let r=this.tk;return r.length>=2&&r[0].t!==ha&&r[1].t===$n}}),hI=Object.freeze({__proto__:null,Base:da,Email:Fm,MultiToken:da,Nl:fI,Text:Bm,Url:sa,createTokenClass:Is}),sr=r=>new Bt(r);function sj({groups:r}){let e=r.domain.concat([ic,oc,Gn,ac,lc,uc,cc,fc,or,Um,ua,hc,dc,pc,Br,gc,fa,mc]),t=[sc,$n,zm,Fr,jm,ua,ca,Wm,qm,$u,Ju,aa,la,Vu,qu,Ku,Gu,Xu,Yu,Zu,Qu,ec,tc,rc,nc],n=[ic,sc,oc,ac,lc,uc,cc,fc,or,aa,la,ua,hc,dc,pc,ca,Br,gc,fa,mc],i=sr(),s=ye(i,fa);Ne(s,n,s),Ne(s,r.domain,s);let a=sr(),o=sr(),l=sr();Ne(i,r.domain,a),Ne(i,r.scheme,o),Ne(i,r.slashscheme,l),Ne(a,n,s),Ne(a,r.domain,a);let u=ye(a,Gn);ye(s,Gn,u),ye(o,Gn,u),ye(l,Gn,u);let c=ye(s,Fr);Ne(c,n,s),Ne(c,r.domain,s);let f=sr();Ne(u,r.domain,f),Ne(f,r.domain,f);let d=ye(f,Fr);Ne(d,r.domain,f);let h=sr(Fm);Ne(d,r.tld,h),Ne(d,r.utld,h),ye(u,ha,h);let y=ye(f,or);ye(y,or,y),Ne(y,r.domain,f),Ne(h,r.domain,f),ye(h,Fr,d),ye(h,or,y);let v=ye(h,$n);Ne(v,r.numeric,Fm);let x=ye(a,or),m=ye(a,Fr);ye(x,or,x),Ne(x,r.domain,a),Ne(m,n,s),Ne(m,r.domain,a);let _=sr(sa);Ne(m,r.tld,_),Ne(m,r.utld,_),Ne(_,r.domain,a),Ne(_,n,s),ye(_,Fr,m),ye(_,or,x),ye(_,Gn,u);let b=ye(_,$n),w=sr(sa);Ne(b,r.numeric,w);let T=sr(sa),P=sr();Ne(T,e,T),Ne(T,t,P),Ne(P,e,T),Ne(P,t,P),ye(_,Br,T),ye(w,Br,T);let M=ye(o,$n),U=ye(l,$n),R=ye(U,Br),J=ye(R,Br);Ne(o,r.domain,a),ye(o,Fr,m),ye(o,or,x),Ne(l,r.domain,a),ye(l,Fr,m),ye(l,or,x),Ne(M,r.domain,T),ye(M,Br,T),ye(M,ca,T),Ne(J,r.domain,T),Ne(J,e,T),ye(J,Br,T);let oe=[[aa,la],[qu,Vu],[Ku,Gu],[$u,Ju],[Xu,Yu],[Zu,Qu],[ec,tc],[rc,nc]];for(let C=0;C<oe.length;C++){let[H,k]=oe[C],V=ye(T,H);ye(P,H,V),ye(V,k,T);let Q=sr(sa);Ne(V,e,Q);let j=sr();Ne(V,t),Ne(Q,e,Q),Ne(Q,t,j),Ne(j,e,Q),Ne(j,t,j),ye(Q,k,T),ye(j,k,T)}return ye(i,ha,_),ye(i,Hm,fI),{start:i,tokens:lI}}function oj(r,e,t){let n=t.length,i=0,s=[],a=[];for(;i<n;){let o=r,l=null,u=null,c=0,f=null,d=-1;for(;i<n&&!(l=o.go(t[i].t));)a.push(t[i++]);for(;i<n&&(u=l||o.go(t[i].t));)l=null,o=u,o.accepts()?(d=0,f=o):d>=0&&d++,i++,c++;if(d<0)i-=c,i<n&&(a.push(t[i]),i++);else{a.length>0&&(s.push(Om(Bm,e,a)),a=[]),i-=d,c-=d;let h=f.t,y=t.slice(i-c,i);s.push(Om(h,e,y))}}return a.length>0&&s.push(Om(Bm,e,a)),s}function Om(r,e,t){let n=t[0].s,i=t[t.length-1].e,s=e.slice(n,i);return new r(s,t)}var pa=typeof console<"u"&&console&&console.warn||(()=>{}),Vm="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",De={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function aj(){return Bt.groups={},De.scanner=null,De.parser=null,De.tokenQueue=[],De.pluginQueue=[],De.customSchemes=[],De.initialized=!1,De}function lj(r,e){if(typeof e!="function")throw new Error(`linkifyjs: Invalid token plugin ${e} (expects function)`);for(let t=0;t<De.tokenQueue.length;t++)if(r===De.tokenQueue[t][0]){pa(`linkifyjs: token plugin "${r}" already registered - will be overwritten`),De.tokenQueue[t]=[r,e];return}De.tokenQueue.push([r,e]),De.initialized&&pa(`linkifyjs: already initialized - will not register token plugin "${r}" ${Vm}`)}function uj(r,e){if(typeof e!="function")throw new Error(`linkifyjs: Invalid plugin ${e} (expects function)`);for(let t=0;t<De.pluginQueue.length;t++)if(r===De.pluginQueue[t][0]){pa(`linkifyjs: plugin "${r}" already registered - will be overwritten`),De.pluginQueue[t]=[r,e];return}De.pluginQueue.push([r,e]),De.initialized&&pa(`linkifyjs: already initialized - will not register plugin "${r}" ${Vm}`)}function cj(r,e=!1){if(De.initialized&&pa(`linkifyjs: already initialized - will not register custom scheme "${r}" ${Vm}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(r))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);De.customSchemes.push([r,e])}function dI(){De.scanner=nj(De.customSchemes);for(let r=0;r<De.tokenQueue.length;r++)De.tokenQueue[r][1]({scanner:De.scanner});De.parser=sj(De.scanner.tokens);for(let r=0;r<De.pluginQueue.length;r++)De.pluginQueue[r][1]({scanner:De.scanner,parser:De.parser});return De.initialized=!0,De}function vc(r){return De.initialized||dI(),oj(De.parser.start,r,uI(De.scanner.start,r))}vc.scan=uI;function fj(r,e=null,t=null){if(e&&typeof e=="object"){if(t)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);t=e,e=null}let n=new ma(t),i=vc(r),s=[];for(let a=0;a<i.length;a++){let o=i[a];o.isLink&&(!e||o.t===e)&&n.check(o)&&s.push(o.toFormattedObject(n))}return s}function hj(r,e=null){let t=vc(r);return t.length===1&&t[0].isLink&&(!e||t[0].t===e)}gt.MultiToken=da;gt.Options=ma;gt.State=Bt;gt.createTokenClass=Is;gt.find=fj;gt.init=dI;gt.multi=hI;gt.options=ij;gt.regexp=ej;gt.registerCustomProtocol=cj;gt.registerPlugin=uj;gt.registerTokenPlugin=lj;gt.reset=aj;gt.stringToArray=cI;gt.test=hj;gt.text=hI;gt.tokenize=vc});var bI=xe((JQ,wI)=>{"use strict";var Km=Object.defineProperty,dj=Object.getOwnPropertyDescriptor,pj=Object.getOwnPropertyNames,mj=Object.prototype.hasOwnProperty,gj=(r,e)=>{for(var t in e)Km(r,t,{get:e[t],enumerable:!0})},vj=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of pj(e))!mj.call(r,i)&&i!==t&&Km(r,i,{get:()=>e[i],enumerable:!(n=dj(e,i))||n.enumerable});return r},yj=r=>vj(Km({},"__esModule",{value:!0}),r),vI={};gj(vI,{Link:()=>yI,default:()=>Rj,isAllowedUri:()=>Jn,pasteRegex:()=>Nj});wI.exports=yj(vI);var wc=Se(),bc=yc(),_c=Se(),pI=Pe(),wj=yc(),Gm="[\0- \xA0\u1680\u180E\u2000-\u2029\u205F\u3000]",bj=new RegExp(Gm),_j=new RegExp(`${Gm}$`),xj=new RegExp(Gm,"g");function Ej(r){return r.length===1?r[0].isLink:r.length===3&&r[1].isLink?["()","[]"].includes(r[0].value+r[2].value):!1}function Sj(r){return new pI.Plugin({key:new pI.PluginKey("autolink"),appendTransaction:(e,t,n)=>{let i=e.some(u=>u.docChanged)&&!t.doc.eq(n.doc),s=e.some(u=>u.getMeta("preventAutolink"));if(!i||s)return;let{tr:a}=n,o=(0,_c.combineTransactionSteps)(t.doc,[...e]);if((0,_c.getChangedRanges)(o).forEach(({newRange:u})=>{let c=(0,_c.findChildrenInRange)(n.doc,u,h=>h.isTextblock),f,d;if(c.length>1)f=c[0],d=n.doc.textBetween(f.pos,f.pos+f.node.nodeSize,void 0," ");else if(c.length){let h=n.doc.textBetween(u.from,u.to," "," ");if(!_j.test(h))return;f=c[0],d=n.doc.textBetween(f.pos,u.to,void 0," ")}if(f&&d){let h=d.split(bj).filter(Boolean);if(h.length<=0)return!1;let y=h[h.length-1],v=f.pos+d.lastIndexOf(y);if(!y)return!1;let x=(0,wj.tokenize)(y).map(m=>m.toObject(r.defaultProtocol));if(!Ej(x))return!1;x.filter(m=>m.isLink).map(m=>({...m,from:v+m.start+1,to:v+m.end+1})).filter(m=>n.schema.marks.code?!n.doc.rangeHasMark(m.from,m.to,n.schema.marks.code):!0).filter(m=>r.validate(m.value)).filter(m=>r.shouldAutoLink(m.value)).forEach(m=>{(0,_c.getMarksBetween)(m.from,m.to,n.doc).some(_=>_.mark.type===r.type)||a.addMark(m.from,m.to,r.type.create({href:m.href}))})}}),!!a.steps.length)return a}})}var kj=Se(),mI=Pe();function Tj(r){return new mI.Plugin({key:new mI.PluginKey("handleClickLink"),props:{handleClick:(e,t,n)=>{var i,s;if(n.button!==0||!e.editable)return!1;let a=null;if(n.target instanceof HTMLAnchorElement)a=n.target;else{let c=n.target,f=[];for(;c.nodeName!=="DIV";)f.push(c),c=c.parentNode;a=f.find(d=>d.nodeName==="A")}if(!a)return!1;let o=(0,kj.getAttributes)(e.state,r.type.name),l=(i=a?.href)!=null?i:o.href,u=(s=a?.target)!=null?s:o.target;return r.enableClickSelection&&r.editor.commands.extendMarkRange(r.type.name),a&&l?(window.open(l,u),!0):!1}}})}var gI=Pe(),Aj=yc();function Oj(r){return new gI.Plugin({key:new gI.PluginKey("handlePasteLink"),props:{handlePaste:(e,t,n)=>{let{shouldAutoLink:i}=r,{state:s}=e,{selection:a}=s,{empty:o}=a;if(o)return!1;let l="";n.content.forEach(c=>{l+=c.textContent});let u=(0,Aj.find)(l,{defaultProtocol:r.defaultProtocol}).find(c=>c.isLink&&c.value===l);return!l||!u||i!==void 0&&!i(u.href)?!1:r.editor.commands.setMark(r.type,{href:u.href})}}})}var Nj=/https?:\/\/(?:www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z]{2,}\b(?:[-a-zA-Z0-9@:%._+~#=?!&/]*)(?:[-a-zA-Z0-9@:%._+~#=?!&/]*)/gi;function Jn(r,e){let t=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(n=>{let i=typeof n=="string"?n:n.scheme;i&&t.push(i)}),!r||r.replace(xj,"").match(new RegExp(`^(?:(?:${t.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var yI=wc.Mark.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(r=>{if(typeof r=="string"){(0,bc.registerCustomProtocol)(r);return}(0,bc.registerCustomProtocol)(r.scheme,r.optionalSlashes)})},onDestroy(){(0,bc.reset)()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(r,e)=>!!Jn(r,e.protocols),validate:r=>!!r,shouldAutoLink:r=>!!r}},addAttributes(){return{href:{default:null,parseHTML(r){return r.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:r=>{let e=r.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:t=>!!Jn(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:r}){return this.options.isAllowedUri(r.href,{defaultValidate:e=>!!Jn(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",(0,wc.mergeAttributes)(this.options.HTMLAttributes,r),0]:["a",(0,wc.mergeAttributes)(this.options.HTMLAttributes,{...r,href:""}),0]},markdownTokenName:"link",parseMarkdown:(r,e)=>e.applyMark("link",e.parseInline(r.tokens||[]),{href:r.href,title:r.title||null}),renderMarkdown:(r,e)=>{var t;let n=((t=r.attrs)==null?void 0:t.href)||"";return`[${e.renderChildren(r)}](${n})`},addCommands(){return{setLink:r=>({chain:e})=>{let{href:t}=r;return this.options.isAllowedUri(t,{defaultValidate:n=>!!Jn(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,r).setMeta("preventAutolink",!0).run():!1},toggleLink:r=>({chain:e})=>{let{href:t}=r||{};return t&&!this.options.isAllowedUri(t,{defaultValidate:n=>!!Jn(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,r,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:r})=>r().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[(0,wc.markPasteRule)({find:r=>{let e=[];if(r){let{protocols:t,defaultProtocol:n}=this.options,i=(0,bc.find)(r).filter(s=>s.isLink&&this.options.isAllowedUri(s.value,{defaultValidate:a=>!!Jn(a,t),protocols:t,defaultProtocol:n}));i.length&&i.forEach(s=>{this.options.shouldAutoLink(s.value)&&e.push({text:s.value,data:{href:s.href},index:s.start})})}return e},type:this.type,getAttributes:r=>{var e;return{href:(e=r.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){let r=[],{protocols:e,defaultProtocol:t}=this.options;return this.options.autolink&&r.push(Sj({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:i=>!!Jn(i,e),protocols:e,defaultProtocol:t}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&r.push(Tj({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&r.push(Oj({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),r}}),Rj=yI});var Xn=xe((XQ,zI)=>{"use strict";var eg=Object.defineProperty,Cj=Object.getOwnPropertyDescriptor,Ij=Object.getOwnPropertyNames,Pj=Object.prototype.hasOwnProperty,kI=(r,e)=>{for(var t in e)eg(r,t,{get:e[t],enumerable:!0})},Dj=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ij(e))!Pj.call(r,i)&&i!==t&&eg(r,i,{get:()=>e[i],enumerable:!(n=Cj(e,i))||n.enumerable});return r},Mj=r=>Dj(eg({},"__esModule",{value:!0}),r),TI={};kI(TI,{BulletList:()=>AI,ListItem:()=>OI,ListKeymap:()=>MI,ListKit:()=>Gj,OrderedList:()=>FI,TaskItem:()=>UI,TaskList:()=>HI,bulletListInputRegex:()=>Xm,inputRegex:()=>BI,listHelpers:()=>NI,orderedListInputRegex:()=>Qm});zI.exports=Mj(TI);var xc=Se(),Lj="listItem",_I="textStyle",Xm=/^\s*([-+*])\s$/,AI=xc.Node.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:r}){return["ul",(0,xc.mergeAttributes)(this.options.HTMLAttributes,r),0]},markdownTokenName:"list",parseMarkdown:(r,e)=>r.type!=="list"||r.ordered?[]:{type:"bulletList",content:r.items?e.parseChildren(r.items):[]},renderMarkdown:(r,e)=>r.content?e.renderChildren(r.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:r,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Lj,this.editor.getAttributes(_I)).run():r.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let r=(0,xc.wrappingInputRule)({find:Xm,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(r=(0,xc.wrappingInputRule)({find:Xm,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(_I),editor:this.editor})),[r]}}),$m=Se(),OI=$m.Node.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:r}){return["li",(0,$m.mergeAttributes)(this.options.HTMLAttributes,r),0]},markdownTokenName:"list_item",parseMarkdown:(r,e)=>{if(r.type!=="list_item")return[];let t=[];if(r.tokens&&r.tokens.length>0)if(r.tokens.some(i=>i.type==="paragraph"))t=e.parseChildren(r.tokens);else{let i=r.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(t=[{type:"paragraph",content:e.parseInline(i.tokens)}],r.tokens.length>1){let a=r.tokens.slice(1),o=e.parseChildren(a);t.push(...o)}}else t=e.parseChildren(r.tokens)}return t.length===0&&(t=[{type:"paragraph",content:[]}]),{type:"listItem",content:t}},renderMarkdown:(r,e,t)=>(0,$m.renderNestedMarkdownContent)(r,e,n=>n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${n.index+1}. `:"- ",t),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Fj=Se(),NI={};kI(NI,{findListItemPos:()=>va,getNextListDepth:()=>tg,handleBackspace:()=>Ym,handleDelete:()=>Zm,hasListBefore:()=>RI,hasListItemAfter:()=>zj,hasListItemBefore:()=>CI,listItemHasSubList:()=>II,nextListIsDeeper:()=>PI,nextListIsHigher:()=>DI});var Bj=Se(),va=(r,e)=>{let{$from:t}=e.selection,n=(0,Bj.getNodeType)(r,e.schema),i=null,s=t.depth,a=t.pos,o=null;for(;s>0&&o===null;)i=t.node(s),i.type===n?o=s:(s-=1,a-=1);return o===null?null:{$pos:e.doc.resolve(a),depth:o}},Uj=Se(),tg=(r,e)=>{let t=va(r,e);if(!t)return!1;let[,n]=(0,Uj.getNodeAtPosition)(e,r,t.$pos.pos+4);return n},Jm=Se(),RI=(r,e,t)=>{let{$anchor:n}=r.selection,i=Math.max(0,n.pos-2),s=r.doc.resolve(i).node();return!(!s||!t.includes(s.type.name))},CI=(r,e)=>{var t;let{$anchor:n}=e.selection,i=e.doc.resolve(n.pos-2);return!(i.index()===0||((t=i.nodeBefore)==null?void 0:t.type.name)!==r)},Hj=Se(),II=(r,e,t)=>{if(!t)return!1;let n=(0,Hj.getNodeType)(r,e.schema),i=!1;return t.descendants(s=>{s.type===n&&(i=!0)}),i},Ym=(r,e,t)=>{if(r.commands.undoInputRule())return!0;if(r.state.selection.from!==r.state.selection.to)return!1;if(!(0,Jm.isNodeActive)(r.state,e)&&RI(r.state,e,t)){let{$anchor:o}=r.state.selection,l=r.state.doc.resolve(o.before()-1),u=[];l.node().descendants((d,h)=>{d.type.name===e&&u.push({node:d,pos:h})});let c=u.at(-1);if(!c)return!1;let f=r.state.doc.resolve(l.start()+c.pos+1);return r.chain().cut({from:o.start()-1,to:o.end()+1},f.end()).joinForward().run()}if(!(0,Jm.isNodeActive)(r.state,e)||!(0,Jm.isAtStartOfNode)(r.state))return!1;let n=va(e,r.state);if(!n)return!1;let s=r.state.doc.resolve(n.$pos.pos-2).node(n.depth),a=II(e,r.state,s);return CI(e,r.state)&&!a?r.commands.joinItemBackward():r.chain().liftListItem(e).run()},xI=Se(),PI=(r,e)=>{let t=tg(r,e),n=va(r,e);return!n||!t?!1:t>n.depth},DI=(r,e)=>{let t=tg(r,e),n=va(r,e);return!n||!t?!1:t<n.depth},Zm=(r,e)=>{if(!(0,xI.isNodeActive)(r.state,e)||!(0,xI.isAtEndOfNode)(r.state,e))return!1;let{selection:t}=r.state,{$from:n,$to:i}=t;return!t.empty&&n.sameParent(i)?!1:PI(e,r.state)?r.chain().focus(r.state.selection.from+4).lift(e).joinBackward().run():DI(e,r.state)?r.chain().joinForward().joinBackward().run():r.commands.joinItemForward()},zj=(r,e)=>{var t;let{$anchor:n}=e.selection,i=e.doc.resolve(n.pos-n.parentOffset-2);return!(i.index()===i.parent.childCount-1||((t=i.nodeAfter)==null?void 0:t.type.name)!==r)},MI=Fj.Extension.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:r})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t})=>{r.state.schema.nodes[t]!==void 0&&Zm(r,t)&&(e=!0)}),e},"Mod-Delete":({editor:r})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t})=>{r.state.schema.nodes[t]!==void 0&&Zm(r,t)&&(e=!0)}),e},Backspace:({editor:r})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t,wrapperNames:n})=>{r.state.schema.nodes[t]!==void 0&&Ym(r,t,n)&&(e=!0)}),e},"Mod-Backspace":({editor:r})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t,wrapperNames:n})=>{r.state.schema.nodes[t]!==void 0&&Ym(r,t,n)&&(e=!0)}),e}}}}),jj=Se(),ga=Se(),EI=/^(\s*)(\d+)\.\s+(.*)$/,Wj=/^\s/;function qj(r){let e=[],t=0,n=0;for(;t<r.length;){let i=r[t],s=i.match(EI);if(!s)break;let[,a,o,l]=s,u=a.length,c=l,f=t+1,d=[i];for(;f<r.length;){let h=r[f];if(h.match(EI))break;if(h.trim()==="")d.push(h),c+=`
`,f+=1;else if(h.match(Wj))d.push(h),c+=`
${h.slice(u+2)}`,f+=1;else break}e.push({indent:u,number:parseInt(o,10),content:c.trim(),raw:d.join(`
`)}),n=f,t=f}return[e,n]}function LI(r,e,t){var n;let i=[],s=0;for(;s<r.length;){let a=r[s];if(a.indent===e){let o=a.content.split(`
`),l=((n=o[0])==null?void 0:n.trim())||"",u=[];l&&u.push({type:"paragraph",raw:l,tokens:t.inlineTokens(l)});let c=o.slice(1).join(`
`).trim();if(c){let h=t.blockTokens(c);u.push(...h)}let f=s+1,d=[];for(;f<r.length&&r[f].indent>e;)d.push(r[f]),f+=1;if(d.length>0){let h=Math.min(...d.map(v=>v.indent)),y=LI(d,h,t);u.push({type:"list",ordered:!0,start:d[0].number,items:y,raw:d.map(v=>v.raw).join(`
`)})}i.push({type:"list_item",raw:a.raw,tokens:u}),s=f}else s+=1}return i}function Vj(r,e){return r.map(t=>{if(t.type!=="list_item")return e.parseChildren([t])[0];let n=[];return t.tokens&&t.tokens.length>0&&t.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")n.push(...e.parseChildren([i]));else if(i.type==="text"&&i.tokens){let s=e.parseChildren([i]);n.push({type:"paragraph",content:s})}else{let s=e.parseChildren([i]);s.length>0&&n.push(...s)}}),{type:"listItem",content:n}})}var Kj="listItem",SI="textStyle",Qm=/^(\d+)\.\s$/,FI=ga.Node.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:r=>r.hasAttribute("start")?parseInt(r.getAttribute("start")||"",10):1},type:{default:null,parseHTML:r=>r.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:r}){let{start:e,...t}=r;return e===1?["ol",(0,ga.mergeAttributes)(this.options.HTMLAttributes,t),0]:["ol",(0,ga.mergeAttributes)(this.options.HTMLAttributes,r),0]},markdownTokenName:"list",parseMarkdown:(r,e)=>{if(r.type!=="list"||!r.ordered)return[];let t=r.start||1,n=r.items?Vj(r.items,e):[];return t!==1?{type:"orderedList",attrs:{start:t},content:n}:{type:"orderedList",content:n}},renderMarkdown:(r,e)=>r.content?e.renderChildren(r.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:r=>{let e=r.match(/^(\s*)(\d+)\.\s+/),t=e?.index;return t!==void 0?t:-1},tokenize:(r,e,t)=>{var n;let i=r.split(`
`),[s,a]=qj(i);if(s.length===0)return;let o=LI(s,0,t);return o.length===0?void 0:{type:"list",ordered:!0,start:((n=s[0])==null?void 0:n.number)||1,items:o,raw:i.slice(0,a).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:r,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Kj,this.editor.getAttributes(SI)).run():r.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let r=(0,ga.wrappingInputRule)({find:Qm,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(r=(0,ga.wrappingInputRule)({find:Qm,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(SI)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[r]}}),Ec=Se(),BI=/^\s*(\[([( |x])?\])\s$/,UI=Ec.Node.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:r=>{let e=r.getAttribute("data-checked");return e===""||e==="true"},renderHTML:r=>({"data-checked":r.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:r,HTMLAttributes:e}){return["li",(0,Ec.mergeAttributes)(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:r.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(r,e)=>{let t=[];if(r.tokens&&r.tokens.length>0?t.push(e.createNode("paragraph",{},e.parseInline(r.tokens))):r.text?t.push(e.createNode("paragraph",{},[e.createNode("text",{text:r.text})])):t.push(e.createNode("paragraph",{},[])),r.nestedTokens&&r.nestedTokens.length>0){let n=e.parseChildren(r.nestedTokens);t.push(...n)}return e.createNode("taskItem",{checked:r.checked||!1},t)},renderMarkdown:(r,e)=>{var t;let i=`- [${(t=r.attrs)!=null&&t.checked?"x":" "}] `;return(0,Ec.renderNestedMarkdownContent)(r,e,i)},addKeyboardShortcuts(){let r={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...r,Tab:()=>this.editor.commands.sinkListItem(this.name)}:r},addNodeView(){return({node:r,HTMLAttributes:e,getPos:t,editor:n})=>{let i=document.createElement("li"),s=document.createElement("label"),a=document.createElement("span"),o=document.createElement("input"),l=document.createElement("div"),u=c=>{var f,d;o.ariaLabel=((d=(f=this.options.a11y)==null?void 0:f.checkboxLabel)==null?void 0:d.call(f,c,o.checked))||`Task item checkbox for ${c.textContent||"empty task item"}`};return u(r),s.contentEditable="false",o.type="checkbox",o.addEventListener("mousedown",c=>c.preventDefault()),o.addEventListener("change",c=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){o.checked=!o.checked;return}let{checked:f}=c.target;n.isEditable&&typeof t=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:d})=>{let h=t();if(typeof h!="number")return!1;let y=d.doc.nodeAt(h);return d.setNodeMarkup(h,void 0,{...y?.attrs,checked:f}),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(r,f)||(o.checked=!o.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([c,f])=>{i.setAttribute(c,f)}),i.dataset.checked=r.attrs.checked,o.checked=r.attrs.checked,s.append(o,a),i.append(s,l),Object.entries(e).forEach(([c,f])=>{i.setAttribute(c,f)}),{dom:i,contentDOM:l,update:c=>c.type!==this.type?!1:(i.dataset.checked=c.attrs.checked,o.checked=c.attrs.checked,u(c),!0)}}},addInputRules(){return[(0,Ec.wrappingInputRule)({find:BI,type:this.type,getAttributes:r=>({checked:r[r.length-1]==="x"})})]}}),Sc=Se(),HI=Sc.Node.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:r}){return["ul",(0,Sc.mergeAttributes)(this.options.HTMLAttributes,r,{"data-type":this.name}),0]},parseMarkdown:(r,e)=>e.createNode("taskList",{},e.parseChildren(r.items||[])),renderMarkdown:(r,e)=>r.content?e.renderChildren(r.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(r){var e;let t=(e=r.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return t!==void 0?t:-1},tokenize(r,e,t){let n=s=>{let a=(0,Sc.parseIndentedBlocks)(s,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,l)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:t.inlineTokens(o.mainContent),nestedTokens:l}),customNestedParser:n},t);return a?[{type:"taskList",raw:a.raw,items:a.items}]:t.blockTokens(s)},i=(0,Sc.parseIndentedBlocks)(r,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:s=>({indentLevel:s[1].length,mainContent:s[4],checked:s[3].toLowerCase()==="x"}),createToken:(s,a)=>({type:"taskItem",raw:"",mainContent:s.mainContent,indentLevel:s.indentLevel,checked:s.checked,text:s.mainContent,tokens:t.inlineTokens(s.mainContent),nestedTokens:a}),customNestedParser:n},t);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:r})=>r.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),Gj=jj.Extension.create({name:"listKit",addExtensions(){let r=[];return this.options.bulletList!==!1&&r.push(AI.configure(this.options.bulletList)),this.options.listItem!==!1&&r.push(OI.configure(this.options.listItem)),this.options.listKeymap!==!1&&r.push(MI.configure(this.options.listKeymap)),this.options.orderedList!==!1&&r.push(FI.configure(this.options.orderedList)),this.options.taskItem!==!1&&r.push(UI.configure(this.options.taskItem)),this.options.taskList!==!1&&r.push(HI.configure(this.options.taskList)),r}})});var ng=xe((YQ,VI)=>{"use strict";var rg=Object.defineProperty,$j=Object.getOwnPropertyDescriptor,Jj=Object.getOwnPropertyNames,Xj=Object.prototype.hasOwnProperty,Yj=(r,e)=>{for(var t in e)rg(r,t,{get:e[t],enumerable:!0})},Zj=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Jj(e))!Xj.call(r,i)&&i!==t&&rg(r,i,{get:()=>e[i],enumerable:!(n=$j(e,i))||n.enumerable});return r},Qj=r=>Zj(rg({},"__esModule",{value:!0}),r),WI={};Yj(WI,{Paragraph:()=>qI,default:()=>eW});VI.exports=Qj(WI);var jI=Se(),qI=jI.Node.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:r}){return["p",(0,jI.mergeAttributes)(this.options.HTMLAttributes,r),0]},parseMarkdown:(r,e)=>{let t=r.tokens||[];return t.length===1&&t[0].type==="image"?e.parseChildren([t[0]]):e.createNode("paragraph",void 0,e.parseInline(t))},renderMarkdown:(r,e)=>!r||!Array.isArray(r.content)?"":e.renderChildren(r.content),addCommands(){return{setParagraph:()=>({commands:r})=>r.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),eW=qI});var YI=xe((ZQ,XI)=>{"use strict";var ig=Object.defineProperty,tW=Object.getOwnPropertyDescriptor,rW=Object.getOwnPropertyNames,nW=Object.prototype.hasOwnProperty,iW=(r,e)=>{for(var t in e)ig(r,t,{get:e[t],enumerable:!0})},sW=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of rW(e))!nW.call(r,i)&&i!==t&&ig(r,i,{get:()=>e[i],enumerable:!(n=tW(e,i))||n.enumerable});return r},oW=r=>sW(ig({},"__esModule",{value:!0}),r),KI={};iW(KI,{Strike:()=>JI,default:()=>aW,inputRegex:()=>GI,pasteRegex:()=>$I});XI.exports=oW(KI);var kc=Se(),GI=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,$I=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,JI=kc.Mark.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:r=>r.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:r}){return["s",(0,kc.mergeAttributes)(this.options.HTMLAttributes,r),0]},markdownTokenName:"del",parseMarkdown:(r,e)=>e.applyMark("strike",e.parseInline(r.tokens||[])),renderMarkdown:(r,e)=>`~~${e.renderChildren(r)}~~`,addCommands(){return{setStrike:()=>({commands:r})=>r.setMark(this.name),toggleStrike:()=>({commands:r})=>r.toggleMark(this.name),unsetStrike:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[(0,kc.markInputRule)({find:GI,type:this.type})]},addPasteRules(){return[(0,kc.markPasteRule)({find:$I,type:this.type})]}}),aW=JI});var tP=xe((QQ,eP)=>{"use strict";var sg=Object.defineProperty,lW=Object.getOwnPropertyDescriptor,uW=Object.getOwnPropertyNames,cW=Object.prototype.hasOwnProperty,fW=(r,e)=>{for(var t in e)sg(r,t,{get:e[t],enumerable:!0})},hW=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of uW(e))!cW.call(r,i)&&i!==t&&sg(r,i,{get:()=>e[i],enumerable:!(n=lW(e,i))||n.enumerable});return r},dW=r=>hW(sg({},"__esModule",{value:!0}),r),ZI={};fW(ZI,{Text:()=>QI,default:()=>mW});eP.exports=dW(ZI);var pW=Se(),QI=pW.Node.create({name:"text",group:"inline",parseMarkdown:r=>({type:"text",text:r.text||""}),renderMarkdown:r=>r.text||""}),mW=QI});var Tc=xe((eee,sP)=>{"use strict";var og=Object.defineProperty,gW=Object.getOwnPropertyDescriptor,vW=Object.getOwnPropertyNames,yW=Object.prototype.hasOwnProperty,wW=(r,e)=>{for(var t in e)og(r,t,{get:e[t],enumerable:!0})},bW=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of vW(e))!yW.call(r,i)&&i!==t&&og(r,i,{get:()=>e[i],enumerable:!(n=gW(e,i))||n.enumerable});return r},_W=r=>bW(og({},"__esModule",{value:!0}),r),nP={};wW(nP,{Underline:()=>iP,default:()=>xW});sP.exports=_W(nP);var rP=Se(),iP=rP.Mark.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:r=>r.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:r}){return["u",(0,rP.mergeAttributes)(this.options.HTMLAttributes,r),0]},parseMarkdown(r,e){return e.applyMark(this.name||"underline",e.parseInline(r.tokens||[]))},renderMarkdown(r,e){return`++${e.renderChildren(r)}++`},markdownTokenizer:{name:"underline",level:"inline",start(r){return r.indexOf("++")},tokenize(r,e,t){let i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(r);if(!i)return;let s=i[2].trim();return{type:"underline",raw:i[0],text:s,tokens:t.inlineTokens(s)}}},addCommands(){return{setUnderline:()=>({commands:r})=>r.setMark(this.name),toggleUnderline:()=>({commands:r})=>r.toggleMark(this.name),unsetUnderline:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),xW=iP});var lP=xe(aP=>{"use strict";function ya(r){"@babel/helpers - typeof";return ya=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ya(r)}function EW(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function oP(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,kW(n.key),n)}}function SW(r,e,t){return e&&oP(r.prototype,e),t&&oP(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function kW(r){var e=TW(r,"string");return ya(e)==="symbol"?e:String(e)}function TW(r,e){if(ya(r)!=="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(ya(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var AW=dn(),OW=Bn();function NW(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new AW.Plugin({view:function(t){return new RW(t,r)}})}var RW=(function(){function r(e,t){var n=this;EW(this,r);var i;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(i=t.width)!==null&&i!==void 0?i:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(function(s){var a=function(l){n[s](l)};return e.dom.addEventListener(s,a),{name:s,handler:a}})}return SW(r,[{key:"destroy",value:function(){var t=this;this.handlers.forEach(function(n){var i=n.name,s=n.handler;return t.editorView.dom.removeEventListener(i,s)})}},{key:"update",value:function(t,n){this.cursorPos!=null&&n.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}},{key:"setCursor",value:function(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}},{key:"updateOverlay",value:function(){var t=this.editorView.state.doc.resolve(this.cursorPos),n=!t.parent.inlineContent,i,s=this.editorView.dom,a=s.getBoundingClientRect(),o=a.width/s.offsetWidth,l=a.height/s.offsetHeight;if(n){var u=t.nodeBefore,c=t.nodeAfter;if(u||c){var f=this.editorView.nodeDOM(this.cursorPos-(u?u.nodeSize:0));if(f){var d=f.getBoundingClientRect(),h=u?d.bottom:d.top;u&&c&&(h=(h+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);var y=this.width/2*l;i={left:d.left,right:d.right,top:h-y,bottom:h+y}}}}if(!i){var v=this.editorView.coordsAtPos(this.cursorPos),x=this.width/2*o;i={left:v.left-x,right:v.left+x,top:v.top,bottom:v.bottom}}var m=this.editorView.dom.offsetParent;this.element||(this.element=m.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);var _,b;if(!m||m==document.body&&getComputedStyle(m).position=="static")_=-pageXOffset,b=-pageYOffset;else{var w=m.getBoundingClientRect(),T=w.width/m.offsetWidth,P=w.height/m.offsetHeight;_=w.left-m.scrollLeft*T,b=w.top-m.scrollTop*P}this.element.style.left=(i.left-_)/o+"px",this.element.style.top=(i.top-b)/l+"px",this.element.style.width=(i.right-i.left)/o+"px",this.element.style.height=(i.bottom-i.top)/l+"px"}},{key:"scheduleRemoval",value:function(t){var n=this;clearTimeout(this.timeout),this.timeout=setTimeout(function(){return n.setCursor(null)},t)}},{key:"dragover",value:function(t){if(this.editorView.editable){var n=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),i=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),s=i&&i.type.spec.disableDropCursor,a=typeof s=="function"?s(this.editorView,n,t):s;if(n&&!a){var o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){var l=OW.dropPoint(this.editorView.state.doc,o,this.editorView.dragging.slice);l!=null&&(o=l)}this.setCursor(o),this.scheduleRemoval(5e3)}}}},{key:"dragend",value:function(){this.scheduleRemoval(20)}},{key:"drop",value:function(){this.scheduleRemoval(20)}},{key:"dragleave",value:function(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}]),r})();aP.dropCursor=NW});var uP=xe(Ac=>{"use strict";Object.defineProperty(Ac,"__esModule",{value:!0});function CW(r){Object.keys(r).filter(e=>e!=="default"&&e!=="__esModule").forEach(e=>{Ac.hasOwnProperty(e)||Object.defineProperty(Ac,e,{enumerable:!0,configurable:!0,get:()=>r[e]})})}var IW=lP();CW(IW)});var mP=xe(lg=>{"use strict";function Ps(r){"@babel/helpers - typeof";return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ps(r)}function hP(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function cP(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,PW(n.key),n)}}function dP(r,e,t){return e&&cP(r.prototype,e),t&&cP(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function PW(r){var e=DW(r,"string");return Ps(e)==="symbol"?e:String(e)}function DW(r,e){if(Ps(r)!=="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(Ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function MW(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&ag(r,e)}function ag(r,e){return ag=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ag(r,e)}function LW(r){var e=UW();return function(){var n=Rc(r),i;if(e){var s=Rc(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return FW(this,i)}}function FW(r,e){if(e&&(Ps(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BW(r)}function BW(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function UW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rc(r){return Rc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Rc(r)}var HW=zp(),bn=dn(),Nc=Ln(),fP=Bp(),Ut=(function(r){MW(t,r);var e=LW(t);function t(n){return hP(this,t),e.call(this,n,n)}return dP(t,[{key:"map",value:function(i,s){var a=i.resolve(s.map(this.head));return t.valid(a)?new t(a):bn.Selection.near(a)}},{key:"content",value:function(){return Nc.Slice.empty}},{key:"eq",value:function(i){return i instanceof t&&i.head==this.head}},{key:"toJSON",value:function(){return{type:"gapcursor",pos:this.head}}},{key:"getBookmark",value:function(){return new zW(this.anchor)}}],[{key:"fromJSON",value:function(i,s){if(typeof s.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new t(i.resolve(s.pos))}},{key:"valid",value:function(i){var s=i.parent;if(s.isTextblock||!jW(i)||!WW(i))return!1;var a=s.type.spec.allowGapCursor;if(a!=null)return a;var o=s.contentMatchAt(i.index()).defaultType;return o&&o.isTextblock}},{key:"findGapCursorFrom",value:function(i,s){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;e:for(;;){if(!a&&t.valid(i))return i;for(var o=i.pos,l=null,u=i.depth;;u--){var c=i.node(u);if(s>0?i.indexAfter(u)<c.childCount:i.index(u)>0){l=c.child(s>0?i.indexAfter(u):i.index(u)-1);break}else if(u==0)return null;o+=s;var f=i.doc.resolve(o);if(t.valid(f))return f}for(;;){var d=s>0?l.firstChild:l.lastChild;if(!d){if(l.isAtom&&!l.isText&&!bn.NodeSelection.isSelectable(l)){i=i.doc.resolve(o+l.nodeSize*s),a=!1;continue e}break}l=d,o+=s;var h=i.doc.resolve(o);if(t.valid(h))return h}return null}}}]),t})(bn.Selection);Ut.prototype.visible=!1;Ut.findFrom=Ut.findGapCursorFrom;bn.Selection.jsonID("gapcursor",Ut);var zW=(function(){function r(e){hP(this,r),this.pos=e}return dP(r,[{key:"map",value:function(t){return new r(t.map(this.pos))}},{key:"resolve",value:function(t){var n=t.resolve(this.pos);return Ut.valid(n)?new Ut(n):bn.Selection.near(n)}}]),r})();function pP(r){return r.isAtom||r.spec.isolating||r.spec.createGapCursor}function jW(r){for(var e=r.depth;e>=0;e--){var t=r.index(e),n=r.node(e);if(t==0){if(n.type.spec.isolating)return!0;continue}for(var i=n.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||pP(i.type))return!0;if(i.inlineContent)return!1}}return!0}function WW(r){for(var e=r.depth;e>=0;e--){var t=r.indexAfter(e),n=r.node(e);if(t==n.childCount){if(n.type.spec.isolating)return!0;continue}for(var i=n.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||pP(i.type))return!0;if(i.inlineContent)return!1}}return!0}function qW(){return new bn.Plugin({props:{decorations:$W,createSelectionBetween:function(e,t,n){return t.pos==n.pos&&Ut.valid(n)?new Ut(n):null},handleClick:KW,handleKeyDown:VW,handleDOMEvents:{beforeinput:GW}}})}var VW=HW.keydownHandler({ArrowLeft:Oc("horiz",-1),ArrowRight:Oc("horiz",1),ArrowUp:Oc("vert",-1),ArrowDown:Oc("vert",1)});function Oc(r,e){var t=r=="vert"?e>0?"down":"up":e>0?"right":"left";return function(n,i,s){var a=n.selection,o=e>0?a.$to:a.$from,l=a.empty;if(a instanceof bn.TextSelection){if(!s.endOfTextblock(t)||o.depth==0)return!1;l=!1,o=n.doc.resolve(e>0?o.after():o.before())}var u=Ut.findGapCursorFrom(o,e,l);return u?(i&&i(n.tr.setSelection(new Ut(u))),!0):!1}}function KW(r,e,t){if(!r||!r.editable)return!1;var n=r.state.doc.resolve(e);if(!Ut.valid(n))return!1;var i=r.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&bn.NodeSelection.isSelectable(r.state.doc.nodeAt(i.inside))?!1:(r.dispatch(r.state.tr.setSelection(new Ut(n))),!0)}function GW(r,e){if(e.inputType!="insertCompositionText"||!(r.state.selection instanceof Ut))return!1;var t=r.state.selection.$from,n=t.parent.contentMatchAt(t.index()).findWrapping(r.state.schema.nodes.text);if(!n)return!1;for(var i=Nc.Fragment.empty,s=n.length-1;s>=0;s--)i=Nc.Fragment.from(n[s].createAndFill(null,i));var a=r.state.tr.replace(t.pos,t.pos,new Nc.Slice(i,0,0));return a.setSelection(bn.TextSelection.near(a.doc.resolve(t.pos+1))),r.dispatch(a),!1}function $W(r){if(!(r.selection instanceof Ut))return null;var e=document.createElement("div");return e.className="ProseMirror-gapcursor",fP.DecorationSet.create(r.doc,[fP.Decoration.widget(r.selection.head,e,{key:"gapcursor"})])}lg.GapCursor=Ut;lg.gapCursor=qW});var gP=xe(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});function JW(r){Object.keys(r).filter(e=>e!=="default"&&e!=="__esModule").forEach(e=>{Cc.hasOwnProperty(e)||Object.defineProperty(Cc,e,{enumerable:!0,configurable:!0,get:()=>r[e]})})}var XW=mP();JW(XW)});var wP=xe((see,yP)=>{"use strict";var Ic=200,Et=function(){};Et.prototype.append=function(e){return e.length?(e=Et.from(e),!this.length&&e||e.length<Ic&&this.leafAppend(e)||this.length<Ic&&e.leafPrepend(this)||this.appendInner(e)):this};Et.prototype.prepend=function(e){return e.length?Et.from(e).append(this):this};Et.prototype.appendInner=function(e){return new YW(this,e)};Et.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?Et.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};Et.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Et.prototype.forEach=function(e,t,n){t===void 0&&(t=0),n===void 0&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)};Et.prototype.map=function(e,t,n){t===void 0&&(t=0),n===void 0&&(n=this.length);var i=[];return this.forEach(function(s,a){return i.push(e(s,a))},t,n),i};Et.from=function(e){return e instanceof Et?e:e&&e.length?new vP(e):Et.empty};var vP=(function(r){function e(n){r.call(this),this.values=n}r&&(e.__proto__=r),e.prototype=Object.create(r&&r.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,a,o){for(var l=s;l<a;l++)if(i(this.values[l],o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,s,a,o){for(var l=s-1;l>=a;l--)if(i(this.values[l],o+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=Ic)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=Ic)return new e(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e})(Et);Et.empty=new vP([]);var YW=(function(r){function e(t,n){r.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return r&&(e.__proto__=r),e.prototype=Object.create(r&&r.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},e.prototype.forEachInner=function(n,i,s,a){var o=this.left.length;if(i<o&&this.left.forEachInner(n,i,Math.min(s,o),a)===!1||s>o&&this.right.forEachInner(n,Math.max(i-o,0),Math.min(this.length,s)-o,a+o)===!1)return!1},e.prototype.forEachInvertedInner=function(n,i,s,a){var o=this.left.length;if(i>o&&this.right.forEachInvertedInner(n,i-o,Math.max(s,o)-o,a+o)===!1||s<o&&this.left.forEachInvertedInner(n,Math.min(i,o),s,a)===!1)return!1},e.prototype.sliceInner=function(n,i){if(n==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(n,i):n>=s?this.right.slice(n-s,i-s):this.left.slice(n,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(n){var i=this.right.leafAppend(n);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(n){var i=this.left.leafPrepend(n);if(i)return new e(i,this.right)},e.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new e(this.left,new e(this.right,n)):new e(this,n)},e})(Et);yP.exports=Et});var AP=xe(Hr=>{"use strict";function wa(r){"@babel/helpers - typeof";return wa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wa(r)}function fg(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function bP(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,ZW(n.key),n)}}function hg(r,e,t){return e&&bP(r.prototype,e),t&&bP(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function ZW(r){var e=QW(r,"string");return wa(e)==="symbol"?e:String(e)}function QW(r,e){if(wa(r)!=="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(wa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var EP=wP(),eq=Bn(),dg=dn(),tq=500,ba=(function(){function r(e,t){fg(this,r),this.items=e,this.eventCount=t}return hg(r,[{key:"popEvent",value:function(t,n){var i=this;if(this.eventCount==0)return null;for(var s=this.items.length;;s--){var a=this.items.get(s-1);if(a.selection){--s;break}}var o,l;n&&(o=this.remapping(s,this.items.length),l=o.maps.length);var u=t.tr,c,f,d=[],h=[];return this.items.forEach(function(y,v){if(!y.step){o||(o=i.remapping(s,v+1),l=o.maps.length),l--,h.push(y);return}if(o){h.push(new Yn(y.map));var x=y.step.map(o.slice(l)),m;x&&u.maybeStep(x).doc&&(m=u.mapping.maps[u.mapping.maps.length-1],d.push(new Yn(m,void 0,void 0,d.length+h.length))),l--,m&&o.appendMap(m,l)}else u.maybeStep(y.step);if(y.selection)return c=o?y.selection.map(o.slice(l)):y.selection,f=new r(i.items.slice(0,s).append(h.reverse().concat(d)),i.eventCount-1),!1},this.items.length,0),{remaining:f,transform:u,selection:c}}},{key:"addTransform",value:function(t,n,i,s){for(var a=[],o=this.eventCount,l=this.items,u=!s&&l.length?l.get(l.length-1):null,c=0;c<t.steps.length;c++){var f=t.steps[c].invert(t.docs[c]),d=new Yn(t.mapping.maps[c],f,n),h=void 0;(h=u&&u.merge(d))&&(d=h,c?a.pop():l=l.slice(0,l.length-1)),a.push(d),n&&(o++,n=void 0),s||(u=d)}var y=o-i.depth;return y>nq&&(l=rq(l,y),o-=y),new r(l.append(a),o)}},{key:"remapping",value:function(t,n){var i=new eq.Mapping;return this.items.forEach(function(s,a){var o=s.mirrorOffset!=null&&a-s.mirrorOffset>=t?i.maps.length-s.mirrorOffset:void 0;i.appendMap(s.map,o)},t,n),i}},{key:"addMaps",value:function(t){return this.eventCount==0?this:new r(this.items.append(t.map(function(n){return new Yn(n)})),this.eventCount)}},{key:"rebased",value:function(t,n){if(!this.eventCount)return this;var i=[],s=Math.max(0,this.items.length-n),a=t.mapping,o=t.steps.length,l=this.eventCount;this.items.forEach(function(y){y.selection&&l--},s);var u=n;this.items.forEach(function(y){var v=a.getMirror(--u);if(v!=null){o=Math.min(o,v);var x=a.maps[v];if(y.step){var m=t.steps[v].invert(t.docs[v]),_=y.selection&&y.selection.map(a.slice(u+1,v));_&&l++,i.push(new Yn(x,m,_))}else i.push(new Yn(x))}},s);for(var c=[],f=n;f<o;f++)c.push(new Yn(a.maps[f]));var d=this.items.slice(0,s).append(c).append(i),h=new r(d,l);return h.emptyItemCount()>tq&&(h=h.compress(this.items.length-i.length)),h}},{key:"emptyItemCount",value:function(){var t=0;return this.items.forEach(function(n){n.step||t++}),t}},{key:"compress",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.items.length,n=this.remapping(0,t),i=n.maps.length,s=[],a=0;return this.items.forEach(function(o,l){if(l>=t)s.push(o),o.selection&&a++;else if(o.step){var u=o.step.map(n.slice(i)),c=u&&u.getMap();if(i--,c&&n.appendMap(c,i),u){var f=o.selection&&o.selection.map(n.slice(i));f&&a++;var d=new Yn(c.invert(),u,f),h,y=s.length-1;(h=s.length&&s[y].merge(d))?s[y]=h:s.push(d)}}else o.map&&i--},this.items.length,0),new r(EP.from(s.reverse()),a)}}]),r})();ba.empty=new ba(EP.empty,0);function rq(r,e){var t;return r.forEach(function(n,i){if(n.selection&&e--==0)return t=i,!1}),r.slice(t)}var Yn=(function(){function r(e,t,n,i){fg(this,r),this.map=e,this.step=t,this.selection=n,this.mirrorOffset=i}return hg(r,[{key:"merge",value:function(t){if(this.step&&t.step&&!t.selection){var n=t.step.merge(this.step);if(n)return new r(n.getMap().invert(),n,this.selection)}}}]),r})(),Zn=hg(function r(e,t,n,i,s){fg(this,r),this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=i,this.prevComposition=s}),nq=20;function iq(r,e,t,n){var i=t.getMeta(Ur),s;if(i)return i.historyState;t.getMeta(SP)&&(r=new Zn(r.done,r.undone,null,0,-1));var a=t.getMeta("appendedTransaction");if(t.steps.length==0)return r;if(a&&a.getMeta(Ur))return a.getMeta(Ur).redo?new Zn(r.done.addTransform(t,void 0,n,Pc(e)),r.undone,_P(t.mapping.maps),r.prevTime,r.prevComposition):new Zn(r.done,r.undone.addTransform(t,void 0,n,Pc(e)),null,r.prevTime,r.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(a&&a.getMeta("addToHistory")===!1)){var o=t.getMeta("composition"),l=r.prevTime==0||!a&&r.prevComposition!=o&&(r.prevTime<(t.time||0)-n.newGroupDelay||!sq(t,r.prevRanges)),u=a?ug(r.prevRanges,t.mapping):_P(t.mapping.maps);return new Zn(r.done.addTransform(t,l?e.selection.getBookmark():void 0,n,Pc(e)),ba.empty,u,t.time,o??r.prevComposition)}else return(s=t.getMeta("rebased"))?new Zn(r.done.rebased(t,s),r.undone.rebased(t,s),ug(r.prevRanges,t.mapping),r.prevTime,r.prevComposition):new Zn(r.done.addMaps(t.mapping.maps),r.undone.addMaps(t.mapping.maps),ug(r.prevRanges,t.mapping),r.prevTime,r.prevComposition)}function sq(r,e){if(!e)return!1;if(!r.docChanged)return!0;var t=!1;return r.mapping.maps[0].forEach(function(n,i){for(var s=0;s<e.length;s+=2)n<=e[s+1]&&i>=e[s]&&(t=!0)}),t}function _P(r){for(var e=[],t=r.length-1;t>=0&&e.length==0;t--)r[t].forEach(function(n,i,s,a){return e.push(s,a)});return e}function ug(r,e){if(!r)return null;for(var t=[],n=0;n<r.length;n+=2){var i=e.map(r[n],1),s=e.map(r[n+1],-1);i<=s&&t.push(i,s)}return t}function oq(r,e,t){var n=Pc(e),i=Ur.get(e).spec.config,s=(t?r.undone:r.done).popEvent(e,n);if(!s)return null;var a=s.selection.resolve(s.transform.doc),o=(t?r.done:r.undone).addTransform(s.transform,e.selection.getBookmark(),i,n),l=new Zn(t?o:s.remaining,t?s.remaining:o,null,0,-1);return s.transform.setSelection(a).setMeta(Ur,{redo:t,historyState:l})}var cg=!1,xP=null;function Pc(r){var e=r.plugins;if(xP!=e){cg=!1,xP=e;for(var t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){cg=!0;break}}return cg}function aq(r){return r.setMeta(SP,!0)}var Ur=new dg.PluginKey("history"),SP=new dg.PluginKey("closeHistory");function lq(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return r={depth:r.depth||100,newGroupDelay:r.newGroupDelay||500},new dg.Plugin({key:Ur,state:{init:function(){return new Zn(ba.empty,ba.empty,null,0,-1)},apply:function(t,n,i){return iq(n,i,t,r)}},config:r,props:{handleDOMEvents:{beforeinput:function(t,n){var i=n.inputType,s=i=="historyUndo"?kP:i=="historyRedo"?TP:null;return!s||!t.editable?!1:(n.preventDefault(),s(t.state,t.dispatch))}}}})}function Dc(r,e){return function(t,n){var i=Ur.getState(t);if(!i||(r?i.undone:i.done).eventCount==0)return!1;if(n){var s=oq(i,t,r);s&&n(e?s.scrollIntoView():s)}return!0}}var kP=Dc(!1,!0),TP=Dc(!0,!0),uq=Dc(!1,!1),cq=Dc(!0,!1);function fq(r){var e=Ur.getState(r);return e?e.done.eventCount:0}function hq(r){var e=Ur.getState(r);return e?e.undone.eventCount:0}function dq(r){return r.getMeta(Ur)!=null}Hr.closeHistory=aq;Hr.history=lq;Hr.isHistoryTransaction=dq;Hr.redo=TP;Hr.redoDepth=hq;Hr.redoNoScroll=cq;Hr.undo=kP;Hr.undoDepth=fq;Hr.undoNoScroll=uq});var OP=xe(Mc=>{"use strict";Object.defineProperty(Mc,"__esModule",{value:!0});function pq(r){Object.keys(r).filter(e=>e!=="default"&&e!=="__esModule").forEach(e=>{Mc.hasOwnProperty(e)||Object.defineProperty(Mc,e,{enumerable:!0,configurable:!0,get:()=>r[e]})})}var mq=AP();pq(mq)});var zP=xe((lee,HP)=>{"use strict";var vg=Object.defineProperty,gq=Object.getOwnPropertyDescriptor,vq=Object.getOwnPropertyNames,yq=Object.prototype.hasOwnProperty,wq=(r,e)=>{for(var t in e)vg(r,t,{get:e[t],enumerable:!0})},bq=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of vq(e))!yq.call(r,i)&&i!==t&&vg(r,i,{get:()=>e[i],enumerable:!(n=gq(e,i))||n.enumerable});return r},_q=r=>bq(vg({},"__esModule",{value:!0}),r),UP={};wq(UP,{CharacterCount:()=>Eq,Dropcursor:()=>Tq,Focus:()=>Oq,Gapcursor:()=>Rq,Placeholder:()=>Cq,Selection:()=>Iq,TrailingNode:()=>Dq,UndoRedo:()=>Lq});HP.exports=_q(UP);var xq=Se(),NP=Pe(),Eq=xq.Extension.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:r=>r.length,wordCounter:r=>r.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=r=>{let e=r?.node||this.editor.state.doc;if((r?.mode||this.options.mode)==="textSize"){let n=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(n)}return e.nodeSize},this.storage.words=r=>{let e=r?.node||this.editor.state.doc,t=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(t)}},addProseMirrorPlugins(){let r=!1;return[new NP.Plugin({key:new NP.PluginKey("characterCount"),appendTransaction:(e,t,n)=>{if(r)return;let i=this.options.limit;if(i==null||i===0){r=!0;return}let s=this.storage.characters({node:n.doc});if(s>i){let a=s-i,o=0,l=a;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);let u=n.tr.deleteRange(o,l);return r=!0,u}r=!0},filterTransaction:(e,t)=>{let n=this.options.limit;if(!e.docChanged||n===0||n===null||n===void 0)return!0;let i=this.storage.characters({node:t.doc}),s=this.storage.characters({node:e.doc});if(s<=n||i>n&&s>n&&s<=i)return!0;if(i>n&&s>n&&s>i||!e.getMeta("paste"))return!1;let o=e.selection.$head.pos,l=s-n,u=o-l,c=o;return e.deleteRange(u,c),!(this.storage.characters({node:e.doc})>n)}})]}}),Sq=Se(),kq=uP(),Tq=Sq.Extension.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[(0,kq.dropCursor)(this.options)]}}),Aq=Se(),RP=Pe(),pg=jo(),Oq=Aq.Extension.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new RP.Plugin({key:new RP.PluginKey("focus"),props:{decorations:({doc:r,selection:e})=>{let{isEditable:t,isFocused:n}=this.editor,{anchor:i}=e,s=[];if(!t||!n)return pg.DecorationSet.create(r,[]);let a=0;this.options.mode==="deepest"&&r.descendants((l,u)=>{if(l.isText)return;if(!(i>=u&&i<=u+l.nodeSize-1))return!1;a+=1});let o=0;return r.descendants((l,u)=>{if(l.isText||!(i>=u&&i<=u+l.nodeSize-1))return!1;if(o+=1,this.options.mode==="deepest"&&a-o>0||this.options.mode==="shallowest"&&o>1)return this.options.mode==="deepest";s.push(pg.Decoration.node(u,u+l.nodeSize,{class:this.options.className}))}),pg.DecorationSet.create(r,s)}}})]}}),mg=Se(),Nq=gP(),Rq=mg.Extension.create({name:"gapCursor",addProseMirrorPlugins(){return[(0,Nq.gapCursor)()]},extendNodeSchema(r){var e;let t={name:r.name,options:r.options,storage:r.storage};return{allowGapCursor:(e=(0,mg.callOrReturn)((0,mg.getExtensionField)(r,"allowGapCursor",t)))!=null?e:null}}}),CP=Se(),IP=Pe(),PP=jo(),Cq=CP.Extension.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something \u2026",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new IP.Plugin({key:new IP.PluginKey("placeholder"),props:{decorations:({doc:r,selection:e})=>{let t=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=e,i=[];if(!t)return null;let s=this.editor.isEmpty;return r.descendants((a,o)=>{let l=n>=o&&n<=o+a.nodeSize,u=!a.isLeaf&&(0,CP.isNodeEmpty)(a);if((l||!this.options.showOnlyCurrent)&&u){let c=[this.options.emptyNodeClass];s&&c.push(this.options.emptyEditorClass);let f=PP.Decoration.node(o,o+a.nodeSize,{class:c.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:a,pos:o,hasAnchor:l}):this.options.placeholder});i.push(f)}return this.options.includeChildren}),PP.DecorationSet.create(r,i)}}})]}}),DP=Se(),MP=Pe(),LP=jo(),Iq=DP.Extension.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){let{editor:r,options:e}=this;return[new MP.Plugin({key:new MP.PluginKey("selection"),props:{decorations(t){return t.selection.empty||r.isFocused||!r.isEditable||(0,DP.isNodeSelection)(t.selection)||r.view.dragging?null:LP.DecorationSet.create(t.doc,[LP.Decoration.inline(t.selection.from,t.selection.to,{class:e.className})])}}})]}}),Pq=Se(),FP=Pe();function BP({types:r,node:e}){return e&&Array.isArray(r)&&r.includes(e.type)||e?.type===r}var Dq=Pq.Extension.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var r;let e=new FP.PluginKey(this.name),t=((r=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:r.name)||this.options.node||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(t).includes(i.name));return[new FP.Plugin({key:e,appendTransaction:(i,s,a)=>{let{doc:o,tr:l,schema:u}=a,c=e.getState(a),f=o.content.size,d=u.nodes[t];if(c)return l.insert(f,d.create())},state:{init:(i,s)=>{let a=s.tr.doc.lastChild;return!BP({node:a,types:n})},apply:(i,s)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return s;let a=i.doc.lastChild;return!BP({node:a,types:n})}}})]}}),Mq=Se(),gg=OP(),Lq=Mq.Extension.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:r,dispatch:e})=>(0,gg.undo)(r,e),redo:()=>({state:r,dispatch:e})=>(0,gg.redo)(r,e)}},addProseMirrorPlugins(){return[(0,gg.history)(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044F":()=>this.editor.commands.undo(),"Shift-Mod-\u044F":()=>this.editor.commands.redo()}}})});var wg=xe((uee,qP)=>{"use strict";var yg=Object.defineProperty,Fq=Object.getOwnPropertyDescriptor,Bq=Object.getOwnPropertyNames,Uq=Object.prototype.hasOwnProperty,Hq=(r,e)=>{for(var t in e)yg(r,t,{get:e[t],enumerable:!0})},zq=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Bq(e))!Uq.call(r,i)&&i!==t&&yg(r,i,{get:()=>e[i],enumerable:!(n=Fq(e,i))||n.enumerable});return r},jq=r=>zq(yg({},"__esModule",{value:!0}),r),jP={};Hq(jP,{StarterKit:()=>WP,default:()=>iV});qP.exports=jq(jP);var Wq=Se(),qq=aC(),Vq=gC(),Kq=xC(),Gq=OC(),$q=IC(),Jq=FC(),Xq=xm(),Yq=qC(),Zq=ZC(),Qq=bI(),Lc=Xn(),eV=ng(),tV=YI(),rV=tP(),nV=Tc(),Fc=zP(),WP=Wq.Extension.create({name:"starterKit",addExtensions(){var r,e,t,n;let i=[];return this.options.bold!==!1&&i.push(Vq.Bold.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(qq.Blockquote.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(Lc.BulletList.configure(this.options.bulletList)),this.options.code!==!1&&i.push(Kq.Code.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(Gq.CodeBlock.configure(this.options.codeBlock)),this.options.document!==!1&&i.push($q.Document.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(Fc.Dropcursor.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(Fc.Gapcursor.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(Jq.HardBreak.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(Xq.Heading.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(Fc.UndoRedo.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(Yq.HorizontalRule.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(Zq.Italic.configure(this.options.italic)),this.options.listItem!==!1&&i.push(Lc.ListItem.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(Lc.ListKeymap.configure((r=this.options)==null?void 0:r.listKeymap)),this.options.link!==!1&&i.push(Qq.Link.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&i.push(Lc.OrderedList.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(eV.Paragraph.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(tV.Strike.configure(this.options.strike)),this.options.text!==!1&&i.push(rV.Text.configure(this.options.text)),this.options.underline!==!1&&i.push(nV.Underline.configure((t=this.options)==null?void 0:t.underline)),this.options.trailingNode!==!1&&i.push(Fc.TrailingNode.configure((n=this.options)==null?void 0:n.trailingNode)),i}}),iV=WP});var GP=xe((cee,KP)=>{"use strict";var bg=Object.defineProperty,sV=Object.getOwnPropertyDescriptor,oV=Object.getOwnPropertyNames,aV=Object.prototype.hasOwnProperty,lV=(r,e)=>{for(var t in e)bg(r,t,{get:e[t],enumerable:!0})},uV=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of oV(e))!aV.call(r,i)&&i!==t&&bg(r,i,{get:()=>e[i],enumerable:!(n=sV(e,i))||n.enumerable});return r},cV=r=>uV(bg({},"__esModule",{value:!0}),r),VP={};lV(VP,{BulletList:()=>hV.BulletList,default:()=>dV});KP.exports=cV(VP);var fV=Xn(),hV=Xn(),dV=fV.BulletList});var XP=xe((fee,JP)=>{"use strict";var _g=Object.defineProperty,pV=Object.getOwnPropertyDescriptor,mV=Object.getOwnPropertyNames,gV=Object.prototype.hasOwnProperty,vV=(r,e)=>{for(var t in e)_g(r,t,{get:e[t],enumerable:!0})},yV=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of mV(e))!gV.call(r,i)&&i!==t&&_g(r,i,{get:()=>e[i],enumerable:!(n=pV(e,i))||n.enumerable});return r},wV=r=>yV(_g({},"__esModule",{value:!0}),r),$P={};vV($P,{OrderedList:()=>_V.OrderedList,default:()=>xV});JP.exports=wV($P);var bV=Xn(),_V=Xn(),xV=bV.OrderedList});var QP=xe((hee,ZP)=>{"use strict";var xg=Object.defineProperty,EV=Object.getOwnPropertyDescriptor,SV=Object.getOwnPropertyNames,kV=Object.prototype.hasOwnProperty,TV=(r,e)=>{for(var t in e)xg(r,t,{get:e[t],enumerable:!0})},AV=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of SV(e))!kV.call(r,i)&&i!==t&&xg(r,i,{get:()=>e[i],enumerable:!(n=EV(e,i))||n.enumerable});return r},OV=r=>AV(xg({},"__esModule",{value:!0}),r),YP={};TV(YP,{ListItem:()=>RV.ListItem,default:()=>CV});ZP.exports=OV(YP);var NV=Xn(),RV=Xn(),CV=NV.ListItem});var Sg=xe((dee,nD)=>{"use strict";var Eg=Object.defineProperty,IV=Object.getOwnPropertyDescriptor,PV=Object.getOwnPropertyNames,DV=Object.prototype.hasOwnProperty,MV=(r,e)=>{for(var t in e)Eg(r,t,{get:e[t],enumerable:!0})},LV=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of PV(e))!DV.call(r,i)&&i!==t&&Eg(r,i,{get:()=>e[i],enumerable:!(n=IV(e,i))||n.enumerable});return r},FV=r=>LV(Eg({},"__esModule",{value:!0}),r),tD={};MV(tD,{Subscript:()=>rD,default:()=>BV});nD.exports=FV(tD);var eD=Se(),rD=eD.Mark.create({name:"subscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sub"},{style:"vertical-align",getAttrs(r){return r!=="sub"?!1:null}}]},renderHTML({HTMLAttributes:r}){return["sub",(0,eD.mergeAttributes)(this.options.HTMLAttributes,r),0]},addCommands(){return{setSubscript:()=>({commands:r})=>r.setMark(this.name),toggleSubscript:()=>({commands:r})=>r.toggleMark(this.name),unsetSubscript:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-,":()=>this.editor.commands.toggleSubscript()}}}),BV=rD});var Tg=xe((pee,aD)=>{"use strict";var kg=Object.defineProperty,UV=Object.getOwnPropertyDescriptor,HV=Object.getOwnPropertyNames,zV=Object.prototype.hasOwnProperty,jV=(r,e)=>{for(var t in e)kg(r,t,{get:e[t],enumerable:!0})},WV=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of HV(e))!zV.call(r,i)&&i!==t&&kg(r,i,{get:()=>e[i],enumerable:!(n=UV(e,i))||n.enumerable});return r},qV=r=>WV(kg({},"__esModule",{value:!0}),r),sD={};jV(sD,{Superscript:()=>oD,default:()=>VV});aD.exports=qV(sD);var iD=Se(),oD=iD.Mark.create({name:"superscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sup"},{style:"vertical-align",getAttrs(r){return r!=="super"?!1:null}}]},renderHTML({HTMLAttributes:r}){return["sup",(0,iD.mergeAttributes)(this.options.HTMLAttributes,r),0]},addCommands(){return{setSuperscript:()=>({commands:r})=>r.setMark(this.name),toggleSuperscript:()=>({commands:r})=>r.toggleMark(this.name),unsetSuperscript:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-.":()=>this.editor.commands.toggleSuperscript()}}}),VV=oD});var Og=xe((mee,vD)=>{"use strict";var Ag=Object.defineProperty,KV=Object.getOwnPropertyDescriptor,GV=Object.getOwnPropertyNames,$V=Object.prototype.hasOwnProperty,JV=(r,e)=>{for(var t in e)Ag(r,t,{get:e[t],enumerable:!0})},XV=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of GV(e))!$V.call(r,i)&&i!==t&&Ag(r,i,{get:()=>e[i],enumerable:!(n=KV(e,i))||n.enumerable});return r},YV=r=>XV(Ag({},"__esModule",{value:!0}),r),uD={};JV(uD,{BackgroundColor:()=>hD,Color:()=>dD,FontFamily:()=>pD,FontSize:()=>mD,LineHeight:()=>gD,TextStyle:()=>fD,TextStyleKit:()=>oK});vD.exports=YV(uD);var lD=Se(),ZV=20,cD=(r,e=0)=>{let t=[];return!r.children.length||e>ZV||Array.from(r.children).forEach(n=>{n.tagName==="SPAN"?t.push(n):n.children.length&&t.push(...cD(n,e+1))}),t},QV=r=>{if(!r.children.length)return;let e=cD(r);e&&e.forEach(t=>{var n,i;let s=t.getAttribute("style"),a=(i=(n=t.parentElement)==null?void 0:n.closest("span"))==null?void 0:i.getAttribute("style");t.setAttribute("style",`${a};${s}`)})},fD=lD.Mark.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:r=>r.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&QV(r),{}):!1}]},renderHTML({HTMLAttributes:r}){return["span",(0,lD.mergeAttributes)(this.options.HTMLAttributes,r),0]},addCommands(){return{toggleTextStyle:r=>({commands:e})=>e.toggleMark(this.name,r),removeEmptyTextStyle:()=>({tr:r})=>{let{selection:e}=r;return r.doc.nodesBetween(e.from,e.to,(t,n)=>{if(t.isTextblock)return!0;t.marks.filter(i=>i.type===this.type).some(i=>Object.values(i.attrs).some(s=>!!s))||r.removeMark(n,n+t.nodeSize,this.type)}),!0}}}}),eK=Se(),hD=eK.Extension.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:r=>{var e;let t=r.getAttribute("style");if(t){let n=t.split(";").map(i=>i.trim()).filter(Boolean);for(let i=n.length-1;i>=0;i-=1){let s=n[i].split(":");if(s.length>=2){let a=s[0].trim().toLowerCase(),o=s.slice(1).join(":").trim();if(a==="background-color")return o.replace(/['"]+/g,"")}}}return(e=r.style.backgroundColor)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:r=>r.backgroundColor?{style:`background-color: ${r.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:r=>({chain:e})=>e().setMark("textStyle",{backgroundColor:r}).run(),unsetBackgroundColor:()=>({chain:r})=>r().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),tK=Se(),dD=tK.Extension.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:r=>{var e;let t=r.getAttribute("style");if(t){let n=t.split(";").map(i=>i.trim()).filter(Boolean);for(let i=n.length-1;i>=0;i-=1){let s=n[i].split(":");if(s.length>=2){let a=s[0].trim().toLowerCase(),o=s.slice(1).join(":").trim();if(a==="color")return o.replace(/['"]+/g,"")}}}return(e=r.style.color)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:r=>r.color?{style:`color: ${r.color}`}:{}}}}]},addCommands(){return{setColor:r=>({chain:e})=>e().setMark("textStyle",{color:r}).run(),unsetColor:()=>({chain:r})=>r().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),rK=Se(),pD=rK.Extension.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:r=>r.style.fontFamily,renderHTML:r=>r.fontFamily?{style:`font-family: ${r.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:r=>({chain:e})=>e().setMark("textStyle",{fontFamily:r}).run(),unsetFontFamily:()=>({chain:r})=>r().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),nK=Se(),mD=nK.Extension.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:r=>r.style.fontSize,renderHTML:r=>r.fontSize?{style:`font-size: ${r.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:r=>({chain:e})=>e().setMark("textStyle",{fontSize:r}).run(),unsetFontSize:()=>({chain:r})=>r().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),iK=Se(),gD=iK.Extension.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:r=>r.style.lineHeight,renderHTML:r=>r.lineHeight?{style:`line-height: ${r.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:r=>({chain:e})=>e().setMark("textStyle",{lineHeight:r}).run(),unsetLineHeight:()=>({chain:r})=>r().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}}),sK=Se(),oK=sK.Extension.create({name:"textStyleKit",addExtensions(){let r=[];return this.options.backgroundColor!==!1&&r.push(hD.configure(this.options.backgroundColor)),this.options.color!==!1&&r.push(dD.configure(this.options.color)),this.options.fontFamily!==!1&&r.push(pD.configure(this.options.fontFamily)),this.options.fontSize!==!1&&r.push(mD.configure(this.options.fontSize)),this.options.lineHeight!==!1&&r.push(gD.configure(this.options.lineHeight)),this.options.textStyle!==!1&&r.push(fD.configure(this.options.textStyle)),r}})});var wD=xe((gee,yD)=>{var{Node:aK,mergeAttributes:lK}=Se(),uK=aK.create({name:"footnote",group:"inline",inline:!0,atom:!0,addAttributes(){return{id:{default:null,parseHTML:r=>r.getAttribute("data-id"),renderHTML:r=>({"data-id":r.id})},number:{default:null}}},parseHTML(){return[{tag:'span[data-type="footnote"]'}]},renderHTML({HTMLAttributes:r}){return["span",lK(r,{"data-type":"footnote",class:"colophon-footnote"}),["sup",{class:"footnote-symbol"},r.number||"#"]]},addCommands(){return{addFootnote:()=>({commands:r})=>{let e=`fn-${Date.now()}`;return r.insertContent({type:this.name,attrs:{id:e,number:"#"}})}}}});yD.exports=uK});var Ng=xe((vee,bD)=>{var{Extension:cK,InputRule:Ds}=Se(),fK=cK.create({name:"substitutions",addOptions(){return{smartQuotes:!0,smartDashes:!0,doubleQuoteStyle:"\u201C|\u201D",singleQuoteStyle:"\u2018|\u2019"}},addInputRules(){let r=[];if(this.options.smartDashes&&(r.push(new Ds({find:/---\s$/,handler:({state:e,range:t})=>e.tr.insertText("\u2014 ",t.from,t.to)})),r.push(new Ds({find:/--\s$/,handler:({state:e,range:t})=>e.tr.insertText("\u2013 ",t.from,t.to)}))),this.options.smartQuotes){let[e,t]=this.options.doubleQuoteStyle.split("|"),[n,i]=this.options.singleQuoteStyle.split("|");r.push(new Ds({find:/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,handler:({state:s,range:a,match:o})=>{let l=o[0],u=l.substring(0,l.length-1);return s.tr.insertText(u+e,a.from,a.to)}})),r.push(new Ds({find:/"$/,handler:({state:s,range:a})=>s.tr.insertText(t,a.from,a.to)})),r.push(new Ds({find:/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,handler:({state:s,range:a,match:o})=>{let l=o[0],u=l.substring(0,l.length-1);return s.tr.insertText(u+n,a.from,a.to)}})),r.push(new Ds({find:/'$/,handler:({state:s,range:a})=>s.tr.insertText(i,a.from,a.to)}))}return r}});bD.exports=fK});var xD=xe((wee,_D)=>{var{SuggestModal:hK}=require("obsidian"),{TextSelection:yee}=Pe(),Rg=class extends hK{constructor(e,t,n){super(e),this.app=e,this.editor=t,this.range=n,this.updateListener=()=>this.updateAndFilterSuggestions()}onOpen(){super.onOpen(),this.editor.on("update",this.updateListener),this.updateAndFilterSuggestions()}onClose(){super.onClose(),this.editor.off("update",this.updateListener)}updateAndFilterSuggestions(){let e=this.getEditorQuery();if(e===null){this.close();return}this.inputEl.value=e,this.onInput()}getEditorQuery(){try{let e=this.editor.state,t=e.selection.from;return t<this.range.from+2||e.doc.textBetween(this.range.from,this.range.from+2)!=="[["?null:e.doc.textBetween(this.range.from+2,t)}catch{return null}}getSuggestions(e){let t=this.app.vault.getMarkdownFiles();if(!e)return t;let n=e.toLowerCase();return t.filter(i=>i.path.toLowerCase().includes(n)||i.basename.toLowerCase().includes(n))}renderSuggestion(e,t){t.createEl("div",{text:e.basename}),t.createEl("small",{text:e.path})}onChooseSuggestion(e,t){let n=e.basename;if(this.editor&&!this.editor.isDestroyed){let{schema:i,tr:s}=this.editor.state,a=this.range.from,o=this.editor.state.selection.from;s.replaceWith(a,o,i.text(n,[i.marks.internallink.create({href:n})])),this.editor.view.dispatch(s)}}};_D.exports=Rg});var Cg=xe((bee,SD)=>{var{Mark:dK,InputRule:pK,mergeAttributes:mK}=Se(),{Plugin:ED,PluginKey:gK}=Pe(),vK=xD(),yK=dK.create({name:"internallink",inclusive:!1,addOptions(){return{app:null,HTMLAttributes:{class:"internal-link"}}},parseHTML(){return[{tag:"a.internal-link"}]},addAttributes(){return{href:{default:null},text:{default:null}}},renderHTML({HTMLAttributes:r}){return["a",mK(this.options.HTMLAttributes,r),0]},addInputRules(){return[new pK({find:/\[\[([^|\]]+)(?:\|([^\]]+))?\]\]$/,handler:({state:r,range:e,match:t})=>{let{tr:n}=r,i=e.from,s=e.to,a=t[1],o=t[2],l=o||a;return n.replaceWith(i,s,r.schema.text(l,[r.schema.marks.internallink.create({href:a,text:o})])),n}})]},addProseMirrorPlugins(){let r=this,e=r.editor,t=(s,a)=>{let o=s.marks().find(f=>f.type===a);if(!o)return null;let l=s.pos,u=s.pos,c=s.index();for(let f=c;f>=0;f--){let d=s.parent.child(f);if(o.isInSet(d.marks))l=s.start()+d.content.findIndex(d).offset;else break}for(let f=c;f<s.parent.childCount;f++){let d=s.parent.child(f);if(o.isInSet(d.marks))u=s.start()+d.content.findIndex(d).offset+d.nodeSize;else break}return{from:l,to:u,mark:o}},n=new ED({key:new gK("internallink-live-preview"),state:{init(){return{activeLink:null}},apply(s,a,o,l){let{selection:u}=s,c=a.activeLink,f=null;if(c){let{from:d,to:h}=c,y=s.mapping.map(d),v=s.mapping.map(h);u.from>=y&&u.to<=v&&(f={from:y,to:v,text:l.doc.textBetween(y,v)})}if(u.empty){let d=t(u.$from,l.schema.marks.internallink);if(d){let{from:h,to:y,mark:v}=d,x=v.attrs.text,m=x?`[[${v.attrs.href}|${x}]]`:`[[${v.attrs.href}]]`;f={from:h,to:y,text:m,mark:v}}}return JSON.stringify(f)===JSON.stringify(c)?a:{activeLink:f}}},view(s){return{update:(a,o)=>{let l=this.key.getState(a.state),u=this.key.getState(o);if(l.activeLink&&!u.activeLink){let{from:c,to:f,text:d}=l.activeLink;a.dispatch(a.state.tr.removeMark(c,f).replaceWith(c,f,a.state.schema.text(d)).setMeta("addToHistory",!1))}else if(!l.activeLink&&u.activeLink){let{from:c,to:f}=u.activeLink,h=o.doc.textBetween(c,f).match(/\[\[([^|\]]+)(?:\|([^\]]+))?\]\]/),y=a.state.tr;if(h){let v=h[1],x=h[2],m=x||v;y.replaceWith(c,f,a.state.schema.text(m,[a.state.schema.marks.internallink.create({href:v,text:x})]))}y.docChanged&&a.dispatch(y)}}}}});return[new ED({props:{handleDOMEvents:{click(s,a){let o=a.target.closest(".internal-link");if(!o)return!1;let l=o.getAttribute("href");if(l&&r.options.app){a.preventDefault(),a.stopPropagation();let u=r.options.getFilePath?r.options.getFilePath():"",c=navigator.platform.toUpperCase().indexOf("MAC")>=0?a.metaKey:a.ctrlKey,f=a.altKey;return c&&f?r.options.app.workspace.openLinkText(l,u,"split"):c?r.options.app.workspace.openLinkText(l,u,"tab"):r.options.app.workspace.openLinkText(l,u,!1),!0}return!1}},handleTextInput(s,a,o,l){return l==="["&&r.options.app&&s.state.doc.textBetween(a-1,a)==="["&&setTimeout(()=>{new vK(r.options.app,r.editor,{from:a-1,to:a+1}).open()},0),!1}}}),n]}});SD.exports=yK});var TD=xe((_ee,kD)=>{var{Mark:wK,InputRule:bK,mergeAttributes:_K}=Se(),{Plugin:xK}=Pe(),EK=wK.create({name:"standardLink",inclusive:!1,addOptions(){return{app:null,HTMLAttributes:{class:"standard-link"}}},addAttributes(){return{href:{default:null}}},parseHTML(){return[{tag:"a[href]:not(.internal-link)"}]},renderHTML({HTMLAttributes:r}){return["a",_K(this.options.HTMLAttributes,r),0]},addInputRules(){return[new bK({find:/\[([^\]]+)\]\(([^)]+)\)$/,handler:({state:r,range:e,match:t})=>{let{tr:n}=r,i=e.from,s=e.to,a=t[1],o=t[2];return n.replaceWith(i,s,r.schema.text(a,[r.schema.marks.standardLink.create({href:o})])),n}})]},addProseMirrorPlugins(){let r=this;return[new xK({props:{handleDOMEvents:{click(e,t){let n=t.target.closest("a.standard-link");if(!n)return!1;let i=n.getAttribute("href");if(i&&r.options.app){if(t.preventDefault(),t.stopPropagation(),/^(http|https|mailto|tel):/.test(i))return window.open(i,"_blank"),!0;let a=r.options.getFilePath?r.options.getFilePath():"",o=navigator.platform.toUpperCase().indexOf("MAC")>=0?t.metaKey:t.ctrlKey,l=t.altKey;return o&&l?r.options.app.workspace.openLinkText(i,a,"split"):o?r.options.app.workspace.openLinkText(i,a,"tab"):r.options.app.workspace.openLinkText(i,a,!1),!0}return!1}}}})]}});kD.exports=EK});var OD=xe((xee,AD)=>{var Ig=class{constructor(){this.styles={}}generateCSS(e){this.styles=e;let t="",n=1;if(e.scale){let i=String(e.scale);i.endsWith("%")?n=parseFloat(i)/100:n=parseFloat(i),isNaN(n)&&(n=1)}for(let[i,s]of Object.entries(e))if(i!=="scale")if(s.type==="list"){let a=this.generateListCSS(i,s,n);a&&(t+=a)}else if(s.type==="footnote"){let a=this.generateFootnoteCSS(i,s,n);a&&(t+=a)}else{let a=this.getSelector(i),o=this.mapStyleToCSS(s,n);o&&(t+=`${a} {
${o}
}
`)}return t}getSelector(e){let t=".colophon-workspace .ProseMirror";if(e&&e.startsWith("heading-")){let n=e.split("-")[1];return`${t} h${n}.${e}`}else return e==="title"?`${t} h1.title`:e==="supertitle"?`${t} p.supertitle`:e==="footnote"?".colophon-footnote-view .colophon-footnote-editor-content p":e==="footnote-number"?"span.colophon-footnote-number":`${t} p.${e}`}mapStyleToCSS(e,t=1){let n=[];if(e["font-family"]&&n.push(`    font-family: ${this.formatFontFamily(e["font-family"])};`),e["font-size"]&&n.push(`    font-size: ${this.convertValue(e["font-size"],"font-size",t)};`),e["text-align"]&&n.push(`    text-align: ${e["text-align"]};`),e["line-spacing"]&&n.push(`    line-height: ${this.convertValue(e["line-spacing"],"line-spacing",t)};`),e["before-paragraph"]&&n.push(`    margin-top: ${this.convertValue(e["before-paragraph"],"spacing",t)};`),e["after-paragraph"]&&n.push(`    margin-bottom: ${this.convertValue(e["after-paragraph"],"spacing",t)};`),e["first-indent"]&&n.push(`    text-indent: ${this.convertValue(e["first-indent"],"indent",t)};`),e["left-indent"]&&n.push(`    margin-left: ${this.convertValue(e["left-indent"],"indent",t)};`),e["right-indent"]&&n.push(`    margin-right: ${this.convertValue(e["right-indent"],"indent",t)};`),e["font-variant"]){let i=e["font-variant"].toLowerCase();i==="italic"?n.push("    font-style: italic;"):i==="bold"?n.push("    font-weight: bold;"):i==="small-caps"?n.push("    font-variant: small-caps;"):(n.push("    font-style: normal;"),n.push("    font-weight: normal;"),n.push("    font-variant: normal;"))}return e.capitalization&&(e.capitalization==="small-caps"?n.push("    font-variant: small-caps;"):n.push(`    text-transform: ${e.capitalization};`)),e["character-spacing"]&&n.push(`    letter-spacing: ${e["character-spacing"]};`),e["keep-with-next"]&&(n.push("    page-break-after: avoid;"),n.push("    break-after: avoid;")),e.color&&n.push(`    color: ${e.color};`),e["font-weight"]&&n.push(`    font-weight: ${e["font-weight"]};`),n.join(`
`)}generateListCSS(e,t,n=1){let i="",s=t.defaults||{},a=t.levels||{};for(let o=1;o<=9;o++){let l={...s,...a[o]||{}},u=`.colophon-workspace .ProseMirror :is(ul, ol).${e}`;if(o>1){let m=o-1;for(let _=0;_<m;_++)u+=" > li > :is(ul, ol)"}let c=`    list-style-type: none;
    padding-left: 0;
    margin-left: 0;
    margin-top: 0;
    margin-bottom: 0;
`;(l["list-type"]==="ordered"||l.type==="ordered")&&(c+=`    counter-reset: colophon-list-item;
`),i+=`${u} {
${c}}
`;let f=`${u} > li`,d=this.convertValue(l["text-indent"],"indent",n),h=this.convertValue(l["marker-indent"],"indent",n),y=`    position: relative;
`;y+=`    padding-left: ${d};
`,y+=`    margin-left: 0;
`,i+=`${f} {
${y}}
`,i+=`${f} > p {
    position: relative;
    text-indent: 0;
    margin: 0;
}
`;let v=`    position: absolute;
`;if(v+=`    left: calc(${h} - ${d});
`,v+=`    top: 0;
`,l.align){let m=this.convertValue(l.align,"indent",n);v+=`    transform: translateY(calc(-1 * ${m}));
`}if(l.color&&l.color!=="inherit"&&(v+=`    color: ${l.color};
`),l.size&&(v+=`    font-size: ${l.size};
`),l["font-weight"]&&(v+=`    font-weight: ${l["font-weight"]};
`),l["list-type"]==="ordered"||l.type==="ordered"){let m=l.marker||"decimal",_=l.suffix||".";v+=`    counter-increment: colophon-list-item;
`,v+=`    content: counter(colophon-list-item, ${m}) "${_}";
`}else{let _=(l.marker||"\u2022").replace(/"/g,'\\"');v+=`    content: "${_}";
`}i+=`${f} > p:first-child::before {
${v}}
`}return i}generateFootnoteCSS(e,t,n=1){let i=".colophon-workspace .ProseMirror .footnote-symbol",s=[];if(t["font-family"]&&s.push(`    font-family: ${t["font-family"]};`),t["font-size"]){let a=this.convertValue(t["font-size"],"font-size",n);s.push(`    font-size: ${a};`)}if(t.color&&s.push(`    color: ${t.color};`),t["font-weight"]&&s.push(`    font-weight: ${t["font-weight"]};`),s.push("    line-height: 0;"),t.align){let a=this.convertValue(t.align,"indent",n);s.push("    position: relative;"),s.push(`    top: calc(-1 * ${a});`),s.push("    vertical-align: baseline;")}return`${i} {
${s.join(`
`)}
}
`}convertValue(e,t,n=1){if(typeof e!="string"&&typeof e!="number")return e;let i=String(e),s=parseFloat(i);if(isNaN(s))return e;let a=s*n;if(i.endsWith("in"))return`${(a*6).toFixed(3)}rem`;if(t==="font-size"){if(i.endsWith("pt"))return`${(a/12).toFixed(3)}rem`}else if(t!=="indent"){if(t==="line-spacing"){if(i.endsWith("pt"))return`${(a/12).toFixed(3)}rem`;if(!i.match(/[a-z%]/i))return i}else if(t==="spacing"&&i.endsWith("pt"))return`${(a/12).toFixed(3)}rem`}return e}formatFontFamily(e){let t=String(e).trim();return t.includes("var(")||t.includes(",")||t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t:t.includes(" ")?`"${t}"`:t}getStyleOptions(e){let t=[],n=[];n.push({label:"None",value:"none",type:"list"});for(let[i,s]of Object.entries(e)){if(i==="scale"||i==="footnote"||i==="footnote-number")continue;let a=s.type||"paragraph",o={label:s.name||i,value:i,type:a,listType:s.defaults?.["list-type"]||"unordered"};a==="list"?n.push(o):(a==="paragraph"||!a)&&t.push(o)}return{paragraphOptions:t,listOptions:n}}};AD.exports=Ig});var RD=xe((Eee,ND)=>{var SK={scale:"100%",supertitle:{name:"Supertitle",type:"paragraph","font-size":"11.5pt","text-align":"center","line-spacing":"14pt","before-paragraph":"0pt","after-paragraph":"18pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular"},title:{name:"Title",type:"paragraph","font-size":"18pt","text-align":"center","line-spacing":"18pt","before-paragraph":"0pt","after-paragraph":"4pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular"},subtitle:{name:"Subtitle",type:"paragraph","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular","font-size":"14pt","line-spacing":"18pt","after-paragraph":"28pt","text-align":"center"},epigraph:{name:"Epigraph",type:"paragraph","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular","font-size":"11.5pt","line-spacing":"16pt","left-indent":"1in","right-indent":"1in","before-paragraph":"48pt","after-paragraph":"56pt"},"body-first":{name:"Body First",type:"paragraph","font-size":"11.5pt","text-align":"left","first-indent":"0in","left-indent":"0in","right-indent":"0in","line-spacing":"16pt","before-paragraph":"0pt","after-paragraph":"0pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular","following-style":"body"},body:{name:"Body",type:"paragraph","font-size":"11.5pt","text-align":"left","first-indent":"0.3in","left-indent":"0in","right-indent":"0in","line-spacing":"16pt","before-paragraph":"0pt","after-paragraph":"0pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular"},footnote:{name:"Footnote",type:"paragraph","font-size":"7pt","text-align":"left","first-indent":"0in","left-indent":"0in","right-indent":"0in","line-spacing":"9pt","before-paragraph":"0pt","after-paragraph":"0pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular","space-between-notes":"10pt",format:"1, 2, 3, \u2026",numbering:"continuous"},"footnote-number":{name:"Footnote Number",type:"pararaph","font-weight":"bold","font-family":"var(--font-text-theme), var(--font-text-override)","font-size":"7pt","line-spacing":"9pt"},"heading-1":{name:"Heading 1",type:"paragraph","font-size":"11.5pt","text-align":"left","first-indent":"0in","left-indent":"0in","right-indent":"0in","line-spacing":"28pt","before-paragraph":"28pt","after-paragraph":"14pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Italic","keep-with-next":!0,"following-style":"body-first"},"heading-2":{name:"Heading 2",type:"paragraph","font-size":"11.5pt","text-align":"left","first-indent":"0in","left-indent":"0in","right-indent":"0in","line-spacing":"28pt","before-paragraph":"28pt","after-paragraph":"14pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular",capitalization:"small-caps","character-spacing":"2%","keep-with-next":!0,"following-style":"body-first"},"heading-3":{name:"Heading 3",type:"paragraph","font-size":"11.5pt","text-align":"center","first-indent":"0in","left-indent":"0in","right-indent":"0in","line-spacing":"28pt","before-paragraph":"28pt","after-paragraph":"14pt","font-family":"var(--font-text-theme), var(--font-text-override)","font-variant":"Regular","keep-with-next":!0,"following-style":"body-first"},bullet:{name:"Bullet",type:"list",defaults:{"list-type":"unordered",marker:"\u2022",color:"inherit",size:"100%",align:"0pt","marker-indent":"0in","text-indent":"0.25in"}},numbered:{name:"Numbered",type:"list",defaults:{"list-type":"ordered",marker:"decimal",suffix:".",color:"inherit",size:"100%",align:"0pt","marker-indent":"0in","text-indent":"0.25in"}},"footnote-symbol":{name:"Footnote Symbol",type:"footnote",format:"integer",align:"4pt","font-size":"7pt","line-height":"0","font-family":"var(--font-text-theme), var(--font-text-override)",color:"var(--text-normal)"}};ND.exports=SK});var ID=xe((kee,CD)=>{var{Editor:kK,Mark:TK,Extension:AK,mergeAttributes:OK}=Se(),{StarterKit:NK}=wg(),{Paragraph:RK}=ng(),{Heading:CK}=xm(),{BulletList:IK}=GP(),{OrderedList:PK}=XP(),{ListItem:DK}=QP(),MK=Tc(),{Subscript:LK}=Sg(),{Superscript:FK}=Tg(),BK=Og(),{InputRule:See}=Se(),UK=wD(),HK=Ng(),zK=Cg(),jK=TD(),WK=OD(),qK=RD(),{parseYaml:VK}=require("obsidian"),KK=AK.create({name:"enterKeyHandler",addKeyboardShortcuts(){return{Enter:()=>{let{state:r}=this.editor,{$from:e}=r.selection;return e.parent.attrs.class!=="body"?this.editor.chain().focus().splitBlock().setNode("paragraph",{class:"body"}).run():this.editor.commands.splitBlock()}}}}),GK=RK.extend({addAttributes(){return{class:{default:"body",parseHTML:r=>r.getAttribute("class"),renderHTML:r=>r.class?{class:r.class}:{}}}}}),$K=CK.extend({addAttributes(){return{...this.parent?.(),level:{default:1,keepOnSplit:!1},class:{default:"heading-1",parseHTML:r=>r.getAttribute("class"),renderHTML:r=>r.class?{class:r.class}:{}}}}}),JK=IK.extend({addAttributes(){return{class:{default:"bullet",parseHTML:r=>r.getAttribute("class"),renderHTML:r=>({class:r.class})}}}}),XK=PK.extend({addAttributes(){return{class:{default:"ordered",parseHTML:r=>r.getAttribute("class"),renderHTML:r=>({class:r.class})}}}}),YK=DK.extend({}),ZK=TK.create({name:"smallCaps",parseHTML(){return[{style:"font-variant",getAttrs:r=>r==="small-caps"?{}:!1}]},renderHTML({HTMLAttributes:r}){return["span",OK(r,{style:"font-variant: small-caps"}),0]},addCommands(){return{toggleSmallCaps:()=>({commands:r})=>r.toggleMark(this.name)}}}),Pg=class{constructor(e,t,n,i,s,a){this.app=e,this.containerEl=t,this.toolbar=n,this.isSpellcheckEnabled=i,this.settings=s,this.onUpdate=a,this.editor=null,this.isLoaded=!1,this.footnotes=[],this.listeners=[],this.styleManager=new WK,this.paragraphOptions=[],this.listOptions=[]}normalizeDoc(e){return!e||!e.content||e.content.forEach(t=>{if(t.type==="paragraph")(!t.attrs||t.attrs.class===null||t.attrs.class===void 0)&&(t.attrs={...t.attrs,class:"body"});else if(t.type==="heading"&&(!t.attrs||t.attrs.class===null||t.attrs.class===void 0)){let n=t.attrs?.level||1;t.attrs={...t.attrs,class:`heading-${n}`}}}),e}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}updateSettings(e){this.settings=e,this.loadStyles(),this.editor&&this.handleScroll()}load(e,t,n){this.filePath=n,this.editor&&this.editor.destroy();let i=null;t&&(t.doc?(i=t.doc,this.footnotes=t.footnotes||[]):(i=t,this.footnotes=[])),i||(i={type:"doc",content:e.split(`

`).map(s=>({type:"paragraph",content:s.trim()?[{type:"text",text:s.trim()}]:[]}))},this.footnotes=[]),i=this.normalizeDoc(i),this.initEditor(i),this.isLoaded=!0}initEditor(e){let t=this.containerEl.createDiv("colophon-editor-host");this.loadStyles().then(()=>{}),this.editor=new kK({element:t,extensions:[NK.configure({paragraph:!1,heading:!1,bulletList:!1,orderedList:!1,listItem:!1}),KK,GK,$K,JK,XK,YK,MK,LK,FK,BK,ZK,UK,HK.configure({smartQuotes:this.settings.smartQuotes,smartDashes:this.settings.smartDashes,doubleQuoteStyle:this.settings.doubleQuoteStyle,singleQuoteStyle:this.settings.singleQuoteStyle}),zK.configure({app:this.app,getFilePath:()=>this.filePath}),jK.configure({app:this.app,getFilePath:()=>this.filePath})],editorProps:{attributes:{spellcheck:this.isSpellcheckEnabled?"true":"false"}},content:e,onUpdate:({editor:n})=>{this.triggerUpdate()},onSelectionUpdate:({editor:n})=>{this.handleScroll(),this.toolbar&&this.toolbar.update()},onFocus:({editor:n})=>{this.toolbar&&this.toolbar.setActiveEditor(n)}}),this.toolbar&&(this.toolbar.setActiveEditor(this.editor),this.toolbar.updateStyleOptions(this.paragraphOptions||[],this.listOptions||[]))}async loadStyles(){try{let e={...qK},t=this.settings.stylesFolder||"snippets",n=`${this.app.vault.configDir}/${t}`;if(await this.app.vault.adapter.exists(n))for(let o of this.settings.enabledStyles||[]){let l=`${n}/${o}`;if(await this.app.vault.adapter.exists(l))try{let u=await this.app.vault.adapter.read(l),c=VK(u);for(let[f,d]of Object.entries(c))e[f]&&typeof e[f]=="object"&&!Array.isArray(e[f])&&d&&typeof d=="object"&&!Array.isArray(d)?e[f]={...e[f],...d}:e[f]=d}catch(u){console.error(`Colophon: Failed to load style file ${o}`,u)}}let i=this.styleManager.generateCSS(e);this.injectStyles(i);let{paragraphOptions:s,listOptions:a}=this.styleManager.getStyleOptions(e);this.paragraphOptions=s,this.listOptions=a,this.toolbar&&this.toolbar.updateStyleOptions(this.paragraphOptions,this.listOptions),this.triggerUpdate()}catch(e){console.error("Colophon: Failed to load styles",e)}}injectStyles(e){let t="colophon-dynamic-styles",n=document.getElementById(t);n||(n=document.createElement("style"),n.id=t,document.head.appendChild(n)),n.textContent=e}handleScroll(){if(!this.editor||!this.editor.view.hasFocus())return;let{state:e}=this.editor;if(!e.selection.empty)return;let t=this.editor.view,n=e.selection.from,i=t.coordsAtPos(n),s=this.containerEl.getBoundingClientRect();if(this.settings.fixedFeedPosition){let o=1-(this.settings.feedPadding||0)/100,l=s.height*o,u=s.top+l,f=i.bottom-u;Math.abs(f)>2&&this.containerEl.scrollBy({top:f,behavior:"smooth"})}else if(i.top<s.top+20){let o=i.top-(s.top+20);this.containerEl.scrollBy({top:o,behavior:"auto"})}else if(i.bottom>s.bottom-20){let o=i.bottom-(s.bottom-20);this.containerEl.scrollBy({top:o,behavior:"auto"})}}triggerUpdate(){if(!this.editor)return;let e=[],t=1,n=!1;this.editor.state.doc.descendants((s,a)=>{if(s.type.name==="footnote"){let o=this.getFootnoteSymbol(t++);e.push({id:s.attrs.id,number:o,pos:a}),s.attrs.number!==o&&(n=!0)}});let i=e.map(s=>{let a=this.footnotes.find(o=>o.id===s.id);return{id:s.id,number:s.number,content:a?a.content:""}});this.footnotes=i,n&&Promise.resolve().then(()=>{if(!this.editor||this.editor.isDestroyed)return;let s=this.editor.state.tr,a=!1;this.editor.state.doc.descendants((o,l)=>{if(o.type.name==="footnote"){let u=e.find(c=>c.id===o.attrs.id)?.number;u&&o.attrs.number!==u&&(s.setNodeMarkup(l,null,{...o.attrs,number:u}),a=!0)}}),a&&this.editor.view.dispatch(s)}),this.onUpdate&&this.onUpdate({doc:this.editor.getJSON(),footnotes:this.footnotes}),this.listeners.forEach(s=>s())}addFootnote(){if(this.editor){let e=`fn-${Date.now()}`;return this.editor.chain().focus().insertContent({type:"footnote",attrs:{id:e,number:"#"}}).run(),e}}updateFootnote(e,t){let n=this.footnotes.find(i=>i.id===e);n&&(n.content=t,this.onUpdate&&this.onUpdate({doc:this.editor.getJSON(),footnotes:this.footnotes}))}getFootnotes(){return this.footnotes}destroy(){this.editor&&(this.editor.destroy(),this.editor=null)}focus(){this.editor&&this.editor.commands.focus()}getFootnoteSymbol(e){let t=this.styleManager.styles["footnote-symbol"],n=t?t.format:"integer";if(Array.isArray(n))return n.length===0?String(e):n[(e-1)%n.length];switch(n){case"lower-roman":return this.toRoman(e).toLowerCase();case"upper-roman":return this.toRoman(e);case"lower-alpha":return this.toAlpha(e).toLowerCase();case"upper-alpha":return this.toAlpha(e);case"integer":default:return String(e)}}toRoman(e){let t={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},n="";for(let i in t)for(;e>=t[i];)n+=i,e-=t[i];return n}toAlpha(e){let t="";for(;e>0;){let n=(e-1)%26;t=String.fromCharCode(65+n)+t,e=(e-n)/26|0}return t}getWordCounts(){if(!this.editor)return{main:0,footnotes:0};let e=this.countWordsInDoc(this.editor.state.doc),t=0;return this.footnotes.forEach(n=>{typeof n.content=="string"?t+=this.countWordsInText(n.content):typeof n.content=="object"&&(t+=this.countWordsInDocNode(n.content))}),{main:e,footnotes:t}}countWordsInDoc(e){let t=0;return e.descendants(n=>{n.isText&&(t+=this.countWordsInText(n.text))}),t}countWordsInDocNode(e){let t=0;return e.type==="text"&&e.text&&(t+=this.countWordsInText(e.text)),e.content&&Array.isArray(e.content)&&e.content.forEach(n=>{t+=this.countWordsInDocNode(n)}),t}countWordsInText(e){if(!e)return 0;let t=e.match(/\S+/g);return t?t.length:0}};CD.exports=Pg});var DD=xe((Tee,PD)=>{function QK(r){let e=r,t="",n=null,i=/^---\n[\s\S]*?\n---\n/,s=r.match(i);s&&(t=s[0],e=e.substring(t.length));let a=/%% colophon:data\s*(\{[\s\S]*?\})\s*%%$/,o=e.match(a);if(o)try{n=JSON.parse(o[1]),e=e.replace(a,"").trimEnd()}catch(l){console.error("Colophon: Failed to parse sidecar data",l)}return{markdown:e,data:n,frontmatter:t}}function eG(r,e,t=""){let n=t+r;if(e){let i=JSON.stringify(e,null,2);n=`${n.trimEnd()}

%% colophon:data ${i} %%`}return n}PD.exports={parseFile:QK,serializeFile:eG}});var UD=xe((Nee,BD)=>{var{FileView:tG,WorkspaceLeaf:Aee,Notice:Oee,debounce:MD}=require("obsidian"),LD=CT(),rG=ID(),{parseFile:nG,serializeFile:iG}=DD(),FD="colophon-view",Dg=class extends tG{constructor(e,t,n){super(e),this.plugin=n,this.settings=t||{textColumnWidth:1080},this.adapter=null,this.toolbar=null,this.data=null,this.markdownBody="",this.frontmatter="",this.themeToggleBtn=null,this.loaderEl=null,this.scrollEl=null,this.isForcedLight=!1,this.wordCountEl=null,this.save=MD(this.save.bind(this),1e3,!0),this.updateWordCount=MD(this.updateWordCount.bind(this),500,!1)}getViewType(){return FD}getDisplayText(){return this.file?this.file.basename:"No File"}getIcon(){return"feather"}async onOpen(){this.contentEl.empty(),this.contentEl.addClass("colophon-workspace"),this.applySettings();let e=this.containerEl.querySelector(".view-header");if(e){let n=e.querySelector(".view-header-center");if(!n){n=createDiv({cls:"view-header-center"});let i=e.querySelector(".view-actions");i?e.insertBefore(n,i):e.appendChild(n)}this.toolbar=new LD(n),this.toolbar.create()}else this.toolbar=new LD(this.contentEl),this.toolbar.create();this.scrollEl=this.contentEl.createDiv("colophon-scroll-container"),this.themeToggleBtn=this.addAction("sun-moon","Enable white canvas mode for this note",()=>{this.toggleTheme()}),this.showLoader();let t=this.app.vault.getConfig("spellcheck");this.adapter=new rG(this.app,this.scrollEl,this.toolbar,t,this.settings,n=>{this.data=n,this.save(),this.updateWordCount(),this.plugin.activateFootnoteView()}),this.plugin.settings.showWordCount&&this.toggleWordCount(!0),this.registerEvent(this.app.workspace.on("css-change",()=>{this.isForcedLight&&this.updateCanvasTheme()}))}onPaneMenu(e,t){super.onPaneMenu(e,t),e.addItem(n=>{n.setTitle("Export to DOCX").setIcon("document").onClick(async()=>{this.plugin.exportToDocx(this)})}),e.addItem(n=>{n.setTitle("Show word count").setIcon("calculator").setChecked(this.plugin.settings.showWordCount).onClick(async()=>{this.plugin.settings.showWordCount=!this.plugin.settings.showWordCount,await this.plugin.saveSettings(),this.toggleWordCount(this.plugin.settings.showWordCount)})})}showLoader(){this.loaderEl||(this.loaderEl=this.contentEl.createDiv("colophon-loader"),this.loaderEl.createDiv("colophon-loader-spinner"),this.loaderEl.createSpan({text:"Loading Manuscript..."}))}hideLoader(){this.loaderEl&&(this.loaderEl.remove(),this.loaderEl=null)}toggleTheme(){this.isForcedLight=!this.isForcedLight,this.themeToggleBtn&&(this.themeToggleBtn.classList.toggle("is-active",this.isForcedLight),this.isForcedLight?this.themeToggleBtn.setAttribute("aria-label","Disable white canvas mode for this note"):this.themeToggleBtn.setAttribute("aria-label","Enable white canvas mode for this note")),this.updateCanvasTheme()}updateCanvasTheme(){let e=["--background-primary","--text-normal","--text-muted","--text-accent","--text-selection","--background-modifier-border"];if(this.isForcedLight){let t=this.extractThemeVars("theme-light");for(let[n,i]of Object.entries(t))i&&this.contentEl.style.setProperty(n,i);this.contentEl.classList.add("colophon-forced-theme")}else{for(let t of e)this.contentEl.style.removeProperty(t);this.contentEl.classList.remove("colophon-forced-theme")}}toggleWordCount(e){e?this.wordCountEl||(this.wordCountEl=this.contentEl.createDiv("colophon-word-count-indicator"),this.updateWordCount()):this.wordCountEl&&(this.wordCountEl.remove(),this.wordCountEl=null)}updateWordCount(){if(!this.wordCountEl||!this.adapter)return;let e=this.adapter.getWordCounts(),t=e.main+e.footnotes;this.wordCountEl.setText(`${e.main} / ${t} (with footnotes)`)}extractThemeVars(e){let t=document.createElement("div");t.classList.add(e),t.style.display="none",document.body.appendChild(t);let n=window.getComputedStyle(t),i={"--background-primary":n.getPropertyValue("--background-primary").trim(),"--text-normal":n.getPropertyValue("--text-normal").trim(),"--text-muted":n.getPropertyValue("--text-muted").trim(),"--text-accent":n.getPropertyValue("--text-accent").trim(),"--text-selection":n.getPropertyValue("--text-selection").trim(),"--background-modifier-border":n.getPropertyValue("--background-modifier-border").trim()};return document.body.removeChild(t),i}updateSettings(e){this.settings=e,this.applySettings(),this.adapter&&this.adapter.updateSettings(this.settings)}applySettings(){this.contentEl&&this.contentEl.style.setProperty("--colophon-editor-width",`${this.settings.textColumnWidth}px`)}async onClose(){if(this.toolbar){this.toolbar.destroy();let e=this.containerEl.querySelector(".view-header");if(e){let t=e.querySelector(".view-header-center");t&&t.remove()}}this.adapter&&this.adapter.destroy()}async onLoadFile(e){!this.loaderEl&&!this.adapter?.isLoaded&&this.showLoader();let t=await this.app.vault.read(e),{markdown:n,data:i,frontmatter:s}=nG(t);this.markdownBody=n,this.data=i,this.frontmatter=s,this.adapter&&(this.adapter.load(n,i,this.file.path),this.hideLoader())}async onUnloadFile(e){this.adapter}async save(){if(!this.file||!this.data)return;let e=iG(this.markdownBody,this.data,this.frontmatter);await this.app.vault.modify(this.file,e)}async insertFootnote(){if(this.adapter){let e=this.adapter.addFootnote();if(e){await this.plugin.activateFootnoteView();let t=this.app.workspace.getLeavesOfType("colophon-footnote-view");if(t.length>0){let n=t[0].view;n&&(n.render(),setTimeout(()=>{n.focusFootnote(e)},50))}}}}};BD.exports={ColophonView:Dg,VIEW_TYPE:FD}});var jD=xe((Dee,zD)=>{var{ItemView:sG,WorkspaceLeaf:Ree,Notice:Cee,setIcon:Iee}=require("obsidian"),{Editor:oG,mergeAttributes:Pee}=Se(),{StarterKit:aG}=wg(),lG=Tc(),{Subscript:uG}=Sg(),{Superscript:cG}=Tg(),fG=Og(),hG=Ng(),dG=Cg(),HD="colophon-footnote-view",Mg=class extends sG{constructor(e,t,n){super(e),this.settings=t||{smartQuotes:!0,smartDashes:!0,doubleQuoteStyle:"\u201C|\u201D",singleQuoteStyle:"\u2018|\u2019"},this.isSpellcheckEnabled=n,this.adapter=null,this.editors=new Map}getViewType(){return HD}getDisplayText(){return"Footnotes"}getIcon(){return"list-ordered"}async onOpen(){let e=this.contentEl;e.empty(),e.addClass("colophon-footnote-view"),this.render()}async onClose(){this.editors.forEach(e=>e.destroy()),this.editors.clear(),this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}updateSettings(e){this.settings=e,this.render(!0)}setAdapter(e){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),this.adapter=e,this.adapter&&(this.unsubscribe=this.adapter.subscribe(()=>{this.render()})),this.render()}render(e=!1){let t=this.contentEl;if(!this.adapter){t.empty(),this.editors.forEach(a=>a.destroy()),this.editors.clear(),t.createEl("div",{text:"No active manuscript.",cls:"colophon-footnote-empty"});return}let n=this.adapter.getFootnotes();if(!n||n.length===0){t.empty(),this.editors.forEach(a=>a.destroy()),this.editors.clear(),t.createEl("div",{text:"No footnotes yet.",cls:"colophon-footnote-empty"});return}let i=t.querySelector(".colophon-footnote-list");i||(t.empty(),i=t.createEl("div",{cls:"colophon-footnote-list"}));let s=new Set(n.map(a=>a.id));for(let[a,o]of this.editors)if(!s.has(a)||e){o.destroy(),this.editors.delete(a);let l=i.querySelector(`[data-footnote-id="${a}"]`);l&&l.remove()}n.forEach((a,o)=>{let l=i.querySelector(`[data-footnote-id="${a.id}"]`);if(l){let u=l.querySelector(".colophon-footnote-number");u&&(u.innerText=`${a.number||o+1}. `)}else{l=i.createEl("div",{cls:"colophon-footnote-item"}),l.dataset.footnoteId=a.id,l.createEl("div",{cls:"colophon-footnote-header"}).createSpan({text:`${a.number||o+1}. `,cls:"colophon-footnote-number"});let c=l.createEl("div",{cls:"colophon-footnote-editor-container"}),f=new oG({element:c,extensions:[aG,lG,uG,cG,fG,hG.configure({smartQuotes:this.settings.smartQuotes,smartDashes:this.settings.smartDashes,doubleQuoteStyle:this.settings.doubleQuoteStyle,singleQuoteStyle:this.settings.singleQuoteStyle}),dG.configure({app:this.app})],content:a.content,onUpdate:({editor:d})=>{this.adapter.updateFootnote(a.id,d.getJSON())},editorProps:{attributes:{class:"colophon-footnote-editor-content",spellcheck:this.isSpellcheckEnabled?"true":"false"}},onFocus:({editor:d})=>{this.adapter&&this.adapter.toolbar&&this.adapter.toolbar.setActiveEditor(d,!0)},onSelectionUpdate:({editor:d})=>{this.adapter&&this.adapter.toolbar&&this.adapter.toolbar.update()}});this.editors.set(a.id,f)}}),n.forEach(a=>{let o=i.querySelector(`[data-footnote-id="${a.id}"]`);o&&i.appendChild(o)})}focusFootnote(e){let t=this.editors.get(e);if(t){t.commands.focus();let n=this.contentEl.querySelector(`[data-footnote-id="${e}"]`);n&&n.scrollIntoView({behavior:"smooth",block:"center"})}}getFocusedEditor(){for(let e of this.editors.values())if(e.isFocused)return e;return null}};zD.exports={FootnoteView:Mg,FOOTNOTE_VIEW_TYPE:HD}});function o1(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function a1(){if(qD)return Bc.exports;qD=1;var r=typeof Reflect=="object"?Reflect:null,e=r&&typeof r.apply=="function"?r.apply:function(T,P,M){return Function.prototype.apply.call(T,P,M)},t;r&&typeof r.ownKeys=="function"?t=r.ownKeys:Object.getOwnPropertySymbols?t=function(T){return Object.getOwnPropertyNames(T).concat(Object.getOwnPropertySymbols(T))}:t=function(T){return Object.getOwnPropertyNames(T)};function n(w){console&&console.warn&&console.warn(w)}var i=Number.isNaN||function(T){return T!==T};function s(){s.init.call(this)}Bc.exports=s,Bc.exports.once=m,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function o(w){if(typeof w!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof w)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(w){if(typeof w!="number"||w<0||i(w))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+w+".");a=w}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(T){if(typeof T!="number"||T<0||i(T))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+T+".");return this._maxListeners=T,this};function l(w){return w._maxListeners===void 0?s.defaultMaxListeners:w._maxListeners}s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(T){for(var P=[],M=1;M<arguments.length;M++)P.push(arguments[M]);var U=T==="error",R=this._events;if(R!==void 0)U=U&&R.error===void 0;else if(!U)return!1;if(U){var J;if(P.length>0&&(J=P[0]),J instanceof Error)throw J;var oe=new Error("Unhandled error."+(J?" ("+J.message+")":""));throw oe.context=J,oe}var C=R[T];if(C===void 0)return!1;if(typeof C=="function")e(C,this,P);else for(var H=C.length,k=y(C,H),M=0;M<H;++M)e(k[M],this,P);return!0};function u(w,T,P,M){var U,R,J;if(o(P),R=w._events,R===void 0?(R=w._events=Object.create(null),w._eventsCount=0):(R.newListener!==void 0&&(w.emit("newListener",T,P.listener?P.listener:P),R=w._events),J=R[T]),J===void 0)J=R[T]=P,++w._eventsCount;else if(typeof J=="function"?J=R[T]=M?[P,J]:[J,P]:M?J.unshift(P):J.push(P),U=l(w),U>0&&J.length>U&&!J.warned){J.warned=!0;var oe=new Error("Possible EventEmitter memory leak detected. "+J.length+" "+String(T)+" listeners added. Use emitter.setMaxListeners() to increase limit");oe.name="MaxListenersExceededWarning",oe.emitter=w,oe.type=T,oe.count=J.length,n(oe)}return w}s.prototype.addListener=function(T,P){return u(this,T,P,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(T,P){return u(this,T,P,!0)};function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(w,T,P){var M={fired:!1,wrapFn:void 0,target:w,type:T,listener:P},U=c.bind(M);return U.listener=P,M.wrapFn=U,U}s.prototype.once=function(T,P){return o(P),this.on(T,f(this,T,P)),this},s.prototype.prependOnceListener=function(T,P){return o(P),this.prependListener(T,f(this,T,P)),this},s.prototype.removeListener=function(T,P){var M,U,R,J,oe;if(o(P),U=this._events,U===void 0)return this;if(M=U[T],M===void 0)return this;if(M===P||M.listener===P)--this._eventsCount===0?this._events=Object.create(null):(delete U[T],U.removeListener&&this.emit("removeListener",T,M.listener||P));else if(typeof M!="function"){for(R=-1,J=M.length-1;J>=0;J--)if(M[J]===P||M[J].listener===P){oe=M[J].listener,R=J;break}if(R<0)return this;R===0?M.shift():v(M,R),M.length===1&&(U[T]=M[0]),U.removeListener!==void 0&&this.emit("removeListener",T,oe||P)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(T){var P,M,U;if(M=this._events,M===void 0)return this;if(M.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):M[T]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete M[T]),this;if(arguments.length===0){var R=Object.keys(M),J;for(U=0;U<R.length;++U)J=R[U],J!=="removeListener"&&this.removeAllListeners(J);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(P=M[T],typeof P=="function")this.removeListener(T,P);else if(P!==void 0)for(U=P.length-1;U>=0;U--)this.removeListener(T,P[U]);return this};function d(w,T,P){var M=w._events;if(M===void 0)return[];var U=M[T];return U===void 0?[]:typeof U=="function"?P?[U.listener||U]:[U]:P?x(U):y(U,U.length)}s.prototype.listeners=function(T){return d(this,T,!0)},s.prototype.rawListeners=function(T){return d(this,T,!1)},s.listenerCount=function(w,T){return typeof w.listenerCount=="function"?w.listenerCount(T):h.call(w,T)},s.prototype.listenerCount=h;function h(w){var T=this._events;if(T!==void 0){var P=T[w];if(typeof P=="function")return 1;if(P!==void 0)return P.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function y(w,T){for(var P=new Array(T),M=0;M<T;++M)P[M]=w[M];return P}function v(w,T){for(;T+1<w.length;T++)w[T]=w[T+1];w.pop()}function x(w){for(var T=new Array(w.length),P=0;P<T.length;++P)T[P]=w[P].listener||w[P];return T}function m(w,T){return new Promise(function(P,M){function U(J){w.removeListener(T,R),M(J)}function R(){typeof w.removeListener=="function"&&w.removeListener("error",U),P([].slice.call(arguments))}b(w,T,R,{once:!0}),T!=="error"&&_(w,U,{once:!0})})}function _(w,T,P){typeof w.on=="function"&&b(w,"error",T,P)}function b(w,T,P,M){if(typeof w.on=="function")M.once?w.once(T,P):w.on(T,P);else if(typeof w.addEventListener=="function")w.addEventListener(T,function U(R){M.once&&w.removeEventListener(T,U),P(R)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof w)}return Bc.exports}function ei(){return VD||(VD=1,typeof Object.create=="function"?Uc.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Uc.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),Uc.exports}function _G(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function _y(){throw new Error("setTimeout has not been defined")}function xy(){throw new Error("clearTimeout has not been defined")}function j2(r){if(jr===setTimeout)return setTimeout(r,0);if((jr===_y||!jr)&&setTimeout)return jr=setTimeout,setTimeout(r,0);try{return jr(r,0)}catch{try{return jr.call(null,r,0)}catch{return jr.call(this,r,0)}}}function xG(r){if(Wr===clearTimeout)return clearTimeout(r);if((Wr===xy||!Wr)&&clearTimeout)return Wr=clearTimeout,clearTimeout(r);try{return Wr(r)}catch{try{return Wr.call(null,r)}catch{return Wr.call(this,r)}}}function EG(){!Bs||!Ri||(Bs=!1,Ri.length?xn=Ri.concat(xn):Gc=-1,xn.length&&W2())}function W2(){if(!Bs){var r=j2(EG);Bs=!0;for(var e=xn.length;e;){for(Ri=xn,xn=[];++Gc<e;)Ri&&Ri[Gc].run();Gc=-1,e=xn.length}Ri=null,Bs=!1,xG(r)}}function q2(r,e){this.fun=r,this.array=e}function Cn(){}function V2(){return KD||(KD=1,Fg=a1().EventEmitter),Fg}function kG(){if(GD)return _a;GD=1,_a.byteLength=o,_a.toByteArray=u,_a.fromByteArray=d;for(var r=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,s=n.length;i<s;++i)r[i]=n[i],e[n.charCodeAt(i)]=i;e[45]=62,e[95]=63;function a(h){var y=h.length;if(y%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=h.indexOf("=");v===-1&&(v=y);var x=v===y?0:4-v%4;return[v,x]}function o(h){var y=a(h),v=y[0],x=y[1];return(v+x)*3/4-x}function l(h,y,v){return(y+v)*3/4-v}function u(h){var y,v=a(h),x=v[0],m=v[1],_=new t(l(h,x,m)),b=0,w=m>0?x-4:x,T;for(T=0;T<w;T+=4)y=e[h.charCodeAt(T)]<<18|e[h.charCodeAt(T+1)]<<12|e[h.charCodeAt(T+2)]<<6|e[h.charCodeAt(T+3)],_[b++]=y>>16&255,_[b++]=y>>8&255,_[b++]=y&255;return m===2&&(y=e[h.charCodeAt(T)]<<2|e[h.charCodeAt(T+1)]>>4,_[b++]=y&255),m===1&&(y=e[h.charCodeAt(T)]<<10|e[h.charCodeAt(T+1)]<<4|e[h.charCodeAt(T+2)]>>2,_[b++]=y>>8&255,_[b++]=y&255),_}function c(h){return r[h>>18&63]+r[h>>12&63]+r[h>>6&63]+r[h&63]}function f(h,y,v){for(var x,m=[],_=y;_<v;_+=3)x=(h[_]<<16&16711680)+(h[_+1]<<8&65280)+(h[_+2]&255),m.push(c(x));return m.join("")}function d(h){for(var y,v=h.length,x=v%3,m=[],_=16383,b=0,w=v-x;b<w;b+=_)m.push(f(h,b,b+_>w?w:b+_));return x===1?(y=h[v-1],m.push(r[y>>2]+r[y<<4&63]+"==")):x===2&&(y=(h[v-2]<<8)+h[v-1],m.push(r[y>>10]+r[y>>4&63]+r[y<<2&63]+"=")),m.join("")}return _a}function TG(){return $D||($D=1,Hc.read=function(r,e,t,n,i){var s,a,o=i*8-n-1,l=(1<<o)-1,u=l>>1,c=-7,f=t?i-1:0,d=t?-1:1,h=r[e+f];for(f+=d,s=h&(1<<-c)-1,h>>=-c,c+=o;c>0;s=s*256+r[e+f],f+=d,c-=8);for(a=s&(1<<-c)-1,s>>=-c,c+=n;c>0;a=a*256+r[e+f],f+=d,c-=8);if(s===0)s=1-u;else{if(s===l)return a?NaN:(h?-1:1)*(1/0);a=a+Math.pow(2,n),s=s-u}return(h?-1:1)*a*Math.pow(2,s-n)},Hc.write=function(r,e,t,n,i,s){var a,o,l,u=s*8-i-1,c=(1<<u)-1,f=c>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:s-1,y=n?1:-1,v=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+f>=1?e+=d/l:e+=d*Math.pow(2,1-f),e*l>=2&&(a++,l/=2),a+f>=c?(o=0,a=c):a+f>=1?(o=(e*l-1)*Math.pow(2,i),a=a+f):(o=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;r[t+h]=o&255,h+=y,o/=256,i-=8);for(a=a<<i|o,u+=i;u>0;r[t+h]=a&255,h+=y,a/=256,u-=8);r[t+h-y]|=v*128}),Hc}function wf(){return JD||(JD=1,(function(r){var e=kG(),t=TG(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=o,r.SlowBuffer=_,r.INSPECT_MAX_BYTES=50;var i=2147483647;r.kMaxLength=i,o.TYPED_ARRAY_SUPPORT=s(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{var N=new Uint8Array(1),p={foo:function(){return 42}};return Object.setPrototypeOf(p,Uint8Array.prototype),Object.setPrototypeOf(N,p),N.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function a(N){if(N>i)throw new RangeError('The value "'+N+'" is invalid for option "size"');var p=new Uint8Array(N);return Object.setPrototypeOf(p,o.prototype),p}function o(N,p,g){if(typeof N=="number"){if(typeof p=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(N)}return l(N,p,g)}o.poolSize=8192;function l(N,p,g){if(typeof N=="string")return d(N,p);if(ArrayBuffer.isView(N))return y(N);if(N==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof N);if(Z(N,ArrayBuffer)||N&&Z(N.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Z(N,SharedArrayBuffer)||N&&Z(N.buffer,SharedArrayBuffer)))return v(N,p,g);if(typeof N=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var S=N.valueOf&&N.valueOf();if(S!=null&&S!==N)return o.from(S,p,g);var F=x(N);if(F)return F;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof N[Symbol.toPrimitive]=="function")return o.from(N[Symbol.toPrimitive]("string"),p,g);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof N)}o.from=function(N,p,g){return l(N,p,g)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function u(N){if(typeof N!="number")throw new TypeError('"size" argument must be of type number');if(N<0)throw new RangeError('The value "'+N+'" is invalid for option "size"')}function c(N,p,g){return u(N),N<=0?a(N):p!==void 0?typeof g=="string"?a(N).fill(p,g):a(N).fill(p):a(N)}o.alloc=function(N,p,g){return c(N,p,g)};function f(N){return u(N),a(N<0?0:m(N)|0)}o.allocUnsafe=function(N){return f(N)},o.allocUnsafeSlow=function(N){return f(N)};function d(N,p){if((typeof p!="string"||p==="")&&(p="utf8"),!o.isEncoding(p))throw new TypeError("Unknown encoding: "+p);var g=b(N,p)|0,S=a(g),F=S.write(N,p);return F!==g&&(S=S.slice(0,F)),S}function h(N){for(var p=N.length<0?0:m(N.length)|0,g=a(p),S=0;S<p;S+=1)g[S]=N[S]&255;return g}function y(N){if(Z(N,Uint8Array)){var p=new Uint8Array(N);return v(p.buffer,p.byteOffset,p.byteLength)}return h(N)}function v(N,p,g){if(p<0||N.byteLength<p)throw new RangeError('"offset" is outside of buffer bounds');if(N.byteLength<p+(g||0))throw new RangeError('"length" is outside of buffer bounds');var S;return p===void 0&&g===void 0?S=new Uint8Array(N):g===void 0?S=new Uint8Array(N,p):S=new Uint8Array(N,p,g),Object.setPrototypeOf(S,o.prototype),S}function x(N){if(o.isBuffer(N)){var p=m(N.length)|0,g=a(p);return g.length===0||N.copy(g,0,0,p),g}if(N.length!==void 0)return typeof N.length!="number"||E(N.length)?a(0):h(N);if(N.type==="Buffer"&&Array.isArray(N.data))return h(N.data)}function m(N){if(N>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return N|0}function _(N){return+N!=N&&(N=0),o.alloc(+N)}o.isBuffer=function(p){return p!=null&&p._isBuffer===!0&&p!==o.prototype},o.compare=function(p,g){if(Z(p,Uint8Array)&&(p=o.from(p,p.offset,p.byteLength)),Z(g,Uint8Array)&&(g=o.from(g,g.offset,g.byteLength)),!o.isBuffer(p)||!o.isBuffer(g))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(p===g)return 0;for(var S=p.length,F=g.length,q=0,z=Math.min(S,F);q<z;++q)if(p[q]!==g[q]){S=p[q],F=g[q];break}return S<F?-1:F<S?1:0},o.isEncoding=function(p){switch(String(p).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(p,g){if(!Array.isArray(p))throw new TypeError('"list" argument must be an Array of Buffers');if(p.length===0)return o.alloc(0);var S;if(g===void 0)for(g=0,S=0;S<p.length;++S)g+=p[S].length;var F=o.allocUnsafe(g),q=0;for(S=0;S<p.length;++S){var z=p[S];if(Z(z,Uint8Array))q+z.length>F.length?o.from(z).copy(F,q):Uint8Array.prototype.set.call(F,z,q);else if(o.isBuffer(z))z.copy(F,q);else throw new TypeError('"list" argument must be an Array of Buffers');q+=z.length}return F};function b(N,p){if(o.isBuffer(N))return N.length;if(ArrayBuffer.isView(N)||Z(N,ArrayBuffer))return N.byteLength;if(typeof N!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof N);var g=N.length,S=arguments.length>2&&arguments[2]===!0;if(!S&&g===0)return 0;for(var F=!1;;)switch(p){case"ascii":case"latin1":case"binary":return g;case"utf8":case"utf-8":return A(N).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return g*2;case"hex":return g>>>1;case"base64":return I(N).length;default:if(F)return S?-1:A(N).length;p=(""+p).toLowerCase(),F=!0}}o.byteLength=b;function w(N,p,g){var S=!1;if((p===void 0||p<0)&&(p=0),p>this.length||((g===void 0||g>this.length)&&(g=this.length),g<=0)||(g>>>=0,p>>>=0,g<=p))return"";for(N||(N="utf8");;)switch(N){case"hex":return ee(this,p,g);case"utf8":case"utf-8":return k(this,p,g);case"ascii":return j(this,p,g);case"latin1":case"binary":return ie(this,p,g);case"base64":return H(this,p,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return le(this,p,g);default:if(S)throw new TypeError("Unknown encoding: "+N);N=(N+"").toLowerCase(),S=!0}}o.prototype._isBuffer=!0;function T(N,p,g){var S=N[p];N[p]=N[g],N[g]=S}o.prototype.swap16=function(){var p=this.length;if(p%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var g=0;g<p;g+=2)T(this,g,g+1);return this},o.prototype.swap32=function(){var p=this.length;if(p%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var g=0;g<p;g+=4)T(this,g,g+3),T(this,g+1,g+2);return this},o.prototype.swap64=function(){var p=this.length;if(p%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var g=0;g<p;g+=8)T(this,g,g+7),T(this,g+1,g+6),T(this,g+2,g+5),T(this,g+3,g+4);return this},o.prototype.toString=function(){var p=this.length;return p===0?"":arguments.length===0?k(this,0,p):w.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(p){if(!o.isBuffer(p))throw new TypeError("Argument must be a Buffer");return this===p?!0:o.compare(this,p)===0},o.prototype.inspect=function(){var p="",g=r.INSPECT_MAX_BYTES;return p=this.toString("hex",0,g).replace(/(.{2})/g,"$1 ").trim(),this.length>g&&(p+=" ... "),"<Buffer "+p+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(p,g,S,F,q){if(Z(p,Uint8Array)&&(p=o.from(p,p.offset,p.byteLength)),!o.isBuffer(p))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof p);if(g===void 0&&(g=0),S===void 0&&(S=p?p.length:0),F===void 0&&(F=0),q===void 0&&(q=this.length),g<0||S>p.length||F<0||q>this.length)throw new RangeError("out of range index");if(F>=q&&g>=S)return 0;if(F>=q)return-1;if(g>=S)return 1;if(g>>>=0,S>>>=0,F>>>=0,q>>>=0,this===p)return 0;for(var z=q-F,ne=S-g,ae=Math.min(z,ne),se=this.slice(F,q),fe=p.slice(g,S),pe=0;pe<ae;++pe)if(se[pe]!==fe[pe]){z=se[pe],ne=fe[pe];break}return z<ne?-1:ne<z?1:0};function P(N,p,g,S,F){if(N.length===0)return-1;if(typeof g=="string"?(S=g,g=0):g>2147483647?g=2147483647:g<-2147483648&&(g=-2147483648),g=+g,E(g)&&(g=F?0:N.length-1),g<0&&(g=N.length+g),g>=N.length){if(F)return-1;g=N.length-1}else if(g<0)if(F)g=0;else return-1;if(typeof p=="string"&&(p=o.from(p,S)),o.isBuffer(p))return p.length===0?-1:M(N,p,g,S,F);if(typeof p=="number")return p=p&255,typeof Uint8Array.prototype.indexOf=="function"?F?Uint8Array.prototype.indexOf.call(N,p,g):Uint8Array.prototype.lastIndexOf.call(N,p,g):M(N,[p],g,S,F);throw new TypeError("val must be string, number or Buffer")}function M(N,p,g,S,F){var q=1,z=N.length,ne=p.length;if(S!==void 0&&(S=String(S).toLowerCase(),S==="ucs2"||S==="ucs-2"||S==="utf16le"||S==="utf-16le")){if(N.length<2||p.length<2)return-1;q=2,z/=2,ne/=2,g/=2}function ae(Me,yt){return q===1?Me[yt]:Me.readUInt16BE(yt*q)}var se;if(F){var fe=-1;for(se=g;se<z;se++)if(ae(N,se)===ae(p,fe===-1?0:se-fe)){if(fe===-1&&(fe=se),se-fe+1===ne)return fe*q}else fe!==-1&&(se-=se-fe),fe=-1}else for(g+ne>z&&(g=z-ne),se=g;se>=0;se--){for(var pe=!0,ve=0;ve<ne;ve++)if(ae(N,se+ve)!==ae(p,ve)){pe=!1;break}if(pe)return se}return-1}o.prototype.includes=function(p,g,S){return this.indexOf(p,g,S)!==-1},o.prototype.indexOf=function(p,g,S){return P(this,p,g,S,!0)},o.prototype.lastIndexOf=function(p,g,S){return P(this,p,g,S,!1)};function U(N,p,g,S){g=Number(g)||0;var F=N.length-g;S?(S=Number(S),S>F&&(S=F)):S=F;var q=p.length;S>q/2&&(S=q/2);for(var z=0;z<S;++z){var ne=parseInt(p.substr(z*2,2),16);if(E(ne))return z;N[g+z]=ne}return z}function R(N,p,g,S){return L(A(p,N.length-g),N,g,S)}function J(N,p,g,S){return L(W(p),N,g,S)}function oe(N,p,g,S){return L(I(p),N,g,S)}function C(N,p,g,S){return L(B(p,N.length-g),N,g,S)}o.prototype.write=function(p,g,S,F){if(g===void 0)F="utf8",S=this.length,g=0;else if(S===void 0&&typeof g=="string")F=g,S=this.length,g=0;else if(isFinite(g))g=g>>>0,isFinite(S)?(S=S>>>0,F===void 0&&(F="utf8")):(F=S,S=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var q=this.length-g;if((S===void 0||S>q)&&(S=q),p.length>0&&(S<0||g<0)||g>this.length)throw new RangeError("Attempt to write outside buffer bounds");F||(F="utf8");for(var z=!1;;)switch(F){case"hex":return U(this,p,g,S);case"utf8":case"utf-8":return R(this,p,g,S);case"ascii":case"latin1":case"binary":return J(this,p,g,S);case"base64":return oe(this,p,g,S);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,p,g,S);default:if(z)throw new TypeError("Unknown encoding: "+F);F=(""+F).toLowerCase(),z=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function H(N,p,g){return p===0&&g===N.length?e.fromByteArray(N):e.fromByteArray(N.slice(p,g))}function k(N,p,g){g=Math.min(N.length,g);for(var S=[],F=p;F<g;){var q=N[F],z=null,ne=q>239?4:q>223?3:q>191?2:1;if(F+ne<=g){var ae,se,fe,pe;switch(ne){case 1:q<128&&(z=q);break;case 2:ae=N[F+1],(ae&192)===128&&(pe=(q&31)<<6|ae&63,pe>127&&(z=pe));break;case 3:ae=N[F+1],se=N[F+2],(ae&192)===128&&(se&192)===128&&(pe=(q&15)<<12|(ae&63)<<6|se&63,pe>2047&&(pe<55296||pe>57343)&&(z=pe));break;case 4:ae=N[F+1],se=N[F+2],fe=N[F+3],(ae&192)===128&&(se&192)===128&&(fe&192)===128&&(pe=(q&15)<<18|(ae&63)<<12|(se&63)<<6|fe&63,pe>65535&&pe<1114112&&(z=pe))}}z===null?(z=65533,ne=1):z>65535&&(z-=65536,S.push(z>>>10&1023|55296),z=56320|z&1023),S.push(z),F+=ne}return Q(S)}var V=4096;function Q(N){var p=N.length;if(p<=V)return String.fromCharCode.apply(String,N);for(var g="",S=0;S<p;)g+=String.fromCharCode.apply(String,N.slice(S,S+=V));return g}function j(N,p,g){var S="";g=Math.min(N.length,g);for(var F=p;F<g;++F)S+=String.fromCharCode(N[F]&127);return S}function ie(N,p,g){var S="";g=Math.min(N.length,g);for(var F=p;F<g;++F)S+=String.fromCharCode(N[F]);return S}function ee(N,p,g){var S=N.length;(!p||p<0)&&(p=0),(!g||g<0||g>S)&&(g=S);for(var F="",q=p;q<g;++q)F+=Y[N[q]];return F}function le(N,p,g){for(var S=N.slice(p,g),F="",q=0;q<S.length-1;q+=2)F+=String.fromCharCode(S[q]+S[q+1]*256);return F}o.prototype.slice=function(p,g){var S=this.length;p=~~p,g=g===void 0?S:~~g,p<0?(p+=S,p<0&&(p=0)):p>S&&(p=S),g<0?(g+=S,g<0&&(g=0)):g>S&&(g=S),g<p&&(g=p);var F=this.subarray(p,g);return Object.setPrototypeOf(F,o.prototype),F};function G(N,p,g){if(N%1!==0||N<0)throw new RangeError("offset is not uint");if(N+p>g)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(p,g,S){p=p>>>0,g=g>>>0,S||G(p,g,this.length);for(var F=this[p],q=1,z=0;++z<g&&(q*=256);)F+=this[p+z]*q;return F},o.prototype.readUintBE=o.prototype.readUIntBE=function(p,g,S){p=p>>>0,g=g>>>0,S||G(p,g,this.length);for(var F=this[p+--g],q=1;g>0&&(q*=256);)F+=this[p+--g]*q;return F},o.prototype.readUint8=o.prototype.readUInt8=function(p,g){return p=p>>>0,g||G(p,1,this.length),this[p]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(p,g){return p=p>>>0,g||G(p,2,this.length),this[p]|this[p+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(p,g){return p=p>>>0,g||G(p,2,this.length),this[p]<<8|this[p+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(p,g){return p=p>>>0,g||G(p,4,this.length),(this[p]|this[p+1]<<8|this[p+2]<<16)+this[p+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(p,g){return p=p>>>0,g||G(p,4,this.length),this[p]*16777216+(this[p+1]<<16|this[p+2]<<8|this[p+3])},o.prototype.readIntLE=function(p,g,S){p=p>>>0,g=g>>>0,S||G(p,g,this.length);for(var F=this[p],q=1,z=0;++z<g&&(q*=256);)F+=this[p+z]*q;return q*=128,F>=q&&(F-=Math.pow(2,8*g)),F},o.prototype.readIntBE=function(p,g,S){p=p>>>0,g=g>>>0,S||G(p,g,this.length);for(var F=g,q=1,z=this[p+--F];F>0&&(q*=256);)z+=this[p+--F]*q;return q*=128,z>=q&&(z-=Math.pow(2,8*g)),z},o.prototype.readInt8=function(p,g){return p=p>>>0,g||G(p,1,this.length),this[p]&128?(255-this[p]+1)*-1:this[p]},o.prototype.readInt16LE=function(p,g){p=p>>>0,g||G(p,2,this.length);var S=this[p]|this[p+1]<<8;return S&32768?S|4294901760:S},o.prototype.readInt16BE=function(p,g){p=p>>>0,g||G(p,2,this.length);var S=this[p+1]|this[p]<<8;return S&32768?S|4294901760:S},o.prototype.readInt32LE=function(p,g){return p=p>>>0,g||G(p,4,this.length),this[p]|this[p+1]<<8|this[p+2]<<16|this[p+3]<<24},o.prototype.readInt32BE=function(p,g){return p=p>>>0,g||G(p,4,this.length),this[p]<<24|this[p+1]<<16|this[p+2]<<8|this[p+3]},o.prototype.readFloatLE=function(p,g){return p=p>>>0,g||G(p,4,this.length),t.read(this,p,!0,23,4)},o.prototype.readFloatBE=function(p,g){return p=p>>>0,g||G(p,4,this.length),t.read(this,p,!1,23,4)},o.prototype.readDoubleLE=function(p,g){return p=p>>>0,g||G(p,8,this.length),t.read(this,p,!0,52,8)},o.prototype.readDoubleBE=function(p,g){return p=p>>>0,g||G(p,8,this.length),t.read(this,p,!1,52,8)};function D(N,p,g,S,F,q){if(!o.isBuffer(N))throw new TypeError('"buffer" argument must be a Buffer instance');if(p>F||p<q)throw new RangeError('"value" argument is out of bounds');if(g+S>N.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(p,g,S,F){if(p=+p,g=g>>>0,S=S>>>0,!F){var q=Math.pow(2,8*S)-1;D(this,p,g,S,q,0)}var z=1,ne=0;for(this[g]=p&255;++ne<S&&(z*=256);)this[g+ne]=p/z&255;return g+S},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(p,g,S,F){if(p=+p,g=g>>>0,S=S>>>0,!F){var q=Math.pow(2,8*S)-1;D(this,p,g,S,q,0)}var z=S-1,ne=1;for(this[g+z]=p&255;--z>=0&&(ne*=256);)this[g+z]=p/ne&255;return g+S},o.prototype.writeUint8=o.prototype.writeUInt8=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,1,255,0),this[g]=p&255,g+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,2,65535,0),this[g]=p&255,this[g+1]=p>>>8,g+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,2,65535,0),this[g]=p>>>8,this[g+1]=p&255,g+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,4,4294967295,0),this[g+3]=p>>>24,this[g+2]=p>>>16,this[g+1]=p>>>8,this[g]=p&255,g+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,4,4294967295,0),this[g]=p>>>24,this[g+1]=p>>>16,this[g+2]=p>>>8,this[g+3]=p&255,g+4},o.prototype.writeIntLE=function(p,g,S,F){if(p=+p,g=g>>>0,!F){var q=Math.pow(2,8*S-1);D(this,p,g,S,q-1,-q)}var z=0,ne=1,ae=0;for(this[g]=p&255;++z<S&&(ne*=256);)p<0&&ae===0&&this[g+z-1]!==0&&(ae=1),this[g+z]=(p/ne>>0)-ae&255;return g+S},o.prototype.writeIntBE=function(p,g,S,F){if(p=+p,g=g>>>0,!F){var q=Math.pow(2,8*S-1);D(this,p,g,S,q-1,-q)}var z=S-1,ne=1,ae=0;for(this[g+z]=p&255;--z>=0&&(ne*=256);)p<0&&ae===0&&this[g+z+1]!==0&&(ae=1),this[g+z]=(p/ne>>0)-ae&255;return g+S},o.prototype.writeInt8=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,1,127,-128),p<0&&(p=255+p+1),this[g]=p&255,g+1},o.prototype.writeInt16LE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,2,32767,-32768),this[g]=p&255,this[g+1]=p>>>8,g+2},o.prototype.writeInt16BE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,2,32767,-32768),this[g]=p>>>8,this[g+1]=p&255,g+2},o.prototype.writeInt32LE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,4,2147483647,-2147483648),this[g]=p&255,this[g+1]=p>>>8,this[g+2]=p>>>16,this[g+3]=p>>>24,g+4},o.prototype.writeInt32BE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,4,2147483647,-2147483648),p<0&&(p=4294967295+p+1),this[g]=p>>>24,this[g+1]=p>>>16,this[g+2]=p>>>8,this[g+3]=p&255,g+4};function $(N,p,g,S,F,q){if(g+S>N.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("Index out of range")}function X(N,p,g,S,F){return p=+p,g=g>>>0,F||$(N,p,g,4),t.write(N,p,g,S,23,4),g+4}o.prototype.writeFloatLE=function(p,g,S){return X(this,p,g,!0,S)},o.prototype.writeFloatBE=function(p,g,S){return X(this,p,g,!1,S)};function re(N,p,g,S,F){return p=+p,g=g>>>0,F||$(N,p,g,8),t.write(N,p,g,S,52,8),g+8}o.prototype.writeDoubleLE=function(p,g,S){return re(this,p,g,!0,S)},o.prototype.writeDoubleBE=function(p,g,S){return re(this,p,g,!1,S)},o.prototype.copy=function(p,g,S,F){if(!o.isBuffer(p))throw new TypeError("argument should be a Buffer");if(S||(S=0),!F&&F!==0&&(F=this.length),g>=p.length&&(g=p.length),g||(g=0),F>0&&F<S&&(F=S),F===S||p.length===0||this.length===0)return 0;if(g<0)throw new RangeError("targetStart out of bounds");if(S<0||S>=this.length)throw new RangeError("Index out of range");if(F<0)throw new RangeError("sourceEnd out of bounds");F>this.length&&(F=this.length),p.length-g<F-S&&(F=p.length-g+S);var q=F-S;return this===p&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(g,S,F):Uint8Array.prototype.set.call(p,this.subarray(S,F),g),q},o.prototype.fill=function(p,g,S,F){if(typeof p=="string"){if(typeof g=="string"?(F=g,g=0,S=this.length):typeof S=="string"&&(F=S,S=this.length),F!==void 0&&typeof F!="string")throw new TypeError("encoding must be a string");if(typeof F=="string"&&!o.isEncoding(F))throw new TypeError("Unknown encoding: "+F);if(p.length===1){var q=p.charCodeAt(0);(F==="utf8"&&q<128||F==="latin1")&&(p=q)}}else typeof p=="number"?p=p&255:typeof p=="boolean"&&(p=Number(p));if(g<0||this.length<g||this.length<S)throw new RangeError("Out of range index");if(S<=g)return this;g=g>>>0,S=S===void 0?this.length:S>>>0,p||(p=0);var z;if(typeof p=="number")for(z=g;z<S;++z)this[z]=p;else{var ne=o.isBuffer(p)?p:o.from(p,F),ae=ne.length;if(ae===0)throw new TypeError('The value "'+p+'" is invalid for argument "value"');for(z=0;z<S-g;++z)this[z+g]=ne[z%ae]}return this};var K=/[^+/0-9A-Za-z-_]/g;function O(N){if(N=N.split("=")[0],N=N.trim().replace(K,""),N.length<2)return"";for(;N.length%4!==0;)N=N+"=";return N}function A(N,p){p=p||1/0;for(var g,S=N.length,F=null,q=[],z=0;z<S;++z){if(g=N.charCodeAt(z),g>55295&&g<57344){if(!F){if(g>56319){(p-=3)>-1&&q.push(239,191,189);continue}else if(z+1===S){(p-=3)>-1&&q.push(239,191,189);continue}F=g;continue}if(g<56320){(p-=3)>-1&&q.push(239,191,189),F=g;continue}g=(F-55296<<10|g-56320)+65536}else F&&(p-=3)>-1&&q.push(239,191,189);if(F=null,g<128){if((p-=1)<0)break;q.push(g)}else if(g<2048){if((p-=2)<0)break;q.push(g>>6|192,g&63|128)}else if(g<65536){if((p-=3)<0)break;q.push(g>>12|224,g>>6&63|128,g&63|128)}else if(g<1114112){if((p-=4)<0)break;q.push(g>>18|240,g>>12&63|128,g>>6&63|128,g&63|128)}else throw new Error("Invalid code point")}return q}function W(N){for(var p=[],g=0;g<N.length;++g)p.push(N.charCodeAt(g)&255);return p}function B(N,p){for(var g,S,F,q=[],z=0;z<N.length&&!((p-=2)<0);++z)g=N.charCodeAt(z),S=g>>8,F=g%256,q.push(F),q.push(S);return q}function I(N){return e.toByteArray(O(N))}function L(N,p,g,S){for(var F=0;F<S&&!(F+g>=p.length||F>=N.length);++F)p[F+g]=N[F];return F}function Z(N,p){return N instanceof p||N!=null&&N.constructor!=null&&N.constructor.name!=null&&N.constructor.name===p.name}function E(N){return N!==N}var Y=(function(){for(var N="0123456789abcdef",p=new Array(256),g=0;g<16;++g)for(var S=g*16,F=0;F<16;++F)p[S+F]=N[g]+N[F];return p})()})(Bg)),Bg}function K2(){return XD||(XD=1,zg=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),n=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[t]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==i||o.enumerable!==!0)return!1}return!0}),zg}function l1(){if(YD)return jg;YD=1;var r=K2();return jg=function(){return r()&&!!Symbol.toStringTag},jg}function G2(){return ZD||(ZD=1,Wg=Object),Wg}function AG(){return QD||(QD=1,qg=Error),qg}function OG(){return eM||(eM=1,Vg=EvalError),Vg}function NG(){return tM||(tM=1,Kg=RangeError),Kg}function RG(){return rM||(rM=1,Gg=ReferenceError),Gg}function $2(){return nM||(nM=1,$g=SyntaxError),$g}function za(){return iM||(iM=1,Jg=TypeError),Jg}function CG(){return sM||(sM=1,Xg=URIError),Xg}function IG(){return oM||(oM=1,Yg=Math.abs),Yg}function PG(){return aM||(aM=1,Zg=Math.floor),Zg}function DG(){return lM||(lM=1,Qg=Math.max),Qg}function MG(){return uM||(uM=1,ev=Math.min),ev}function LG(){return cM||(cM=1,tv=Math.pow),tv}function FG(){return fM||(fM=1,rv=Math.round),rv}function BG(){return hM||(hM=1,nv=Number.isNaN||function(e){return e!==e}),nv}function UG(){if(dM)return iv;dM=1;var r=BG();return iv=function(t){return r(t)||t===0?t:t<0?-1:1},iv}function HG(){return pM||(pM=1,sv=Object.getOwnPropertyDescriptor),sv}function ja(){if(mM)return ov;mM=1;var r=HG();if(r)try{r([],"length")}catch{r=null}return ov=r,ov}function bf(){if(gM)return av;gM=1;var r=Object.defineProperty||!1;if(r)try{r({},"a",{value:1})}catch{r=!1}return av=r,av}function zG(){if(vM)return lv;vM=1;var r=typeof Symbol<"u"&&Symbol,e=K2();return lv=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},lv}function J2(){return yM||(yM=1,uv=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),uv}function X2(){if(wM)return cv;wM=1;var r=G2();return cv=r.getPrototypeOf||null,cv}function jG(){if(bM)return fv;bM=1;var r="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,n="[object Function]",i=function(l,u){for(var c=[],f=0;f<l.length;f+=1)c[f]=l[f];for(var d=0;d<u.length;d+=1)c[d+l.length]=u[d];return c},s=function(l,u){for(var c=[],f=u,d=0;f<l.length;f+=1,d+=1)c[d]=l[f];return c},a=function(o,l){for(var u="",c=0;c<o.length;c+=1)u+=o[c],c+1<o.length&&(u+=l);return u};return fv=function(l){var u=this;if(typeof u!="function"||e.apply(u)!==n)throw new TypeError(r+u);for(var c=s(arguments,1),f,d=function(){if(this instanceof f){var m=u.apply(this,i(c,arguments));return Object(m)===m?m:this}return u.apply(l,i(c,arguments))},h=t(0,u.length-c.length),y=[],v=0;v<h;v++)y[v]="$"+v;if(f=Function("binder","return function ("+a(y,",")+"){ return binder.apply(this,arguments); }")(d),u.prototype){var x=function(){};x.prototype=u.prototype,f.prototype=new x,x.prototype=null}return f},fv}function Wa(){if(_M)return hv;_M=1;var r=jG();return hv=Function.prototype.bind||r,hv}function u1(){return xM||(xM=1,dv=Function.prototype.call),dv}function Y2(){return EM||(EM=1,pv=Function.prototype.apply),pv}function WG(){return SM||(SM=1,mv=typeof Reflect<"u"&&Reflect&&Reflect.apply),mv}function qG(){if(kM)return gv;kM=1;var r=Wa(),e=Y2(),t=u1(),n=WG();return gv=n||r.call(t,e),gv}function VG(){if(TM)return vv;TM=1;var r=Wa(),e=za(),t=u1(),n=qG();return vv=function(s){if(s.length<1||typeof s[0]!="function")throw new e("a function is required");return n(r,t,s)},vv}function KG(){if(AM)return yv;AM=1;var r=VG(),e=ja(),t;try{t=[].__proto__===Array.prototype}catch(a){if(!a||typeof a!="object"||!("code"in a)||a.code!=="ERR_PROTO_ACCESS")throw a}var n=!!t&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return yv=n&&typeof n.get=="function"?r([n.get]):typeof s=="function"?(function(o){return s(o==null?o:i(o))}):!1,yv}function GG(){if(OM)return wv;OM=1;var r=J2(),e=X2(),t=KG();return wv=r?function(i){return r(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:t?function(i){return t(i)}:null,wv}function $G(){if(NM)return bv;NM=1;var r=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=Wa();return bv=t.call(r,e),bv}function c1(){if(RM)return _v;RM=1;var r,e=G2(),t=AG(),n=OG(),i=NG(),s=RG(),a=$2(),o=za(),l=CG(),u=IG(),c=PG(),f=DG(),d=MG(),h=LG(),y=FG(),v=UG(),x=Function,m=function(W){try{return x('"use strict"; return ('+W+").constructor;")()}catch{}},_=ja(),b=bf(),w=function(){throw new o},T=_?(function(){try{return arguments.callee,w}catch{try{return _(arguments,"callee").get}catch{return w}}})():w,P=zG()(),M=GG(),U=X2(),R=J2(),J=Y2(),oe=u1(),C={},H=typeof Uint8Array>"u"||!M?r:M(Uint8Array),k={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?r:ArrayBuffer,"%ArrayIteratorPrototype%":P&&M?M([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":C,"%AsyncGenerator%":C,"%AsyncGeneratorFunction%":C,"%AsyncIteratorPrototype%":C,"%Atomics%":typeof Atomics>"u"?r:Atomics,"%BigInt%":typeof BigInt>"u"?r:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?r:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":n,"%Float16Array%":typeof Float16Array>"u"?r:Float16Array,"%Float32Array%":typeof Float32Array>"u"?r:Float32Array,"%Float64Array%":typeof Float64Array>"u"?r:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?r:FinalizationRegistry,"%Function%":x,"%GeneratorFunction%":C,"%Int8Array%":typeof Int8Array>"u"?r:Int8Array,"%Int16Array%":typeof Int16Array>"u"?r:Int16Array,"%Int32Array%":typeof Int32Array>"u"?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":P&&M?M(M([][Symbol.iterator]())):r,"%JSON%":typeof JSON=="object"?JSON:r,"%Map%":typeof Map>"u"?r:Map,"%MapIteratorPrototype%":typeof Map>"u"||!P||!M?r:M(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":_,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?r:Promise,"%Proxy%":typeof Proxy>"u"?r:Proxy,"%RangeError%":i,"%ReferenceError%":s,"%Reflect%":typeof Reflect>"u"?r:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?r:Set,"%SetIteratorPrototype%":typeof Set>"u"||!P||!M?r:M(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":P&&M?M(""[Symbol.iterator]()):r,"%Symbol%":P?Symbol:r,"%SyntaxError%":a,"%ThrowTypeError%":T,"%TypedArray%":H,"%TypeError%":o,"%Uint8Array%":typeof Uint8Array>"u"?r:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?r:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?r:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?r:Uint32Array,"%URIError%":l,"%WeakMap%":typeof WeakMap>"u"?r:WeakMap,"%WeakRef%":typeof WeakRef>"u"?r:WeakRef,"%WeakSet%":typeof WeakSet>"u"?r:WeakSet,"%Function.prototype.call%":oe,"%Function.prototype.apply%":J,"%Object.defineProperty%":b,"%Object.getPrototypeOf%":U,"%Math.abs%":u,"%Math.floor%":c,"%Math.max%":f,"%Math.min%":d,"%Math.pow%":h,"%Math.round%":y,"%Math.sign%":v,"%Reflect.getPrototypeOf%":R};if(M)try{null.error}catch(W){var V=M(M(W));k["%Error.prototype%"]=V}var Q=function W(B){var I;if(B==="%AsyncFunction%")I=m("async function () {}");else if(B==="%GeneratorFunction%")I=m("function* () {}");else if(B==="%AsyncGeneratorFunction%")I=m("async function* () {}");else if(B==="%AsyncGenerator%"){var L=W("%AsyncGeneratorFunction%");L&&(I=L.prototype)}else if(B==="%AsyncIteratorPrototype%"){var Z=W("%AsyncGenerator%");Z&&M&&(I=M(Z.prototype))}return k[B]=I,I},j={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ie=Wa(),ee=$G(),le=ie.call(oe,Array.prototype.concat),G=ie.call(J,Array.prototype.splice),D=ie.call(oe,String.prototype.replace),$=ie.call(oe,String.prototype.slice),X=ie.call(oe,RegExp.prototype.exec),re=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,K=/\\(\\)?/g,O=function(B){var I=$(B,0,1),L=$(B,-1);if(I==="%"&&L!=="%")throw new a("invalid intrinsic syntax, expected closing `%`");if(L==="%"&&I!=="%")throw new a("invalid intrinsic syntax, expected opening `%`");var Z=[];return D(B,re,function(E,Y,N,p){Z[Z.length]=N?D(p,K,"$1"):Y||E}),Z},A=function(B,I){var L=B,Z;if(ee(j,L)&&(Z=j[L],L="%"+Z[0]+"%"),ee(k,L)){var E=k[L];if(E===C&&(E=Q(L)),typeof E>"u"&&!I)throw new o("intrinsic "+B+" exists, but is not available. Please file an issue!");return{alias:Z,name:L,value:E}}throw new a("intrinsic "+B+" does not exist!")};return _v=function(B,I){if(typeof B!="string"||B.length===0)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof I!="boolean")throw new o('"allowMissing" argument must be a boolean');if(X(/^%?[^%]*%?$/,B)===null)throw new a("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var L=O(B),Z=L.length>0?L[0]:"",E=A("%"+Z+"%",I),Y=E.name,N=E.value,p=!1,g=E.alias;g&&(Z=g[0],G(L,le([0,1],g)));for(var S=1,F=!0;S<L.length;S+=1){var q=L[S],z=$(q,0,1),ne=$(q,-1);if((z==='"'||z==="'"||z==="`"||ne==='"'||ne==="'"||ne==="`")&&z!==ne)throw new a("property names with quotes must have matching quotes");if((q==="constructor"||!F)&&(p=!0),Z+="."+q,Y="%"+Z+"%",ee(k,Y))N=k[Y];else if(N!=null){if(!(q in N)){if(!I)throw new o("base intrinsic for "+B+" exists, but the property is not available.");return}if(_&&S+1>=L.length){var ae=_(N,q);F=!!ae,F&&"get"in ae&&!("originalValue"in ae.get)?N=ae.get:N=N[q]}else F=ee(N,q),N=N[q];F&&!p&&(k[Y]=N)}}return N},_v}function JG(){if(CM)return Ev;CM=1;var r=bf(),e=$2(),t=za(),n=ja();return Ev=function(s,a,o){if(!s||typeof s!="object"&&typeof s!="function")throw new t("`obj` must be an object or a function`");if(typeof a!="string"&&typeof a!="symbol")throw new t("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new t("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new t("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new t("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new t("`loose`, if provided, must be a boolean");var l=arguments.length>3?arguments[3]:null,u=arguments.length>4?arguments[4]:null,c=arguments.length>5?arguments[5]:null,f=arguments.length>6?arguments[6]:!1,d=!!n&&n(s,a);if(r)r(s,a,{configurable:c===null&&d?d.configurable:!c,enumerable:l===null&&d?d.enumerable:!l,value:o,writable:u===null&&d?d.writable:!u});else if(f||!l&&!u&&!c)s[a]=o;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Ev}function XG(){if(IM)return Sv;IM=1;var r=bf(),e=function(){return!!r};return e.hasArrayLengthDefineBug=function(){if(!r)return null;try{return r([],"length",{value:1}).length!==1}catch{return!0}},Sv=e,Sv}function YG(){if(PM)return kv;PM=1;var r=c1(),e=JG(),t=XG()(),n=ja(),i=za(),s=r("%Math.floor%");return kv=function(o,l){if(typeof o!="function")throw new i("`fn` is not a function");if(typeof l!="number"||l<0||l>4294967295||s(l)!==l)throw new i("`length` must be a positive 32-bit integer");var u=arguments.length>2&&!!arguments[2],c=!0,f=!0;if("length"in o&&n){var d=n(o,"length");d&&!d.configurable&&(c=!1),d&&!d.writable&&(f=!1)}return(c||f||!u)&&(t?e(o,"length",l,!0,!0):e(o,"length",l)),o},kv}function Z2(){return DM||(DM=1,(function(r){var e=Wa(),t=c1(),n=YG(),i=za(),s=t("%Function.prototype.apply%"),a=t("%Function.prototype.call%"),o=t("%Reflect.apply%",!0)||e.call(a,s),l=bf(),u=t("%Math.max%");r.exports=function(d){if(typeof d!="function")throw new i("a function is required");var h=o(e,a,arguments);return n(h,1+u(0,d.length-(arguments.length-1)),!0)};var c=function(){return o(e,s,arguments)};l?l(r.exports,"apply",{value:c}):r.exports.apply=c})(xv)),xv.exports}function Q2(){if(MM)return Tv;MM=1;var r=c1(),e=Z2(),t=e(r("String.prototype.indexOf"));return Tv=function(i,s){var a=r(i,!!s);return typeof a=="function"&&t(i,".prototype.")>-1?e(a):a},Tv}function ZG(){if(LM)return Av;LM=1;var r=l1()(),e=Q2(),t=e("Object.prototype.toString"),n=function(o){return r&&o&&typeof o=="object"&&Symbol.toStringTag in o?!1:t(o)==="[object Arguments]"},i=function(o){return n(o)?!0:o!==null&&typeof o=="object"&&typeof o.length=="number"&&o.length>=0&&t(o)!=="[object Array]"&&t(o.callee)==="[object Function]"},s=(function(){return n(arguments)})();return n.isLegacyArguments=i,Av=s?n:i,Av}function QG(){if(FM)return Ov;FM=1;var r=Object.prototype.toString,e=Function.prototype.toString,t=/^\s*(?:function)?\*/,n=l1()(),i=Object.getPrototypeOf,s=function(){if(!n)return!1;try{return Function("return function*() {}")()}catch{}},a;return Ov=function(l){if(typeof l!="function")return!1;if(t.test(e.call(l)))return!0;if(!n){var u=r.call(l);return u==="[object GeneratorFunction]"}if(!i)return!1;if(typeof a>"u"){var c=s();a=c?i(c):!1}return i(l)===a},Ov}function e$(){if(BM)return Nv;BM=1;var r=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,t,n;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{t=Object.defineProperty({},"length",{get:function(){throw n}}),n={},e(function(){throw 42},null,t)}catch(_){_!==n&&(e=null)}else e=null;var i=/^\s*class\b/,s=function(b){try{var w=r.call(b);return i.test(w)}catch{return!1}},a=function(b){try{return s(b)?!1:(r.call(b),!0)}catch{return!1}},o=Object.prototype.toString,l="[object Object]",u="[object Function]",c="[object GeneratorFunction]",f="[object HTMLAllCollection]",d="[object HTML document.all class]",h="[object HTMLCollection]",y=typeof Symbol=="function"&&!!Symbol.toStringTag,v=!(0 in[,]),x=function(){return!1};if(typeof document=="object"){var m=document.all;o.call(m)===o.call(document.all)&&(x=function(b){if((v||!b)&&(typeof b>"u"||typeof b=="object"))try{var w=o.call(b);return(w===f||w===d||w===h||w===l)&&b("")==null}catch{}return!1})}return Nv=e?function(b){if(x(b))return!0;if(!b||typeof b!="function"&&typeof b!="object")return!1;try{e(b,null,t)}catch(w){if(w!==n)return!1}return!s(b)&&a(b)}:function(b){if(x(b))return!0;if(!b||typeof b!="function"&&typeof b!="object")return!1;if(y)return a(b);if(s(b))return!1;var w=o.call(b);return w!==u&&w!==c&&!/^\[object HTML/.test(w)?!1:a(b)},Nv}function t$(){if(UM)return Rv;UM=1;var r=e$(),e=Object.prototype.toString,t=Object.prototype.hasOwnProperty,n=function(l,u,c){for(var f=0,d=l.length;f<d;f++)t.call(l,f)&&(c==null?u(l[f],f,l):u.call(c,l[f],f,l))},i=function(l,u,c){for(var f=0,d=l.length;f<d;f++)c==null?u(l.charAt(f),f,l):u.call(c,l.charAt(f),f,l)},s=function(l,u,c){for(var f in l)t.call(l,f)&&(c==null?u(l[f],f,l):u.call(c,l[f],f,l))},a=function(l,u,c){if(!r(u))throw new TypeError("iterator must be a function");var f;arguments.length>=3&&(f=c),e.call(l)==="[object Array]"?n(l,u,f):typeof l=="string"?i(l,u,f):s(l,u,f)};return Rv=a,Rv}function r$(){return HM||(HM=1,Cv=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),Cv}function n$(){if(zM)return Iv;zM=1;var r=r$(),e=typeof globalThis>"u"?qr:globalThis;return Iv=function(){for(var n=[],i=0;i<r.length;i++)typeof e[r[i]]=="function"&&(n[n.length]=r[i]);return n},Iv}function e5(){if(jM)return Pv;jM=1;var r=t$(),e=n$(),t=Z2(),n=Q2(),i=ja(),s=n("Object.prototype.toString"),a=l1()(),o=typeof globalThis>"u"?qr:globalThis,l=e(),u=n("String.prototype.slice"),c=Object.getPrototypeOf,f=n("Array.prototype.indexOf",!0)||function(x,m){for(var _=0;_<x.length;_+=1)if(x[_]===m)return _;return-1},d={__proto__:null};a&&i&&c?r(l,function(v){var x=new o[v];if(Symbol.toStringTag in x){var m=c(x),_=i(m,Symbol.toStringTag);if(!_){var b=c(m);_=i(b,Symbol.toStringTag)}d["$"+v]=t(_.get)}}):r(l,function(v){var x=new o[v],m=x.slice||x.set;m&&(d["$"+v]=t(m))});var h=function(x){var m=!1;return r(d,function(_,b){if(!m)try{"$"+_(x)===b&&(m=u(b,1))}catch{}}),m},y=function(x){var m=!1;return r(d,function(_,b){if(!m)try{_(x),m=u(b,1)}catch{}}),m};return Pv=function(x){if(!x||typeof x!="object")return!1;if(!a){var m=u(s(x),8,-1);return f(l,m)>-1?m:m!=="Object"?!1:y(x)}return i?h(x):null},Pv}function i$(){if(WM)return Dv;WM=1;var r=e5();return Dv=function(t){return!!r(t)},Dv}function s$(){return qM||(qM=1,(function(r){var e=ZG(),t=QG(),n=e5(),i=i$();function s(S){return S.call.bind(S)}var a=typeof BigInt<"u",o=typeof Symbol<"u",l=s(Object.prototype.toString),u=s(Number.prototype.valueOf),c=s(String.prototype.valueOf),f=s(Boolean.prototype.valueOf);if(a)var d=s(BigInt.prototype.valueOf);if(o)var h=s(Symbol.prototype.valueOf);function y(S,F){if(typeof S!="object")return!1;try{return F(S),!0}catch{return!1}}r.isArgumentsObject=e,r.isGeneratorFunction=t,r.isTypedArray=i;function v(S){return typeof Promise<"u"&&S instanceof Promise||S!==null&&typeof S=="object"&&typeof S.then=="function"&&typeof S.catch=="function"}r.isPromise=v;function x(S){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(S):i(S)||$(S)}r.isArrayBufferView=x;function m(S){return n(S)==="Uint8Array"}r.isUint8Array=m;function _(S){return n(S)==="Uint8ClampedArray"}r.isUint8ClampedArray=_;function b(S){return n(S)==="Uint16Array"}r.isUint16Array=b;function w(S){return n(S)==="Uint32Array"}r.isUint32Array=w;function T(S){return n(S)==="Int8Array"}r.isInt8Array=T;function P(S){return n(S)==="Int16Array"}r.isInt16Array=P;function M(S){return n(S)==="Int32Array"}r.isInt32Array=M;function U(S){return n(S)==="Float32Array"}r.isFloat32Array=U;function R(S){return n(S)==="Float64Array"}r.isFloat64Array=R;function J(S){return n(S)==="BigInt64Array"}r.isBigInt64Array=J;function oe(S){return n(S)==="BigUint64Array"}r.isBigUint64Array=oe;function C(S){return l(S)==="[object Map]"}C.working=typeof Map<"u"&&C(new Map);function H(S){return typeof Map>"u"?!1:C.working?C(S):S instanceof Map}r.isMap=H;function k(S){return l(S)==="[object Set]"}k.working=typeof Set<"u"&&k(new Set);function V(S){return typeof Set>"u"?!1:k.working?k(S):S instanceof Set}r.isSet=V;function Q(S){return l(S)==="[object WeakMap]"}Q.working=typeof WeakMap<"u"&&Q(new WeakMap);function j(S){return typeof WeakMap>"u"?!1:Q.working?Q(S):S instanceof WeakMap}r.isWeakMap=j;function ie(S){return l(S)==="[object WeakSet]"}ie.working=typeof WeakSet<"u"&&ie(new WeakSet);function ee(S){return ie(S)}r.isWeakSet=ee;function le(S){return l(S)==="[object ArrayBuffer]"}le.working=typeof ArrayBuffer<"u"&&le(new ArrayBuffer);function G(S){return typeof ArrayBuffer>"u"?!1:le.working?le(S):S instanceof ArrayBuffer}r.isArrayBuffer=G;function D(S){return l(S)==="[object DataView]"}D.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&D(new DataView(new ArrayBuffer(1),0,1));function $(S){return typeof DataView>"u"?!1:D.working?D(S):S instanceof DataView}r.isDataView=$;var X=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function re(S){return l(S)==="[object SharedArrayBuffer]"}function K(S){return typeof X>"u"?!1:(typeof re.working>"u"&&(re.working=re(new X)),re.working?re(S):S instanceof X)}r.isSharedArrayBuffer=K;function O(S){return l(S)==="[object AsyncFunction]"}r.isAsyncFunction=O;function A(S){return l(S)==="[object Map Iterator]"}r.isMapIterator=A;function W(S){return l(S)==="[object Set Iterator]"}r.isSetIterator=W;function B(S){return l(S)==="[object Generator]"}r.isGeneratorObject=B;function I(S){return l(S)==="[object WebAssembly.Module]"}r.isWebAssemblyCompiledModule=I;function L(S){return y(S,u)}r.isNumberObject=L;function Z(S){return y(S,c)}r.isStringObject=Z;function E(S){return y(S,f)}r.isBooleanObject=E;function Y(S){return a&&y(S,d)}r.isBigIntObject=Y;function N(S){return o&&y(S,h)}r.isSymbolObject=N;function p(S){return L(S)||Z(S)||E(S)||Y(S)||N(S)}r.isBoxedPrimitive=p;function g(S){return typeof Uint8Array<"u"&&(G(S)||K(S))}r.isAnyArrayBuffer=g,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(S){Object.defineProperty(r,S,{enumerable:!1,value:function(){throw new Error(S+" is not supported in userland")}})})})(Hg)),Hg}function o$(){return VM||(VM=1,Mv=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}),Mv}function t5(){return KM||(KM=1,(function(r){var e=Object.getOwnPropertyDescriptors||function($){for(var X=Object.keys($),re={},K=0;K<X.length;K++)re[X[K]]=Object.getOwnPropertyDescriptor($,X[K]);return re},t=/%[sdj%]/g;r.format=function(D){if(!T(D)){for(var $=[],X=0;X<arguments.length;X++)$.push(a(arguments[X]));return $.join(" ")}for(var X=1,re=arguments,K=re.length,O=String(D).replace(t,function(W){if(W==="%%")return"%";if(X>=K)return W;switch(W){case"%s":return String(re[X++]);case"%d":return Number(re[X++]);case"%j":try{return JSON.stringify(re[X++])}catch{return"[Circular]"}default:return W}}),A=re[X];X<K;A=re[++X])_(A)||!R(A)?O+=" "+A:O+=" "+a(A);return O},r.deprecate=function(D,$){if(typeof Ce<"u"&&Ce.noDeprecation===!0)return D;if(typeof Ce>"u")return function(){return r.deprecate(D,$).apply(this,arguments)};var X=!1;function re(){if(!X){if(Ce.throwDeprecation)throw new Error($);Ce.traceDeprecation?console.trace($):console.error($),X=!0}return D.apply(this,arguments)}return re};var n={},i=/^$/;if(Ce.env.NODE_DEBUG){var s=Ce.env.NODE_DEBUG;s=s.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),i=new RegExp("^"+s+"$","i")}r.debuglog=function(D){if(D=D.toUpperCase(),!n[D])if(i.test(D)){var $=Ce.pid;n[D]=function(){var X=r.format.apply(r,arguments);console.error("%s %d: %s",D,$,X)}}else n[D]=function(){};return n[D]};function a(D,$){var X={seen:[],stylize:l};return arguments.length>=3&&(X.depth=arguments[2]),arguments.length>=4&&(X.colors=arguments[3]),m($)?X.showHidden=$:$&&r._extend(X,$),M(X.showHidden)&&(X.showHidden=!1),M(X.depth)&&(X.depth=2),M(X.colors)&&(X.colors=!1),M(X.customInspect)&&(X.customInspect=!0),X.colors&&(X.stylize=o),c(X,D,X.depth)}r.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function o(D,$){var X=a.styles[$];return X?"\x1B["+a.colors[X][0]+"m"+D+"\x1B["+a.colors[X][1]+"m":D}function l(D,$){return D}function u(D){var $={};return D.forEach(function(X,re){$[X]=!0}),$}function c(D,$,X){if(D.customInspect&&$&&C($.inspect)&&$.inspect!==r.inspect&&!($.constructor&&$.constructor.prototype===$)){var re=$.inspect(X,D);return T(re)||(re=c(D,re,X)),re}var K=f(D,$);if(K)return K;var O=Object.keys($),A=u(O);if(D.showHidden&&(O=Object.getOwnPropertyNames($)),oe($)&&(O.indexOf("message")>=0||O.indexOf("description")>=0))return d($);if(O.length===0){if(C($)){var W=$.name?": "+$.name:"";return D.stylize("[Function"+W+"]","special")}if(U($))return D.stylize(RegExp.prototype.toString.call($),"regexp");if(J($))return D.stylize(Date.prototype.toString.call($),"date");if(oe($))return d($)}var B="",I=!1,L=["{","}"];if(x($)&&(I=!0,L=["[","]"]),C($)){var Z=$.name?": "+$.name:"";B=" [Function"+Z+"]"}if(U($)&&(B=" "+RegExp.prototype.toString.call($)),J($)&&(B=" "+Date.prototype.toUTCString.call($)),oe($)&&(B=" "+d($)),O.length===0&&(!I||$.length==0))return L[0]+B+L[1];if(X<0)return U($)?D.stylize(RegExp.prototype.toString.call($),"regexp"):D.stylize("[Object]","special");D.seen.push($);var E;return I?E=h(D,$,X,A,O):E=O.map(function(Y){return y(D,$,X,A,Y,I)}),D.seen.pop(),v(E,B,L)}function f(D,$){if(M($))return D.stylize("undefined","undefined");if(T($)){var X="'"+JSON.stringify($).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return D.stylize(X,"string")}if(w($))return D.stylize(""+$,"number");if(m($))return D.stylize(""+$,"boolean");if(_($))return D.stylize("null","null")}function d(D){return"["+Error.prototype.toString.call(D)+"]"}function h(D,$,X,re,K){for(var O=[],A=0,W=$.length;A<W;++A)ie($,String(A))?O.push(y(D,$,X,re,String(A),!0)):O.push("");return K.forEach(function(B){B.match(/^\d+$/)||O.push(y(D,$,X,re,B,!0))}),O}function y(D,$,X,re,K,O){var A,W,B;if(B=Object.getOwnPropertyDescriptor($,K)||{value:$[K]},B.get?B.set?W=D.stylize("[Getter/Setter]","special"):W=D.stylize("[Getter]","special"):B.set&&(W=D.stylize("[Setter]","special")),ie(re,K)||(A="["+K+"]"),W||(D.seen.indexOf(B.value)<0?(_(X)?W=c(D,B.value,null):W=c(D,B.value,X-1),W.indexOf(`
`)>-1&&(O?W=W.split(`
`).map(function(I){return"  "+I}).join(`
`).slice(2):W=`
`+W.split(`
`).map(function(I){return"   "+I}).join(`
`))):W=D.stylize("[Circular]","special")),M(A)){if(O&&K.match(/^\d+$/))return W;A=JSON.stringify(""+K),A.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(A=A.slice(1,-1),A=D.stylize(A,"name")):(A=A.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),A=D.stylize(A,"string"))}return A+": "+W}function v(D,$,X){var re=D.reduce(function(K,O){return O.indexOf(`
`)>=0,K+O.replace(/\u001b\[\d\d?m/g,"").length+1},0);return re>60?X[0]+($===""?"":$+`
 `)+" "+D.join(`,
  `)+" "+X[1]:X[0]+$+" "+D.join(", ")+" "+X[1]}r.types=s$();function x(D){return Array.isArray(D)}r.isArray=x;function m(D){return typeof D=="boolean"}r.isBoolean=m;function _(D){return D===null}r.isNull=_;function b(D){return D==null}r.isNullOrUndefined=b;function w(D){return typeof D=="number"}r.isNumber=w;function T(D){return typeof D=="string"}r.isString=T;function P(D){return typeof D=="symbol"}r.isSymbol=P;function M(D){return D===void 0}r.isUndefined=M;function U(D){return R(D)&&k(D)==="[object RegExp]"}r.isRegExp=U,r.types.isRegExp=U;function R(D){return typeof D=="object"&&D!==null}r.isObject=R;function J(D){return R(D)&&k(D)==="[object Date]"}r.isDate=J,r.types.isDate=J;function oe(D){return R(D)&&(k(D)==="[object Error]"||D instanceof Error)}r.isError=oe,r.types.isNativeError=oe;function C(D){return typeof D=="function"}r.isFunction=C;function H(D){return D===null||typeof D=="boolean"||typeof D=="number"||typeof D=="string"||typeof D=="symbol"||typeof D>"u"}r.isPrimitive=H,r.isBuffer=o$();function k(D){return Object.prototype.toString.call(D)}function V(D){return D<10?"0"+D.toString(10):D.toString(10)}var Q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function j(){var D=new Date,$=[V(D.getHours()),V(D.getMinutes()),V(D.getSeconds())].join(":");return[D.getDate(),Q[D.getMonth()],$].join(" ")}r.log=function(){console.log("%s - %s",j(),r.format.apply(r,arguments))},r.inherits=ei(),r._extend=function(D,$){if(!$||!R($))return D;for(var X=Object.keys($),re=X.length;re--;)D[X[re]]=$[X[re]];return D};function ie(D,$){return Object.prototype.hasOwnProperty.call(D,$)}var ee=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;r.promisify=function($){if(typeof $!="function")throw new TypeError('The "original" argument must be of type Function');if(ee&&$[ee]){var X=$[ee];if(typeof X!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(X,ee,{value:X,enumerable:!1,writable:!1,configurable:!0}),X}function X(){for(var re,K,O=new Promise(function(B,I){re=B,K=I}),A=[],W=0;W<arguments.length;W++)A.push(arguments[W]);A.push(function(B,I){B?K(B):re(I)});try{$.apply(this,A)}catch(B){K(B)}return O}return Object.setPrototypeOf(X,Object.getPrototypeOf($)),ee&&Object.defineProperty(X,ee,{value:X,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(X,e($))},r.promisify.custom=ee;function le(D,$){if(!D){var X=new Error("Promise was rejected with a falsy value");X.reason=D,D=X}return $(D)}function G(D){if(typeof D!="function")throw new TypeError('The "original" argument must be of type Function');function $(){for(var X=[],re=0;re<arguments.length;re++)X.push(arguments[re]);var K=X.pop();if(typeof K!="function")throw new TypeError("The last argument must be of type Function");var O=this,A=function(){return K.apply(O,arguments)};D.apply(this,X).then(function(W){Ce.nextTick(A.bind(null,null,W))},function(W){Ce.nextTick(le.bind(null,W,A))})}return Object.setPrototypeOf($,Object.getPrototypeOf(D)),Object.defineProperties($,e(D)),$}r.callbackify=G})(Ug)),Ug}function a$(){if(GM)return Lv;GM=1;function r(d,h){var y=Object.keys(d);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(d);h&&(v=v.filter(function(x){return Object.getOwnPropertyDescriptor(d,x).enumerable})),y.push.apply(y,v)}return y}function e(d){for(var h=1;h<arguments.length;h++){var y=arguments[h]!=null?arguments[h]:{};h%2?r(Object(y),!0).forEach(function(v){t(d,v,y[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(y)):r(Object(y)).forEach(function(v){Object.defineProperty(d,v,Object.getOwnPropertyDescriptor(y,v))})}return d}function t(d,h,y){return h in d?Object.defineProperty(d,h,{value:y,enumerable:!0,configurable:!0,writable:!0}):d[h]=y,d}function n(d,h){if(!(d instanceof h))throw new TypeError("Cannot call a class as a function")}function i(d,h){for(var y=0;y<h.length;y++){var v=h[y];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(d,v.key,v)}}function s(d,h,y){return h&&i(d.prototype,h),d}var a=wf(),o=a.Buffer,l=t5(),u=l.inspect,c=u&&u.custom||"inspect";function f(d,h,y){o.prototype.copy.call(d,h,y)}return Lv=(function(){function d(){n(this,d),this.head=null,this.tail=null,this.length=0}return s(d,[{key:"push",value:function(y){var v={data:y,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(y){var v={data:y,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var y=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,y}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(y){if(this.length===0)return"";for(var v=this.head,x=""+v.data;v=v.next;)x+=y+v.data;return x}},{key:"concat",value:function(y){if(this.length===0)return o.alloc(0);for(var v=o.allocUnsafe(y>>>0),x=this.head,m=0;x;)f(x.data,v,m),m+=x.data.length,x=x.next;return v}},{key:"consume",value:function(y,v){var x;return y<this.head.data.length?(x=this.head.data.slice(0,y),this.head.data=this.head.data.slice(y)):y===this.head.data.length?x=this.shift():x=v?this._getString(y):this._getBuffer(y),x}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(y){var v=this.head,x=1,m=v.data;for(y-=m.length;v=v.next;){var _=v.data,b=y>_.length?_.length:y;if(b===_.length?m+=_:m+=_.slice(0,y),y-=b,y===0){b===_.length?(++x,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=_.slice(b));break}++x}return this.length-=x,m}},{key:"_getBuffer",value:function(y){var v=o.allocUnsafe(y),x=this.head,m=1;for(x.data.copy(v),y-=x.data.length;x=x.next;){var _=x.data,b=y>_.length?_.length:y;if(_.copy(v,v.length-y,0,b),y-=b,y===0){b===_.length?(++m,x.next?this.head=x.next:this.head=this.tail=null):(this.head=x,x.data=_.slice(b));break}++m}return this.length-=m,v}},{key:c,value:function(y,v){return u(this,e({},v,{depth:0,customInspect:!1}))}}]),d})(),Lv}function r5(){if($M)return Fv;$M=1;function r(a,o){var l=this,u=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return u||c?(o?o(a):a&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Ce.nextTick(i,this,a)):Ce.nextTick(i,this,a)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(a||null,function(f){!o&&f?l._writableState?l._writableState.errorEmitted?Ce.nextTick(t,l):(l._writableState.errorEmitted=!0,Ce.nextTick(e,l,f)):Ce.nextTick(e,l,f):o?(Ce.nextTick(t,l),o(f)):Ce.nextTick(t,l)}),this)}function e(a,o){i(a,o),t(a)}function t(a){a._writableState&&!a._writableState.emitClose||a._readableState&&!a._readableState.emitClose||a.emit("close")}function n(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function i(a,o){a.emit("error",o)}function s(a,o){var l=a._readableState,u=a._writableState;l&&l.autoDestroy||u&&u.autoDestroy?a.destroy(o):a.emit("error",o)}return Fv={destroy:r,undestroy:n,errorOrDestroy:s},Fv}function Js(){if(JM)return Bv;JM=1;function r(o,l){o.prototype=Object.create(l.prototype),o.prototype.constructor=o,o.__proto__=l}var e={};function t(o,l,u){u||(u=Error);function c(d,h,y){return typeof l=="string"?l:l(d,h,y)}var f=(function(d){r(h,d);function h(y,v,x){return d.call(this,c(y,v,x))||this}return h})(u);f.prototype.name=u.name,f.prototype.code=o,e[o]=f}function n(o,l){if(Array.isArray(o)){var u=o.length;return o=o.map(function(c){return String(c)}),u>2?"one of ".concat(l," ").concat(o.slice(0,u-1).join(", "),", or ")+o[u-1]:u===2?"one of ".concat(l," ").concat(o[0]," or ").concat(o[1]):"of ".concat(l," ").concat(o[0])}else return"of ".concat(l," ").concat(String(o))}function i(o,l,u){return o.substr(0,l.length)===l}function s(o,l,u){return(u===void 0||u>o.length)&&(u=o.length),o.substring(u-l.length,u)===l}function a(o,l,u){return typeof u!="number"&&(u=0),u+l.length>o.length?!1:o.indexOf(l,u)!==-1}return t("ERR_INVALID_OPT_VALUE",function(o,l){return'The value "'+l+'" is invalid for option "'+o+'"'},TypeError),t("ERR_INVALID_ARG_TYPE",function(o,l,u){var c;typeof l=="string"&&i(l,"not ")?(c="must not be",l=l.replace(/^not /,"")):c="must be";var f;if(s(o," argument"))f="The ".concat(o," ").concat(c," ").concat(n(l,"type"));else{var d=a(o,".")?"property":"argument";f='The "'.concat(o,'" ').concat(d," ").concat(c," ").concat(n(l,"type"))}return f+=". Received type ".concat(typeof u),f},TypeError),t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),t("ERR_METHOD_NOT_IMPLEMENTED",function(o){return"The "+o+" method is not implemented"}),t("ERR_STREAM_PREMATURE_CLOSE","Premature close"),t("ERR_STREAM_DESTROYED",function(o){return"Cannot call "+o+" after a stream was destroyed"}),t("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),t("ERR_STREAM_WRITE_AFTER_END","write after end"),t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),t("ERR_UNKNOWN_ENCODING",function(o){return"Unknown encoding: "+o},TypeError),t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Bv.codes=e,Bv}function n5(){if(XM)return Uv;XM=1;var r=Js().codes.ERR_INVALID_OPT_VALUE;function e(n,i,s){return n.highWaterMark!=null?n.highWaterMark:i?n[s]:null}function t(n,i,s,a){var o=e(i,a,s);if(o!=null){if(!(isFinite(o)&&Math.floor(o)===o)||o<0){var l=a?s:"highWaterMark";throw new r(l,o)}return Math.floor(o)}return n.objectMode?16:16*1024}return Uv={getHighWaterMark:t},Uv}function l$(){if(YM)return Hv;YM=1,Hv=r;function r(t,n){if(e("noDeprecation"))return t;var i=!1;function s(){if(!i){if(e("throwDeprecation"))throw new Error(n);e("traceDeprecation")?console.trace(n):console.warn(n),i=!0}return t.apply(this,arguments)}return s}function e(t){try{if(!qr.localStorage)return!1}catch{return!1}var n=qr.localStorage[t];return n==null?!1:String(n).toLowerCase()==="true"}return Hv}function i5(){if(ZM)return zv;ZM=1,zv=U;function r(K){var O=this;this.next=null,this.entry=null,this.finish=function(){re(O,K)}}var e;U.WritableState=P;var t={deprecate:l$()},n=V2(),i=wf().Buffer,s=qr.Uint8Array||function(){};function a(K){return i.from(K)}function o(K){return i.isBuffer(K)||K instanceof s}var l=r5(),u=n5(),c=u.getHighWaterMark,f=Js().codes,d=f.ERR_INVALID_ARG_TYPE,h=f.ERR_METHOD_NOT_IMPLEMENTED,y=f.ERR_MULTIPLE_CALLBACK,v=f.ERR_STREAM_CANNOT_PIPE,x=f.ERR_STREAM_DESTROYED,m=f.ERR_STREAM_NULL_VALUES,_=f.ERR_STREAM_WRITE_AFTER_END,b=f.ERR_UNKNOWN_ENCODING,w=l.errorOrDestroy;ei()(U,n);function T(){}function P(K,O,A){e=e||zs(),K=K||{},typeof A!="boolean"&&(A=O instanceof e),this.objectMode=!!K.objectMode,A&&(this.objectMode=this.objectMode||!!K.writableObjectMode),this.highWaterMark=c(this,K,"writableHighWaterMark",A),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var W=K.decodeStrings===!1;this.decodeStrings=!W,this.defaultEncoding=K.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(B){Q(O,B)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=K.emitClose!==!1,this.autoDestroy=!!K.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}P.prototype.getBuffer=function(){for(var O=this.bufferedRequest,A=[];O;)A.push(O),O=O.next;return A},(function(){try{Object.defineProperty(P.prototype,"buffer",{get:t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var M;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(M=Function.prototype[Symbol.hasInstance],Object.defineProperty(U,Symbol.hasInstance,{value:function(O){return M.call(this,O)?!0:this!==U?!1:O&&O._writableState instanceof P}})):M=function(O){return O instanceof this};function U(K){e=e||zs();var O=this instanceof e;if(!O&&!M.call(U,this))return new U(K);this._writableState=new P(K,this,O),this.writable=!0,K&&(typeof K.write=="function"&&(this._write=K.write),typeof K.writev=="function"&&(this._writev=K.writev),typeof K.destroy=="function"&&(this._destroy=K.destroy),typeof K.final=="function"&&(this._final=K.final)),n.call(this)}U.prototype.pipe=function(){w(this,new v)};function R(K,O){var A=new _;w(K,A),Ce.nextTick(O,A)}function J(K,O,A,W){var B;return A===null?B=new m:typeof A!="string"&&!O.objectMode&&(B=new d("chunk",["string","Buffer"],A)),B?(w(K,B),Ce.nextTick(W,B),!1):!0}U.prototype.write=function(K,O,A){var W=this._writableState,B=!1,I=!W.objectMode&&o(K);return I&&!i.isBuffer(K)&&(K=a(K)),typeof O=="function"&&(A=O,O=null),I?O="buffer":O||(O=W.defaultEncoding),typeof A!="function"&&(A=T),W.ending?R(this,A):(I||J(this,W,K,A))&&(W.pendingcb++,B=C(this,W,I,K,O,A)),B},U.prototype.cork=function(){this._writableState.corked++},U.prototype.uncork=function(){var K=this._writableState;K.corked&&(K.corked--,!K.writing&&!K.corked&&!K.bufferProcessing&&K.bufferedRequest&&ee(this,K))},U.prototype.setDefaultEncoding=function(O){if(typeof O=="string"&&(O=O.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((O+"").toLowerCase())>-1))throw new b(O);return this._writableState.defaultEncoding=O,this},Object.defineProperty(U.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function oe(K,O,A){return!K.objectMode&&K.decodeStrings!==!1&&typeof O=="string"&&(O=i.from(O,A)),O}Object.defineProperty(U.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function C(K,O,A,W,B,I){if(!A){var L=oe(O,W,B);W!==L&&(A=!0,B="buffer",W=L)}var Z=O.objectMode?1:W.length;O.length+=Z;var E=O.length<O.highWaterMark;if(E||(O.needDrain=!0),O.writing||O.corked){var Y=O.lastBufferedRequest;O.lastBufferedRequest={chunk:W,encoding:B,isBuf:A,callback:I,next:null},Y?Y.next=O.lastBufferedRequest:O.bufferedRequest=O.lastBufferedRequest,O.bufferedRequestCount+=1}else H(K,O,!1,Z,W,B,I);return E}function H(K,O,A,W,B,I,L){O.writelen=W,O.writecb=L,O.writing=!0,O.sync=!0,O.destroyed?O.onwrite(new x("write")):A?K._writev(B,O.onwrite):K._write(B,I,O.onwrite),O.sync=!1}function k(K,O,A,W,B){--O.pendingcb,A?(Ce.nextTick(B,W),Ce.nextTick($,K,O),K._writableState.errorEmitted=!0,w(K,W)):(B(W),K._writableState.errorEmitted=!0,w(K,W),$(K,O))}function V(K){K.writing=!1,K.writecb=null,K.length-=K.writelen,K.writelen=0}function Q(K,O){var A=K._writableState,W=A.sync,B=A.writecb;if(typeof B!="function")throw new y;if(V(A),O)k(K,A,W,O,B);else{var I=le(A)||K.destroyed;!I&&!A.corked&&!A.bufferProcessing&&A.bufferedRequest&&ee(K,A),W?Ce.nextTick(j,K,A,I,B):j(K,A,I,B)}}function j(K,O,A,W){A||ie(K,O),O.pendingcb--,W(),$(K,O)}function ie(K,O){O.length===0&&O.needDrain&&(O.needDrain=!1,K.emit("drain"))}function ee(K,O){O.bufferProcessing=!0;var A=O.bufferedRequest;if(K._writev&&A&&A.next){var W=O.bufferedRequestCount,B=new Array(W),I=O.corkedRequestsFree;I.entry=A;for(var L=0,Z=!0;A;)B[L]=A,A.isBuf||(Z=!1),A=A.next,L+=1;B.allBuffers=Z,H(K,O,!0,O.length,B,"",I.finish),O.pendingcb++,O.lastBufferedRequest=null,I.next?(O.corkedRequestsFree=I.next,I.next=null):O.corkedRequestsFree=new r(O),O.bufferedRequestCount=0}else{for(;A;){var E=A.chunk,Y=A.encoding,N=A.callback,p=O.objectMode?1:E.length;if(H(K,O,!1,p,E,Y,N),A=A.next,O.bufferedRequestCount--,O.writing)break}A===null&&(O.lastBufferedRequest=null)}O.bufferedRequest=A,O.bufferProcessing=!1}U.prototype._write=function(K,O,A){A(new h("_write()"))},U.prototype._writev=null,U.prototype.end=function(K,O,A){var W=this._writableState;return typeof K=="function"?(A=K,K=null,O=null):typeof O=="function"&&(A=O,O=null),K!=null&&this.write(K,O),W.corked&&(W.corked=1,this.uncork()),W.ending||X(this,W,A),this},Object.defineProperty(U.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function le(K){return K.ending&&K.length===0&&K.bufferedRequest===null&&!K.finished&&!K.writing}function G(K,O){K._final(function(A){O.pendingcb--,A&&w(K,A),O.prefinished=!0,K.emit("prefinish"),$(K,O)})}function D(K,O){!O.prefinished&&!O.finalCalled&&(typeof K._final=="function"&&!O.destroyed?(O.pendingcb++,O.finalCalled=!0,Ce.nextTick(G,K,O)):(O.prefinished=!0,K.emit("prefinish")))}function $(K,O){var A=le(O);if(A&&(D(K,O),O.pendingcb===0&&(O.finished=!0,K.emit("finish"),O.autoDestroy))){var W=K._readableState;(!W||W.autoDestroy&&W.endEmitted)&&K.destroy()}return A}function X(K,O,A){O.ending=!0,$(K,O),A&&(O.finished?Ce.nextTick(A):K.once("finish",A)),O.ended=!0,K.writable=!1}function re(K,O,A){var W=K.entry;for(K.entry=null;W;){var B=W.callback;O.pendingcb--,B(A),W=W.next}O.corkedRequestsFree.next=K}return Object.defineProperty(U.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(O){this._writableState&&(this._writableState.destroyed=O)}}),U.prototype.destroy=l.destroy,U.prototype._undestroy=l.undestroy,U.prototype._destroy=function(K,O){O(K)},zv}function zs(){if(QM)return jv;QM=1;var r=Object.keys||function(u){var c=[];for(var f in u)c.push(f);return c};jv=a;var e=s5(),t=i5();ei()(a,e);for(var n=r(t.prototype),i=0;i<n.length;i++){var s=n[i];a.prototype[s]||(a.prototype[s]=t.prototype[s])}function a(u){if(!(this instanceof a))return new a(u);e.call(this,u),t.call(this,u),this.allowHalfOpen=!0,u&&(u.readable===!1&&(this.readable=!1),u.writable===!1&&(this.writable=!1),u.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",o)))}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function o(){this._writableState.ended||Ce.nextTick(l,this)}function l(u){u.end()}return Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(c){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=c,this._writableState.destroyed=c)}}),jv}function u$(){return e2||(e2=1,(function(r,e){var t=wf(),n=t.Buffer;function i(a,o){for(var l in a)o[l]=a[l]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?r.exports=t:(i(t,e),e.Buffer=s);function s(a,o,l){return n(a,o,l)}i(n,s),s.from=function(a,o,l){if(typeof a=="number")throw new TypeError("Argument must not be a number");return n(a,o,l)},s.alloc=function(a,o,l){if(typeof a!="number")throw new TypeError("Argument must be a number");var u=n(a);return o!==void 0?typeof l=="string"?u.fill(o,l):u.fill(o):u.fill(0),u},s.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n(a)},s.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(a)}})(zc,zc.exports)),zc.exports}function Ey(){if(t2)return Wv;t2=1;var r=u$().Buffer,e=r.isEncoding||function(m){switch(m=""+m,m&&m.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(m){if(!m)return"utf8";for(var _;;)switch(m){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return m;default:if(_)return;m=(""+m).toLowerCase(),_=!0}}function n(m){var _=t(m);if(typeof _!="string"&&(r.isEncoding===e||!e(m)))throw new Error("Unknown encoding: "+m);return _||m}Wv.StringDecoder=i;function i(m){this.encoding=n(m);var _;switch(this.encoding){case"utf16le":this.text=f,this.end=d,_=4;break;case"utf8":this.fillLast=l,_=4;break;case"base64":this.text=h,this.end=y,_=3;break;default:this.write=v,this.end=x;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(_)}i.prototype.write=function(m){if(m.length===0)return"";var _,b;if(this.lastNeed){if(_=this.fillLast(m),_===void 0)return"";b=this.lastNeed,this.lastNeed=0}else b=0;return b<m.length?_?_+this.text(m,b):this.text(m,b):_||""},i.prototype.end=c,i.prototype.text=u,i.prototype.fillLast=function(m){if(this.lastNeed<=m.length)return m.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);m.copy(this.lastChar,this.lastTotal-this.lastNeed,0,m.length),this.lastNeed-=m.length};function s(m){return m<=127?0:m>>5===6?2:m>>4===14?3:m>>3===30?4:m>>6===2?-1:-2}function a(m,_,b){var w=_.length-1;if(w<b)return 0;var T=s(_[w]);return T>=0?(T>0&&(m.lastNeed=T-1),T):--w<b||T===-2?0:(T=s(_[w]),T>=0?(T>0&&(m.lastNeed=T-2),T):--w<b||T===-2?0:(T=s(_[w]),T>=0?(T>0&&(T===2?T=0:m.lastNeed=T-3),T):0))}function o(m,_,b){if((_[0]&192)!==128)return m.lastNeed=0,"\uFFFD";if(m.lastNeed>1&&_.length>1){if((_[1]&192)!==128)return m.lastNeed=1,"\uFFFD";if(m.lastNeed>2&&_.length>2&&(_[2]&192)!==128)return m.lastNeed=2,"\uFFFD"}}function l(m){var _=this.lastTotal-this.lastNeed,b=o(this,m);if(b!==void 0)return b;if(this.lastNeed<=m.length)return m.copy(this.lastChar,_,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);m.copy(this.lastChar,_,0,m.length),this.lastNeed-=m.length}function u(m,_){var b=a(this,m,_);if(!this.lastNeed)return m.toString("utf8",_);this.lastTotal=b;var w=m.length-(b-this.lastNeed);return m.copy(this.lastChar,0,w),m.toString("utf8",_,w)}function c(m){var _=m&&m.length?this.write(m):"";return this.lastNeed?_+"\uFFFD":_}function f(m,_){if((m.length-_)%2===0){var b=m.toString("utf16le",_);if(b){var w=b.charCodeAt(b.length-1);if(w>=55296&&w<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=m[m.length-2],this.lastChar[1]=m[m.length-1],b.slice(0,-1)}return b}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=m[m.length-1],m.toString("utf16le",_,m.length-1)}function d(m){var _=m&&m.length?this.write(m):"";if(this.lastNeed){var b=this.lastTotal-this.lastNeed;return _+this.lastChar.toString("utf16le",0,b)}return _}function h(m,_){var b=(m.length-_)%3;return b===0?m.toString("base64",_):(this.lastNeed=3-b,this.lastTotal=3,b===1?this.lastChar[0]=m[m.length-1]:(this.lastChar[0]=m[m.length-2],this.lastChar[1]=m[m.length-1]),m.toString("base64",_,m.length-b))}function y(m){var _=m&&m.length?this.write(m):"";return this.lastNeed?_+this.lastChar.toString("base64",0,3-this.lastNeed):_}function v(m){return m.toString(this.encoding)}function x(m){return m&&m.length?this.write(m):""}return Wv}function f1(){if(r2)return qv;r2=1;var r=Js().codes.ERR_STREAM_PREMATURE_CLOSE;function e(s){var a=!1;return function(){if(!a){a=!0;for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];s.apply(this,l)}}}function t(){}function n(s){return s.setHeader&&typeof s.abort=="function"}function i(s,a,o){if(typeof a=="function")return i(s,null,a);a||(a={}),o=e(o||t);var l=a.readable||a.readable!==!1&&s.readable,u=a.writable||a.writable!==!1&&s.writable,c=function(){s.writable||d()},f=s._writableState&&s._writableState.finished,d=function(){u=!1,f=!0,l||o.call(s)},h=s._readableState&&s._readableState.endEmitted,y=function(){l=!1,h=!0,u||o.call(s)},v=function(b){o.call(s,b)},x=function(){var b;if(l&&!h)return(!s._readableState||!s._readableState.ended)&&(b=new r),o.call(s,b);if(u&&!f)return(!s._writableState||!s._writableState.ended)&&(b=new r),o.call(s,b)},m=function(){s.req.on("finish",d)};return n(s)?(s.on("complete",d),s.on("abort",x),s.req?m():s.on("request",m)):u&&!s._writableState&&(s.on("end",c),s.on("close",c)),s.on("end",y),s.on("finish",d),a.error!==!1&&s.on("error",v),s.on("close",x),function(){s.removeListener("complete",d),s.removeListener("abort",x),s.removeListener("request",m),s.req&&s.req.removeListener("finish",d),s.removeListener("end",c),s.removeListener("close",c),s.removeListener("finish",d),s.removeListener("end",y),s.removeListener("error",v),s.removeListener("close",x)}}return qv=i,qv}function c$(){if(n2)return Vv;n2=1;var r;function e(m,_,b){return _ in m?Object.defineProperty(m,_,{value:b,enumerable:!0,configurable:!0,writable:!0}):m[_]=b,m}var t=f1(),n=Symbol("lastResolve"),i=Symbol("lastReject"),s=Symbol("error"),a=Symbol("ended"),o=Symbol("lastPromise"),l=Symbol("handlePromise"),u=Symbol("stream");function c(m,_){return{value:m,done:_}}function f(m){var _=m[n];if(_!==null){var b=m[u].read();b!==null&&(m[o]=null,m[n]=null,m[i]=null,_(c(b,!1)))}}function d(m){Ce.nextTick(f,m)}function h(m,_){return function(b,w){m.then(function(){if(_[a]){b(c(void 0,!0));return}_[l](b,w)},w)}}var y=Object.getPrototypeOf(function(){}),v=Object.setPrototypeOf((r={get stream(){return this[u]},next:function(){var _=this,b=this[s];if(b!==null)return Promise.reject(b);if(this[a])return Promise.resolve(c(void 0,!0));if(this[u].destroyed)return new Promise(function(M,U){Ce.nextTick(function(){_[s]?U(_[s]):M(c(void 0,!0))})});var w=this[o],T;if(w)T=new Promise(h(w,this));else{var P=this[u].read();if(P!==null)return Promise.resolve(c(P,!1));T=new Promise(this[l])}return this[o]=T,T}},e(r,Symbol.asyncIterator,function(){return this}),e(r,"return",function(){var _=this;return new Promise(function(b,w){_[u].destroy(null,function(T){if(T){w(T);return}b(c(void 0,!0))})})}),r),y),x=function(_){var b,w=Object.create(v,(b={},e(b,u,{value:_,writable:!0}),e(b,n,{value:null,writable:!0}),e(b,i,{value:null,writable:!0}),e(b,s,{value:null,writable:!0}),e(b,a,{value:_._readableState.endEmitted,writable:!0}),e(b,l,{value:function(P,M){var U=w[u].read();U?(w[o]=null,w[n]=null,w[i]=null,P(c(U,!1))):(w[n]=P,w[i]=M)},writable:!0}),b));return w[o]=null,t(_,function(T){if(T&&T.code!=="ERR_STREAM_PREMATURE_CLOSE"){var P=w[i];P!==null&&(w[o]=null,w[n]=null,w[i]=null,P(T)),w[s]=T;return}var M=w[n];M!==null&&(w[o]=null,w[n]=null,w[i]=null,M(c(void 0,!0))),w[a]=!0}),_.on("readable",d.bind(null,w)),w};return Vv=x,Vv}function f$(){return i2||(i2=1,Kv=function(){throw new Error("Readable.from is not available in the browser")}),Kv}function s5(){if(s2)return Gv;s2=1,Gv=R;var r;R.ReadableState=U,a1().EventEmitter;var e=function(L,Z){return L.listeners(Z).length},t=V2(),n=wf().Buffer,i=qr.Uint8Array||function(){};function s(I){return n.from(I)}function a(I){return n.isBuffer(I)||I instanceof i}var o=t5(),l;o&&o.debuglog?l=o.debuglog("stream"):l=function(){};var u=a$(),c=r5(),f=n5(),d=f.getHighWaterMark,h=Js().codes,y=h.ERR_INVALID_ARG_TYPE,v=h.ERR_STREAM_PUSH_AFTER_EOF,x=h.ERR_METHOD_NOT_IMPLEMENTED,m=h.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,_,b,w;ei()(R,t);var T=c.errorOrDestroy,P=["error","close","destroy","pause","resume"];function M(I,L,Z){if(typeof I.prependListener=="function")return I.prependListener(L,Z);!I._events||!I._events[L]?I.on(L,Z):Array.isArray(I._events[L])?I._events[L].unshift(Z):I._events[L]=[Z,I._events[L]]}function U(I,L,Z){r=r||zs(),I=I||{},typeof Z!="boolean"&&(Z=L instanceof r),this.objectMode=!!I.objectMode,Z&&(this.objectMode=this.objectMode||!!I.readableObjectMode),this.highWaterMark=d(this,I,"readableHighWaterMark",Z),this.buffer=new u,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=I.emitClose!==!1,this.autoDestroy=!!I.autoDestroy,this.destroyed=!1,this.defaultEncoding=I.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,I.encoding&&(_||(_=Ey().StringDecoder),this.decoder=new _(I.encoding),this.encoding=I.encoding)}function R(I){if(r=r||zs(),!(this instanceof R))return new R(I);var L=this instanceof r;this._readableState=new U(I,this,L),this.readable=!0,I&&(typeof I.read=="function"&&(this._read=I.read),typeof I.destroy=="function"&&(this._destroy=I.destroy)),t.call(this)}Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(L){this._readableState&&(this._readableState.destroyed=L)}}),R.prototype.destroy=c.destroy,R.prototype._undestroy=c.undestroy,R.prototype._destroy=function(I,L){L(I)},R.prototype.push=function(I,L){var Z=this._readableState,E;return Z.objectMode?E=!0:typeof I=="string"&&(L=L||Z.defaultEncoding,L!==Z.encoding&&(I=n.from(I,L),L=""),E=!0),J(this,I,L,!1,E)},R.prototype.unshift=function(I){return J(this,I,null,!0,!1)};function J(I,L,Z,E,Y){l("readableAddChunk",L);var N=I._readableState;if(L===null)N.reading=!1,Q(I,N);else{var p;if(Y||(p=C(N,L)),p)T(I,p);else if(N.objectMode||L&&L.length>0)if(typeof L!="string"&&!N.objectMode&&Object.getPrototypeOf(L)!==n.prototype&&(L=s(L)),E)N.endEmitted?T(I,new m):oe(I,N,L,!0);else if(N.ended)T(I,new v);else{if(N.destroyed)return!1;N.reading=!1,N.decoder&&!Z?(L=N.decoder.write(L),N.objectMode||L.length!==0?oe(I,N,L,!1):ee(I,N)):oe(I,N,L,!1)}else E||(N.reading=!1,ee(I,N))}return!N.ended&&(N.length<N.highWaterMark||N.length===0)}function oe(I,L,Z,E){L.flowing&&L.length===0&&!L.sync?(L.awaitDrain=0,I.emit("data",Z)):(L.length+=L.objectMode?1:Z.length,E?L.buffer.unshift(Z):L.buffer.push(Z),L.needReadable&&j(I)),ee(I,L)}function C(I,L){var Z;return!a(L)&&typeof L!="string"&&L!==void 0&&!I.objectMode&&(Z=new y("chunk",["string","Buffer","Uint8Array"],L)),Z}R.prototype.isPaused=function(){return this._readableState.flowing===!1},R.prototype.setEncoding=function(I){_||(_=Ey().StringDecoder);var L=new _(I);this._readableState.decoder=L,this._readableState.encoding=this._readableState.decoder.encoding;for(var Z=this._readableState.buffer.head,E="";Z!==null;)E+=L.write(Z.data),Z=Z.next;return this._readableState.buffer.clear(),E!==""&&this._readableState.buffer.push(E),this._readableState.length=E.length,this};var H=1073741824;function k(I){return I>=H?I=H:(I--,I|=I>>>1,I|=I>>>2,I|=I>>>4,I|=I>>>8,I|=I>>>16,I++),I}function V(I,L){return I<=0||L.length===0&&L.ended?0:L.objectMode?1:I!==I?L.flowing&&L.length?L.buffer.head.data.length:L.length:(I>L.highWaterMark&&(L.highWaterMark=k(I)),I<=L.length?I:L.ended?L.length:(L.needReadable=!0,0))}R.prototype.read=function(I){l("read",I),I=parseInt(I,10);var L=this._readableState,Z=I;if(I!==0&&(L.emittedReadable=!1),I===0&&L.needReadable&&((L.highWaterMark!==0?L.length>=L.highWaterMark:L.length>0)||L.ended))return l("read: emitReadable",L.length,L.ended),L.length===0&&L.ended?A(this):j(this),null;if(I=V(I,L),I===0&&L.ended)return L.length===0&&A(this),null;var E=L.needReadable;l("need readable",E),(L.length===0||L.length-I<L.highWaterMark)&&(E=!0,l("length less than watermark",E)),L.ended||L.reading?(E=!1,l("reading or ended",E)):E&&(l("do read"),L.reading=!0,L.sync=!0,L.length===0&&(L.needReadable=!0),this._read(L.highWaterMark),L.sync=!1,L.reading||(I=V(Z,L)));var Y;return I>0?Y=O(I,L):Y=null,Y===null?(L.needReadable=L.length<=L.highWaterMark,I=0):(L.length-=I,L.awaitDrain=0),L.length===0&&(L.ended||(L.needReadable=!0),Z!==I&&L.ended&&A(this)),Y!==null&&this.emit("data",Y),Y};function Q(I,L){if(l("onEofChunk"),!L.ended){if(L.decoder){var Z=L.decoder.end();Z&&Z.length&&(L.buffer.push(Z),L.length+=L.objectMode?1:Z.length)}L.ended=!0,L.sync?j(I):(L.needReadable=!1,L.emittedReadable||(L.emittedReadable=!0,ie(I)))}}function j(I){var L=I._readableState;l("emitReadable",L.needReadable,L.emittedReadable),L.needReadable=!1,L.emittedReadable||(l("emitReadable",L.flowing),L.emittedReadable=!0,Ce.nextTick(ie,I))}function ie(I){var L=I._readableState;l("emitReadable_",L.destroyed,L.length,L.ended),!L.destroyed&&(L.length||L.ended)&&(I.emit("readable"),L.emittedReadable=!1),L.needReadable=!L.flowing&&!L.ended&&L.length<=L.highWaterMark,K(I)}function ee(I,L){L.readingMore||(L.readingMore=!0,Ce.nextTick(le,I,L))}function le(I,L){for(;!L.reading&&!L.ended&&(L.length<L.highWaterMark||L.flowing&&L.length===0);){var Z=L.length;if(l("maybeReadMore read 0"),I.read(0),Z===L.length)break}L.readingMore=!1}R.prototype._read=function(I){T(this,new x("_read()"))},R.prototype.pipe=function(I,L){var Z=this,E=this._readableState;switch(E.pipesCount){case 0:E.pipes=I;break;case 1:E.pipes=[E.pipes,I];break;default:E.pipes.push(I);break}E.pipesCount+=1,l("pipe count=%d opts=%j",E.pipesCount,L);var Y=(!L||L.end!==!1)&&I!==Ce.stdout&&I!==Ce.stderr,N=Y?g:fe;E.endEmitted?Ce.nextTick(N):Z.once("end",N),I.on("unpipe",p);function p(pe,ve){l("onunpipe"),pe===Z&&ve&&ve.hasUnpiped===!1&&(ve.hasUnpiped=!0,q())}function g(){l("onend"),I.end()}var S=G(Z);I.on("drain",S);var F=!1;function q(){l("cleanup"),I.removeListener("close",ae),I.removeListener("finish",se),I.removeListener("drain",S),I.removeListener("error",ne),I.removeListener("unpipe",p),Z.removeListener("end",g),Z.removeListener("end",fe),Z.removeListener("data",z),F=!0,E.awaitDrain&&(!I._writableState||I._writableState.needDrain)&&S()}Z.on("data",z);function z(pe){l("ondata");var ve=I.write(pe);l("dest.write",ve),ve===!1&&((E.pipesCount===1&&E.pipes===I||E.pipesCount>1&&B(E.pipes,I)!==-1)&&!F&&(l("false write response, pause",E.awaitDrain),E.awaitDrain++),Z.pause())}function ne(pe){l("onerror",pe),fe(),I.removeListener("error",ne),e(I,"error")===0&&T(I,pe)}M(I,"error",ne);function ae(){I.removeListener("finish",se),fe()}I.once("close",ae);function se(){l("onfinish"),I.removeListener("close",ae),fe()}I.once("finish",se);function fe(){l("unpipe"),Z.unpipe(I)}return I.emit("pipe",Z),E.flowing||(l("pipe resume"),Z.resume()),I};function G(I){return function(){var Z=I._readableState;l("pipeOnDrain",Z.awaitDrain),Z.awaitDrain&&Z.awaitDrain--,Z.awaitDrain===0&&e(I,"data")&&(Z.flowing=!0,K(I))}}R.prototype.unpipe=function(I){var L=this._readableState,Z={hasUnpiped:!1};if(L.pipesCount===0)return this;if(L.pipesCount===1)return I&&I!==L.pipes?this:(I||(I=L.pipes),L.pipes=null,L.pipesCount=0,L.flowing=!1,I&&I.emit("unpipe",this,Z),this);if(!I){var E=L.pipes,Y=L.pipesCount;L.pipes=null,L.pipesCount=0,L.flowing=!1;for(var N=0;N<Y;N++)E[N].emit("unpipe",this,{hasUnpiped:!1});return this}var p=B(L.pipes,I);return p===-1?this:(L.pipes.splice(p,1),L.pipesCount-=1,L.pipesCount===1&&(L.pipes=L.pipes[0]),I.emit("unpipe",this,Z),this)},R.prototype.on=function(I,L){var Z=t.prototype.on.call(this,I,L),E=this._readableState;return I==="data"?(E.readableListening=this.listenerCount("readable")>0,E.flowing!==!1&&this.resume()):I==="readable"&&!E.endEmitted&&!E.readableListening&&(E.readableListening=E.needReadable=!0,E.flowing=!1,E.emittedReadable=!1,l("on readable",E.length,E.reading),E.length?j(this):E.reading||Ce.nextTick($,this)),Z},R.prototype.addListener=R.prototype.on,R.prototype.removeListener=function(I,L){var Z=t.prototype.removeListener.call(this,I,L);return I==="readable"&&Ce.nextTick(D,this),Z},R.prototype.removeAllListeners=function(I){var L=t.prototype.removeAllListeners.apply(this,arguments);return(I==="readable"||I===void 0)&&Ce.nextTick(D,this),L};function D(I){var L=I._readableState;L.readableListening=I.listenerCount("readable")>0,L.resumeScheduled&&!L.paused?L.flowing=!0:I.listenerCount("data")>0&&I.resume()}function $(I){l("readable nexttick read 0"),I.read(0)}R.prototype.resume=function(){var I=this._readableState;return I.flowing||(l("resume"),I.flowing=!I.readableListening,X(this,I)),I.paused=!1,this};function X(I,L){L.resumeScheduled||(L.resumeScheduled=!0,Ce.nextTick(re,I,L))}function re(I,L){l("resume",L.reading),L.reading||I.read(0),L.resumeScheduled=!1,I.emit("resume"),K(I),L.flowing&&!L.reading&&I.read(0)}R.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function K(I){var L=I._readableState;for(l("flow",L.flowing);L.flowing&&I.read()!==null;);}R.prototype.wrap=function(I){var L=this,Z=this._readableState,E=!1;I.on("end",function(){if(l("wrapped end"),Z.decoder&&!Z.ended){var p=Z.decoder.end();p&&p.length&&L.push(p)}L.push(null)}),I.on("data",function(p){if(l("wrapped data"),Z.decoder&&(p=Z.decoder.write(p)),!(Z.objectMode&&p==null)&&!(!Z.objectMode&&(!p||!p.length))){var g=L.push(p);g||(E=!0,I.pause())}});for(var Y in I)this[Y]===void 0&&typeof I[Y]=="function"&&(this[Y]=(function(g){return function(){return I[g].apply(I,arguments)}})(Y));for(var N=0;N<P.length;N++)I.on(P[N],this.emit.bind(this,P[N]));return this._read=function(p){l("wrapped _read",p),E&&(E=!1,I.resume())},this},typeof Symbol=="function"&&(R.prototype[Symbol.asyncIterator]=function(){return b===void 0&&(b=c$()),b(this)}),Object.defineProperty(R.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(R.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(R.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(L){this._readableState&&(this._readableState.flowing=L)}}),R._fromList=O,Object.defineProperty(R.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function O(I,L){if(L.length===0)return null;var Z;return L.objectMode?Z=L.buffer.shift():!I||I>=L.length?(L.decoder?Z=L.buffer.join(""):L.buffer.length===1?Z=L.buffer.first():Z=L.buffer.concat(L.length),L.buffer.clear()):Z=L.buffer.consume(I,L.decoder),Z}function A(I){var L=I._readableState;l("endReadable",L.endEmitted),L.endEmitted||(L.ended=!0,Ce.nextTick(W,L,I))}function W(I,L){if(l("endReadableNT",I.endEmitted,I.length),!I.endEmitted&&I.length===0&&(I.endEmitted=!0,L.readable=!1,L.emit("end"),I.autoDestroy)){var Z=L._writableState;(!Z||Z.autoDestroy&&Z.finished)&&L.destroy()}}typeof Symbol=="function"&&(R.from=function(I,L){return w===void 0&&(w=f$()),w(R,I,L)});function B(I,L){for(var Z=0,E=I.length;Z<E;Z++)if(I[Z]===L)return Z;return-1}return Gv}function o5(){if(o2)return $v;o2=1,$v=o;var r=Js().codes,e=r.ERR_METHOD_NOT_IMPLEMENTED,t=r.ERR_MULTIPLE_CALLBACK,n=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,i=r.ERR_TRANSFORM_WITH_LENGTH_0,s=zs();ei()(o,s);function a(c,f){var d=this._transformState;d.transforming=!1;var h=d.writecb;if(h===null)return this.emit("error",new t);d.writechunk=null,d.writecb=null,f!=null&&this.push(f),h(c);var y=this._readableState;y.reading=!1,(y.needReadable||y.length<y.highWaterMark)&&this._read(y.highWaterMark)}function o(c){if(!(this instanceof o))return new o(c);s.call(this,c),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.on("prefinish",l)}function l(){var c=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(f,d){u(c,f,d)}):u(this,null,null)}o.prototype.push=function(c,f){return this._transformState.needTransform=!1,s.prototype.push.call(this,c,f)},o.prototype._transform=function(c,f,d){d(new e("_transform()"))},o.prototype._write=function(c,f,d){var h=this._transformState;if(h.writecb=d,h.writechunk=c,h.writeencoding=f,!h.transforming){var y=this._readableState;(h.needTransform||y.needReadable||y.length<y.highWaterMark)&&this._read(y.highWaterMark)}},o.prototype._read=function(c){var f=this._transformState;f.writechunk!==null&&!f.transforming?(f.transforming=!0,this._transform(f.writechunk,f.writeencoding,f.afterTransform)):f.needTransform=!0},o.prototype._destroy=function(c,f){s.prototype._destroy.call(this,c,function(d){f(d)})};function u(c,f,d){if(f)return c.emit("error",f);if(d!=null&&c.push(d),c._writableState.length)throw new i;if(c._transformState.transforming)throw new n;return c.push(null)}return $v}function h$(){if(a2)return Jv;a2=1,Jv=e;var r=o5();ei()(e,r);function e(t){if(!(this instanceof e))return new e(t);r.call(this,t)}return e.prototype._transform=function(t,n,i){i(null,t)},Jv}function d$(){if(l2)return Xv;l2=1;var r;function e(d){var h=!1;return function(){h||(h=!0,d.apply(void 0,arguments))}}var t=Js().codes,n=t.ERR_MISSING_ARGS,i=t.ERR_STREAM_DESTROYED;function s(d){if(d)throw d}function a(d){return d.setHeader&&typeof d.abort=="function"}function o(d,h,y,v){v=e(v);var x=!1;d.on("close",function(){x=!0}),r===void 0&&(r=f1()),r(d,{readable:h,writable:y},function(_){if(_)return v(_);x=!0,v()});var m=!1;return function(_){if(!x&&!m){if(m=!0,a(d))return d.abort();if(typeof d.destroy=="function")return d.destroy();v(_||new i("pipe"))}}}function l(d){d()}function u(d,h){return d.pipe(h)}function c(d){return!d.length||typeof d[d.length-1]!="function"?s:d.pop()}function f(){for(var d=arguments.length,h=new Array(d),y=0;y<d;y++)h[y]=arguments[y];var v=c(h);if(Array.isArray(h[0])&&(h=h[0]),h.length<2)throw new n("streams");var x,m=h.map(function(_,b){var w=b<h.length-1,T=b>0;return o(_,w,T,function(P){x||(x=P),P&&m.forEach(l),!w&&(m.forEach(l),v(x))})});return h.reduce(u)}return Xv=f,Xv}function h1(){if(u2)return Yv;u2=1,Yv=t;var r=a1().EventEmitter,e=ei();e(t,r),t.Readable=s5(),t.Writable=i5(),t.Duplex=zs(),t.Transform=o5(),t.PassThrough=h$(),t.finished=f1(),t.pipeline=d$(),t.Stream=t;function t(){r.call(this)}return t.prototype.pipe=function(n,i){var s=this;function a(h){n.writable&&n.write(h)===!1&&s.pause&&s.pause()}s.on("data",a);function o(){s.readable&&s.resume&&s.resume()}n.on("drain",o),!n._isStdio&&(!i||i.end!==!1)&&(s.on("end",u),s.on("close",c));var l=!1;function u(){l||(l=!0,n.end())}function c(){l||(l=!0,typeof n.destroy=="function"&&n.destroy())}function f(h){if(d(),r.listenerCount(this,"error")===0)throw h}s.on("error",f),n.on("error",f);function d(){s.removeListener("data",a),n.removeListener("drain",o),s.removeListener("end",u),s.removeListener("close",c),s.removeListener("error",f),n.removeListener("error",f),s.removeListener("end",d),s.removeListener("close",d),n.removeListener("close",d)}return s.on("end",d),s.on("close",d),n.on("close",d),n.emit("pipe",s),n},Yv}function p$(){return c2||(c2=1,(function(r){(function(e){e.parser=function(O,A){return new n(O,A)},e.SAXParser=n,e.SAXStream=c,e.createStream=u,e.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function n(O,A){if(!(this instanceof n))return new n(O,A);var W=this;s(W),W.q=W.c="",W.bufferCheckPosition=e.MAX_BUFFER_LENGTH,W.opt=A||{},W.opt.lowercase=W.opt.lowercase||W.opt.lowercasetags,W.looseCase=W.opt.lowercase?"toLowerCase":"toUpperCase",W.tags=[],W.closed=W.closedRoot=W.sawRoot=!1,W.tag=W.error=null,W.strict=!!O,W.noscript=!!(O||W.opt.noscript),W.state=R.BEGIN,W.strictEntities=W.opt.strictEntities,W.ENTITIES=W.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),W.attribList=[],W.opt.xmlns&&(W.ns=Object.create(v)),W.trackPosition=W.opt.position!==!1,W.trackPosition&&(W.position=W.line=W.column=0),oe(W,"onready")}Object.create||(Object.create=function(O){function A(){}A.prototype=O;var W=new A;return W}),Object.keys||(Object.keys=function(O){var A=[];for(var W in O)O.hasOwnProperty(W)&&A.push(W);return A});function i(O){for(var A=Math.max(e.MAX_BUFFER_LENGTH,10),W=0,B=0,I=t.length;B<I;B++){var L=O[t[B]].length;if(L>A)switch(t[B]){case"textNode":H(O);break;case"cdata":C(O,"oncdata",O.cdata),O.cdata="";break;case"script":C(O,"onscript",O.script),O.script="";break;default:V(O,"Max buffer length exceeded: "+t[B])}W=Math.max(W,L)}var Z=e.MAX_BUFFER_LENGTH-W;O.bufferCheckPosition=Z+O.position}function s(O){for(var A=0,W=t.length;A<W;A++)O[t[A]]=""}function a(O){H(O),O.cdata!==""&&(C(O,"oncdata",O.cdata),O.cdata=""),O.script!==""&&(C(O,"onscript",O.script),O.script="")}n.prototype={end:function(){Q(this)},write:K,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){a(this)}};var o;try{o=h1().Stream}catch{o=function(){}}var l=e.EVENTS.filter(function(O){return O!=="error"&&O!=="end"});function u(O,A){return new c(O,A)}function c(O,A){if(!(this instanceof c))return new c(O,A);o.apply(this),this._parser=new n(O,A),this.writable=!0,this.readable=!0;var W=this;this._parser.onend=function(){W.emit("end")},this._parser.onerror=function(B){W.emit("error",B),W._parser.error=null},this._decoder=null,l.forEach(function(B){Object.defineProperty(W,"on"+B,{get:function(){return W._parser["on"+B]},set:function(I){if(!I)return W.removeAllListeners(B),W._parser["on"+B]=I,I;W.on(B,I)},enumerable:!0,configurable:!1})})}c.prototype=Object.create(o.prototype,{constructor:{value:c}}),c.prototype.write=function(O){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(O)){if(!this._decoder){var A=Ey().StringDecoder;this._decoder=new A("utf8")}O=this._decoder.write(O)}return this._parser.write(O.toString()),this.emit("data",O),!0},c.prototype.end=function(O){return O&&O.length&&this.write(O),this._parser.end(),!0},c.prototype.on=function(O,A){var W=this;return!W._parser["on"+O]&&l.indexOf(O)!==-1&&(W._parser["on"+O]=function(){var B=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);B.splice(0,0,O),W.emit.apply(W,B)}),o.prototype.on.call(W,O,A)};var f="[CDATA[",d="DOCTYPE",h="http://www.w3.org/XML/1998/namespace",y="http://www.w3.org/2000/xmlns/",v={xml:h,xmlns:y},x=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,_=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,b=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function w(O){return O===" "||O===`
`||O==="\r"||O==="	"}function T(O){return O==='"'||O==="'"}function P(O){return O===">"||w(O)}function M(O,A){return O.test(A)}function U(O,A){return!M(O,A)}var R=0;e.STATE={BEGIN:R++,BEGIN_WHITESPACE:R++,TEXT:R++,TEXT_ENTITY:R++,OPEN_WAKA:R++,SGML_DECL:R++,SGML_DECL_QUOTED:R++,DOCTYPE:R++,DOCTYPE_QUOTED:R++,DOCTYPE_DTD:R++,DOCTYPE_DTD_QUOTED:R++,COMMENT_STARTING:R++,COMMENT:R++,COMMENT_ENDING:R++,COMMENT_ENDED:R++,CDATA:R++,CDATA_ENDING:R++,CDATA_ENDING_2:R++,PROC_INST:R++,PROC_INST_BODY:R++,PROC_INST_ENDING:R++,OPEN_TAG:R++,OPEN_TAG_SLASH:R++,ATTRIB:R++,ATTRIB_NAME:R++,ATTRIB_NAME_SAW_WHITE:R++,ATTRIB_VALUE:R++,ATTRIB_VALUE_QUOTED:R++,ATTRIB_VALUE_CLOSED:R++,ATTRIB_VALUE_UNQUOTED:R++,ATTRIB_VALUE_ENTITY_Q:R++,ATTRIB_VALUE_ENTITY_U:R++,CLOSE_TAG:R++,CLOSE_TAG_SAW_WHITE:R++,SCRIPT:R++,SCRIPT_ENDING:R++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(O){var A=e.ENTITIES[O],W=typeof A=="number"?String.fromCharCode(A):A;e.ENTITIES[O]=W});for(var J in e.STATE)e.STATE[e.STATE[J]]=J;R=e.STATE;function oe(O,A,W){O[A]&&O[A](W)}function C(O,A,W){O.textNode&&H(O),oe(O,A,W)}function H(O){O.textNode=k(O.opt,O.textNode),O.textNode&&oe(O,"ontext",O.textNode),O.textNode=""}function k(O,A){return O.trim&&(A=A.trim()),O.normalize&&(A=A.replace(/\s+/g," ")),A}function V(O,A){return H(O),O.trackPosition&&(A+=`
Line: `+O.line+`
Column: `+O.column+`
Char: `+O.c),A=new Error(A),O.error=A,oe(O,"onerror",A),O}function Q(O){return O.sawRoot&&!O.closedRoot&&j(O,"Unclosed root tag"),O.state!==R.BEGIN&&O.state!==R.BEGIN_WHITESPACE&&O.state!==R.TEXT&&V(O,"Unexpected end"),H(O),O.c="",O.closed=!0,oe(O,"onend"),n.call(O,O.strict,O.opt),O}function j(O,A){if(typeof O!="object"||!(O instanceof n))throw new Error("bad call to strictFail");O.strict&&V(O,A)}function ie(O){O.strict||(O.tagName=O.tagName[O.looseCase]());var A=O.tags[O.tags.length-1]||O,W=O.tag={name:O.tagName,attributes:{}};O.opt.xmlns&&(W.ns=A.ns),O.attribList.length=0,C(O,"onopentagstart",W)}function ee(O,A){var W=O.indexOf(":"),B=W<0?["",O]:O.split(":"),I=B[0],L=B[1];return A&&O==="xmlns"&&(I="xmlns",L=""),{prefix:I,local:L}}function le(O){if(O.strict||(O.attribName=O.attribName[O.looseCase]()),O.attribList.indexOf(O.attribName)!==-1||O.tag.attributes.hasOwnProperty(O.attribName)){O.attribName=O.attribValue="";return}if(O.opt.xmlns){var A=ee(O.attribName,!0),W=A.prefix,B=A.local;if(W==="xmlns")if(B==="xml"&&O.attribValue!==h)j(O,"xml: prefix must be bound to "+h+`
Actual: `+O.attribValue);else if(B==="xmlns"&&O.attribValue!==y)j(O,"xmlns: prefix must be bound to "+y+`
Actual: `+O.attribValue);else{var I=O.tag,L=O.tags[O.tags.length-1]||O;I.ns===L.ns&&(I.ns=Object.create(L.ns)),I.ns[B]=O.attribValue}O.attribList.push([O.attribName,O.attribValue])}else O.tag.attributes[O.attribName]=O.attribValue,C(O,"onattribute",{name:O.attribName,value:O.attribValue});O.attribName=O.attribValue=""}function G(O,A){if(O.opt.xmlns){var W=O.tag,B=ee(O.tagName);W.prefix=B.prefix,W.local=B.local,W.uri=W.ns[B.prefix]||"",W.prefix&&!W.uri&&(j(O,"Unbound namespace prefix: "+JSON.stringify(O.tagName)),W.uri=B.prefix);var I=O.tags[O.tags.length-1]||O;W.ns&&I.ns!==W.ns&&Object.keys(W.ns).forEach(function(z){C(O,"onopennamespace",{prefix:z,uri:W.ns[z]})});for(var L=0,Z=O.attribList.length;L<Z;L++){var E=O.attribList[L],Y=E[0],N=E[1],p=ee(Y,!0),g=p.prefix,S=p.local,F=g===""?"":W.ns[g]||"",q={name:Y,value:N,prefix:g,local:S,uri:F};g&&g!=="xmlns"&&!F&&(j(O,"Unbound namespace prefix: "+JSON.stringify(g)),q.uri=g),O.tag.attributes[Y]=q,C(O,"onattribute",q)}O.attribList.length=0}O.tag.isSelfClosing=!!A,O.sawRoot=!0,O.tags.push(O.tag),C(O,"onopentag",O.tag),A||(!O.noscript&&O.tagName.toLowerCase()==="script"?O.state=R.SCRIPT:O.state=R.TEXT,O.tag=null,O.tagName=""),O.attribName=O.attribValue="",O.attribList.length=0}function D(O){if(!O.tagName){j(O,"Weird empty close tag."),O.textNode+="</>",O.state=R.TEXT;return}if(O.script){if(O.tagName!=="script"){O.script+="</"+O.tagName+">",O.tagName="",O.state=R.SCRIPT;return}C(O,"onscript",O.script),O.script=""}var A=O.tags.length,W=O.tagName;O.strict||(W=W[O.looseCase]());for(var B=W;A--;){var I=O.tags[A];if(I.name!==B)j(O,"Unexpected close tag");else break}if(A<0){j(O,"Unmatched closing tag: "+O.tagName),O.textNode+="</"+O.tagName+">",O.state=R.TEXT;return}O.tagName=W;for(var L=O.tags.length;L-- >A;){var Z=O.tag=O.tags.pop();O.tagName=O.tag.name,C(O,"onclosetag",O.tagName);var E={};for(var Y in Z.ns)E[Y]=Z.ns[Y];var N=O.tags[O.tags.length-1]||O;O.opt.xmlns&&Z.ns!==N.ns&&Object.keys(Z.ns).forEach(function(p){var g=Z.ns[p];C(O,"onclosenamespace",{prefix:p,uri:g})})}A===0&&(O.closedRoot=!0),O.tagName=O.attribValue=O.attribName="",O.attribList.length=0,O.state=R.TEXT}function $(O){var A=O.entity,W=A.toLowerCase(),B,I="";return O.ENTITIES[A]?O.ENTITIES[A]:O.ENTITIES[W]?O.ENTITIES[W]:(A=W,A.charAt(0)==="#"&&(A.charAt(1)==="x"?(A=A.slice(2),B=parseInt(A,16),I=B.toString(16)):(A=A.slice(1),B=parseInt(A,10),I=B.toString(10))),A=A.replace(/^0+/,""),isNaN(B)||I.toLowerCase()!==A?(j(O,"Invalid character entity"),"&"+O.entity+";"):String.fromCodePoint(B))}function X(O,A){A==="<"?(O.state=R.OPEN_WAKA,O.startTagPosition=O.position):w(A)||(j(O,"Non-whitespace before first tag."),O.textNode=A,O.state=R.TEXT)}function re(O,A){var W="";return A<O.length&&(W=O.charAt(A)),W}function K(O){var A=this;if(this.error)throw this.error;if(A.closed)return V(A,"Cannot write after close. Assign an onready handler.");if(O===null)return Q(A);typeof O=="object"&&(O=O.toString());for(var W=0,B="";B=re(O,W++),A.c=B,!!B;)switch(A.trackPosition&&(A.position++,B===`
`?(A.line++,A.column=0):A.column++),A.state){case R.BEGIN:if(A.state=R.BEGIN_WHITESPACE,B==="\uFEFF")continue;X(A,B);continue;case R.BEGIN_WHITESPACE:X(A,B);continue;case R.TEXT:if(A.sawRoot&&!A.closedRoot){for(var I=W-1;B&&B!=="<"&&B!=="&";)B=re(O,W++),B&&A.trackPosition&&(A.position++,B===`
`?(A.line++,A.column=0):A.column++);A.textNode+=O.substring(I,W-1)}B==="<"&&!(A.sawRoot&&A.closedRoot&&!A.strict)?(A.state=R.OPEN_WAKA,A.startTagPosition=A.position):(!w(B)&&(!A.sawRoot||A.closedRoot)&&j(A,"Text data outside of root node."),B==="&"?A.state=R.TEXT_ENTITY:A.textNode+=B);continue;case R.SCRIPT:B==="<"?A.state=R.SCRIPT_ENDING:A.script+=B;continue;case R.SCRIPT_ENDING:B==="/"?A.state=R.CLOSE_TAG:(A.script+="<"+B,A.state=R.SCRIPT);continue;case R.OPEN_WAKA:if(B==="!")A.state=R.SGML_DECL,A.sgmlDecl="";else if(!w(B))if(M(x,B))A.state=R.OPEN_TAG,A.tagName=B;else if(B==="/")A.state=R.CLOSE_TAG,A.tagName="";else if(B==="?")A.state=R.PROC_INST,A.procInstName=A.procInstBody="";else{if(j(A,"Unencoded <"),A.startTagPosition+1<A.position){var L=A.position-A.startTagPosition;B=new Array(L).join(" ")+B}A.textNode+="<"+B,A.state=R.TEXT}continue;case R.SGML_DECL:(A.sgmlDecl+B).toUpperCase()===f?(C(A,"onopencdata"),A.state=R.CDATA,A.sgmlDecl="",A.cdata=""):A.sgmlDecl+B==="--"?(A.state=R.COMMENT,A.comment="",A.sgmlDecl=""):(A.sgmlDecl+B).toUpperCase()===d?(A.state=R.DOCTYPE,(A.doctype||A.sawRoot)&&j(A,"Inappropriately located doctype declaration"),A.doctype="",A.sgmlDecl=""):B===">"?(C(A,"onsgmldeclaration",A.sgmlDecl),A.sgmlDecl="",A.state=R.TEXT):(T(B)&&(A.state=R.SGML_DECL_QUOTED),A.sgmlDecl+=B);continue;case R.SGML_DECL_QUOTED:B===A.q&&(A.state=R.SGML_DECL,A.q=""),A.sgmlDecl+=B;continue;case R.DOCTYPE:B===">"?(A.state=R.TEXT,C(A,"ondoctype",A.doctype),A.doctype=!0):(A.doctype+=B,B==="["?A.state=R.DOCTYPE_DTD:T(B)&&(A.state=R.DOCTYPE_QUOTED,A.q=B));continue;case R.DOCTYPE_QUOTED:A.doctype+=B,B===A.q&&(A.q="",A.state=R.DOCTYPE);continue;case R.DOCTYPE_DTD:A.doctype+=B,B==="]"?A.state=R.DOCTYPE:T(B)&&(A.state=R.DOCTYPE_DTD_QUOTED,A.q=B);continue;case R.DOCTYPE_DTD_QUOTED:A.doctype+=B,B===A.q&&(A.state=R.DOCTYPE_DTD,A.q="");continue;case R.COMMENT:B==="-"?A.state=R.COMMENT_ENDING:A.comment+=B;continue;case R.COMMENT_ENDING:B==="-"?(A.state=R.COMMENT_ENDED,A.comment=k(A.opt,A.comment),A.comment&&C(A,"oncomment",A.comment),A.comment=""):(A.comment+="-"+B,A.state=R.COMMENT);continue;case R.COMMENT_ENDED:B!==">"?(j(A,"Malformed comment"),A.comment+="--"+B,A.state=R.COMMENT):A.state=R.TEXT;continue;case R.CDATA:B==="]"?A.state=R.CDATA_ENDING:A.cdata+=B;continue;case R.CDATA_ENDING:B==="]"?A.state=R.CDATA_ENDING_2:(A.cdata+="]"+B,A.state=R.CDATA);continue;case R.CDATA_ENDING_2:B===">"?(A.cdata&&C(A,"oncdata",A.cdata),C(A,"onclosecdata"),A.cdata="",A.state=R.TEXT):B==="]"?A.cdata+="]":(A.cdata+="]]"+B,A.state=R.CDATA);continue;case R.PROC_INST:B==="?"?A.state=R.PROC_INST_ENDING:w(B)?A.state=R.PROC_INST_BODY:A.procInstName+=B;continue;case R.PROC_INST_BODY:if(!A.procInstBody&&w(B))continue;B==="?"?A.state=R.PROC_INST_ENDING:A.procInstBody+=B;continue;case R.PROC_INST_ENDING:B===">"?(C(A,"onprocessinginstruction",{name:A.procInstName,body:A.procInstBody}),A.procInstName=A.procInstBody="",A.state=R.TEXT):(A.procInstBody+="?"+B,A.state=R.PROC_INST_BODY);continue;case R.OPEN_TAG:M(m,B)?A.tagName+=B:(ie(A),B===">"?G(A):B==="/"?A.state=R.OPEN_TAG_SLASH:(w(B)||j(A,"Invalid character in tag name"),A.state=R.ATTRIB));continue;case R.OPEN_TAG_SLASH:B===">"?(G(A,!0),D(A)):(j(A,"Forward-slash in opening tag not followed by >"),A.state=R.ATTRIB);continue;case R.ATTRIB:if(w(B))continue;B===">"?G(A):B==="/"?A.state=R.OPEN_TAG_SLASH:M(x,B)?(A.attribName=B,A.attribValue="",A.state=R.ATTRIB_NAME):j(A,"Invalid attribute name");continue;case R.ATTRIB_NAME:B==="="?A.state=R.ATTRIB_VALUE:B===">"?(j(A,"Attribute without value"),A.attribValue=A.attribName,le(A),G(A)):w(B)?A.state=R.ATTRIB_NAME_SAW_WHITE:M(m,B)?A.attribName+=B:j(A,"Invalid attribute name");continue;case R.ATTRIB_NAME_SAW_WHITE:if(B==="=")A.state=R.ATTRIB_VALUE;else{if(w(B))continue;j(A,"Attribute without value"),A.tag.attributes[A.attribName]="",A.attribValue="",C(A,"onattribute",{name:A.attribName,value:""}),A.attribName="",B===">"?G(A):M(x,B)?(A.attribName=B,A.state=R.ATTRIB_NAME):(j(A,"Invalid attribute name"),A.state=R.ATTRIB)}continue;case R.ATTRIB_VALUE:if(w(B))continue;T(B)?(A.q=B,A.state=R.ATTRIB_VALUE_QUOTED):(j(A,"Unquoted attribute value"),A.state=R.ATTRIB_VALUE_UNQUOTED,A.attribValue=B);continue;case R.ATTRIB_VALUE_QUOTED:if(B!==A.q){B==="&"?A.state=R.ATTRIB_VALUE_ENTITY_Q:A.attribValue+=B;continue}le(A),A.q="",A.state=R.ATTRIB_VALUE_CLOSED;continue;case R.ATTRIB_VALUE_CLOSED:w(B)?A.state=R.ATTRIB:B===">"?G(A):B==="/"?A.state=R.OPEN_TAG_SLASH:M(x,B)?(j(A,"No whitespace between attributes"),A.attribName=B,A.attribValue="",A.state=R.ATTRIB_NAME):j(A,"Invalid attribute name");continue;case R.ATTRIB_VALUE_UNQUOTED:if(!P(B)){B==="&"?A.state=R.ATTRIB_VALUE_ENTITY_U:A.attribValue+=B;continue}le(A),B===">"?G(A):A.state=R.ATTRIB;continue;case R.CLOSE_TAG:if(A.tagName)B===">"?D(A):M(m,B)?A.tagName+=B:A.script?(A.script+="</"+A.tagName,A.tagName="",A.state=R.SCRIPT):(w(B)||j(A,"Invalid tagname in closing tag"),A.state=R.CLOSE_TAG_SAW_WHITE);else{if(w(B))continue;U(x,B)?A.script?(A.script+="</"+B,A.state=R.SCRIPT):j(A,"Invalid tagname in closing tag."):A.tagName=B}continue;case R.CLOSE_TAG_SAW_WHITE:if(w(B))continue;B===">"?D(A):j(A,"Invalid characters in closing tag");continue;case R.TEXT_ENTITY:case R.ATTRIB_VALUE_ENTITY_Q:case R.ATTRIB_VALUE_ENTITY_U:var Z,E;switch(A.state){case R.TEXT_ENTITY:Z=R.TEXT,E="textNode";break;case R.ATTRIB_VALUE_ENTITY_Q:Z=R.ATTRIB_VALUE_QUOTED,E="attribValue";break;case R.ATTRIB_VALUE_ENTITY_U:Z=R.ATTRIB_VALUE_UNQUOTED,E="attribValue";break}B===";"?(A[E]+=$(A),A.entity="",A.state=Z):M(A.entity.length?b:_,B)?A.entity+=B:(j(A,"Invalid character in entity name"),A[E]+="&"+A.entity+B,A.entity="",A.state=Z);continue;default:throw new Error(A,"Unknown state: "+A.state)}return A.position>=A.bufferCheckPosition&&i(A),A}String.fromCodePoint||(function(){var O=String.fromCharCode,A=Math.floor,W=function(){var B=16384,I=[],L,Z,E=-1,Y=arguments.length;if(!Y)return"";for(var N="";++E<Y;){var p=Number(arguments[E]);if(!isFinite(p)||p<0||p>1114111||A(p)!==p)throw RangeError("Invalid code point: "+p);p<=65535?I.push(p):(p-=65536,L=(p>>10)+55296,Z=p%1024+56320,I.push(L,Z)),(E+1===Y||I.length>B)&&(N+=O.apply(null,I),I.length=0)}return N};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:W,configurable:!0,writable:!0}):String.fromCodePoint=W})()})(r)})(Lg)),Lg}function d1(){return f2||(f2=1,Zv={isArray:function(r){return Array.isArray?Array.isArray(r):Object.prototype.toString.call(r)==="[object Array]"}}),Zv}function p1(){if(h2)return Qv;h2=1;var r=d1().isArray;return Qv={copyOptions:function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n},ensureFlagExists:function(e,t){(!(e in t)||typeof t[e]!="boolean")&&(t[e]=!1)},ensureSpacesExists:function(e){(!("spaces"in e)||typeof e.spaces!="number"&&typeof e.spaces!="string")&&(e.spaces=0)},ensureAlwaysArrayExists:function(e){(!("alwaysArray"in e)||typeof e.alwaysArray!="boolean"&&!r(e.alwaysArray))&&(e.alwaysArray=!1)},ensureKeyExists:function(e,t){(!(e+"Key"in t)||typeof t[e+"Key"]!="string")&&(t[e+"Key"]=t.compact?"_"+e:e)},checkFnExists:function(e,t){return e+"Fn"in t}},Qv}function a5(){if(d2)return ey;d2=1;var r=p$(),e=p1(),t=d1().isArray,n,i;function s(m){return n=e.copyOptions(m),e.ensureFlagExists("ignoreDeclaration",n),e.ensureFlagExists("ignoreInstruction",n),e.ensureFlagExists("ignoreAttributes",n),e.ensureFlagExists("ignoreText",n),e.ensureFlagExists("ignoreComment",n),e.ensureFlagExists("ignoreCdata",n),e.ensureFlagExists("ignoreDoctype",n),e.ensureFlagExists("compact",n),e.ensureFlagExists("alwaysChildren",n),e.ensureFlagExists("addParent",n),e.ensureFlagExists("trim",n),e.ensureFlagExists("nativeType",n),e.ensureFlagExists("nativeTypeAttributes",n),e.ensureFlagExists("sanitize",n),e.ensureFlagExists("instructionHasAttributes",n),e.ensureFlagExists("captureSpacesBetweenElements",n),e.ensureAlwaysArrayExists(n),e.ensureKeyExists("declaration",n),e.ensureKeyExists("instruction",n),e.ensureKeyExists("attributes",n),e.ensureKeyExists("text",n),e.ensureKeyExists("comment",n),e.ensureKeyExists("cdata",n),e.ensureKeyExists("doctype",n),e.ensureKeyExists("type",n),e.ensureKeyExists("name",n),e.ensureKeyExists("elements",n),e.ensureKeyExists("parent",n),e.checkFnExists("doctype",n),e.checkFnExists("instruction",n),e.checkFnExists("cdata",n),e.checkFnExists("comment",n),e.checkFnExists("text",n),e.checkFnExists("instructionName",n),e.checkFnExists("elementName",n),e.checkFnExists("attributeName",n),e.checkFnExists("attributeValue",n),e.checkFnExists("attributes",n),n}function a(m){var _=Number(m);if(!isNaN(_))return _;var b=m.toLowerCase();return b==="true"?!0:b==="false"?!1:m}function o(m,_){var b;if(n.compact){if(!i[n[m+"Key"]]&&(t(n.alwaysArray)?n.alwaysArray.indexOf(n[m+"Key"])!==-1:n.alwaysArray)&&(i[n[m+"Key"]]=[]),i[n[m+"Key"]]&&!t(i[n[m+"Key"]])&&(i[n[m+"Key"]]=[i[n[m+"Key"]]]),m+"Fn"in n&&typeof _=="string"&&(_=n[m+"Fn"](_,i)),m==="instruction"&&("instructionFn"in n||"instructionNameFn"in n)){for(b in _)if(_.hasOwnProperty(b))if("instructionFn"in n)_[b]=n.instructionFn(_[b],b,i);else{var w=_[b];delete _[b],_[n.instructionNameFn(b,w,i)]=w}}t(i[n[m+"Key"]])?i[n[m+"Key"]].push(_):i[n[m+"Key"]]=_}else{i[n.elementsKey]||(i[n.elementsKey]=[]);var T={};if(T[n.typeKey]=m,m==="instruction"){for(b in _)if(_.hasOwnProperty(b))break;T[n.nameKey]="instructionNameFn"in n?n.instructionNameFn(b,_,i):b,n.instructionHasAttributes?(T[n.attributesKey]=_[b][n.attributesKey],"instructionFn"in n&&(T[n.attributesKey]=n.instructionFn(T[n.attributesKey],b,i))):("instructionFn"in n&&(_[b]=n.instructionFn(_[b],b,i)),T[n.instructionKey]=_[b])}else m+"Fn"in n&&(_=n[m+"Fn"](_,i)),T[n[m+"Key"]]=_;n.addParent&&(T[n.parentKey]=i),i[n.elementsKey].push(T)}}function l(m){if("attributesFn"in n&&m&&(m=n.attributesFn(m,i)),(n.trim||"attributeValueFn"in n||"attributeNameFn"in n||n.nativeTypeAttributes)&&m){var _;for(_ in m)if(m.hasOwnProperty(_)&&(n.trim&&(m[_]=m[_].trim()),n.nativeTypeAttributes&&(m[_]=a(m[_])),"attributeValueFn"in n&&(m[_]=n.attributeValueFn(m[_],_,i)),"attributeNameFn"in n)){var b=m[_];delete m[_],m[n.attributeNameFn(_,m[_],i)]=b}}return m}function u(m){var _={};if(m.body&&(m.name.toLowerCase()==="xml"||n.instructionHasAttributes)){for(var b=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,w;(w=b.exec(m.body))!==null;)_[w[1]]=w[2]||w[3]||w[4];_=l(_)}if(m.name.toLowerCase()==="xml"){if(n.ignoreDeclaration)return;i[n.declarationKey]={},Object.keys(_).length&&(i[n.declarationKey][n.attributesKey]=_),n.addParent&&(i[n.declarationKey][n.parentKey]=i)}else{if(n.ignoreInstruction)return;n.trim&&(m.body=m.body.trim());var T={};n.instructionHasAttributes&&Object.keys(_).length?(T[m.name]={},T[m.name][n.attributesKey]=_):T[m.name]=m.body,o("instruction",T)}}function c(m,_){var b;if(typeof m=="object"&&(_=m.attributes,m=m.name),_=l(_),"elementNameFn"in n&&(m=n.elementNameFn(m,i)),n.compact){if(b={},!n.ignoreAttributes&&_&&Object.keys(_).length){b[n.attributesKey]={};var w;for(w in _)_.hasOwnProperty(w)&&(b[n.attributesKey][w]=_[w])}!(m in i)&&(t(n.alwaysArray)?n.alwaysArray.indexOf(m)!==-1:n.alwaysArray)&&(i[m]=[]),i[m]&&!t(i[m])&&(i[m]=[i[m]]),t(i[m])?i[m].push(b):i[m]=b}else i[n.elementsKey]||(i[n.elementsKey]=[]),b={},b[n.typeKey]="element",b[n.nameKey]=m,!n.ignoreAttributes&&_&&Object.keys(_).length&&(b[n.attributesKey]=_),n.alwaysChildren&&(b[n.elementsKey]=[]),i[n.elementsKey].push(b);b[n.parentKey]=i,i=b}function f(m){n.ignoreText||!m.trim()&&!n.captureSpacesBetweenElements||(n.trim&&(m=m.trim()),n.nativeType&&(m=a(m)),n.sanitize&&(m=m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),o("text",m))}function d(m){n.ignoreComment||(n.trim&&(m=m.trim()),o("comment",m))}function h(m){var _=i[n.parentKey];n.addParent||delete i[n.parentKey],i=_}function y(m){n.ignoreCdata||(n.trim&&(m=m.trim()),o("cdata",m))}function v(m){n.ignoreDoctype||(m=m.replace(/^ /,""),n.trim&&(m=m.trim()),o("doctype",m))}function x(m){m.note=m}return ey=function(m,_){var b=r.parser(!0,{}),w={};if(i=w,n=s(_),b.opt={strictEntities:!0},b.onopentag=c,b.ontext=f,b.oncomment=d,b.onclosetag=h,b.onerror=x,b.oncdata=y,b.ondoctype=v,b.onprocessinginstruction=u,b.write(m).close(),w[n.elementsKey]){var T=w[n.elementsKey];delete w[n.elementsKey],w[n.elementsKey]=T,delete w.text}return w},ey}function m$(){if(p2)return ty;p2=1;var r=p1(),e=a5();function t(n){var i=r.copyOptions(n);return r.ensureSpacesExists(i),i}return ty=function(n,i){var s,a,o,l;return s=t(i),a=e(n,s),l="compact"in s&&s.compact?"_parent":"parent","addParent"in s&&s.addParent?o=JSON.stringify(a,function(u,c){return u===l?"_":c},s.spaces):o=JSON.stringify(a,null,s.spaces),o.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},ty}function l5(){if(m2)return ry;m2=1;var r=p1(),e=d1().isArray,t,n;function i(b){var w=r.copyOptions(b);return r.ensureFlagExists("ignoreDeclaration",w),r.ensureFlagExists("ignoreInstruction",w),r.ensureFlagExists("ignoreAttributes",w),r.ensureFlagExists("ignoreText",w),r.ensureFlagExists("ignoreComment",w),r.ensureFlagExists("ignoreCdata",w),r.ensureFlagExists("ignoreDoctype",w),r.ensureFlagExists("compact",w),r.ensureFlagExists("indentText",w),r.ensureFlagExists("indentCdata",w),r.ensureFlagExists("indentAttributes",w),r.ensureFlagExists("indentInstruction",w),r.ensureFlagExists("fullTagEmptyElement",w),r.ensureFlagExists("noQuotesForNativeAttributes",w),r.ensureSpacesExists(w),typeof w.spaces=="number"&&(w.spaces=Array(w.spaces+1).join(" ")),r.ensureKeyExists("declaration",w),r.ensureKeyExists("instruction",w),r.ensureKeyExists("attributes",w),r.ensureKeyExists("text",w),r.ensureKeyExists("comment",w),r.ensureKeyExists("cdata",w),r.ensureKeyExists("doctype",w),r.ensureKeyExists("type",w),r.ensureKeyExists("name",w),r.ensureKeyExists("elements",w),r.checkFnExists("doctype",w),r.checkFnExists("instruction",w),r.checkFnExists("cdata",w),r.checkFnExists("comment",w),r.checkFnExists("text",w),r.checkFnExists("instructionName",w),r.checkFnExists("elementName",w),r.checkFnExists("attributeName",w),r.checkFnExists("attributeValue",w),r.checkFnExists("attributes",w),r.checkFnExists("fullTagEmptyElement",w),w}function s(b,w,T){return(!T&&b.spaces?`
`:"")+Array(w+1).join(b.spaces)}function a(b,w,T){if(w.ignoreAttributes)return"";"attributesFn"in w&&(b=w.attributesFn(b,n,t));var P,M,U,R,J=[];for(P in b)b.hasOwnProperty(P)&&b[P]!==null&&b[P]!==void 0&&(R=w.noQuotesForNativeAttributes&&typeof b[P]!="string"?"":'"',M=""+b[P],M=M.replace(/"/g,"&quot;"),U="attributeNameFn"in w?w.attributeNameFn(P,M,n,t):P,J.push(w.spaces&&w.indentAttributes?s(w,T+1,!1):" "),J.push(U+"="+R+("attributeValueFn"in w?w.attributeValueFn(M,P,n,t):M)+R));return b&&Object.keys(b).length&&w.spaces&&w.indentAttributes&&J.push(s(w,T,!1)),J.join("")}function o(b,w,T){return t=b,n="xml",w.ignoreDeclaration?"":"<?xml"+a(b[w.attributesKey],w,T)+"?>"}function l(b,w,T){if(w.ignoreInstruction)return"";var P;for(P in b)if(b.hasOwnProperty(P))break;var M="instructionNameFn"in w?w.instructionNameFn(P,b[P],n,t):P;if(typeof b[P]=="object")return t=b,n=M,"<?"+M+a(b[P][w.attributesKey],w,T)+"?>";var U=b[P]?b[P]:"";return"instructionFn"in w&&(U=w.instructionFn(U,P,n,t)),"<?"+M+(U?" "+U:"")+"?>"}function u(b,w){return w.ignoreComment?"":"<!--"+("commentFn"in w?w.commentFn(b,n,t):b)+"-->"}function c(b,w){return w.ignoreCdata?"":"<![CDATA["+("cdataFn"in w?w.cdataFn(b,n,t):b.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function f(b,w){return w.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in w?w.doctypeFn(b,n,t):b)+">"}function d(b,w){return w.ignoreText?"":(b=""+b,b=b.replace(/&amp;/g,"&"),b=b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in w?w.textFn(b,n,t):b)}function h(b,w){var T;if(b.elements&&b.elements.length)for(T=0;T<b.elements.length;++T)switch(b.elements[T][w.typeKey]){case"text":if(w.indentText)return!0;break;case"cdata":if(w.indentCdata)return!0;break;case"instruction":if(w.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function y(b,w,T){t=b,n=b.name;var P=[],M="elementNameFn"in w?w.elementNameFn(b.name,b):b.name;P.push("<"+M),b[w.attributesKey]&&P.push(a(b[w.attributesKey],w,T));var U=b[w.elementsKey]&&b[w.elementsKey].length||b[w.attributesKey]&&b[w.attributesKey]["xml:space"]==="preserve";return U||("fullTagEmptyElementFn"in w?U=w.fullTagEmptyElementFn(b.name,b):U=w.fullTagEmptyElement),U?(P.push(">"),b[w.elementsKey]&&b[w.elementsKey].length&&(P.push(v(b[w.elementsKey],w,T+1)),t=b,n=b.name),P.push(w.spaces&&h(b,w)?`
`+Array(T+1).join(w.spaces):""),P.push("</"+M+">")):P.push("/>"),P.join("")}function v(b,w,T,P){return b.reduce(function(M,U){var R=s(w,T,P&&!M);switch(U.type){case"element":return M+R+y(U,w,T);case"comment":return M+R+u(U[w.commentKey],w);case"doctype":return M+R+f(U[w.doctypeKey],w);case"cdata":return M+(w.indentCdata?R:"")+c(U[w.cdataKey],w);case"text":return M+(w.indentText?R:"")+d(U[w.textKey],w);case"instruction":var J={};return J[U[w.nameKey]]=U[w.attributesKey]?U:U[w.instructionKey],M+(w.indentInstruction?R:"")+l(J,w,T)}},"")}function x(b,w,T){var P;for(P in b)if(b.hasOwnProperty(P))switch(P){case w.parentKey:case w.attributesKey:break;case w.textKey:if(w.indentText||T)return!0;break;case w.cdataKey:if(w.indentCdata||T)return!0;break;case w.instructionKey:if(w.indentInstruction||T)return!0;break;case w.doctypeKey:case w.commentKey:return!0;default:return!0}return!1}function m(b,w,T,P,M){t=b,n=w;var U="elementNameFn"in T?T.elementNameFn(w,b):w;if(typeof b>"u"||b===null||b==="")return"fullTagEmptyElementFn"in T&&T.fullTagEmptyElementFn(w,b)||T.fullTagEmptyElement?"<"+U+"></"+U+">":"<"+U+"/>";var R=[];if(w){if(R.push("<"+U),typeof b!="object")return R.push(">"+d(b,T)+"</"+U+">"),R.join("");b[T.attributesKey]&&R.push(a(b[T.attributesKey],T,P));var J=x(b,T,!0)||b[T.attributesKey]&&b[T.attributesKey]["xml:space"]==="preserve";if(J||("fullTagEmptyElementFn"in T?J=T.fullTagEmptyElementFn(w,b):J=T.fullTagEmptyElement),J)R.push(">");else return R.push("/>"),R.join("")}return R.push(_(b,T,P+1,!1)),t=b,n=w,w&&R.push((M?s(T,P,!1):"")+"</"+U+">"),R.join("")}function _(b,w,T,P){var M,U,R,J=[];for(U in b)if(b.hasOwnProperty(U))for(R=e(b[U])?b[U]:[b[U]],M=0;M<R.length;++M){switch(U){case w.declarationKey:J.push(o(R[M],w,T));break;case w.instructionKey:J.push((w.indentInstruction?s(w,T,P):"")+l(R[M],w,T));break;case w.attributesKey:case w.parentKey:break;case w.textKey:J.push((w.indentText?s(w,T,P):"")+d(R[M],w));break;case w.cdataKey:J.push((w.indentCdata?s(w,T,P):"")+c(R[M],w));break;case w.doctypeKey:J.push(s(w,T,P)+f(R[M],w));break;case w.commentKey:J.push(s(w,T,P)+u(R[M],w));break;default:J.push(s(w,T,P)+m(R[M],U,w,T,x(R[M],w)))}P=P&&!J.length}return J.join("")}return ry=function(b,w){w=i(w);var T=[];return t=b,n="_root_",w.compact?T.push(_(b,w,0,!0)):(b[w.declarationKey]&&T.push(o(b[w.declarationKey],w,0)),b[w.elementsKey]&&b[w.elementsKey].length&&T.push(v(b[w.elementsKey],w,0,!T.length))),T.join("")},ry}function g$(){if(g2)return ny;g2=1;var r=l5();return ny=function(e,t){e instanceof Buffer&&(e=e.toString());var n=null;if(typeof e=="string")try{n=JSON.parse(e)}catch{throw new Error("The JSON structure is invalid")}else n=e;return r(n,t)},ny}function v$(){if(v2)return iy;v2=1;var r=a5(),e=m$(),t=l5(),n=g$();return iy={xml2js:r,xml2json:e,js2xml:t,json2xml:n},iy}function qa(){if(w2)return oy;w2=1,oy=r;function r(e,t){if(!e)throw new Error(t||"Assertion failed")}return r.equal=function(t,n,i){if(t!=n)throw new Error(i||"Assertion failed: "+t+" != "+n)},oy}function Kr(){if(b2)return je;b2=1;var r=qa(),e=ei();je.inherits=e;function t(C,H){return(C.charCodeAt(H)&64512)!==55296||H<0||H+1>=C.length?!1:(C.charCodeAt(H+1)&64512)===56320}function n(C,H){if(Array.isArray(C))return C.slice();if(!C)return[];var k=[];if(typeof C=="string")if(H){if(H==="hex")for(C=C.replace(/[^a-z0-9]+/ig,""),C.length%2!==0&&(C="0"+C),Q=0;Q<C.length;Q+=2)k.push(parseInt(C[Q]+C[Q+1],16))}else for(var V=0,Q=0;Q<C.length;Q++){var j=C.charCodeAt(Q);j<128?k[V++]=j:j<2048?(k[V++]=j>>6|192,k[V++]=j&63|128):t(C,Q)?(j=65536+((j&1023)<<10)+(C.charCodeAt(++Q)&1023),k[V++]=j>>18|240,k[V++]=j>>12&63|128,k[V++]=j>>6&63|128,k[V++]=j&63|128):(k[V++]=j>>12|224,k[V++]=j>>6&63|128,k[V++]=j&63|128)}else for(Q=0;Q<C.length;Q++)k[Q]=C[Q]|0;return k}je.toArray=n;function i(C){for(var H="",k=0;k<C.length;k++)H+=o(C[k].toString(16));return H}je.toHex=i;function s(C){var H=C>>>24|C>>>8&65280|C<<8&16711680|(C&255)<<24;return H>>>0}je.htonl=s;function a(C,H){for(var k="",V=0;V<C.length;V++){var Q=C[V];H==="little"&&(Q=s(Q)),k+=l(Q.toString(16))}return k}je.toHex32=a;function o(C){return C.length===1?"0"+C:C}je.zero2=o;function l(C){return C.length===7?"0"+C:C.length===6?"00"+C:C.length===5?"000"+C:C.length===4?"0000"+C:C.length===3?"00000"+C:C.length===2?"000000"+C:C.length===1?"0000000"+C:C}je.zero8=l;function u(C,H,k,V){var Q=k-H;r(Q%4===0);for(var j=new Array(Q/4),ie=0,ee=H;ie<j.length;ie++,ee+=4){var le;V==="big"?le=C[ee]<<24|C[ee+1]<<16|C[ee+2]<<8|C[ee+3]:le=C[ee+3]<<24|C[ee+2]<<16|C[ee+1]<<8|C[ee],j[ie]=le>>>0}return j}je.join32=u;function c(C,H){for(var k=new Array(C.length*4),V=0,Q=0;V<C.length;V++,Q+=4){var j=C[V];H==="big"?(k[Q]=j>>>24,k[Q+1]=j>>>16&255,k[Q+2]=j>>>8&255,k[Q+3]=j&255):(k[Q+3]=j>>>24,k[Q+2]=j>>>16&255,k[Q+1]=j>>>8&255,k[Q]=j&255)}return k}je.split32=c;function f(C,H){return C>>>H|C<<32-H}je.rotr32=f;function d(C,H){return C<<H|C>>>32-H}je.rotl32=d;function h(C,H){return C+H>>>0}je.sum32=h;function y(C,H,k){return C+H+k>>>0}je.sum32_3=y;function v(C,H,k,V){return C+H+k+V>>>0}je.sum32_4=v;function x(C,H,k,V,Q){return C+H+k+V+Q>>>0}je.sum32_5=x;function m(C,H,k,V){var Q=C[H],j=C[H+1],ie=V+j>>>0,ee=(ie<V?1:0)+k+Q;C[H]=ee>>>0,C[H+1]=ie}je.sum64=m;function _(C,H,k,V){var Q=H+V>>>0,j=(Q<H?1:0)+C+k;return j>>>0}je.sum64_hi=_;function b(C,H,k,V){var Q=H+V;return Q>>>0}je.sum64_lo=b;function w(C,H,k,V,Q,j,ie,ee){var le=0,G=H;G=G+V>>>0,le+=G<H?1:0,G=G+j>>>0,le+=G<j?1:0,G=G+ee>>>0,le+=G<ee?1:0;var D=C+k+Q+ie+le;return D>>>0}je.sum64_4_hi=w;function T(C,H,k,V,Q,j,ie,ee){var le=H+V+j+ee;return le>>>0}je.sum64_4_lo=T;function P(C,H,k,V,Q,j,ie,ee,le,G){var D=0,$=H;$=$+V>>>0,D+=$<H?1:0,$=$+j>>>0,D+=$<j?1:0,$=$+ee>>>0,D+=$<ee?1:0,$=$+G>>>0,D+=$<G?1:0;var X=C+k+Q+ie+le+D;return X>>>0}je.sum64_5_hi=P;function M(C,H,k,V,Q,j,ie,ee,le,G){var D=H+V+j+ee+G;return D>>>0}je.sum64_5_lo=M;function U(C,H,k){var V=H<<32-k|C>>>k;return V>>>0}je.rotr64_hi=U;function R(C,H,k){var V=C<<32-k|H>>>k;return V>>>0}je.rotr64_lo=R;function J(C,H,k){return C>>>k}je.shr64_hi=J;function oe(C,H,k){var V=C<<32-k|H>>>k;return V>>>0}return je.shr64_lo=oe,je}function Va(){if(_2)return ay;_2=1;var r=Kr(),e=qa();function t(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}return ay.BlockHash=t,t.prototype.update=function(i,s){if(i=r.toArray(i,s),this.pending?this.pending=this.pending.concat(i):this.pending=i,this.pendingTotal+=i.length,this.pending.length>=this._delta8){i=this.pending;var a=i.length%this._delta8;this.pending=i.slice(i.length-a,i.length),this.pending.length===0&&(this.pending=null),i=r.join32(i,0,i.length-a,this.endian);for(var o=0;o<i.length;o+=this._delta32)this._update(i,o,o+this._delta32)}return this},t.prototype.digest=function(i){return this.update(this._pad()),e(this.pending===null),this._digest(i)},t.prototype._pad=function(){var i=this.pendingTotal,s=this._delta8,a=s-(i+this.padLength)%s,o=new Array(a+this.padLength);o[0]=128;for(var l=1;l<a;l++)o[l]=0;if(i<<=3,this.endian==="big"){for(var u=8;u<this.padLength;u++)o[l++]=0;o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=i>>>24&255,o[l++]=i>>>16&255,o[l++]=i>>>8&255,o[l++]=i&255}else for(o[l++]=i&255,o[l++]=i>>>8&255,o[l++]=i>>>16&255,o[l++]=i>>>24&255,o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=0,u=8;u<this.padLength;u++)o[l++]=0;return o},ay}function g5(){if(x2)return zr;x2=1;var r=Kr(),e=r.rotr32;function t(c,f,d,h){if(c===0)return n(f,d,h);if(c===1||c===3)return s(f,d,h);if(c===2)return i(f,d,h)}zr.ft_1=t;function n(c,f,d){return c&f^~c&d}zr.ch32=n;function i(c,f,d){return c&f^c&d^f&d}zr.maj32=i;function s(c,f,d){return c^f^d}zr.p32=s;function a(c){return e(c,2)^e(c,13)^e(c,22)}zr.s0_256=a;function o(c){return e(c,6)^e(c,11)^e(c,25)}zr.s1_256=o;function l(c){return e(c,7)^e(c,18)^c>>>3}zr.g0_256=l;function u(c){return e(c,17)^e(c,19)^c>>>10}return zr.g1_256=u,zr}function T$(){if(E2)return ly;E2=1;var r=Kr(),e=Va(),t=g5(),n=r.rotl32,i=r.sum32,s=r.sum32_5,a=t.ft_1,o=e.BlockHash,l=[1518500249,1859775393,2400959708,3395469782];function u(){if(!(this instanceof u))return new u;o.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}return r.inherits(u,o),ly=u,u.blockSize=512,u.outSize=160,u.hmacStrength=80,u.padLength=64,u.prototype._update=function(f,d){for(var h=this.W,y=0;y<16;y++)h[y]=f[d+y];for(;y<h.length;y++)h[y]=n(h[y-3]^h[y-8]^h[y-14]^h[y-16],1);var v=this.h[0],x=this.h[1],m=this.h[2],_=this.h[3],b=this.h[4];for(y=0;y<h.length;y++){var w=~~(y/20),T=s(n(v,5),a(w,x,m,_),b,h[y],l[w]);b=_,_=m,m=n(x,30),x=v,v=T}this.h[0]=i(this.h[0],v),this.h[1]=i(this.h[1],x),this.h[2]=i(this.h[2],m),this.h[3]=i(this.h[3],_),this.h[4]=i(this.h[4],b)},u.prototype._digest=function(f){return f==="hex"?r.toHex32(this.h,"big"):r.split32(this.h,"big")},ly}function v5(){if(S2)return uy;S2=1;var r=Kr(),e=Va(),t=g5(),n=qa(),i=r.sum32,s=r.sum32_4,a=r.sum32_5,o=t.ch32,l=t.maj32,u=t.s0_256,c=t.s1_256,f=t.g0_256,d=t.g1_256,h=e.BlockHash,y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function v(){if(!(this instanceof v))return new v;h.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=y,this.W=new Array(64)}return r.inherits(v,h),uy=v,v.blockSize=512,v.outSize=256,v.hmacStrength=192,v.padLength=64,v.prototype._update=function(m,_){for(var b=this.W,w=0;w<16;w++)b[w]=m[_+w];for(;w<b.length;w++)b[w]=s(d(b[w-2]),b[w-7],f(b[w-15]),b[w-16]);var T=this.h[0],P=this.h[1],M=this.h[2],U=this.h[3],R=this.h[4],J=this.h[5],oe=this.h[6],C=this.h[7];for(n(this.k.length===b.length),w=0;w<b.length;w++){var H=a(C,c(R),o(R,J,oe),this.k[w],b[w]),k=i(u(T),l(T,P,M));C=oe,oe=J,J=R,R=i(U,H),U=M,M=P,P=T,T=i(H,k)}this.h[0]=i(this.h[0],T),this.h[1]=i(this.h[1],P),this.h[2]=i(this.h[2],M),this.h[3]=i(this.h[3],U),this.h[4]=i(this.h[4],R),this.h[5]=i(this.h[5],J),this.h[6]=i(this.h[6],oe),this.h[7]=i(this.h[7],C)},v.prototype._digest=function(m){return m==="hex"?r.toHex32(this.h,"big"):r.split32(this.h,"big")},uy}function A$(){if(k2)return cy;k2=1;var r=Kr(),e=v5();function t(){if(!(this instanceof t))return new t;e.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}return r.inherits(t,e),cy=t,t.blockSize=512,t.outSize=224,t.hmacStrength=192,t.padLength=64,t.prototype._digest=function(i){return i==="hex"?r.toHex32(this.h.slice(0,7),"big"):r.split32(this.h.slice(0,7),"big")},cy}function y5(){if(T2)return fy;T2=1;var r=Kr(),e=Va(),t=qa(),n=r.rotr64_hi,i=r.rotr64_lo,s=r.shr64_hi,a=r.shr64_lo,o=r.sum64,l=r.sum64_hi,u=r.sum64_lo,c=r.sum64_4_hi,f=r.sum64_4_lo,d=r.sum64_5_hi,h=r.sum64_5_lo,y=e.BlockHash,v=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function x(){if(!(this instanceof x))return new x;y.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=v,this.W=new Array(160)}r.inherits(x,y),fy=x,x.blockSize=1024,x.outSize=512,x.hmacStrength=192,x.padLength=128,x.prototype._prepareBlock=function(k,V){for(var Q=this.W,j=0;j<32;j++)Q[j]=k[V+j];for(;j<Q.length;j+=2){var ie=oe(Q[j-4],Q[j-3]),ee=C(Q[j-4],Q[j-3]),le=Q[j-14],G=Q[j-13],D=R(Q[j-30],Q[j-29]),$=J(Q[j-30],Q[j-29]),X=Q[j-32],re=Q[j-31];Q[j]=c(ie,ee,le,G,D,$,X,re),Q[j+1]=f(ie,ee,le,G,D,$,X,re)}},x.prototype._update=function(k,V){this._prepareBlock(k,V);var Q=this.W,j=this.h[0],ie=this.h[1],ee=this.h[2],le=this.h[3],G=this.h[4],D=this.h[5],$=this.h[6],X=this.h[7],re=this.h[8],K=this.h[9],O=this.h[10],A=this.h[11],W=this.h[12],B=this.h[13],I=this.h[14],L=this.h[15];t(this.k.length===Q.length);for(var Z=0;Z<Q.length;Z+=2){var E=I,Y=L,N=M(re,K),p=U(re,K),g=m(re,K,O,A,W),S=_(re,K,O,A,W,B),F=this.k[Z],q=this.k[Z+1],z=Q[Z],ne=Q[Z+1],ae=d(E,Y,N,p,g,S,F,q,z,ne),se=h(E,Y,N,p,g,S,F,q,z,ne);E=T(j,ie),Y=P(j,ie),N=b(j,ie,ee,le,G),p=w(j,ie,ee,le,G,D);var fe=l(E,Y,N,p),pe=u(E,Y,N,p);I=W,L=B,W=O,B=A,O=re,A=K,re=l($,X,ae,se),K=u(X,X,ae,se),$=G,X=D,G=ee,D=le,ee=j,le=ie,j=l(ae,se,fe,pe),ie=u(ae,se,fe,pe)}o(this.h,0,j,ie),o(this.h,2,ee,le),o(this.h,4,G,D),o(this.h,6,$,X),o(this.h,8,re,K),o(this.h,10,O,A),o(this.h,12,W,B),o(this.h,14,I,L)},x.prototype._digest=function(k){return k==="hex"?r.toHex32(this.h,"big"):r.split32(this.h,"big")};function m(H,k,V,Q,j){var ie=H&V^~H&j;return ie<0&&(ie+=4294967296),ie}function _(H,k,V,Q,j,ie){var ee=k&Q^~k&ie;return ee<0&&(ee+=4294967296),ee}function b(H,k,V,Q,j){var ie=H&V^H&j^V&j;return ie<0&&(ie+=4294967296),ie}function w(H,k,V,Q,j,ie){var ee=k&Q^k&ie^Q&ie;return ee<0&&(ee+=4294967296),ee}function T(H,k){var V=n(H,k,28),Q=n(k,H,2),j=n(k,H,7),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}function P(H,k){var V=i(H,k,28),Q=i(k,H,2),j=i(k,H,7),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}function M(H,k){var V=n(H,k,14),Q=n(H,k,18),j=n(k,H,9),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}function U(H,k){var V=i(H,k,14),Q=i(H,k,18),j=i(k,H,9),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}function R(H,k){var V=n(H,k,1),Q=n(H,k,8),j=s(H,k,7),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}function J(H,k){var V=i(H,k,1),Q=i(H,k,8),j=a(H,k,7),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}function oe(H,k){var V=n(H,k,19),Q=n(k,H,29),j=s(H,k,6),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}function C(H,k){var V=i(H,k,19),Q=i(k,H,29),j=a(H,k,6),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}return fy}function O$(){if(A2)return hy;A2=1;var r=Kr(),e=y5();function t(){if(!(this instanceof t))return new t;e.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}return r.inherits(t,e),hy=t,t.blockSize=1024,t.outSize=384,t.hmacStrength=192,t.padLength=128,t.prototype._digest=function(i){return i==="hex"?r.toHex32(this.h.slice(0,12),"big"):r.split32(this.h.slice(0,12),"big")},hy}function N$(){return O2||(O2=1,Oi.sha1=T$(),Oi.sha224=A$(),Oi.sha256=v5(),Oi.sha384=O$(),Oi.sha512=y5()),Oi}function R$(){if(N2)return dy;N2=1;var r=Kr(),e=Va(),t=r.rotl32,n=r.sum32,i=r.sum32_3,s=r.sum32_4,a=e.BlockHash;function o(){if(!(this instanceof o))return new o;a.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}r.inherits(o,a),dy.ripemd160=o,o.blockSize=512,o.outSize=160,o.hmacStrength=192,o.padLength=64,o.prototype._update=function(x,m){for(var _=this.h[0],b=this.h[1],w=this.h[2],T=this.h[3],P=this.h[4],M=_,U=b,R=w,J=T,oe=P,C=0;C<80;C++){var H=n(t(s(_,l(C,b,w,T),x[f[C]+m],u(C)),h[C]),P);_=P,P=T,T=t(w,10),w=b,b=H,H=n(t(s(M,l(79-C,U,R,J),x[d[C]+m],c(C)),y[C]),oe),M=oe,oe=J,J=t(R,10),R=U,U=H}H=i(this.h[1],w,J),this.h[1]=i(this.h[2],T,oe),this.h[2]=i(this.h[3],P,M),this.h[3]=i(this.h[4],_,U),this.h[4]=i(this.h[0],b,R),this.h[0]=H},o.prototype._digest=function(x){return x==="hex"?r.toHex32(this.h,"little"):r.split32(this.h,"little")};function l(v,x,m,_){return v<=15?x^m^_:v<=31?x&m|~x&_:v<=47?(x|~m)^_:v<=63?x&_|m&~_:x^(m|~_)}function u(v){return v<=15?0:v<=31?1518500249:v<=47?1859775393:v<=63?2400959708:2840853838}function c(v){return v<=15?1352829926:v<=31?1548603684:v<=47?1836072691:v<=63?2053994217:0}var f=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],d=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],h=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],y=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];return dy}function C$(){if(R2)return py;R2=1;var r=Kr(),e=qa();function t(n,i,s){if(!(this instanceof t))return new t(n,i,s);this.Hash=n,this.blockSize=n.blockSize/8,this.outSize=n.outSize/8,this.inner=null,this.outer=null,this._init(r.toArray(i,s))}return py=t,t.prototype._init=function(i){i.length>this.blockSize&&(i=new this.Hash().update(i).digest()),e(i.length<=this.blockSize);for(var s=i.length;s<this.blockSize;s++)i.push(0);for(s=0;s<i.length;s++)i[s]^=54;for(this.inner=new this.Hash().update(i),s=0;s<i.length;s++)i[s]^=106;this.outer=new this.Hash().update(i)},t.prototype.update=function(i,s){return this.inner.update(i,s),this},t.prototype.digest=function(i){return this.outer.update(this.inner.digest()),this.outer.digest(i)},py}function I$(){return C2||(C2=1,(function(r){var e=r;e.utils=Kr(),e.common=Va(),e.sha=N$(),e.ripemd=R$(),e.hmac=C$(),e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160})(sy)),sy}function Kc(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}function yJ(){return F2||(F2=1,(function(r,e){(function(t){r.exports=t()})(function(){return(function t(n,i,s){function a(u,c){if(!i[u]){if(!n[u]){var f=typeof Kc=="function"&&Kc;if(!c&&f)return f(u,!0);if(o)return o(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var h=i[u]={exports:{}};n[u][0].call(h.exports,function(y){var v=n[u][1][y];return a(v||y)},h,h.exports,t,n,i,s)}return i[u].exports}for(var o=typeof Kc=="function"&&Kc,l=0;l<s.length;l++)a(s[l]);return a})({1:[function(t,n,i){var s=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var u,c,f,d,h,y,v,x=[],m=0,_=l.length,b=_,w=s.getTypeOf(l)!=="string";m<l.length;)b=_-m,f=w?(u=l[m++],c=m<_?l[m++]:0,m<_?l[m++]:0):(u=l.charCodeAt(m++),c=m<_?l.charCodeAt(m++):0,m<_?l.charCodeAt(m++):0),d=u>>2,h=(3&u)<<4|c>>4,y=1<b?(15&c)<<2|f>>6:64,v=2<b?63&f:64,x.push(o.charAt(d)+o.charAt(h)+o.charAt(y)+o.charAt(v));return x.join("")},i.decode=function(l){var u,c,f,d,h,y,v=0,x=0,m="data:";if(l.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");var _,b=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&b--,l.charAt(l.length-2)===o.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=a.uint8array?new Uint8Array(0|b):new Array(0|b);v<l.length;)u=o.indexOf(l.charAt(v++))<<2|(d=o.indexOf(l.charAt(v++)))>>4,c=(15&d)<<4|(h=o.indexOf(l.charAt(v++)))>>2,f=(3&h)<<6|(y=o.indexOf(l.charAt(v++))),_[x++]=u,h!==64&&(_[x++]=c),y!==64&&(_[x++]=f);return _}},{"./support":30,"./utils":32}],2:[function(t,n,i){var s=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function u(c,f,d,h,y){this.compressedSize=c,this.uncompressedSize=f,this.crc32=d,this.compression=h,this.compressedContent=y}u.prototype={getContentWorker:function(){var c=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return c.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(c,f,d){return c.pipe(new o).pipe(new l("uncompressedSize")).pipe(f.compressWorker(d)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},n.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,n,i){var s=t("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,n,i){var s=t("./utils"),a=(function(){for(var o,l=[],u=0;u<256;u++){o=u;for(var c=0;c<8;c++)o=1&o?3988292384^o>>>1:o>>>1;l[u]=o}return l})();n.exports=function(o,l){return o!==void 0&&o.length?s.getTypeOf(o)!=="string"?(function(u,c,f,d){var h=a,y=d+f;u^=-1;for(var v=d;v<y;v++)u=u>>>8^h[255&(u^c[v])];return-1^u})(0|l,o,o.length,0):(function(u,c,f,d){var h=a,y=d+f;u^=-1;for(var v=d;v<y;v++)u=u>>>8^h[255&(u^c.charCodeAt(v))];return-1^u})(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(t,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(t,n,i){var s=null;s=typeof Promise<"u"?Promise:t("lie"),n.exports={Promise:s}},{lie:37}],7:[function(t,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=t("pako"),o=t("./utils"),l=t("./stream/GenericWorker"),u=s?"uint8array":"array";function c(f,d){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=d,this.meta={}}i.magic="\b\0",o.inherits(c,l),c.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(u,f.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(d){f.push({data:d,meta:f.meta})}},i.compressWorker=function(f){return new c("Deflate",f)},i.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,n,i){function s(h,y){var v,x="";for(v=0;v<y;v++)x+=String.fromCharCode(255&h),h>>>=8;return x}function a(h,y,v,x,m,_){var b,w,T=h.file,P=h.compression,M=_!==u.utf8encode,U=o.transformTo("string",_(T.name)),R=o.transformTo("string",u.utf8encode(T.name)),J=T.comment,oe=o.transformTo("string",_(J)),C=o.transformTo("string",u.utf8encode(J)),H=R.length!==T.name.length,k=C.length!==J.length,V="",Q="",j="",ie=T.dir,ee=T.date,le={crc32:0,compressedSize:0,uncompressedSize:0};y&&!v||(le.crc32=h.crc32,le.compressedSize=h.compressedSize,le.uncompressedSize=h.uncompressedSize);var G=0;y&&(G|=8),M||!H&&!k||(G|=2048);var D=0,$=0;ie&&(D|=16),m==="UNIX"?($=798,D|=(function(re,K){var O=re;return re||(O=K?16893:33204),(65535&O)<<16})(T.unixPermissions,ie)):($=20,D|=(function(re){return 63&(re||0)})(T.dosPermissions)),b=ee.getUTCHours(),b<<=6,b|=ee.getUTCMinutes(),b<<=5,b|=ee.getUTCSeconds()/2,w=ee.getUTCFullYear()-1980,w<<=4,w|=ee.getUTCMonth()+1,w<<=5,w|=ee.getUTCDate(),H&&(Q=s(1,1)+s(c(U),4)+R,V+="up"+s(Q.length,2)+Q),k&&(j=s(1,1)+s(c(oe),4)+C,V+="uc"+s(j.length,2)+j);var X="";return X+=`
\0`,X+=s(G,2),X+=P.magic,X+=s(b,2),X+=s(w,2),X+=s(le.crc32,4),X+=s(le.compressedSize,4),X+=s(le.uncompressedSize,4),X+=s(U.length,2),X+=s(V.length,2),{fileRecord:f.LOCAL_FILE_HEADER+X+U+V,dirRecord:f.CENTRAL_FILE_HEADER+s($,2)+X+s(oe.length,2)+"\0\0\0\0"+s(D,4)+s(x,4)+U+V+oe}}var o=t("../utils"),l=t("../stream/GenericWorker"),u=t("../utf8"),c=t("../crc32"),f=t("../signature");function d(h,y,v,x){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=v,this.encodeFileName=x,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(d,l),d.prototype.push=function(h){var y=h.meta.percent||0,v=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,l.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:v?(y+100*(v-x-1))/v:100}}))},d.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var y=this.streamFiles&&!h.file.dir;if(y){var v=a(h,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(h){this.accumulate=!1;var y=this.streamFiles&&!h.file.dir,v=a(h,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),y)this.push({data:(function(x){return f.DATA_DESCRIPTOR+s(x.crc32,4)+s(x.compressedSize,4)+s(x.uncompressedSize,4)})(h),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var h=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var v=this.bytesWritten-h,x=(function(m,_,b,w,T){var P=o.transformTo("string",T(w));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(m,2)+s(m,2)+s(_,4)+s(b,4)+s(P.length,2)+P})(this.dirRecords.length,v,h,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(h){this._sources.push(h);var y=this;return h.on("data",function(v){y.processChunk(v)}),h.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),h.on("error",function(v){y.error(v)}),this},d.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(h){var y=this._sources;if(!l.prototype.error.call(this,h))return!1;for(var v=0;v<y.length;v++)try{y[v].error(h)}catch{}return!0},d.prototype.lock=function(){l.prototype.lock.call(this);for(var h=this._sources,y=0;y<h.length;y++)h[y].lock()},n.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,n,i){var s=t("../compressions"),a=t("./ZipFileWorker");i.generateWorker=function(o,l,u){var c=new a(l.streamFiles,u,l.platform,l.encodeFileName),f=0;try{o.forEach(function(d,h){f++;var y=(function(_,b){var w=_||b,T=s[w];if(!T)throw new Error(w+" is not a valid compression method !");return T})(h.options.compression,l.compression),v=h.options.compressionOptions||l.compressionOptions||{},x=h.dir,m=h.date;h._compressWorker(y,v).withStreamInfo("file",{name:d,dir:x,date:m,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(c)}),c.entriesCount=f}catch(d){c.error(d)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,n,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(s.prototype=t("./object")).loadAsync=t("./load"),s.support=t("./support"),s.defaults=t("./defaults"),s.version="3.10.1",s.loadAsync=function(a,o){return new s().loadAsync(a,o)},s.external=t("./external"),n.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,n,i){var s=t("./utils"),a=t("./external"),o=t("./utf8"),l=t("./zipEntries"),u=t("./stream/Crc32Probe"),c=t("./nodejsUtils");function f(d){return new a.Promise(function(h,y){var v=d.decompressed.getContentWorker().pipe(new u);v.on("error",function(x){y(x)}).on("end",function(){v.streamInfo.crc32!==d.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}n.exports=function(d,h){var y=this;return h=s.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),c.isNode&&c.isStream(d)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",d,!0,h.optimizedBinaryString,h.base64).then(function(v){var x=new l(h);return x.load(v),x}).then(function(v){var x=[a.Promise.resolve(v)],m=v.files;if(h.checkCRC32)for(var _=0;_<m.length;_++)x.push(f(m[_]));return a.Promise.all(x)}).then(function(v){for(var x=v.shift(),m=x.files,_=0;_<m.length;_++){var b=m[_],w=b.fileNameStr,T=s.resolve(b.fileNameStr);y.file(T,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:h.createFolders}),b.dir||(y.file(T).unsafeOriginalName=w)}return x.zipComment.length&&(y.comment=x.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,n,i){var s=t("../utils"),a=t("../stream/GenericWorker");function o(l,u){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}s.inherits(o,a),o.prototype._bindStream=function(l){var u=this;(this._stream=l).pause(),l.on("data",function(c){u.push({data:c,meta:{percent:0}})}).on("error",function(c){u.isPaused?this.generatedError=c:u.error(c)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,n,i){var s=t("readable-stream").Readable;function a(o,l,u){s.call(this,l),this._helper=o;var c=this;o.on("data",function(f,d){c.push(f)||c._helper.pause(),u&&u(d)}).on("error",function(f){c.emit("error",f)}).on("end",function(){c.push(null)})}t("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},n.exports=a},{"../utils":32,"readable-stream":16}],14:[function(t,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(t,n,i){function s(T,P,M){var U,R=o.getTypeOf(P),J=o.extend(M||{},c);J.date=J.date||new Date,J.compression!==null&&(J.compression=J.compression.toUpperCase()),typeof J.unixPermissions=="string"&&(J.unixPermissions=parseInt(J.unixPermissions,8)),J.unixPermissions&&16384&J.unixPermissions&&(J.dir=!0),J.dosPermissions&&16&J.dosPermissions&&(J.dir=!0),J.dir&&(T=m(T)),J.createFolders&&(U=x(T))&&_.call(this,U,!0);var oe=R==="string"&&J.binary===!1&&J.base64===!1;M&&M.binary!==void 0||(J.binary=!oe),(P instanceof f&&P.uncompressedSize===0||J.dir||!P||P.length===0)&&(J.base64=!1,J.binary=!0,P="",J.compression="STORE",R="string");var C=null;C=P instanceof f||P instanceof l?P:y.isNode&&y.isStream(P)?new v(T,P):o.prepareContent(T,P,J.binary,J.optimizedBinaryString,J.base64);var H=new d(T,C,J);this.files[T]=H}var a=t("./utf8"),o=t("./utils"),l=t("./stream/GenericWorker"),u=t("./stream/StreamHelper"),c=t("./defaults"),f=t("./compressedObject"),d=t("./zipObject"),h=t("./generate"),y=t("./nodejsUtils"),v=t("./nodejs/NodejsStreamInputAdapter"),x=function(T){T.slice(-1)==="/"&&(T=T.substring(0,T.length-1));var P=T.lastIndexOf("/");return 0<P?T.substring(0,P):""},m=function(T){return T.slice(-1)!=="/"&&(T+="/"),T},_=function(T,P){return P=P!==void 0?P:c.createFolders,T=m(T),this.files[T]||s.call(this,T,null,{dir:!0,createFolders:P}),this.files[T]};function b(T){return Object.prototype.toString.call(T)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(T){var P,M,U;for(P in this.files)U=this.files[P],(M=P.slice(this.root.length,P.length))&&P.slice(0,this.root.length)===this.root&&T(M,U)},filter:function(T){var P=[];return this.forEach(function(M,U){T(M,U)&&P.push(U)}),P},file:function(T,P,M){if(arguments.length!==1)return T=this.root+T,s.call(this,T,P,M),this;if(b(T)){var U=T;return this.filter(function(J,oe){return!oe.dir&&U.test(J)})}var R=this.files[this.root+T];return R&&!R.dir?R:null},folder:function(T){if(!T)return this;if(b(T))return this.filter(function(R,J){return J.dir&&T.test(R)});var P=this.root+T,M=_.call(this,P),U=this.clone();return U.root=M.name,U},remove:function(T){T=this.root+T;var P=this.files[T];if(P||(T.slice(-1)!=="/"&&(T+="/"),P=this.files[T]),P&&!P.dir)delete this.files[T];else for(var M=this.filter(function(R,J){return J.name.slice(0,T.length)===T}),U=0;U<M.length;U++)delete this.files[M[U].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(T){var P,M={};try{if((M=o.extend(T||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=M.type.toLowerCase(),M.compression=M.compression.toUpperCase(),M.type==="binarystring"&&(M.type="string"),!M.type)throw new Error("No output type specified.");o.checkSupport(M.type),M.platform!=="darwin"&&M.platform!=="freebsd"&&M.platform!=="linux"&&M.platform!=="sunos"||(M.platform="UNIX"),M.platform==="win32"&&(M.platform="DOS");var U=M.comment||this.comment||"";P=h.generateWorker(this,M,U)}catch(R){(P=new l("error")).error(R)}return new u(P,M.type||"string",M.mimeType)},generateAsync:function(T,P){return this.generateInternalStream(T).accumulate(P)},generateNodeStream:function(T,P){return(T=T||{}).type||(T.type="nodebuffer"),this.generateInternalStream(T).toNodejsStream(P)}};n.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,n,i){n.exports=t("stream")},{stream:void 0}],17:[function(t,n,i){var s=t("./DataReader");function a(o){s.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}t("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),u=o.charCodeAt(1),c=o.charCodeAt(2),f=o.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===l&&this.data[d+1]===u&&this.data[d+2]===c&&this.data[d+3]===f)return d-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),u=o.charCodeAt(1),c=o.charCodeAt(2),f=o.charCodeAt(3),d=this.readData(4);return l===d[0]&&u===d[1]&&c===d[2]&&f===d[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=a},{"../utils":32,"./DataReader":18}],18:[function(t,n,i){var s=t("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,u=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)u=(u<<8)+this.byteAt(l);return this.index+=o,u},readString:function(o){return s.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},n.exports=a},{"../utils":32}],19:[function(t,n,i){var s=t("./Uint8ArrayReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,n,i){var s=t("./DataReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=a},{"../utils":32,"./DataReader":18}],21:[function(t,n,i){var s=t("./ArrayReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(t,n,i){var s=t("../utils"),a=t("../support"),o=t("./ArrayReader"),l=t("./StringReader"),u=t("./NodeBufferReader"),c=t("./Uint8ArrayReader");n.exports=function(f){var d=s.getTypeOf(f);return s.checkSupport(d),d!=="string"||a.uint8array?d==="nodebuffer"?new u(f):a.uint8array?new c(s.transformTo("uint8array",f)):new o(s.transformTo("array",f)):new l(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,n,i){var s=t("./GenericWorker"),a=t("../utils");function o(l){s.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,s),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},n.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,n,i){var s=t("./GenericWorker"),a=t("../crc32");function o(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,s),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,n,i){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(o,a),o.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}a.prototype.processChunk.call(this,l)},n.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,n,i){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(c){u.dataIsReady=!0,u.data=c,u.max=c&&c.length||0,u.type=s.getTypeOf(c),u.isPaused||u._tickAndRepeat()},function(c){u.error(c)})}s.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,u);break;case"uint8array":l=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":l=this.data.slice(this.index,u)}return this.index=u,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,n,i){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},n.exports=s},{}],29:[function(t,n,i){var s=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),l=t("../base64"),u=t("../support"),c=t("../external"),f=null;if(u.nodestream)try{f=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(y,v){return new c.Promise(function(x,m){var _=[],b=y._internalType,w=y._outputType,T=y._mimeType;y.on("data",function(P,M){_.push(P),v&&v(M)}).on("error",function(P){_=[],m(P)}).on("end",function(){try{var P=(function(M,U,R){switch(M){case"blob":return s.newBlob(s.transformTo("arraybuffer",U),R);case"base64":return l.encode(U);default:return s.transformTo(M,U)}})(w,(function(M,U){var R,J=0,oe=null,C=0;for(R=0;R<U.length;R++)C+=U[R].length;switch(M){case"string":return U.join("");case"array":return Array.prototype.concat.apply([],U);case"uint8array":for(oe=new Uint8Array(C),R=0;R<U.length;R++)oe.set(U[R],J),J+=U[R].length;return oe;case"nodebuffer":return Buffer.concat(U);default:throw new Error("concat : unsupported type '"+M+"'")}})(b,_),T);x(P)}catch(M){m(M)}_=[]}).resume()})}function h(y,v,x){var m=v;switch(v){case"blob":case"arraybuffer":m="uint8array";break;case"base64":m="string"}try{this._internalType=m,this._outputType=v,this._mimeType=x,s.checkSupport(m),this._worker=y.pipe(new a(m)),y.lock()}catch(_){this._worker=new o("error"),this._worker.error(_)}}h.prototype={accumulate:function(y){return d(this,y)},on:function(y,v){var x=this;return y==="data"?this._worker.on(y,function(m){v.call(x,m.data,m.meta)}):this._worker.on(y,function(){s.delay(v,arguments,x)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},y)}},n.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!t("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(t,n,i){for(var s=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),l=t("./stream/GenericWorker"),u=new Array(256),c=0;c<256;c++)u[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;u[254]=u[254]=1;function f(){l.call(this,"utf-8 decode"),this.leftOver=null}function d(){l.call(this,"utf-8 encode")}i.utf8encode=function(h){return a.nodebuffer?o.newBufferFrom(h,"utf-8"):(function(y){var v,x,m,_,b,w=y.length,T=0;for(_=0;_<w;_++)(64512&(x=y.charCodeAt(_)))==55296&&_+1<w&&(64512&(m=y.charCodeAt(_+1)))==56320&&(x=65536+(x-55296<<10)+(m-56320),_++),T+=x<128?1:x<2048?2:x<65536?3:4;for(v=a.uint8array?new Uint8Array(T):new Array(T),_=b=0;b<T;_++)(64512&(x=y.charCodeAt(_)))==55296&&_+1<w&&(64512&(m=y.charCodeAt(_+1)))==56320&&(x=65536+(x-55296<<10)+(m-56320),_++),x<128?v[b++]=x:(x<2048?v[b++]=192|x>>>6:(x<65536?v[b++]=224|x>>>12:(v[b++]=240|x>>>18,v[b++]=128|x>>>12&63),v[b++]=128|x>>>6&63),v[b++]=128|63&x);return v})(h)},i.utf8decode=function(h){return a.nodebuffer?s.transformTo("nodebuffer",h).toString("utf-8"):(function(y){var v,x,m,_,b=y.length,w=new Array(2*b);for(v=x=0;v<b;)if((m=y[v++])<128)w[x++]=m;else if(4<(_=u[m]))w[x++]=65533,v+=_-1;else{for(m&=_===2?31:_===3?15:7;1<_&&v<b;)m=m<<6|63&y[v++],_--;1<_?w[x++]=65533:m<65536?w[x++]=m:(m-=65536,w[x++]=55296|m>>10&1023,w[x++]=56320|1023&m)}return w.length!==x&&(w.subarray?w=w.subarray(0,x):w.length=x),s.applyFromCharCode(w)})(h=s.transformTo(a.uint8array?"uint8array":"array",h))},s.inherits(f,l),f.prototype.processChunk=function(h){var y=s.transformTo(a.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var v=y;(y=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),y.set(v,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var x=(function(_,b){var w;for((b=b||_.length)>_.length&&(b=_.length),w=b-1;0<=w&&(192&_[w])==128;)w--;return w<0||w===0?b:w+u[_[w]]>b?w:b})(y),m=y;x!==y.length&&(a.uint8array?(m=y.subarray(0,x),this.leftOver=y.subarray(x,y.length)):(m=y.slice(0,x),this.leftOver=y.slice(x,y.length))),this.push({data:i.utf8decode(m),meta:h.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=f,s.inherits(d,l),d.prototype.processChunk=function(h){this.push({data:i.utf8encode(h.data),meta:h.meta})},i.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,n,i){var s=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),l=t("./external");function u(v){return v}function c(v,x){for(var m=0;m<v.length;++m)x[m]=255&v.charCodeAt(m);return x}t("setimmediate"),i.newBlob=function(v,x){i.checkSupport("blob");try{return new Blob([v],{type:x})}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return m.append(v),m.getBlob(x)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(v,x,m){var _=[],b=0,w=v.length;if(w<=m)return String.fromCharCode.apply(null,v);for(;b<w;)x==="array"||x==="nodebuffer"?_.push(String.fromCharCode.apply(null,v.slice(b,Math.min(b+m,w)))):_.push(String.fromCharCode.apply(null,v.subarray(b,Math.min(b+m,w)))),b+=m;return _.join("")},stringifyByChar:function(v){for(var x="",m=0;m<v.length;m++)x+=String.fromCharCode(v[m]);return x},applyCanBeUsed:{uint8array:(function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}})()}};function d(v){var x=65536,m=i.getTypeOf(v),_=!0;if(m==="uint8array"?_=f.applyCanBeUsed.uint8array:m==="nodebuffer"&&(_=f.applyCanBeUsed.nodebuffer),_)for(;1<x;)try{return f.stringifyByChunk(v,m,x)}catch{x=Math.floor(x/2)}return f.stringifyByChar(v)}function h(v,x){for(var m=0;m<v.length;m++)x[m]=v[m];return x}i.applyFromCharCode=d;var y={};y.string={string:u,array:function(v){return c(v,new Array(v.length))},arraybuffer:function(v){return y.string.uint8array(v).buffer},uint8array:function(v){return c(v,new Uint8Array(v.length))},nodebuffer:function(v){return c(v,o.allocBuffer(v.length))}},y.array={string:d,array:u,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return o.newBufferFrom(v)}},y.arraybuffer={string:function(v){return d(new Uint8Array(v))},array:function(v){return h(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:u,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return o.newBufferFrom(new Uint8Array(v))}},y.uint8array={string:d,array:function(v){return h(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:u,nodebuffer:function(v){return o.newBufferFrom(v)}},y.nodebuffer={string:d,array:function(v){return h(v,new Array(v.length))},arraybuffer:function(v){return y.nodebuffer.uint8array(v).buffer},uint8array:function(v){return h(v,new Uint8Array(v.length))},nodebuffer:u},i.transformTo=function(v,x){if(x=x||"",!v)return x;i.checkSupport(v);var m=i.getTypeOf(x);return y[m][v](x)},i.resolve=function(v){for(var x=v.split("/"),m=[],_=0;_<x.length;_++){var b=x[_];b==="."||b===""&&_!==0&&_!==x.length-1||(b===".."?m.pop():m.push(b))}return m.join("/")},i.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":s.nodebuffer&&o.isBuffer(v)?"nodebuffer":s.uint8array&&v instanceof Uint8Array?"uint8array":s.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(v){if(!s[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(v){var x,m,_="";for(m=0;m<(v||"").length;m++)_+="\\x"+((x=v.charCodeAt(m))<16?"0":"")+x.toString(16).toUpperCase();return _},i.delay=function(v,x,m){setImmediate(function(){v.apply(m||null,x||[])})},i.inherits=function(v,x){function m(){}m.prototype=x.prototype,v.prototype=new m},i.extend=function(){var v,x,m={};for(v=0;v<arguments.length;v++)for(x in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],x)&&m[x]===void 0&&(m[x]=arguments[v][x]);return m},i.prepareContent=function(v,x,m,_,b){return l.Promise.resolve(x).then(function(w){return s.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1)&&typeof FileReader<"u"?new l.Promise(function(T,P){var M=new FileReader;M.onload=function(U){T(U.target.result)},M.onerror=function(U){P(U.target.error)},M.readAsArrayBuffer(w)}):w}).then(function(w){var T=i.getTypeOf(w);return T?(T==="arraybuffer"?w=i.transformTo("uint8array",w):T==="string"&&(b?w=a.decode(w):m&&_!==!0&&(w=(function(P){return c(P,s.uint8array?new Uint8Array(P.length):new Array(P.length))})(w))),w):l.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,n,i){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),l=t("./zipEntry"),u=t("./support");function c(f){this.files=[],this.loadOptions=f}c.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(d)+", expected "+a.pretty(f)+")")}},isSignature:function(f,d){var h=this.reader.index;this.reader.setIndex(f);var y=this.reader.readString(4)===d;return this.reader.setIndex(h),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),d=u.uint8array?"uint8array":"array",h=a.transformTo(d,f);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,d,h,y=this.zip64EndOfCentralSize-44;0<y;)f=this.reader.readInt(2),d=this.reader.readInt(4),h=this.reader.readData(d),this.zip64ExtensibleData[f]={id:f,length:d,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,d;for(f=0;f<this.files.length;f++)d=this.files[f],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(f=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var d=f;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var y=d-h;if(0<y)this.isSignature(d,o.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,n,i){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),l=t("./crc32"),u=t("./utf8"),c=t("./compressions"),f=t("./support");function d(h,y){this.options=h,this.loadOptions=y}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var y,v;if(h.skip(22),this.fileNameLength=h.readInt(2),v=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=(function(x){for(var m in c)if(Object.prototype.hasOwnProperty.call(c,m)&&c[m].magic===x)return c[m];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,y,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var y=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(y),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var y,v,x,m=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<m;)y=h.readInt(2),v=h.readInt(2),x=h.readData(v),this.extraFields[y]={id:y,length:v,value:x};h.setIndex(m)},handleUTF8:function(){var h=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var v=a.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var x=this.findExtraFieldUnicodeComment();if(x!==null)this.fileCommentStr=x;else{var m=a.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(m)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var y=s(h.value);return y.readInt(1)!==1||l(this.fileName)!==y.readInt(4)?null:u.utf8decode(y.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var y=s(h.value);return y.readInt(1)!==1||l(this.fileComment)!==y.readInt(4)?null:u.utf8decode(y.readData(h.length-5))}return null}},n.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,n,i){function s(y,v,x){this.name=y,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=v,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}}var a=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),l=t("./utf8"),u=t("./compressedObject"),c=t("./stream/GenericWorker");s.prototype={internalStream:function(y){var v=null,x="string";try{if(!y)throw new Error("No output type specified.");var m=(x=y.toLowerCase())==="string"||x==="text";x!=="binarystring"&&x!=="text"||(x="string"),v=this._decompressWorker();var _=!this._dataBinary;_&&!m&&(v=v.pipe(new l.Utf8EncodeWorker)),!_&&m&&(v=v.pipe(new l.Utf8DecodeWorker))}catch(b){(v=new c("error")).error(b)}return new a(v,x,"")},async:function(y,v){return this.internalStream(y).accumulate(v)},nodeStream:function(y,v){return this.internalStream(y||"nodebuffer").toNodejsStream(v)},_compressWorker:function(y,v){if(this._data instanceof u&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new l.Utf8EncodeWorker)),u.createWorkerFrom(x,y,v)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof c?this._data:new o(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<f.length;h++)s.prototype[f[h]]=d;n.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,n,i){(function(s){var a,o,l=s.MutationObserver||s.WebKitMutationObserver;if(l){var u=0,c=new l(y),f=s.document.createTextNode("");c.observe(f,{characterData:!0}),a=function(){f.data=u=++u%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var v=s.document.createElement("script");v.onreadystatechange=function(){y(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},s.document.documentElement.appendChild(v)}:function(){setTimeout(y,0)};else{var d=new s.MessageChannel;d.port1.onmessage=y,a=function(){d.port2.postMessage(0)}}var h=[];function y(){var v,x;o=!0;for(var m=h.length;m;){for(x=h,h=[],v=-1;++v<m;)x[v]();m=h.length}o=!1}n.exports=function(v){h.push(v)!==1||o||a()}}).call(this,typeof qr<"u"?qr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,n,i){var s=t("immediate");function a(){}var o={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];function f(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,m!==a&&v(this,m)}function d(m,_,b){this.promise=m,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function h(m,_,b){s(function(){var w;try{w=_(b)}catch(T){return o.reject(m,T)}w===m?o.reject(m,new TypeError("Cannot resolve promise with itself")):o.resolve(m,w)})}function y(m){var _=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof _=="function")return function(){_.apply(m,arguments)}}function v(m,_){var b=!1;function w(M){b||(b=!0,o.reject(m,M))}function T(M){b||(b=!0,o.resolve(m,M))}var P=x(function(){_(T,w)});P.status==="error"&&w(P.value)}function x(m,_){var b={};try{b.value=m(_),b.status="success"}catch(w){b.status="error",b.value=w}return b}(n.exports=f).prototype.finally=function(m){if(typeof m!="function")return this;var _=this.constructor;return this.then(function(b){return _.resolve(m()).then(function(){return b})},function(b){return _.resolve(m()).then(function(){throw b})})},f.prototype.catch=function(m){return this.then(null,m)},f.prototype.then=function(m,_){if(typeof m!="function"&&this.state===u||typeof _!="function"&&this.state===l)return this;var b=new this.constructor(a);return this.state!==c?h(b,this.state===u?m:_,this.outcome):this.queue.push(new d(b,m,_)),b},d.prototype.callFulfilled=function(m){o.resolve(this.promise,m)},d.prototype.otherCallFulfilled=function(m){h(this.promise,this.onFulfilled,m)},d.prototype.callRejected=function(m){o.reject(this.promise,m)},d.prototype.otherCallRejected=function(m){h(this.promise,this.onRejected,m)},o.resolve=function(m,_){var b=x(y,_);if(b.status==="error")return o.reject(m,b.value);var w=b.value;if(w)v(m,w);else{m.state=u,m.outcome=_;for(var T=-1,P=m.queue.length;++T<P;)m.queue[T].callFulfilled(_)}return m},o.reject=function(m,_){m.state=l,m.outcome=_;for(var b=-1,w=m.queue.length;++b<w;)m.queue[b].callRejected(_);return m},f.resolve=function(m){return m instanceof this?m:o.resolve(new this(a),m)},f.reject=function(m){var _=new this(a);return o.reject(_,m)},f.all=function(m){var _=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=m.length,w=!1;if(!b)return this.resolve([]);for(var T=new Array(b),P=0,M=-1,U=new this(a);++M<b;)R(m[M],M);return U;function R(J,oe){_.resolve(J).then(function(C){T[oe]=C,++P!==b||w||(w=!0,o.resolve(U,T))},function(C){w||(w=!0,o.reject(U,C))})}},f.race=function(m){var _=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=m.length,w=!1;if(!b)return this.resolve([]);for(var T=-1,P=new this(a);++T<b;)M=m[T],_.resolve(M).then(function(U){w||(w=!0,o.resolve(P,U))},function(U){w||(w=!0,o.reject(P,U))});var M;return P}},{immediate:36}],38:[function(t,n,i){var s={};(0,t("./lib/utils/common").assign)(s,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),n.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,n,i){var s=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/messages"),u=t("./zlib/zstream"),c=Object.prototype.toString,f=0,d=-1,h=0,y=8;function v(m){if(!(this instanceof v))return new v(m);this.options=a.assign({level:d,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},m||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var b=s.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(b!==f)throw new Error(l[b]);if(_.header&&s.deflateSetHeader(this.strm,_.header),_.dictionary){var w;if(w=typeof _.dictionary=="string"?o.string2buf(_.dictionary):c.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(b=s.deflateSetDictionary(this.strm,w))!==f)throw new Error(l[b]);this._dict_set=!0}}function x(m,_){var b=new v(_);if(b.push(m,!0),b.err)throw b.msg||l[b.err];return b.result}v.prototype.push=function(m,_){var b,w,T=this.strm,P=this.options.chunkSize;if(this.ended)return!1;w=_===~~_?_:_===!0?4:0,typeof m=="string"?T.input=o.string2buf(m):c.call(m)==="[object ArrayBuffer]"?T.input=new Uint8Array(m):T.input=m,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new a.Buf8(P),T.next_out=0,T.avail_out=P),(b=s.deflate(T,w))!==1&&b!==f)return this.onEnd(b),!(this.ended=!0);T.avail_out!==0&&(T.avail_in!==0||w!==4&&w!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(T.output,T.next_out))):this.onData(a.shrinkBuf(T.output,T.next_out)))}while((0<T.avail_in||T.avail_out===0)&&b!==1);return w===4?(b=s.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===f):w!==2||(this.onEnd(f),!(T.avail_out=0))},v.prototype.onData=function(m){this.chunks.push(m)},v.prototype.onEnd=function(m){m===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},i.Deflate=v,i.deflate=x,i.deflateRaw=function(m,_){return(_=_||{}).raw=!0,x(m,_)},i.gzip=function(m,_){return(_=_||{}).gzip=!0,x(m,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,n,i){var s=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/constants"),u=t("./zlib/messages"),c=t("./zlib/zstream"),f=t("./zlib/gzheader"),d=Object.prototype.toString;function h(v){if(!(this instanceof h))return new h(v);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},v||{});var x=this.options;x.raw&&0<=x.windowBits&&x.windowBits<16&&(x.windowBits=-x.windowBits,x.windowBits===0&&(x.windowBits=-15)),!(0<=x.windowBits&&x.windowBits<16)||v&&v.windowBits||(x.windowBits+=32),15<x.windowBits&&x.windowBits<48&&(15&x.windowBits)==0&&(x.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var m=s.inflateInit2(this.strm,x.windowBits);if(m!==l.Z_OK)throw new Error(u[m]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}function y(v,x){var m=new h(x);if(m.push(v,!0),m.err)throw m.msg||u[m.err];return m.result}h.prototype.push=function(v,x){var m,_,b,w,T,P,M=this.strm,U=this.options.chunkSize,R=this.options.dictionary,J=!1;if(this.ended)return!1;_=x===~~x?x:x===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof v=="string"?M.input=o.binstring2buf(v):d.call(v)==="[object ArrayBuffer]"?M.input=new Uint8Array(v):M.input=v,M.next_in=0,M.avail_in=M.input.length;do{if(M.avail_out===0&&(M.output=new a.Buf8(U),M.next_out=0,M.avail_out=U),(m=s.inflate(M,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&R&&(P=typeof R=="string"?o.string2buf(R):d.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,m=s.inflateSetDictionary(this.strm,P)),m===l.Z_BUF_ERROR&&J===!0&&(m=l.Z_OK,J=!1),m!==l.Z_STREAM_END&&m!==l.Z_OK)return this.onEnd(m),!(this.ended=!0);M.next_out&&(M.avail_out!==0&&m!==l.Z_STREAM_END&&(M.avail_in!==0||_!==l.Z_FINISH&&_!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=o.utf8border(M.output,M.next_out),w=M.next_out-b,T=o.buf2string(M.output,b),M.next_out=w,M.avail_out=U-w,w&&a.arraySet(M.output,M.output,b,w,0),this.onData(T)):this.onData(a.shrinkBuf(M.output,M.next_out)))),M.avail_in===0&&M.avail_out===0&&(J=!0)}while((0<M.avail_in||M.avail_out===0)&&m!==l.Z_STREAM_END);return m===l.Z_STREAM_END&&(_=l.Z_FINISH),_===l.Z_FINISH?(m=s.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===l.Z_OK):_!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(M.avail_out=0))},h.prototype.onData=function(v){this.chunks.push(v)},h.prototype.onEnd=function(v){v===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},i.Inflate=h,i.inflate=y,i.inflateRaw=function(v,x){return(x=x||{}).raw=!0,y(v,x)},i.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var c=u.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var f in c)c.hasOwnProperty(f)&&(l[f]=c[f])}}return l},i.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var a={arraySet:function(l,u,c,f,d){if(u.subarray&&l.subarray)l.set(u.subarray(c,c+f),d);else for(var h=0;h<f;h++)l[d+h]=u[c+h]},flattenChunks:function(l){var u,c,f,d,h,y;for(u=f=0,c=l.length;u<c;u++)f+=l[u].length;for(y=new Uint8Array(f),u=d=0,c=l.length;u<c;u++)h=l[u],y.set(h,d),d+=h.length;return y}},o={arraySet:function(l,u,c,f,d){for(var h=0;h<f;h++)l[d+h]=u[c+h]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(s)},{}],42:[function(t,n,i){var s=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new s.Buf8(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function c(f,d){if(d<65537&&(f.subarray&&o||!f.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(f,d));for(var h="",y=0;y<d;y++)h+=String.fromCharCode(f[y]);return h}l[254]=l[254]=1,i.string2buf=function(f){var d,h,y,v,x,m=f.length,_=0;for(v=0;v<m;v++)(64512&(h=f.charCodeAt(v)))==55296&&v+1<m&&(64512&(y=f.charCodeAt(v+1)))==56320&&(h=65536+(h-55296<<10)+(y-56320),v++),_+=h<128?1:h<2048?2:h<65536?3:4;for(d=new s.Buf8(_),v=x=0;x<_;v++)(64512&(h=f.charCodeAt(v)))==55296&&v+1<m&&(64512&(y=f.charCodeAt(v+1)))==56320&&(h=65536+(h-55296<<10)+(y-56320),v++),h<128?d[x++]=h:(h<2048?d[x++]=192|h>>>6:(h<65536?d[x++]=224|h>>>12:(d[x++]=240|h>>>18,d[x++]=128|h>>>12&63),d[x++]=128|h>>>6&63),d[x++]=128|63&h);return d},i.buf2binstring=function(f){return c(f,f.length)},i.binstring2buf=function(f){for(var d=new s.Buf8(f.length),h=0,y=d.length;h<y;h++)d[h]=f.charCodeAt(h);return d},i.buf2string=function(f,d){var h,y,v,x,m=d||f.length,_=new Array(2*m);for(h=y=0;h<m;)if((v=f[h++])<128)_[y++]=v;else if(4<(x=l[v]))_[y++]=65533,h+=x-1;else{for(v&=x===2?31:x===3?15:7;1<x&&h<m;)v=v<<6|63&f[h++],x--;1<x?_[y++]=65533:v<65536?_[y++]=v:(v-=65536,_[y++]=55296|v>>10&1023,_[y++]=56320|1023&v)}return c(_,y)},i.utf8border=function(f,d){var h;for((d=d||f.length)>f.length&&(d=f.length),h=d-1;0<=h&&(192&f[h])==128;)h--;return h<0||h===0?d:h+l[f[h]]>d?h:d}},{"./common":41}],43:[function(t,n,i){n.exports=function(s,a,o,l){for(var u=65535&s|0,c=s>>>16&65535|0,f=0;o!==0;){for(o-=f=2e3<o?2e3:o;c=c+(u=u+a[l++]|0)|0,--f;);u%=65521,c%=65521}return u|c<<16|0}},{}],44:[function(t,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,n,i){var s=(function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o})();n.exports=function(a,o,l,u){var c=s,f=u+l;a^=-1;for(var d=u;d<f;d++)a=a>>>8^c[255&(a^o[d])];return-1^a}},{}],46:[function(t,n,i){var s,a=t("../utils/common"),o=t("./trees"),l=t("./adler32"),u=t("./crc32"),c=t("./messages"),f=0,d=4,h=0,y=-2,v=-1,x=4,m=2,_=8,b=9,w=286,T=30,P=19,M=2*w+1,U=15,R=3,J=258,oe=J+R+1,C=42,H=113,k=1,V=2,Q=3,j=4;function ie(E,Y){return E.msg=c[Y],Y}function ee(E){return(E<<1)-(4<E?9:0)}function le(E){for(var Y=E.length;0<=--Y;)E[Y]=0}function G(E){var Y=E.state,N=Y.pending;N>E.avail_out&&(N=E.avail_out),N!==0&&(a.arraySet(E.output,Y.pending_buf,Y.pending_out,N,E.next_out),E.next_out+=N,Y.pending_out+=N,E.total_out+=N,E.avail_out-=N,Y.pending-=N,Y.pending===0&&(Y.pending_out=0))}function D(E,Y){o._tr_flush_block(E,0<=E.block_start?E.block_start:-1,E.strstart-E.block_start,Y),E.block_start=E.strstart,G(E.strm)}function $(E,Y){E.pending_buf[E.pending++]=Y}function X(E,Y){E.pending_buf[E.pending++]=Y>>>8&255,E.pending_buf[E.pending++]=255&Y}function re(E,Y){var N,p,g=E.max_chain_length,S=E.strstart,F=E.prev_length,q=E.nice_match,z=E.strstart>E.w_size-oe?E.strstart-(E.w_size-oe):0,ne=E.window,ae=E.w_mask,se=E.prev,fe=E.strstart+J,pe=ne[S+F-1],ve=ne[S+F];E.prev_length>=E.good_match&&(g>>=2),q>E.lookahead&&(q=E.lookahead);do if(ne[(N=Y)+F]===ve&&ne[N+F-1]===pe&&ne[N]===ne[S]&&ne[++N]===ne[S+1]){S+=2,N++;do;while(ne[++S]===ne[++N]&&ne[++S]===ne[++N]&&ne[++S]===ne[++N]&&ne[++S]===ne[++N]&&ne[++S]===ne[++N]&&ne[++S]===ne[++N]&&ne[++S]===ne[++N]&&ne[++S]===ne[++N]&&S<fe);if(p=J-(fe-S),S=fe-J,F<p){if(E.match_start=Y,q<=(F=p))break;pe=ne[S+F-1],ve=ne[S+F]}}while((Y=se[Y&ae])>z&&--g!=0);return F<=E.lookahead?F:E.lookahead}function K(E){var Y,N,p,g,S,F,q,z,ne,ae,se=E.w_size;do{if(g=E.window_size-E.lookahead-E.strstart,E.strstart>=se+(se-oe)){for(a.arraySet(E.window,E.window,se,se,0),E.match_start-=se,E.strstart-=se,E.block_start-=se,Y=N=E.hash_size;p=E.head[--Y],E.head[Y]=se<=p?p-se:0,--N;);for(Y=N=se;p=E.prev[--Y],E.prev[Y]=se<=p?p-se:0,--N;);g+=se}if(E.strm.avail_in===0)break;if(F=E.strm,q=E.window,z=E.strstart+E.lookahead,ne=g,ae=void 0,ae=F.avail_in,ne<ae&&(ae=ne),N=ae===0?0:(F.avail_in-=ae,a.arraySet(q,F.input,F.next_in,ae,z),F.state.wrap===1?F.adler=l(F.adler,q,ae,z):F.state.wrap===2&&(F.adler=u(F.adler,q,ae,z)),F.next_in+=ae,F.total_in+=ae,ae),E.lookahead+=N,E.lookahead+E.insert>=R)for(S=E.strstart-E.insert,E.ins_h=E.window[S],E.ins_h=(E.ins_h<<E.hash_shift^E.window[S+1])&E.hash_mask;E.insert&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[S+R-1])&E.hash_mask,E.prev[S&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=S,S++,E.insert--,!(E.lookahead+E.insert<R)););}while(E.lookahead<oe&&E.strm.avail_in!==0)}function O(E,Y){for(var N,p;;){if(E.lookahead<oe){if(K(E),E.lookahead<oe&&Y===f)return k;if(E.lookahead===0)break}if(N=0,E.lookahead>=R&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+R-1])&E.hash_mask,N=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),N!==0&&E.strstart-N<=E.w_size-oe&&(E.match_length=re(E,N)),E.match_length>=R)if(p=o._tr_tally(E,E.strstart-E.match_start,E.match_length-R),E.lookahead-=E.match_length,E.match_length<=E.max_lazy_match&&E.lookahead>=R){for(E.match_length--;E.strstart++,E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+R-1])&E.hash_mask,N=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart,--E.match_length!=0;);E.strstart++}else E.strstart+=E.match_length,E.match_length=0,E.ins_h=E.window[E.strstart],E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+1])&E.hash_mask;else p=o._tr_tally(E,0,E.window[E.strstart]),E.lookahead--,E.strstart++;if(p&&(D(E,!1),E.strm.avail_out===0))return k}return E.insert=E.strstart<R-1?E.strstart:R-1,Y===d?(D(E,!0),E.strm.avail_out===0?Q:j):E.last_lit&&(D(E,!1),E.strm.avail_out===0)?k:V}function A(E,Y){for(var N,p,g;;){if(E.lookahead<oe){if(K(E),E.lookahead<oe&&Y===f)return k;if(E.lookahead===0)break}if(N=0,E.lookahead>=R&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+R-1])&E.hash_mask,N=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),E.prev_length=E.match_length,E.prev_match=E.match_start,E.match_length=R-1,N!==0&&E.prev_length<E.max_lazy_match&&E.strstart-N<=E.w_size-oe&&(E.match_length=re(E,N),E.match_length<=5&&(E.strategy===1||E.match_length===R&&4096<E.strstart-E.match_start)&&(E.match_length=R-1)),E.prev_length>=R&&E.match_length<=E.prev_length){for(g=E.strstart+E.lookahead-R,p=o._tr_tally(E,E.strstart-1-E.prev_match,E.prev_length-R),E.lookahead-=E.prev_length-1,E.prev_length-=2;++E.strstart<=g&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+R-1])&E.hash_mask,N=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),--E.prev_length!=0;);if(E.match_available=0,E.match_length=R-1,E.strstart++,p&&(D(E,!1),E.strm.avail_out===0))return k}else if(E.match_available){if((p=o._tr_tally(E,0,E.window[E.strstart-1]))&&D(E,!1),E.strstart++,E.lookahead--,E.strm.avail_out===0)return k}else E.match_available=1,E.strstart++,E.lookahead--}return E.match_available&&(p=o._tr_tally(E,0,E.window[E.strstart-1]),E.match_available=0),E.insert=E.strstart<R-1?E.strstart:R-1,Y===d?(D(E,!0),E.strm.avail_out===0?Q:j):E.last_lit&&(D(E,!1),E.strm.avail_out===0)?k:V}function W(E,Y,N,p,g){this.good_length=E,this.max_lazy=Y,this.nice_length=N,this.max_chain=p,this.func=g}function B(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*M),this.dyn_dtree=new a.Buf16(2*(2*T+1)),this.bl_tree=new a.Buf16(2*(2*P+1)),le(this.dyn_ltree),le(this.dyn_dtree),le(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(U+1),this.heap=new a.Buf16(2*w+1),le(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*w+1),le(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function I(E){var Y;return E&&E.state?(E.total_in=E.total_out=0,E.data_type=m,(Y=E.state).pending=0,Y.pending_out=0,Y.wrap<0&&(Y.wrap=-Y.wrap),Y.status=Y.wrap?C:H,E.adler=Y.wrap===2?0:1,Y.last_flush=f,o._tr_init(Y),h):ie(E,y)}function L(E){var Y=I(E);return Y===h&&(function(N){N.window_size=2*N.w_size,le(N.head),N.max_lazy_match=s[N.level].max_lazy,N.good_match=s[N.level].good_length,N.nice_match=s[N.level].nice_length,N.max_chain_length=s[N.level].max_chain,N.strstart=0,N.block_start=0,N.lookahead=0,N.insert=0,N.match_length=N.prev_length=R-1,N.match_available=0,N.ins_h=0})(E.state),Y}function Z(E,Y,N,p,g,S){if(!E)return y;var F=1;if(Y===v&&(Y=6),p<0?(F=0,p=-p):15<p&&(F=2,p-=16),g<1||b<g||N!==_||p<8||15<p||Y<0||9<Y||S<0||x<S)return ie(E,y);p===8&&(p=9);var q=new B;return(E.state=q).strm=E,q.wrap=F,q.gzhead=null,q.w_bits=p,q.w_size=1<<q.w_bits,q.w_mask=q.w_size-1,q.hash_bits=g+7,q.hash_size=1<<q.hash_bits,q.hash_mask=q.hash_size-1,q.hash_shift=~~((q.hash_bits+R-1)/R),q.window=new a.Buf8(2*q.w_size),q.head=new a.Buf16(q.hash_size),q.prev=new a.Buf16(q.w_size),q.lit_bufsize=1<<g+6,q.pending_buf_size=4*q.lit_bufsize,q.pending_buf=new a.Buf8(q.pending_buf_size),q.d_buf=1*q.lit_bufsize,q.l_buf=3*q.lit_bufsize,q.level=Y,q.strategy=S,q.method=N,L(E)}s=[new W(0,0,0,0,function(E,Y){var N=65535;for(N>E.pending_buf_size-5&&(N=E.pending_buf_size-5);;){if(E.lookahead<=1){if(K(E),E.lookahead===0&&Y===f)return k;if(E.lookahead===0)break}E.strstart+=E.lookahead,E.lookahead=0;var p=E.block_start+N;if((E.strstart===0||E.strstart>=p)&&(E.lookahead=E.strstart-p,E.strstart=p,D(E,!1),E.strm.avail_out===0)||E.strstart-E.block_start>=E.w_size-oe&&(D(E,!1),E.strm.avail_out===0))return k}return E.insert=0,Y===d?(D(E,!0),E.strm.avail_out===0?Q:j):(E.strstart>E.block_start&&(D(E,!1),E.strm.avail_out),k)}),new W(4,4,8,4,O),new W(4,5,16,8,O),new W(4,6,32,32,O),new W(4,4,16,16,A),new W(8,16,32,32,A),new W(8,16,128,128,A),new W(8,32,128,256,A),new W(32,128,258,1024,A),new W(32,258,258,4096,A)],i.deflateInit=function(E,Y){return Z(E,Y,_,15,8,0)},i.deflateInit2=Z,i.deflateReset=L,i.deflateResetKeep=I,i.deflateSetHeader=function(E,Y){return E&&E.state?E.state.wrap!==2?y:(E.state.gzhead=Y,h):y},i.deflate=function(E,Y){var N,p,g,S;if(!E||!E.state||5<Y||Y<0)return E?ie(E,y):y;if(p=E.state,!E.output||!E.input&&E.avail_in!==0||p.status===666&&Y!==d)return ie(E,E.avail_out===0?-5:y);if(p.strm=E,N=p.last_flush,p.last_flush=Y,p.status===C)if(p.wrap===2)E.adler=0,$(p,31),$(p,139),$(p,8),p.gzhead?($(p,(p.gzhead.text?1:0)+(p.gzhead.hcrc?2:0)+(p.gzhead.extra?4:0)+(p.gzhead.name?8:0)+(p.gzhead.comment?16:0)),$(p,255&p.gzhead.time),$(p,p.gzhead.time>>8&255),$(p,p.gzhead.time>>16&255),$(p,p.gzhead.time>>24&255),$(p,p.level===9?2:2<=p.strategy||p.level<2?4:0),$(p,255&p.gzhead.os),p.gzhead.extra&&p.gzhead.extra.length&&($(p,255&p.gzhead.extra.length),$(p,p.gzhead.extra.length>>8&255)),p.gzhead.hcrc&&(E.adler=u(E.adler,p.pending_buf,p.pending,0)),p.gzindex=0,p.status=69):($(p,0),$(p,0),$(p,0),$(p,0),$(p,0),$(p,p.level===9?2:2<=p.strategy||p.level<2?4:0),$(p,3),p.status=H);else{var F=_+(p.w_bits-8<<4)<<8;F|=(2<=p.strategy||p.level<2?0:p.level<6?1:p.level===6?2:3)<<6,p.strstart!==0&&(F|=32),F+=31-F%31,p.status=H,X(p,F),p.strstart!==0&&(X(p,E.adler>>>16),X(p,65535&E.adler)),E.adler=1}if(p.status===69)if(p.gzhead.extra){for(g=p.pending;p.gzindex<(65535&p.gzhead.extra.length)&&(p.pending!==p.pending_buf_size||(p.gzhead.hcrc&&p.pending>g&&(E.adler=u(E.adler,p.pending_buf,p.pending-g,g)),G(E),g=p.pending,p.pending!==p.pending_buf_size));)$(p,255&p.gzhead.extra[p.gzindex]),p.gzindex++;p.gzhead.hcrc&&p.pending>g&&(E.adler=u(E.adler,p.pending_buf,p.pending-g,g)),p.gzindex===p.gzhead.extra.length&&(p.gzindex=0,p.status=73)}else p.status=73;if(p.status===73)if(p.gzhead.name){g=p.pending;do{if(p.pending===p.pending_buf_size&&(p.gzhead.hcrc&&p.pending>g&&(E.adler=u(E.adler,p.pending_buf,p.pending-g,g)),G(E),g=p.pending,p.pending===p.pending_buf_size)){S=1;break}S=p.gzindex<p.gzhead.name.length?255&p.gzhead.name.charCodeAt(p.gzindex++):0,$(p,S)}while(S!==0);p.gzhead.hcrc&&p.pending>g&&(E.adler=u(E.adler,p.pending_buf,p.pending-g,g)),S===0&&(p.gzindex=0,p.status=91)}else p.status=91;if(p.status===91)if(p.gzhead.comment){g=p.pending;do{if(p.pending===p.pending_buf_size&&(p.gzhead.hcrc&&p.pending>g&&(E.adler=u(E.adler,p.pending_buf,p.pending-g,g)),G(E),g=p.pending,p.pending===p.pending_buf_size)){S=1;break}S=p.gzindex<p.gzhead.comment.length?255&p.gzhead.comment.charCodeAt(p.gzindex++):0,$(p,S)}while(S!==0);p.gzhead.hcrc&&p.pending>g&&(E.adler=u(E.adler,p.pending_buf,p.pending-g,g)),S===0&&(p.status=103)}else p.status=103;if(p.status===103&&(p.gzhead.hcrc?(p.pending+2>p.pending_buf_size&&G(E),p.pending+2<=p.pending_buf_size&&($(p,255&E.adler),$(p,E.adler>>8&255),E.adler=0,p.status=H)):p.status=H),p.pending!==0){if(G(E),E.avail_out===0)return p.last_flush=-1,h}else if(E.avail_in===0&&ee(Y)<=ee(N)&&Y!==d)return ie(E,-5);if(p.status===666&&E.avail_in!==0)return ie(E,-5);if(E.avail_in!==0||p.lookahead!==0||Y!==f&&p.status!==666){var q=p.strategy===2?(function(z,ne){for(var ae;;){if(z.lookahead===0&&(K(z),z.lookahead===0)){if(ne===f)return k;break}if(z.match_length=0,ae=o._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,ae&&(D(z,!1),z.strm.avail_out===0))return k}return z.insert=0,ne===d?(D(z,!0),z.strm.avail_out===0?Q:j):z.last_lit&&(D(z,!1),z.strm.avail_out===0)?k:V})(p,Y):p.strategy===3?(function(z,ne){for(var ae,se,fe,pe,ve=z.window;;){if(z.lookahead<=J){if(K(z),z.lookahead<=J&&ne===f)return k;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=R&&0<z.strstart&&(se=ve[fe=z.strstart-1])===ve[++fe]&&se===ve[++fe]&&se===ve[++fe]){pe=z.strstart+J;do;while(se===ve[++fe]&&se===ve[++fe]&&se===ve[++fe]&&se===ve[++fe]&&se===ve[++fe]&&se===ve[++fe]&&se===ve[++fe]&&se===ve[++fe]&&fe<pe);z.match_length=J-(pe-fe),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=R?(ae=o._tr_tally(z,1,z.match_length-R),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(ae=o._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),ae&&(D(z,!1),z.strm.avail_out===0))return k}return z.insert=0,ne===d?(D(z,!0),z.strm.avail_out===0?Q:j):z.last_lit&&(D(z,!1),z.strm.avail_out===0)?k:V})(p,Y):s[p.level].func(p,Y);if(q!==Q&&q!==j||(p.status=666),q===k||q===Q)return E.avail_out===0&&(p.last_flush=-1),h;if(q===V&&(Y===1?o._tr_align(p):Y!==5&&(o._tr_stored_block(p,0,0,!1),Y===3&&(le(p.head),p.lookahead===0&&(p.strstart=0,p.block_start=0,p.insert=0))),G(E),E.avail_out===0))return p.last_flush=-1,h}return Y!==d?h:p.wrap<=0?1:(p.wrap===2?($(p,255&E.adler),$(p,E.adler>>8&255),$(p,E.adler>>16&255),$(p,E.adler>>24&255),$(p,255&E.total_in),$(p,E.total_in>>8&255),$(p,E.total_in>>16&255),$(p,E.total_in>>24&255)):(X(p,E.adler>>>16),X(p,65535&E.adler)),G(E),0<p.wrap&&(p.wrap=-p.wrap),p.pending!==0?h:1)},i.deflateEnd=function(E){var Y;return E&&E.state?(Y=E.state.status)!==C&&Y!==69&&Y!==73&&Y!==91&&Y!==103&&Y!==H&&Y!==666?ie(E,y):(E.state=null,Y===H?ie(E,-3):h):y},i.deflateSetDictionary=function(E,Y){var N,p,g,S,F,q,z,ne,ae=Y.length;if(!E||!E.state||(S=(N=E.state).wrap)===2||S===1&&N.status!==C||N.lookahead)return y;for(S===1&&(E.adler=l(E.adler,Y,ae,0)),N.wrap=0,ae>=N.w_size&&(S===0&&(le(N.head),N.strstart=0,N.block_start=0,N.insert=0),ne=new a.Buf8(N.w_size),a.arraySet(ne,Y,ae-N.w_size,N.w_size,0),Y=ne,ae=N.w_size),F=E.avail_in,q=E.next_in,z=E.input,E.avail_in=ae,E.next_in=0,E.input=Y,K(N);N.lookahead>=R;){for(p=N.strstart,g=N.lookahead-(R-1);N.ins_h=(N.ins_h<<N.hash_shift^N.window[p+R-1])&N.hash_mask,N.prev[p&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=p,p++,--g;);N.strstart=p,N.lookahead=R-1,K(N)}return N.strstart+=N.lookahead,N.block_start=N.strstart,N.insert=N.lookahead,N.lookahead=0,N.match_length=N.prev_length=R-1,N.match_available=0,E.next_in=q,E.input=z,E.avail_in=F,N.wrap=S,h},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,n,i){n.exports=function(s,a){var o,l,u,c,f,d,h,y,v,x,m,_,b,w,T,P,M,U,R,J,oe,C,H,k,V;o=s.state,l=s.next_in,k=s.input,u=l+(s.avail_in-5),c=s.next_out,V=s.output,f=c-(a-s.avail_out),d=c+(s.avail_out-257),h=o.dmax,y=o.wsize,v=o.whave,x=o.wnext,m=o.window,_=o.hold,b=o.bits,w=o.lencode,T=o.distcode,P=(1<<o.lenbits)-1,M=(1<<o.distbits)-1;e:do{b<15&&(_+=k[l++]<<b,b+=8,_+=k[l++]<<b,b+=8),U=w[_&P];t:for(;;){if(_>>>=R=U>>>24,b-=R,(R=U>>>16&255)===0)V[c++]=65535&U;else{if(!(16&R)){if((64&R)==0){U=w[(65535&U)+(_&(1<<R)-1)];continue t}if(32&R){o.mode=12;break e}s.msg="invalid literal/length code",o.mode=30;break e}J=65535&U,(R&=15)&&(b<R&&(_+=k[l++]<<b,b+=8),J+=_&(1<<R)-1,_>>>=R,b-=R),b<15&&(_+=k[l++]<<b,b+=8,_+=k[l++]<<b,b+=8),U=T[_&M];r:for(;;){if(_>>>=R=U>>>24,b-=R,!(16&(R=U>>>16&255))){if((64&R)==0){U=T[(65535&U)+(_&(1<<R)-1)];continue r}s.msg="invalid distance code",o.mode=30;break e}if(oe=65535&U,b<(R&=15)&&(_+=k[l++]<<b,(b+=8)<R&&(_+=k[l++]<<b,b+=8)),h<(oe+=_&(1<<R)-1)){s.msg="invalid distance too far back",o.mode=30;break e}if(_>>>=R,b-=R,(R=c-f)<oe){if(v<(R=oe-R)&&o.sane){s.msg="invalid distance too far back",o.mode=30;break e}if(H=m,(C=0)===x){if(C+=y-R,R<J){for(J-=R;V[c++]=m[C++],--R;);C=c-oe,H=V}}else if(x<R){if(C+=y+x-R,(R-=x)<J){for(J-=R;V[c++]=m[C++],--R;);if(C=0,x<J){for(J-=R=x;V[c++]=m[C++],--R;);C=c-oe,H=V}}}else if(C+=x-R,R<J){for(J-=R;V[c++]=m[C++],--R;);C=c-oe,H=V}for(;2<J;)V[c++]=H[C++],V[c++]=H[C++],V[c++]=H[C++],J-=3;J&&(V[c++]=H[C++],1<J&&(V[c++]=H[C++]))}else{for(C=c-oe;V[c++]=V[C++],V[c++]=V[C++],V[c++]=V[C++],2<(J-=3););J&&(V[c++]=V[C++],1<J&&(V[c++]=V[C++]))}break}}break}}while(l<u&&c<d);l-=J=b>>3,_&=(1<<(b-=J<<3))-1,s.next_in=l,s.next_out=c,s.avail_in=l<u?u-l+5:5-(l-u),s.avail_out=c<d?d-c+257:257-(c-d),o.hold=_,o.bits=b}},{}],49:[function(t,n,i){var s=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),l=t("./inffast"),u=t("./inftrees"),c=1,f=2,d=0,h=-2,y=1,v=852,x=592;function m(C){return(C>>>24&255)+(C>>>8&65280)+((65280&C)<<8)+((255&C)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(C){var H;return C&&C.state?(H=C.state,C.total_in=C.total_out=H.total=0,C.msg="",H.wrap&&(C.adler=1&H.wrap),H.mode=y,H.last=0,H.havedict=0,H.dmax=32768,H.head=null,H.hold=0,H.bits=0,H.lencode=H.lendyn=new s.Buf32(v),H.distcode=H.distdyn=new s.Buf32(x),H.sane=1,H.back=-1,d):h}function w(C){var H;return C&&C.state?((H=C.state).wsize=0,H.whave=0,H.wnext=0,b(C)):h}function T(C,H){var k,V;return C&&C.state?(V=C.state,H<0?(k=0,H=-H):(k=1+(H>>4),H<48&&(H&=15)),H&&(H<8||15<H)?h:(V.window!==null&&V.wbits!==H&&(V.window=null),V.wrap=k,V.wbits=H,w(C))):h}function P(C,H){var k,V;return C?(V=new _,(C.state=V).window=null,(k=T(C,H))!==d&&(C.state=null),k):h}var M,U,R=!0;function J(C){if(R){var H;for(M=new s.Buf32(512),U=new s.Buf32(32),H=0;H<144;)C.lens[H++]=8;for(;H<256;)C.lens[H++]=9;for(;H<280;)C.lens[H++]=7;for(;H<288;)C.lens[H++]=8;for(u(c,C.lens,0,288,M,0,C.work,{bits:9}),H=0;H<32;)C.lens[H++]=5;u(f,C.lens,0,32,U,0,C.work,{bits:5}),R=!1}C.lencode=M,C.lenbits=9,C.distcode=U,C.distbits=5}function oe(C,H,k,V){var Q,j=C.state;return j.window===null&&(j.wsize=1<<j.wbits,j.wnext=0,j.whave=0,j.window=new s.Buf8(j.wsize)),V>=j.wsize?(s.arraySet(j.window,H,k-j.wsize,j.wsize,0),j.wnext=0,j.whave=j.wsize):(V<(Q=j.wsize-j.wnext)&&(Q=V),s.arraySet(j.window,H,k-V,Q,j.wnext),(V-=Q)?(s.arraySet(j.window,H,k-V,V,0),j.wnext=V,j.whave=j.wsize):(j.wnext+=Q,j.wnext===j.wsize&&(j.wnext=0),j.whave<j.wsize&&(j.whave+=Q))),0}i.inflateReset=w,i.inflateReset2=T,i.inflateResetKeep=b,i.inflateInit=function(C){return P(C,15)},i.inflateInit2=P,i.inflate=function(C,H){var k,V,Q,j,ie,ee,le,G,D,$,X,re,K,O,A,W,B,I,L,Z,E,Y,N,p,g=0,S=new s.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!C||!C.state||!C.output||!C.input&&C.avail_in!==0)return h;(k=C.state).mode===12&&(k.mode=13),ie=C.next_out,Q=C.output,le=C.avail_out,j=C.next_in,V=C.input,ee=C.avail_in,G=k.hold,D=k.bits,$=ee,X=le,Y=d;e:for(;;)switch(k.mode){case y:if(k.wrap===0){k.mode=13;break}for(;D<16;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(2&k.wrap&&G===35615){S[k.check=0]=255&G,S[1]=G>>>8&255,k.check=o(k.check,S,2,0),D=G=0,k.mode=2;break}if(k.flags=0,k.head&&(k.head.done=!1),!(1&k.wrap)||(((255&G)<<8)+(G>>8))%31){C.msg="incorrect header check",k.mode=30;break}if((15&G)!=8){C.msg="unknown compression method",k.mode=30;break}if(D-=4,E=8+(15&(G>>>=4)),k.wbits===0)k.wbits=E;else if(E>k.wbits){C.msg="invalid window size",k.mode=30;break}k.dmax=1<<E,C.adler=k.check=1,k.mode=512&G?10:12,D=G=0;break;case 2:for(;D<16;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(k.flags=G,(255&k.flags)!=8){C.msg="unknown compression method",k.mode=30;break}if(57344&k.flags){C.msg="unknown header flags set",k.mode=30;break}k.head&&(k.head.text=G>>8&1),512&k.flags&&(S[0]=255&G,S[1]=G>>>8&255,k.check=o(k.check,S,2,0)),D=G=0,k.mode=3;case 3:for(;D<32;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}k.head&&(k.head.time=G),512&k.flags&&(S[0]=255&G,S[1]=G>>>8&255,S[2]=G>>>16&255,S[3]=G>>>24&255,k.check=o(k.check,S,4,0)),D=G=0,k.mode=4;case 4:for(;D<16;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}k.head&&(k.head.xflags=255&G,k.head.os=G>>8),512&k.flags&&(S[0]=255&G,S[1]=G>>>8&255,k.check=o(k.check,S,2,0)),D=G=0,k.mode=5;case 5:if(1024&k.flags){for(;D<16;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}k.length=G,k.head&&(k.head.extra_len=G),512&k.flags&&(S[0]=255&G,S[1]=G>>>8&255,k.check=o(k.check,S,2,0)),D=G=0}else k.head&&(k.head.extra=null);k.mode=6;case 6:if(1024&k.flags&&(ee<(re=k.length)&&(re=ee),re&&(k.head&&(E=k.head.extra_len-k.length,k.head.extra||(k.head.extra=new Array(k.head.extra_len)),s.arraySet(k.head.extra,V,j,re,E)),512&k.flags&&(k.check=o(k.check,V,re,j)),ee-=re,j+=re,k.length-=re),k.length))break e;k.length=0,k.mode=7;case 7:if(2048&k.flags){if(ee===0)break e;for(re=0;E=V[j+re++],k.head&&E&&k.length<65536&&(k.head.name+=String.fromCharCode(E)),E&&re<ee;);if(512&k.flags&&(k.check=o(k.check,V,re,j)),ee-=re,j+=re,E)break e}else k.head&&(k.head.name=null);k.length=0,k.mode=8;case 8:if(4096&k.flags){if(ee===0)break e;for(re=0;E=V[j+re++],k.head&&E&&k.length<65536&&(k.head.comment+=String.fromCharCode(E)),E&&re<ee;);if(512&k.flags&&(k.check=o(k.check,V,re,j)),ee-=re,j+=re,E)break e}else k.head&&(k.head.comment=null);k.mode=9;case 9:if(512&k.flags){for(;D<16;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(G!==(65535&k.check)){C.msg="header crc mismatch",k.mode=30;break}D=G=0}k.head&&(k.head.hcrc=k.flags>>9&1,k.head.done=!0),C.adler=k.check=0,k.mode=12;break;case 10:for(;D<32;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}C.adler=k.check=m(G),D=G=0,k.mode=11;case 11:if(k.havedict===0)return C.next_out=ie,C.avail_out=le,C.next_in=j,C.avail_in=ee,k.hold=G,k.bits=D,2;C.adler=k.check=1,k.mode=12;case 12:if(H===5||H===6)break e;case 13:if(k.last){G>>>=7&D,D-=7&D,k.mode=27;break}for(;D<3;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}switch(k.last=1&G,D-=1,3&(G>>>=1)){case 0:k.mode=14;break;case 1:if(J(k),k.mode=20,H!==6)break;G>>>=2,D-=2;break e;case 2:k.mode=17;break;case 3:C.msg="invalid block type",k.mode=30}G>>>=2,D-=2;break;case 14:for(G>>>=7&D,D-=7&D;D<32;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if((65535&G)!=(G>>>16^65535)){C.msg="invalid stored block lengths",k.mode=30;break}if(k.length=65535&G,D=G=0,k.mode=15,H===6)break e;case 15:k.mode=16;case 16:if(re=k.length){if(ee<re&&(re=ee),le<re&&(re=le),re===0)break e;s.arraySet(Q,V,j,re,ie),ee-=re,j+=re,le-=re,ie+=re,k.length-=re;break}k.mode=12;break;case 17:for(;D<14;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(k.nlen=257+(31&G),G>>>=5,D-=5,k.ndist=1+(31&G),G>>>=5,D-=5,k.ncode=4+(15&G),G>>>=4,D-=4,286<k.nlen||30<k.ndist){C.msg="too many length or distance symbols",k.mode=30;break}k.have=0,k.mode=18;case 18:for(;k.have<k.ncode;){for(;D<3;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}k.lens[F[k.have++]]=7&G,G>>>=3,D-=3}for(;k.have<19;)k.lens[F[k.have++]]=0;if(k.lencode=k.lendyn,k.lenbits=7,N={bits:k.lenbits},Y=u(0,k.lens,0,19,k.lencode,0,k.work,N),k.lenbits=N.bits,Y){C.msg="invalid code lengths set",k.mode=30;break}k.have=0,k.mode=19;case 19:for(;k.have<k.nlen+k.ndist;){for(;W=(g=k.lencode[G&(1<<k.lenbits)-1])>>>16&255,B=65535&g,!((A=g>>>24)<=D);){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(B<16)G>>>=A,D-=A,k.lens[k.have++]=B;else{if(B===16){for(p=A+2;D<p;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(G>>>=A,D-=A,k.have===0){C.msg="invalid bit length repeat",k.mode=30;break}E=k.lens[k.have-1],re=3+(3&G),G>>>=2,D-=2}else if(B===17){for(p=A+3;D<p;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}D-=A,E=0,re=3+(7&(G>>>=A)),G>>>=3,D-=3}else{for(p=A+7;D<p;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}D-=A,E=0,re=11+(127&(G>>>=A)),G>>>=7,D-=7}if(k.have+re>k.nlen+k.ndist){C.msg="invalid bit length repeat",k.mode=30;break}for(;re--;)k.lens[k.have++]=E}}if(k.mode===30)break;if(k.lens[256]===0){C.msg="invalid code -- missing end-of-block",k.mode=30;break}if(k.lenbits=9,N={bits:k.lenbits},Y=u(c,k.lens,0,k.nlen,k.lencode,0,k.work,N),k.lenbits=N.bits,Y){C.msg="invalid literal/lengths set",k.mode=30;break}if(k.distbits=6,k.distcode=k.distdyn,N={bits:k.distbits},Y=u(f,k.lens,k.nlen,k.ndist,k.distcode,0,k.work,N),k.distbits=N.bits,Y){C.msg="invalid distances set",k.mode=30;break}if(k.mode=20,H===6)break e;case 20:k.mode=21;case 21:if(6<=ee&&258<=le){C.next_out=ie,C.avail_out=le,C.next_in=j,C.avail_in=ee,k.hold=G,k.bits=D,l(C,X),ie=C.next_out,Q=C.output,le=C.avail_out,j=C.next_in,V=C.input,ee=C.avail_in,G=k.hold,D=k.bits,k.mode===12&&(k.back=-1);break}for(k.back=0;W=(g=k.lencode[G&(1<<k.lenbits)-1])>>>16&255,B=65535&g,!((A=g>>>24)<=D);){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(W&&(240&W)==0){for(I=A,L=W,Z=B;W=(g=k.lencode[Z+((G&(1<<I+L)-1)>>I)])>>>16&255,B=65535&g,!(I+(A=g>>>24)<=D);){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}G>>>=I,D-=I,k.back+=I}if(G>>>=A,D-=A,k.back+=A,k.length=B,W===0){k.mode=26;break}if(32&W){k.back=-1,k.mode=12;break}if(64&W){C.msg="invalid literal/length code",k.mode=30;break}k.extra=15&W,k.mode=22;case 22:if(k.extra){for(p=k.extra;D<p;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}k.length+=G&(1<<k.extra)-1,G>>>=k.extra,D-=k.extra,k.back+=k.extra}k.was=k.length,k.mode=23;case 23:for(;W=(g=k.distcode[G&(1<<k.distbits)-1])>>>16&255,B=65535&g,!((A=g>>>24)<=D);){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if((240&W)==0){for(I=A,L=W,Z=B;W=(g=k.distcode[Z+((G&(1<<I+L)-1)>>I)])>>>16&255,B=65535&g,!(I+(A=g>>>24)<=D);){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}G>>>=I,D-=I,k.back+=I}if(G>>>=A,D-=A,k.back+=A,64&W){C.msg="invalid distance code",k.mode=30;break}k.offset=B,k.extra=15&W,k.mode=24;case 24:if(k.extra){for(p=k.extra;D<p;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}k.offset+=G&(1<<k.extra)-1,G>>>=k.extra,D-=k.extra,k.back+=k.extra}if(k.offset>k.dmax){C.msg="invalid distance too far back",k.mode=30;break}k.mode=25;case 25:if(le===0)break e;if(re=X-le,k.offset>re){if((re=k.offset-re)>k.whave&&k.sane){C.msg="invalid distance too far back",k.mode=30;break}K=re>k.wnext?(re-=k.wnext,k.wsize-re):k.wnext-re,re>k.length&&(re=k.length),O=k.window}else O=Q,K=ie-k.offset,re=k.length;for(le<re&&(re=le),le-=re,k.length-=re;Q[ie++]=O[K++],--re;);k.length===0&&(k.mode=21);break;case 26:if(le===0)break e;Q[ie++]=k.length,le--,k.mode=21;break;case 27:if(k.wrap){for(;D<32;){if(ee===0)break e;ee--,G|=V[j++]<<D,D+=8}if(X-=le,C.total_out+=X,k.total+=X,X&&(C.adler=k.check=k.flags?o(k.check,Q,X,ie-X):a(k.check,Q,X,ie-X)),X=le,(k.flags?G:m(G))!==k.check){C.msg="incorrect data check",k.mode=30;break}D=G=0}k.mode=28;case 28:if(k.wrap&&k.flags){for(;D<32;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(G!==(4294967295&k.total)){C.msg="incorrect length check",k.mode=30;break}D=G=0}k.mode=29;case 29:Y=1;break e;case 30:Y=-3;break e;case 31:return-4;case 32:default:return h}return C.next_out=ie,C.avail_out=le,C.next_in=j,C.avail_in=ee,k.hold=G,k.bits=D,(k.wsize||X!==C.avail_out&&k.mode<30&&(k.mode<27||H!==4))&&oe(C,C.output,C.next_out,X-C.avail_out)?(k.mode=31,-4):($-=C.avail_in,X-=C.avail_out,C.total_in+=$,C.total_out+=X,k.total+=X,k.wrap&&X&&(C.adler=k.check=k.flags?o(k.check,Q,X,C.next_out-X):a(k.check,Q,X,C.next_out-X)),C.data_type=k.bits+(k.last?64:0)+(k.mode===12?128:0)+(k.mode===20||k.mode===15?256:0),($==0&&X===0||H===4)&&Y===d&&(Y=-5),Y)},i.inflateEnd=function(C){if(!C||!C.state)return h;var H=C.state;return H.window&&(H.window=null),C.state=null,d},i.inflateGetHeader=function(C,H){var k;return C&&C.state?(2&(k=C.state).wrap)==0?h:((k.head=H).done=!1,d):h},i.inflateSetDictionary=function(C,H){var k,V=H.length;return C&&C.state?(k=C.state).wrap!==0&&k.mode!==11?h:k.mode===11&&a(1,H,V,0)!==k.check?-3:oe(C,H,V,V)?(k.mode=31,-4):(k.havedict=1,d):h},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,n,i){var s=t("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(c,f,d,h,y,v,x,m){var _,b,w,T,P,M,U,R,J,oe=m.bits,C=0,H=0,k=0,V=0,Q=0,j=0,ie=0,ee=0,le=0,G=0,D=null,$=0,X=new s.Buf16(16),re=new s.Buf16(16),K=null,O=0;for(C=0;C<=15;C++)X[C]=0;for(H=0;H<h;H++)X[f[d+H]]++;for(Q=oe,V=15;1<=V&&X[V]===0;V--);if(V<Q&&(Q=V),V===0)return y[v++]=20971520,y[v++]=20971520,m.bits=1,0;for(k=1;k<V&&X[k]===0;k++);for(Q<k&&(Q=k),C=ee=1;C<=15;C++)if(ee<<=1,(ee-=X[C])<0)return-1;if(0<ee&&(c===0||V!==1))return-1;for(re[1]=0,C=1;C<15;C++)re[C+1]=re[C]+X[C];for(H=0;H<h;H++)f[d+H]!==0&&(x[re[f[d+H]]++]=H);if(M=c===0?(D=K=x,19):c===1?(D=a,$-=257,K=o,O-=257,256):(D=l,K=u,-1),C=k,P=v,ie=H=G=0,w=-1,T=(le=1<<(j=Q))-1,c===1&&852<le||c===2&&592<le)return 1;for(;;){for(U=C-ie,J=x[H]<M?(R=0,x[H]):x[H]>M?(R=K[O+x[H]],D[$+x[H]]):(R=96,0),_=1<<C-ie,k=b=1<<j;y[P+(G>>ie)+(b-=_)]=U<<24|R<<16|J|0,b!==0;);for(_=1<<C-1;G&_;)_>>=1;if(_!==0?(G&=_-1,G+=_):G=0,H++,--X[C]==0){if(C===V)break;C=f[d+x[H]]}if(Q<C&&(G&T)!==w){for(ie===0&&(ie=Q),P+=k,ee=1<<(j=C-ie);j+ie<V&&!((ee-=X[j+ie])<=0);)j++,ee<<=1;if(le+=1<<j,c===1&&852<le||c===2&&592<le)return 1;y[w=G&T]=Q<<24|j<<16|P-v|0}}return G!==0&&(y[P+G]=C-ie<<24|64<<16|0),m.bits=Q,0}},{"../utils/common":41}],51:[function(t,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,n,i){var s=t("../utils/common"),a=0,o=1;function l(g){for(var S=g.length;0<=--S;)g[S]=0}var u=0,c=29,f=256,d=f+1+c,h=30,y=19,v=2*d+1,x=15,m=16,_=7,b=256,w=16,T=17,P=18,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],U=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=new Array(2*(d+2));l(oe);var C=new Array(2*h);l(C);var H=new Array(512);l(H);var k=new Array(256);l(k);var V=new Array(c);l(V);var Q,j,ie,ee=new Array(h);function le(g,S,F,q,z){this.static_tree=g,this.extra_bits=S,this.extra_base=F,this.elems=q,this.max_length=z,this.has_stree=g&&g.length}function G(g,S){this.dyn_tree=g,this.max_code=0,this.stat_desc=S}function D(g){return g<256?H[g]:H[256+(g>>>7)]}function $(g,S){g.pending_buf[g.pending++]=255&S,g.pending_buf[g.pending++]=S>>>8&255}function X(g,S,F){g.bi_valid>m-F?(g.bi_buf|=S<<g.bi_valid&65535,$(g,g.bi_buf),g.bi_buf=S>>m-g.bi_valid,g.bi_valid+=F-m):(g.bi_buf|=S<<g.bi_valid&65535,g.bi_valid+=F)}function re(g,S,F){X(g,F[2*S],F[2*S+1])}function K(g,S){for(var F=0;F|=1&g,g>>>=1,F<<=1,0<--S;);return F>>>1}function O(g,S,F){var q,z,ne=new Array(x+1),ae=0;for(q=1;q<=x;q++)ne[q]=ae=ae+F[q-1]<<1;for(z=0;z<=S;z++){var se=g[2*z+1];se!==0&&(g[2*z]=K(ne[se]++,se))}}function A(g){var S;for(S=0;S<d;S++)g.dyn_ltree[2*S]=0;for(S=0;S<h;S++)g.dyn_dtree[2*S]=0;for(S=0;S<y;S++)g.bl_tree[2*S]=0;g.dyn_ltree[2*b]=1,g.opt_len=g.static_len=0,g.last_lit=g.matches=0}function W(g){8<g.bi_valid?$(g,g.bi_buf):0<g.bi_valid&&(g.pending_buf[g.pending++]=g.bi_buf),g.bi_buf=0,g.bi_valid=0}function B(g,S,F,q){var z=2*S,ne=2*F;return g[z]<g[ne]||g[z]===g[ne]&&q[S]<=q[F]}function I(g,S,F){for(var q=g.heap[F],z=F<<1;z<=g.heap_len&&(z<g.heap_len&&B(S,g.heap[z+1],g.heap[z],g.depth)&&z++,!B(S,q,g.heap[z],g.depth));)g.heap[F]=g.heap[z],F=z,z<<=1;g.heap[F]=q}function L(g,S,F){var q,z,ne,ae,se=0;if(g.last_lit!==0)for(;q=g.pending_buf[g.d_buf+2*se]<<8|g.pending_buf[g.d_buf+2*se+1],z=g.pending_buf[g.l_buf+se],se++,q===0?re(g,z,S):(re(g,(ne=k[z])+f+1,S),(ae=M[ne])!==0&&X(g,z-=V[ne],ae),re(g,ne=D(--q),F),(ae=U[ne])!==0&&X(g,q-=ee[ne],ae)),se<g.last_lit;);re(g,b,S)}function Z(g,S){var F,q,z,ne=S.dyn_tree,ae=S.stat_desc.static_tree,se=S.stat_desc.has_stree,fe=S.stat_desc.elems,pe=-1;for(g.heap_len=0,g.heap_max=v,F=0;F<fe;F++)ne[2*F]!==0?(g.heap[++g.heap_len]=pe=F,g.depth[F]=0):ne[2*F+1]=0;for(;g.heap_len<2;)ne[2*(z=g.heap[++g.heap_len]=pe<2?++pe:0)]=1,g.depth[z]=0,g.opt_len--,se&&(g.static_len-=ae[2*z+1]);for(S.max_code=pe,F=g.heap_len>>1;1<=F;F--)I(g,ne,F);for(z=fe;F=g.heap[1],g.heap[1]=g.heap[g.heap_len--],I(g,ne,1),q=g.heap[1],g.heap[--g.heap_max]=F,g.heap[--g.heap_max]=q,ne[2*z]=ne[2*F]+ne[2*q],g.depth[z]=(g.depth[F]>=g.depth[q]?g.depth[F]:g.depth[q])+1,ne[2*F+1]=ne[2*q+1]=z,g.heap[1]=z++,I(g,ne,1),2<=g.heap_len;);g.heap[--g.heap_max]=g.heap[1],(function(ve,Me){var yt,tt,fr,Oe,ln,li,ct=Me.dyn_tree,wo=Me.max_code,Nd=Me.stat_desc.static_tree,Rd=Me.stat_desc.has_stree,Cd=Me.stat_desc.extra_bits,bo=Me.stat_desc.extra_base,hr=Me.stat_desc.max_length,un=0;for(Oe=0;Oe<=x;Oe++)ve.bl_count[Oe]=0;for(ct[2*ve.heap[ve.heap_max]+1]=0,yt=ve.heap_max+1;yt<v;yt++)hr<(Oe=ct[2*ct[2*(tt=ve.heap[yt])+1]+1]+1)&&(Oe=hr,un++),ct[2*tt+1]=Oe,wo<tt||(ve.bl_count[Oe]++,ln=0,bo<=tt&&(ln=Cd[tt-bo]),li=ct[2*tt],ve.opt_len+=li*(Oe+ln),Rd&&(ve.static_len+=li*(Nd[2*tt+1]+ln)));if(un!==0){do{for(Oe=hr-1;ve.bl_count[Oe]===0;)Oe--;ve.bl_count[Oe]--,ve.bl_count[Oe+1]+=2,ve.bl_count[hr]--,un-=2}while(0<un);for(Oe=hr;Oe!==0;Oe--)for(tt=ve.bl_count[Oe];tt!==0;)wo<(fr=ve.heap[--yt])||(ct[2*fr+1]!==Oe&&(ve.opt_len+=(Oe-ct[2*fr+1])*ct[2*fr],ct[2*fr+1]=Oe),tt--)}})(g,S),O(ne,pe,g.bl_count)}function E(g,S,F){var q,z,ne=-1,ae=S[1],se=0,fe=7,pe=4;for(ae===0&&(fe=138,pe=3),S[2*(F+1)+1]=65535,q=0;q<=F;q++)z=ae,ae=S[2*(q+1)+1],++se<fe&&z===ae||(se<pe?g.bl_tree[2*z]+=se:z!==0?(z!==ne&&g.bl_tree[2*z]++,g.bl_tree[2*w]++):se<=10?g.bl_tree[2*T]++:g.bl_tree[2*P]++,ne=z,pe=(se=0)===ae?(fe=138,3):z===ae?(fe=6,3):(fe=7,4))}function Y(g,S,F){var q,z,ne=-1,ae=S[1],se=0,fe=7,pe=4;for(ae===0&&(fe=138,pe=3),q=0;q<=F;q++)if(z=ae,ae=S[2*(q+1)+1],!(++se<fe&&z===ae)){if(se<pe)for(;re(g,z,g.bl_tree),--se!=0;);else z!==0?(z!==ne&&(re(g,z,g.bl_tree),se--),re(g,w,g.bl_tree),X(g,se-3,2)):se<=10?(re(g,T,g.bl_tree),X(g,se-3,3)):(re(g,P,g.bl_tree),X(g,se-11,7));ne=z,pe=(se=0)===ae?(fe=138,3):z===ae?(fe=6,3):(fe=7,4)}}l(ee);var N=!1;function p(g,S,F,q){X(g,(u<<1)+(q?1:0),3),(function(z,ne,ae,se){W(z),$(z,ae),$(z,~ae),s.arraySet(z.pending_buf,z.window,ne,ae,z.pending),z.pending+=ae})(g,S,F)}i._tr_init=function(g){N||((function(){var S,F,q,z,ne,ae=new Array(x+1);for(z=q=0;z<c-1;z++)for(V[z]=q,S=0;S<1<<M[z];S++)k[q++]=z;for(k[q-1]=z,z=ne=0;z<16;z++)for(ee[z]=ne,S=0;S<1<<U[z];S++)H[ne++]=z;for(ne>>=7;z<h;z++)for(ee[z]=ne<<7,S=0;S<1<<U[z]-7;S++)H[256+ne++]=z;for(F=0;F<=x;F++)ae[F]=0;for(S=0;S<=143;)oe[2*S+1]=8,S++,ae[8]++;for(;S<=255;)oe[2*S+1]=9,S++,ae[9]++;for(;S<=279;)oe[2*S+1]=7,S++,ae[7]++;for(;S<=287;)oe[2*S+1]=8,S++,ae[8]++;for(O(oe,d+1,ae),S=0;S<h;S++)C[2*S+1]=5,C[2*S]=K(S,5);Q=new le(oe,M,f+1,d,x),j=new le(C,U,0,h,x),ie=new le(new Array(0),R,0,y,_)})(),N=!0),g.l_desc=new G(g.dyn_ltree,Q),g.d_desc=new G(g.dyn_dtree,j),g.bl_desc=new G(g.bl_tree,ie),g.bi_buf=0,g.bi_valid=0,A(g)},i._tr_stored_block=p,i._tr_flush_block=function(g,S,F,q){var z,ne,ae=0;0<g.level?(g.strm.data_type===2&&(g.strm.data_type=(function(se){var fe,pe=4093624447;for(fe=0;fe<=31;fe++,pe>>>=1)if(1&pe&&se.dyn_ltree[2*fe]!==0)return a;if(se.dyn_ltree[18]!==0||se.dyn_ltree[20]!==0||se.dyn_ltree[26]!==0)return o;for(fe=32;fe<f;fe++)if(se.dyn_ltree[2*fe]!==0)return o;return a})(g)),Z(g,g.l_desc),Z(g,g.d_desc),ae=(function(se){var fe;for(E(se,se.dyn_ltree,se.l_desc.max_code),E(se,se.dyn_dtree,se.d_desc.max_code),Z(se,se.bl_desc),fe=y-1;3<=fe&&se.bl_tree[2*J[fe]+1]===0;fe--);return se.opt_len+=3*(fe+1)+5+5+4,fe})(g),z=g.opt_len+3+7>>>3,(ne=g.static_len+3+7>>>3)<=z&&(z=ne)):z=ne=F+5,F+4<=z&&S!==-1?p(g,S,F,q):g.strategy===4||ne===z?(X(g,2+(q?1:0),3),L(g,oe,C)):(X(g,4+(q?1:0),3),(function(se,fe,pe,ve){var Me;for(X(se,fe-257,5),X(se,pe-1,5),X(se,ve-4,4),Me=0;Me<ve;Me++)X(se,se.bl_tree[2*J[Me]+1],3);Y(se,se.dyn_ltree,fe-1),Y(se,se.dyn_dtree,pe-1)})(g,g.l_desc.max_code+1,g.d_desc.max_code+1,ae+1),L(g,g.dyn_ltree,g.dyn_dtree)),A(g),q&&W(g)},i._tr_tally=function(g,S,F){return g.pending_buf[g.d_buf+2*g.last_lit]=S>>>8&255,g.pending_buf[g.d_buf+2*g.last_lit+1]=255&S,g.pending_buf[g.l_buf+g.last_lit]=255&F,g.last_lit++,S===0?g.dyn_ltree[2*F]++:(g.matches++,S--,g.dyn_ltree[2*(k[F]+f+1)]++,g.dyn_dtree[2*D(S)]++),g.last_lit===g.lit_bufsize-1},i._tr_align=function(g){X(g,2,3),re(g,b,oe),(function(S){S.bi_valid===16?($(S,S.bi_buf),S.bi_buf=0,S.bi_valid=0):8<=S.bi_valid&&(S.pending_buf[S.pending++]=255&S.bi_buf,S.bi_buf>>=8,S.bi_valid-=8)})(g)}},{"../utils/common":41}],53:[function(t,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,n,i){(function(s){(function(a,o){if(!a.setImmediate){var l,u,c,f,d=1,h={},y=!1,v=a.document,x=Object.getPrototypeOf&&Object.getPrototypeOf(a);x=x&&x.setTimeout?x:a,l={}.toString.call(a.process)==="[object process]"?function(w){Ce.nextTick(function(){_(w)})}:(function(){if(a.postMessage&&!a.importScripts){var w=!0,T=a.onmessage;return a.onmessage=function(){w=!1},a.postMessage("","*"),a.onmessage=T,w}})()?(f="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",b,!1):a.attachEvent("onmessage",b),function(w){a.postMessage(f+w,"*")}):a.MessageChannel?((c=new MessageChannel).port1.onmessage=function(w){_(w.data)},function(w){c.port2.postMessage(w)}):v&&"onreadystatechange"in v.createElement("script")?(u=v.documentElement,function(w){var T=v.createElement("script");T.onreadystatechange=function(){_(w),T.onreadystatechange=null,u.removeChild(T),T=null},u.appendChild(T)}):function(w){setTimeout(_,0,w)},x.setImmediate=function(w){typeof w!="function"&&(w=new Function(""+w));for(var T=new Array(arguments.length-1),P=0;P<T.length;P++)T[P]=arguments[P+1];var M={callback:w,args:T};return h[d]=M,l(d),d++},x.clearImmediate=m}function m(w){delete h[w]}function _(w){if(y)setTimeout(_,0,w);else{var T=h[w];if(T){y=!0;try{(function(P){var M=P.callback,U=P.args;switch(U.length){case 0:M();break;case 1:M(U[0]);break;case 2:M(U[0],U[1]);break;case 3:M(U[0],U[1],U[2]);break;default:M.apply(o,U)}})(T)}finally{m(w),y=!1}}}}function b(w){w.source===a&&typeof w.data=="string"&&w.data.indexOf(f)===0&&_(+w.data.slice(f.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof qr<"u"?qr:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(vy)),vy.exports}function _J(){if(B2)return yy;B2=1;var r={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function e(t){return t&&t.replace?t.replace(/([&"<>'])/g,function(n,i){return r[i]}):t}return yy=e,yy}function xJ(){if(U2)return Sa.exports;U2=1;var r=_J(),e=h1().Stream,t="    ";function n(u,c){typeof c!="object"&&(c={indent:c});var f=c.stream?new e:null,d="",h=!1,y=c.indent?c.indent===!0?t:c.indent:"",v=!0;function x(T){v?Ce.nextTick(T):T()}function m(T,P){if(P!==void 0&&(d+=P),T&&!h&&(f=f||new e,h=!0),T&&h){var M=d;x(function(){f.emit("data",M)}),d=""}}function _(T,P){o(m,a(T,y,y?1:0),P)}function b(){if(f){var T=d;x(function(){f.emit("data",T),f.emit("end"),f.readable=!1,f.emit("close")})}}function w(T){var P=T.encoding||"UTF-8",M={version:"1.0",encoding:P};T.standalone&&(M.standalone=T.standalone),_({"?xml":{_attr:M}}),d=d.replace("/>","?>")}return x(function(){v=!1}),c.declaration&&w(c.declaration),u&&u.forEach?u.forEach(function(T,P){var M;P+1===u.length&&(M=b),_(T,M)}):_(u,b),f?(f.readable=!0,f):d}function i(){var u=Array.prototype.slice.call(arguments),c={_elem:a(u)};return c.push=function(f){if(!this.append)throw new Error("not assigned to a parent!");var d=this,h=this._elem.indent;o(this.append,a(f,h,this._elem.icount+(h?1:0)),function(){d.append(!0)})},c.close=function(f){f!==void 0&&this.push(f),this.end&&this.end()},c}function s(u,c){return new Array(c||0).join(u||"")}function a(u,c,f){f=f||0;var d=s(c,f),h,y=u,v=!1;if(typeof u=="object"){var x=Object.keys(u);if(h=x[0],y=u[h],y&&y._elem)return y._elem.name=h,y._elem.icount=f,y._elem.indent=c,y._elem.indents=d,y._elem.interrupt=y,y._elem}var m=[],_=[],b;function w(T){var P=Object.keys(T);P.forEach(function(M){m.push(l(M,T[M]))})}switch(typeof y){case"object":if(y===null)break;y._attr&&w(y._attr),y._cdata&&_.push(("<![CDATA["+y._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),y.forEach&&(b=!1,_.push(""),y.forEach(function(T){if(typeof T=="object"){var P=Object.keys(T)[0];P=="_attr"?w(T._attr):_.push(a(T,c,f+1))}else _.pop(),b=!0,_.push(r(T))}),b||_.push(""));break;default:_.push(r(y))}return{name:h,interrupt:v,attributes:m,content:_,icount:f,indents:d,indent:c}}function o(u,c,f){if(typeof c!="object")return u(!1,c);var d=c.interrupt?1:c.content.length;function h(){for(;c.content.length;){var v=c.content.shift();if(v!==void 0){if(y(v))return;o(u,v)}}u(!1,(d>1?c.indents:"")+(c.name?"</"+c.name+">":"")+(c.indent&&!f?`
`:"")),f&&f()}function y(v){return v.interrupt?(v.interrupt.append=u,v.interrupt.end=h,v.interrupt=!1,u(!0),!0):!1}if(u(!1,c.indents+(c.name?"<"+c.name:"")+(c.attributes.length?" "+c.attributes.join(" "):"")+(d?c.name?">":"":c.name?"/>":"")+(c.indent&&d>1?`
`:"")),!d)return u(!1,c.indent?`
`:"");y(c)||h()}function l(u,c){return u+'="'+r(c)+'"'}return Sa.exports=n,Sa.exports.element=Sa.exports.Element=i,Sa.exports}var pG,mG,gG,WD,vG,yG,by,Re,Tn,de,wG,Hs,bG,he,_r,be,xr,$e,qr,Lg,Bc,qD,Uc,VD,z2,st,jr,Wr,xn,Bs,Ri,Gc,SG,Ce,Fg,KD,Bg,_a,GD,Hc,$D,JD,Ug,Hg,zg,XD,jg,YD,Wg,ZD,qg,QD,Vg,eM,Kg,tM,Gg,rM,$g,nM,Jg,iM,Xg,sM,Yg,oM,Zg,aM,Qg,lM,ev,uM,tv,cM,rv,fM,nv,hM,iv,dM,sv,pM,ov,mM,av,gM,lv,vM,uv,yM,cv,wM,fv,bM,hv,_M,dv,xM,pv,EM,mv,SM,gv,kM,vv,TM,yv,AM,wv,OM,bv,NM,_v,RM,xv,Ev,CM,Sv,IM,kv,PM,DM,Tv,MM,Av,LM,Ov,FM,Nv,BM,Rv,UM,Cv,HM,Iv,zM,Pv,jM,Dv,WM,qM,Mv,VM,KM,Lv,GM,Fv,$M,Bv,JM,Uv,XM,Hv,YM,zv,ZM,jv,QM,Wv,zc,e2,t2,qv,r2,Vv,n2,Kv,i2,Gv,s2,$v,o2,Jv,a2,Xv,l2,Yv,u2,c2,Zv,f2,Qv,h2,ey,d2,ty,p2,ry,m2,ny,g2,iy,v2,u5,m1,Sy,ky,Ty,$c,Ct,_f,c5,y2,g1,f5,js,En,y$,St,w$,h5,b$,_$,x$,ge,Ta,kn,xa,Di,Ay,_n,Fe,mt,Oy,Jc,ze,Ny,v1,Ry,Cy,Iy,E$,y1,Ca,Ci,Ii,Pi,Mi,An,Py,Dy,My,Ly,Fy,Ws,d5,By,S$,Uy,Hy,zy,jy,Wy,qy,k$,Xc,Aa,p5,Vy,Ky,m5,Gy,On,$y,Yc,jc,Nn,et,sy,je,oy,w2,b2,ay,_2,Oi,zr,x2,ly,E2,uy,S2,cy,k2,fy,T2,hy,A2,O2,dy,N2,py,R2,C2,P$,D$,M$,L$,F$,Kt,xf,B$,U$,H$,z$,w5,I2,Ea,j$,W$,q$,V$,b5,_5,K$,G$,Jy,$$,J$,X$,Y$,Xy,Yy,Zy,Qy,ew,tw,rw,x5,nw,iw,sw,ow,aw,lw,uw,cw,fw,hw,E5,Z$,Q$,P2,eJ,dw,pw,mw,gw,vw,yw,ww,bw,Zc,Wc,tJ,Qc,_w,xw,Ew,Sw,kw,Tw,ef,S5,k5,Aw,Ow,T5,Nw,Rw,rJ,Cw,nJ,iJ,my,Ia,Iw,tf,Pw,Pa,Dw,Mw,sJ,Lw,Rn,Fw,Bw,Uw,Hw,zw,jw,Ww,qw,er,qc,Vw,Li,Ka,Kw,Gw,Oa,$w,Jw,rf,Xw,qs,Da,Vs,Yw,Zw,Ma,Qw,e0,t0,oJ,Bee,r0,nf,n0,aJ,Us,i0,D2,Na,lJ,sf,s0,o0,a0,l0,u0,uJ,c0,f0,w1,h0,d0,Ni,gy,p0,m0,M2,Ks,g0,v0,y0,of,w0,b0,cJ,Qn,$t,Ga,_0,Fi,x0,E0,A5,af,S0,Sn,k0,T0,A0,O5,O0,lf,N0,R0,C0,Bi,Ms,Ls,uf,I0,P0,D0,fJ,cf,M0,La,L0,F0,B0,Fa,U0,H0,z0,j0,br,W0,Vt,q0,V0,K0,ff,G0,$0,J0,X0,Y0,Vc,hJ,dJ,pJ,Z0,Q0,mJ,eb,tb,rb,nb,L2,Ra,ib,sb,ob,ab,lb,ub,cb,fb,gJ,hb,db,Gt,pb,mb,gb,vb,yb,wb,bb,_b,xb,Eb,hf,Sb,kb,df,Tb,Ab,Ob,Nb,Rb,Cb,Ib,Pb,Db,Mb,pf,Lb,Fb,Bb,mf,Gs,$s,Vr,Ub,Hb,zb,jb,Wb,qb,Vb,Kb,Gb,$b,Jb,Xb,Yb,Ba,Zb,Qb,e1,t1,gf,vf,r1,n1,Ua,vJ,vy,F2,wJ,bJ,Sa,yy,B2,U2,EJ,Qe,ka,wy,SJ,kJ,Ha,yf,i1,s1,TJ,H2,N5,R5,jee,Wee,qee,Vee,Kee,$a=jt(()=>{pG=Object.defineProperty,mG=Object.defineProperties,gG=Object.getOwnPropertyDescriptors,WD=Object.getOwnPropertySymbols,vG=Object.prototype.hasOwnProperty,yG=Object.prototype.propertyIsEnumerable,by=(r,e,t)=>e in r?pG(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Re=(r,e)=>{for(var t in e||(e={}))vG.call(e,t)&&by(r,t,e[t]);if(WD)for(var t of WD(e))yG.call(e,t)&&by(r,t,e[t]);return r},Tn=(r,e)=>mG(r,gG(e)),de=(r,e,t)=>by(r,typeof e!="symbol"?e+"":e,t),wG=(r,e,t)=>new Promise((n,i)=>{var s=l=>{try{o(t.next(l))}catch(u){i(u)}},a=l=>{try{o(t.throw(l))}catch(u){i(u)}},o=l=>l.done?n(l.value):Promise.resolve(l.value).then(s,a);o((t=t.apply(r,e)).next())}),Hs=class{constructor(e){de(this,"rootKey"),this.rootKey=e}},bG=Object.seal({}),he=class extends Hs{constructor(e){super(e),de(this,"root"),this.root=new Array}prepForXml(e){var t;e.stack.push(this);let n=this.root.map(i=>i instanceof Hs?i.prepForXml(e):i).filter(i=>i!==void 0);return e.stack.pop(),{[this.rootKey]:n.length?n.length===1&&((t=n[0])!=null&&t._attr)?n[0]:n:bG}}addChildElement(e){return this.root.push(e),this}},_r=class extends he{prepForXml(e){let t=super.prepForXml(e);if(t&&(typeof t[this.rootKey]!="object"||Object.keys(t[this.rootKey]).length))return t}},be=class extends Hs{constructor(e){super("_attr"),de(this,"xmlKeys"),this.root=e}prepForXml(e){let t={};return Object.entries(this.root).forEach(([n,i])=>{if(i!==void 0){let s=this.xmlKeys&&this.xmlKeys[n]||n;t[s]=i}}),{_attr:t}}},xr=class extends Hs{constructor(e){super("_attr"),this.root=e}prepForXml(e){return{_attr:Object.values(this.root).filter(({value:n})=>n!==void 0).reduce((n,{key:i,value:s})=>Tn(Re({},n),{[i]:s}),{})}}},$e=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}},qr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};Lg={},Bc={exports:{}};Uc={exports:{}};z2={exports:{}},st=z2.exports={};(function(){try{typeof setTimeout=="function"?jr=setTimeout:jr=_y}catch{jr=_y}try{typeof clearTimeout=="function"?Wr=clearTimeout:Wr=xy}catch{Wr=xy}})();xn=[],Bs=!1,Gc=-1;st.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];xn.push(new q2(r,e)),xn.length===1&&!Bs&&j2(W2)};q2.prototype.run=function(){this.fun.apply(null,this.array)};st.title="browser";st.browser=!0;st.env={};st.argv=[];st.version="";st.versions={};st.on=Cn;st.addListener=Cn;st.once=Cn;st.off=Cn;st.removeListener=Cn;st.removeAllListeners=Cn;st.emit=Cn;st.prependListener=Cn;st.prependOnceListener=Cn;st.listeners=function(r){return[]};st.binding=function(r){throw new Error("process.binding is not supported")};st.cwd=function(){return"/"};st.chdir=function(r){throw new Error("process.chdir is not supported")};st.umask=function(){return 0};SG=z2.exports,Ce=_G(SG);Bg={},_a={};Hc={};Ug={},Hg={};xv={exports:{}};Bv={};Wv={},zc={exports:{}};u5=v$(),m1=r=>{switch(r.type){case void 0:case"element":let e=new ky(r.name,r.attributes),t=r.elements||[];for(let n of t){let i=m1(n);i!==void 0&&e.push(i)}return e;case"text":return r.text;default:return}},Sy=class extends be{},ky=class extends he{static fromXmlString(e){let t=u5.xml2js(e,{compact:!1});return m1(t)}constructor(e,t){super(e),t&&this.root.push(new Sy(t))}push(e){this.root.push(e)}},Ty=class extends he{constructor(e){super(""),this._attr=e}prepForXml(e){return{_attr:this._attr}}},$c=class extends he{constructor(e,t){super(e),t&&(this.root=t.root)}},Ct=r=>{if(isNaN(r))throw new Error(`Invalid value '${r}' specified. Must be an integer.`);return Math.floor(r)},_f=r=>{let e=Ct(r);if(e<0)throw new Error(`Invalid value '${r}' specified. Must be a positive integer.`);return e},c5=(r,e)=>{let t=e*2;if(r.length!==t||isNaN(+`0x${r}`))throw new Error(`Invalid hex value '${r}'. Expected ${t} digit hex value`);return r},y2=r=>c5(r,1),g1=r=>{let e=r.slice(-2),t=r.substring(0,r.length-2);return`${Number(t)}${e}`},f5=r=>{let e=g1(r);if(parseFloat(e)<0)throw new Error(`Invalid value '${e}' specified. Expected a positive number.`);return e},js=r=>{if(r==="auto")return r;let e=r.charAt(0)==="#"?r.substring(1):r;return c5(e,3)},En=r=>typeof r=="string"?g1(r):Ct(r),y$=r=>typeof r=="string"?f5(r):_f(r),St=r=>typeof r=="string"?f5(r):_f(r),w$=r=>{let e=r.substring(0,r.length-1);return`${Number(e)}%`},h5=r=>typeof r=="number"?Ct(r):r.slice(-1)==="%"?w$(r):g1(r),b$=_f,_$=_f,x$=r=>r.toISOString(),ge=class extends he{constructor(e,t=!0){super(e),t!==!0&&this.root.push(new $e({val:t}))}},Ta=class extends he{constructor(e,t){super(e),this.root.push(new $e({val:y$(t)}))}},kn=class extends he{constructor(e,t){super(e),this.root.push(new $e({val:t}))}},xa=(r,e)=>new Fe({name:r,attributes:{value:{key:"w:val",value:e}}}),Di=class extends he{constructor(e,t){super(e),this.root.push(new $e({val:t}))}},Ay=class extends he{constructor(e,t){super(e),this.root.push(new $e({val:t}))}},_n=class extends he{constructor(e,t){super(e),this.root.push(t)}},Fe=class extends he{constructor({name:e,attributes:t,children:n}){super(e),t&&this.root.push(new xr(t)),n&&this.root.push(...n)}},mt={START:"start",CENTER:"center",END:"end",BOTH:"both",MEDIUM_KASHIDA:"mediumKashida",DISTRIBUTE:"distribute",NUM_TAB:"numTab",HIGH_KASHIDA:"highKashida",LOW_KASHIDA:"lowKashida",THAI_DISTRIBUTE:"thaiDistribute",LEFT:"left",RIGHT:"right",JUSTIFIED:"both"},Oy=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{val:"w:val"})}},Jc=class extends he{constructor(e){super("w:jc"),this.root.push(new Oy({val:e}))}},ze=class extends he{constructor(e,{color:t,size:n,space:i,style:s}){super(e),this.root.push(new Ny({style:s,color:t===void 0?void 0:js(t),size:n===void 0?void 0:b$(n),space:i===void 0?void 0:_$(i)}))}},Ny=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}},v1={SINGLE:"single",DASH_DOT_STROKED:"dashDotStroked",DASHED:"dashed",DASH_SMALL_GAP:"dashSmallGap",DOT_DASH:"dotDash",DOT_DOT_DASH:"dotDotDash",DOTTED:"dotted",DOUBLE:"double",DOUBLE_WAVE:"doubleWave",INSET:"inset",NIL:"nil",NONE:"none",OUTSET:"outset",THICK:"thick",THICK_THIN_LARGE_GAP:"thickThinLargeGap",THICK_THIN_MEDIUM_GAP:"thickThinMediumGap",THICK_THIN_SMALL_GAP:"thickThinSmallGap",THIN_THICK_LARGE_GAP:"thinThickLargeGap",THIN_THICK_MEDIUM_GAP:"thinThickMediumGap",THIN_THICK_SMALL_GAP:"thinThickSmallGap",THIN_THICK_THIN_LARGE_GAP:"thinThickThinLargeGap",THIN_THICK_THIN_MEDIUM_GAP:"thinThickThinMediumGap",THIN_THICK_THIN_SMALL_GAP:"thinThickThinSmallGap",THREE_D_EMBOSS:"threeDEmboss",THREE_D_ENGRAVE:"threeDEngrave",TRIPLE:"triple",WAVE:"wave"},Ry=class extends _r{constructor(e){super("w:pBdr"),e.top&&this.root.push(new ze("w:top",e.top)),e.bottom&&this.root.push(new ze("w:bottom",e.bottom)),e.left&&this.root.push(new ze("w:left",e.left)),e.right&&this.root.push(new ze("w:right",e.right))}},Cy=class extends he{constructor(){super("w:pBdr");let e=new ze("w:bottom",{color:"auto",space:1,style:v1.SINGLE,size:6});this.root.push(e)}},Iy=class extends he{constructor({start:e,end:t,left:n,right:i,hanging:s,firstLine:a}){super("w:ind"),this.root.push(new xr({start:{key:"w:start",value:e===void 0?void 0:En(e)},end:{key:"w:end",value:t===void 0?void 0:En(t)},left:{key:"w:left",value:n===void 0?void 0:En(n)},right:{key:"w:right",value:i===void 0?void 0:En(i)},hanging:{key:"w:hanging",value:s===void 0?void 0:St(s)},firstLine:{key:"w:firstLine",value:a===void 0?void 0:St(a)}}))}},E$=class extends he{constructor(){super("w:br")}},y1={BEGIN:"begin",END:"end",SEPARATE:"separate"},Ca=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}},Ci=class extends he{constructor(e){super("w:fldChar"),this.root.push(new Ca({type:y1.BEGIN,dirty:e}))}},Ii=class extends he{constructor(e){super("w:fldChar"),this.root.push(new Ca({type:y1.SEPARATE,dirty:e}))}},Pi=class extends he{constructor(e){super("w:fldChar"),this.root.push(new Ca({type:y1.END,dirty:e}))}},Mi={DEFAULT:"default",PRESERVE:"preserve"},An=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{space:"xml:space"})}},Py=class extends he{constructor(){super("w:instrText"),this.root.push(new An({space:Mi.PRESERVE})),this.root.push("PAGE")}},Dy=class extends he{constructor(){super("w:instrText"),this.root.push(new An({space:Mi.PRESERVE})),this.root.push("NUMPAGES")}},My=class extends he{constructor(){super("w:instrText"),this.root.push(new An({space:Mi.PRESERVE})),this.root.push("SECTIONPAGES")}},Ly=class extends he{constructor(){super("w:instrText"),this.root.push(new An({space:Mi.PRESERVE})),this.root.push("SECTION")}},Fy=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}},Ws=class extends he{constructor({fill:e,color:t,type:n}){super("w:shd"),this.root.push(new Fy({fill:e===void 0?void 0:js(e),color:t===void 0?void 0:js(t),type:n}))}},d5={CLEAR:"clear",DIAGONAL_CROSS:"diagCross",DIAGONAL_STRIPE:"diagStripe",HORIZONTAL_CROSS:"horzCross",HORIZONTAL_STRIPE:"horzStripe",NIL:"nil",PERCENT_5:"pct5",PERCENT_10:"pct10",PERCENT_12:"pct12",PERCENT_15:"pct15",PERCENT_20:"pct20",PERCENT_25:"pct25",PERCENT_30:"pct30",PERCENT_35:"pct35",PERCENT_37:"pct37",PERCENT_40:"pct40",PERCENT_45:"pct45",PERCENT_50:"pct50",PERCENT_55:"pct55",PERCENT_60:"pct60",PERCENT_62:"pct62",PERCENT_65:"pct65",PERCENT_70:"pct70",PERCENT_75:"pct75",PERCENT_80:"pct80",PERCENT_85:"pct85",PERCENT_87:"pct87",PERCENT_90:"pct90",PERCENT_95:"pct95",REVERSE_DIAGONAL_STRIPE:"reverseDiagStripe",SOLID:"solid",THIN_DIAGONAL_CROSS:"thinDiagCross",THIN_DIAGONAL_STRIPE:"thinDiagStripe",THIN_HORIZONTAL_CROSS:"thinHorzCross",THIN_REVERSE_DIAGONAL_STRIPE:"thinReverseDiagStripe",THIN_VERTICAL_STRIPE:"thinVertStripe",VERTICAL_STRIPE:"vertStripe"},By=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}},S$={DOT:"dot"},Uy=class extends he{constructor(e){super("w:em"),this.root.push(new $e({val:e}))}},Hy=class extends Uy{constructor(e=S$.DOT){super(e)}},zy=class extends he{constructor(e){super("w:spacing"),this.root.push(new $e({val:En(e)}))}},jy=class extends he{constructor(e){super("w:color"),this.root.push(new $e({val:js(e)}))}},Wy=class extends he{constructor(e){super("w:highlight"),this.root.push(new $e({val:e}))}},qy=class extends he{constructor(e){super("w:highlightCs"),this.root.push(new $e({val:e}))}},k$=r=>new Fe({name:"w:lang",attributes:{value:{key:"w:val",value:r.value},eastAsia:{key:"w:eastAsia",value:r.eastAsia},bidirectional:{key:"w:bidi",value:r.bidirectional}}}),Xc=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}},Aa=class extends he{constructor(e,t){if(super("w:rFonts"),typeof e=="string"){let n=e;this.root.push(new Xc({ascii:n,cs:n,eastAsia:n,hAnsi:n,hint:t}))}else{let n=e;this.root.push(new Xc(n))}}},p5=class extends he{constructor(e){super("w:vertAlign"),this.root.push(new $e({val:e}))}},Vy=class extends p5{constructor(){super("superscript")}},Ky=class extends p5{constructor(){super("subscript")}},m5={SINGLE:"single",WORDS:"words",DOUBLE:"double",THICK:"thick",DOTTED:"dotted",DOTTEDHEAVY:"dottedHeavy",DASH:"dash",DASHEDHEAVY:"dashedHeavy",DASHLONG:"dashLong",DASHLONGHEAVY:"dashLongHeavy",DOTDASH:"dotDash",DASHDOTHEAVY:"dashDotHeavy",DOTDOTDASH:"dotDotDash",DASHDOTDOTHEAVY:"dashDotDotHeavy",WAVE:"wave",WAVYHEAVY:"wavyHeavy",WAVYDOUBLE:"wavyDouble",NONE:"none"},Gy=class extends he{constructor(e=m5.SINGLE,t){super("w:u"),this.root.push(new $e({val:e,color:t===void 0?void 0:js(t)}))}},On=class extends _r{constructor(e){var t,n;if(super("w:rPr"),!e)return;e.style&&this.push(new kn("w:rStyle",e.style)),e.font&&(typeof e.font=="string"?this.push(new Aa(e.font)):"name"in e.font?this.push(new Aa(e.font.name,e.font.hint)):this.push(new Aa(e.font))),e.bold!==void 0&&this.push(new ge("w:b",e.bold)),(e.boldComplexScript===void 0&&e.bold!==void 0||e.boldComplexScript)&&this.push(new ge("w:bCs",(t=e.boldComplexScript)!=null?t:e.bold)),e.italics!==void 0&&this.push(new ge("w:i",e.italics)),(e.italicsComplexScript===void 0&&e.italics!==void 0||e.italicsComplexScript)&&this.push(new ge("w:iCs",(n=e.italicsComplexScript)!=null?n:e.italics)),e.smallCaps!==void 0?this.push(new ge("w:smallCaps",e.smallCaps)):e.allCaps!==void 0&&this.push(new ge("w:caps",e.allCaps)),e.strike!==void 0&&this.push(new ge("w:strike",e.strike)),e.doubleStrike!==void 0&&this.push(new ge("w:dstrike",e.doubleStrike)),e.emboss!==void 0&&this.push(new ge("w:emboss",e.emboss)),e.imprint!==void 0&&this.push(new ge("w:imprint",e.imprint)),e.noProof!==void 0&&this.push(new ge("w:noProof",e.noProof)),e.snapToGrid!==void 0&&this.push(new ge("w:snapToGrid",e.snapToGrid)),e.vanish&&this.push(new ge("w:vanish",e.vanish)),e.color&&this.push(new jy(e.color)),e.characterSpacing&&this.push(new zy(e.characterSpacing)),e.scale!==void 0&&this.push(new Di("w:w",e.scale)),e.kern&&this.push(new Ta("w:kern",e.kern)),e.position&&this.push(new kn("w:position",e.position)),e.size!==void 0&&this.push(new Ta("w:sz",e.size));let i=e.sizeComplexScript===void 0||e.sizeComplexScript===!0?e.size:e.sizeComplexScript;i&&this.push(new Ta("w:szCs",i)),e.highlight&&this.push(new Wy(e.highlight));let s=e.highlightComplexScript===void 0||e.highlightComplexScript===!0?e.highlight:e.highlightComplexScript;s&&this.push(new qy(s)),e.underline&&this.push(new Gy(e.underline.type,e.underline.color)),e.effect&&this.push(new kn("w:effect",e.effect)),e.border&&this.push(new ze("w:bdr",e.border)),e.shading&&this.push(new Ws(e.shading)),e.subScript&&this.push(new Ky),e.superScript&&this.push(new Vy),e.rightToLeft!==void 0&&this.push(new ge("w:rtl",e.rightToLeft)),e.emphasisMark&&this.push(new Hy(e.emphasisMark.type)),e.language&&this.push(k$(e.language)),e.specVanish&&this.push(new ge("w:specVanish",e.vanish)),e.math&&this.push(new ge("w:oMath",e.math)),e.revision&&this.push(new $y(e.revision))}push(e){this.root.push(e)}},$y=class extends he{constructor(e){super("w:rPrChange"),this.root.push(new By({id:e.id,author:e.author,date:e.date})),this.addChildElement(new On(e))}},Yc=class extends he{constructor(e){var t;super("w:t"),typeof e=="string"?(this.root.push(new An({space:Mi.PRESERVE})),this.root.push(e)):(this.root.push(new An({space:(t=e.space)!=null?t:Mi.DEFAULT})),this.root.push(e.text))}},jc={CURRENT:"CURRENT",TOTAL_PAGES:"TOTAL_PAGES",TOTAL_PAGES_IN_SECTION:"TOTAL_PAGES_IN_SECTION",CURRENT_SECTION:"SECTION"},Nn=class extends he{constructor(e){if(super("w:r"),de(this,"properties"),this.properties=new On(e),this.root.push(this.properties),e.break)for(let t=0;t<e.break;t++)this.root.push(new E$);if(e.children)for(let t of e.children){if(typeof t=="string"){switch(t){case jc.CURRENT:this.root.push(new Ci),this.root.push(new Py),this.root.push(new Ii),this.root.push(new Pi);break;case jc.TOTAL_PAGES:this.root.push(new Ci),this.root.push(new Dy),this.root.push(new Ii),this.root.push(new Pi);break;case jc.TOTAL_PAGES_IN_SECTION:this.root.push(new Ci),this.root.push(new My),this.root.push(new Ii),this.root.push(new Pi);break;case jc.CURRENT_SECTION:this.root.push(new Ci),this.root.push(new Ly),this.root.push(new Ii),this.root.push(new Pi);break;default:this.root.push(new Yc(t));break}continue}this.root.push(t)}else e.text!==void 0&&this.root.push(new Yc(e.text))}},et=class extends Nn{constructor(e){super(typeof e=="string"?{text:e}:e)}},sy={},je={};ay={};Oi={},zr={};dy={};P$=I$(),D$=o1(P$),M$="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",L$=(r,e=21)=>(t=e)=>{let n="",i=t|0;for(;i--;)n+=r[Math.random()*r.length|0];return n},F$=(r=21)=>{let e="",t=r|0;for(;t--;)e+=M$[Math.random()*64|0];return e},Kt=r=>Math.floor(r*72*20),xf=(r=0)=>{let e=r;return()=>++e},B$=()=>xf(),U$=()=>xf(1),H$=()=>xf(),z$=()=>xf(),w5=()=>F$().toLowerCase(),I2=r=>D$.sha1().update(r instanceof ArrayBuffer?new Uint8Array(r):r).digest("hex"),Ea=r=>L$("1234567890abcdef",r)(),j$=()=>`${Ea(8)}-${Ea(4)}-${Ea(4)}-${Ea(4)}-${Ea(12)}`,W$={CHARACTER:"character",COLUMN:"column",INSIDE_MARGIN:"insideMargin",LEFT_MARGIN:"leftMargin",MARGIN:"margin",OUTSIDE_MARGIN:"outsideMargin",PAGE:"page",RIGHT_MARGIN:"rightMargin"},q$={BOTTOM_MARGIN:"bottomMargin",INSIDE_MARGIN:"insideMargin",LINE:"line",MARGIN:"margin",OUTSIDE_MARGIN:"outsideMargin",PAGE:"page",PARAGRAPH:"paragraph",TOP_MARGIN:"topMargin"},V$=()=>new Fe({name:"wp:simplePos",attributes:{x:{key:"x",value:0},y:{key:"y",value:0}}}),b5=r=>new Fe({name:"wp:align",children:[r]}),_5=r=>new Fe({name:"wp:posOffset",children:[r.toString()]}),K$=({relative:r,align:e,offset:t})=>new Fe({name:"wp:positionH",attributes:{relativeFrom:{key:"relativeFrom",value:r??W$.PAGE}},children:[(()=>{if(e)return b5(e);if(t!==void 0)return _5(t);throw new Error("There is no configuration provided for floating position (Align or offset)")})()]}),G$=({relative:r,align:e,offset:t})=>new Fe({name:"wp:positionV",attributes:{relativeFrom:{key:"relativeFrom",value:r??q$.PAGE}},children:[(()=>{if(e)return b5(e);if(t!==void 0)return _5(t);throw new Error("There is no configuration provided for floating position (Align or offset)")})()]}),Jy=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{uri:"uri"})}},$$=r=>new Fe({name:"asvg:svgBlip",attributes:{asvg:{key:"xmlns:asvg",value:"http://schemas.microsoft.com/office/drawing/2016/SVG/main"},embed:{key:"r:embed",value:`rId{${r.fileName}}`}}}),J$=r=>new Fe({name:"a:ext",attributes:{uri:{key:"uri",value:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"}},children:[$$(r)]}),X$=r=>new Fe({name:"a:extLst",children:[J$(r)]}),Y$=r=>new Fe({name:"a:blip",attributes:{embed:{key:"r:embed",value:`rId{${r.type==="svg"?r.fallback.fileName:r.fileName}}`},cstate:{key:"cstate",value:"none"}},children:r.type==="svg"?[X$(r)]:[]}),Xy=class extends he{constructor(){super("a:srcRect")}},Yy=class extends he{constructor(){super("a:fillRect")}},Zy=class extends he{constructor(){super("a:stretch"),this.root.push(new Yy)}},Qy=class extends he{constructor(e){super("pic:blipFill"),this.root.push(Y$(e)),this.root.push(new Xy),this.root.push(new Zy)}},ew=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{noChangeAspect:"noChangeAspect",noChangeArrowheads:"noChangeArrowheads"})}},tw=class extends he{constructor(){super("a:picLocks"),this.root.push(new ew({noChangeAspect:1,noChangeArrowheads:1}))}},rw=class extends he{constructor(){super("pic:cNvPicPr"),this.root.push(new tw)}},x5=(r,e)=>new Fe({name:"a:hlinkClick",attributes:Tn(Re({},e?{xmlns:{key:"xmlns:a",value:"http://schemas.openxmlformats.org/drawingml/2006/main"}}:{}),{id:{key:"r:id",value:`rId${r}`}})}),nw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{id:"id",name:"name",descr:"descr"})}},iw=class extends he{constructor(){super("pic:cNvPr"),this.root.push(new nw({id:0,name:"",descr:""}))}prepForXml(e){for(let t=e.stack.length-1;t>=0;t--){let n=e.stack[t];if(n instanceof qs){this.root.push(x5(n.linkId,!1));break}}return super.prepForXml(e)}},sw=class extends he{constructor(){super("pic:nvPicPr"),this.root.push(new iw),this.root.push(new rw)}},ow=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{xmlns:"xmlns:pic"})}},aw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{cx:"cx",cy:"cy"})}},lw=class extends he{constructor(e,t){super("a:ext"),de(this,"attributes"),this.attributes=new aw({cx:e,cy:t}),this.root.push(this.attributes)}},uw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{x:"x",y:"y"})}},cw=class extends he{constructor(){super("a:off"),this.root.push(new uw({x:0,y:0}))}},fw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{flipVertical:"flipV",flipHorizontal:"flipH",rotation:"rot"})}},hw=class extends he{constructor(e){var t,n;super("a:xfrm"),de(this,"extents"),this.root.push(new fw({flipVertical:(t=e.flip)==null?void 0:t.vertical,flipHorizontal:(n=e.flip)==null?void 0:n.horizontal,rotation:e.rotation})),this.extents=new lw(e.emus.x,e.emus.y),this.root.push(new cw),this.root.push(this.extents)}},E5=()=>new Fe({name:"a:noFill"}),Z$=r=>new Fe({name:"a:srgbClr",attributes:{value:{key:"val",value:r.value}}}),Q$=r=>new Fe({name:"a:schemeClr",attributes:{value:{key:"val",value:r.value}}}),P2=r=>new Fe({name:"a:solidFill",children:[r.type==="rgb"?Z$(r):Q$(r)]}),eJ=r=>new Fe({name:"a:ln",attributes:{width:{key:"w",value:r.width},cap:{key:"cap",value:r.cap},compoundLine:{key:"cmpd",value:r.compoundLine},align:{key:"algn",value:r.align}},children:[r.type==="noFill"?E5():r.solidFillType==="rgb"?P2({type:"rgb",value:r.value}):P2({type:"scheme",value:r.value})]}),dw=class extends he{constructor(){super("a:avLst")}},pw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{prst:"prst"})}},mw=class extends he{constructor(){super("a:prstGeom"),this.root.push(new pw({prst:"rect"})),this.root.push(new dw)}},gw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{bwMode:"bwMode"})}},vw=class extends he{constructor({outline:e,transform:t}){super("pic:spPr"),de(this,"form"),this.root.push(new gw({bwMode:"auto"})),this.form=new hw(t),this.root.push(this.form),this.root.push(new mw),e&&(this.root.push(E5()),this.root.push(eJ(e)))}},yw=class extends he{constructor({mediaData:e,transform:t,outline:n}){super("pic:pic"),this.root.push(new ow({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.root.push(new sw),this.root.push(new Qy(e)),this.root.push(new vw({transform:t,outline:n}))}},ww=class extends he{constructor({mediaData:e,transform:t,outline:n}){super("a:graphicData"),de(this,"pic"),this.root.push(new Jy({uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.pic=new yw({mediaData:e,transform:t,outline:n}),this.root.push(this.pic)}},bw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{a:"xmlns:a"})}},Zc=class extends he{constructor({mediaData:e,transform:t,outline:n}){super("a:graphic"),de(this,"data"),this.root.push(new bw({a:"http://schemas.openxmlformats.org/drawingml/2006/main"})),this.data=new ww({mediaData:e,transform:t,outline:n}),this.root.push(this.data)}},Wc={NONE:0,SQUARE:1,TIGHT:2,TOP_AND_BOTTOM:3},tJ={BOTH_SIDES:"bothSides",LEFT:"left",RIGHT:"right",LARGEST:"largest"},Qc=class extends he{constructor(){super("wp:wrapNone")}},_w=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",wrapText:"wrapText"})}},xw=class extends he{constructor(e,t={top:0,bottom:0,left:0,right:0}){super("wp:wrapSquare"),this.root.push(new _w({wrapText:e.side||tJ.BOTH_SIDES,distT:t.top,distB:t.bottom,distL:t.left,distR:t.right}))}},Ew=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{distT:"distT",distB:"distB"})}},Sw=class extends he{constructor(e={top:0,bottom:0}){super("wp:wrapTight"),this.root.push(new Ew({distT:e.top,distB:e.bottom}))}},kw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{distT:"distT",distB:"distB"})}},Tw=class extends he{constructor(e={top:0,bottom:0}){super("wp:wrapTopAndBottom"),this.root.push(new kw({distT:e.top,distB:e.bottom}))}},ef=class extends he{constructor({name:e,description:t,title:n}={name:"",description:"",title:""}){super("wp:docPr"),de(this,"docPropertiesUniqueNumericId",H$());let i={id:{key:"id",value:this.docPropertiesUniqueNumericId()},name:{key:"name",value:e}};t!=null&&(i.description={key:"descr",value:t}),n!=null&&(i.title={key:"title",value:n}),this.root.push(new xr(i))}prepForXml(e){for(let t=e.stack.length-1;t>=0;t--){let n=e.stack[t];if(n instanceof qs){this.root.push(x5(n.linkId,!0));break}}return super.prepForXml(e)}},S5=({top:r,right:e,bottom:t,left:n})=>new Fe({name:"wp:effectExtent",attributes:{top:{key:"t",value:r},right:{key:"r",value:e},bottom:{key:"b",value:t},left:{key:"l",value:n}}}),k5=({x:r,y:e})=>new Fe({name:"wp:extent",attributes:{x:{key:"cx",value:r},y:{key:"cy",value:e}}}),Aw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{xmlns:"xmlns:a",noChangeAspect:"noChangeAspect"})}},Ow=class extends he{constructor(){super("a:graphicFrameLocks"),this.root.push(new Aw({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:1}))}},T5=()=>new Fe({name:"wp:cNvGraphicFramePr",children:[new Ow]}),Nw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",allowOverlap:"allowOverlap",behindDoc:"behindDoc",layoutInCell:"layoutInCell",locked:"locked",relativeHeight:"relativeHeight",simplePos:"simplePos"})}},Rw=class extends he{constructor({mediaData:e,transform:t,drawingOptions:n}){super("wp:anchor");let i=Re({allowOverlap:!0,behindDocument:!1,lockAnchor:!1,layoutInCell:!0,verticalPosition:{},horizontalPosition:{}},n.floating);if(this.root.push(new Nw({distT:i.margins&&i.margins.top||0,distB:i.margins&&i.margins.bottom||0,distL:i.margins&&i.margins.left||0,distR:i.margins&&i.margins.right||0,simplePos:"0",allowOverlap:i.allowOverlap===!0?"1":"0",behindDoc:i.behindDocument===!0?"1":"0",locked:i.lockAnchor===!0?"1":"0",layoutInCell:i.layoutInCell===!0?"1":"0",relativeHeight:i.zIndex?i.zIndex:t.emus.y})),this.root.push(V$()),this.root.push(K$(i.horizontalPosition)),this.root.push(G$(i.verticalPosition)),this.root.push(k5({x:t.emus.x,y:t.emus.y})),this.root.push(S5({top:0,right:0,bottom:0,left:0})),n.floating!==void 0&&n.floating.wrap!==void 0)switch(n.floating.wrap.type){case Wc.SQUARE:this.root.push(new xw(n.floating.wrap,n.floating.margins));break;case Wc.TIGHT:this.root.push(new Sw(n.floating.margins));break;case Wc.TOP_AND_BOTTOM:this.root.push(new Tw(n.floating.margins));break;case Wc.NONE:default:this.root.push(new Qc)}else this.root.push(new Qc);this.root.push(new ef(n.docProperties)),this.root.push(T5()),this.root.push(new Zc({mediaData:e,transform:t,outline:n.outline}))}},rJ=({mediaData:r,transform:e,docProperties:t,outline:n})=>{var i,s,a,o;return new Fe({name:"wp:inline",attributes:{distanceTop:{key:"distT",value:0},distanceBottom:{key:"distB",value:0},distanceLeft:{key:"distL",value:0},distanceRight:{key:"distR",value:0}},children:[k5({x:e.emus.x,y:e.emus.y}),S5(n?{top:((i=n.width)!=null?i:9525)*2,right:((s=n.width)!=null?s:9525)*2,bottom:((a=n.width)!=null?a:9525)*2,left:((o=n.width)!=null?o:9525)*2}:{top:0,right:0,bottom:0,left:0}),new ef(t),T5(),new Zc({mediaData:r,transform:e,outline:n})]})},Cw=class extends he{constructor(e,t={}){super("w:drawing"),t.floating?this.root.push(new Rw({mediaData:e,transform:e.transformation,drawingOptions:t})):this.root.push(rJ({mediaData:e,transform:e.transformation,docProperties:t.docProperties,outline:t.outline}))}},nJ=r=>{if(typeof atob=="function"){let e=";base64,",t=r.indexOf(e),n=t===-1?0:t+e.length;return new Uint8Array(atob(r.substring(n)).split("").map(i=>i.charCodeAt(0)))}else{let e=require("buffer");return new e.Buffer(r,"base64")}},iJ=r=>typeof r=="string"?nJ(r):r,my=(r,e)=>({data:iJ(r.data),fileName:e,transformation:{pixels:{x:Math.round(r.transformation.width),y:Math.round(r.transformation.height)},emus:{x:Math.round(r.transformation.width*9525),y:Math.round(r.transformation.height*9525)},flip:r.transformation.flip,rotation:r.transformation.rotation?r.transformation.rotation*6e4:void 0}}),Ia=class extends Nn{constructor(e){super({}),de(this,"imageData");let n=`${I2(e.data)}.${e.type}`;this.imageData=e.type==="svg"?Tn(Re({type:e.type},my(e,n)),{fallback:Re({type:e.fallback.type},my(Tn(Re({},e.fallback),{transformation:e.transformation}),`${I2(e.fallback.data)}.${e.fallback.type}`))}):Re({type:e.type},my(e,n));let i=new Cw(this.imageData,{floating:e.floating,docProperties:e.altText,outline:e.outline});this.root.push(i)}prepForXml(e){return e.file.Media.addImage(this.imageData.fileName,this.imageData),this.imageData.type==="svg"&&e.file.Media.addImage(this.imageData.fallback.fileName,this.imageData.fallback),super.prepForXml(e)}},Iw=class extends he{constructor(e){super("w:instrText"),this.root.push(new An({space:Mi.PRESERVE})),this.root.push(`SEQ ${e}`)}},tf=class extends Nn{constructor(e){super({}),this.root.push(new Ci(!0)),this.root.push(new Iw(e)),this.root.push(new Ii),this.root.push(new Pi)}},Pw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{instr:"w:instr"})}},Pa=class extends he{constructor(e,t){super("w:fldSimple"),this.root.push(new Pw({instr:e})),t!==void 0&&this.root.push(new et(t))}},Dw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{xmlns:"xmlns"})}},Mw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}},sJ={EXTERNAL:"External"},Lw=class extends he{constructor(e,t,n,i){super("Relationship"),this.root.push(new Mw({id:e,type:t,target:n,targetMode:i}))}},Rn=class extends he{constructor(){super("Relationships"),this.root.push(new Dw({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(e,t,n,i){let s=new Lw(`rId${e}`,t,n,i);return this.root.push(s),s}get RelationshipCount(){return this.root.length-1}},Fw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}},Bw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}},Uw=class extends he{constructor({id:e,initials:t,author:n,date:i=new Date,children:s}){super("w:comment"),this.root.push(new Fw({id:e,initials:t,author:n,date:i.toISOString()}));for(let a of s)this.root.push(a)}},Hw=class extends he{constructor({children:e}){super("w:comments"),de(this,"relationships"),this.root.push(new Bw({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(let t of e)this.root.push(new Uw(t));this.relationships=new Rn}get Relationships(){return this.relationships}},zw=class extends he{constructor(){super("w:pageBreakBefore")}},jw={AT_LEAST:"atLeast",EXACTLY:"exactly",EXACT:"exact",AUTO:"auto"},Ww=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule",beforeAutoSpacing:"w:beforeAutospacing",afterAutoSpacing:"w:afterAutospacing"})}},qw=class extends he{constructor(e){super("w:spacing"),this.root.push(new Ww(e))}},er={HEADING_1:"Heading1",HEADING_2:"Heading2",HEADING_3:"Heading3",HEADING_4:"Heading4",HEADING_5:"Heading5",HEADING_6:"Heading6",TITLE:"Title"},qc=class extends he{constructor(e){super("w:pStyle"),this.root.push(new $e({val:e}))}},Vw=class extends he{constructor(e){super("w:tabs");for(let t of e)this.root.push(new Gw(t))}},Li={LEFT:"left",RIGHT:"right",CENTER:"center",BAR:"bar",CLEAR:"clear",DECIMAL:"decimal",END:"end",NUM:"num",START:"start"},Ka={MAX:9026},Kw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}},Gw=class extends he{constructor({type:e,position:t,leader:n}){super("w:tab"),this.root.push(new Kw({val:e,pos:t,leader:n}))}},Oa=class extends he{constructor(e,t){super("w:numPr"),this.root.push(new $w(t)),this.root.push(new Jw(e))}},$w=class extends he{constructor(e){if(super("w:ilvl"),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new $e({val:e}))}},Jw=class extends he{constructor(e){super("w:numId"),this.root.push(new $e({val:typeof e=="string"?`{${e}}`:e}))}},rf=class extends he{constructor(){super(...arguments),de(this,"fileChild",Symbol())}},Xw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}},qs=class extends he{constructor(e,t,n){super("w:hyperlink"),de(this,"linkId"),this.linkId=t;let i={history:1,anchor:n||void 0,id:n?void 0:`rId${this.linkId}`},s=new Xw(i);this.root.push(s),e.forEach(a=>{this.root.push(a)})}},Da=class extends qs{constructor(e){super(e.children,w5(),e.anchor)}},Vs=class extends he{constructor(e){super("w:externalHyperlink"),this.options=e}},Yw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{id:"w:id",name:"w:name"})}},Zw=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{id:"w:id"})}},Ma=class{constructor(e){de(this,"bookmarkUniqueNumericId",z$()),de(this,"start"),de(this,"children"),de(this,"end");let t=this.bookmarkUniqueNumericId();this.start=new Qw(e.id,t),this.children=e.children,this.end=new e0(t)}},Qw=class extends he{constructor(e,t){super("w:bookmarkStart");let n=new Yw({name:e,id:t});this.root.push(n)}},e0=class extends he{constructor(e){super("w:bookmarkEnd");let t=new Zw({id:e});this.root.push(t)}},t0=class extends he{constructor(e){super("w:outlineLvl"),this.level=e,this.root.push(new $e({val:e}))}},oJ={TOP:"top",CENTER:"center",BOTTOM:"bottom"},Bee=Tn(Re({},oJ),{BOTH:"both"}),r0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{verticalAlign:"w:val"})}},nf=class extends he{constructor(e){super("w:vAlign"),this.root.push(new r0({verticalAlign:e}))}},n0=class extends he{constructor({space:e,count:t,separate:n,equalWidth:i,children:s}){super("w:cols"),this.root.push(new xr({space:{key:"w:space",value:e===void 0?void 0:St(e)},count:{key:"w:num",value:t===void 0?void 0:Ct(t)},separate:{key:"w:sep",value:n},equalWidth:{key:"w:equalWidth",value:i}})),!i&&s&&s.forEach(a=>this.addChildElement(a))}},aJ=({type:r,linePitch:e,charSpace:t})=>new Fe({name:"w:docGrid",attributes:{type:{key:"w:type",value:r},linePitch:{key:"w:linePitch",value:Ct(e)},charSpace:{key:"w:charSpace",value:t?Ct(t):void 0}}}),Us={DEFAULT:"default",FIRST:"first",EVEN:"even"},i0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{type:"w:type",id:"r:id"})}},D2={HEADER:"w:headerReference",FOOTER:"w:footerReference"},Na=class extends he{constructor(e,t){super(e),this.root.push(new i0({type:t.type||Us.DEFAULT,id:`rId${t.id}`}))}},lJ=({countBy:r,start:e,restart:t,distance:n})=>new Fe({name:"w:lnNumType",attributes:{countBy:{key:"w:countBy",value:r===void 0?void 0:Ct(r)},start:{key:"w:start",value:e===void 0?void 0:Ct(e)},restart:{key:"w:restart",value:t},distance:{key:"w:distance",value:n===void 0?void 0:St(n)}}}),sf=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}},s0=class extends _r{constructor(e){if(super("w:pgBorders"),!e)return this;e.pageBorders?this.root.push(new sf({display:e.pageBorders.display,offsetFrom:e.pageBorders.offsetFrom,zOrder:e.pageBorders.zOrder})):this.root.push(new sf({})),e.pageBorderTop&&this.root.push(new ze("w:top",e.pageBorderTop)),e.pageBorderLeft&&this.root.push(new ze("w:left",e.pageBorderLeft)),e.pageBorderBottom&&this.root.push(new ze("w:bottom",e.pageBorderBottom)),e.pageBorderRight&&this.root.push(new ze("w:right",e.pageBorderRight))}},o0=class extends he{constructor(e,t,n,i,s,a,o){super("w:pgMar"),this.root.push(new xr({top:{key:"w:top",value:En(e)},right:{key:"w:right",value:St(t)},bottom:{key:"w:bottom",value:En(n)},left:{key:"w:left",value:St(i)},header:{key:"w:header",value:St(s)},footer:{key:"w:footer",value:St(a)},gutter:{key:"w:gutter",value:St(o)}}))}},a0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}},l0=class extends he{constructor({start:e,formatType:t,separator:n}){super("w:pgNumType"),this.root.push(new a0({start:e===void 0?void 0:Ct(e),formatType:t,separator:n}))}},u0={PORTRAIT:"portrait",LANDSCAPE:"landscape"},uJ=({width:r,height:e,orientation:t,code:n})=>{let i=St(r),s=St(e);return new Fe({name:"w:pgSz",attributes:{width:{key:"w:w",value:t===u0.LANDSCAPE?s:i},height:{key:"w:h",value:t===u0.LANDSCAPE?i:s},orientation:{key:"w:orient",value:t},code:{key:"w:code",value:n}}})},c0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{val:"w:val"})}},f0=class extends he{constructor(e){super("w:textDirection"),this.root.push(new c0({val:e}))}},w1={NEXT_PAGE:"nextPage",NEXT_COLUMN:"nextColumn",CONTINUOUS:"continuous",EVEN_PAGE:"evenPage",ODD_PAGE:"oddPage"},h0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{val:"w:val"})}},d0=class extends he{constructor(e){super("w:type"),this.root.push(new h0({val:e}))}},Ni={TOP:1440,RIGHT:1440,BOTTOM:1440,LEFT:1440,HEADER:708,FOOTER:708,GUTTER:0},gy={WIDTH:11906,HEIGHT:16838,ORIENTATION:u0.PORTRAIT},p0=class extends he{constructor({page:{size:{width:e=gy.WIDTH,height:t=gy.HEIGHT,orientation:n=gy.ORIENTATION}={},margin:{top:i=Ni.TOP,right:s=Ni.RIGHT,bottom:a=Ni.BOTTOM,left:o=Ni.LEFT,header:l=Ni.HEADER,footer:u=Ni.FOOTER,gutter:c=Ni.GUTTER}={},pageNumbers:f={},borders:d,textDirection:h}={},grid:{linePitch:y=360,charSpace:v,type:x}={},headerWrapperGroup:m={},footerWrapperGroup:_={},lineNumbers:b,titlePage:w,verticalAlign:T,column:P,type:M}={}){super("w:sectPr"),this.addHeaderFooterGroup(D2.HEADER,m),this.addHeaderFooterGroup(D2.FOOTER,_),M&&this.root.push(new d0(M)),this.root.push(uJ({width:e,height:t,orientation:n})),this.root.push(new o0(i,s,a,o,l,u,c)),d&&this.root.push(new s0(d)),b&&this.root.push(lJ(b)),this.root.push(new l0(f)),P&&this.root.push(new n0(P)),T&&this.root.push(new nf(T)),w!==void 0&&this.root.push(new ge("w:titlePg",w)),h&&this.root.push(new f0(h)),this.root.push(aJ({linePitch:y,charSpace:v,type:x}))}addHeaderFooterGroup(e,t){t.default&&this.root.push(new Na(e,{type:Us.DEFAULT,id:t.default.View.ReferenceId})),t.first&&this.root.push(new Na(e,{type:Us.FIRST,id:t.first.View.ReferenceId})),t.even&&this.root.push(new Na(e,{type:Us.EVEN,id:t.even.View.ReferenceId}))}},m0=class extends he{constructor(){super("w:body"),de(this,"sections",[])}addSection(e){let t=this.sections.pop();this.root.push(this.createSectionParagraph(t)),this.sections.push(new p0(e))}prepForXml(e){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(e)}push(e){this.root.push(e)}createSectionParagraph(e){let t=new $t({}),n=new Qn({});return n.push(e),t.addChildElement(n),t}},M2={wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ks=class extends be{constructor(e,t){super(Re({Ignorable:t},Object.fromEntries(e.map(n=>[n,M2[n]])))),de(this,"xmlKeys",Re({Ignorable:"mc:Ignorable"},Object.fromEntries(Object.keys(M2).map(n=>[n,`xmlns:${n}`]))))}},g0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}},v0=class extends he{constructor(e){super("w:background"),this.root.push(new g0({color:e.color===void 0?void 0:js(e.color),themeColor:e.themeColor,themeShade:e.themeShade===void 0?void 0:y2(e.themeShade),themeTint:e.themeTint===void 0?void 0:y2(e.themeTint)}))}},y0=class extends he{constructor(e){super("w:document"),de(this,"body"),this.root.push(new Ks(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps","cx","cx1","cx2","cx3","cx4","cx5","cx6","cx7","cx8","aink","am3d","w16cex","w16cid","w16","w16sdtdh","w16se"],"w14 w15 wp14")),this.body=new m0,e.background&&this.root.push(new v0(e.background)),this.root.push(this.body)}add(e){return this.body.push(e),this}get Body(){return this.body}},of=class{constructor(e){de(this,"document"),de(this,"relationships"),this.document=new y0(e),this.relationships=new Rn}get View(){return this.document}get Relationships(){return this.relationships}},w0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{val:"w:val"})}},b0=class extends he{constructor(){super("w:wordWrap"),this.root.push(new w0({val:0}))}},cJ=r=>{var e,t;return new Fe({name:"w:framePr",attributes:{anchorLock:{key:"w:anchorLock",value:r.anchorLock},dropCap:{key:"w:dropCap",value:r.dropCap},width:{key:"w:w",value:r.width},height:{key:"w:h",value:r.height},x:{key:"w:x",value:r.position?r.position.x:void 0},y:{key:"w:y",value:r.position?r.position.y:void 0},anchorHorizontal:{key:"w:hAnchor",value:r.anchor.horizontal},anchorVertical:{key:"w:vAnchor",value:r.anchor.vertical},spaceHorizontal:{key:"w:hSpace",value:(e=r.space)==null?void 0:e.horizontal},spaceVertical:{key:"w:vSpace",value:(t=r.space)==null?void 0:t.vertical},rule:{key:"w:hRule",value:r.rule},alignmentX:{key:"w:xAlign",value:r.alignment?r.alignment.x:void 0},alignmentY:{key:"w:yAlign",value:r.alignment?r.alignment.y:void 0},lines:{key:"w:lines",value:r.lines},wrap:{key:"w:wrap",value:r.wrap}}})},Qn=class extends _r{constructor(e){var t,n;if(super("w:pPr"),de(this,"numberingReferences",[]),!e)return this;e.heading&&this.push(new qc(e.heading)),e.bullet&&this.push(new qc("ListParagraph")),e.numbering&&!e.style&&!e.heading&&(e.numbering.custom||this.push(new qc("ListParagraph"))),e.style&&this.push(new qc(e.style)),e.keepNext!==void 0&&this.push(new ge("w:keepNext",e.keepNext)),e.keepLines!==void 0&&this.push(new ge("w:keepLines",e.keepLines)),e.pageBreakBefore&&this.push(new zw),e.frame&&this.push(cJ(e.frame)),e.widowControl!==void 0&&this.push(new ge("w:widowControl",e.widowControl)),e.bullet&&this.push(new Oa(1,e.bullet.level)),e.numbering?(this.numberingReferences.push({reference:e.numbering.reference,instance:(t=e.numbering.instance)!=null?t:0}),this.push(new Oa(`${e.numbering.reference}-${(n=e.numbering.instance)!=null?n:0}`,e.numbering.level))):e.numbering===!1&&this.push(new Oa(0,0)),e.border&&this.push(new Ry(e.border)),e.thematicBreak&&this.push(new Cy),e.shading&&this.push(new Ws(e.shading)),e.wordWrap&&this.push(new b0),e.overflowPunctuation&&this.push(new ge("w:overflowPunct",e.overflowPunctuation));let i=[...e.rightTabStop!==void 0?[{type:Li.RIGHT,position:e.rightTabStop}]:[],...e.tabStops?e.tabStops:[],...e.leftTabStop!==void 0?[{type:Li.LEFT,position:e.leftTabStop}]:[]];i.length>0&&this.push(new Vw(i)),e.bidirectional!==void 0&&this.push(new ge("w:bidi",e.bidirectional)),e.spacing&&this.push(new qw(e.spacing)),e.indent&&this.push(new Iy(e.indent)),e.contextualSpacing!==void 0&&this.push(new ge("w:contextualSpacing",e.contextualSpacing)),e.alignment&&this.push(new Jc(e.alignment)),e.outlineLevel!==void 0&&this.push(new t0(e.outlineLevel)),e.suppressLineNumbers!==void 0&&this.push(new ge("w:suppressLineNumbers",e.suppressLineNumbers)),e.autoSpaceEastAsianText!==void 0&&this.push(new ge("w:autoSpaceDN",e.autoSpaceEastAsianText)),e.run&&this.push(new On(e.run))}push(e){this.root.push(e)}prepForXml(e){if(e.viewWrapper instanceof of)for(let t of this.numberingReferences)e.file.Numbering.createConcreteNumberingInstance(t.reference,t.instance);return super.prepForXml(e)}},$t=class extends rf{constructor(e){if(super("w:p"),de(this,"properties"),typeof e=="string")return this.properties=new Qn({}),this.root.push(this.properties),this.root.push(new et(e)),this;if(this.properties=new Qn(e),this.root.push(this.properties),e.text&&this.root.push(new et(e.text)),e.children)for(let t of e.children){if(t instanceof Ma){this.root.push(t.start);for(let n of t.children)this.root.push(n);this.root.push(t.end);continue}this.root.push(t)}}prepForXml(e){for(let t of this.root)if(t instanceof Vs){let n=this.root.indexOf(t),i=new qs(t.options.children,w5());e.viewWrapper.Relationships.createRelationship(i.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",t.options.link,sJ.EXTERNAL),this.root[n]=i}return super.prepForXml(e)}addRunToFront(e){return this.root.splice(1,0,e),this}},Ga=class extends he{constructor(e){super("m:oMath");for(let t of e.children)this.root.push(t)}},_0=class extends he{constructor(e){super("m:t"),this.root.push(e)}},Fi=class extends he{constructor(e){super("m:r"),this.root.push(new _0(e))}},x0=class extends he{constructor(e){super("w:tblGrid");for(let t of e)this.root.push(new E0(t))}},E0=class extends he{constructor(e){super("w:gridCol"),e!==void 0&&this.root.push(new xr({width:{key:"w:w",value:St(e)}}))}},A5={TABLE:"w:tblCellMar",TABLE_CELL:"w:tcMar"},af=class extends _r{constructor(e,{marginUnitType:t=S0.DXA,top:n,left:i,bottom:s,right:a}){super(e),n!==void 0&&this.root.push(new Sn("w:top",{type:t,size:n})),i!==void 0&&this.root.push(new Sn("w:left",{type:t,size:i})),s!==void 0&&this.root.push(new Sn("w:bottom",{type:t,size:s})),a!==void 0&&this.root.push(new Sn("w:right",{type:t,size:a}))}},S0={AUTO:"auto",DXA:"dxa",NIL:"nil",PERCENTAGE:"pct"},Sn=class extends he{constructor(e,{type:t=S0.AUTO,size:n}){super(e);let i=n;t===S0.PERCENTAGE&&typeof n=="number"&&(i=`${n}%`),this.root.push(new xr({type:{key:"w:type",value:t},size:{key:"w:w",value:h5(i)}}))}},k0=class extends _r{constructor(e){super("w:tcBorders"),e.top&&this.root.push(new ze("w:top",e.top)),e.start&&this.root.push(new ze("w:start",e.start)),e.left&&this.root.push(new ze("w:left",e.left)),e.bottom&&this.root.push(new ze("w:bottom",e.bottom)),e.end&&this.root.push(new ze("w:end",e.end)),e.right&&this.root.push(new ze("w:right",e.right))}},T0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{val:"w:val"})}},A0=class extends he{constructor(e){super("w:gridSpan"),this.root.push(new T0({val:Ct(e)}))}},O5={CONTINUE:"continue",RESTART:"restart"},O0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{val:"w:val"})}},lf=class extends he{constructor(e){super("w:vMerge"),this.root.push(new O0({val:e}))}},N0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{val:"w:val"})}},R0=class extends he{constructor(e){super("w:textDirection"),this.root.push(new N0({val:e}))}},C0=class extends _r{constructor(e){super("w:tcPr"),e.width&&this.root.push(new Sn("w:tcW",e.width)),e.columnSpan&&this.root.push(new A0(e.columnSpan)),e.verticalMerge?this.root.push(new lf(e.verticalMerge)):e.rowSpan&&e.rowSpan>1&&this.root.push(new lf(O5.RESTART)),e.borders&&this.root.push(new k0(e.borders)),e.shading&&this.root.push(new Ws(e.shading)),e.margins&&this.root.push(new af(A5.TABLE_CELL,e.margins)),e.textDirection&&this.root.push(new R0(e.textDirection)),e.verticalAlign&&this.root.push(new nf(e.verticalAlign))}},Bi=class extends he{constructor(e){super("w:tc"),this.options=e,this.root.push(new C0(e));for(let t of e.children)this.root.push(t)}prepForXml(e){return this.root[this.root.length-1]instanceof $t||this.root.push(new $t({})),super.prepForXml(e)}},Ms={style:v1.NONE,size:0,color:"auto"},Ls={style:v1.SINGLE,size:4,color:"auto"},uf=class extends he{constructor(e){super("w:tblBorders"),e.top?this.root.push(new ze("w:top",e.top)):this.root.push(new ze("w:top",Ls)),e.left?this.root.push(new ze("w:left",e.left)):this.root.push(new ze("w:left",Ls)),e.bottom?this.root.push(new ze("w:bottom",e.bottom)):this.root.push(new ze("w:bottom",Ls)),e.right?this.root.push(new ze("w:right",e.right)):this.root.push(new ze("w:right",Ls)),e.insideHorizontal?this.root.push(new ze("w:insideH",e.insideHorizontal)):this.root.push(new ze("w:insideH",Ls)),e.insideVertical?this.root.push(new ze("w:insideV",e.insideVertical)):this.root.push(new ze("w:insideV",Ls))}};de(uf,"NONE",{top:Ms,bottom:Ms,left:Ms,right:Ms,insideHorizontal:Ms,insideVertical:Ms});I0=class extends he{constructor({horizontalAnchor:e,verticalAnchor:t,absoluteHorizontalPosition:n,relativeHorizontalPosition:i,absoluteVerticalPosition:s,relativeVerticalPosition:a,bottomFromText:o,topFromText:l,leftFromText:u,rightFromText:c,overlap:f}){super("w:tblpPr"),this.root.push(new xr({leftFromText:{key:"w:leftFromText",value:u===void 0?void 0:St(u)},rightFromText:{key:"w:rightFromText",value:c===void 0?void 0:St(c)},topFromText:{key:"w:topFromText",value:l===void 0?void 0:St(l)},bottomFromText:{key:"w:bottomFromText",value:o===void 0?void 0:St(o)},absoluteHorizontalPosition:{key:"w:tblpX",value:n===void 0?void 0:En(n)},absoluteVerticalPosition:{key:"w:tblpY",value:s===void 0?void 0:En(s)},horizontalAnchor:{key:"w:horzAnchor",value:e===void 0?void 0:e},relativeHorizontalPosition:{key:"w:tblpXSpec",value:i},relativeVerticalPosition:{key:"w:tblpYSpec",value:a},verticalAnchor:{key:"w:vertAnchor",value:t}})),f&&this.root.push(new Ay("w:tblOverlap",f))}},P0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{type:"w:type"})}},D0=class extends he{constructor(e){super("w:tblLayout"),this.root.push(new P0({type:e}))}},fJ={DXA:"dxa"},cf=class extends he{constructor({type:e=fJ.DXA,value:t}){super("w:tblCellSpacing"),this.root.push(new xr({type:{key:"w:type",value:e},value:{key:"w:w",value:h5(t)}}))}},M0=class extends _r{constructor(e){super("w:tblPr"),e.style&&this.root.push(new kn("w:tblStyle",e.style)),e.float&&this.root.push(new I0(e.float)),e.visuallyRightToLeft!==void 0&&this.root.push(new ge("w:bidiVisual",e.visuallyRightToLeft)),e.width&&this.root.push(new Sn("w:tblW",e.width)),e.alignment&&this.root.push(new Jc(e.alignment)),e.indent&&this.root.push(new Sn("w:tblInd",e.indent)),e.borders&&this.root.push(new uf(e.borders)),e.shading&&this.root.push(new Ws(e.shading)),e.layout&&this.root.push(new D0(e.layout)),e.cellMargin&&this.root.push(new af(A5.TABLE,e.cellMargin)),e.cellSpacing&&this.root.push(new cf(e.cellSpacing))}},La=class extends rf{constructor({rows:e,width:t,columnWidths:n=Array(Math.max(...e.map(h=>h.CellCount))).fill(100),margins:i,indent:s,float:a,layout:o,style:l,borders:u,alignment:c,visuallyRightToLeft:f,cellSpacing:d}){super("w:tbl"),this.root.push(new M0({borders:u??{},width:t??{size:100},indent:s,float:a,layout:o,style:l,alignment:c,cellMargin:i,visuallyRightToLeft:f,cellSpacing:d})),this.root.push(new x0(n));for(let h of e)this.root.push(h);e.forEach((h,y)=>{if(y===e.length-1)return;let v=0;h.cells.forEach(x=>{if(x.options.rowSpan&&x.options.rowSpan>1){let m=new Bi({rowSpan:x.options.rowSpan-1,columnSpan:x.options.columnSpan,borders:x.options.borders,children:[],verticalMerge:O5.CONTINUE});e[y+1].addCellToColumnIndex(m,v)}v+=x.options.columnSpan||1})})}},L0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{value:"w:val",rule:"w:hRule"})}},F0=class extends he{constructor(e,t){super("w:trHeight"),this.root.push(new L0({value:St(e),rule:t}))}},B0=class extends _r{constructor(e){super("w:trPr"),e.cantSplit!==void 0&&this.root.push(new ge("w:cantSplit",e.cantSplit)),e.tableHeader!==void 0&&this.root.push(new ge("w:tblHeader",e.tableHeader)),e.height&&this.root.push(new F0(e.height.value,e.height.rule)),e.cellSpacing&&this.root.push(new cf(e.cellSpacing))}},Fa=class extends he{constructor(e){super("w:tr"),this.options=e,this.root.push(new B0(e));for(let t of e.children)this.root.push(t)}get CellCount(){return this.options.children.length}get cells(){return this.root.filter(e=>e instanceof Bi)}addCellToIndex(e,t){this.root.splice(t+1,0,e)}addCellToColumnIndex(e,t){let n=this.columnIndexToRootIndex(t,!0);this.addCellToIndex(e,n-1)}rootIndexToColumnIndex(e){if(e<1||e>=this.root.length)throw new Error(`cell 'rootIndex' should between 1 to ${this.root.length-1}`);let t=0;for(let n=1;n<e;n++){let i=this.root[n];t+=i.options.columnSpan||1}return t}columnIndexToRootIndex(e,t=!1){if(e<0)throw new Error("cell 'columnIndex' should not less than zero");let n=0,i=1;for(;n<=e;){if(i>=this.root.length){if(t)return this.root.length;throw new Error(`cell 'columnIndex' should not great than ${n-1}`)}let s=this.root[i];i+=1,n+=s&&s.options.columnSpan||1}return i-1}},U0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}},H0=class extends he{constructor(){super("Properties"),this.root.push(new U0({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}},z0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{xmlns:"xmlns"})}},j0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}},br=class extends he{constructor(e,t){super("Default"),this.root.push(new j0({contentType:e,extension:t}))}},W0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}},Vt=class extends he{constructor(e,t){super("Override"),this.root.push(new W0({contentType:e,partName:t}))}},q0=class extends he{constructor(){super("Types"),this.root.push(new z0({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new br("image/png","png")),this.root.push(new br("image/jpeg","jpeg")),this.root.push(new br("image/jpeg","jpg")),this.root.push(new br("image/bmp","bmp")),this.root.push(new br("image/gif","gif")),this.root.push(new br("image/svg+xml","svg")),this.root.push(new br("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new br("application/xml","xml")),this.root.push(new br("application/vnd.openxmlformats-officedocument.obfuscatedFont","odttf")),this.root.push(new Vt("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new Vt("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new Vt("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new Vt("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new Vt("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new Vt("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new Vt("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new Vt("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new Vt("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),this.root.push(new Vt("application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml","/word/fontTable.xml"))}addFooter(e){this.root.push(new Vt("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${e}.xml`))}addHeader(e){this.root.push(new Vt("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${e}.xml`))}},V0=class extends he{constructor(e){super("cp:coreProperties"),this.root.push(new Ks(["cp","dc","dcterms","dcmitype","xsi"])),e.title&&this.root.push(new _n("dc:title",e.title)),e.subject&&this.root.push(new _n("dc:subject",e.subject)),e.creator&&this.root.push(new _n("dc:creator",e.creator)),e.keywords&&this.root.push(new _n("cp:keywords",e.keywords)),e.description&&this.root.push(new _n("dc:description",e.description)),e.lastModifiedBy&&this.root.push(new _n("cp:lastModifiedBy",e.lastModifiedBy)),e.revision&&this.root.push(new _n("cp:revision",String(e.revision))),this.root.push(new ff("dcterms:created")),this.root.push(new ff("dcterms:modified"))}},K0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{type:"xsi:type"})}},ff=class extends he{constructor(e){super(e),this.root.push(new K0({type:"dcterms:W3CDTF"})),this.root.push(x$(new Date))}},G0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}},$0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{fmtid:"fmtid",pid:"pid",name:"name"})}},J0=class extends he{constructor(e,t){super("property"),this.root.push(new $0({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e.toString(),name:t.name})),this.root.push(new X0(t.value))}},X0=class extends he{constructor(e){super("vt:lpwstr"),this.root.push(e)}},Y0=class extends he{constructor(e){super("Properties"),de(this,"nextId"),de(this,"properties",[]),this.root.push(new G0({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(let t of e)this.addCustomProperty(t)}prepForXml(e){return this.properties.forEach(t=>this.root.push(t)),super.prepForXml(e)}addCustomProperty(e){this.properties.push(new J0(this.nextId++,e))}},Vc=({id:r,fontKey:e,subsetted:t},n)=>new Fe({name:n,attributes:Re({id:{key:"r:id",value:r}},e?{fontKey:{key:"w:fontKey",value:`{${e}}`}}:{}),children:[...t?[new ge("w:subsetted",t)]:[]]}),hJ=({name:r,altName:e,panose1:t,charset:n,family:i,notTrueType:s,pitch:a,sig:o,embedRegular:l,embedBold:u,embedItalic:c,embedBoldItalic:f})=>new Fe({name:"w:font",attributes:{name:{key:"w:name",value:r}},children:[...e?[xa("w:altName",e)]:[],...t?[xa("w:panose1",t)]:[],...n?[xa("w:charset",n)]:[],xa("w:family",i),...s?[new ge("w:notTrueType",s)]:[],xa("w:pitch",a),...o?[new Fe({name:"w:sig",attributes:{usb0:{key:"w:usb0",value:o.usb0},usb1:{key:"w:usb1",value:o.usb1},usb2:{key:"w:usb2",value:o.usb2},usb3:{key:"w:usb3",value:o.usb3},csb0:{key:"w:csb0",value:o.csb0},csb1:{key:"w:csb1",value:o.csb1}}})]:[],...l?[Vc(l,"w:embedRegular")]:[],...u?[Vc(u,"w:embedBold")]:[],...c?[Vc(c,"w:embedItalic")]:[],...f?[Vc(f,"w:embedBoldItalic")]:[]]}),dJ=({name:r,index:e,fontKey:t,characterSet:n})=>hJ({name:r,sig:{usb0:"E0002AFF",usb1:"C000247B",usb2:"00000009",usb3:"00000000",csb0:"000001FF",csb1:"00000000"},charset:n,family:"auto",pitch:"variable",embedRegular:{fontKey:t,id:`rId${e}`}}),pJ=r=>new Fe({name:"w:fonts",attributes:{mc:{key:"xmlns:mc",value:"http://schemas.openxmlformats.org/markup-compatibility/2006"},r:{key:"xmlns:r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"},w:{key:"xmlns:w",value:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},w14:{key:"xmlns:w14",value:"http://schemas.microsoft.com/office/word/2010/wordml"},w15:{key:"xmlns:w15",value:"http://schemas.microsoft.com/office/word/2012/wordml"},w16cex:{key:"xmlns:w16cex",value:"http://schemas.microsoft.com/office/word/2018/wordml/cex"},w16cid:{key:"xmlns:w16cid",value:"http://schemas.microsoft.com/office/word/2016/wordml/cid"},w16:{key:"xmlns:w16",value:"http://schemas.microsoft.com/office/word/2018/wordml"},w16sdtdh:{key:"xmlns:w16sdtdh",value:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash"},w16se:{key:"xmlns:w16se",value:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ignorable:{key:"mc:Ignorable",value:"w14 w15 w16se w16cid w16 w16cex w16sdtdh"}},children:r.map((e,t)=>dJ({name:e.name,index:t+1,fontKey:e.fontKey}))}),Z0=class{constructor(e){de(this,"fontTable"),de(this,"relationships"),de(this,"fontOptionsWithKey",[]),this.options=e,this.fontOptionsWithKey=e.map(t=>Tn(Re({},t),{fontKey:j$()})),this.fontTable=pJ(this.fontOptionsWithKey),this.relationships=new Rn;for(let t=0;t<e.length;t++)this.relationships.createRelationship(t+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",`fonts/${e[t].name}.odttf`)}get View(){return this.fontTable}get Relationships(){return this.relationships}},Q0=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}},mJ=class extends $c{constructor(e,t){super("w:ftr",t),de(this,"refId"),this.refId=e,t||this.root.push(new Q0({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}},eb=class{constructor(e,t,n){de(this,"footer"),de(this,"relationships"),this.media=e,this.footer=new mJ(t,n),this.relationships=new Rn}add(e){this.footer.add(e)}addChildElement(e){this.footer.addChildElement(e)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}},tb=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{type:"w:type",id:"w:id"})}},rb=class extends he{constructor(){super("w:footnoteRef")}},nb=class extends Nn{constructor(){super({style:"FootnoteReference"}),this.root.push(new rb)}},L2={SEPERATOR:"separator",CONTINUATION_SEPERATOR:"continuationSeparator"},Ra=class extends he{constructor(e){super("w:footnote"),this.root.push(new tb({type:e.type,id:e.id}));for(let t=0;t<e.children.length;t++){let n=e.children[t];t===0&&n.addRunToFront(new nb),this.root.push(n)}}},ib=class extends he{constructor(){super("w:continuationSeparator")}},sb=class extends Nn{constructor(){super({}),this.root.push(new ib)}},ob=class extends he{constructor(){super("w:separator")}},ab=class extends Nn{constructor(){super({}),this.root.push(new ob)}},lb=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}},ub=class extends he{constructor(){super("w:footnotes"),this.root.push(new lb({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));let e=new Ra({id:-1,type:L2.SEPERATOR,children:[new $t({spacing:{after:0,line:240,lineRule:jw.AUTO},children:[new ab]})]});this.root.push(e);let t=new Ra({id:0,type:L2.CONTINUATION_SEPERATOR,children:[new $t({spacing:{after:0,line:240,lineRule:jw.AUTO},children:[new sb]})]});this.root.push(t)}createFootNote(e,t){let n=new Ra({id:e,children:t});this.root.push(n)}},cb=class{constructor(){de(this,"footnotess"),de(this,"relationships"),this.footnotess=new ub,this.relationships=new Rn}get View(){return this.footnotess}get Relationships(){return this.relationships}},fb=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}},gJ=class extends $c{constructor(e,t){super("w:hdr",t),de(this,"refId"),this.refId=e,t||this.root.push(new fb({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}},hb=class{constructor(e,t,n){de(this,"header"),de(this,"relationships"),this.media=e,this.header=new gJ(t,n),this.relationships=new Rn}add(e){return this.header.add(e),this}addChildElement(e){this.header.addChildElement(e)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}},db=class{constructor(){de(this,"map"),this.map=new Map}addImage(e,t){this.map.set(e,t)}get Array(){return Array.from(this.map.values())}},Gt={DECIMAL:"decimal",UPPER_ROMAN:"upperRoman",LOWER_ROMAN:"lowerRoman",UPPER_LETTER:"upperLetter",LOWER_LETTER:"lowerLetter",ORDINAL:"ordinal",CARDINAL_TEXT:"cardinalText",ORDINAL_TEXT:"ordinalText",HEX:"hex",CHICAGO:"chicago",IDEOGRAPH__DIGITAL:"ideographDigital",JAPANESE_COUNTING:"japaneseCounting",AIUEO:"aiueo",IROHA:"iroha",DECIMAL_FULL_WIDTH:"decimalFullWidth",DECIMAL_HALF_WIDTH:"decimalHalfWidth",JAPANESE_LEGAL:"japaneseLegal",JAPANESE_DIGITAL_TEN_THOUSAND:"japaneseDigitalTenThousand",DECIMAL_ENCLOSED_CIRCLE:"decimalEnclosedCircle",DECIMAL_FULL_WIDTH2:"decimalFullWidth2",AIUEO_FULL_WIDTH:"aiueoFullWidth",IROHA_FULL_WIDTH:"irohaFullWidth",DECIMAL_ZERO:"decimalZero",BULLET:"bullet",GANADA:"ganada",CHOSUNG:"chosung",DECIMAL_ENCLOSED_FULLSTOP:"decimalEnclosedFullstop",DECIMAL_ENCLOSED_PARENTHESES:"decimalEnclosedParen",DECIMAL_ENCLOSED_CIRCLE_CHINESE:"decimalEnclosedCircleChinese",IDEOGRAPH_ENCLOSED_CIRCLE:"ideographEnclosedCircle",IDEOGRAPH_TRADITIONAL:"ideographTraditional",IDEOGRAPH_ZODIAC:"ideographZodiac",IDEOGRAPH_ZODIAC_TRADITIONAL:"ideographZodiacTraditional",TAIWANESE_COUNTING:"taiwaneseCounting",IDEOGRAPH_LEGAL_TRADITIONAL:"ideographLegalTraditional",TAIWANESE_COUNTING_THOUSAND:"taiwaneseCountingThousand",TAIWANESE_DIGITAL:"taiwaneseDigital",CHINESE_COUNTING:"chineseCounting",CHINESE_LEGAL_SIMPLIFIED:"chineseLegalSimplified",CHINESE_COUNTING_THOUSAND:"chineseCountingThousand",KOREAN_DIGITAL:"koreanDigital",KOREAN_COUNTING:"koreanCounting",KOREAN_LEGAL:"koreanLegal",KOREAN_DIGITAL2:"koreanDigital2",VIETNAMESE_COUNTING:"vietnameseCounting",RUSSIAN_LOWER:"russianLower",RUSSIAN_UPPER:"russianUpper",NONE:"none",NUMBER_IN_DASH:"numberInDash",HEBREW1:"hebrew1",HEBREW2:"hebrew2",ARABIC_ALPHA:"arabicAlpha",ARABIC_ABJAD:"arabicAbjad",HINDI_VOWELS:"hindiVowels",HINDI_CONSONANTS:"hindiConsonants",HINDI_NUMBERS:"hindiNumbers",HINDI_COUNTING:"hindiCounting",THAI_LETTERS:"thaiLetters",THAI_NUMBERS:"thaiNumbers",THAI_COUNTING:"thaiCounting",BAHT_TEXT:"bahtText",DOLLAR_TEXT:"dollarText",CUSTOM:"custom"},pb=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}},mb=class extends he{constructor(e){super("w:numFmt"),this.root.push(new $e({val:e}))}},gb=class extends he{constructor(e){super("w:lvlText"),this.root.push(new $e({val:e}))}},vb=class extends he{constructor(e){super("w:lvlJc"),this.root.push(new $e({val:e}))}},yb=class extends he{constructor(e){super("w:suff"),this.root.push(new $e({val:e}))}},wb=class extends he{constructor(){super("w:isLgl")}},bb=class extends he{constructor({level:e,format:t,text:n,alignment:i=mt.START,start:s=1,style:a,suffix:o,isLegalNumberingStyle:l}){if(super("w:lvl"),de(this,"paragraphProperties"),de(this,"runProperties"),this.root.push(new Di("w:start",Ct(s))),t&&this.root.push(new mb(t)),o&&this.root.push(new yb(o)),l&&this.root.push(new wb),n&&this.root.push(new gb(n)),this.root.push(new vb(i)),this.paragraphProperties=new Qn(a&&a.paragraph),this.runProperties=new On(a&&a.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new pb({ilvl:Ct(e),tentative:1}))}},_b=class extends bb{},xb=class extends he{constructor(e){super("w:multiLevelType"),this.root.push(new $e({val:e}))}},Eb=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}},hf=class extends he{constructor(e,t){super("w:abstractNum"),de(this,"id"),this.root.push(new Eb({abstractNumId:Ct(e),restartNumberingAfterBreak:0})),this.root.push(new xb("hybridMultilevel")),this.id=e;for(let n of t)this.root.push(new _b(n))}},Sb=class extends he{constructor(e){super("w:abstractNumId"),this.root.push(new $e({val:e}))}},kb=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{numId:"w:numId"})}},df=class extends he{constructor(e){if(super("w:num"),de(this,"numId"),de(this,"reference"),de(this,"instance"),this.numId=e.numId,this.reference=e.reference,this.instance=e.instance,this.root.push(new kb({numId:Ct(e.numId)})),this.root.push(new Sb(Ct(e.abstractNumId))),e.overrideLevels&&e.overrideLevels.length)for(let t of e.overrideLevels)this.root.push(new Ab(t.num,t.start))}},Tb=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{ilvl:"w:ilvl"})}},Ab=class extends he{constructor(e,t){super("w:lvlOverride"),this.root.push(new Tb({ilvl:e})),t!==void 0&&this.root.push(new Nb(t))}},Ob=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{val:"w:val"})}},Nb=class extends he{constructor(e){super("w:startOverride"),this.root.push(new Ob({val:e}))}},Rb=class extends he{constructor(e){super("w:numbering"),de(this,"abstractNumberingMap",new Map),de(this,"concreteNumberingMap",new Map),de(this,"referenceConfigMap",new Map),de(this,"abstractNumUniqueNumericId",B$()),de(this,"concreteNumUniqueNumericId",U$()),this.root.push(new Ks(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps"],"w14 w15 wp14"));let t=new hf(this.abstractNumUniqueNumericId(),[{level:0,format:Gt.BULLET,text:"\u25CF",alignment:mt.LEFT,style:{paragraph:{indent:{left:Kt(.5),hanging:Kt(.25)}}}},{level:1,format:Gt.BULLET,text:"\u25CB",alignment:mt.LEFT,style:{paragraph:{indent:{left:Kt(1),hanging:Kt(.25)}}}},{level:2,format:Gt.BULLET,text:"\u25A0",alignment:mt.LEFT,style:{paragraph:{indent:{left:2160,hanging:Kt(.25)}}}},{level:3,format:Gt.BULLET,text:"\u25CF",alignment:mt.LEFT,style:{paragraph:{indent:{left:2880,hanging:Kt(.25)}}}},{level:4,format:Gt.BULLET,text:"\u25CB",alignment:mt.LEFT,style:{paragraph:{indent:{left:3600,hanging:Kt(.25)}}}},{level:5,format:Gt.BULLET,text:"\u25A0",alignment:mt.LEFT,style:{paragraph:{indent:{left:4320,hanging:Kt(.25)}}}},{level:6,format:Gt.BULLET,text:"\u25CF",alignment:mt.LEFT,style:{paragraph:{indent:{left:5040,hanging:Kt(.25)}}}},{level:7,format:Gt.BULLET,text:"\u25CF",alignment:mt.LEFT,style:{paragraph:{indent:{left:5760,hanging:Kt(.25)}}}},{level:8,format:Gt.BULLET,text:"\u25CF",alignment:mt.LEFT,style:{paragraph:{indent:{left:6480,hanging:Kt(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new df({numId:1,abstractNumId:t.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",t);for(let n of e.config)this.abstractNumberingMap.set(n.reference,new hf(this.abstractNumUniqueNumericId(),n.levels)),this.referenceConfigMap.set(n.reference,n.levels)}prepForXml(e){for(let t of this.abstractNumberingMap.values())this.root.push(t);for(let t of this.concreteNumberingMap.values())this.root.push(t);return super.prepForXml(e)}createConcreteNumberingInstance(e,t){let n=this.abstractNumberingMap.get(e);if(!n)return;let i=`${e}-${t}`;if(this.concreteNumberingMap.has(i))return;let s=this.referenceConfigMap.get(e),a=s&&s[0].start,o={numId:this.concreteNumUniqueNumericId(),abstractNumId:n.id,reference:e,instance:t,overrideLevels:[a&&Number.isInteger(a)?{num:0,start:a}:{num:0,start:1}]};this.concreteNumberingMap.set(i,new df(o))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}},Cb=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}},Ib=class extends he{constructor(e){super("w:compatSetting"),this.root.push(new Cb({version:e,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}},Pb=class extends he{constructor(e){super("w:compat"),e.version&&this.root.push(new Ib(e.version)),e.useSingleBorderforContiguousCells&&this.root.push(new ge("w:useSingleBorderforContiguousCells",e.useSingleBorderforContiguousCells)),e.wordPerfectJustification&&this.root.push(new ge("w:wpJustification",e.wordPerfectJustification)),e.noTabStopForHangingIndent&&this.root.push(new ge("w:noTabHangInd",e.noTabStopForHangingIndent)),e.noLeading&&this.root.push(new ge("w:noLeading",e.noLeading)),e.spaceForUnderline&&this.root.push(new ge("w:spaceForUL",e.spaceForUnderline)),e.noColumnBalance&&this.root.push(new ge("w:noColumnBalance",e.noColumnBalance)),e.balanceSingleByteDoubleByteWidth&&this.root.push(new ge("w:balanceSingleByteDoubleByteWidth",e.balanceSingleByteDoubleByteWidth)),e.noExtraLineSpacing&&this.root.push(new ge("w:noExtraLineSpacing",e.noExtraLineSpacing)),e.doNotLeaveBackslashAlone&&this.root.push(new ge("w:doNotLeaveBackslashAlone",e.doNotLeaveBackslashAlone)),e.underlineTrailingSpaces&&this.root.push(new ge("w:ulTrailSpace",e.underlineTrailingSpaces)),e.doNotExpandShiftReturn&&this.root.push(new ge("w:doNotExpandShiftReturn",e.doNotExpandShiftReturn)),e.spacingInWholePoints&&this.root.push(new ge("w:spacingInWholePoints",e.spacingInWholePoints)),e.lineWrapLikeWord6&&this.root.push(new ge("w:lineWrapLikeWord6",e.lineWrapLikeWord6)),e.printBodyTextBeforeHeader&&this.root.push(new ge("w:printBodyTextBeforeHeader",e.printBodyTextBeforeHeader)),e.printColorsBlack&&this.root.push(new ge("w:printColBlack",e.printColorsBlack)),e.spaceWidth&&this.root.push(new ge("w:wpSpaceWidth",e.spaceWidth)),e.showBreaksInFrames&&this.root.push(new ge("w:showBreaksInFrames",e.showBreaksInFrames)),e.subFontBySize&&this.root.push(new ge("w:subFontBySize",e.subFontBySize)),e.suppressBottomSpacing&&this.root.push(new ge("w:suppressBottomSpacing",e.suppressBottomSpacing)),e.suppressTopSpacing&&this.root.push(new ge("w:suppressTopSpacing",e.suppressTopSpacing)),e.suppressSpacingAtTopOfPage&&this.root.push(new ge("w:suppressSpacingAtTopOfPage",e.suppressSpacingAtTopOfPage)),e.suppressTopSpacingWP&&this.root.push(new ge("w:suppressTopSpacingWP",e.suppressTopSpacingWP)),e.suppressSpBfAfterPgBrk&&this.root.push(new ge("w:suppressSpBfAfterPgBrk",e.suppressSpBfAfterPgBrk)),e.swapBordersFacingPages&&this.root.push(new ge("w:swapBordersFacingPages",e.swapBordersFacingPages)),e.convertMailMergeEsc&&this.root.push(new ge("w:convMailMergeEsc",e.convertMailMergeEsc)),e.truncateFontHeightsLikeWP6&&this.root.push(new ge("w:truncateFontHeightsLikeWP6",e.truncateFontHeightsLikeWP6)),e.macWordSmallCaps&&this.root.push(new ge("w:mwSmallCaps",e.macWordSmallCaps)),e.usePrinterMetrics&&this.root.push(new ge("w:usePrinterMetrics",e.usePrinterMetrics)),e.doNotSuppressParagraphBorders&&this.root.push(new ge("w:doNotSuppressParagraphBorders",e.doNotSuppressParagraphBorders)),e.wrapTrailSpaces&&this.root.push(new ge("w:wrapTrailSpaces",e.wrapTrailSpaces)),e.footnoteLayoutLikeWW8&&this.root.push(new ge("w:footnoteLayoutLikeWW8",e.footnoteLayoutLikeWW8)),e.shapeLayoutLikeWW8&&this.root.push(new ge("w:shapeLayoutLikeWW8",e.shapeLayoutLikeWW8)),e.alignTablesRowByRow&&this.root.push(new ge("w:alignTablesRowByRow",e.alignTablesRowByRow)),e.forgetLastTabAlignment&&this.root.push(new ge("w:forgetLastTabAlignment",e.forgetLastTabAlignment)),e.adjustLineHeightInTable&&this.root.push(new ge("w:adjustLineHeightInTable",e.adjustLineHeightInTable)),e.autoSpaceLikeWord95&&this.root.push(new ge("w:autoSpaceLikeWord95",e.autoSpaceLikeWord95)),e.noSpaceRaiseLower&&this.root.push(new ge("w:noSpaceRaiseLower",e.noSpaceRaiseLower)),e.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new ge("w:doNotUseHTMLParagraphAutoSpacing",e.doNotUseHTMLParagraphAutoSpacing)),e.layoutRawTableWidth&&this.root.push(new ge("w:layoutRawTableWidth",e.layoutRawTableWidth)),e.layoutTableRowsApart&&this.root.push(new ge("w:layoutTableRowsApart",e.layoutTableRowsApart)),e.useWord97LineBreakRules&&this.root.push(new ge("w:useWord97LineBreakRules",e.useWord97LineBreakRules)),e.doNotBreakWrappedTables&&this.root.push(new ge("w:doNotBreakWrappedTables",e.doNotBreakWrappedTables)),e.doNotSnapToGridInCell&&this.root.push(new ge("w:doNotSnapToGridInCell",e.doNotSnapToGridInCell)),e.selectFieldWithFirstOrLastCharacter&&this.root.push(new ge("w:selectFldWithFirstOrLastChar",e.selectFieldWithFirstOrLastCharacter)),e.applyBreakingRules&&this.root.push(new ge("w:applyBreakingRules",e.applyBreakingRules)),e.doNotWrapTextWithPunctuation&&this.root.push(new ge("w:doNotWrapTextWithPunct",e.doNotWrapTextWithPunctuation)),e.doNotUseEastAsianBreakRules&&this.root.push(new ge("w:doNotUseEastAsianBreakRules",e.doNotUseEastAsianBreakRules)),e.useWord2002TableStyleRules&&this.root.push(new ge("w:useWord2002TableStyleRules",e.useWord2002TableStyleRules)),e.growAutofit&&this.root.push(new ge("w:growAutofit",e.growAutofit)),e.useFELayout&&this.root.push(new ge("w:useFELayout",e.useFELayout)),e.useNormalStyleForList&&this.root.push(new ge("w:useNormalStyleForList",e.useNormalStyleForList)),e.doNotUseIndentAsNumberingTabStop&&this.root.push(new ge("w:doNotUseIndentAsNumberingTabStop",e.doNotUseIndentAsNumberingTabStop)),e.useAlternateEastAsianLineBreakRules&&this.root.push(new ge("w:useAltKinsokuLineBreakRules",e.useAlternateEastAsianLineBreakRules)),e.allowSpaceOfSameStyleInTable&&this.root.push(new ge("w:allowSpaceOfSameStyleInTable",e.allowSpaceOfSameStyleInTable)),e.doNotSuppressIndentation&&this.root.push(new ge("w:doNotSuppressIndentation",e.doNotSuppressIndentation)),e.doNotAutofitConstrainedTables&&this.root.push(new ge("w:doNotAutofitConstrainedTables",e.doNotAutofitConstrainedTables)),e.autofitToFirstFixedWidthCell&&this.root.push(new ge("w:autofitToFirstFixedWidthCell",e.autofitToFirstFixedWidthCell)),e.underlineTabInNumberingList&&this.root.push(new ge("w:underlineTabInNumList",e.underlineTabInNumberingList)),e.displayHangulFixedWidth&&this.root.push(new ge("w:displayHangulFixedWidth",e.displayHangulFixedWidth)),e.splitPgBreakAndParaMark&&this.root.push(new ge("w:splitPgBreakAndParaMark",e.splitPgBreakAndParaMark)),e.doNotVerticallyAlignCellWithSp&&this.root.push(new ge("w:doNotVertAlignCellWithSp",e.doNotVerticallyAlignCellWithSp)),e.doNotBreakConstrainedForcedTable&&this.root.push(new ge("w:doNotBreakConstrainedForcedTable",e.doNotBreakConstrainedForcedTable)),e.ignoreVerticalAlignmentInTextboxes&&this.root.push(new ge("w:doNotVertAlignInTxbx",e.ignoreVerticalAlignmentInTextboxes)),e.useAnsiKerningPairs&&this.root.push(new ge("w:useAnsiKerningPairs",e.useAnsiKerningPairs)),e.cachedColumnBalance&&this.root.push(new ge("w:cachedColBalance",e.cachedColumnBalance))}},Db=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}},Mb=class extends he{constructor(e){var t,n,i,s,a,o,l,u;super("w:settings"),this.root.push(new Db({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new ge("w:displayBackgroundShape",!0)),e.trackRevisions!==void 0&&this.root.push(new ge("w:trackRevisions",e.trackRevisions)),e.evenAndOddHeaders!==void 0&&this.root.push(new ge("w:evenAndOddHeaders",e.evenAndOddHeaders)),e.updateFields!==void 0&&this.root.push(new ge("w:updateFields",e.updateFields)),e.defaultTabStop!==void 0&&this.root.push(new Di("w:defaultTabStop",e.defaultTabStop)),((t=e.hyphenation)==null?void 0:t.autoHyphenation)!==void 0&&this.root.push(new ge("w:autoHyphenation",e.hyphenation.autoHyphenation)),((n=e.hyphenation)==null?void 0:n.hyphenationZone)!==void 0&&this.root.push(new Di("w:hyphenationZone",e.hyphenation.hyphenationZone)),((i=e.hyphenation)==null?void 0:i.consecutiveHyphenLimit)!==void 0&&this.root.push(new Di("w:consecutiveHyphenLimit",e.hyphenation.consecutiveHyphenLimit)),((s=e.hyphenation)==null?void 0:s.doNotHyphenateCaps)!==void 0&&this.root.push(new ge("w:doNotHyphenateCaps",e.hyphenation.doNotHyphenateCaps)),this.root.push(new Pb(Tn(Re({},(a=e.compatibility)!=null?a:{}),{version:(u=(l=(o=e.compatibility)==null?void 0:o.version)!=null?l:e.compatibilityModeVersion)!=null?u:15})))}},pf=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{val:"w:val"})}},Lb=class extends he{constructor(e){super("w:name"),this.root.push(new pf({val:e}))}},Fb=class extends he{constructor(e){super("w:uiPriority"),this.root.push(new pf({val:Ct(e)}))}},Bb=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}},mf=class extends he{constructor(e,t){super("w:style"),this.root.push(new Bb(e)),t.name&&this.root.push(new Lb(t.name)),t.basedOn&&this.root.push(new kn("w:basedOn",t.basedOn)),t.next&&this.root.push(new kn("w:next",t.next)),t.link&&this.root.push(new kn("w:link",t.link)),t.uiPriority!==void 0&&this.root.push(new Fb(t.uiPriority)),t.semiHidden!==void 0&&this.root.push(new ge("w:semiHidden",t.semiHidden)),t.unhideWhenUsed!==void 0&&this.root.push(new ge("w:unhideWhenUsed",t.unhideWhenUsed)),t.quickFormat!==void 0&&this.root.push(new ge("w:qFormat",t.quickFormat))}},Gs=class extends mf{constructor(e){super({type:"paragraph",styleId:e.id},e),de(this,"paragraphProperties"),de(this,"runProperties"),this.paragraphProperties=new Qn(e.paragraph),this.runProperties=new On(e.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}},$s=class extends mf{constructor(e){super({type:"character",styleId:e.id},Re({uiPriority:99,unhideWhenUsed:!0},e)),de(this,"runProperties"),this.runProperties=new On(e.run),this.root.push(this.runProperties)}},Vr=class extends Gs{constructor(e){super(Re({basedOn:"Normal",next:"Normal",quickFormat:!0},e))}},Ub=class extends Vr{constructor(e){super(Re({id:"Title",name:"Title"},e))}},Hb=class extends Vr{constructor(e){super(Re({id:"Heading1",name:"Heading 1"},e))}},zb=class extends Vr{constructor(e){super(Re({id:"Heading2",name:"Heading 2"},e))}},jb=class extends Vr{constructor(e){super(Re({id:"Heading3",name:"Heading 3"},e))}},Wb=class extends Vr{constructor(e){super(Re({id:"Heading4",name:"Heading 4"},e))}},qb=class extends Vr{constructor(e){super(Re({id:"Heading5",name:"Heading 5"},e))}},Vb=class extends Vr{constructor(e){super(Re({id:"Heading6",name:"Heading 6"},e))}},Kb=class extends Vr{constructor(e){super(Re({id:"Strong",name:"Strong"},e))}},Gb=class extends Gs{constructor(e){super(Re({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0},e))}},$b=class extends Gs{constructor(e){super(Re({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:jw.AUTO}},run:{size:20}},e))}},Jb=class extends $s{constructor(e){super(Re({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}},e))}},Xb=class extends $s{constructor(e){super(Re({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}},e))}},Yb=class extends $s{constructor(e){super(Re({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:m5.SINGLE}}},e))}},Ba=class extends he{constructor(e){if(super("w:styles"),e.initialStyles&&this.root.push(e.initialStyles),e.importedStyles)for(let t of e.importedStyles)this.root.push(t);if(e.paragraphStyles)for(let t of e.paragraphStyles)this.root.push(new Gs(t));if(e.characterStyles)for(let t of e.characterStyles)this.root.push(new $s(t))}},Zb=class extends he{constructor(e){super("w:pPrDefault"),this.root.push(new Qn(e))}},Qb=class extends he{constructor(e){super("w:rPrDefault"),this.root.push(new On(e))}},e1=class extends he{constructor(e){super("w:docDefaults"),de(this,"runPropertiesDefaults"),de(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new Qb(e.run),this.paragraphPropertiesDefaults=new Zb(e.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}},t1=class{newInstance(e){let t=u5.xml2js(e,{compact:!1}),n;for(let a of t.elements||[])a.name==="w:styles"&&(n=a);if(n===void 0)throw new Error("can not find styles element");let i=n.elements||[];return new Ba({initialStyles:new Ty(n.attributes),importedStyles:i.map(a=>m1(a))})}},gf=class{newInstance(e={}){var t;return{initialStyles:new Ks(["mc","r","w","w14","w15"],"w14 w15"),importedStyles:[new e1((t=e.document)!=null?t:{}),new Ub(Re({run:{size:56}},e.title)),new Hb(Re({run:{color:"2E74B5",size:32}},e.heading1)),new zb(Re({run:{color:"2E74B5",size:26}},e.heading2)),new jb(Re({run:{color:"1F4D78",size:24}},e.heading3)),new Wb(Re({run:{color:"2E74B5",italics:!0}},e.heading4)),new qb(Re({run:{color:"2E74B5"}},e.heading5)),new Vb(Re({run:{color:"1F4D78"}},e.heading6)),new Kb(Re({run:{bold:!0}},e.strong)),new Gb(e.listParagraph||{}),new Yb(e.hyperlink||{}),new Jb(e.footnoteReference||{}),new $b(e.footnoteText||{}),new Xb(e.footnoteTextChar||{})]}}},vf=class{constructor(e){de(this,"currentRelationshipId",1),de(this,"documentWrapper"),de(this,"headers",[]),de(this,"footers",[]),de(this,"coreProperties"),de(this,"numbering"),de(this,"media"),de(this,"fileRelationships"),de(this,"footnotesWrapper"),de(this,"settings"),de(this,"contentTypes"),de(this,"customProperties"),de(this,"appProperties"),de(this,"styles"),de(this,"comments"),de(this,"fontWrapper");var t,n,i,s,a,o,l,u,c,f,d,h;if(this.coreProperties=new V0(Tn(Re({},e),{creator:(t=e.creator)!=null?t:"Un-named",revision:(n=e.revision)!=null?n:1,lastModifiedBy:(i=e.lastModifiedBy)!=null?i:"Un-named"})),this.numbering=new Rb(e.numbering?e.numbering:{config:[]}),this.comments=new Hw((s=e.comments)!=null?s:{children:[]}),this.fileRelationships=new Rn,this.customProperties=new Y0((a=e.customProperties)!=null?a:[]),this.appProperties=new H0,this.footnotesWrapper=new cb,this.contentTypes=new q0,this.documentWrapper=new of({background:e.background}),this.settings=new Mb({compatibilityModeVersion:e.compatabilityModeVersion,compatibility:e.compatibility,evenAndOddHeaders:!!e.evenAndOddHeaderAndFooters,trackRevisions:(o=e.features)==null?void 0:o.trackRevisions,updateFields:(l=e.features)==null?void 0:l.updateFields,defaultTabStop:e.defaultTabStop,hyphenation:{autoHyphenation:(u=e.hyphenation)==null?void 0:u.autoHyphenation,hyphenationZone:(c=e.hyphenation)==null?void 0:c.hyphenationZone,consecutiveHyphenLimit:(f=e.hyphenation)==null?void 0:f.consecutiveHyphenLimit,doNotHyphenateCaps:(d=e.hyphenation)==null?void 0:d.doNotHyphenateCaps}}),this.media=new db,e.externalStyles!==void 0){let y=new t1;this.styles=y.newInstance(e.externalStyles)}else if(e.styles){let v=new gf().newInstance(e.styles.default);this.styles=new Ba(Re(Re({},v),e.styles))}else{let y=new gf;this.styles=new Ba(y.newInstance())}this.addDefaultRelationships();for(let y of e.sections)this.addSection(y);if(e.footnotes)for(let y in e.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(y),e.footnotes[y].children);this.fontWrapper=new Z0((h=e.fonts)!=null?h:[])}addSection({headers:e={},footers:t={},children:n,properties:i}){this.documentWrapper.View.Body.addSection(Tn(Re({},i),{headerWrapperGroup:{default:e.default?this.createHeader(e.default):void 0,first:e.first?this.createHeader(e.first):void 0,even:e.even?this.createHeader(e.even):void 0},footerWrapperGroup:{default:t.default?this.createFooter(t.default):void 0,first:t.first?this.createFooter(t.first):void 0,even:t.even?this.createFooter(t.even):void 0}}));for(let s of n)this.documentWrapper.View.add(s)}createHeader(e){let t=new hb(this.media,this.currentRelationshipId++);for(let n of e.options.children)t.add(n);return this.addHeaderToDocument(t),t}createFooter(e){let t=new eb(this.media,this.currentRelationshipId++);for(let n of e.options.children)t.add(n);return this.addFooterToDocument(t),t}addHeaderToDocument(e,t=Us.DEFAULT){this.headers.push({header:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(e,t=Us.DEFAULT){this.footers.push({footer:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(e=>e.header)}get Footers(){return this.footers.map(e=>e.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}get FontTable(){return this.fontWrapper}},r1=class extends be{constructor(){super(...arguments),de(this,"xmlKeys",{id:"w:id"})}},n1=class extends he{constructor(e){super("w:footnoteReference"),this.root.push(new r1({id:e}))}},Ua=class extends Nn{constructor(e){super({style:"FootnoteReference"}),this.root.push(new n1(e))}},vJ=h1();vy={exports:{}};wJ=yJ(),bJ=o1(wJ),Sa={exports:{}};EJ=xJ(),Qe=o1(EJ),ka=0,wy=32,SJ=32,kJ=(r,e)=>{let t=e.replace(/-/g,"");if(t.length!==SJ)throw new Error(`Error: Cannot extract GUID from font filename: ${e}`);let i=t.replace(/(..)/g,"$1 ").trim().split(" ").map(l=>parseInt(l,16));i.reverse();let a=r.slice(ka,wy).map((l,u)=>l^i[u%i.length]),o=new Uint8Array(ka+a.length+Math.max(0,r.length-wy));return o.set(r.slice(0,ka)),o.set(a,ka),o.set(r.slice(wy),ka+a.length),o},Ha=class{format(e,t={stack:[]}){let n=e.prepForXml(t);if(n)return n;throw Error("XMLComponent did not format correctly")}},yf=class{replace(e,t,n){let i=e;return t.forEach((s,a)=>{i=i.replace(new RegExp(`{${s.fileName}}`,"g"),(n+a).toString())}),i}getMediaData(e,t){return t.Array.filter(n=>e.search(`{${n.fileName}}`)>0)}},i1=class{replace(e,t){let n=e;for(let i of t)n=n.replace(new RegExp(`{${i.reference}-${i.instance}}`,"g"),i.numId.toString());return n}},s1=class{constructor(){de(this,"formatter"),de(this,"imageReplacer"),de(this,"numberingReplacer"),this.formatter=new Ha,this.imageReplacer=new yf,this.numberingReplacer=new i1}compile(e,t,n=[]){let i=new bJ,s=this.xmlifyFile(e,t),a=new Map(Object.entries(s));for(let[,o]of a)if(Array.isArray(o))for(let l of o)i.file(l.path,l.data);else i.file(o.path,o.data);for(let o of n)i.file(o.path,o.data);for(let o of e.Media.Array)o.type!=="svg"?i.file(`word/media/${o.fileName}`,o.data):(i.file(`word/media/${o.fileName}`,o.data),i.file(`word/media/${o.fallback.fileName}`,o.fallback.data));for(let{data:o,name:l,fontKey:u}of e.FontTable.fontOptionsWithKey){let[c]=l.split(".");i.file(`word/fonts/${c}.odttf`,kJ(o,u))}return i}xmlifyFile(e,t){let n=e.Document.Relationships.RelationshipCount+1,i=Qe(this.formatter.format(e.Document.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),s=e.Comments.Relationships.RelationshipCount+1,a=Qe(this.formatter.format(e.Comments,{viewWrapper:{View:e.Comments,Relationships:e.Comments.Relationships},file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),o=this.imageReplacer.getMediaData(i,e.Media),l=this.imageReplacer.getMediaData(a,e.Media);return{Relationships:{data:(o.forEach((u,c)=>{e.Document.Relationships.createRelationship(n+c,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${u.fileName}`)}),e.Document.Relationships.createRelationship(e.Document.Relationships.RelationshipCount+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable","fontTable.xml"),Qe(this.formatter.format(e.Document.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{let u=this.imageReplacer.replace(i,o,n);return this.numberingReplacer.replace(u,e.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{let u=Qe(this.formatter.format(e.Styles,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(u,e.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:Qe(this.formatter.format(e.CoreProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:Qe(this.formatter.format(e.Numbering,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:Qe(this.formatter.format(e.FileRelationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:e.Headers.map((u,c)=>{let f=Qe(this.formatter.format(u.View,{viewWrapper:u,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(f,e.Media).forEach((h,y)=>{u.Relationships.createRelationship(y,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${h.fileName}`)}),{data:Qe(this.formatter.format(u.Relationships,{viewWrapper:u,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${c+1}.xml.rels`}}),FooterRelationships:e.Footers.map((u,c)=>{let f=Qe(this.formatter.format(u.View,{viewWrapper:u,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(f,e.Media).forEach((h,y)=>{u.Relationships.createRelationship(y,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${h.fileName}`)}),{data:Qe(this.formatter.format(u.Relationships,{viewWrapper:u,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${c+1}.xml.rels`}}),Headers:e.Headers.map((u,c)=>{let f=Qe(this.formatter.format(u.View,{viewWrapper:u,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),d=this.imageReplacer.getMediaData(f,e.Media),h=this.imageReplacer.replace(f,d,0);return{data:this.numberingReplacer.replace(h,e.Numbering.ConcreteNumbering),path:`word/header${c+1}.xml`}}),Footers:e.Footers.map((u,c)=>{let f=Qe(this.formatter.format(u.View,{viewWrapper:u,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),d=this.imageReplacer.getMediaData(f,e.Media),h=this.imageReplacer.replace(f,d,0);return{data:this.numberingReplacer.replace(h,e.Numbering.ConcreteNumbering),path:`word/footer${c+1}.xml`}}),ContentTypes:{data:Qe(this.formatter.format(e.ContentTypes,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:Qe(this.formatter.format(e.CustomProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:Qe(this.formatter.format(e.AppProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:Qe(this.formatter.format(e.FootNotes.View,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:Qe(this.formatter.format(e.FootNotes.Relationships,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:Qe(this.formatter.format(e.Settings,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:(()=>{let u=this.imageReplacer.replace(a,l,s);return this.numberingReplacer.replace(u,e.Numbering.ConcreteNumbering)})(),path:"word/comments.xml"},CommentsRelationships:{data:(l.forEach((u,c)=>{e.Comments.Relationships.createRelationship(s+c,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${u.fileName}`)}),Qe(this.formatter.format(e.Comments.Relationships,{viewWrapper:{View:e.Comments,Relationships:e.Comments.Relationships},file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}})),path:"word/_rels/comments.xml.rels"},FontTable:{data:Qe(this.formatter.format(e.FontTable.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/fontTable.xml"},FontTableRelationships:{data:Qe(this.formatter.format(e.FontTable.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/fontTable.xml.rels"}}}},TJ={NONE:"",WITH_2_BLANKS:"  ",WITH_4_BLANKS:"    ",WITH_TAB:"	"},H2=r=>r===!0?TJ.WITH_2_BLANKS:r===!1?void 0:r,N5=class Fs{static pack(e,t,n){return wG(this,arguments,function*(i,s,a,o=[]){return this.compiler.compile(i,H2(a),o).generateAsync({type:s,mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toString(e,t,n=[]){return Fs.pack(e,"string",t,n)}static toBuffer(e,t,n=[]){return Fs.pack(e,"nodebuffer",t,n)}static toBase64String(e,t,n=[]){return Fs.pack(e,"base64",t,n)}static toBlob(e,t,n=[]){return Fs.pack(e,"blob",t,n)}static toArrayBuffer(e,t,n=[]){return Fs.pack(e,"arraybuffer",t,n)}static toStream(e,t,n=[]){let i=new vJ.Stream;return this.compiler.compile(e,H2(t),n).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(a=>{i.emit("data",a),i.emit("end")}),i}};de(N5,"compiler",new s1);R5=N5,jee=new Ha,Wee=new Ha,qee=new yf,Vee=new Uint8Array([255,254]),Kee=new Uint8Array([254,255])});function Ui(r,e,t){return r.byteLength>=e+t}function In(r,e,t=!1){if(Ui(r,e,4))return r.getUint32(e,t)}function Hi(r,e,t=!1){if(Ui(r,e,2))return r.getUint16(e,t)}function Ef(r){if(r.length<16||!(r[4]===102&&r[5]===116&&r[6]===121&&r[7]===112))return;let t=new DataView(r.buffer,r.byteOffset,r.byteLength),n=In(t,0);if(n===void 0||n<16||n>r.length)return;let i=[];i.push(String.fromCodePoint(...r.slice(8,12)));for(let s=16;s+4<=n;s+=4)i.push(String.fromCodePoint(...r.slice(s,s+4)));return i}function Sf(r,e){let t=new DataView(r.buffer,r.byteOffset,r.byteLength),n=In(t,e);if(n!==void 0&&!(r.length<n+e||n<8))return{type:String.fromCodePoint(...r.slice(e+4,e+8)),data:r.slice(e+8,e+n),tail:e+n}}function kf(r){let e=[],t=0;for(;t<r.length;){let n=Sf(r,t);if(!n)break;n.type==="meta"&&AJ(n.data,e),t=n.tail}return e}function AJ(r,e){let t=4;for(;t<r.length;){let n=Sf(r,t);if(!n)break;n.type==="iprp"&&OJ(n.data,e),t=n.tail}return e}function OJ(r,e){let t=0;for(;t<r.length;){let n=Sf(r,t);if(!n)break;n.type==="ipco"&&NJ(n.data,e),t=n.tail}}function NJ(r,e){let t=0;for(;t<r.length;){let n=Sf(r,t);if(!n)break;if(n.type==="ispe"){let i=new DataView(n.data.buffer,n.data.byteOffset,n.data.byteLength),s=In(i,4),a=In(i,8);if(s===void 0||a===void 0)return;e.push({width:s,height:a})}t=n.tail}}function Tf(r){let e=r[0];for(let t of r)t.width*t.height>e.width*e.height&&(e=t);return e}var zi=jt(()=>{});function b1(r){if(!RJ(r))return;let e=new DataView(r.buffer),t=CJ(r),n=In(e,t?32:16,!1),i=In(e,t?36:20,!1);if(!(n===void 0||i===void 0))return{width:n,height:i,type:"png"}}var RJ,CJ,C5=jt(()=>{zi();RJ=r=>r[0]===137&&r[1]===80&&r[2]===78&&r[3]===71&&r[4]===13&&r[5]===10&&r[6]===26&&r[7]===10,CJ=r=>r[12]===67&&r[13]===103&&r[14]===66&&r[15]===73});function _1(r){if(!DJ(r))return;let e=new DataView(r.buffer),t=2;for(;Ui(e,t,2);){let n=e.getUint16(t);if(t+=2,n>=IJ&&n<=PJ){let s=Hi(e,t+3,!1),a=Hi(e,t+5,!1);return s===void 0||a===void 0?void 0:{height:s,width:a,type:"jpeg"}}let i=Hi(e,t);if(i===void 0||(t+=i,t>e.byteLength))return}}var IJ,PJ,DJ,I5=jt(()=>{zi();IJ=65472,PJ=65475,DJ=r=>r[0]===255&&r[1]===216&&r[2]===255});function x1(r){if(!MJ(r))return;let e=new DataView(r.buffer),t=Hi(e,6,!0),n=Hi(e,8,!0);if(!(t===void 0||n===void 0))return{width:t,height:n,type:"gif"}}var MJ,P5=jt(()=>{zi();MJ=r=>r[0]===71&&r[1]===73&&r[2]===70&&r[3]===56&&(r[4]===55||r[4]===57)&&r[5]===97});function D5(r,e){let t=r.getUint8(e),n=r.getUint8(e+1);return r.getUint8(e+2)<<16|n<<8|t}function E1(r){if(!LJ(r))return;let e=new DataView(r.buffer),t=16383;if(FJ(r))return Ui(e,28,2)?{width:e.getUint16(26,!0)&t,height:e.getUint16(28,!0)&t,type:"webp"}:void 0;if(BJ(r)){let n=In(e,21,!0);return n===void 0?void 0:{width:(n&t)+1,height:(n>>14&t)+1,type:"webp"}}if(UJ(r))return Ui(e,27,3)?{width:D5(e,24)+1,height:D5(e,27)+1,type:"webp"}:void 0}var LJ,FJ,BJ,UJ,M5=jt(()=>{zi();LJ=r=>r[0]===82&&r[1]===73&&r[2]===70&&r[3]===70&&r[8]===87&&r[9]===69&&r[10]===66&&r[11]===80,FJ=r=>r[12]===86&&r[13]===80&&r[14]===56&&r[15]===32,BJ=r=>r[12]===86&&r[13]===80&&r[14]===56&&r[15]===76,UJ=r=>r[12]===86&&r[13]===80&&r[14]===56&&r[15]===88});function S1(r){if(!zJ(r))return;let e=kf(r);if(e.length!==0)return{...Tf(e),type:"avif"}}var HJ,zJ,L5=jt(()=>{zi();HJ=new Set(["avif","avis","avio"]),zJ=r=>{let e=Ef(r);return e?e.some(t=>HJ.has(t)):!1}});function k1(r){if(!WJ(r))return;let e=kf(r);if(e.length!==0)return{...Tf(e),type:"heic"}}var jJ,WJ,F5=jt(()=>{zi();jJ=new Set(["mif1","msf1","heic","heix","hevc","hevx","heim","heis","hevm","hevs"]),WJ=r=>{let e=Ef(r);return e?e.some(t=>jJ.has(t)):!1}});function T1(r){if(!(r.length<3))return r=new Uint8Array(r),b1(r)??x1(r)??_1(r)??E1(r)??S1(r)??k1(r)}var B5=jt(()=>{C5();I5();P5();M5();L5();F5()});function U5(r){return{alignment:mt.START,style:{paragraph:{indent:{left:Kt(r),hanging:Kt(.18)}}}}}function A1(r,e){return{reference:r,levels:KJ[e]}}var qJ,VJ,KJ,H5=jt(()=>{$a();qJ=Array(3).fill([Gt.DECIMAL,Gt.LOWER_LETTER,Gt.LOWER_ROMAN]).flat().map((r,e)=>Object.assign({level:e,format:r,text:`%${e+1}.`},U5((e+1)/2))),VJ=Array(3).fill(["\u25CF","\u25CB","\u25A0"]).flat().map((r,e)=>Object.assign({level:e,format:Gt.BULLET,text:r},U5((e+1)/2))),KJ={numbered:qJ,bullets:VJ}});function Ja(){return Math.random().toString(36).slice(2,11)}function Xs(r,e){var t;let n=(t=r?.sections)===null||t===void 0?void 0:t.map(s=>({properties:s.config.properties||{type:w1.CONTINUOUS},headers:s.config.headers,footers:s.config.footers,children:s.children}));return n||(n=[{headers:void 0,footers:void 0,properties:{type:w1.CONTINUOUS},children:r?.children||[]}]),new vf(Object.assign({footnotes:r.footnotes,numbering:{config:r.numbering},sections:n},e||{}))}function z5(r){return Xs({numbering:r.numbering,sections:[{config:{},children:r.children}],footnotes:r.footnotes})}function j5(r,e){return GJ(this,void 0,void 0,function*(){let t=yield R5.toBuffer(r);return yield e?.(t),t})}function Xa(r){let e="";return r.forEach(t=>{t.isText&&(e+=t.text)}),e}var GJ,Af=jt(()=>{$a();GJ=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(f){a(f)}}function l(c){try{u(n.throw(c))}catch(f){a(f)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})}});function Of(r,e,t,n){let i=t?[new et(t)]:[],s=n?[new et(n)]:[];return new Ma({id:r,children:[...i,new tf(e),...s]})}var Gr,ti,Ya,Ys,Za,Zs,O1=jt(()=>{$a();B5();H5();Af();Gr=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(f){a(f)}}function l(c){try{u(n.throw(c))}catch(f){a(f)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})},ti=600;Ya=class{constructor(e,t,n){this.currentSectionIndex=0,this.footnotes={},this.current=[],this.maxImageWidth=ti,this.$footnoteCounter=0,this.nodes=e,this.marks=t,this.options=n??{},this.children=[],this.numbering=[],n.sections&&n.sections.length>0?(this.sections=n.sections.map(i=>({config:i,children:[]})),this.children=this.sections[0].children):this.sections=[]}renderContent(e,t){e.forEach((n,i,s)=>{t&&this.addParagraphOptions(t),this.render(n,e,s)})}render(e,t,n){if(typeof t=="number")throw new Error("!");if(!this.nodes[e.type.name])throw new Error(`Token type \`${e.type.name}\` not supported by Word renderer`);this.nodes[e.type.name](this,e,t,n)}renderMarks(e,t){return t.map(n=>{var i,s;return(s=(i=this.marks)[n.type.name])===null||s===void 0?void 0:s.call(i,this,e,n)}).reduce((n,i)=>Object.assign(Object.assign({},n),i),{})}renderInline(e){let t,n=()=>{if(!t)return;let a=new Vs({link:t.link,children:this.current});this.current=[...t.stack,a],t=void 0},i=a=>{let o=a===t?.link;if(this.addRunOptions({style:"Hyperlink"}),!!0)n();else{if(t&&o)return;t&&!o&&n()}t={link:a,stack:this.current},this.current=[]},s=(a,o,l)=>{let u=a.marks.filter(f=>f.type.name==="link"),c=u.length>0;c?i(u[0].attrs.href):!c&&t&&n(),a.isText?this.text(a.text,this.renderMarks(a,[...a.marks])):this.render(a,e,l)};e.forEach(s),n()}renderList(e,t){if(this.currentNumbering){let{reference:n,level:i}=this.currentNumbering;this.currentNumbering={reference:n,level:i+1}}else{let n=Ja();this.numbering.push(A1(n,t)),this.currentNumbering={reference:n,level:0}}if(this.renderContent(e),this.currentNumbering.level===0)delete this.currentNumbering;else{let{reference:n,level:i}=this.currentNumbering;this.currentNumbering={reference:n,level:i-1}}}renderListItem(e){if(!this.currentNumbering)throw new Error("Trying to create a list item without a list?");this.addParagraphOptions({numbering:this.currentNumbering}),this.renderContent(e)}addParagraphOptions(e){this.nextParentParagraphOpts=Object.assign(Object.assign({},this.nextParentParagraphOpts),e)}addRunOptions(e){this.nextRunOpts=Object.assign(Object.assign({},this.nextRunOpts),e)}text(e,t){e&&(this.current.push(new et(Object.assign(Object.assign({text:e},this.nextRunOpts),t))),delete this.nextRunOpts)}math(e,t={inline:!0}){var n;if(t.inline||!t.numbered){this.current.push(new Ga({children:[new Fi(e)]}));return}let i=(n=t.id)!==null&&n!==void 0?n:Ja();this.current=[new et("	"),new Ga({children:[new Fi(e)]}),new et("	("),Of(i,"Equation"),new et(")")],this.addParagraphOptions({tabStops:[{type:Li.CENTER,position:Ka.MAX/2},{type:Li.RIGHT,position:Ka.MAX}]})}image(e,t=70,n="center",i,s){let a=this.options.getImageBuffer(e),o=T1(a);if(!o)return;let l=o.height/o.width,u=this.maxImageWidth*(t/100),c;try{c=s||e.replace(/.*\./,"").toLowerCase()}catch{c="png"}this.current.push(new Ia(Object.assign(Object.assign({data:a},i),{type:c,transformation:Object.assign(Object.assign({},i?.transformation||{}),{width:u,height:u*l})})));let f;switch(n){case"right":f=mt.RIGHT;break;case"left":f=mt.LEFT;break;default:f=mt.CENTER}this.addParagraphOptions({alignment:f})}table(e,t={}){let{getCellOptions:n,getRowOptions:i,tableOptions:s}=t,a=this.children,o=[];e.content.forEach(u=>{let c=[],f=!0;u.content.forEach(d=>{d.type.name!=="table_header"&&(f=!1)}),this.maxImageWidth=ti/u.content.childCount,u.content.forEach(d=>{var h,y;this.children=[],this.renderContent(d);let v={children:this.children},x=(h=d.attrs.colspan)!==null&&h!==void 0?h:1,m=(y=d.attrs.rowspan)!==null&&y!==void 0?y:1;x>1&&(v.columnSpan=x),m>1&&(v.rowSpan=m),c.push(new Bi(Object.assign(Object.assign({},v),n?.(d)||{})))}),o.push(new Fa(Object.assign(Object.assign({},i?.(u)||{}),{children:c,tableHeader:f})))}),this.maxImageWidth=ti;let l=new La(Object.assign(Object.assign({},s),{rows:o}));a.push(l),a.push(new $t("")),this.children=a}captionLabel(e,t,{suffix:n}={suffix:": "}){this.current.push(Of(e,t,`${t} `),new et(n))}footnote(e){let{current:t,nextRunOpts:n}=this;this.current=[],delete this.nextRunOpts,this.$footnoteCounter+=1,this.renderInline(e),this.footnotes[this.$footnoteCounter]={children:[new $t({children:this.current})]},this.current=t,this.nextRunOpts=n,this.current.push(new Ua(this.$footnoteCounter))}closeBlock(e,t){let n=new $t(Object.assign(Object.assign({children:this.current},this.nextParentParagraphOpts),t));this.current=[],delete this.nextParentParagraphOpts,this.children.push(n)}nextSection(){this.currentSectionIndex<this.sections.length-1&&(this.currentSectionIndex+=1,this.children=this.sections[this.currentSectionIndex].children)}setSectionConfig(e){this.sections[this.currentSectionIndex].config=Object.assign(Object.assign({},this.sections[this.currentSectionIndex].config),e)}addSection(e={}){this.sections.push({config:e,children:[]}),this.currentSectionIndex=this.sections.length-1,this.children=this.sections[this.currentSectionIndex].children}getCurrentSectionIndex(){return this.currentSectionIndex}getCurrentSectionConfig(){return this.sections[this.currentSectionIndex].config}getSerializationState(){return{numbering:this.numbering,sections:this.sections,footnotes:this.footnotes}}createReference(e,t,n){let i=[];t&&i.push(new et(t)),i.push(new Pa(`REF ${e} \\h`)),n&&i.push(new et(n));let s=new Da({anchor:e,children:i});this.current.push(s)}},Ys=class{constructor(e,t){this.nodes=e,this.marks=t}serialize(e,t,n){let i=new Ya(this.nodes,this.marks,t);return i.renderContent(e),Xs(i,n?.(i))}},Za=class{constructor(e,t,n){this.currentSectionIndex=0,this.footnotes={},this.current=[],this.maxImageWidth=ti,this.$footnoteCounter=0,this.nodes=e,this.marks=t,this.options=n??{},this.children=[],this.numbering=[],n.sections&&n.sections.length>0?(this.sections=n.sections.map(i=>({config:i,children:[]})),this.children=this.sections[0].children):this.sections=[]}renderContent(e,t){return Gr(this,void 0,void 0,function*(){for(let n=0;n<e.childCount;n+=1){let i=e.child(n);t&&this.addParagraphOptions(t),yield this.render(i,e,n)}})}render(e,t,n){return Gr(this,void 0,void 0,function*(){if(typeof t=="number")throw new Error("!");if(!this.nodes[e.type.name])throw new Error(`Token type \`${e.type.name}\` not supported by Word renderer`);yield Promise.resolve(this.nodes[e.type.name](this,e,t,n))})}renderMarks(e,t){return t.map(n=>{var i,s;return(s=(i=this.marks)[n.type.name])===null||s===void 0?void 0:s.call(i,this,e,n)}).reduce((n,i)=>Object.assign(Object.assign({},n),i),{})}renderInline(e){return Gr(this,void 0,void 0,function*(){let t,n=()=>{if(!t)return;let a=new Vs({link:t.link,children:this.current});this.current=[...t.stack,a],t=void 0},i=a=>{let o=a===t?.link;if(this.addRunOptions({style:"Hyperlink"}),!!0)n();else{if(t&&o)return;t&&!o&&n()}t={link:a,stack:this.current},this.current=[]},s=(a,o,l)=>Gr(this,void 0,void 0,function*(){let u=a.marks.filter(f=>f.type.name==="link"),c=u.length>0;c?i(u[0].attrs.href):!c&&t&&n(),a.isText?this.text(a.text,this.renderMarks(a,[...a.marks])):yield this.render(a,e,l)});for(let a=0;a<e.childCount;a+=1)yield s(e.child(a),0,a);n()})}renderList(e,t){return Gr(this,void 0,void 0,function*(){if(this.currentNumbering){let{reference:n,level:i}=this.currentNumbering;this.currentNumbering={reference:n,level:i+1}}else{let n=Ja();this.numbering.push(A1(n,t)),this.currentNumbering={reference:n,level:0}}if(yield this.renderContent(e),this.currentNumbering.level===0)delete this.currentNumbering;else{let{reference:n,level:i}=this.currentNumbering;this.currentNumbering={reference:n,level:i-1}}})}renderListItem(e){return Gr(this,void 0,void 0,function*(){if(!this.currentNumbering)throw new Error("Trying to create a list item without a list?");this.addParagraphOptions({numbering:this.currentNumbering}),yield this.renderContent(e)})}addParagraphOptions(e){this.nextParentParagraphOpts=Object.assign(Object.assign({},this.nextParentParagraphOpts),e)}addRunOptions(e){this.nextRunOpts=Object.assign(Object.assign({},this.nextRunOpts),e)}text(e,t){e&&(this.current.push(new et(Object.assign(Object.assign({text:e},this.nextRunOpts),t))),delete this.nextRunOpts)}math(e,t={inline:!0}){var n;if(t.inline||!t.numbered){this.current.push(new Ga({children:[new Fi(e)]}));return}let i=(n=t.id)!==null&&n!==void 0?n:Ja();this.current=[new et("	"),new Ga({children:[new Fi(e)]}),new et("	("),Of(i,"Equation"),new et(")")],this.addParagraphOptions({tabStops:[{type:Li.CENTER,position:Ka.MAX/2},{type:Li.RIGHT,position:Ka.MAX}]})}image(e,t=70,n="center",i,s){return Gr(this,void 0,void 0,function*(){let a=yield Promise.resolve(this.options.getImageBuffer(e)),o=T1(a);if(!o)return;let l=o.height/o.width,u=this.maxImageWidth*(t/100),c;try{c=s||e.replace(/.*\./,"").toLowerCase()}catch{c="png"}this.current.push(new Ia(Object.assign(Object.assign({data:a},i),{type:c,transformation:Object.assign(Object.assign({},i?.transformation||{}),{width:u,height:u*l})})));let f;switch(n){case"right":f=mt.RIGHT;break;case"left":f=mt.LEFT;break;default:f=mt.CENTER}this.addParagraphOptions({alignment:f})})}table(e,t={}){var n,i;return Gr(this,void 0,void 0,function*(){let{getCellOptions:s,getRowOptions:a,tableOptions:o}=t,l=this.children,u=[];for(let f=0;f<e.content.childCount;f+=1){let d=e.content.child(f),h=[],y=!0;for(let v=0;v<d.content.childCount;v+=1)d.content.child(v).type.name!=="table_header"&&(y=!1);this.maxImageWidth=ti/d.content.childCount;for(let v=0;v<d.content.childCount;v+=1){let x=d.content.child(v);this.children=[],yield this.renderContent(x);let m={children:this.children},_=(n=x.attrs.colspan)!==null&&n!==void 0?n:1,b=(i=x.attrs.rowspan)!==null&&i!==void 0?i:1;_>1&&(m.columnSpan=_),b>1&&(m.rowSpan=b),h.push(new Bi(Object.assign(Object.assign({},m),s?.(x)||{})))}u.push(new Fa(Object.assign(Object.assign({},a?.(d)||{}),{children:h,tableHeader:y})))}this.maxImageWidth=ti;let c=new La(Object.assign(Object.assign({},o),{rows:u}));l.push(c),l.push(new $t("")),this.children=l})}captionLabel(e,t,{suffix:n}={suffix:": "}){this.current.push(Of(e,t,`${t} `),new et(n))}footnote(e){return Gr(this,void 0,void 0,function*(){let{current:t,nextRunOpts:n}=this;this.current=[],delete this.nextRunOpts,this.$footnoteCounter+=1,yield this.renderInline(e),this.footnotes[this.$footnoteCounter]={children:[new $t({children:this.current})]},this.current=t,this.nextRunOpts=n,this.current.push(new Ua(this.$footnoteCounter))})}closeBlock(e,t){let n=new $t(Object.assign(Object.assign({children:this.current},this.nextParentParagraphOpts),t));this.current=[],delete this.nextParentParagraphOpts,this.children.push(n)}nextSection(){this.currentSectionIndex<this.sections.length-1&&(this.currentSectionIndex+=1,this.children=this.sections[this.currentSectionIndex].children)}setSectionConfig(e){this.sections[this.currentSectionIndex].config=Object.assign(Object.assign({},this.sections[this.currentSectionIndex].config),e)}addSection(e={}){this.sections.push({config:e,children:[]}),this.currentSectionIndex=this.sections.length-1,this.children=this.sections[this.currentSectionIndex].children}getCurrentSectionIndex(){return this.currentSectionIndex}getCurrentSectionConfig(){return this.sections[this.currentSectionIndex].config}getSerializationState(){return{numbering:this.numbering,sections:this.sections,footnotes:this.footnotes}}createReference(e,t,n){let i=[];t&&i.push(new et(t)),i.push(new Pa(`REF ${e} \\h`)),n&&i.push(new et(n));let s=new Da({anchor:e,children:i});this.current.push(s)}},Zs=class{constructor(e,t){this.nodes=e,this.marks=t}serializeAsync(e,t,n){return Gr(this,void 0,void 0,function*(){let i=new Za(this.nodes,this.marks,t);return yield i.renderContent(e),Xs(i,n?.(i))})}}});var ji,N1,R1,Nf,W5,q5,V5=jt(()=>{$a();O1();Af();ji=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(f){a(f)}}function l(c){try{u(n.throw(c))}catch(f){a(f)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})},N1={text(r,e){var t;r.text((t=e.text)!==null&&t!==void 0?t:"")},paragraph(r,e){r.renderInline(e),r.closeBlock(e)},heading(r,e){r.renderInline(e);let t=[er.HEADING_1,er.HEADING_2,er.HEADING_3,er.HEADING_4,er.HEADING_5,er.HEADING_6][e.attrs.level-1];r.closeBlock(e,{heading:t})},blockquote(r,e){r.renderContent(e,{style:"IntenseQuote"})},code_block(r,e){r.renderContent(e),r.closeBlock(e)},horizontal_rule(r,e){r.closeBlock(e,{thematicBreak:!0}),r.closeBlock(e)},hard_break(r){r.addRunOptions({break:1})},ordered_list(r,e){r.renderList(e,"numbered")},bullet_list(r,e){r.renderList(e,"bullets")},list_item(r,e){r.renderListItem(e)},image(r,e){let{src:t}=e.attrs;r.image(t),r.closeBlock(e)},math(r,e){r.math(Xa(e),{inline:!0})},equation(r,e){let{id:t,numbered:n}=e.attrs;r.math(Xa(e),{inline:!1,numbered:n,id:t}),r.closeBlock(e)},table(r,e){r.table(e)}},R1={text(r,e){var t;r.text((t=e.text)!==null&&t!==void 0?t:"")},paragraph(r,e){return ji(this,void 0,void 0,function*(){yield r.renderInline(e),r.closeBlock(e)})},heading(r,e){return ji(this,void 0,void 0,function*(){yield r.renderInline(e);let t=[er.HEADING_1,er.HEADING_2,er.HEADING_3,er.HEADING_4,er.HEADING_5,er.HEADING_6][e.attrs.level-1];r.closeBlock(e,{heading:t})})},blockquote(r,e){r.renderContent(e,{style:"IntenseQuote"})},code_block(r,e){r.renderContent(e),r.closeBlock(e)},horizontal_rule(r,e){r.closeBlock(e,{thematicBreak:!0}),r.closeBlock(e)},hard_break(r){r.addRunOptions({break:1})},ordered_list(r,e){return ji(this,void 0,void 0,function*(){yield r.renderList(e,"numbered")})},bullet_list(r,e){return ji(this,void 0,void 0,function*(){yield r.renderList(e,"bullets")})},list_item(r,e){return ji(this,void 0,void 0,function*(){yield r.renderListItem(e)})},image(r,e){return ji(this,void 0,void 0,function*(){let{src:t}=e.attrs;yield r.image(t),r.closeBlock(e)})},math(r,e){r.math(Xa(e),{inline:!0})},equation(r,e){let{id:t,numbered:n}=e.attrs;r.math(Xa(e),{inline:!1,numbered:n,id:t}),r.closeBlock(e)},table(r,e){return ji(this,void 0,void 0,function*(){yield r.table(e)})}},Nf={em(){return{italics:!0}},strong(){return{bold:!0}},italic(){return{italics:!0}},bold(){return{bold:!0}},link(){return{}},code(){return{font:{name:"Monospace"},color:"000000",shading:{type:d5.SOLID,color:"D2D3D2",fill:"D2D3D2"}}},abbr(){return{}},subscript(){return{subScript:!0}},superscript(){return{superScript:!0}},strikethrough(){return{strike:!0}},underline(){return{underline:{}}},smallcaps(){return{smallCaps:!0}},allcaps(){return{allCaps:!0}}},W5=new Ys(N1,Nf),q5=new Zs(R1,Nf)});var K5={};b4(K5,{DocxSerializer:()=>Ys,DocxSerializerAsync:()=>Zs,DocxSerializerState:()=>Ya,DocxSerializerStateAsync:()=>Za,MAX_IMAGE_WIDTH:()=>ti,buildDoc:()=>Xs,createDocFromState:()=>z5,defaultAsyncNodes:()=>R1,defaultDocxSerializer:()=>W5,defaultDocxSerializerAsync:()=>q5,defaultMarks:()=>Nf,defaultNodes:()=>N1,writeDocx:()=>j5});var G5=jt(()=>{O1();V5();Af()});var m4=xe(te=>{"use strict";var $J=Object.defineProperty,JJ=Object.defineProperties,XJ=Object.getOwnPropertyDescriptors,Bf=Object.getOwnPropertySymbols,GL=Object.prototype.hasOwnProperty,$L=Object.prototype.propertyIsEnumerable,gx=(r,e,t)=>e in r?$J(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Te=(r,e)=>{for(var t in e||(e={}))GL.call(e,t)&&gx(r,t,e[t]);if(Bf)for(var t of Bf(e))$L.call(e,t)&&gx(r,t,e[t]);return r},It=(r,e)=>JJ(r,XJ(e)),YJ=(r,e)=>{var t={};for(var n in r)GL.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&Bf)for(var n of Bf(r))e.indexOf(n)<0&&$L.call(r,n)&&(t[n]=r[n]);return t},ce=(r,e,t)=>gx(r,typeof e!="symbol"?e+"":e,t),cT=(r,e,t)=>new Promise((n,i)=>{var s=l=>{try{o(t.next(l))}catch(u){i(u)}},a=l=>{try{o(t.throw(l))}catch(u){i(u)}},o=l=>l.done?n(l.value):Promise.resolve(l.value).then(s,a);o((t=t.apply(r,e)).next())});Object.defineProperty(te,Symbol.toStringTag,{value:"Module"});var Ki=class{constructor(e){ce(this,"rootKey"),this.rootKey=e}},JL=Object.seal({}),ue=class extends Ki{constructor(e){super(e),ce(this,"root"),this.root=new Array}prepForXml(e){var t;e.stack.push(this);let n=this.root.map(i=>i instanceof Ki?i.prepForXml(e):i).filter(i=>i!==void 0);return e.stack.pop(),{[this.rootKey]:n.length?n.length===1&&((t=n[0])!=null&&t._attr)?n[0]:n:JL}}addChildElement(e){return this.root.push(e),this}},cr=class extends ue{prepForXml(e){let t=super.prepForXml(e);if(t&&(typeof t[this.rootKey]!="object"||Object.keys(t[this.rootKey]).length))return t}},we=class extends Ki{constructor(e){super("_attr"),ce(this,"xmlKeys"),this.root=e}prepForXml(e){let t={};return Object.entries(this.root).forEach(([n,i])=>{if(i!==void 0){let s=this.xmlKeys&&this.xmlKeys[n]||n;t[s]=i}}),{_attr:t}}},Xt=class extends Ki{constructor(e){super("_attr"),this.root=e}prepForXml(e){return{_attr:Object.values(this.root).filter(({value:n})=>n!==void 0).reduce((n,{key:i,value:s})=>It(Te({},n),{[i]:s}),{})}}},Ve=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}},Qr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fT(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var C1={},Rf={exports:{}},$5;function hT(){if($5)return Rf.exports;$5=1;var r=typeof Reflect=="object"?Reflect:null,e=r&&typeof r.apply=="function"?r.apply:function(T,P,M){return Function.prototype.apply.call(T,P,M)},t;r&&typeof r.ownKeys=="function"?t=r.ownKeys:Object.getOwnPropertySymbols?t=function(T){return Object.getOwnPropertyNames(T).concat(Object.getOwnPropertySymbols(T))}:t=function(T){return Object.getOwnPropertyNames(T)};function n(w){console&&console.warn&&console.warn(w)}var i=Number.isNaN||function(T){return T!==T};function s(){s.init.call(this)}Rf.exports=s,Rf.exports.once=m,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function o(w){if(typeof w!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof w)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(w){if(typeof w!="number"||w<0||i(w))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+w+".");a=w}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(T){if(typeof T!="number"||T<0||i(T))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+T+".");return this._maxListeners=T,this};function l(w){return w._maxListeners===void 0?s.defaultMaxListeners:w._maxListeners}s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(T){for(var P=[],M=1;M<arguments.length;M++)P.push(arguments[M]);var U=T==="error",R=this._events;if(R!==void 0)U=U&&R.error===void 0;else if(!U)return!1;if(U){var J;if(P.length>0&&(J=P[0]),J instanceof Error)throw J;var oe=new Error("Unhandled error."+(J?" ("+J.message+")":""));throw oe.context=J,oe}var C=R[T];if(C===void 0)return!1;if(typeof C=="function")e(C,this,P);else for(var H=C.length,k=y(C,H),M=0;M<H;++M)e(k[M],this,P);return!0};function u(w,T,P,M){var U,R,J;if(o(P),R=w._events,R===void 0?(R=w._events=Object.create(null),w._eventsCount=0):(R.newListener!==void 0&&(w.emit("newListener",T,P.listener?P.listener:P),R=w._events),J=R[T]),J===void 0)J=R[T]=P,++w._eventsCount;else if(typeof J=="function"?J=R[T]=M?[P,J]:[J,P]:M?J.unshift(P):J.push(P),U=l(w),U>0&&J.length>U&&!J.warned){J.warned=!0;var oe=new Error("Possible EventEmitter memory leak detected. "+J.length+" "+String(T)+" listeners added. Use emitter.setMaxListeners() to increase limit");oe.name="MaxListenersExceededWarning",oe.emitter=w,oe.type=T,oe.count=J.length,n(oe)}return w}s.prototype.addListener=function(T,P){return u(this,T,P,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(T,P){return u(this,T,P,!0)};function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(w,T,P){var M={fired:!1,wrapFn:void 0,target:w,type:T,listener:P},U=c.bind(M);return U.listener=P,M.wrapFn=U,U}s.prototype.once=function(T,P){return o(P),this.on(T,f(this,T,P)),this},s.prototype.prependOnceListener=function(T,P){return o(P),this.prependListener(T,f(this,T,P)),this},s.prototype.removeListener=function(T,P){var M,U,R,J,oe;if(o(P),U=this._events,U===void 0)return this;if(M=U[T],M===void 0)return this;if(M===P||M.listener===P)--this._eventsCount===0?this._events=Object.create(null):(delete U[T],U.removeListener&&this.emit("removeListener",T,M.listener||P));else if(typeof M!="function"){for(R=-1,J=M.length-1;J>=0;J--)if(M[J]===P||M[J].listener===P){oe=M[J].listener,R=J;break}if(R<0)return this;R===0?M.shift():v(M,R),M.length===1&&(U[T]=M[0]),U.removeListener!==void 0&&this.emit("removeListener",T,oe||P)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(T){var P,M,U;if(M=this._events,M===void 0)return this;if(M.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):M[T]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete M[T]),this;if(arguments.length===0){var R=Object.keys(M),J;for(U=0;U<R.length;++U)J=R[U],J!=="removeListener"&&this.removeAllListeners(J);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(P=M[T],typeof P=="function")this.removeListener(T,P);else if(P!==void 0)for(U=P.length-1;U>=0;U--)this.removeListener(T,P[U]);return this};function d(w,T,P){var M=w._events;if(M===void 0)return[];var U=M[T];return U===void 0?[]:typeof U=="function"?P?[U.listener||U]:[U]:P?x(U):y(U,U.length)}s.prototype.listeners=function(T){return d(this,T,!0)},s.prototype.rawListeners=function(T){return d(this,T,!1)},s.listenerCount=function(w,T){return typeof w.listenerCount=="function"?w.listenerCount(T):h.call(w,T)},s.prototype.listenerCount=h;function h(w){var T=this._events;if(T!==void 0){var P=T[w];if(typeof P=="function")return 1;if(P!==void 0)return P.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function y(w,T){for(var P=new Array(T),M=0;M<T;++M)P[M]=w[M];return P}function v(w,T){for(;T+1<w.length;T++)w[T]=w[T+1];w.pop()}function x(w){for(var T=new Array(w.length),P=0;P<T.length;++P)T[P]=w[P].listener||w[P];return T}function m(w,T){return new Promise(function(P,M){function U(J){w.removeListener(T,R),M(J)}function R(){typeof w.removeListener=="function"&&w.removeListener("error",U),P([].slice.call(arguments))}b(w,T,R,{once:!0}),T!=="error"&&_(w,U,{once:!0})})}function _(w,T,P){typeof w.on=="function"&&b(w,"error",T,P)}function b(w,T,P,M){if(typeof w.on=="function")M.once?w.once(T,P):w.on(T,P);else if(typeof w.addEventListener=="function")w.addEventListener(T,function U(R){M.once&&w.removeEventListener(T,U),P(R)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof w)}return Rf.exports}var Cf={exports:{}},J5;function oi(){return J5||(J5=1,typeof Object.create=="function"?Cf.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Cf.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),Cf.exports}function ZJ(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var XL={exports:{}},ot=XL.exports={},Xr,Yr;function vx(){throw new Error("setTimeout has not been defined")}function yx(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Xr=setTimeout:Xr=vx}catch{Xr=vx}try{typeof clearTimeout=="function"?Yr=clearTimeout:Yr=yx}catch{Yr=yx}})();function YL(r){if(Xr===setTimeout)return setTimeout(r,0);if((Xr===vx||!Xr)&&setTimeout)return Xr=setTimeout,setTimeout(r,0);try{return Xr(r,0)}catch{try{return Xr.call(null,r,0)}catch{return Xr.call(this,r,0)}}}function QJ(r){if(Yr===clearTimeout)return clearTimeout(r);if((Yr===yx||!Yr)&&clearTimeout)return Yr=clearTimeout,clearTimeout(r);try{return Yr(r)}catch{try{return Yr.call(null,r)}catch{return Yr.call(this,r)}}}var Pn=[],io=!1,qi,Lf=-1;function eX(){!io||!qi||(io=!1,qi.length?Pn=qi.concat(Pn):Lf=-1,Pn.length&&ZL())}function ZL(){if(!io){var r=YL(eX);io=!0;for(var e=Pn.length;e;){for(qi=Pn,Pn=[];++Lf<e;)qi&&qi[Lf].run();Lf=-1,e=Pn.length}qi=null,io=!1,QJ(r)}}ot.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];Pn.push(new QL(r,e)),Pn.length===1&&!io&&YL(ZL)};function QL(r,e){this.fun=r,this.array=e}QL.prototype.run=function(){this.fun.apply(null,this.array)};ot.title="browser";ot.browser=!0;ot.env={};ot.argv=[];ot.version="";ot.versions={};function Mn(){}ot.on=Mn;ot.addListener=Mn;ot.once=Mn;ot.off=Mn;ot.removeListener=Mn;ot.removeAllListeners=Mn;ot.emit=Mn;ot.prependListener=Mn;ot.prependOnceListener=Mn;ot.listeners=function(r){return[]};ot.binding=function(r){throw new Error("process.binding is not supported")};ot.cwd=function(){return"/"};ot.chdir=function(r){throw new Error("process.chdir is not supported")};ot.umask=function(){return 0};var tX=XL.exports,Ie=ZJ(tX),I1,X5;function e3(){return X5||(X5=1,I1=hT().EventEmitter),I1}var P1={},Qa={},Y5;function rX(){if(Y5)return Qa;Y5=1,Qa.byteLength=o,Qa.toByteArray=u,Qa.fromByteArray=d;for(var r=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,s=n.length;i<s;++i)r[i]=n[i],e[n.charCodeAt(i)]=i;e[45]=62,e[95]=63;function a(h){var y=h.length;if(y%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=h.indexOf("=");v===-1&&(v=y);var x=v===y?0:4-v%4;return[v,x]}function o(h){var y=a(h),v=y[0],x=y[1];return(v+x)*3/4-x}function l(h,y,v){return(y+v)*3/4-v}function u(h){var y,v=a(h),x=v[0],m=v[1],_=new t(l(h,x,m)),b=0,w=m>0?x-4:x,T;for(T=0;T<w;T+=4)y=e[h.charCodeAt(T)]<<18|e[h.charCodeAt(T+1)]<<12|e[h.charCodeAt(T+2)]<<6|e[h.charCodeAt(T+3)],_[b++]=y>>16&255,_[b++]=y>>8&255,_[b++]=y&255;return m===2&&(y=e[h.charCodeAt(T)]<<2|e[h.charCodeAt(T+1)]>>4,_[b++]=y&255),m===1&&(y=e[h.charCodeAt(T)]<<10|e[h.charCodeAt(T+1)]<<4|e[h.charCodeAt(T+2)]>>2,_[b++]=y>>8&255,_[b++]=y&255),_}function c(h){return r[h>>18&63]+r[h>>12&63]+r[h>>6&63]+r[h&63]}function f(h,y,v){for(var x,m=[],_=y;_<v;_+=3)x=(h[_]<<16&16711680)+(h[_+1]<<8&65280)+(h[_+2]&255),m.push(c(x));return m.join("")}function d(h){for(var y,v=h.length,x=v%3,m=[],_=16383,b=0,w=v-x;b<w;b+=_)m.push(f(h,b,b+_>w?w:b+_));return x===1?(y=h[v-1],m.push(r[y>>2]+r[y<<4&63]+"==")):x===2&&(y=(h[v-2]<<8)+h[v-1],m.push(r[y>>10]+r[y>>4&63]+r[y<<2&63]+"=")),m.join("")}return Qa}var If={};var Z5;function nX(){return Z5||(Z5=1,If.read=function(r,e,t,n,i){var s,a,o=i*8-n-1,l=(1<<o)-1,u=l>>1,c=-7,f=t?i-1:0,d=t?-1:1,h=r[e+f];for(f+=d,s=h&(1<<-c)-1,h>>=-c,c+=o;c>0;s=s*256+r[e+f],f+=d,c-=8);for(a=s&(1<<-c)-1,s>>=-c,c+=n;c>0;a=a*256+r[e+f],f+=d,c-=8);if(s===0)s=1-u;else{if(s===l)return a?NaN:(h?-1:1)*(1/0);a=a+Math.pow(2,n),s=s-u}return(h?-1:1)*a*Math.pow(2,s-n)},If.write=function(r,e,t,n,i,s){var a,o,l,u=s*8-i-1,c=(1<<u)-1,f=c>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:s-1,y=n?1:-1,v=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+f>=1?e+=d/l:e+=d*Math.pow(2,1-f),e*l>=2&&(a++,l/=2),a+f>=c?(o=0,a=c):a+f>=1?(o=(e*l-1)*Math.pow(2,i),a=a+f):(o=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;r[t+h]=o&255,h+=y,o/=256,i-=8);for(a=a<<i|o,u+=i;u>0;r[t+h]=a&255,h+=y,a/=256,u-=8);r[t+h-y]|=v*128}),If}var Q5;function bd(){return Q5||(Q5=1,(function(r){var e=rX(),t=nX(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=o,r.SlowBuffer=_,r.INSPECT_MAX_BYTES=50;var i=2147483647;r.kMaxLength=i,o.TYPED_ARRAY_SUPPORT=s(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{var N=new Uint8Array(1),p={foo:function(){return 42}};return Object.setPrototypeOf(p,Uint8Array.prototype),Object.setPrototypeOf(N,p),N.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function a(N){if(N>i)throw new RangeError('The value "'+N+'" is invalid for option "size"');var p=new Uint8Array(N);return Object.setPrototypeOf(p,o.prototype),p}function o(N,p,g){if(typeof N=="number"){if(typeof p=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(N)}return l(N,p,g)}o.poolSize=8192;function l(N,p,g){if(typeof N=="string")return d(N,p);if(ArrayBuffer.isView(N))return y(N);if(N==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof N);if(Z(N,ArrayBuffer)||N&&Z(N.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Z(N,SharedArrayBuffer)||N&&Z(N.buffer,SharedArrayBuffer)))return v(N,p,g);if(typeof N=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var S=N.valueOf&&N.valueOf();if(S!=null&&S!==N)return o.from(S,p,g);var F=x(N);if(F)return F;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof N[Symbol.toPrimitive]=="function")return o.from(N[Symbol.toPrimitive]("string"),p,g);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof N)}o.from=function(N,p,g){return l(N,p,g)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function u(N){if(typeof N!="number")throw new TypeError('"size" argument must be of type number');if(N<0)throw new RangeError('The value "'+N+'" is invalid for option "size"')}function c(N,p,g){return u(N),N<=0?a(N):p!==void 0?typeof g=="string"?a(N).fill(p,g):a(N).fill(p):a(N)}o.alloc=function(N,p,g){return c(N,p,g)};function f(N){return u(N),a(N<0?0:m(N)|0)}o.allocUnsafe=function(N){return f(N)},o.allocUnsafeSlow=function(N){return f(N)};function d(N,p){if((typeof p!="string"||p==="")&&(p="utf8"),!o.isEncoding(p))throw new TypeError("Unknown encoding: "+p);var g=b(N,p)|0,S=a(g),F=S.write(N,p);return F!==g&&(S=S.slice(0,F)),S}function h(N){for(var p=N.length<0?0:m(N.length)|0,g=a(p),S=0;S<p;S+=1)g[S]=N[S]&255;return g}function y(N){if(Z(N,Uint8Array)){var p=new Uint8Array(N);return v(p.buffer,p.byteOffset,p.byteLength)}return h(N)}function v(N,p,g){if(p<0||N.byteLength<p)throw new RangeError('"offset" is outside of buffer bounds');if(N.byteLength<p+(g||0))throw new RangeError('"length" is outside of buffer bounds');var S;return p===void 0&&g===void 0?S=new Uint8Array(N):g===void 0?S=new Uint8Array(N,p):S=new Uint8Array(N,p,g),Object.setPrototypeOf(S,o.prototype),S}function x(N){if(o.isBuffer(N)){var p=m(N.length)|0,g=a(p);return g.length===0||N.copy(g,0,0,p),g}if(N.length!==void 0)return typeof N.length!="number"||E(N.length)?a(0):h(N);if(N.type==="Buffer"&&Array.isArray(N.data))return h(N.data)}function m(N){if(N>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return N|0}function _(N){return+N!=N&&(N=0),o.alloc(+N)}o.isBuffer=function(p){return p!=null&&p._isBuffer===!0&&p!==o.prototype},o.compare=function(p,g){if(Z(p,Uint8Array)&&(p=o.from(p,p.offset,p.byteLength)),Z(g,Uint8Array)&&(g=o.from(g,g.offset,g.byteLength)),!o.isBuffer(p)||!o.isBuffer(g))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(p===g)return 0;for(var S=p.length,F=g.length,q=0,z=Math.min(S,F);q<z;++q)if(p[q]!==g[q]){S=p[q],F=g[q];break}return S<F?-1:F<S?1:0},o.isEncoding=function(p){switch(String(p).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(p,g){if(!Array.isArray(p))throw new TypeError('"list" argument must be an Array of Buffers');if(p.length===0)return o.alloc(0);var S;if(g===void 0)for(g=0,S=0;S<p.length;++S)g+=p[S].length;var F=o.allocUnsafe(g),q=0;for(S=0;S<p.length;++S){var z=p[S];if(Z(z,Uint8Array))q+z.length>F.length?o.from(z).copy(F,q):Uint8Array.prototype.set.call(F,z,q);else if(o.isBuffer(z))z.copy(F,q);else throw new TypeError('"list" argument must be an Array of Buffers');q+=z.length}return F};function b(N,p){if(o.isBuffer(N))return N.length;if(ArrayBuffer.isView(N)||Z(N,ArrayBuffer))return N.byteLength;if(typeof N!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof N);var g=N.length,S=arguments.length>2&&arguments[2]===!0;if(!S&&g===0)return 0;for(var F=!1;;)switch(p){case"ascii":case"latin1":case"binary":return g;case"utf8":case"utf-8":return A(N).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return g*2;case"hex":return g>>>1;case"base64":return I(N).length;default:if(F)return S?-1:A(N).length;p=(""+p).toLowerCase(),F=!0}}o.byteLength=b;function w(N,p,g){var S=!1;if((p===void 0||p<0)&&(p=0),p>this.length||((g===void 0||g>this.length)&&(g=this.length),g<=0)||(g>>>=0,p>>>=0,g<=p))return"";for(N||(N="utf8");;)switch(N){case"hex":return ee(this,p,g);case"utf8":case"utf-8":return k(this,p,g);case"ascii":return j(this,p,g);case"latin1":case"binary":return ie(this,p,g);case"base64":return H(this,p,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return le(this,p,g);default:if(S)throw new TypeError("Unknown encoding: "+N);N=(N+"").toLowerCase(),S=!0}}o.prototype._isBuffer=!0;function T(N,p,g){var S=N[p];N[p]=N[g],N[g]=S}o.prototype.swap16=function(){var p=this.length;if(p%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var g=0;g<p;g+=2)T(this,g,g+1);return this},o.prototype.swap32=function(){var p=this.length;if(p%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var g=0;g<p;g+=4)T(this,g,g+3),T(this,g+1,g+2);return this},o.prototype.swap64=function(){var p=this.length;if(p%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var g=0;g<p;g+=8)T(this,g,g+7),T(this,g+1,g+6),T(this,g+2,g+5),T(this,g+3,g+4);return this},o.prototype.toString=function(){var p=this.length;return p===0?"":arguments.length===0?k(this,0,p):w.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(p){if(!o.isBuffer(p))throw new TypeError("Argument must be a Buffer");return this===p?!0:o.compare(this,p)===0},o.prototype.inspect=function(){var p="",g=r.INSPECT_MAX_BYTES;return p=this.toString("hex",0,g).replace(/(.{2})/g,"$1 ").trim(),this.length>g&&(p+=" ... "),"<Buffer "+p+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(p,g,S,F,q){if(Z(p,Uint8Array)&&(p=o.from(p,p.offset,p.byteLength)),!o.isBuffer(p))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof p);if(g===void 0&&(g=0),S===void 0&&(S=p?p.length:0),F===void 0&&(F=0),q===void 0&&(q=this.length),g<0||S>p.length||F<0||q>this.length)throw new RangeError("out of range index");if(F>=q&&g>=S)return 0;if(F>=q)return-1;if(g>=S)return 1;if(g>>>=0,S>>>=0,F>>>=0,q>>>=0,this===p)return 0;for(var z=q-F,ne=S-g,ae=Math.min(z,ne),se=this.slice(F,q),fe=p.slice(g,S),pe=0;pe<ae;++pe)if(se[pe]!==fe[pe]){z=se[pe],ne=fe[pe];break}return z<ne?-1:ne<z?1:0};function P(N,p,g,S,F){if(N.length===0)return-1;if(typeof g=="string"?(S=g,g=0):g>2147483647?g=2147483647:g<-2147483648&&(g=-2147483648),g=+g,E(g)&&(g=F?0:N.length-1),g<0&&(g=N.length+g),g>=N.length){if(F)return-1;g=N.length-1}else if(g<0)if(F)g=0;else return-1;if(typeof p=="string"&&(p=o.from(p,S)),o.isBuffer(p))return p.length===0?-1:M(N,p,g,S,F);if(typeof p=="number")return p=p&255,typeof Uint8Array.prototype.indexOf=="function"?F?Uint8Array.prototype.indexOf.call(N,p,g):Uint8Array.prototype.lastIndexOf.call(N,p,g):M(N,[p],g,S,F);throw new TypeError("val must be string, number or Buffer")}function M(N,p,g,S,F){var q=1,z=N.length,ne=p.length;if(S!==void 0&&(S=String(S).toLowerCase(),S==="ucs2"||S==="ucs-2"||S==="utf16le"||S==="utf-16le")){if(N.length<2||p.length<2)return-1;q=2,z/=2,ne/=2,g/=2}function ae(Me,yt){return q===1?Me[yt]:Me.readUInt16BE(yt*q)}var se;if(F){var fe=-1;for(se=g;se<z;se++)if(ae(N,se)===ae(p,fe===-1?0:se-fe)){if(fe===-1&&(fe=se),se-fe+1===ne)return fe*q}else fe!==-1&&(se-=se-fe),fe=-1}else for(g+ne>z&&(g=z-ne),se=g;se>=0;se--){for(var pe=!0,ve=0;ve<ne;ve++)if(ae(N,se+ve)!==ae(p,ve)){pe=!1;break}if(pe)return se}return-1}o.prototype.includes=function(p,g,S){return this.indexOf(p,g,S)!==-1},o.prototype.indexOf=function(p,g,S){return P(this,p,g,S,!0)},o.prototype.lastIndexOf=function(p,g,S){return P(this,p,g,S,!1)};function U(N,p,g,S){g=Number(g)||0;var F=N.length-g;S?(S=Number(S),S>F&&(S=F)):S=F;var q=p.length;S>q/2&&(S=q/2);for(var z=0;z<S;++z){var ne=parseInt(p.substr(z*2,2),16);if(E(ne))return z;N[g+z]=ne}return z}function R(N,p,g,S){return L(A(p,N.length-g),N,g,S)}function J(N,p,g,S){return L(W(p),N,g,S)}function oe(N,p,g,S){return L(I(p),N,g,S)}function C(N,p,g,S){return L(B(p,N.length-g),N,g,S)}o.prototype.write=function(p,g,S,F){if(g===void 0)F="utf8",S=this.length,g=0;else if(S===void 0&&typeof g=="string")F=g,S=this.length,g=0;else if(isFinite(g))g=g>>>0,isFinite(S)?(S=S>>>0,F===void 0&&(F="utf8")):(F=S,S=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var q=this.length-g;if((S===void 0||S>q)&&(S=q),p.length>0&&(S<0||g<0)||g>this.length)throw new RangeError("Attempt to write outside buffer bounds");F||(F="utf8");for(var z=!1;;)switch(F){case"hex":return U(this,p,g,S);case"utf8":case"utf-8":return R(this,p,g,S);case"ascii":case"latin1":case"binary":return J(this,p,g,S);case"base64":return oe(this,p,g,S);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,p,g,S);default:if(z)throw new TypeError("Unknown encoding: "+F);F=(""+F).toLowerCase(),z=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function H(N,p,g){return p===0&&g===N.length?e.fromByteArray(N):e.fromByteArray(N.slice(p,g))}function k(N,p,g){g=Math.min(N.length,g);for(var S=[],F=p;F<g;){var q=N[F],z=null,ne=q>239?4:q>223?3:q>191?2:1;if(F+ne<=g){var ae,se,fe,pe;switch(ne){case 1:q<128&&(z=q);break;case 2:ae=N[F+1],(ae&192)===128&&(pe=(q&31)<<6|ae&63,pe>127&&(z=pe));break;case 3:ae=N[F+1],se=N[F+2],(ae&192)===128&&(se&192)===128&&(pe=(q&15)<<12|(ae&63)<<6|se&63,pe>2047&&(pe<55296||pe>57343)&&(z=pe));break;case 4:ae=N[F+1],se=N[F+2],fe=N[F+3],(ae&192)===128&&(se&192)===128&&(fe&192)===128&&(pe=(q&15)<<18|(ae&63)<<12|(se&63)<<6|fe&63,pe>65535&&pe<1114112&&(z=pe))}}z===null?(z=65533,ne=1):z>65535&&(z-=65536,S.push(z>>>10&1023|55296),z=56320|z&1023),S.push(z),F+=ne}return Q(S)}var V=4096;function Q(N){var p=N.length;if(p<=V)return String.fromCharCode.apply(String,N);for(var g="",S=0;S<p;)g+=String.fromCharCode.apply(String,N.slice(S,S+=V));return g}function j(N,p,g){var S="";g=Math.min(N.length,g);for(var F=p;F<g;++F)S+=String.fromCharCode(N[F]&127);return S}function ie(N,p,g){var S="";g=Math.min(N.length,g);for(var F=p;F<g;++F)S+=String.fromCharCode(N[F]);return S}function ee(N,p,g){var S=N.length;(!p||p<0)&&(p=0),(!g||g<0||g>S)&&(g=S);for(var F="",q=p;q<g;++q)F+=Y[N[q]];return F}function le(N,p,g){for(var S=N.slice(p,g),F="",q=0;q<S.length-1;q+=2)F+=String.fromCharCode(S[q]+S[q+1]*256);return F}o.prototype.slice=function(p,g){var S=this.length;p=~~p,g=g===void 0?S:~~g,p<0?(p+=S,p<0&&(p=0)):p>S&&(p=S),g<0?(g+=S,g<0&&(g=0)):g>S&&(g=S),g<p&&(g=p);var F=this.subarray(p,g);return Object.setPrototypeOf(F,o.prototype),F};function G(N,p,g){if(N%1!==0||N<0)throw new RangeError("offset is not uint");if(N+p>g)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(p,g,S){p=p>>>0,g=g>>>0,S||G(p,g,this.length);for(var F=this[p],q=1,z=0;++z<g&&(q*=256);)F+=this[p+z]*q;return F},o.prototype.readUintBE=o.prototype.readUIntBE=function(p,g,S){p=p>>>0,g=g>>>0,S||G(p,g,this.length);for(var F=this[p+--g],q=1;g>0&&(q*=256);)F+=this[p+--g]*q;return F},o.prototype.readUint8=o.prototype.readUInt8=function(p,g){return p=p>>>0,g||G(p,1,this.length),this[p]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(p,g){return p=p>>>0,g||G(p,2,this.length),this[p]|this[p+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(p,g){return p=p>>>0,g||G(p,2,this.length),this[p]<<8|this[p+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(p,g){return p=p>>>0,g||G(p,4,this.length),(this[p]|this[p+1]<<8|this[p+2]<<16)+this[p+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(p,g){return p=p>>>0,g||G(p,4,this.length),this[p]*16777216+(this[p+1]<<16|this[p+2]<<8|this[p+3])},o.prototype.readIntLE=function(p,g,S){p=p>>>0,g=g>>>0,S||G(p,g,this.length);for(var F=this[p],q=1,z=0;++z<g&&(q*=256);)F+=this[p+z]*q;return q*=128,F>=q&&(F-=Math.pow(2,8*g)),F},o.prototype.readIntBE=function(p,g,S){p=p>>>0,g=g>>>0,S||G(p,g,this.length);for(var F=g,q=1,z=this[p+--F];F>0&&(q*=256);)z+=this[p+--F]*q;return q*=128,z>=q&&(z-=Math.pow(2,8*g)),z},o.prototype.readInt8=function(p,g){return p=p>>>0,g||G(p,1,this.length),this[p]&128?(255-this[p]+1)*-1:this[p]},o.prototype.readInt16LE=function(p,g){p=p>>>0,g||G(p,2,this.length);var S=this[p]|this[p+1]<<8;return S&32768?S|4294901760:S},o.prototype.readInt16BE=function(p,g){p=p>>>0,g||G(p,2,this.length);var S=this[p+1]|this[p]<<8;return S&32768?S|4294901760:S},o.prototype.readInt32LE=function(p,g){return p=p>>>0,g||G(p,4,this.length),this[p]|this[p+1]<<8|this[p+2]<<16|this[p+3]<<24},o.prototype.readInt32BE=function(p,g){return p=p>>>0,g||G(p,4,this.length),this[p]<<24|this[p+1]<<16|this[p+2]<<8|this[p+3]},o.prototype.readFloatLE=function(p,g){return p=p>>>0,g||G(p,4,this.length),t.read(this,p,!0,23,4)},o.prototype.readFloatBE=function(p,g){return p=p>>>0,g||G(p,4,this.length),t.read(this,p,!1,23,4)},o.prototype.readDoubleLE=function(p,g){return p=p>>>0,g||G(p,8,this.length),t.read(this,p,!0,52,8)},o.prototype.readDoubleBE=function(p,g){return p=p>>>0,g||G(p,8,this.length),t.read(this,p,!1,52,8)};function D(N,p,g,S,F,q){if(!o.isBuffer(N))throw new TypeError('"buffer" argument must be a Buffer instance');if(p>F||p<q)throw new RangeError('"value" argument is out of bounds');if(g+S>N.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(p,g,S,F){if(p=+p,g=g>>>0,S=S>>>0,!F){var q=Math.pow(2,8*S)-1;D(this,p,g,S,q,0)}var z=1,ne=0;for(this[g]=p&255;++ne<S&&(z*=256);)this[g+ne]=p/z&255;return g+S},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(p,g,S,F){if(p=+p,g=g>>>0,S=S>>>0,!F){var q=Math.pow(2,8*S)-1;D(this,p,g,S,q,0)}var z=S-1,ne=1;for(this[g+z]=p&255;--z>=0&&(ne*=256);)this[g+z]=p/ne&255;return g+S},o.prototype.writeUint8=o.prototype.writeUInt8=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,1,255,0),this[g]=p&255,g+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,2,65535,0),this[g]=p&255,this[g+1]=p>>>8,g+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,2,65535,0),this[g]=p>>>8,this[g+1]=p&255,g+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,4,4294967295,0),this[g+3]=p>>>24,this[g+2]=p>>>16,this[g+1]=p>>>8,this[g]=p&255,g+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,4,4294967295,0),this[g]=p>>>24,this[g+1]=p>>>16,this[g+2]=p>>>8,this[g+3]=p&255,g+4},o.prototype.writeIntLE=function(p,g,S,F){if(p=+p,g=g>>>0,!F){var q=Math.pow(2,8*S-1);D(this,p,g,S,q-1,-q)}var z=0,ne=1,ae=0;for(this[g]=p&255;++z<S&&(ne*=256);)p<0&&ae===0&&this[g+z-1]!==0&&(ae=1),this[g+z]=(p/ne>>0)-ae&255;return g+S},o.prototype.writeIntBE=function(p,g,S,F){if(p=+p,g=g>>>0,!F){var q=Math.pow(2,8*S-1);D(this,p,g,S,q-1,-q)}var z=S-1,ne=1,ae=0;for(this[g+z]=p&255;--z>=0&&(ne*=256);)p<0&&ae===0&&this[g+z+1]!==0&&(ae=1),this[g+z]=(p/ne>>0)-ae&255;return g+S},o.prototype.writeInt8=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,1,127,-128),p<0&&(p=255+p+1),this[g]=p&255,g+1},o.prototype.writeInt16LE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,2,32767,-32768),this[g]=p&255,this[g+1]=p>>>8,g+2},o.prototype.writeInt16BE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,2,32767,-32768),this[g]=p>>>8,this[g+1]=p&255,g+2},o.prototype.writeInt32LE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,4,2147483647,-2147483648),this[g]=p&255,this[g+1]=p>>>8,this[g+2]=p>>>16,this[g+3]=p>>>24,g+4},o.prototype.writeInt32BE=function(p,g,S){return p=+p,g=g>>>0,S||D(this,p,g,4,2147483647,-2147483648),p<0&&(p=4294967295+p+1),this[g]=p>>>24,this[g+1]=p>>>16,this[g+2]=p>>>8,this[g+3]=p&255,g+4};function $(N,p,g,S,F,q){if(g+S>N.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("Index out of range")}function X(N,p,g,S,F){return p=+p,g=g>>>0,F||$(N,p,g,4),t.write(N,p,g,S,23,4),g+4}o.prototype.writeFloatLE=function(p,g,S){return X(this,p,g,!0,S)},o.prototype.writeFloatBE=function(p,g,S){return X(this,p,g,!1,S)};function re(N,p,g,S,F){return p=+p,g=g>>>0,F||$(N,p,g,8),t.write(N,p,g,S,52,8),g+8}o.prototype.writeDoubleLE=function(p,g,S){return re(this,p,g,!0,S)},o.prototype.writeDoubleBE=function(p,g,S){return re(this,p,g,!1,S)},o.prototype.copy=function(p,g,S,F){if(!o.isBuffer(p))throw new TypeError("argument should be a Buffer");if(S||(S=0),!F&&F!==0&&(F=this.length),g>=p.length&&(g=p.length),g||(g=0),F>0&&F<S&&(F=S),F===S||p.length===0||this.length===0)return 0;if(g<0)throw new RangeError("targetStart out of bounds");if(S<0||S>=this.length)throw new RangeError("Index out of range");if(F<0)throw new RangeError("sourceEnd out of bounds");F>this.length&&(F=this.length),p.length-g<F-S&&(F=p.length-g+S);var q=F-S;return this===p&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(g,S,F):Uint8Array.prototype.set.call(p,this.subarray(S,F),g),q},o.prototype.fill=function(p,g,S,F){if(typeof p=="string"){if(typeof g=="string"?(F=g,g=0,S=this.length):typeof S=="string"&&(F=S,S=this.length),F!==void 0&&typeof F!="string")throw new TypeError("encoding must be a string");if(typeof F=="string"&&!o.isEncoding(F))throw new TypeError("Unknown encoding: "+F);if(p.length===1){var q=p.charCodeAt(0);(F==="utf8"&&q<128||F==="latin1")&&(p=q)}}else typeof p=="number"?p=p&255:typeof p=="boolean"&&(p=Number(p));if(g<0||this.length<g||this.length<S)throw new RangeError("Out of range index");if(S<=g)return this;g=g>>>0,S=S===void 0?this.length:S>>>0,p||(p=0);var z;if(typeof p=="number")for(z=g;z<S;++z)this[z]=p;else{var ne=o.isBuffer(p)?p:o.from(p,F),ae=ne.length;if(ae===0)throw new TypeError('The value "'+p+'" is invalid for argument "value"');for(z=0;z<S-g;++z)this[z+g]=ne[z%ae]}return this};var K=/[^+/0-9A-Za-z-_]/g;function O(N){if(N=N.split("=")[0],N=N.trim().replace(K,""),N.length<2)return"";for(;N.length%4!==0;)N=N+"=";return N}function A(N,p){p=p||1/0;for(var g,S=N.length,F=null,q=[],z=0;z<S;++z){if(g=N.charCodeAt(z),g>55295&&g<57344){if(!F){if(g>56319){(p-=3)>-1&&q.push(239,191,189);continue}else if(z+1===S){(p-=3)>-1&&q.push(239,191,189);continue}F=g;continue}if(g<56320){(p-=3)>-1&&q.push(239,191,189),F=g;continue}g=(F-55296<<10|g-56320)+65536}else F&&(p-=3)>-1&&q.push(239,191,189);if(F=null,g<128){if((p-=1)<0)break;q.push(g)}else if(g<2048){if((p-=2)<0)break;q.push(g>>6|192,g&63|128)}else if(g<65536){if((p-=3)<0)break;q.push(g>>12|224,g>>6&63|128,g&63|128)}else if(g<1114112){if((p-=4)<0)break;q.push(g>>18|240,g>>12&63|128,g>>6&63|128,g&63|128)}else throw new Error("Invalid code point")}return q}function W(N){for(var p=[],g=0;g<N.length;++g)p.push(N.charCodeAt(g)&255);return p}function B(N,p){for(var g,S,F,q=[],z=0;z<N.length&&!((p-=2)<0);++z)g=N.charCodeAt(z),S=g>>8,F=g%256,q.push(F),q.push(S);return q}function I(N){return e.toByteArray(O(N))}function L(N,p,g,S){for(var F=0;F<S&&!(F+g>=p.length||F>=N.length);++F)p[F+g]=N[F];return F}function Z(N,p){return N instanceof p||N!=null&&N.constructor!=null&&N.constructor.name!=null&&N.constructor.name===p.name}function E(N){return N!==N}var Y=(function(){for(var N="0123456789abcdef",p=new Array(256),g=0;g<16;++g)for(var S=g*16,F=0;F<16;++F)p[S+F]=N[g]+N[F];return p})()})(P1)),P1}var D1={},M1={},L1,e6;function t3(){return e6||(e6=1,L1=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),n=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[t]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==i||o.enumerable!==!0)return!1}return!0}),L1}var F1,t6;function dT(){if(t6)return F1;t6=1;var r=t3();return F1=function(){return r()&&!!Symbol.toStringTag},F1}var B1,r6;function r3(){return r6||(r6=1,B1=Object),B1}var U1,n6;function iX(){return n6||(n6=1,U1=Error),U1}var H1,i6;function sX(){return i6||(i6=1,H1=EvalError),H1}var z1,s6;function oX(){return s6||(s6=1,z1=RangeError),z1}var j1,o6;function aX(){return o6||(o6=1,j1=ReferenceError),j1}var W1,a6;function n3(){return a6||(a6=1,W1=SyntaxError),W1}var q1,l6;function Tl(){return l6||(l6=1,q1=TypeError),q1}var V1,u6;function lX(){return u6||(u6=1,V1=URIError),V1}var K1,c6;function uX(){return c6||(c6=1,K1=Math.abs),K1}var G1,f6;function cX(){return f6||(f6=1,G1=Math.floor),G1}var $1,h6;function fX(){return h6||(h6=1,$1=Math.max),$1}var J1,d6;function hX(){return d6||(d6=1,J1=Math.min),J1}var X1,p6;function dX(){return p6||(p6=1,X1=Math.pow),X1}var Y1,m6;function pX(){return m6||(m6=1,Y1=Math.round),Y1}var Z1,g6;function mX(){return g6||(g6=1,Z1=Number.isNaN||function(e){return e!==e}),Z1}var Q1,v6;function gX(){if(v6)return Q1;v6=1;var r=mX();return Q1=function(t){return r(t)||t===0?t:t<0?-1:1},Q1}var e_,y6;function vX(){return y6||(y6=1,e_=Object.getOwnPropertyDescriptor),e_}var t_,w6;function Al(){if(w6)return t_;w6=1;var r=vX();if(r)try{r([],"length")}catch{r=null}return t_=r,t_}var r_,b6;function _d(){if(b6)return r_;b6=1;var r=Object.defineProperty||!1;if(r)try{r({},"a",{value:1})}catch{r=!1}return r_=r,r_}var n_,_6;function yX(){if(_6)return n_;_6=1;var r=typeof Symbol<"u"&&Symbol,e=t3();return n_=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},n_}var i_,x6;function i3(){return x6||(x6=1,i_=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),i_}var s_,E6;function s3(){if(E6)return s_;E6=1;var r=r3();return s_=r.getPrototypeOf||null,s_}var o_,S6;function wX(){if(S6)return o_;S6=1;var r="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,n="[object Function]",i=function(l,u){for(var c=[],f=0;f<l.length;f+=1)c[f]=l[f];for(var d=0;d<u.length;d+=1)c[d+l.length]=u[d];return c},s=function(l,u){for(var c=[],f=u,d=0;f<l.length;f+=1,d+=1)c[d]=l[f];return c},a=function(o,l){for(var u="",c=0;c<o.length;c+=1)u+=o[c],c+1<o.length&&(u+=l);return u};return o_=function(l){var u=this;if(typeof u!="function"||e.apply(u)!==n)throw new TypeError(r+u);for(var c=s(arguments,1),f,d=function(){if(this instanceof f){var m=u.apply(this,i(c,arguments));return Object(m)===m?m:this}return u.apply(l,i(c,arguments))},h=t(0,u.length-c.length),y=[],v=0;v<h;v++)y[v]="$"+v;if(f=Function("binder","return function ("+a(y,",")+"){ return binder.apply(this,arguments); }")(d),u.prototype){var x=function(){};x.prototype=u.prototype,f.prototype=new x,x.prototype=null}return f},o_}var a_,k6;function Ol(){if(k6)return a_;k6=1;var r=wX();return a_=Function.prototype.bind||r,a_}var l_,T6;function pT(){return T6||(T6=1,l_=Function.prototype.call),l_}var u_,A6;function o3(){return A6||(A6=1,u_=Function.prototype.apply),u_}var c_,O6;function bX(){return O6||(O6=1,c_=typeof Reflect<"u"&&Reflect&&Reflect.apply),c_}var f_,N6;function _X(){if(N6)return f_;N6=1;var r=Ol(),e=o3(),t=pT(),n=bX();return f_=n||r.call(t,e),f_}var h_,R6;function xX(){if(R6)return h_;R6=1;var r=Ol(),e=Tl(),t=pT(),n=_X();return h_=function(s){if(s.length<1||typeof s[0]!="function")throw new e("a function is required");return n(r,t,s)},h_}var d_,C6;function EX(){if(C6)return d_;C6=1;var r=xX(),e=Al(),t;try{t=[].__proto__===Array.prototype}catch(a){if(!a||typeof a!="object"||!("code"in a)||a.code!=="ERR_PROTO_ACCESS")throw a}var n=!!t&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return d_=n&&typeof n.get=="function"?r([n.get]):typeof s=="function"?(function(o){return s(o==null?o:i(o))}):!1,d_}var p_,I6;function SX(){if(I6)return p_;I6=1;var r=i3(),e=s3(),t=EX();return p_=r?function(i){return r(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:t?function(i){return t(i)}:null,p_}var m_,P6;function kX(){if(P6)return m_;P6=1;var r=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=Ol();return m_=t.call(r,e),m_}var g_,D6;function mT(){if(D6)return g_;D6=1;var r,e=r3(),t=iX(),n=sX(),i=oX(),s=aX(),a=n3(),o=Tl(),l=lX(),u=uX(),c=cX(),f=fX(),d=hX(),h=dX(),y=pX(),v=gX(),x=Function,m=function(W){try{return x('"use strict"; return ('+W+").constructor;")()}catch{}},_=Al(),b=_d(),w=function(){throw new o},T=_?(function(){try{return arguments.callee,w}catch{try{return _(arguments,"callee").get}catch{return w}}})():w,P=yX()(),M=SX(),U=s3(),R=i3(),J=o3(),oe=pT(),C={},H=typeof Uint8Array>"u"||!M?r:M(Uint8Array),k={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?r:ArrayBuffer,"%ArrayIteratorPrototype%":P&&M?M([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":C,"%AsyncGenerator%":C,"%AsyncGeneratorFunction%":C,"%AsyncIteratorPrototype%":C,"%Atomics%":typeof Atomics>"u"?r:Atomics,"%BigInt%":typeof BigInt>"u"?r:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?r:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":n,"%Float16Array%":typeof Float16Array>"u"?r:Float16Array,"%Float32Array%":typeof Float32Array>"u"?r:Float32Array,"%Float64Array%":typeof Float64Array>"u"?r:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?r:FinalizationRegistry,"%Function%":x,"%GeneratorFunction%":C,"%Int8Array%":typeof Int8Array>"u"?r:Int8Array,"%Int16Array%":typeof Int16Array>"u"?r:Int16Array,"%Int32Array%":typeof Int32Array>"u"?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":P&&M?M(M([][Symbol.iterator]())):r,"%JSON%":typeof JSON=="object"?JSON:r,"%Map%":typeof Map>"u"?r:Map,"%MapIteratorPrototype%":typeof Map>"u"||!P||!M?r:M(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":_,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?r:Promise,"%Proxy%":typeof Proxy>"u"?r:Proxy,"%RangeError%":i,"%ReferenceError%":s,"%Reflect%":typeof Reflect>"u"?r:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?r:Set,"%SetIteratorPrototype%":typeof Set>"u"||!P||!M?r:M(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":P&&M?M(""[Symbol.iterator]()):r,"%Symbol%":P?Symbol:r,"%SyntaxError%":a,"%ThrowTypeError%":T,"%TypedArray%":H,"%TypeError%":o,"%Uint8Array%":typeof Uint8Array>"u"?r:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?r:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?r:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?r:Uint32Array,"%URIError%":l,"%WeakMap%":typeof WeakMap>"u"?r:WeakMap,"%WeakRef%":typeof WeakRef>"u"?r:WeakRef,"%WeakSet%":typeof WeakSet>"u"?r:WeakSet,"%Function.prototype.call%":oe,"%Function.prototype.apply%":J,"%Object.defineProperty%":b,"%Object.getPrototypeOf%":U,"%Math.abs%":u,"%Math.floor%":c,"%Math.max%":f,"%Math.min%":d,"%Math.pow%":h,"%Math.round%":y,"%Math.sign%":v,"%Reflect.getPrototypeOf%":R};if(M)try{null.error}catch(W){var V=M(M(W));k["%Error.prototype%"]=V}var Q=function W(B){var I;if(B==="%AsyncFunction%")I=m("async function () {}");else if(B==="%GeneratorFunction%")I=m("function* () {}");else if(B==="%AsyncGeneratorFunction%")I=m("async function* () {}");else if(B==="%AsyncGenerator%"){var L=W("%AsyncGeneratorFunction%");L&&(I=L.prototype)}else if(B==="%AsyncIteratorPrototype%"){var Z=W("%AsyncGenerator%");Z&&M&&(I=M(Z.prototype))}return k[B]=I,I},j={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ie=Ol(),ee=kX(),le=ie.call(oe,Array.prototype.concat),G=ie.call(J,Array.prototype.splice),D=ie.call(oe,String.prototype.replace),$=ie.call(oe,String.prototype.slice),X=ie.call(oe,RegExp.prototype.exec),re=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,K=/\\(\\)?/g,O=function(B){var I=$(B,0,1),L=$(B,-1);if(I==="%"&&L!=="%")throw new a("invalid intrinsic syntax, expected closing `%`");if(L==="%"&&I!=="%")throw new a("invalid intrinsic syntax, expected opening `%`");var Z=[];return D(B,re,function(E,Y,N,p){Z[Z.length]=N?D(p,K,"$1"):Y||E}),Z},A=function(B,I){var L=B,Z;if(ee(j,L)&&(Z=j[L],L="%"+Z[0]+"%"),ee(k,L)){var E=k[L];if(E===C&&(E=Q(L)),typeof E>"u"&&!I)throw new o("intrinsic "+B+" exists, but is not available. Please file an issue!");return{alias:Z,name:L,value:E}}throw new a("intrinsic "+B+" does not exist!")};return g_=function(B,I){if(typeof B!="string"||B.length===0)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof I!="boolean")throw new o('"allowMissing" argument must be a boolean');if(X(/^%?[^%]*%?$/,B)===null)throw new a("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var L=O(B),Z=L.length>0?L[0]:"",E=A("%"+Z+"%",I),Y=E.name,N=E.value,p=!1,g=E.alias;g&&(Z=g[0],G(L,le([0,1],g)));for(var S=1,F=!0;S<L.length;S+=1){var q=L[S],z=$(q,0,1),ne=$(q,-1);if((z==='"'||z==="'"||z==="`"||ne==='"'||ne==="'"||ne==="`")&&z!==ne)throw new a("property names with quotes must have matching quotes");if((q==="constructor"||!F)&&(p=!0),Z+="."+q,Y="%"+Z+"%",ee(k,Y))N=k[Y];else if(N!=null){if(!(q in N)){if(!I)throw new o("base intrinsic for "+B+" exists, but the property is not available.");return}if(_&&S+1>=L.length){var ae=_(N,q);F=!!ae,F&&"get"in ae&&!("originalValue"in ae.get)?N=ae.get:N=N[q]}else F=ee(N,q),N=N[q];F&&!p&&(k[Y]=N)}}return N},g_}var v_={exports:{}},y_,M6;function TX(){if(M6)return y_;M6=1;var r=_d(),e=n3(),t=Tl(),n=Al();return y_=function(s,a,o){if(!s||typeof s!="object"&&typeof s!="function")throw new t("`obj` must be an object or a function`");if(typeof a!="string"&&typeof a!="symbol")throw new t("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new t("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new t("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new t("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new t("`loose`, if provided, must be a boolean");var l=arguments.length>3?arguments[3]:null,u=arguments.length>4?arguments[4]:null,c=arguments.length>5?arguments[5]:null,f=arguments.length>6?arguments[6]:!1,d=!!n&&n(s,a);if(r)r(s,a,{configurable:c===null&&d?d.configurable:!c,enumerable:l===null&&d?d.enumerable:!l,value:o,writable:u===null&&d?d.writable:!u});else if(f||!l&&!u&&!c)s[a]=o;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},y_}var w_,L6;function AX(){if(L6)return w_;L6=1;var r=_d(),e=function(){return!!r};return e.hasArrayLengthDefineBug=function(){if(!r)return null;try{return r([],"length",{value:1}).length!==1}catch{return!0}},w_=e,w_}var b_,F6;function OX(){if(F6)return b_;F6=1;var r=mT(),e=TX(),t=AX()(),n=Al(),i=Tl(),s=r("%Math.floor%");return b_=function(o,l){if(typeof o!="function")throw new i("`fn` is not a function");if(typeof l!="number"||l<0||l>4294967295||s(l)!==l)throw new i("`length` must be a positive 32-bit integer");var u=arguments.length>2&&!!arguments[2],c=!0,f=!0;if("length"in o&&n){var d=n(o,"length");d&&!d.configurable&&(c=!1),d&&!d.writable&&(f=!1)}return(c||f||!u)&&(t?e(o,"length",l,!0,!0):e(o,"length",l)),o},b_}var B6;function a3(){return B6||(B6=1,(function(r){var e=Ol(),t=mT(),n=OX(),i=Tl(),s=t("%Function.prototype.apply%"),a=t("%Function.prototype.call%"),o=t("%Reflect.apply%",!0)||e.call(a,s),l=_d(),u=t("%Math.max%");r.exports=function(d){if(typeof d!="function")throw new i("a function is required");var h=o(e,a,arguments);return n(h,1+u(0,d.length-(arguments.length-1)),!0)};var c=function(){return o(e,s,arguments)};l?l(r.exports,"apply",{value:c}):r.exports.apply=c})(v_)),v_.exports}var __,U6;function l3(){if(U6)return __;U6=1;var r=mT(),e=a3(),t=e(r("String.prototype.indexOf"));return __=function(i,s){var a=r(i,!!s);return typeof a=="function"&&t(i,".prototype.")>-1?e(a):a},__}var x_,H6;function NX(){if(H6)return x_;H6=1;var r=dT()(),e=l3(),t=e("Object.prototype.toString"),n=function(o){return r&&o&&typeof o=="object"&&Symbol.toStringTag in o?!1:t(o)==="[object Arguments]"},i=function(o){return n(o)?!0:o!==null&&typeof o=="object"&&typeof o.length=="number"&&o.length>=0&&t(o)!=="[object Array]"&&t(o.callee)==="[object Function]"},s=(function(){return n(arguments)})();return n.isLegacyArguments=i,x_=s?n:i,x_}var E_,z6;function RX(){if(z6)return E_;z6=1;var r=Object.prototype.toString,e=Function.prototype.toString,t=/^\s*(?:function)?\*/,n=dT()(),i=Object.getPrototypeOf,s=function(){if(!n)return!1;try{return Function("return function*() {}")()}catch{}},a;return E_=function(l){if(typeof l!="function")return!1;if(t.test(e.call(l)))return!0;if(!n){var u=r.call(l);return u==="[object GeneratorFunction]"}if(!i)return!1;if(typeof a>"u"){var c=s();a=c?i(c):!1}return i(l)===a},E_}var S_,j6;function CX(){if(j6)return S_;j6=1;var r=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,t,n;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{t=Object.defineProperty({},"length",{get:function(){throw n}}),n={},e(function(){throw 42},null,t)}catch(_){_!==n&&(e=null)}else e=null;var i=/^\s*class\b/,s=function(b){try{var w=r.call(b);return i.test(w)}catch{return!1}},a=function(b){try{return s(b)?!1:(r.call(b),!0)}catch{return!1}},o=Object.prototype.toString,l="[object Object]",u="[object Function]",c="[object GeneratorFunction]",f="[object HTMLAllCollection]",d="[object HTML document.all class]",h="[object HTMLCollection]",y=typeof Symbol=="function"&&!!Symbol.toStringTag,v=!(0 in[,]),x=function(){return!1};if(typeof document=="object"){var m=document.all;o.call(m)===o.call(document.all)&&(x=function(b){if((v||!b)&&(typeof b>"u"||typeof b=="object"))try{var w=o.call(b);return(w===f||w===d||w===h||w===l)&&b("")==null}catch{}return!1})}return S_=e?function(b){if(x(b))return!0;if(!b||typeof b!="function"&&typeof b!="object")return!1;try{e(b,null,t)}catch(w){if(w!==n)return!1}return!s(b)&&a(b)}:function(b){if(x(b))return!0;if(!b||typeof b!="function"&&typeof b!="object")return!1;if(y)return a(b);if(s(b))return!1;var w=o.call(b);return w!==u&&w!==c&&!/^\[object HTML/.test(w)?!1:a(b)},S_}var k_,W6;function IX(){if(W6)return k_;W6=1;var r=CX(),e=Object.prototype.toString,t=Object.prototype.hasOwnProperty,n=function(l,u,c){for(var f=0,d=l.length;f<d;f++)t.call(l,f)&&(c==null?u(l[f],f,l):u.call(c,l[f],f,l))},i=function(l,u,c){for(var f=0,d=l.length;f<d;f++)c==null?u(l.charAt(f),f,l):u.call(c,l.charAt(f),f,l)},s=function(l,u,c){for(var f in l)t.call(l,f)&&(c==null?u(l[f],f,l):u.call(c,l[f],f,l))},a=function(l,u,c){if(!r(u))throw new TypeError("iterator must be a function");var f;arguments.length>=3&&(f=c),e.call(l)==="[object Array]"?n(l,u,f):typeof l=="string"?i(l,u,f):s(l,u,f)};return k_=a,k_}var T_,q6;function PX(){return q6||(q6=1,T_=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),T_}var A_,V6;function DX(){if(V6)return A_;V6=1;var r=PX(),e=typeof globalThis>"u"?Qr:globalThis;return A_=function(){for(var n=[],i=0;i<r.length;i++)typeof e[r[i]]=="function"&&(n[n.length]=r[i]);return n},A_}var O_,K6;function u3(){if(K6)return O_;K6=1;var r=IX(),e=DX(),t=a3(),n=l3(),i=Al(),s=n("Object.prototype.toString"),a=dT()(),o=typeof globalThis>"u"?Qr:globalThis,l=e(),u=n("String.prototype.slice"),c=Object.getPrototypeOf,f=n("Array.prototype.indexOf",!0)||function(x,m){for(var _=0;_<x.length;_+=1)if(x[_]===m)return _;return-1},d={__proto__:null};a&&i&&c?r(l,function(v){var x=new o[v];if(Symbol.toStringTag in x){var m=c(x),_=i(m,Symbol.toStringTag);if(!_){var b=c(m);_=i(b,Symbol.toStringTag)}d["$"+v]=t(_.get)}}):r(l,function(v){var x=new o[v],m=x.slice||x.set;m&&(d["$"+v]=t(m))});var h=function(x){var m=!1;return r(d,function(_,b){if(!m)try{"$"+_(x)===b&&(m=u(b,1))}catch{}}),m},y=function(x){var m=!1;return r(d,function(_,b){if(!m)try{_(x),m=u(b,1)}catch{}}),m};return O_=function(x){if(!x||typeof x!="object")return!1;if(!a){var m=u(s(x),8,-1);return f(l,m)>-1?m:m!=="Object"?!1:y(x)}return i?h(x):null},O_}var N_,G6;function MX(){if(G6)return N_;G6=1;var r=u3();return N_=function(t){return!!r(t)},N_}var $6;function LX(){return $6||($6=1,(function(r){var e=NX(),t=RX(),n=u3(),i=MX();function s(S){return S.call.bind(S)}var a=typeof BigInt<"u",o=typeof Symbol<"u",l=s(Object.prototype.toString),u=s(Number.prototype.valueOf),c=s(String.prototype.valueOf),f=s(Boolean.prototype.valueOf);if(a)var d=s(BigInt.prototype.valueOf);if(o)var h=s(Symbol.prototype.valueOf);function y(S,F){if(typeof S!="object")return!1;try{return F(S),!0}catch{return!1}}r.isArgumentsObject=e,r.isGeneratorFunction=t,r.isTypedArray=i;function v(S){return typeof Promise<"u"&&S instanceof Promise||S!==null&&typeof S=="object"&&typeof S.then=="function"&&typeof S.catch=="function"}r.isPromise=v;function x(S){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(S):i(S)||$(S)}r.isArrayBufferView=x;function m(S){return n(S)==="Uint8Array"}r.isUint8Array=m;function _(S){return n(S)==="Uint8ClampedArray"}r.isUint8ClampedArray=_;function b(S){return n(S)==="Uint16Array"}r.isUint16Array=b;function w(S){return n(S)==="Uint32Array"}r.isUint32Array=w;function T(S){return n(S)==="Int8Array"}r.isInt8Array=T;function P(S){return n(S)==="Int16Array"}r.isInt16Array=P;function M(S){return n(S)==="Int32Array"}r.isInt32Array=M;function U(S){return n(S)==="Float32Array"}r.isFloat32Array=U;function R(S){return n(S)==="Float64Array"}r.isFloat64Array=R;function J(S){return n(S)==="BigInt64Array"}r.isBigInt64Array=J;function oe(S){return n(S)==="BigUint64Array"}r.isBigUint64Array=oe;function C(S){return l(S)==="[object Map]"}C.working=typeof Map<"u"&&C(new Map);function H(S){return typeof Map>"u"?!1:C.working?C(S):S instanceof Map}r.isMap=H;function k(S){return l(S)==="[object Set]"}k.working=typeof Set<"u"&&k(new Set);function V(S){return typeof Set>"u"?!1:k.working?k(S):S instanceof Set}r.isSet=V;function Q(S){return l(S)==="[object WeakMap]"}Q.working=typeof WeakMap<"u"&&Q(new WeakMap);function j(S){return typeof WeakMap>"u"?!1:Q.working?Q(S):S instanceof WeakMap}r.isWeakMap=j;function ie(S){return l(S)==="[object WeakSet]"}ie.working=typeof WeakSet<"u"&&ie(new WeakSet);function ee(S){return ie(S)}r.isWeakSet=ee;function le(S){return l(S)==="[object ArrayBuffer]"}le.working=typeof ArrayBuffer<"u"&&le(new ArrayBuffer);function G(S){return typeof ArrayBuffer>"u"?!1:le.working?le(S):S instanceof ArrayBuffer}r.isArrayBuffer=G;function D(S){return l(S)==="[object DataView]"}D.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&D(new DataView(new ArrayBuffer(1),0,1));function $(S){return typeof DataView>"u"?!1:D.working?D(S):S instanceof DataView}r.isDataView=$;var X=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function re(S){return l(S)==="[object SharedArrayBuffer]"}function K(S){return typeof X>"u"?!1:(typeof re.working>"u"&&(re.working=re(new X)),re.working?re(S):S instanceof X)}r.isSharedArrayBuffer=K;function O(S){return l(S)==="[object AsyncFunction]"}r.isAsyncFunction=O;function A(S){return l(S)==="[object Map Iterator]"}r.isMapIterator=A;function W(S){return l(S)==="[object Set Iterator]"}r.isSetIterator=W;function B(S){return l(S)==="[object Generator]"}r.isGeneratorObject=B;function I(S){return l(S)==="[object WebAssembly.Module]"}r.isWebAssemblyCompiledModule=I;function L(S){return y(S,u)}r.isNumberObject=L;function Z(S){return y(S,c)}r.isStringObject=Z;function E(S){return y(S,f)}r.isBooleanObject=E;function Y(S){return a&&y(S,d)}r.isBigIntObject=Y;function N(S){return o&&y(S,h)}r.isSymbolObject=N;function p(S){return L(S)||Z(S)||E(S)||Y(S)||N(S)}r.isBoxedPrimitive=p;function g(S){return typeof Uint8Array<"u"&&(G(S)||K(S))}r.isAnyArrayBuffer=g,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(S){Object.defineProperty(r,S,{enumerable:!1,value:function(){throw new Error(S+" is not supported in userland")}})})})(M1)),M1}var R_,J6;function FX(){return J6||(J6=1,R_=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}),R_}var X6;function c3(){return X6||(X6=1,(function(r){var e=Object.getOwnPropertyDescriptors||function($){for(var X=Object.keys($),re={},K=0;K<X.length;K++)re[X[K]]=Object.getOwnPropertyDescriptor($,X[K]);return re},t=/%[sdj%]/g;r.format=function(D){if(!T(D)){for(var $=[],X=0;X<arguments.length;X++)$.push(a(arguments[X]));return $.join(" ")}for(var X=1,re=arguments,K=re.length,O=String(D).replace(t,function(W){if(W==="%%")return"%";if(X>=K)return W;switch(W){case"%s":return String(re[X++]);case"%d":return Number(re[X++]);case"%j":try{return JSON.stringify(re[X++])}catch{return"[Circular]"}default:return W}}),A=re[X];X<K;A=re[++X])_(A)||!R(A)?O+=" "+A:O+=" "+a(A);return O},r.deprecate=function(D,$){if(typeof Ie<"u"&&Ie.noDeprecation===!0)return D;if(typeof Ie>"u")return function(){return r.deprecate(D,$).apply(this,arguments)};var X=!1;function re(){if(!X){if(Ie.throwDeprecation)throw new Error($);Ie.traceDeprecation?console.trace($):console.error($),X=!0}return D.apply(this,arguments)}return re};var n={},i=/^$/;if(Ie.env.NODE_DEBUG){var s=Ie.env.NODE_DEBUG;s=s.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),i=new RegExp("^"+s+"$","i")}r.debuglog=function(D){if(D=D.toUpperCase(),!n[D])if(i.test(D)){var $=Ie.pid;n[D]=function(){var X=r.format.apply(r,arguments);console.error("%s %d: %s",D,$,X)}}else n[D]=function(){};return n[D]};function a(D,$){var X={seen:[],stylize:l};return arguments.length>=3&&(X.depth=arguments[2]),arguments.length>=4&&(X.colors=arguments[3]),m($)?X.showHidden=$:$&&r._extend(X,$),M(X.showHidden)&&(X.showHidden=!1),M(X.depth)&&(X.depth=2),M(X.colors)&&(X.colors=!1),M(X.customInspect)&&(X.customInspect=!0),X.colors&&(X.stylize=o),c(X,D,X.depth)}r.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function o(D,$){var X=a.styles[$];return X?"\x1B["+a.colors[X][0]+"m"+D+"\x1B["+a.colors[X][1]+"m":D}function l(D,$){return D}function u(D){var $={};return D.forEach(function(X,re){$[X]=!0}),$}function c(D,$,X){if(D.customInspect&&$&&C($.inspect)&&$.inspect!==r.inspect&&!($.constructor&&$.constructor.prototype===$)){var re=$.inspect(X,D);return T(re)||(re=c(D,re,X)),re}var K=f(D,$);if(K)return K;var O=Object.keys($),A=u(O);if(D.showHidden&&(O=Object.getOwnPropertyNames($)),oe($)&&(O.indexOf("message")>=0||O.indexOf("description")>=0))return d($);if(O.length===0){if(C($)){var W=$.name?": "+$.name:"";return D.stylize("[Function"+W+"]","special")}if(U($))return D.stylize(RegExp.prototype.toString.call($),"regexp");if(J($))return D.stylize(Date.prototype.toString.call($),"date");if(oe($))return d($)}var B="",I=!1,L=["{","}"];if(x($)&&(I=!0,L=["[","]"]),C($)){var Z=$.name?": "+$.name:"";B=" [Function"+Z+"]"}if(U($)&&(B=" "+RegExp.prototype.toString.call($)),J($)&&(B=" "+Date.prototype.toUTCString.call($)),oe($)&&(B=" "+d($)),O.length===0&&(!I||$.length==0))return L[0]+B+L[1];if(X<0)return U($)?D.stylize(RegExp.prototype.toString.call($),"regexp"):D.stylize("[Object]","special");D.seen.push($);var E;return I?E=h(D,$,X,A,O):E=O.map(function(Y){return y(D,$,X,A,Y,I)}),D.seen.pop(),v(E,B,L)}function f(D,$){if(M($))return D.stylize("undefined","undefined");if(T($)){var X="'"+JSON.stringify($).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return D.stylize(X,"string")}if(w($))return D.stylize(""+$,"number");if(m($))return D.stylize(""+$,"boolean");if(_($))return D.stylize("null","null")}function d(D){return"["+Error.prototype.toString.call(D)+"]"}function h(D,$,X,re,K){for(var O=[],A=0,W=$.length;A<W;++A)ie($,String(A))?O.push(y(D,$,X,re,String(A),!0)):O.push("");return K.forEach(function(B){B.match(/^\d+$/)||O.push(y(D,$,X,re,B,!0))}),O}function y(D,$,X,re,K,O){var A,W,B;if(B=Object.getOwnPropertyDescriptor($,K)||{value:$[K]},B.get?B.set?W=D.stylize("[Getter/Setter]","special"):W=D.stylize("[Getter]","special"):B.set&&(W=D.stylize("[Setter]","special")),ie(re,K)||(A="["+K+"]"),W||(D.seen.indexOf(B.value)<0?(_(X)?W=c(D,B.value,null):W=c(D,B.value,X-1),W.indexOf(`
`)>-1&&(O?W=W.split(`
`).map(function(I){return"  "+I}).join(`
`).slice(2):W=`
`+W.split(`
`).map(function(I){return"   "+I}).join(`
`))):W=D.stylize("[Circular]","special")),M(A)){if(O&&K.match(/^\d+$/))return W;A=JSON.stringify(""+K),A.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(A=A.slice(1,-1),A=D.stylize(A,"name")):(A=A.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),A=D.stylize(A,"string"))}return A+": "+W}function v(D,$,X){var re=D.reduce(function(K,O){return O.indexOf(`
`)>=0,K+O.replace(/\u001b\[\d\d?m/g,"").length+1},0);return re>60?X[0]+($===""?"":$+`
 `)+" "+D.join(`,
  `)+" "+X[1]:X[0]+$+" "+D.join(", ")+" "+X[1]}r.types=LX();function x(D){return Array.isArray(D)}r.isArray=x;function m(D){return typeof D=="boolean"}r.isBoolean=m;function _(D){return D===null}r.isNull=_;function b(D){return D==null}r.isNullOrUndefined=b;function w(D){return typeof D=="number"}r.isNumber=w;function T(D){return typeof D=="string"}r.isString=T;function P(D){return typeof D=="symbol"}r.isSymbol=P;function M(D){return D===void 0}r.isUndefined=M;function U(D){return R(D)&&k(D)==="[object RegExp]"}r.isRegExp=U,r.types.isRegExp=U;function R(D){return typeof D=="object"&&D!==null}r.isObject=R;function J(D){return R(D)&&k(D)==="[object Date]"}r.isDate=J,r.types.isDate=J;function oe(D){return R(D)&&(k(D)==="[object Error]"||D instanceof Error)}r.isError=oe,r.types.isNativeError=oe;function C(D){return typeof D=="function"}r.isFunction=C;function H(D){return D===null||typeof D=="boolean"||typeof D=="number"||typeof D=="string"||typeof D=="symbol"||typeof D>"u"}r.isPrimitive=H,r.isBuffer=FX();function k(D){return Object.prototype.toString.call(D)}function V(D){return D<10?"0"+D.toString(10):D.toString(10)}var Q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function j(){var D=new Date,$=[V(D.getHours()),V(D.getMinutes()),V(D.getSeconds())].join(":");return[D.getDate(),Q[D.getMonth()],$].join(" ")}r.log=function(){console.log("%s - %s",j(),r.format.apply(r,arguments))},r.inherits=oi(),r._extend=function(D,$){if(!$||!R($))return D;for(var X=Object.keys($),re=X.length;re--;)D[X[re]]=$[X[re]];return D};function ie(D,$){return Object.prototype.hasOwnProperty.call(D,$)}var ee=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;r.promisify=function($){if(typeof $!="function")throw new TypeError('The "original" argument must be of type Function');if(ee&&$[ee]){var X=$[ee];if(typeof X!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(X,ee,{value:X,enumerable:!1,writable:!1,configurable:!0}),X}function X(){for(var re,K,O=new Promise(function(B,I){re=B,K=I}),A=[],W=0;W<arguments.length;W++)A.push(arguments[W]);A.push(function(B,I){B?K(B):re(I)});try{$.apply(this,A)}catch(B){K(B)}return O}return Object.setPrototypeOf(X,Object.getPrototypeOf($)),ee&&Object.defineProperty(X,ee,{value:X,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(X,e($))},r.promisify.custom=ee;function le(D,$){if(!D){var X=new Error("Promise was rejected with a falsy value");X.reason=D,D=X}return $(D)}function G(D){if(typeof D!="function")throw new TypeError('The "original" argument must be of type Function');function $(){for(var X=[],re=0;re<arguments.length;re++)X.push(arguments[re]);var K=X.pop();if(typeof K!="function")throw new TypeError("The last argument must be of type Function");var O=this,A=function(){return K.apply(O,arguments)};D.apply(this,X).then(function(W){Ie.nextTick(A.bind(null,null,W))},function(W){Ie.nextTick(le.bind(null,W,A))})}return Object.setPrototypeOf($,Object.getPrototypeOf(D)),Object.defineProperties($,e(D)),$}r.callbackify=G})(D1)),D1}var C_,Y6;function BX(){if(Y6)return C_;Y6=1;function r(d,h){var y=Object.keys(d);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(d);h&&(v=v.filter(function(x){return Object.getOwnPropertyDescriptor(d,x).enumerable})),y.push.apply(y,v)}return y}function e(d){for(var h=1;h<arguments.length;h++){var y=arguments[h]!=null?arguments[h]:{};h%2?r(Object(y),!0).forEach(function(v){t(d,v,y[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(y)):r(Object(y)).forEach(function(v){Object.defineProperty(d,v,Object.getOwnPropertyDescriptor(y,v))})}return d}function t(d,h,y){return h in d?Object.defineProperty(d,h,{value:y,enumerable:!0,configurable:!0,writable:!0}):d[h]=y,d}function n(d,h){if(!(d instanceof h))throw new TypeError("Cannot call a class as a function")}function i(d,h){for(var y=0;y<h.length;y++){var v=h[y];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(d,v.key,v)}}function s(d,h,y){return h&&i(d.prototype,h),d}var a=bd(),o=a.Buffer,l=c3(),u=l.inspect,c=u&&u.custom||"inspect";function f(d,h,y){o.prototype.copy.call(d,h,y)}return C_=(function(){function d(){n(this,d),this.head=null,this.tail=null,this.length=0}return s(d,[{key:"push",value:function(y){var v={data:y,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(y){var v={data:y,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var y=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,y}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(y){if(this.length===0)return"";for(var v=this.head,x=""+v.data;v=v.next;)x+=y+v.data;return x}},{key:"concat",value:function(y){if(this.length===0)return o.alloc(0);for(var v=o.allocUnsafe(y>>>0),x=this.head,m=0;x;)f(x.data,v,m),m+=x.data.length,x=x.next;return v}},{key:"consume",value:function(y,v){var x;return y<this.head.data.length?(x=this.head.data.slice(0,y),this.head.data=this.head.data.slice(y)):y===this.head.data.length?x=this.shift():x=v?this._getString(y):this._getBuffer(y),x}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(y){var v=this.head,x=1,m=v.data;for(y-=m.length;v=v.next;){var _=v.data,b=y>_.length?_.length:y;if(b===_.length?m+=_:m+=_.slice(0,y),y-=b,y===0){b===_.length?(++x,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=_.slice(b));break}++x}return this.length-=x,m}},{key:"_getBuffer",value:function(y){var v=o.allocUnsafe(y),x=this.head,m=1;for(x.data.copy(v),y-=x.data.length;x=x.next;){var _=x.data,b=y>_.length?_.length:y;if(_.copy(v,v.length-y,0,b),y-=b,y===0){b===_.length?(++m,x.next?this.head=x.next:this.head=this.tail=null):(this.head=x,x.data=_.slice(b));break}++m}return this.length-=m,v}},{key:c,value:function(y,v){return u(this,e({},v,{depth:0,customInspect:!1}))}}]),d})(),C_}var I_,Z6;function f3(){if(Z6)return I_;Z6=1;function r(a,o){var l=this,u=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return u||c?(o?o(a):a&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Ie.nextTick(i,this,a)):Ie.nextTick(i,this,a)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(a||null,function(f){!o&&f?l._writableState?l._writableState.errorEmitted?Ie.nextTick(t,l):(l._writableState.errorEmitted=!0,Ie.nextTick(e,l,f)):Ie.nextTick(e,l,f):o?(Ie.nextTick(t,l),o(f)):Ie.nextTick(t,l)}),this)}function e(a,o){i(a,o),t(a)}function t(a){a._writableState&&!a._writableState.emitClose||a._readableState&&!a._readableState.emitClose||a.emit("close")}function n(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function i(a,o){a.emit("error",o)}function s(a,o){var l=a._readableState,u=a._writableState;l&&l.autoDestroy||u&&u.autoDestroy?a.destroy(o):a.emit("error",o)}return I_={destroy:r,undestroy:n,errorOrDestroy:s},I_}var P_={},Q6;function po(){if(Q6)return P_;Q6=1;function r(o,l){o.prototype=Object.create(l.prototype),o.prototype.constructor=o,o.__proto__=l}var e={};function t(o,l,u){u||(u=Error);function c(d,h,y){return typeof l=="string"?l:l(d,h,y)}var f=(function(d){r(h,d);function h(y,v,x){return d.call(this,c(y,v,x))||this}return h})(u);f.prototype.name=u.name,f.prototype.code=o,e[o]=f}function n(o,l){if(Array.isArray(o)){var u=o.length;return o=o.map(function(c){return String(c)}),u>2?"one of ".concat(l," ").concat(o.slice(0,u-1).join(", "),", or ")+o[u-1]:u===2?"one of ".concat(l," ").concat(o[0]," or ").concat(o[1]):"of ".concat(l," ").concat(o[0])}else return"of ".concat(l," ").concat(String(o))}function i(o,l,u){return o.substr(0,l.length)===l}function s(o,l,u){return(u===void 0||u>o.length)&&(u=o.length),o.substring(u-l.length,u)===l}function a(o,l,u){return typeof u!="number"&&(u=0),u+l.length>o.length?!1:o.indexOf(l,u)!==-1}return t("ERR_INVALID_OPT_VALUE",function(o,l){return'The value "'+l+'" is invalid for option "'+o+'"'},TypeError),t("ERR_INVALID_ARG_TYPE",function(o,l,u){var c;typeof l=="string"&&i(l,"not ")?(c="must not be",l=l.replace(/^not /,"")):c="must be";var f;if(s(o," argument"))f="The ".concat(o," ").concat(c," ").concat(n(l,"type"));else{var d=a(o,".")?"property":"argument";f='The "'.concat(o,'" ').concat(d," ").concat(c," ").concat(n(l,"type"))}return f+=". Received type ".concat(typeof u),f},TypeError),t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),t("ERR_METHOD_NOT_IMPLEMENTED",function(o){return"The "+o+" method is not implemented"}),t("ERR_STREAM_PREMATURE_CLOSE","Premature close"),t("ERR_STREAM_DESTROYED",function(o){return"Cannot call "+o+" after a stream was destroyed"}),t("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),t("ERR_STREAM_WRITE_AFTER_END","write after end"),t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),t("ERR_UNKNOWN_ENCODING",function(o){return"Unknown encoding: "+o},TypeError),t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),P_.codes=e,P_}var D_,eL;function h3(){if(eL)return D_;eL=1;var r=po().codes.ERR_INVALID_OPT_VALUE;function e(n,i,s){return n.highWaterMark!=null?n.highWaterMark:i?n[s]:null}function t(n,i,s,a){var o=e(i,a,s);if(o!=null){if(!(isFinite(o)&&Math.floor(o)===o)||o<0){var l=a?s:"highWaterMark";throw new r(l,o)}return Math.floor(o)}return n.objectMode?16:16*1024}return D_={getHighWaterMark:t},D_}var M_,tL;function UX(){if(tL)return M_;tL=1,M_=r;function r(t,n){if(e("noDeprecation"))return t;var i=!1;function s(){if(!i){if(e("throwDeprecation"))throw new Error(n);e("traceDeprecation")?console.trace(n):console.warn(n),i=!0}return t.apply(this,arguments)}return s}function e(t){try{if(!Qr.localStorage)return!1}catch{return!1}var n=Qr.localStorage[t];return n==null?!1:String(n).toLowerCase()==="true"}return M_}var L_,rL;function d3(){if(rL)return L_;rL=1,L_=U;function r(K){var O=this;this.next=null,this.entry=null,this.finish=function(){re(O,K)}}var e;U.WritableState=P;var t={deprecate:UX()},n=e3(),i=bd().Buffer,s=Qr.Uint8Array||function(){};function a(K){return i.from(K)}function o(K){return i.isBuffer(K)||K instanceof s}var l=f3(),u=h3(),c=u.getHighWaterMark,f=po().codes,d=f.ERR_INVALID_ARG_TYPE,h=f.ERR_METHOD_NOT_IMPLEMENTED,y=f.ERR_MULTIPLE_CALLBACK,v=f.ERR_STREAM_CANNOT_PIPE,x=f.ERR_STREAM_DESTROYED,m=f.ERR_STREAM_NULL_VALUES,_=f.ERR_STREAM_WRITE_AFTER_END,b=f.ERR_UNKNOWN_ENCODING,w=l.errorOrDestroy;oi()(U,n);function T(){}function P(K,O,A){e=e||fo(),K=K||{},typeof A!="boolean"&&(A=O instanceof e),this.objectMode=!!K.objectMode,A&&(this.objectMode=this.objectMode||!!K.writableObjectMode),this.highWaterMark=c(this,K,"writableHighWaterMark",A),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var W=K.decodeStrings===!1;this.decodeStrings=!W,this.defaultEncoding=K.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(B){Q(O,B)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=K.emitClose!==!1,this.autoDestroy=!!K.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}P.prototype.getBuffer=function(){for(var O=this.bufferedRequest,A=[];O;)A.push(O),O=O.next;return A},(function(){try{Object.defineProperty(P.prototype,"buffer",{get:t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var M;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(M=Function.prototype[Symbol.hasInstance],Object.defineProperty(U,Symbol.hasInstance,{value:function(O){return M.call(this,O)?!0:this!==U?!1:O&&O._writableState instanceof P}})):M=function(O){return O instanceof this};function U(K){e=e||fo();var O=this instanceof e;if(!O&&!M.call(U,this))return new U(K);this._writableState=new P(K,this,O),this.writable=!0,K&&(typeof K.write=="function"&&(this._write=K.write),typeof K.writev=="function"&&(this._writev=K.writev),typeof K.destroy=="function"&&(this._destroy=K.destroy),typeof K.final=="function"&&(this._final=K.final)),n.call(this)}U.prototype.pipe=function(){w(this,new v)};function R(K,O){var A=new _;w(K,A),Ie.nextTick(O,A)}function J(K,O,A,W){var B;return A===null?B=new m:typeof A!="string"&&!O.objectMode&&(B=new d("chunk",["string","Buffer"],A)),B?(w(K,B),Ie.nextTick(W,B),!1):!0}U.prototype.write=function(K,O,A){var W=this._writableState,B=!1,I=!W.objectMode&&o(K);return I&&!i.isBuffer(K)&&(K=a(K)),typeof O=="function"&&(A=O,O=null),I?O="buffer":O||(O=W.defaultEncoding),typeof A!="function"&&(A=T),W.ending?R(this,A):(I||J(this,W,K,A))&&(W.pendingcb++,B=C(this,W,I,K,O,A)),B},U.prototype.cork=function(){this._writableState.corked++},U.prototype.uncork=function(){var K=this._writableState;K.corked&&(K.corked--,!K.writing&&!K.corked&&!K.bufferProcessing&&K.bufferedRequest&&ee(this,K))},U.prototype.setDefaultEncoding=function(O){if(typeof O=="string"&&(O=O.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((O+"").toLowerCase())>-1))throw new b(O);return this._writableState.defaultEncoding=O,this},Object.defineProperty(U.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function oe(K,O,A){return!K.objectMode&&K.decodeStrings!==!1&&typeof O=="string"&&(O=i.from(O,A)),O}Object.defineProperty(U.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function C(K,O,A,W,B,I){if(!A){var L=oe(O,W,B);W!==L&&(A=!0,B="buffer",W=L)}var Z=O.objectMode?1:W.length;O.length+=Z;var E=O.length<O.highWaterMark;if(E||(O.needDrain=!0),O.writing||O.corked){var Y=O.lastBufferedRequest;O.lastBufferedRequest={chunk:W,encoding:B,isBuf:A,callback:I,next:null},Y?Y.next=O.lastBufferedRequest:O.bufferedRequest=O.lastBufferedRequest,O.bufferedRequestCount+=1}else H(K,O,!1,Z,W,B,I);return E}function H(K,O,A,W,B,I,L){O.writelen=W,O.writecb=L,O.writing=!0,O.sync=!0,O.destroyed?O.onwrite(new x("write")):A?K._writev(B,O.onwrite):K._write(B,I,O.onwrite),O.sync=!1}function k(K,O,A,W,B){--O.pendingcb,A?(Ie.nextTick(B,W),Ie.nextTick($,K,O),K._writableState.errorEmitted=!0,w(K,W)):(B(W),K._writableState.errorEmitted=!0,w(K,W),$(K,O))}function V(K){K.writing=!1,K.writecb=null,K.length-=K.writelen,K.writelen=0}function Q(K,O){var A=K._writableState,W=A.sync,B=A.writecb;if(typeof B!="function")throw new y;if(V(A),O)k(K,A,W,O,B);else{var I=le(A)||K.destroyed;!I&&!A.corked&&!A.bufferProcessing&&A.bufferedRequest&&ee(K,A),W?Ie.nextTick(j,K,A,I,B):j(K,A,I,B)}}function j(K,O,A,W){A||ie(K,O),O.pendingcb--,W(),$(K,O)}function ie(K,O){O.length===0&&O.needDrain&&(O.needDrain=!1,K.emit("drain"))}function ee(K,O){O.bufferProcessing=!0;var A=O.bufferedRequest;if(K._writev&&A&&A.next){var W=O.bufferedRequestCount,B=new Array(W),I=O.corkedRequestsFree;I.entry=A;for(var L=0,Z=!0;A;)B[L]=A,A.isBuf||(Z=!1),A=A.next,L+=1;B.allBuffers=Z,H(K,O,!0,O.length,B,"",I.finish),O.pendingcb++,O.lastBufferedRequest=null,I.next?(O.corkedRequestsFree=I.next,I.next=null):O.corkedRequestsFree=new r(O),O.bufferedRequestCount=0}else{for(;A;){var E=A.chunk,Y=A.encoding,N=A.callback,p=O.objectMode?1:E.length;if(H(K,O,!1,p,E,Y,N),A=A.next,O.bufferedRequestCount--,O.writing)break}A===null&&(O.lastBufferedRequest=null)}O.bufferedRequest=A,O.bufferProcessing=!1}U.prototype._write=function(K,O,A){A(new h("_write()"))},U.prototype._writev=null,U.prototype.end=function(K,O,A){var W=this._writableState;return typeof K=="function"?(A=K,K=null,O=null):typeof O=="function"&&(A=O,O=null),K!=null&&this.write(K,O),W.corked&&(W.corked=1,this.uncork()),W.ending||X(this,W,A),this},Object.defineProperty(U.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function le(K){return K.ending&&K.length===0&&K.bufferedRequest===null&&!K.finished&&!K.writing}function G(K,O){K._final(function(A){O.pendingcb--,A&&w(K,A),O.prefinished=!0,K.emit("prefinish"),$(K,O)})}function D(K,O){!O.prefinished&&!O.finalCalled&&(typeof K._final=="function"&&!O.destroyed?(O.pendingcb++,O.finalCalled=!0,Ie.nextTick(G,K,O)):(O.prefinished=!0,K.emit("prefinish")))}function $(K,O){var A=le(O);if(A&&(D(K,O),O.pendingcb===0&&(O.finished=!0,K.emit("finish"),O.autoDestroy))){var W=K._readableState;(!W||W.autoDestroy&&W.endEmitted)&&K.destroy()}return A}function X(K,O,A){O.ending=!0,$(K,O),A&&(O.finished?Ie.nextTick(A):K.once("finish",A)),O.ended=!0,K.writable=!1}function re(K,O,A){var W=K.entry;for(K.entry=null;W;){var B=W.callback;O.pendingcb--,B(A),W=W.next}O.corkedRequestsFree.next=K}return Object.defineProperty(U.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(O){this._writableState&&(this._writableState.destroyed=O)}}),U.prototype.destroy=l.destroy,U.prototype._undestroy=l.undestroy,U.prototype._destroy=function(K,O){O(K)},L_}var F_,nL;function fo(){if(nL)return F_;nL=1;var r=Object.keys||function(u){var c=[];for(var f in u)c.push(f);return c};F_=a;var e=p3(),t=d3();oi()(a,e);for(var n=r(t.prototype),i=0;i<n.length;i++){var s=n[i];a.prototype[s]||(a.prototype[s]=t.prototype[s])}function a(u){if(!(this instanceof a))return new a(u);e.call(this,u),t.call(this,u),this.allowHalfOpen=!0,u&&(u.readable===!1&&(this.readable=!1),u.writable===!1&&(this.writable=!1),u.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",o)))}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function o(){this._writableState.ended||Ie.nextTick(l,this)}function l(u){u.end()}return Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(c){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=c,this._writableState.destroyed=c)}}),F_}var B_={},Pf={exports:{}},iL;function HX(){return iL||(iL=1,(function(r,e){var t=bd(),n=t.Buffer;function i(a,o){for(var l in a)o[l]=a[l]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?r.exports=t:(i(t,e),e.Buffer=s);function s(a,o,l){return n(a,o,l)}i(n,s),s.from=function(a,o,l){if(typeof a=="number")throw new TypeError("Argument must not be a number");return n(a,o,l)},s.alloc=function(a,o,l){if(typeof a!="number")throw new TypeError("Argument must be a number");var u=n(a);return o!==void 0?typeof l=="string"?u.fill(o,l):u.fill(o):u.fill(0),u},s.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n(a)},s.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(a)}})(Pf,Pf.exports)),Pf.exports}var sL;function wx(){if(sL)return B_;sL=1;var r=HX().Buffer,e=r.isEncoding||function(m){switch(m=""+m,m&&m.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(m){if(!m)return"utf8";for(var _;;)switch(m){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return m;default:if(_)return;m=(""+m).toLowerCase(),_=!0}}function n(m){var _=t(m);if(typeof _!="string"&&(r.isEncoding===e||!e(m)))throw new Error("Unknown encoding: "+m);return _||m}B_.StringDecoder=i;function i(m){this.encoding=n(m);var _;switch(this.encoding){case"utf16le":this.text=f,this.end=d,_=4;break;case"utf8":this.fillLast=l,_=4;break;case"base64":this.text=h,this.end=y,_=3;break;default:this.write=v,this.end=x;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(_)}i.prototype.write=function(m){if(m.length===0)return"";var _,b;if(this.lastNeed){if(_=this.fillLast(m),_===void 0)return"";b=this.lastNeed,this.lastNeed=0}else b=0;return b<m.length?_?_+this.text(m,b):this.text(m,b):_||""},i.prototype.end=c,i.prototype.text=u,i.prototype.fillLast=function(m){if(this.lastNeed<=m.length)return m.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);m.copy(this.lastChar,this.lastTotal-this.lastNeed,0,m.length),this.lastNeed-=m.length};function s(m){return m<=127?0:m>>5===6?2:m>>4===14?3:m>>3===30?4:m>>6===2?-1:-2}function a(m,_,b){var w=_.length-1;if(w<b)return 0;var T=s(_[w]);return T>=0?(T>0&&(m.lastNeed=T-1),T):--w<b||T===-2?0:(T=s(_[w]),T>=0?(T>0&&(m.lastNeed=T-2),T):--w<b||T===-2?0:(T=s(_[w]),T>=0?(T>0&&(T===2?T=0:m.lastNeed=T-3),T):0))}function o(m,_,b){if((_[0]&192)!==128)return m.lastNeed=0,"\uFFFD";if(m.lastNeed>1&&_.length>1){if((_[1]&192)!==128)return m.lastNeed=1,"\uFFFD";if(m.lastNeed>2&&_.length>2&&(_[2]&192)!==128)return m.lastNeed=2,"\uFFFD"}}function l(m){var _=this.lastTotal-this.lastNeed,b=o(this,m);if(b!==void 0)return b;if(this.lastNeed<=m.length)return m.copy(this.lastChar,_,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);m.copy(this.lastChar,_,0,m.length),this.lastNeed-=m.length}function u(m,_){var b=a(this,m,_);if(!this.lastNeed)return m.toString("utf8",_);this.lastTotal=b;var w=m.length-(b-this.lastNeed);return m.copy(this.lastChar,0,w),m.toString("utf8",_,w)}function c(m){var _=m&&m.length?this.write(m):"";return this.lastNeed?_+"\uFFFD":_}function f(m,_){if((m.length-_)%2===0){var b=m.toString("utf16le",_);if(b){var w=b.charCodeAt(b.length-1);if(w>=55296&&w<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=m[m.length-2],this.lastChar[1]=m[m.length-1],b.slice(0,-1)}return b}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=m[m.length-1],m.toString("utf16le",_,m.length-1)}function d(m){var _=m&&m.length?this.write(m):"";if(this.lastNeed){var b=this.lastTotal-this.lastNeed;return _+this.lastChar.toString("utf16le",0,b)}return _}function h(m,_){var b=(m.length-_)%3;return b===0?m.toString("base64",_):(this.lastNeed=3-b,this.lastTotal=3,b===1?this.lastChar[0]=m[m.length-1]:(this.lastChar[0]=m[m.length-2],this.lastChar[1]=m[m.length-1]),m.toString("base64",_,m.length-b))}function y(m){var _=m&&m.length?this.write(m):"";return this.lastNeed?_+this.lastChar.toString("base64",0,3-this.lastNeed):_}function v(m){return m.toString(this.encoding)}function x(m){return m&&m.length?this.write(m):""}return B_}var U_,oL;function gT(){if(oL)return U_;oL=1;var r=po().codes.ERR_STREAM_PREMATURE_CLOSE;function e(s){var a=!1;return function(){if(!a){a=!0;for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];s.apply(this,l)}}}function t(){}function n(s){return s.setHeader&&typeof s.abort=="function"}function i(s,a,o){if(typeof a=="function")return i(s,null,a);a||(a={}),o=e(o||t);var l=a.readable||a.readable!==!1&&s.readable,u=a.writable||a.writable!==!1&&s.writable,c=function(){s.writable||d()},f=s._writableState&&s._writableState.finished,d=function(){u=!1,f=!0,l||o.call(s)},h=s._readableState&&s._readableState.endEmitted,y=function(){l=!1,h=!0,u||o.call(s)},v=function(b){o.call(s,b)},x=function(){var b;if(l&&!h)return(!s._readableState||!s._readableState.ended)&&(b=new r),o.call(s,b);if(u&&!f)return(!s._writableState||!s._writableState.ended)&&(b=new r),o.call(s,b)},m=function(){s.req.on("finish",d)};return n(s)?(s.on("complete",d),s.on("abort",x),s.req?m():s.on("request",m)):u&&!s._writableState&&(s.on("end",c),s.on("close",c)),s.on("end",y),s.on("finish",d),a.error!==!1&&s.on("error",v),s.on("close",x),function(){s.removeListener("complete",d),s.removeListener("abort",x),s.removeListener("request",m),s.req&&s.req.removeListener("finish",d),s.removeListener("end",c),s.removeListener("close",c),s.removeListener("finish",d),s.removeListener("end",y),s.removeListener("error",v),s.removeListener("close",x)}}return U_=i,U_}var H_,aL;function zX(){if(aL)return H_;aL=1;var r;function e(m,_,b){return _ in m?Object.defineProperty(m,_,{value:b,enumerable:!0,configurable:!0,writable:!0}):m[_]=b,m}var t=gT(),n=Symbol("lastResolve"),i=Symbol("lastReject"),s=Symbol("error"),a=Symbol("ended"),o=Symbol("lastPromise"),l=Symbol("handlePromise"),u=Symbol("stream");function c(m,_){return{value:m,done:_}}function f(m){var _=m[n];if(_!==null){var b=m[u].read();b!==null&&(m[o]=null,m[n]=null,m[i]=null,_(c(b,!1)))}}function d(m){Ie.nextTick(f,m)}function h(m,_){return function(b,w){m.then(function(){if(_[a]){b(c(void 0,!0));return}_[l](b,w)},w)}}var y=Object.getPrototypeOf(function(){}),v=Object.setPrototypeOf((r={get stream(){return this[u]},next:function(){var _=this,b=this[s];if(b!==null)return Promise.reject(b);if(this[a])return Promise.resolve(c(void 0,!0));if(this[u].destroyed)return new Promise(function(M,U){Ie.nextTick(function(){_[s]?U(_[s]):M(c(void 0,!0))})});var w=this[o],T;if(w)T=new Promise(h(w,this));else{var P=this[u].read();if(P!==null)return Promise.resolve(c(P,!1));T=new Promise(this[l])}return this[o]=T,T}},e(r,Symbol.asyncIterator,function(){return this}),e(r,"return",function(){var _=this;return new Promise(function(b,w){_[u].destroy(null,function(T){if(T){w(T);return}b(c(void 0,!0))})})}),r),y),x=function(_){var b,w=Object.create(v,(b={},e(b,u,{value:_,writable:!0}),e(b,n,{value:null,writable:!0}),e(b,i,{value:null,writable:!0}),e(b,s,{value:null,writable:!0}),e(b,a,{value:_._readableState.endEmitted,writable:!0}),e(b,l,{value:function(P,M){var U=w[u].read();U?(w[o]=null,w[n]=null,w[i]=null,P(c(U,!1))):(w[n]=P,w[i]=M)},writable:!0}),b));return w[o]=null,t(_,function(T){if(T&&T.code!=="ERR_STREAM_PREMATURE_CLOSE"){var P=w[i];P!==null&&(w[o]=null,w[n]=null,w[i]=null,P(T)),w[s]=T;return}var M=w[n];M!==null&&(w[o]=null,w[n]=null,w[i]=null,M(c(void 0,!0))),w[a]=!0}),_.on("readable",d.bind(null,w)),w};return H_=x,H_}var z_,lL;function jX(){return lL||(lL=1,z_=function(){throw new Error("Readable.from is not available in the browser")}),z_}var j_,uL;function p3(){if(uL)return j_;uL=1,j_=R;var r;R.ReadableState=U,hT().EventEmitter;var e=function(L,Z){return L.listeners(Z).length},t=e3(),n=bd().Buffer,i=Qr.Uint8Array||function(){};function s(I){return n.from(I)}function a(I){return n.isBuffer(I)||I instanceof i}var o=c3(),l;o&&o.debuglog?l=o.debuglog("stream"):l=function(){};var u=BX(),c=f3(),f=h3(),d=f.getHighWaterMark,h=po().codes,y=h.ERR_INVALID_ARG_TYPE,v=h.ERR_STREAM_PUSH_AFTER_EOF,x=h.ERR_METHOD_NOT_IMPLEMENTED,m=h.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,_,b,w;oi()(R,t);var T=c.errorOrDestroy,P=["error","close","destroy","pause","resume"];function M(I,L,Z){if(typeof I.prependListener=="function")return I.prependListener(L,Z);!I._events||!I._events[L]?I.on(L,Z):Array.isArray(I._events[L])?I._events[L].unshift(Z):I._events[L]=[Z,I._events[L]]}function U(I,L,Z){r=r||fo(),I=I||{},typeof Z!="boolean"&&(Z=L instanceof r),this.objectMode=!!I.objectMode,Z&&(this.objectMode=this.objectMode||!!I.readableObjectMode),this.highWaterMark=d(this,I,"readableHighWaterMark",Z),this.buffer=new u,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=I.emitClose!==!1,this.autoDestroy=!!I.autoDestroy,this.destroyed=!1,this.defaultEncoding=I.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,I.encoding&&(_||(_=wx().StringDecoder),this.decoder=new _(I.encoding),this.encoding=I.encoding)}function R(I){if(r=r||fo(),!(this instanceof R))return new R(I);var L=this instanceof r;this._readableState=new U(I,this,L),this.readable=!0,I&&(typeof I.read=="function"&&(this._read=I.read),typeof I.destroy=="function"&&(this._destroy=I.destroy)),t.call(this)}Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(L){this._readableState&&(this._readableState.destroyed=L)}}),R.prototype.destroy=c.destroy,R.prototype._undestroy=c.undestroy,R.prototype._destroy=function(I,L){L(I)},R.prototype.push=function(I,L){var Z=this._readableState,E;return Z.objectMode?E=!0:typeof I=="string"&&(L=L||Z.defaultEncoding,L!==Z.encoding&&(I=n.from(I,L),L=""),E=!0),J(this,I,L,!1,E)},R.prototype.unshift=function(I){return J(this,I,null,!0,!1)};function J(I,L,Z,E,Y){l("readableAddChunk",L);var N=I._readableState;if(L===null)N.reading=!1,Q(I,N);else{var p;if(Y||(p=C(N,L)),p)T(I,p);else if(N.objectMode||L&&L.length>0)if(typeof L!="string"&&!N.objectMode&&Object.getPrototypeOf(L)!==n.prototype&&(L=s(L)),E)N.endEmitted?T(I,new m):oe(I,N,L,!0);else if(N.ended)T(I,new v);else{if(N.destroyed)return!1;N.reading=!1,N.decoder&&!Z?(L=N.decoder.write(L),N.objectMode||L.length!==0?oe(I,N,L,!1):ee(I,N)):oe(I,N,L,!1)}else E||(N.reading=!1,ee(I,N))}return!N.ended&&(N.length<N.highWaterMark||N.length===0)}function oe(I,L,Z,E){L.flowing&&L.length===0&&!L.sync?(L.awaitDrain=0,I.emit("data",Z)):(L.length+=L.objectMode?1:Z.length,E?L.buffer.unshift(Z):L.buffer.push(Z),L.needReadable&&j(I)),ee(I,L)}function C(I,L){var Z;return!a(L)&&typeof L!="string"&&L!==void 0&&!I.objectMode&&(Z=new y("chunk",["string","Buffer","Uint8Array"],L)),Z}R.prototype.isPaused=function(){return this._readableState.flowing===!1},R.prototype.setEncoding=function(I){_||(_=wx().StringDecoder);var L=new _(I);this._readableState.decoder=L,this._readableState.encoding=this._readableState.decoder.encoding;for(var Z=this._readableState.buffer.head,E="";Z!==null;)E+=L.write(Z.data),Z=Z.next;return this._readableState.buffer.clear(),E!==""&&this._readableState.buffer.push(E),this._readableState.length=E.length,this};var H=1073741824;function k(I){return I>=H?I=H:(I--,I|=I>>>1,I|=I>>>2,I|=I>>>4,I|=I>>>8,I|=I>>>16,I++),I}function V(I,L){return I<=0||L.length===0&&L.ended?0:L.objectMode?1:I!==I?L.flowing&&L.length?L.buffer.head.data.length:L.length:(I>L.highWaterMark&&(L.highWaterMark=k(I)),I<=L.length?I:L.ended?L.length:(L.needReadable=!0,0))}R.prototype.read=function(I){l("read",I),I=parseInt(I,10);var L=this._readableState,Z=I;if(I!==0&&(L.emittedReadable=!1),I===0&&L.needReadable&&((L.highWaterMark!==0?L.length>=L.highWaterMark:L.length>0)||L.ended))return l("read: emitReadable",L.length,L.ended),L.length===0&&L.ended?A(this):j(this),null;if(I=V(I,L),I===0&&L.ended)return L.length===0&&A(this),null;var E=L.needReadable;l("need readable",E),(L.length===0||L.length-I<L.highWaterMark)&&(E=!0,l("length less than watermark",E)),L.ended||L.reading?(E=!1,l("reading or ended",E)):E&&(l("do read"),L.reading=!0,L.sync=!0,L.length===0&&(L.needReadable=!0),this._read(L.highWaterMark),L.sync=!1,L.reading||(I=V(Z,L)));var Y;return I>0?Y=O(I,L):Y=null,Y===null?(L.needReadable=L.length<=L.highWaterMark,I=0):(L.length-=I,L.awaitDrain=0),L.length===0&&(L.ended||(L.needReadable=!0),Z!==I&&L.ended&&A(this)),Y!==null&&this.emit("data",Y),Y};function Q(I,L){if(l("onEofChunk"),!L.ended){if(L.decoder){var Z=L.decoder.end();Z&&Z.length&&(L.buffer.push(Z),L.length+=L.objectMode?1:Z.length)}L.ended=!0,L.sync?j(I):(L.needReadable=!1,L.emittedReadable||(L.emittedReadable=!0,ie(I)))}}function j(I){var L=I._readableState;l("emitReadable",L.needReadable,L.emittedReadable),L.needReadable=!1,L.emittedReadable||(l("emitReadable",L.flowing),L.emittedReadable=!0,Ie.nextTick(ie,I))}function ie(I){var L=I._readableState;l("emitReadable_",L.destroyed,L.length,L.ended),!L.destroyed&&(L.length||L.ended)&&(I.emit("readable"),L.emittedReadable=!1),L.needReadable=!L.flowing&&!L.ended&&L.length<=L.highWaterMark,K(I)}function ee(I,L){L.readingMore||(L.readingMore=!0,Ie.nextTick(le,I,L))}function le(I,L){for(;!L.reading&&!L.ended&&(L.length<L.highWaterMark||L.flowing&&L.length===0);){var Z=L.length;if(l("maybeReadMore read 0"),I.read(0),Z===L.length)break}L.readingMore=!1}R.prototype._read=function(I){T(this,new x("_read()"))},R.prototype.pipe=function(I,L){var Z=this,E=this._readableState;switch(E.pipesCount){case 0:E.pipes=I;break;case 1:E.pipes=[E.pipes,I];break;default:E.pipes.push(I);break}E.pipesCount+=1,l("pipe count=%d opts=%j",E.pipesCount,L);var Y=(!L||L.end!==!1)&&I!==Ie.stdout&&I!==Ie.stderr,N=Y?g:fe;E.endEmitted?Ie.nextTick(N):Z.once("end",N),I.on("unpipe",p);function p(pe,ve){l("onunpipe"),pe===Z&&ve&&ve.hasUnpiped===!1&&(ve.hasUnpiped=!0,q())}function g(){l("onend"),I.end()}var S=G(Z);I.on("drain",S);var F=!1;function q(){l("cleanup"),I.removeListener("close",ae),I.removeListener("finish",se),I.removeListener("drain",S),I.removeListener("error",ne),I.removeListener("unpipe",p),Z.removeListener("end",g),Z.removeListener("end",fe),Z.removeListener("data",z),F=!0,E.awaitDrain&&(!I._writableState||I._writableState.needDrain)&&S()}Z.on("data",z);function z(pe){l("ondata");var ve=I.write(pe);l("dest.write",ve),ve===!1&&((E.pipesCount===1&&E.pipes===I||E.pipesCount>1&&B(E.pipes,I)!==-1)&&!F&&(l("false write response, pause",E.awaitDrain),E.awaitDrain++),Z.pause())}function ne(pe){l("onerror",pe),fe(),I.removeListener("error",ne),e(I,"error")===0&&T(I,pe)}M(I,"error",ne);function ae(){I.removeListener("finish",se),fe()}I.once("close",ae);function se(){l("onfinish"),I.removeListener("close",ae),fe()}I.once("finish",se);function fe(){l("unpipe"),Z.unpipe(I)}return I.emit("pipe",Z),E.flowing||(l("pipe resume"),Z.resume()),I};function G(I){return function(){var Z=I._readableState;l("pipeOnDrain",Z.awaitDrain),Z.awaitDrain&&Z.awaitDrain--,Z.awaitDrain===0&&e(I,"data")&&(Z.flowing=!0,K(I))}}R.prototype.unpipe=function(I){var L=this._readableState,Z={hasUnpiped:!1};if(L.pipesCount===0)return this;if(L.pipesCount===1)return I&&I!==L.pipes?this:(I||(I=L.pipes),L.pipes=null,L.pipesCount=0,L.flowing=!1,I&&I.emit("unpipe",this,Z),this);if(!I){var E=L.pipes,Y=L.pipesCount;L.pipes=null,L.pipesCount=0,L.flowing=!1;for(var N=0;N<Y;N++)E[N].emit("unpipe",this,{hasUnpiped:!1});return this}var p=B(L.pipes,I);return p===-1?this:(L.pipes.splice(p,1),L.pipesCount-=1,L.pipesCount===1&&(L.pipes=L.pipes[0]),I.emit("unpipe",this,Z),this)},R.prototype.on=function(I,L){var Z=t.prototype.on.call(this,I,L),E=this._readableState;return I==="data"?(E.readableListening=this.listenerCount("readable")>0,E.flowing!==!1&&this.resume()):I==="readable"&&!E.endEmitted&&!E.readableListening&&(E.readableListening=E.needReadable=!0,E.flowing=!1,E.emittedReadable=!1,l("on readable",E.length,E.reading),E.length?j(this):E.reading||Ie.nextTick($,this)),Z},R.prototype.addListener=R.prototype.on,R.prototype.removeListener=function(I,L){var Z=t.prototype.removeListener.call(this,I,L);return I==="readable"&&Ie.nextTick(D,this),Z},R.prototype.removeAllListeners=function(I){var L=t.prototype.removeAllListeners.apply(this,arguments);return(I==="readable"||I===void 0)&&Ie.nextTick(D,this),L};function D(I){var L=I._readableState;L.readableListening=I.listenerCount("readable")>0,L.resumeScheduled&&!L.paused?L.flowing=!0:I.listenerCount("data")>0&&I.resume()}function $(I){l("readable nexttick read 0"),I.read(0)}R.prototype.resume=function(){var I=this._readableState;return I.flowing||(l("resume"),I.flowing=!I.readableListening,X(this,I)),I.paused=!1,this};function X(I,L){L.resumeScheduled||(L.resumeScheduled=!0,Ie.nextTick(re,I,L))}function re(I,L){l("resume",L.reading),L.reading||I.read(0),L.resumeScheduled=!1,I.emit("resume"),K(I),L.flowing&&!L.reading&&I.read(0)}R.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function K(I){var L=I._readableState;for(l("flow",L.flowing);L.flowing&&I.read()!==null;);}R.prototype.wrap=function(I){var L=this,Z=this._readableState,E=!1;I.on("end",function(){if(l("wrapped end"),Z.decoder&&!Z.ended){var p=Z.decoder.end();p&&p.length&&L.push(p)}L.push(null)}),I.on("data",function(p){if(l("wrapped data"),Z.decoder&&(p=Z.decoder.write(p)),!(Z.objectMode&&p==null)&&!(!Z.objectMode&&(!p||!p.length))){var g=L.push(p);g||(E=!0,I.pause())}});for(var Y in I)this[Y]===void 0&&typeof I[Y]=="function"&&(this[Y]=(function(g){return function(){return I[g].apply(I,arguments)}})(Y));for(var N=0;N<P.length;N++)I.on(P[N],this.emit.bind(this,P[N]));return this._read=function(p){l("wrapped _read",p),E&&(E=!1,I.resume())},this},typeof Symbol=="function"&&(R.prototype[Symbol.asyncIterator]=function(){return b===void 0&&(b=zX()),b(this)}),Object.defineProperty(R.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(R.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(R.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(L){this._readableState&&(this._readableState.flowing=L)}}),R._fromList=O,Object.defineProperty(R.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function O(I,L){if(L.length===0)return null;var Z;return L.objectMode?Z=L.buffer.shift():!I||I>=L.length?(L.decoder?Z=L.buffer.join(""):L.buffer.length===1?Z=L.buffer.first():Z=L.buffer.concat(L.length),L.buffer.clear()):Z=L.buffer.consume(I,L.decoder),Z}function A(I){var L=I._readableState;l("endReadable",L.endEmitted),L.endEmitted||(L.ended=!0,Ie.nextTick(W,L,I))}function W(I,L){if(l("endReadableNT",I.endEmitted,I.length),!I.endEmitted&&I.length===0&&(I.endEmitted=!0,L.readable=!1,L.emit("end"),I.autoDestroy)){var Z=L._writableState;(!Z||Z.autoDestroy&&Z.finished)&&L.destroy()}}typeof Symbol=="function"&&(R.from=function(I,L){return w===void 0&&(w=jX()),w(R,I,L)});function B(I,L){for(var Z=0,E=I.length;Z<E;Z++)if(I[Z]===L)return Z;return-1}return j_}var W_,cL;function m3(){if(cL)return W_;cL=1,W_=o;var r=po().codes,e=r.ERR_METHOD_NOT_IMPLEMENTED,t=r.ERR_MULTIPLE_CALLBACK,n=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,i=r.ERR_TRANSFORM_WITH_LENGTH_0,s=fo();oi()(o,s);function a(c,f){var d=this._transformState;d.transforming=!1;var h=d.writecb;if(h===null)return this.emit("error",new t);d.writechunk=null,d.writecb=null,f!=null&&this.push(f),h(c);var y=this._readableState;y.reading=!1,(y.needReadable||y.length<y.highWaterMark)&&this._read(y.highWaterMark)}function o(c){if(!(this instanceof o))return new o(c);s.call(this,c),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.on("prefinish",l)}function l(){var c=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(f,d){u(c,f,d)}):u(this,null,null)}o.prototype.push=function(c,f){return this._transformState.needTransform=!1,s.prototype.push.call(this,c,f)},o.prototype._transform=function(c,f,d){d(new e("_transform()"))},o.prototype._write=function(c,f,d){var h=this._transformState;if(h.writecb=d,h.writechunk=c,h.writeencoding=f,!h.transforming){var y=this._readableState;(h.needTransform||y.needReadable||y.length<y.highWaterMark)&&this._read(y.highWaterMark)}},o.prototype._read=function(c){var f=this._transformState;f.writechunk!==null&&!f.transforming?(f.transforming=!0,this._transform(f.writechunk,f.writeencoding,f.afterTransform)):f.needTransform=!0},o.prototype._destroy=function(c,f){s.prototype._destroy.call(this,c,function(d){f(d)})};function u(c,f,d){if(f)return c.emit("error",f);if(d!=null&&c.push(d),c._writableState.length)throw new i;if(c._transformState.transforming)throw new n;return c.push(null)}return W_}var q_,fL;function WX(){if(fL)return q_;fL=1,q_=e;var r=m3();oi()(e,r);function e(t){if(!(this instanceof e))return new e(t);r.call(this,t)}return e.prototype._transform=function(t,n,i){i(null,t)},q_}var V_,hL;function qX(){if(hL)return V_;hL=1;var r;function e(d){var h=!1;return function(){h||(h=!0,d.apply(void 0,arguments))}}var t=po().codes,n=t.ERR_MISSING_ARGS,i=t.ERR_STREAM_DESTROYED;function s(d){if(d)throw d}function a(d){return d.setHeader&&typeof d.abort=="function"}function o(d,h,y,v){v=e(v);var x=!1;d.on("close",function(){x=!0}),r===void 0&&(r=gT()),r(d,{readable:h,writable:y},function(_){if(_)return v(_);x=!0,v()});var m=!1;return function(_){if(!x&&!m){if(m=!0,a(d))return d.abort();if(typeof d.destroy=="function")return d.destroy();v(_||new i("pipe"))}}}function l(d){d()}function u(d,h){return d.pipe(h)}function c(d){return!d.length||typeof d[d.length-1]!="function"?s:d.pop()}function f(){for(var d=arguments.length,h=new Array(d),y=0;y<d;y++)h[y]=arguments[y];var v=c(h);if(Array.isArray(h[0])&&(h=h[0]),h.length<2)throw new n("streams");var x,m=h.map(function(_,b){var w=b<h.length-1,T=b>0;return o(_,w,T,function(P){x||(x=P),P&&m.forEach(l),!w&&(m.forEach(l),v(x))})});return h.reduce(u)}return V_=f,V_}var K_,dL;function vT(){if(dL)return K_;dL=1,K_=t;var r=hT().EventEmitter,e=oi();e(t,r),t.Readable=p3(),t.Writable=d3(),t.Duplex=fo(),t.Transform=m3(),t.PassThrough=WX(),t.finished=gT(),t.pipeline=qX(),t.Stream=t;function t(){r.call(this)}return t.prototype.pipe=function(n,i){var s=this;function a(h){n.writable&&n.write(h)===!1&&s.pause&&s.pause()}s.on("data",a);function o(){s.readable&&s.resume&&s.resume()}n.on("drain",o),!n._isStdio&&(!i||i.end!==!1)&&(s.on("end",u),s.on("close",c));var l=!1;function u(){l||(l=!0,n.end())}function c(){l||(l=!0,typeof n.destroy=="function"&&n.destroy())}function f(h){if(d(),r.listenerCount(this,"error")===0)throw h}s.on("error",f),n.on("error",f);function d(){s.removeListener("data",a),n.removeListener("drain",o),s.removeListener("end",u),s.removeListener("close",c),s.removeListener("error",f),n.removeListener("error",f),s.removeListener("end",d),s.removeListener("close",d),n.removeListener("close",d)}return s.on("end",d),s.on("close",d),n.on("close",d),n.emit("pipe",s),n},K_}var pL;function VX(){return pL||(pL=1,(function(r){(function(e){e.parser=function(O,A){return new n(O,A)},e.SAXParser=n,e.SAXStream=c,e.createStream=u,e.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function n(O,A){if(!(this instanceof n))return new n(O,A);var W=this;s(W),W.q=W.c="",W.bufferCheckPosition=e.MAX_BUFFER_LENGTH,W.opt=A||{},W.opt.lowercase=W.opt.lowercase||W.opt.lowercasetags,W.looseCase=W.opt.lowercase?"toLowerCase":"toUpperCase",W.tags=[],W.closed=W.closedRoot=W.sawRoot=!1,W.tag=W.error=null,W.strict=!!O,W.noscript=!!(O||W.opt.noscript),W.state=R.BEGIN,W.strictEntities=W.opt.strictEntities,W.ENTITIES=W.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),W.attribList=[],W.opt.xmlns&&(W.ns=Object.create(v)),W.trackPosition=W.opt.position!==!1,W.trackPosition&&(W.position=W.line=W.column=0),oe(W,"onready")}Object.create||(Object.create=function(O){function A(){}A.prototype=O;var W=new A;return W}),Object.keys||(Object.keys=function(O){var A=[];for(var W in O)O.hasOwnProperty(W)&&A.push(W);return A});function i(O){for(var A=Math.max(e.MAX_BUFFER_LENGTH,10),W=0,B=0,I=t.length;B<I;B++){var L=O[t[B]].length;if(L>A)switch(t[B]){case"textNode":H(O);break;case"cdata":C(O,"oncdata",O.cdata),O.cdata="";break;case"script":C(O,"onscript",O.script),O.script="";break;default:V(O,"Max buffer length exceeded: "+t[B])}W=Math.max(W,L)}var Z=e.MAX_BUFFER_LENGTH-W;O.bufferCheckPosition=Z+O.position}function s(O){for(var A=0,W=t.length;A<W;A++)O[t[A]]=""}function a(O){H(O),O.cdata!==""&&(C(O,"oncdata",O.cdata),O.cdata=""),O.script!==""&&(C(O,"onscript",O.script),O.script="")}n.prototype={end:function(){Q(this)},write:K,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){a(this)}};var o;try{o=vT().Stream}catch{o=function(){}}var l=e.EVENTS.filter(function(O){return O!=="error"&&O!=="end"});function u(O,A){return new c(O,A)}function c(O,A){if(!(this instanceof c))return new c(O,A);o.apply(this),this._parser=new n(O,A),this.writable=!0,this.readable=!0;var W=this;this._parser.onend=function(){W.emit("end")},this._parser.onerror=function(B){W.emit("error",B),W._parser.error=null},this._decoder=null,l.forEach(function(B){Object.defineProperty(W,"on"+B,{get:function(){return W._parser["on"+B]},set:function(I){if(!I)return W.removeAllListeners(B),W._parser["on"+B]=I,I;W.on(B,I)},enumerable:!0,configurable:!1})})}c.prototype=Object.create(o.prototype,{constructor:{value:c}}),c.prototype.write=function(O){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(O)){if(!this._decoder){var A=wx().StringDecoder;this._decoder=new A("utf8")}O=this._decoder.write(O)}return this._parser.write(O.toString()),this.emit("data",O),!0},c.prototype.end=function(O){return O&&O.length&&this.write(O),this._parser.end(),!0},c.prototype.on=function(O,A){var W=this;return!W._parser["on"+O]&&l.indexOf(O)!==-1&&(W._parser["on"+O]=function(){var B=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);B.splice(0,0,O),W.emit.apply(W,B)}),o.prototype.on.call(W,O,A)};var f="[CDATA[",d="DOCTYPE",h="http://www.w3.org/XML/1998/namespace",y="http://www.w3.org/2000/xmlns/",v={xml:h,xmlns:y},x=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,_=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,b=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function w(O){return O===" "||O===`
`||O==="\r"||O==="	"}function T(O){return O==='"'||O==="'"}function P(O){return O===">"||w(O)}function M(O,A){return O.test(A)}function U(O,A){return!M(O,A)}var R=0;e.STATE={BEGIN:R++,BEGIN_WHITESPACE:R++,TEXT:R++,TEXT_ENTITY:R++,OPEN_WAKA:R++,SGML_DECL:R++,SGML_DECL_QUOTED:R++,DOCTYPE:R++,DOCTYPE_QUOTED:R++,DOCTYPE_DTD:R++,DOCTYPE_DTD_QUOTED:R++,COMMENT_STARTING:R++,COMMENT:R++,COMMENT_ENDING:R++,COMMENT_ENDED:R++,CDATA:R++,CDATA_ENDING:R++,CDATA_ENDING_2:R++,PROC_INST:R++,PROC_INST_BODY:R++,PROC_INST_ENDING:R++,OPEN_TAG:R++,OPEN_TAG_SLASH:R++,ATTRIB:R++,ATTRIB_NAME:R++,ATTRIB_NAME_SAW_WHITE:R++,ATTRIB_VALUE:R++,ATTRIB_VALUE_QUOTED:R++,ATTRIB_VALUE_CLOSED:R++,ATTRIB_VALUE_UNQUOTED:R++,ATTRIB_VALUE_ENTITY_Q:R++,ATTRIB_VALUE_ENTITY_U:R++,CLOSE_TAG:R++,CLOSE_TAG_SAW_WHITE:R++,SCRIPT:R++,SCRIPT_ENDING:R++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(O){var A=e.ENTITIES[O],W=typeof A=="number"?String.fromCharCode(A):A;e.ENTITIES[O]=W});for(var J in e.STATE)e.STATE[e.STATE[J]]=J;R=e.STATE;function oe(O,A,W){O[A]&&O[A](W)}function C(O,A,W){O.textNode&&H(O),oe(O,A,W)}function H(O){O.textNode=k(O.opt,O.textNode),O.textNode&&oe(O,"ontext",O.textNode),O.textNode=""}function k(O,A){return O.trim&&(A=A.trim()),O.normalize&&(A=A.replace(/\s+/g," ")),A}function V(O,A){return H(O),O.trackPosition&&(A+=`
Line: `+O.line+`
Column: `+O.column+`
Char: `+O.c),A=new Error(A),O.error=A,oe(O,"onerror",A),O}function Q(O){return O.sawRoot&&!O.closedRoot&&j(O,"Unclosed root tag"),O.state!==R.BEGIN&&O.state!==R.BEGIN_WHITESPACE&&O.state!==R.TEXT&&V(O,"Unexpected end"),H(O),O.c="",O.closed=!0,oe(O,"onend"),n.call(O,O.strict,O.opt),O}function j(O,A){if(typeof O!="object"||!(O instanceof n))throw new Error("bad call to strictFail");O.strict&&V(O,A)}function ie(O){O.strict||(O.tagName=O.tagName[O.looseCase]());var A=O.tags[O.tags.length-1]||O,W=O.tag={name:O.tagName,attributes:{}};O.opt.xmlns&&(W.ns=A.ns),O.attribList.length=0,C(O,"onopentagstart",W)}function ee(O,A){var W=O.indexOf(":"),B=W<0?["",O]:O.split(":"),I=B[0],L=B[1];return A&&O==="xmlns"&&(I="xmlns",L=""),{prefix:I,local:L}}function le(O){if(O.strict||(O.attribName=O.attribName[O.looseCase]()),O.attribList.indexOf(O.attribName)!==-1||O.tag.attributes.hasOwnProperty(O.attribName)){O.attribName=O.attribValue="";return}if(O.opt.xmlns){var A=ee(O.attribName,!0),W=A.prefix,B=A.local;if(W==="xmlns")if(B==="xml"&&O.attribValue!==h)j(O,"xml: prefix must be bound to "+h+`
Actual: `+O.attribValue);else if(B==="xmlns"&&O.attribValue!==y)j(O,"xmlns: prefix must be bound to "+y+`
Actual: `+O.attribValue);else{var I=O.tag,L=O.tags[O.tags.length-1]||O;I.ns===L.ns&&(I.ns=Object.create(L.ns)),I.ns[B]=O.attribValue}O.attribList.push([O.attribName,O.attribValue])}else O.tag.attributes[O.attribName]=O.attribValue,C(O,"onattribute",{name:O.attribName,value:O.attribValue});O.attribName=O.attribValue=""}function G(O,A){if(O.opt.xmlns){var W=O.tag,B=ee(O.tagName);W.prefix=B.prefix,W.local=B.local,W.uri=W.ns[B.prefix]||"",W.prefix&&!W.uri&&(j(O,"Unbound namespace prefix: "+JSON.stringify(O.tagName)),W.uri=B.prefix);var I=O.tags[O.tags.length-1]||O;W.ns&&I.ns!==W.ns&&Object.keys(W.ns).forEach(function(z){C(O,"onopennamespace",{prefix:z,uri:W.ns[z]})});for(var L=0,Z=O.attribList.length;L<Z;L++){var E=O.attribList[L],Y=E[0],N=E[1],p=ee(Y,!0),g=p.prefix,S=p.local,F=g===""?"":W.ns[g]||"",q={name:Y,value:N,prefix:g,local:S,uri:F};g&&g!=="xmlns"&&!F&&(j(O,"Unbound namespace prefix: "+JSON.stringify(g)),q.uri=g),O.tag.attributes[Y]=q,C(O,"onattribute",q)}O.attribList.length=0}O.tag.isSelfClosing=!!A,O.sawRoot=!0,O.tags.push(O.tag),C(O,"onopentag",O.tag),A||(!O.noscript&&O.tagName.toLowerCase()==="script"?O.state=R.SCRIPT:O.state=R.TEXT,O.tag=null,O.tagName=""),O.attribName=O.attribValue="",O.attribList.length=0}function D(O){if(!O.tagName){j(O,"Weird empty close tag."),O.textNode+="</>",O.state=R.TEXT;return}if(O.script){if(O.tagName!=="script"){O.script+="</"+O.tagName+">",O.tagName="",O.state=R.SCRIPT;return}C(O,"onscript",O.script),O.script=""}var A=O.tags.length,W=O.tagName;O.strict||(W=W[O.looseCase]());for(var B=W;A--;){var I=O.tags[A];if(I.name!==B)j(O,"Unexpected close tag");else break}if(A<0){j(O,"Unmatched closing tag: "+O.tagName),O.textNode+="</"+O.tagName+">",O.state=R.TEXT;return}O.tagName=W;for(var L=O.tags.length;L-- >A;){var Z=O.tag=O.tags.pop();O.tagName=O.tag.name,C(O,"onclosetag",O.tagName);var E={};for(var Y in Z.ns)E[Y]=Z.ns[Y];var N=O.tags[O.tags.length-1]||O;O.opt.xmlns&&Z.ns!==N.ns&&Object.keys(Z.ns).forEach(function(p){var g=Z.ns[p];C(O,"onclosenamespace",{prefix:p,uri:g})})}A===0&&(O.closedRoot=!0),O.tagName=O.attribValue=O.attribName="",O.attribList.length=0,O.state=R.TEXT}function $(O){var A=O.entity,W=A.toLowerCase(),B,I="";return O.ENTITIES[A]?O.ENTITIES[A]:O.ENTITIES[W]?O.ENTITIES[W]:(A=W,A.charAt(0)==="#"&&(A.charAt(1)==="x"?(A=A.slice(2),B=parseInt(A,16),I=B.toString(16)):(A=A.slice(1),B=parseInt(A,10),I=B.toString(10))),A=A.replace(/^0+/,""),isNaN(B)||I.toLowerCase()!==A?(j(O,"Invalid character entity"),"&"+O.entity+";"):String.fromCodePoint(B))}function X(O,A){A==="<"?(O.state=R.OPEN_WAKA,O.startTagPosition=O.position):w(A)||(j(O,"Non-whitespace before first tag."),O.textNode=A,O.state=R.TEXT)}function re(O,A){var W="";return A<O.length&&(W=O.charAt(A)),W}function K(O){var A=this;if(this.error)throw this.error;if(A.closed)return V(A,"Cannot write after close. Assign an onready handler.");if(O===null)return Q(A);typeof O=="object"&&(O=O.toString());for(var W=0,B="";B=re(O,W++),A.c=B,!!B;)switch(A.trackPosition&&(A.position++,B===`
`?(A.line++,A.column=0):A.column++),A.state){case R.BEGIN:if(A.state=R.BEGIN_WHITESPACE,B==="\uFEFF")continue;X(A,B);continue;case R.BEGIN_WHITESPACE:X(A,B);continue;case R.TEXT:if(A.sawRoot&&!A.closedRoot){for(var I=W-1;B&&B!=="<"&&B!=="&";)B=re(O,W++),B&&A.trackPosition&&(A.position++,B===`
`?(A.line++,A.column=0):A.column++);A.textNode+=O.substring(I,W-1)}B==="<"&&!(A.sawRoot&&A.closedRoot&&!A.strict)?(A.state=R.OPEN_WAKA,A.startTagPosition=A.position):(!w(B)&&(!A.sawRoot||A.closedRoot)&&j(A,"Text data outside of root node."),B==="&"?A.state=R.TEXT_ENTITY:A.textNode+=B);continue;case R.SCRIPT:B==="<"?A.state=R.SCRIPT_ENDING:A.script+=B;continue;case R.SCRIPT_ENDING:B==="/"?A.state=R.CLOSE_TAG:(A.script+="<"+B,A.state=R.SCRIPT);continue;case R.OPEN_WAKA:if(B==="!")A.state=R.SGML_DECL,A.sgmlDecl="";else if(!w(B))if(M(x,B))A.state=R.OPEN_TAG,A.tagName=B;else if(B==="/")A.state=R.CLOSE_TAG,A.tagName="";else if(B==="?")A.state=R.PROC_INST,A.procInstName=A.procInstBody="";else{if(j(A,"Unencoded <"),A.startTagPosition+1<A.position){var L=A.position-A.startTagPosition;B=new Array(L).join(" ")+B}A.textNode+="<"+B,A.state=R.TEXT}continue;case R.SGML_DECL:(A.sgmlDecl+B).toUpperCase()===f?(C(A,"onopencdata"),A.state=R.CDATA,A.sgmlDecl="",A.cdata=""):A.sgmlDecl+B==="--"?(A.state=R.COMMENT,A.comment="",A.sgmlDecl=""):(A.sgmlDecl+B).toUpperCase()===d?(A.state=R.DOCTYPE,(A.doctype||A.sawRoot)&&j(A,"Inappropriately located doctype declaration"),A.doctype="",A.sgmlDecl=""):B===">"?(C(A,"onsgmldeclaration",A.sgmlDecl),A.sgmlDecl="",A.state=R.TEXT):(T(B)&&(A.state=R.SGML_DECL_QUOTED),A.sgmlDecl+=B);continue;case R.SGML_DECL_QUOTED:B===A.q&&(A.state=R.SGML_DECL,A.q=""),A.sgmlDecl+=B;continue;case R.DOCTYPE:B===">"?(A.state=R.TEXT,C(A,"ondoctype",A.doctype),A.doctype=!0):(A.doctype+=B,B==="["?A.state=R.DOCTYPE_DTD:T(B)&&(A.state=R.DOCTYPE_QUOTED,A.q=B));continue;case R.DOCTYPE_QUOTED:A.doctype+=B,B===A.q&&(A.q="",A.state=R.DOCTYPE);continue;case R.DOCTYPE_DTD:A.doctype+=B,B==="]"?A.state=R.DOCTYPE:T(B)&&(A.state=R.DOCTYPE_DTD_QUOTED,A.q=B);continue;case R.DOCTYPE_DTD_QUOTED:A.doctype+=B,B===A.q&&(A.state=R.DOCTYPE_DTD,A.q="");continue;case R.COMMENT:B==="-"?A.state=R.COMMENT_ENDING:A.comment+=B;continue;case R.COMMENT_ENDING:B==="-"?(A.state=R.COMMENT_ENDED,A.comment=k(A.opt,A.comment),A.comment&&C(A,"oncomment",A.comment),A.comment=""):(A.comment+="-"+B,A.state=R.COMMENT);continue;case R.COMMENT_ENDED:B!==">"?(j(A,"Malformed comment"),A.comment+="--"+B,A.state=R.COMMENT):A.state=R.TEXT;continue;case R.CDATA:B==="]"?A.state=R.CDATA_ENDING:A.cdata+=B;continue;case R.CDATA_ENDING:B==="]"?A.state=R.CDATA_ENDING_2:(A.cdata+="]"+B,A.state=R.CDATA);continue;case R.CDATA_ENDING_2:B===">"?(A.cdata&&C(A,"oncdata",A.cdata),C(A,"onclosecdata"),A.cdata="",A.state=R.TEXT):B==="]"?A.cdata+="]":(A.cdata+="]]"+B,A.state=R.CDATA);continue;case R.PROC_INST:B==="?"?A.state=R.PROC_INST_ENDING:w(B)?A.state=R.PROC_INST_BODY:A.procInstName+=B;continue;case R.PROC_INST_BODY:if(!A.procInstBody&&w(B))continue;B==="?"?A.state=R.PROC_INST_ENDING:A.procInstBody+=B;continue;case R.PROC_INST_ENDING:B===">"?(C(A,"onprocessinginstruction",{name:A.procInstName,body:A.procInstBody}),A.procInstName=A.procInstBody="",A.state=R.TEXT):(A.procInstBody+="?"+B,A.state=R.PROC_INST_BODY);continue;case R.OPEN_TAG:M(m,B)?A.tagName+=B:(ie(A),B===">"?G(A):B==="/"?A.state=R.OPEN_TAG_SLASH:(w(B)||j(A,"Invalid character in tag name"),A.state=R.ATTRIB));continue;case R.OPEN_TAG_SLASH:B===">"?(G(A,!0),D(A)):(j(A,"Forward-slash in opening tag not followed by >"),A.state=R.ATTRIB);continue;case R.ATTRIB:if(w(B))continue;B===">"?G(A):B==="/"?A.state=R.OPEN_TAG_SLASH:M(x,B)?(A.attribName=B,A.attribValue="",A.state=R.ATTRIB_NAME):j(A,"Invalid attribute name");continue;case R.ATTRIB_NAME:B==="="?A.state=R.ATTRIB_VALUE:B===">"?(j(A,"Attribute without value"),A.attribValue=A.attribName,le(A),G(A)):w(B)?A.state=R.ATTRIB_NAME_SAW_WHITE:M(m,B)?A.attribName+=B:j(A,"Invalid attribute name");continue;case R.ATTRIB_NAME_SAW_WHITE:if(B==="=")A.state=R.ATTRIB_VALUE;else{if(w(B))continue;j(A,"Attribute without value"),A.tag.attributes[A.attribName]="",A.attribValue="",C(A,"onattribute",{name:A.attribName,value:""}),A.attribName="",B===">"?G(A):M(x,B)?(A.attribName=B,A.state=R.ATTRIB_NAME):(j(A,"Invalid attribute name"),A.state=R.ATTRIB)}continue;case R.ATTRIB_VALUE:if(w(B))continue;T(B)?(A.q=B,A.state=R.ATTRIB_VALUE_QUOTED):(j(A,"Unquoted attribute value"),A.state=R.ATTRIB_VALUE_UNQUOTED,A.attribValue=B);continue;case R.ATTRIB_VALUE_QUOTED:if(B!==A.q){B==="&"?A.state=R.ATTRIB_VALUE_ENTITY_Q:A.attribValue+=B;continue}le(A),A.q="",A.state=R.ATTRIB_VALUE_CLOSED;continue;case R.ATTRIB_VALUE_CLOSED:w(B)?A.state=R.ATTRIB:B===">"?G(A):B==="/"?A.state=R.OPEN_TAG_SLASH:M(x,B)?(j(A,"No whitespace between attributes"),A.attribName=B,A.attribValue="",A.state=R.ATTRIB_NAME):j(A,"Invalid attribute name");continue;case R.ATTRIB_VALUE_UNQUOTED:if(!P(B)){B==="&"?A.state=R.ATTRIB_VALUE_ENTITY_U:A.attribValue+=B;continue}le(A),B===">"?G(A):A.state=R.ATTRIB;continue;case R.CLOSE_TAG:if(A.tagName)B===">"?D(A):M(m,B)?A.tagName+=B:A.script?(A.script+="</"+A.tagName,A.tagName="",A.state=R.SCRIPT):(w(B)||j(A,"Invalid tagname in closing tag"),A.state=R.CLOSE_TAG_SAW_WHITE);else{if(w(B))continue;U(x,B)?A.script?(A.script+="</"+B,A.state=R.SCRIPT):j(A,"Invalid tagname in closing tag."):A.tagName=B}continue;case R.CLOSE_TAG_SAW_WHITE:if(w(B))continue;B===">"?D(A):j(A,"Invalid characters in closing tag");continue;case R.TEXT_ENTITY:case R.ATTRIB_VALUE_ENTITY_Q:case R.ATTRIB_VALUE_ENTITY_U:var Z,E;switch(A.state){case R.TEXT_ENTITY:Z=R.TEXT,E="textNode";break;case R.ATTRIB_VALUE_ENTITY_Q:Z=R.ATTRIB_VALUE_QUOTED,E="attribValue";break;case R.ATTRIB_VALUE_ENTITY_U:Z=R.ATTRIB_VALUE_UNQUOTED,E="attribValue";break}B===";"?(A[E]+=$(A),A.entity="",A.state=Z):M(A.entity.length?b:_,B)?A.entity+=B:(j(A,"Invalid character in entity name"),A[E]+="&"+A.entity+B,A.entity="",A.state=Z);continue;default:throw new Error(A,"Unknown state: "+A.state)}return A.position>=A.bufferCheckPosition&&i(A),A}String.fromCodePoint||(function(){var O=String.fromCharCode,A=Math.floor,W=function(){var B=16384,I=[],L,Z,E=-1,Y=arguments.length;if(!Y)return"";for(var N="";++E<Y;){var p=Number(arguments[E]);if(!isFinite(p)||p<0||p>1114111||A(p)!==p)throw RangeError("Invalid code point: "+p);p<=65535?I.push(p):(p-=65536,L=(p>>10)+55296,Z=p%1024+56320,I.push(L,Z)),(E+1===Y||I.length>B)&&(N+=O.apply(null,I),I.length=0)}return N};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:W,configurable:!0,writable:!0}):String.fromCodePoint=W})()})(r)})(C1)),C1}var G_,mL;function yT(){return mL||(mL=1,G_={isArray:function(r){return Array.isArray?Array.isArray(r):Object.prototype.toString.call(r)==="[object Array]"}}),G_}var $_,gL;function wT(){if(gL)return $_;gL=1;var r=yT().isArray;return $_={copyOptions:function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n},ensureFlagExists:function(e,t){(!(e in t)||typeof t[e]!="boolean")&&(t[e]=!1)},ensureSpacesExists:function(e){(!("spaces"in e)||typeof e.spaces!="number"&&typeof e.spaces!="string")&&(e.spaces=0)},ensureAlwaysArrayExists:function(e){(!("alwaysArray"in e)||typeof e.alwaysArray!="boolean"&&!r(e.alwaysArray))&&(e.alwaysArray=!1)},ensureKeyExists:function(e,t){(!(e+"Key"in t)||typeof t[e+"Key"]!="string")&&(t[e+"Key"]=t.compact?"_"+e:e)},checkFnExists:function(e,t){return e+"Fn"in t}},$_}var J_,vL;function g3(){if(vL)return J_;vL=1;var r=VX(),e=wT(),t=yT().isArray,n,i;function s(m){return n=e.copyOptions(m),e.ensureFlagExists("ignoreDeclaration",n),e.ensureFlagExists("ignoreInstruction",n),e.ensureFlagExists("ignoreAttributes",n),e.ensureFlagExists("ignoreText",n),e.ensureFlagExists("ignoreComment",n),e.ensureFlagExists("ignoreCdata",n),e.ensureFlagExists("ignoreDoctype",n),e.ensureFlagExists("compact",n),e.ensureFlagExists("alwaysChildren",n),e.ensureFlagExists("addParent",n),e.ensureFlagExists("trim",n),e.ensureFlagExists("nativeType",n),e.ensureFlagExists("nativeTypeAttributes",n),e.ensureFlagExists("sanitize",n),e.ensureFlagExists("instructionHasAttributes",n),e.ensureFlagExists("captureSpacesBetweenElements",n),e.ensureAlwaysArrayExists(n),e.ensureKeyExists("declaration",n),e.ensureKeyExists("instruction",n),e.ensureKeyExists("attributes",n),e.ensureKeyExists("text",n),e.ensureKeyExists("comment",n),e.ensureKeyExists("cdata",n),e.ensureKeyExists("doctype",n),e.ensureKeyExists("type",n),e.ensureKeyExists("name",n),e.ensureKeyExists("elements",n),e.ensureKeyExists("parent",n),e.checkFnExists("doctype",n),e.checkFnExists("instruction",n),e.checkFnExists("cdata",n),e.checkFnExists("comment",n),e.checkFnExists("text",n),e.checkFnExists("instructionName",n),e.checkFnExists("elementName",n),e.checkFnExists("attributeName",n),e.checkFnExists("attributeValue",n),e.checkFnExists("attributes",n),n}function a(m){var _=Number(m);if(!isNaN(_))return _;var b=m.toLowerCase();return b==="true"?!0:b==="false"?!1:m}function o(m,_){var b;if(n.compact){if(!i[n[m+"Key"]]&&(t(n.alwaysArray)?n.alwaysArray.indexOf(n[m+"Key"])!==-1:n.alwaysArray)&&(i[n[m+"Key"]]=[]),i[n[m+"Key"]]&&!t(i[n[m+"Key"]])&&(i[n[m+"Key"]]=[i[n[m+"Key"]]]),m+"Fn"in n&&typeof _=="string"&&(_=n[m+"Fn"](_,i)),m==="instruction"&&("instructionFn"in n||"instructionNameFn"in n)){for(b in _)if(_.hasOwnProperty(b))if("instructionFn"in n)_[b]=n.instructionFn(_[b],b,i);else{var w=_[b];delete _[b],_[n.instructionNameFn(b,w,i)]=w}}t(i[n[m+"Key"]])?i[n[m+"Key"]].push(_):i[n[m+"Key"]]=_}else{i[n.elementsKey]||(i[n.elementsKey]=[]);var T={};if(T[n.typeKey]=m,m==="instruction"){for(b in _)if(_.hasOwnProperty(b))break;T[n.nameKey]="instructionNameFn"in n?n.instructionNameFn(b,_,i):b,n.instructionHasAttributes?(T[n.attributesKey]=_[b][n.attributesKey],"instructionFn"in n&&(T[n.attributesKey]=n.instructionFn(T[n.attributesKey],b,i))):("instructionFn"in n&&(_[b]=n.instructionFn(_[b],b,i)),T[n.instructionKey]=_[b])}else m+"Fn"in n&&(_=n[m+"Fn"](_,i)),T[n[m+"Key"]]=_;n.addParent&&(T[n.parentKey]=i),i[n.elementsKey].push(T)}}function l(m){if("attributesFn"in n&&m&&(m=n.attributesFn(m,i)),(n.trim||"attributeValueFn"in n||"attributeNameFn"in n||n.nativeTypeAttributes)&&m){var _;for(_ in m)if(m.hasOwnProperty(_)&&(n.trim&&(m[_]=m[_].trim()),n.nativeTypeAttributes&&(m[_]=a(m[_])),"attributeValueFn"in n&&(m[_]=n.attributeValueFn(m[_],_,i)),"attributeNameFn"in n)){var b=m[_];delete m[_],m[n.attributeNameFn(_,m[_],i)]=b}}return m}function u(m){var _={};if(m.body&&(m.name.toLowerCase()==="xml"||n.instructionHasAttributes)){for(var b=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,w;(w=b.exec(m.body))!==null;)_[w[1]]=w[2]||w[3]||w[4];_=l(_)}if(m.name.toLowerCase()==="xml"){if(n.ignoreDeclaration)return;i[n.declarationKey]={},Object.keys(_).length&&(i[n.declarationKey][n.attributesKey]=_),n.addParent&&(i[n.declarationKey][n.parentKey]=i)}else{if(n.ignoreInstruction)return;n.trim&&(m.body=m.body.trim());var T={};n.instructionHasAttributes&&Object.keys(_).length?(T[m.name]={},T[m.name][n.attributesKey]=_):T[m.name]=m.body,o("instruction",T)}}function c(m,_){var b;if(typeof m=="object"&&(_=m.attributes,m=m.name),_=l(_),"elementNameFn"in n&&(m=n.elementNameFn(m,i)),n.compact){if(b={},!n.ignoreAttributes&&_&&Object.keys(_).length){b[n.attributesKey]={};var w;for(w in _)_.hasOwnProperty(w)&&(b[n.attributesKey][w]=_[w])}!(m in i)&&(t(n.alwaysArray)?n.alwaysArray.indexOf(m)!==-1:n.alwaysArray)&&(i[m]=[]),i[m]&&!t(i[m])&&(i[m]=[i[m]]),t(i[m])?i[m].push(b):i[m]=b}else i[n.elementsKey]||(i[n.elementsKey]=[]),b={},b[n.typeKey]="element",b[n.nameKey]=m,!n.ignoreAttributes&&_&&Object.keys(_).length&&(b[n.attributesKey]=_),n.alwaysChildren&&(b[n.elementsKey]=[]),i[n.elementsKey].push(b);b[n.parentKey]=i,i=b}function f(m){n.ignoreText||!m.trim()&&!n.captureSpacesBetweenElements||(n.trim&&(m=m.trim()),n.nativeType&&(m=a(m)),n.sanitize&&(m=m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),o("text",m))}function d(m){n.ignoreComment||(n.trim&&(m=m.trim()),o("comment",m))}function h(m){var _=i[n.parentKey];n.addParent||delete i[n.parentKey],i=_}function y(m){n.ignoreCdata||(n.trim&&(m=m.trim()),o("cdata",m))}function v(m){n.ignoreDoctype||(m=m.replace(/^ /,""),n.trim&&(m=m.trim()),o("doctype",m))}function x(m){m.note=m}return J_=function(m,_){var b=r.parser(!0,{}),w={};if(i=w,n=s(_),b.opt={strictEntities:!0},b.onopentag=c,b.ontext=f,b.oncomment=d,b.onclosetag=h,b.onerror=x,b.oncdata=y,b.ondoctype=v,b.onprocessinginstruction=u,b.write(m).close(),w[n.elementsKey]){var T=w[n.elementsKey];delete w[n.elementsKey],w[n.elementsKey]=T,delete w.text}return w},J_}var X_,yL;function KX(){if(yL)return X_;yL=1;var r=wT(),e=g3();function t(n){var i=r.copyOptions(n);return r.ensureSpacesExists(i),i}return X_=function(n,i){var s,a,o,l;return s=t(i),a=e(n,s),l="compact"in s&&s.compact?"_parent":"parent","addParent"in s&&s.addParent?o=JSON.stringify(a,function(u,c){return u===l?"_":c},s.spaces):o=JSON.stringify(a,null,s.spaces),o.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},X_}var Y_,wL;function v3(){if(wL)return Y_;wL=1;var r=wT(),e=yT().isArray,t,n;function i(b){var w=r.copyOptions(b);return r.ensureFlagExists("ignoreDeclaration",w),r.ensureFlagExists("ignoreInstruction",w),r.ensureFlagExists("ignoreAttributes",w),r.ensureFlagExists("ignoreText",w),r.ensureFlagExists("ignoreComment",w),r.ensureFlagExists("ignoreCdata",w),r.ensureFlagExists("ignoreDoctype",w),r.ensureFlagExists("compact",w),r.ensureFlagExists("indentText",w),r.ensureFlagExists("indentCdata",w),r.ensureFlagExists("indentAttributes",w),r.ensureFlagExists("indentInstruction",w),r.ensureFlagExists("fullTagEmptyElement",w),r.ensureFlagExists("noQuotesForNativeAttributes",w),r.ensureSpacesExists(w),typeof w.spaces=="number"&&(w.spaces=Array(w.spaces+1).join(" ")),r.ensureKeyExists("declaration",w),r.ensureKeyExists("instruction",w),r.ensureKeyExists("attributes",w),r.ensureKeyExists("text",w),r.ensureKeyExists("comment",w),r.ensureKeyExists("cdata",w),r.ensureKeyExists("doctype",w),r.ensureKeyExists("type",w),r.ensureKeyExists("name",w),r.ensureKeyExists("elements",w),r.checkFnExists("doctype",w),r.checkFnExists("instruction",w),r.checkFnExists("cdata",w),r.checkFnExists("comment",w),r.checkFnExists("text",w),r.checkFnExists("instructionName",w),r.checkFnExists("elementName",w),r.checkFnExists("attributeName",w),r.checkFnExists("attributeValue",w),r.checkFnExists("attributes",w),r.checkFnExists("fullTagEmptyElement",w),w}function s(b,w,T){return(!T&&b.spaces?`
`:"")+Array(w+1).join(b.spaces)}function a(b,w,T){if(w.ignoreAttributes)return"";"attributesFn"in w&&(b=w.attributesFn(b,n,t));var P,M,U,R,J=[];for(P in b)b.hasOwnProperty(P)&&b[P]!==null&&b[P]!==void 0&&(R=w.noQuotesForNativeAttributes&&typeof b[P]!="string"?"":'"',M=""+b[P],M=M.replace(/"/g,"&quot;"),U="attributeNameFn"in w?w.attributeNameFn(P,M,n,t):P,J.push(w.spaces&&w.indentAttributes?s(w,T+1,!1):" "),J.push(U+"="+R+("attributeValueFn"in w?w.attributeValueFn(M,P,n,t):M)+R));return b&&Object.keys(b).length&&w.spaces&&w.indentAttributes&&J.push(s(w,T,!1)),J.join("")}function o(b,w,T){return t=b,n="xml",w.ignoreDeclaration?"":"<?xml"+a(b[w.attributesKey],w,T)+"?>"}function l(b,w,T){if(w.ignoreInstruction)return"";var P;for(P in b)if(b.hasOwnProperty(P))break;var M="instructionNameFn"in w?w.instructionNameFn(P,b[P],n,t):P;if(typeof b[P]=="object")return t=b,n=M,"<?"+M+a(b[P][w.attributesKey],w,T)+"?>";var U=b[P]?b[P]:"";return"instructionFn"in w&&(U=w.instructionFn(U,P,n,t)),"<?"+M+(U?" "+U:"")+"?>"}function u(b,w){return w.ignoreComment?"":"<!--"+("commentFn"in w?w.commentFn(b,n,t):b)+"-->"}function c(b,w){return w.ignoreCdata?"":"<![CDATA["+("cdataFn"in w?w.cdataFn(b,n,t):b.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function f(b,w){return w.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in w?w.doctypeFn(b,n,t):b)+">"}function d(b,w){return w.ignoreText?"":(b=""+b,b=b.replace(/&amp;/g,"&"),b=b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in w?w.textFn(b,n,t):b)}function h(b,w){var T;if(b.elements&&b.elements.length)for(T=0;T<b.elements.length;++T)switch(b.elements[T][w.typeKey]){case"text":if(w.indentText)return!0;break;case"cdata":if(w.indentCdata)return!0;break;case"instruction":if(w.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function y(b,w,T){t=b,n=b.name;var P=[],M="elementNameFn"in w?w.elementNameFn(b.name,b):b.name;P.push("<"+M),b[w.attributesKey]&&P.push(a(b[w.attributesKey],w,T));var U=b[w.elementsKey]&&b[w.elementsKey].length||b[w.attributesKey]&&b[w.attributesKey]["xml:space"]==="preserve";return U||("fullTagEmptyElementFn"in w?U=w.fullTagEmptyElementFn(b.name,b):U=w.fullTagEmptyElement),U?(P.push(">"),b[w.elementsKey]&&b[w.elementsKey].length&&(P.push(v(b[w.elementsKey],w,T+1)),t=b,n=b.name),P.push(w.spaces&&h(b,w)?`
`+Array(T+1).join(w.spaces):""),P.push("</"+M+">")):P.push("/>"),P.join("")}function v(b,w,T,P){return b.reduce(function(M,U){var R=s(w,T,P&&!M);switch(U.type){case"element":return M+R+y(U,w,T);case"comment":return M+R+u(U[w.commentKey],w);case"doctype":return M+R+f(U[w.doctypeKey],w);case"cdata":return M+(w.indentCdata?R:"")+c(U[w.cdataKey],w);case"text":return M+(w.indentText?R:"")+d(U[w.textKey],w);case"instruction":var J={};return J[U[w.nameKey]]=U[w.attributesKey]?U:U[w.instructionKey],M+(w.indentInstruction?R:"")+l(J,w,T)}},"")}function x(b,w,T){var P;for(P in b)if(b.hasOwnProperty(P))switch(P){case w.parentKey:case w.attributesKey:break;case w.textKey:if(w.indentText||T)return!0;break;case w.cdataKey:if(w.indentCdata||T)return!0;break;case w.instructionKey:if(w.indentInstruction||T)return!0;break;case w.doctypeKey:case w.commentKey:return!0;default:return!0}return!1}function m(b,w,T,P,M){t=b,n=w;var U="elementNameFn"in T?T.elementNameFn(w,b):w;if(typeof b>"u"||b===null||b==="")return"fullTagEmptyElementFn"in T&&T.fullTagEmptyElementFn(w,b)||T.fullTagEmptyElement?"<"+U+"></"+U+">":"<"+U+"/>";var R=[];if(w){if(R.push("<"+U),typeof b!="object")return R.push(">"+d(b,T)+"</"+U+">"),R.join("");b[T.attributesKey]&&R.push(a(b[T.attributesKey],T,P));var J=x(b,T,!0)||b[T.attributesKey]&&b[T.attributesKey]["xml:space"]==="preserve";if(J||("fullTagEmptyElementFn"in T?J=T.fullTagEmptyElementFn(w,b):J=T.fullTagEmptyElement),J)R.push(">");else return R.push("/>"),R.join("")}return R.push(_(b,T,P+1,!1)),t=b,n=w,w&&R.push((M?s(T,P,!1):"")+"</"+U+">"),R.join("")}function _(b,w,T,P){var M,U,R,J=[];for(U in b)if(b.hasOwnProperty(U))for(R=e(b[U])?b[U]:[b[U]],M=0;M<R.length;++M){switch(U){case w.declarationKey:J.push(o(R[M],w,T));break;case w.instructionKey:J.push((w.indentInstruction?s(w,T,P):"")+l(R[M],w,T));break;case w.attributesKey:case w.parentKey:break;case w.textKey:J.push((w.indentText?s(w,T,P):"")+d(R[M],w));break;case w.cdataKey:J.push((w.indentCdata?s(w,T,P):"")+c(R[M],w));break;case w.doctypeKey:J.push(s(w,T,P)+f(R[M],w));break;case w.commentKey:J.push(s(w,T,P)+u(R[M],w));break;default:J.push(s(w,T,P)+m(R[M],U,w,T,x(R[M],w)))}P=P&&!J.length}return J.join("")}return Y_=function(b,w){w=i(w);var T=[];return t=b,n="_root_",w.compact?T.push(_(b,w,0,!0)):(b[w.declarationKey]&&T.push(o(b[w.declarationKey],w,0)),b[w.elementsKey]&&b[w.elementsKey].length&&T.push(v(b[w.elementsKey],w,0,!T.length))),T.join("")},Y_}var Z_,bL;function GX(){if(bL)return Z_;bL=1;var r=v3();return Z_=function(e,t){e instanceof Buffer&&(e=e.toString());var n=null;if(typeof e=="string")try{n=JSON.parse(e)}catch{throw new Error("The JSON structure is invalid")}else n=e;return r(n,t)},Z_}var Q_,_L;function $X(){if(_L)return Q_;_L=1;var r=g3(),e=KX(),t=v3(),n=GX();return Q_={xml2js:r,xml2json:e,js2xml:t,json2xml:n},Q_}var xd=$X(),Ed=r=>{switch(r.type){case void 0:case"element":let e=new Uf(r.name,r.attributes),t=r.elements||[];for(let n of t){let i=Ed(n);i!==void 0&&e.push(i)}return e;case"text":return r.text;default:return}},bx=class extends we{},Uf=class extends ue{static fromXmlString(e){let t=xd.xml2js(e,{compact:!1});return Ed(t)}constructor(e,t){super(e),t&&this.root.push(new bx(t))}push(e){this.root.push(e)}},Hf=class extends ue{constructor(e){super(""),this._attr=e}prepForXml(e){return{_attr:this._attr}}},JX="",al=class extends ue{constructor(e,t){super(e),t&&(this.root=t.root)}},vt=r=>{if(isNaN(r))throw new Error(`Invalid value '${r}' specified. Must be an integer.`);return Math.floor(r)},Nl=r=>{let e=vt(r);if(e<0)throw new Error(`Invalid value '${r}' specified. Must be a positive integer.`);return e},Sd=(r,e)=>{let t=e*2;if(r.length!==t||isNaN(+`0x${r}`))throw new Error(`Invalid hex value '${r}'. Expected ${t} digit hex value`);return r},XX=r=>Sd(r,4),y3=r=>Sd(r,2),_x=r=>Sd(r,1),Rl=r=>{let e=r.slice(-2),t=r.substring(0,r.length-2);return`${Number(t)}${e}`},bT=r=>{let e=Rl(r);if(parseFloat(e)<0)throw new Error(`Invalid value '${e}' specified. Expected a positive number.`);return e},Gi=r=>{if(r==="auto")return r;let e=r.charAt(0)==="#"?r.substring(1):r;return Sd(e,3)},en=r=>typeof r=="string"?Rl(r):vt(r),w3=r=>typeof r=="string"?bT(r):Nl(r),YX=r=>typeof r=="string"?Rl(r):vt(r),lt=r=>typeof r=="string"?bT(r):Nl(r),b3=r=>{let e=r.substring(0,r.length-1);return`${Number(e)}%`},_T=r=>typeof r=="number"?vt(r):r.slice(-1)==="%"?b3(r):Rl(r),_3=Nl,x3=Nl,E3=r=>r.toISOString(),me=class extends ue{constructor(e,t=!0){super(e),t!==!0&&this.root.push(new Ve({val:t}))}},so=class extends ue{constructor(e,t){super(e),this.root.push(new Ve({val:w3(t)}))}},ut=class extends ue{},Tr=class extends ue{constructor(e,t){super(e),this.root.push(new Ve({val:t}))}},ro=(r,e)=>new ke({name:r,attributes:{value:{key:"w:val",value:e}}}),ii=class extends ue{constructor(e,t){super(e),this.root.push(new Ve({val:t}))}},zf=class extends ue{constructor(e,t){super(e),this.root.push(new Ve({val:t}))}},Zr=class extends ue{constructor(e,t){super(e),this.root.push(t)}},ke=class extends ue{constructor({name:e,attributes:t,children:n}){super(e),t&&this.root.push(new Xt(t)),n&&this.root.push(...n)}},Er={START:"start",CENTER:"center",END:"end",BOTH:"both",MEDIUM_KASHIDA:"mediumKashida",DISTRIBUTE:"distribute",NUM_TAB:"numTab",HIGH_KASHIDA:"highKashida",LOW_KASHIDA:"lowKashida",THAI_DISTRIBUTE:"thaiDistribute",LEFT:"left",RIGHT:"right",JUSTIFIED:"both"},jf=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{val:"w:val"})}},ll=class extends ue{constructor(e){super("w:jc"),this.root.push(new jf({val:e}))}},Be=class extends ue{constructor(e,{color:t,size:n,space:i,style:s}){super(e),this.root.push(new xx({style:s,color:t===void 0?void 0:Gi(t),size:n===void 0?void 0:_3(n),space:i===void 0?void 0:x3(i)}))}},xx=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}},kd={SINGLE:"single",DASH_DOT_STROKED:"dashDotStroked",DASHED:"dashed",DASH_SMALL_GAP:"dashSmallGap",DOT_DASH:"dotDash",DOT_DOT_DASH:"dotDotDash",DOTTED:"dotted",DOUBLE:"double",DOUBLE_WAVE:"doubleWave",INSET:"inset",NIL:"nil",NONE:"none",OUTSET:"outset",THICK:"thick",THICK_THIN_LARGE_GAP:"thickThinLargeGap",THICK_THIN_MEDIUM_GAP:"thickThinMediumGap",THICK_THIN_SMALL_GAP:"thickThinSmallGap",THIN_THICK_LARGE_GAP:"thinThickLargeGap",THIN_THICK_MEDIUM_GAP:"thinThickMediumGap",THIN_THICK_SMALL_GAP:"thinThickSmallGap",THIN_THICK_THIN_LARGE_GAP:"thinThickThinLargeGap",THIN_THICK_THIN_MEDIUM_GAP:"thinThickThinMediumGap",THIN_THICK_THIN_SMALL_GAP:"thinThickThinSmallGap",THREE_D_EMBOSS:"threeDEmboss",THREE_D_ENGRAVE:"threeDEngrave",TRIPLE:"triple",WAVE:"wave"},Wf=class extends cr{constructor(e){super("w:pBdr"),e.top&&this.root.push(new Be("w:top",e.top)),e.bottom&&this.root.push(new Be("w:bottom",e.bottom)),e.left&&this.root.push(new Be("w:left",e.left)),e.right&&this.root.push(new Be("w:right",e.right))}},qf=class extends ue{constructor(){super("w:pBdr");let e=new Be("w:bottom",{color:"auto",space:1,style:kd.SINGLE,size:6});this.root.push(e)}},Vf=class extends ue{constructor({start:e,end:t,left:n,right:i,hanging:s,firstLine:a}){super("w:ind"),this.root.push(new Xt({start:{key:"w:start",value:e===void 0?void 0:en(e)},end:{key:"w:end",value:t===void 0?void 0:en(t)},left:{key:"w:left",value:n===void 0?void 0:en(n)},right:{key:"w:right",value:i===void 0?void 0:en(i)},hanging:{key:"w:hanging",value:s===void 0?void 0:lt(s)},firstLine:{key:"w:firstLine",value:a===void 0?void 0:lt(a)}}))}},S3=class extends ue{constructor(){super("w:br")}},xT={BEGIN:"begin",END:"end",SEPARATE:"separate"},ul=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}},lr=class extends ue{constructor(e){super("w:fldChar"),this.root.push(new ul({type:xT.BEGIN,dirty:e}))}},kr=class extends ue{constructor(e){super("w:fldChar"),this.root.push(new ul({type:xT.SEPARATE,dirty:e}))}},ur=class extends ue{constructor(e){super("w:fldChar"),this.root.push(new ul({type:xT.END,dirty:e}))}},ZX={CENTER:"center",INSIDE:"inside",LEFT:"left",OUTSIDE:"outside",RIGHT:"right"},QX={BOTTOM:"bottom",CENTER:"center",INSIDE:"inside",OUTSIDE:"outside",TOP:"top"},eY={DECIMAL:"decimal",UPPER_ROMAN:"upperRoman",LOWER_ROMAN:"lowerRoman",UPPER_LETTER:"upperLetter",LOWER_LETTER:"lowerLetter",ORDINAL:"ordinal",CARDINAL_TEXT:"cardinalText",ORDINAL_TEXT:"ordinalText",HEX:"hex",CHICAGO:"chicago",IDEOGRAPH_DIGITAL:"ideographDigital",JAPANESE_COUNTING:"japaneseCounting",AIUEO:"aiueo",IROHA:"iroha",DECIMAL_FULL_WIDTH:"decimalFullWidth",DECIMAL_HALF_WIDTH:"decimalHalfWidth",JAPANESE_LEGAL:"japaneseLegal",JAPANESE_DIGITAL_TEN_THOUSAND:"japaneseDigitalTenThousand",DECIMAL_ENCLOSED_CIRCLE:"decimalEnclosedCircle",DECIMAL_FULL_WIDTH_2:"decimalFullWidth2",AIUEO_FULL_WIDTH:"aiueoFullWidth",IROHA_FULL_WIDTH:"irohaFullWidth",DECIMAL_ZERO:"decimalZero",BULLET:"bullet",GANADA:"ganada",CHOSUNG:"chosung",DECIMAL_ENCLOSED_FULL_STOP:"decimalEnclosedFullstop",DECIMAL_ENCLOSED_PAREN:"decimalEnclosedParen",DECIMAL_ENCLOSED_CIRCLE_CHINESE:"decimalEnclosedCircleChinese",IDEOGRAPH_ENCLOSED_CIRCLE:"ideographEnclosedCircle",IDEOGRAPH_TRADITIONAL:"ideographTraditional",IDEOGRAPH_ZODIAC:"ideographZodiac",IDEOGRAPH_ZODIAC_TRADITIONAL:"ideographZodiacTraditional",TAIWANESE_COUNTING:"taiwaneseCounting",IDEOGRAPH_LEGAL_TRADITIONAL:"ideographLegalTraditional",TAIWANESE_COUNTING_THOUSAND:"taiwaneseCountingThousand",TAIWANESE_DIGITAL:"taiwaneseDigital",CHINESE_COUNTING:"chineseCounting",CHINESE_LEGAL_SIMPLIFIED:"chineseLegalSimplified",CHINESE_COUNTING_TEN_THOUSAND:"chineseCountingThousand",KOREAN_DIGITAL:"koreanDigital",KOREAN_COUNTING:"koreanCounting",KOREAN_LEGAL:"koreanLegal",KOREAN_DIGITAL_2:"koreanDigital2",VIETNAMESE_COUNTING:"vietnameseCounting",RUSSIAN_LOWER:"russianLower",RUSSIAN_UPPER:"russianUpper",NONE:"none",NUMBER_IN_DASH:"numberInDash",HEBREW_1:"hebrew1",HEBREW_2:"hebrew2",ARABIC_ALPHA:"arabicAlpha",ARABIC_ABJAD:"arabicAbjad",HINDI_VOWELS:"hindiVowels",HINDI_CONSONANTS:"hindiConsonants",HINDI_NUMBERS:"hindiNumbers",HINDI_COUNTING:"hindiCounting",THAI_LETTERS:"thaiLetters",THAI_NUMBERS:"thaiNumbers",THAI_COUNTING:"thaiCounting",BAHT_TEXT:"bahtText",DOLLAR_TEXT:"dollarText"},Yt={DEFAULT:"default",PRESERVE:"preserve"},Ht=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{space:"xml:space"})}},Ex=class extends ue{constructor(){super("w:instrText"),this.root.push(new Ht({space:Yt.PRESERVE})),this.root.push("PAGE")}},Sx=class extends ue{constructor(){super("w:instrText"),this.root.push(new Ht({space:Yt.PRESERVE})),this.root.push("NUMPAGES")}},kx=class extends ue{constructor(){super("w:instrText"),this.root.push(new Ht({space:Yt.PRESERVE})),this.root.push("SECTIONPAGES")}},Tx=class extends ue{constructor(){super("w:instrText"),this.root.push(new Ht({space:Yt.PRESERVE})),this.root.push("SECTION")}},Ax=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}},$i=class extends ue{constructor({fill:e,color:t,type:n}){super("w:shd"),this.root.push(new Ax({fill:e===void 0?void 0:Gi(e),color:t===void 0?void 0:Gi(t),type:n}))}},tY={CLEAR:"clear",DIAGONAL_CROSS:"diagCross",DIAGONAL_STRIPE:"diagStripe",HORIZONTAL_CROSS:"horzCross",HORIZONTAL_STRIPE:"horzStripe",NIL:"nil",PERCENT_5:"pct5",PERCENT_10:"pct10",PERCENT_12:"pct12",PERCENT_15:"pct15",PERCENT_20:"pct20",PERCENT_25:"pct25",PERCENT_30:"pct30",PERCENT_35:"pct35",PERCENT_37:"pct37",PERCENT_40:"pct40",PERCENT_45:"pct45",PERCENT_50:"pct50",PERCENT_55:"pct55",PERCENT_60:"pct60",PERCENT_62:"pct62",PERCENT_65:"pct65",PERCENT_70:"pct70",PERCENT_75:"pct75",PERCENT_80:"pct80",PERCENT_85:"pct85",PERCENT_87:"pct87",PERCENT_90:"pct90",PERCENT_95:"pct95",REVERSE_DIAGONAL_STRIPE:"reverseDiagStripe",SOLID:"solid",THIN_DIAGONAL_CROSS:"thinDiagCross",THIN_DIAGONAL_STRIPE:"thinDiagStripe",THIN_HORIZONTAL_CROSS:"thinHorzCross",THIN_REVERSE_DIAGONAL_STRIPE:"thinReverseDiagStripe",THIN_VERTICAL_STRIPE:"thinVertStripe",VERTICAL_STRIPE:"vertStripe"},cl=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}},ET={DOT:"dot"},fl=class extends ue{constructor(e){super("w:em"),this.root.push(new Ve({val:e}))}},Kf=class extends fl{constructor(e=ET.DOT){super(e)}},Ox=class extends fl{constructor(){super(ET.DOT)}},Nx=class extends ue{constructor(e){super("w:spacing"),this.root.push(new Ve({val:en(e)}))}},Rx=class extends ue{constructor(e){super("w:color"),this.root.push(new Ve({val:Gi(e)}))}},Cx=class extends ue{constructor(e){super("w:highlight"),this.root.push(new Ve({val:e}))}},Ix=class extends ue{constructor(e){super("w:highlightCs"),this.root.push(new Ve({val:e}))}},rY=r=>new ke({name:"w:lang",attributes:{value:{key:"w:val",value:r.value},eastAsia:{key:"w:eastAsia",value:r.eastAsia},bidirectional:{key:"w:bidi",value:r.bidirectional}}}),Gf=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}},oo=class extends ue{constructor(e,t){if(super("w:rFonts"),typeof e=="string"){let n=e;this.root.push(new Gf({ascii:n,cs:n,eastAsia:n,hAnsi:n,hint:t}))}else{let n=e;this.root.push(new Gf(n))}}},k3=class extends ue{constructor(e){super("w:vertAlign"),this.root.push(new Ve({val:e}))}},Px=class extends k3{constructor(){super("superscript")}},Dx=class extends k3{constructor(){super("subscript")}},ST={SINGLE:"single",WORDS:"words",DOUBLE:"double",THICK:"thick",DOTTED:"dotted",DOTTEDHEAVY:"dottedHeavy",DASH:"dash",DASHEDHEAVY:"dashedHeavy",DASHLONG:"dashLong",DASHLONGHEAVY:"dashLongHeavy",DOTDASH:"dotDash",DASHDOTHEAVY:"dashDotHeavy",DOTDOTDASH:"dotDotDash",DASHDOTDOTHEAVY:"dashDotDotHeavy",WAVE:"wave",WAVYHEAVY:"wavyHeavy",WAVYDOUBLE:"wavyDouble",NONE:"none"},$f=class extends ue{constructor(e=ST.SINGLE,t){super("w:u"),this.root.push(new Ve({val:e,color:t===void 0?void 0:Gi(t)}))}},nY={BLINK_BACKGROUND:"blinkBackground",LIGHTS:"lights",ANTS_BLACK:"antsBlack",ANTS_RED:"antsRed",SHIMMER:"shimmer",SPARKLE:"sparkle",NONE:"none"},iY={BLACK:"black",BLUE:"blue",CYAN:"cyan",DARK_BLUE:"darkBlue",DARK_CYAN:"darkCyan",DARK_GRAY:"darkGray",DARK_GREEN:"darkGreen",DARK_MAGENTA:"darkMagenta",DARK_RED:"darkRed",DARK_YELLOW:"darkYellow",GREEN:"green",LIGHT_GRAY:"lightGray",MAGENTA:"magenta",NONE:"none",RED:"red",WHITE:"white",YELLOW:"yellow"},Ar=class extends cr{constructor(e){var t,n;if(super("w:rPr"),!e)return;e.style&&this.push(new Tr("w:rStyle",e.style)),e.font&&(typeof e.font=="string"?this.push(new oo(e.font)):"name"in e.font?this.push(new oo(e.font.name,e.font.hint)):this.push(new oo(e.font))),e.bold!==void 0&&this.push(new me("w:b",e.bold)),(e.boldComplexScript===void 0&&e.bold!==void 0||e.boldComplexScript)&&this.push(new me("w:bCs",(t=e.boldComplexScript)!=null?t:e.bold)),e.italics!==void 0&&this.push(new me("w:i",e.italics)),(e.italicsComplexScript===void 0&&e.italics!==void 0||e.italicsComplexScript)&&this.push(new me("w:iCs",(n=e.italicsComplexScript)!=null?n:e.italics)),e.smallCaps!==void 0?this.push(new me("w:smallCaps",e.smallCaps)):e.allCaps!==void 0&&this.push(new me("w:caps",e.allCaps)),e.strike!==void 0&&this.push(new me("w:strike",e.strike)),e.doubleStrike!==void 0&&this.push(new me("w:dstrike",e.doubleStrike)),e.emboss!==void 0&&this.push(new me("w:emboss",e.emboss)),e.imprint!==void 0&&this.push(new me("w:imprint",e.imprint)),e.noProof!==void 0&&this.push(new me("w:noProof",e.noProof)),e.snapToGrid!==void 0&&this.push(new me("w:snapToGrid",e.snapToGrid)),e.vanish&&this.push(new me("w:vanish",e.vanish)),e.color&&this.push(new Rx(e.color)),e.characterSpacing&&this.push(new Nx(e.characterSpacing)),e.scale!==void 0&&this.push(new ii("w:w",e.scale)),e.kern&&this.push(new so("w:kern",e.kern)),e.position&&this.push(new Tr("w:position",e.position)),e.size!==void 0&&this.push(new so("w:sz",e.size));let i=e.sizeComplexScript===void 0||e.sizeComplexScript===!0?e.size:e.sizeComplexScript;i&&this.push(new so("w:szCs",i)),e.highlight&&this.push(new Cx(e.highlight));let s=e.highlightComplexScript===void 0||e.highlightComplexScript===!0?e.highlight:e.highlightComplexScript;s&&this.push(new Ix(s)),e.underline&&this.push(new $f(e.underline.type,e.underline.color)),e.effect&&this.push(new Tr("w:effect",e.effect)),e.border&&this.push(new Be("w:bdr",e.border)),e.shading&&this.push(new $i(e.shading)),e.subScript&&this.push(new Dx),e.superScript&&this.push(new Px),e.rightToLeft!==void 0&&this.push(new me("w:rtl",e.rightToLeft)),e.emphasisMark&&this.push(new Kf(e.emphasisMark.type)),e.language&&this.push(rY(e.language)),e.specVanish&&this.push(new me("w:specVanish",e.vanish)),e.math&&this.push(new me("w:oMath",e.math)),e.revision&&this.push(new Jf(e.revision))}push(e){this.root.push(e)}},Jf=class extends ue{constructor(e){super("w:rPrChange"),this.root.push(new cl({id:e.id,author:e.author,date:e.date})),this.addChildElement(new Ar(e))}},hl=class extends ue{constructor(e){var t;super("w:t"),typeof e=="string"?(this.root.push(new Ht({space:Yt.PRESERVE})),this.root.push(e)):(this.root.push(new Ht({space:(t=e.space)!=null?t:Yt.DEFAULT})),this.root.push(e.text))}},ni={CURRENT:"CURRENT",TOTAL_PAGES:"TOTAL_PAGES",TOTAL_PAGES_IN_SECTION:"TOTAL_PAGES_IN_SECTION",CURRENT_SECTION:"SECTION"},Pt=class extends ue{constructor(e){if(super("w:r"),ce(this,"properties"),this.properties=new Ar(e),this.root.push(this.properties),e.break)for(let t=0;t<e.break;t++)this.root.push(new S3);if(e.children)for(let t of e.children){if(typeof t=="string"){switch(t){case ni.CURRENT:this.root.push(new lr),this.root.push(new Ex),this.root.push(new kr),this.root.push(new ur);break;case ni.TOTAL_PAGES:this.root.push(new lr),this.root.push(new Sx),this.root.push(new kr),this.root.push(new ur);break;case ni.TOTAL_PAGES_IN_SECTION:this.root.push(new lr),this.root.push(new kx),this.root.push(new kr),this.root.push(new ur);break;case ni.CURRENT_SECTION:this.root.push(new lr),this.root.push(new Tx),this.root.push(new kr),this.root.push(new ur);break;default:this.root.push(new hl(t));break}continue}this.root.push(t)}else e.text!==void 0&&this.root.push(new hl(e.text))}},Ji=class extends Pt{constructor(e){super(typeof e=="string"?{text:e}:e)}},Mx=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{char:"w:char",symbolfont:"w:font"})}},xL=class extends ue{constructor(e="",t="Wingdings"){super("w:sym"),this.root.push(new Mx({char:e,symbolfont:t}))}},Xf=class extends Pt{constructor(e){if(typeof e=="string")return super({}),this.root.push(new xL(e)),this;super(e),this.root.push(new xL(e.char,e.symbolfont))}},ex={},We={},tx,EL;function Cl(){if(EL)return tx;EL=1,tx=r;function r(e,t){if(!e)throw new Error(t||"Assertion failed")}return r.equal=function(t,n,i){if(t!=n)throw new Error(i||"Assertion failed: "+t+" != "+n)},tx}var SL;function on(){if(SL)return We;SL=1;var r=Cl(),e=oi();We.inherits=e;function t(C,H){return(C.charCodeAt(H)&64512)!==55296||H<0||H+1>=C.length?!1:(C.charCodeAt(H+1)&64512)===56320}function n(C,H){if(Array.isArray(C))return C.slice();if(!C)return[];var k=[];if(typeof C=="string")if(H){if(H==="hex")for(C=C.replace(/[^a-z0-9]+/ig,""),C.length%2!==0&&(C="0"+C),Q=0;Q<C.length;Q+=2)k.push(parseInt(C[Q]+C[Q+1],16))}else for(var V=0,Q=0;Q<C.length;Q++){var j=C.charCodeAt(Q);j<128?k[V++]=j:j<2048?(k[V++]=j>>6|192,k[V++]=j&63|128):t(C,Q)?(j=65536+((j&1023)<<10)+(C.charCodeAt(++Q)&1023),k[V++]=j>>18|240,k[V++]=j>>12&63|128,k[V++]=j>>6&63|128,k[V++]=j&63|128):(k[V++]=j>>12|224,k[V++]=j>>6&63|128,k[V++]=j&63|128)}else for(Q=0;Q<C.length;Q++)k[Q]=C[Q]|0;return k}We.toArray=n;function i(C){for(var H="",k=0;k<C.length;k++)H+=o(C[k].toString(16));return H}We.toHex=i;function s(C){var H=C>>>24|C>>>8&65280|C<<8&16711680|(C&255)<<24;return H>>>0}We.htonl=s;function a(C,H){for(var k="",V=0;V<C.length;V++){var Q=C[V];H==="little"&&(Q=s(Q)),k+=l(Q.toString(16))}return k}We.toHex32=a;function o(C){return C.length===1?"0"+C:C}We.zero2=o;function l(C){return C.length===7?"0"+C:C.length===6?"00"+C:C.length===5?"000"+C:C.length===4?"0000"+C:C.length===3?"00000"+C:C.length===2?"000000"+C:C.length===1?"0000000"+C:C}We.zero8=l;function u(C,H,k,V){var Q=k-H;r(Q%4===0);for(var j=new Array(Q/4),ie=0,ee=H;ie<j.length;ie++,ee+=4){var le;V==="big"?le=C[ee]<<24|C[ee+1]<<16|C[ee+2]<<8|C[ee+3]:le=C[ee+3]<<24|C[ee+2]<<16|C[ee+1]<<8|C[ee],j[ie]=le>>>0}return j}We.join32=u;function c(C,H){for(var k=new Array(C.length*4),V=0,Q=0;V<C.length;V++,Q+=4){var j=C[V];H==="big"?(k[Q]=j>>>24,k[Q+1]=j>>>16&255,k[Q+2]=j>>>8&255,k[Q+3]=j&255):(k[Q+3]=j>>>24,k[Q+2]=j>>>16&255,k[Q+1]=j>>>8&255,k[Q]=j&255)}return k}We.split32=c;function f(C,H){return C>>>H|C<<32-H}We.rotr32=f;function d(C,H){return C<<H|C>>>32-H}We.rotl32=d;function h(C,H){return C+H>>>0}We.sum32=h;function y(C,H,k){return C+H+k>>>0}We.sum32_3=y;function v(C,H,k,V){return C+H+k+V>>>0}We.sum32_4=v;function x(C,H,k,V,Q){return C+H+k+V+Q>>>0}We.sum32_5=x;function m(C,H,k,V){var Q=C[H],j=C[H+1],ie=V+j>>>0,ee=(ie<V?1:0)+k+Q;C[H]=ee>>>0,C[H+1]=ie}We.sum64=m;function _(C,H,k,V){var Q=H+V>>>0,j=(Q<H?1:0)+C+k;return j>>>0}We.sum64_hi=_;function b(C,H,k,V){var Q=H+V;return Q>>>0}We.sum64_lo=b;function w(C,H,k,V,Q,j,ie,ee){var le=0,G=H;G=G+V>>>0,le+=G<H?1:0,G=G+j>>>0,le+=G<j?1:0,G=G+ee>>>0,le+=G<ee?1:0;var D=C+k+Q+ie+le;return D>>>0}We.sum64_4_hi=w;function T(C,H,k,V,Q,j,ie,ee){var le=H+V+j+ee;return le>>>0}We.sum64_4_lo=T;function P(C,H,k,V,Q,j,ie,ee,le,G){var D=0,$=H;$=$+V>>>0,D+=$<H?1:0,$=$+j>>>0,D+=$<j?1:0,$=$+ee>>>0,D+=$<ee?1:0,$=$+G>>>0,D+=$<G?1:0;var X=C+k+Q+ie+le+D;return X>>>0}We.sum64_5_hi=P;function M(C,H,k,V,Q,j,ie,ee,le,G){var D=H+V+j+ee+G;return D>>>0}We.sum64_5_lo=M;function U(C,H,k){var V=H<<32-k|C>>>k;return V>>>0}We.rotr64_hi=U;function R(C,H,k){var V=C<<32-k|H>>>k;return V>>>0}We.rotr64_lo=R;function J(C,H,k){return C>>>k}We.shr64_hi=J;function oe(C,H,k){var V=C<<32-k|H>>>k;return V>>>0}return We.shr64_lo=oe,We}var rx={},kL;function Il(){if(kL)return rx;kL=1;var r=on(),e=Cl();function t(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}return rx.BlockHash=t,t.prototype.update=function(i,s){if(i=r.toArray(i,s),this.pending?this.pending=this.pending.concat(i):this.pending=i,this.pendingTotal+=i.length,this.pending.length>=this._delta8){i=this.pending;var a=i.length%this._delta8;this.pending=i.slice(i.length-a,i.length),this.pending.length===0&&(this.pending=null),i=r.join32(i,0,i.length-a,this.endian);for(var o=0;o<i.length;o+=this._delta32)this._update(i,o,o+this._delta32)}return this},t.prototype.digest=function(i){return this.update(this._pad()),e(this.pending===null),this._digest(i)},t.prototype._pad=function(){var i=this.pendingTotal,s=this._delta8,a=s-(i+this.padLength)%s,o=new Array(a+this.padLength);o[0]=128;for(var l=1;l<a;l++)o[l]=0;if(i<<=3,this.endian==="big"){for(var u=8;u<this.padLength;u++)o[l++]=0;o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=i>>>24&255,o[l++]=i>>>16&255,o[l++]=i>>>8&255,o[l++]=i&255}else for(o[l++]=i&255,o[l++]=i>>>8&255,o[l++]=i>>>16&255,o[l++]=i>>>24&255,o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=0,u=8;u<this.padLength;u++)o[l++]=0;return o},rx}var Wi={},$r={},TL;function T3(){if(TL)return $r;TL=1;var r=on(),e=r.rotr32;function t(c,f,d,h){if(c===0)return n(f,d,h);if(c===1||c===3)return s(f,d,h);if(c===2)return i(f,d,h)}$r.ft_1=t;function n(c,f,d){return c&f^~c&d}$r.ch32=n;function i(c,f,d){return c&f^c&d^f&d}$r.maj32=i;function s(c,f,d){return c^f^d}$r.p32=s;function a(c){return e(c,2)^e(c,13)^e(c,22)}$r.s0_256=a;function o(c){return e(c,6)^e(c,11)^e(c,25)}$r.s1_256=o;function l(c){return e(c,7)^e(c,18)^c>>>3}$r.g0_256=l;function u(c){return e(c,17)^e(c,19)^c>>>10}return $r.g1_256=u,$r}var nx,AL;function sY(){if(AL)return nx;AL=1;var r=on(),e=Il(),t=T3(),n=r.rotl32,i=r.sum32,s=r.sum32_5,a=t.ft_1,o=e.BlockHash,l=[1518500249,1859775393,2400959708,3395469782];function u(){if(!(this instanceof u))return new u;o.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}return r.inherits(u,o),nx=u,u.blockSize=512,u.outSize=160,u.hmacStrength=80,u.padLength=64,u.prototype._update=function(f,d){for(var h=this.W,y=0;y<16;y++)h[y]=f[d+y];for(;y<h.length;y++)h[y]=n(h[y-3]^h[y-8]^h[y-14]^h[y-16],1);var v=this.h[0],x=this.h[1],m=this.h[2],_=this.h[3],b=this.h[4];for(y=0;y<h.length;y++){var w=~~(y/20),T=s(n(v,5),a(w,x,m,_),b,h[y],l[w]);b=_,_=m,m=n(x,30),x=v,v=T}this.h[0]=i(this.h[0],v),this.h[1]=i(this.h[1],x),this.h[2]=i(this.h[2],m),this.h[3]=i(this.h[3],_),this.h[4]=i(this.h[4],b)},u.prototype._digest=function(f){return f==="hex"?r.toHex32(this.h,"big"):r.split32(this.h,"big")},nx}var ix,OL;function A3(){if(OL)return ix;OL=1;var r=on(),e=Il(),t=T3(),n=Cl(),i=r.sum32,s=r.sum32_4,a=r.sum32_5,o=t.ch32,l=t.maj32,u=t.s0_256,c=t.s1_256,f=t.g0_256,d=t.g1_256,h=e.BlockHash,y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function v(){if(!(this instanceof v))return new v;h.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=y,this.W=new Array(64)}return r.inherits(v,h),ix=v,v.blockSize=512,v.outSize=256,v.hmacStrength=192,v.padLength=64,v.prototype._update=function(m,_){for(var b=this.W,w=0;w<16;w++)b[w]=m[_+w];for(;w<b.length;w++)b[w]=s(d(b[w-2]),b[w-7],f(b[w-15]),b[w-16]);var T=this.h[0],P=this.h[1],M=this.h[2],U=this.h[3],R=this.h[4],J=this.h[5],oe=this.h[6],C=this.h[7];for(n(this.k.length===b.length),w=0;w<b.length;w++){var H=a(C,c(R),o(R,J,oe),this.k[w],b[w]),k=i(u(T),l(T,P,M));C=oe,oe=J,J=R,R=i(U,H),U=M,M=P,P=T,T=i(H,k)}this.h[0]=i(this.h[0],T),this.h[1]=i(this.h[1],P),this.h[2]=i(this.h[2],M),this.h[3]=i(this.h[3],U),this.h[4]=i(this.h[4],R),this.h[5]=i(this.h[5],J),this.h[6]=i(this.h[6],oe),this.h[7]=i(this.h[7],C)},v.prototype._digest=function(m){return m==="hex"?r.toHex32(this.h,"big"):r.split32(this.h,"big")},ix}var sx,NL;function oY(){if(NL)return sx;NL=1;var r=on(),e=A3();function t(){if(!(this instanceof t))return new t;e.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}return r.inherits(t,e),sx=t,t.blockSize=512,t.outSize=224,t.hmacStrength=192,t.padLength=64,t.prototype._digest=function(i){return i==="hex"?r.toHex32(this.h.slice(0,7),"big"):r.split32(this.h.slice(0,7),"big")},sx}var ox,RL;function O3(){if(RL)return ox;RL=1;var r=on(),e=Il(),t=Cl(),n=r.rotr64_hi,i=r.rotr64_lo,s=r.shr64_hi,a=r.shr64_lo,o=r.sum64,l=r.sum64_hi,u=r.sum64_lo,c=r.sum64_4_hi,f=r.sum64_4_lo,d=r.sum64_5_hi,h=r.sum64_5_lo,y=e.BlockHash,v=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function x(){if(!(this instanceof x))return new x;y.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=v,this.W=new Array(160)}r.inherits(x,y),ox=x,x.blockSize=1024,x.outSize=512,x.hmacStrength=192,x.padLength=128,x.prototype._prepareBlock=function(k,V){for(var Q=this.W,j=0;j<32;j++)Q[j]=k[V+j];for(;j<Q.length;j+=2){var ie=oe(Q[j-4],Q[j-3]),ee=C(Q[j-4],Q[j-3]),le=Q[j-14],G=Q[j-13],D=R(Q[j-30],Q[j-29]),$=J(Q[j-30],Q[j-29]),X=Q[j-32],re=Q[j-31];Q[j]=c(ie,ee,le,G,D,$,X,re),Q[j+1]=f(ie,ee,le,G,D,$,X,re)}},x.prototype._update=function(k,V){this._prepareBlock(k,V);var Q=this.W,j=this.h[0],ie=this.h[1],ee=this.h[2],le=this.h[3],G=this.h[4],D=this.h[5],$=this.h[6],X=this.h[7],re=this.h[8],K=this.h[9],O=this.h[10],A=this.h[11],W=this.h[12],B=this.h[13],I=this.h[14],L=this.h[15];t(this.k.length===Q.length);for(var Z=0;Z<Q.length;Z+=2){var E=I,Y=L,N=M(re,K),p=U(re,K),g=m(re,K,O,A,W),S=_(re,K,O,A,W,B),F=this.k[Z],q=this.k[Z+1],z=Q[Z],ne=Q[Z+1],ae=d(E,Y,N,p,g,S,F,q,z,ne),se=h(E,Y,N,p,g,S,F,q,z,ne);E=T(j,ie),Y=P(j,ie),N=b(j,ie,ee,le,G),p=w(j,ie,ee,le,G,D);var fe=l(E,Y,N,p),pe=u(E,Y,N,p);I=W,L=B,W=O,B=A,O=re,A=K,re=l($,X,ae,se),K=u(X,X,ae,se),$=G,X=D,G=ee,D=le,ee=j,le=ie,j=l(ae,se,fe,pe),ie=u(ae,se,fe,pe)}o(this.h,0,j,ie),o(this.h,2,ee,le),o(this.h,4,G,D),o(this.h,6,$,X),o(this.h,8,re,K),o(this.h,10,O,A),o(this.h,12,W,B),o(this.h,14,I,L)},x.prototype._digest=function(k){return k==="hex"?r.toHex32(this.h,"big"):r.split32(this.h,"big")};function m(H,k,V,Q,j){var ie=H&V^~H&j;return ie<0&&(ie+=4294967296),ie}function _(H,k,V,Q,j,ie){var ee=k&Q^~k&ie;return ee<0&&(ee+=4294967296),ee}function b(H,k,V,Q,j){var ie=H&V^H&j^V&j;return ie<0&&(ie+=4294967296),ie}function w(H,k,V,Q,j,ie){var ee=k&Q^k&ie^Q&ie;return ee<0&&(ee+=4294967296),ee}function T(H,k){var V=n(H,k,28),Q=n(k,H,2),j=n(k,H,7),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}function P(H,k){var V=i(H,k,28),Q=i(k,H,2),j=i(k,H,7),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}function M(H,k){var V=n(H,k,14),Q=n(H,k,18),j=n(k,H,9),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}function U(H,k){var V=i(H,k,14),Q=i(H,k,18),j=i(k,H,9),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}function R(H,k){var V=n(H,k,1),Q=n(H,k,8),j=s(H,k,7),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}function J(H,k){var V=i(H,k,1),Q=i(H,k,8),j=a(H,k,7),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}function oe(H,k){var V=n(H,k,19),Q=n(k,H,29),j=s(H,k,6),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}function C(H,k){var V=i(H,k,19),Q=i(k,H,29),j=a(H,k,6),ie=V^Q^j;return ie<0&&(ie+=4294967296),ie}return ox}var ax,CL;function aY(){if(CL)return ax;CL=1;var r=on(),e=O3();function t(){if(!(this instanceof t))return new t;e.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}return r.inherits(t,e),ax=t,t.blockSize=1024,t.outSize=384,t.hmacStrength=192,t.padLength=128,t.prototype._digest=function(i){return i==="hex"?r.toHex32(this.h.slice(0,12),"big"):r.split32(this.h.slice(0,12),"big")},ax}var IL;function lY(){return IL||(IL=1,Wi.sha1=sY(),Wi.sha224=oY(),Wi.sha256=A3(),Wi.sha384=aY(),Wi.sha512=O3()),Wi}var lx={},PL;function uY(){if(PL)return lx;PL=1;var r=on(),e=Il(),t=r.rotl32,n=r.sum32,i=r.sum32_3,s=r.sum32_4,a=e.BlockHash;function o(){if(!(this instanceof o))return new o;a.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}r.inherits(o,a),lx.ripemd160=o,o.blockSize=512,o.outSize=160,o.hmacStrength=192,o.padLength=64,o.prototype._update=function(x,m){for(var _=this.h[0],b=this.h[1],w=this.h[2],T=this.h[3],P=this.h[4],M=_,U=b,R=w,J=T,oe=P,C=0;C<80;C++){var H=n(t(s(_,l(C,b,w,T),x[f[C]+m],u(C)),h[C]),P);_=P,P=T,T=t(w,10),w=b,b=H,H=n(t(s(M,l(79-C,U,R,J),x[d[C]+m],c(C)),y[C]),oe),M=oe,oe=J,J=t(R,10),R=U,U=H}H=i(this.h[1],w,J),this.h[1]=i(this.h[2],T,oe),this.h[2]=i(this.h[3],P,M),this.h[3]=i(this.h[4],_,U),this.h[4]=i(this.h[0],b,R),this.h[0]=H},o.prototype._digest=function(x){return x==="hex"?r.toHex32(this.h,"little"):r.split32(this.h,"little")};function l(v,x,m,_){return v<=15?x^m^_:v<=31?x&m|~x&_:v<=47?(x|~m)^_:v<=63?x&_|m&~_:x^(m|~_)}function u(v){return v<=15?0:v<=31?1518500249:v<=47?1859775393:v<=63?2400959708:2840853838}function c(v){return v<=15?1352829926:v<=31?1548603684:v<=47?1836072691:v<=63?2053994217:0}var f=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],d=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],h=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],y=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];return lx}var ux,DL;function cY(){if(DL)return ux;DL=1;var r=on(),e=Cl();function t(n,i,s){if(!(this instanceof t))return new t(n,i,s);this.Hash=n,this.blockSize=n.blockSize/8,this.outSize=n.outSize/8,this.inner=null,this.outer=null,this._init(r.toArray(i,s))}return ux=t,t.prototype._init=function(i){i.length>this.blockSize&&(i=new this.Hash().update(i).digest()),e(i.length<=this.blockSize);for(var s=i.length;s<this.blockSize;s++)i.push(0);for(s=0;s<i.length;s++)i[s]^=54;for(this.inner=new this.Hash().update(i),s=0;s<i.length;s++)i[s]^=106;this.outer=new this.Hash().update(i)},t.prototype.update=function(i,s){return this.inner.update(i,s),this},t.prototype.digest=function(i){return this.outer.update(this.inner.digest()),this.outer.digest(i)},ux}var ML;function fY(){return ML||(ML=1,(function(r){var e=r;e.utils=on(),e.common=Il(),e.sha=lY(),e.ripemd=uY(),e.hmac=cY(),e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160})(ex)),ex}var hY=fY(),dY=fT(hY),pY="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",mY=(r,e=21)=>(t=e)=>{let n="",i=t|0;for(;i--;)n+=r[Math.random()*r.length|0];return n},gY=(r=21)=>{let e="",t=r|0;for(;t--;)e+=pY[Math.random()*64|0];return e},vY=r=>Math.floor(r/25.4*72*20),ar=r=>Math.floor(r*72*20),Pl=(r=0)=>{let e=r;return()=>++e},N3=()=>Pl(),R3=()=>Pl(1),C3=()=>Pl(),I3=()=>Pl(),Dl=()=>gY().toLowerCase(),Lx=r=>dY.sha1().update(r instanceof ArrayBuffer?new Uint8Array(r):r).digest("hex"),el=r=>mY("1234567890abcdef",r)(),P3=()=>`${el(8)}-${el(4)}-${el(4)}-${el(4)}-${el(12)}`,D3={CHARACTER:"character",COLUMN:"column",INSIDE_MARGIN:"insideMargin",LEFT_MARGIN:"leftMargin",MARGIN:"margin",OUTSIDE_MARGIN:"outsideMargin",PAGE:"page",RIGHT_MARGIN:"rightMargin"},M3={BOTTOM_MARGIN:"bottomMargin",INSIDE_MARGIN:"insideMargin",LINE:"line",MARGIN:"margin",OUTSIDE_MARGIN:"outsideMargin",PAGE:"page",PARAGRAPH:"paragraph",TOP_MARGIN:"topMargin"},L3=()=>new ke({name:"wp:simplePos",attributes:{x:{key:"x",value:0},y:{key:"y",value:0}}}),F3=r=>new ke({name:"wp:align",children:[r]}),B3=r=>new ke({name:"wp:posOffset",children:[r.toString()]}),U3=({relative:r,align:e,offset:t})=>new ke({name:"wp:positionH",attributes:{relativeFrom:{key:"relativeFrom",value:r??D3.PAGE}},children:[(()=>{if(e)return F3(e);if(t!==void 0)return B3(t);throw new Error("There is no configuration provided for floating position (Align or offset)")})()]}),H3=({relative:r,align:e,offset:t})=>new ke({name:"wp:positionV",attributes:{relativeFrom:{key:"relativeFrom",value:r??M3.PAGE}},children:[(()=>{if(e)return F3(e);if(t!==void 0)return B3(t);throw new Error("There is no configuration provided for floating position (Align or offset)")})()]}),Fx=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{uri:"uri"})}},yY=r=>new ke({name:"asvg:svgBlip",attributes:{asvg:{key:"xmlns:asvg",value:"http://schemas.microsoft.com/office/drawing/2016/SVG/main"},embed:{key:"r:embed",value:`rId{${r.fileName}}`}}}),wY=r=>new ke({name:"a:ext",attributes:{uri:{key:"uri",value:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"}},children:[yY(r)]}),bY=r=>new ke({name:"a:extLst",children:[wY(r)]}),_Y=r=>new ke({name:"a:blip",attributes:{embed:{key:"r:embed",value:`rId{${r.type==="svg"?r.fallback.fileName:r.fileName}}`},cstate:{key:"cstate",value:"none"}},children:r.type==="svg"?[bY(r)]:[]}),Bx=class extends ue{constructor(){super("a:srcRect")}},Ux=class extends ue{constructor(){super("a:fillRect")}},Hx=class extends ue{constructor(){super("a:stretch"),this.root.push(new Ux)}},zx=class extends ue{constructor(e){super("pic:blipFill"),this.root.push(_Y(e)),this.root.push(new Bx),this.root.push(new Hx)}},jx=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{noChangeAspect:"noChangeAspect",noChangeArrowheads:"noChangeArrowheads"})}},Wx=class extends ue{constructor(){super("a:picLocks"),this.root.push(new jx({noChangeAspect:1,noChangeArrowheads:1}))}},qx=class extends ue{constructor(){super("pic:cNvPicPr"),this.root.push(new Wx)}},z3=(r,e)=>new ke({name:"a:hlinkClick",attributes:It(Te({},e?{xmlns:{key:"xmlns:a",value:"http://schemas.openxmlformats.org/drawingml/2006/main"}}:{}),{id:{key:"r:id",value:`rId${r}`}})}),Vx=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{id:"id",name:"name",descr:"descr"})}},Kx=class extends ue{constructor(){super("pic:cNvPr"),this.root.push(new Vx({id:0,name:"",descr:""}))}prepForXml(e){for(let t=e.stack.length-1;t>=0;t--){let n=e.stack[t];if(n instanceof si){this.root.push(z3(n.linkId,!1));break}}return super.prepForXml(e)}},Gx=class extends ue{constructor(){super("pic:nvPicPr"),this.root.push(new Kx),this.root.push(new qx)}},$x=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{xmlns:"xmlns:pic"})}},Jx=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{cx:"cx",cy:"cy"})}},Xx=class extends ue{constructor(e,t){super("a:ext"),ce(this,"attributes"),this.attributes=new Jx({cx:e,cy:t}),this.root.push(this.attributes)}},Yx=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{x:"x",y:"y"})}},Zx=class extends ue{constructor(){super("a:off"),this.root.push(new Yx({x:0,y:0}))}},Qx=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{flipVertical:"flipV",flipHorizontal:"flipH",rotation:"rot"})}},eE=class extends ue{constructor(e){var t,n;super("a:xfrm"),ce(this,"extents"),this.root.push(new Qx({flipVertical:(t=e.flip)==null?void 0:t.vertical,flipHorizontal:(n=e.flip)==null?void 0:n.horizontal,rotation:e.rotation})),this.extents=new Xx(e.emus.x,e.emus.y),this.root.push(new Zx),this.root.push(this.extents)}},j3=()=>new ke({name:"a:noFill"}),xY=r=>new ke({name:"a:srgbClr",attributes:{value:{key:"val",value:r.value}}}),EY=r=>new ke({name:"a:schemeClr",attributes:{value:{key:"val",value:r.value}}}),LL=r=>new ke({name:"a:solidFill",children:[r.type==="rgb"?xY(r):EY(r)]}),SY=r=>new ke({name:"a:ln",attributes:{width:{key:"w",value:r.width},cap:{key:"cap",value:r.cap},compoundLine:{key:"cmpd",value:r.compoundLine},align:{key:"algn",value:r.align}},children:[r.type==="noFill"?j3():r.solidFillType==="rgb"?LL({type:"rgb",value:r.value}):LL({type:"scheme",value:r.value})]}),tE=class extends ue{constructor(){super("a:avLst")}},rE=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{prst:"prst"})}},nE=class extends ue{constructor(){super("a:prstGeom"),this.root.push(new rE({prst:"rect"})),this.root.push(new tE)}},iE=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{bwMode:"bwMode"})}},sE=class extends ue{constructor({outline:e,transform:t}){super("pic:spPr"),ce(this,"form"),this.root.push(new iE({bwMode:"auto"})),this.form=new eE(t),this.root.push(this.form),this.root.push(new nE),e&&(this.root.push(j3()),this.root.push(SY(e)))}},oE=class extends ue{constructor({mediaData:e,transform:t,outline:n}){super("pic:pic"),this.root.push(new $x({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.root.push(new Gx),this.root.push(new zx(e)),this.root.push(new sE({transform:t,outline:n}))}},aE=class extends ue{constructor({mediaData:e,transform:t,outline:n}){super("a:graphicData"),ce(this,"pic"),this.root.push(new Fx({uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.pic=new oE({mediaData:e,transform:t,outline:n}),this.root.push(this.pic)}},lE=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{a:"xmlns:a"})}},Yf=class extends ue{constructor({mediaData:e,transform:t,outline:n}){super("a:graphic"),ce(this,"data"),this.root.push(new lE({a:"http://schemas.openxmlformats.org/drawingml/2006/main"})),this.data=new aE({mediaData:e,transform:t,outline:n}),this.root.push(this.data)}},il={NONE:0,SQUARE:1,TIGHT:2,TOP_AND_BOTTOM:3},W3={BOTH_SIDES:"bothSides",LEFT:"left",RIGHT:"right",LARGEST:"largest"},dl=class extends ue{constructor(){super("wp:wrapNone")}},uE=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",wrapText:"wrapText"})}},Zf=class extends ue{constructor(e,t={top:0,bottom:0,left:0,right:0}){super("wp:wrapSquare"),this.root.push(new uE({wrapText:e.side||W3.BOTH_SIDES,distT:t.top,distB:t.bottom,distL:t.left,distR:t.right}))}},cE=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{distT:"distT",distB:"distB"})}},Qf=class extends ue{constructor(e={top:0,bottom:0}){super("wp:wrapTight"),this.root.push(new cE({distT:e.top,distB:e.bottom}))}},fE=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{distT:"distT",distB:"distB"})}},eh=class extends ue{constructor(e={top:0,bottom:0}){super("wp:wrapTopAndBottom"),this.root.push(new fE({distT:e.top,distB:e.bottom}))}},th=class extends ue{constructor({name:e,description:t,title:n}={name:"",description:"",title:""}){super("wp:docPr"),ce(this,"docPropertiesUniqueNumericId",C3());let i={id:{key:"id",value:this.docPropertiesUniqueNumericId()},name:{key:"name",value:e}};t!=null&&(i.description={key:"descr",value:t}),n!=null&&(i.title={key:"title",value:n}),this.root.push(new Xt(i))}prepForXml(e){for(let t=e.stack.length-1;t>=0;t--){let n=e.stack[t];if(n instanceof si){this.root.push(z3(n.linkId,!0));break}}return super.prepForXml(e)}},q3=({top:r,right:e,bottom:t,left:n})=>new ke({name:"wp:effectExtent",attributes:{top:{key:"t",value:r},right:{key:"r",value:e},bottom:{key:"b",value:t},left:{key:"l",value:n}}}),V3=({x:r,y:e})=>new ke({name:"wp:extent",attributes:{x:{key:"cx",value:r},y:{key:"cy",value:e}}}),hE=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{xmlns:"xmlns:a",noChangeAspect:"noChangeAspect"})}},dE=class extends ue{constructor(){super("a:graphicFrameLocks"),this.root.push(new hE({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:1}))}},K3=()=>new ke({name:"wp:cNvGraphicFramePr",children:[new dE]}),pE=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",allowOverlap:"allowOverlap",behindDoc:"behindDoc",layoutInCell:"layoutInCell",locked:"locked",relativeHeight:"relativeHeight",simplePos:"simplePos"})}},mE=class extends ue{constructor({mediaData:e,transform:t,drawingOptions:n}){super("wp:anchor");let i=Te({allowOverlap:!0,behindDocument:!1,lockAnchor:!1,layoutInCell:!0,verticalPosition:{},horizontalPosition:{}},n.floating);if(this.root.push(new pE({distT:i.margins&&i.margins.top||0,distB:i.margins&&i.margins.bottom||0,distL:i.margins&&i.margins.left||0,distR:i.margins&&i.margins.right||0,simplePos:"0",allowOverlap:i.allowOverlap===!0?"1":"0",behindDoc:i.behindDocument===!0?"1":"0",locked:i.lockAnchor===!0?"1":"0",layoutInCell:i.layoutInCell===!0?"1":"0",relativeHeight:i.zIndex?i.zIndex:t.emus.y})),this.root.push(L3()),this.root.push(U3(i.horizontalPosition)),this.root.push(H3(i.verticalPosition)),this.root.push(V3({x:t.emus.x,y:t.emus.y})),this.root.push(q3({top:0,right:0,bottom:0,left:0})),n.floating!==void 0&&n.floating.wrap!==void 0)switch(n.floating.wrap.type){case il.SQUARE:this.root.push(new Zf(n.floating.wrap,n.floating.margins));break;case il.TIGHT:this.root.push(new Qf(n.floating.margins));break;case il.TOP_AND_BOTTOM:this.root.push(new eh(n.floating.margins));break;case il.NONE:default:this.root.push(new dl)}else this.root.push(new dl);this.root.push(new th(n.docProperties)),this.root.push(K3()),this.root.push(new Yf({mediaData:e,transform:t,outline:n.outline}))}},kY=({mediaData:r,transform:e,docProperties:t,outline:n})=>{var i,s,a,o;return new ke({name:"wp:inline",attributes:{distanceTop:{key:"distT",value:0},distanceBottom:{key:"distB",value:0},distanceLeft:{key:"distL",value:0},distanceRight:{key:"distR",value:0}},children:[V3({x:e.emus.x,y:e.emus.y}),q3(n?{top:((i=n.width)!=null?i:9525)*2,right:((s=n.width)!=null?s:9525)*2,bottom:((a=n.width)!=null?a:9525)*2,left:((o=n.width)!=null?o:9525)*2}:{top:0,right:0,bottom:0,left:0}),new th(t),K3(),new Yf({mediaData:r,transform:e,outline:n})]})},rh=class extends ue{constructor(e,t={}){super("w:drawing"),t.floating?this.root.push(new mE({mediaData:e,transform:e.transformation,drawingOptions:t})):this.root.push(kY({mediaData:e,transform:e.transformation,docProperties:t.docProperties,outline:t.outline}))}},TY=r=>{if(typeof atob=="function"){let e=";base64,",t=r.indexOf(e),n=t===-1?0:t+e.length;return new Uint8Array(atob(r.substring(n)).split("").map(i=>i.charCodeAt(0)))}else{let e=require("buffer");return new e.Buffer(r,"base64")}},AY=r=>typeof r=="string"?TY(r):r,cx=(r,e)=>({data:AY(r.data),fileName:e,transformation:{pixels:{x:Math.round(r.transformation.width),y:Math.round(r.transformation.height)},emus:{x:Math.round(r.transformation.width*9525),y:Math.round(r.transformation.height*9525)},flip:r.transformation.flip,rotation:r.transformation.rotation?r.transformation.rotation*6e4:void 0}}),gE=class extends Pt{constructor(e){super({}),ce(this,"imageData");let n=`${Lx(e.data)}.${e.type}`;this.imageData=e.type==="svg"?It(Te({type:e.type},cx(e,n)),{fallback:Te({type:e.fallback.type},cx(It(Te({},e.fallback),{transformation:e.transformation}),`${Lx(e.fallback.data)}.${e.fallback.type}`))}):Te({type:e.type},cx(e,n));let i=new rh(this.imageData,{floating:e.floating,docProperties:e.altText,outline:e.outline});this.root.push(i)}prepForXml(e){return e.file.Media.addImage(this.imageData.fileName,this.imageData),this.imageData.type==="svg"&&e.file.Media.addImage(this.imageData.fallback.fileName,this.imageData.fallback),super.prepForXml(e)}},vE=class extends ue{constructor(e){super("w:instrText"),this.root.push(new Ht({space:Yt.PRESERVE})),this.root.push(`SEQ ${e}`)}},yE=class extends Pt{constructor(e){super({}),this.root.push(new lr(!0)),this.root.push(new vE(e)),this.root.push(new kr),this.root.push(new ur)}},wE=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{instr:"w:instr"})}},nh=class extends ue{constructor(e,t){super("w:fldSimple"),this.root.push(new wE({instr:e})),t!==void 0&&this.root.push(new Ji(t))}},bE=class extends nh{constructor(e){super(` MERGEFIELD ${e} `,`\xAB${e}\xBB`)}},_E=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{xmlns:"xmlns"})}},xE=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}},G3={EXTERNAL:"External"},EE=class extends ue{constructor(e,t,n,i){super("Relationship"),this.root.push(new xE({id:e,type:t,target:n,targetMode:i}))}},Dn=class extends ue{constructor(){super("Relationships"),this.root.push(new _E({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(e,t,n,i){let s=new EE(`rId${e}`,t,n,i);return this.root.push(s),s}get RelationshipCount(){return this.root.length-1}},SE=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}},pl=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{id:"w:id"})}},kE=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}},TE=class extends ue{constructor(e){super("w:commentRangeStart"),this.root.push(new pl({id:e}))}},AE=class extends ue{constructor(e){super("w:commentRangeEnd"),this.root.push(new pl({id:e}))}},OE=class extends ue{constructor(e){super("w:commentReference"),this.root.push(new pl({id:e}))}},ih=class extends ue{constructor({id:e,initials:t,author:n,date:i=new Date,children:s}){super("w:comment"),this.root.push(new SE({id:e,initials:t,author:n,date:i.toISOString()}));for(let a of s)this.root.push(a)}},sh=class extends ue{constructor({children:e}){super("w:comments"),ce(this,"relationships"),this.root.push(new kE({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(let t of e)this.root.push(new ih(t));this.relationships=new Dn}get Relationships(){return this.relationships}},NE=class extends ut{constructor(){super("w:noBreakHyphen")}},RE=class extends ut{constructor(){super("w:softHyphen")}},CE=class extends ut{constructor(){super("w:dayShort")}},IE=class extends ut{constructor(){super("w:monthShort")}},PE=class extends ut{constructor(){super("w:yearShort")}},DE=class extends ut{constructor(){super("w:dayLong")}},ME=class extends ut{constructor(){super("w:monthLong")}},LE=class extends ut{constructor(){super("w:yearLong")}},FE=class extends ut{constructor(){super("w:annotationRef")}},BE=class extends ut{constructor(){super("w:footnoteRef")}},UE=class extends ut{constructor(){super("w:endnoteRef")}},HE=class extends ut{constructor(){super("w:separator")}},zE=class extends ut{constructor(){super("w:continuationSeparator")}},jE=class extends ut{constructor(){super("w:pgNum")}},WE=class extends ut{constructor(){super("w:cr")}},qE=class extends ut{constructor(){super("w:tab")}},VE=class extends ut{constructor(){super("w:lastRenderedPageBreak")}},OY={LEFT:"left",CENTER:"center",RIGHT:"right"},NY={MARGIN:"margin",INDENT:"indent"},RY={NONE:"none",DOT:"dot",HYPHEN:"hyphen",UNDERSCORE:"underscore",MIDDLE_DOT:"middleDot"},KE=class extends ue{constructor(e){super("w:ptab"),this.root.push(new Xt({alignment:{key:"w:alignment",value:e.alignment},relativeTo:{key:"w:relativeTo",value:e.relativeTo},leader:{key:"w:leader",value:e.leader}}))}},$3={COLUMN:"column",PAGE:"page"},oh=class extends ue{constructor(e){super("w:br"),this.root.push(new Ve({type:e}))}},GE=class extends Pt{constructor(){super({}),this.root.push(new oh($3.PAGE))}},$E=class extends Pt{constructor(){super({}),this.root.push(new oh($3.COLUMN))}},ah=class extends ue{constructor(){super("w:pageBreakBefore")}},lh={AT_LEAST:"atLeast",EXACTLY:"exactly",EXACT:"exact",AUTO:"auto"},JE=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule",beforeAutoSpacing:"w:beforeAutospacing",afterAutoSpacing:"w:afterAutospacing"})}},uh=class extends ue{constructor(e){super("w:spacing"),this.root.push(new JE(e))}},CY={HEADING_1:"Heading1",HEADING_2:"Heading2",HEADING_3:"Heading3",HEADING_4:"Heading4",HEADING_5:"Heading5",HEADING_6:"Heading6",TITLE:"Title"},sl=class extends ue{constructor(e){super("w:pStyle"),this.root.push(new Ve({val:e}))}},ch=class extends ue{constructor(e){super("w:tabs");for(let t of e)this.root.push(new hh(t))}},XE={LEFT:"left",RIGHT:"right",CENTER:"center",BAR:"bar",CLEAR:"clear",DECIMAL:"decimal",END:"end",NUM:"num",START:"start"},IY={DOT:"dot",HYPHEN:"hyphen",MIDDLE_DOT:"middleDot",NONE:"none",UNDERSCORE:"underscore"},PY={MAX:9026},fh=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}},hh=class extends ue{constructor({type:e,position:t,leader:n}){super("w:tab"),this.root.push(new fh({val:e,pos:t,leader:n}))}},ao=class extends ue{constructor(e,t){super("w:numPr"),this.root.push(new YE(t)),this.root.push(new ZE(e))}},YE=class extends ue{constructor(e){if(super("w:ilvl"),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new Ve({val:e}))}},ZE=class extends ue{constructor(e){super("w:numId"),this.root.push(new Ve({val:typeof e=="string"?`{${e}}`:e}))}},Xi=class extends ue{constructor(){super(...arguments),ce(this,"fileChild",Symbol())}},QE=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}},DY={INTERNAL:"INTERNAL",EXTERNAL:"EXTERNAL"},si=class extends ue{constructor(e,t,n){super("w:hyperlink"),ce(this,"linkId"),this.linkId=t;let i={history:1,anchor:n||void 0,id:n?void 0:`rId${this.linkId}`},s=new QE(i);this.root.push(s),e.forEach(a=>{this.root.push(a)})}},eS=class extends si{constructor(e){super(e.children,Dl(),e.anchor)}},ml=class extends ue{constructor(e){super("w:externalHyperlink"),this.options=e}},tS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{id:"w:id",name:"w:name"})}},rS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{id:"w:id"})}},dh=class{constructor(e){ce(this,"bookmarkUniqueNumericId",I3()),ce(this,"start"),ce(this,"children"),ce(this,"end");let t=this.bookmarkUniqueNumericId();this.start=new ph(e.id,t),this.children=e.children,this.end=new mh(t)}},ph=class extends ue{constructor(e,t){super("w:bookmarkStart");let n=new tS({name:e,id:t});this.root.push(n)}},mh=class extends ue{constructor(e){super("w:bookmarkEnd");let t=new rS({id:e});this.root.push(t)}},gh=class extends ue{constructor(e){super("w:outlineLvl"),this.level=e,this.root.push(new Ve({val:e}))}},nS=class extends ue{constructor(e,t={}){super("w:instrText"),this.root.push(new Ht({space:Yt.PRESERVE}));let n=`PAGEREF ${e}`;t.hyperlink&&(n=`${n} \\h`),t.useRelativePosition&&(n=`${n} \\p`),this.root.push(n)}},iS=class extends Pt{constructor(e,t={}){super({children:[new lr(!0),new nS(e,t),new ur]})}},J3={TOP:"top",CENTER:"center",BOTTOM:"bottom"},X3=It(Te({},J3),{BOTH:"both"}),MY=X3,vh=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{verticalAlign:"w:val"})}},gl=class extends ue{constructor(e){super("w:vAlign"),this.root.push(new vh({verticalAlign:e}))}},yh=class extends ue{constructor({space:e,count:t,separate:n,equalWidth:i,children:s}){super("w:cols"),this.root.push(new Xt({space:{key:"w:space",value:e===void 0?void 0:lt(e)},count:{key:"w:num",value:t===void 0?void 0:vt(t)},separate:{key:"w:sep",value:n},equalWidth:{key:"w:equalWidth",value:i}})),!i&&s&&s.forEach(a=>this.addChildElement(a))}},LY={DEFAULT:"default",LINES:"lines",LINES_AND_CHARS:"linesAndChars",SNAP_TO_CHARS:"snapToChars"},Y3=({type:r,linePitch:e,charSpace:t})=>new ke({name:"w:docGrid",attributes:{type:{key:"w:type",value:r},linePitch:{key:"w:linePitch",value:vt(e)},charSpace:{key:"w:charSpace",value:t?vt(t):void 0}}}),Vi={DEFAULT:"default",FIRST:"first",EVEN:"even"},sS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{type:"w:type",id:"r:id"})}},oS={HEADER:"w:headerReference",FOOTER:"w:footerReference"},lo=class extends ue{constructor(e,t){super(e),this.root.push(new sS({type:t.type||Vi.DEFAULT,id:`rId${t.id}`}))}},FY={NEW_PAGE:"newPage",NEW_SECTION:"newSection",CONTINUOUS:"continuous"},Z3=({countBy:r,start:e,restart:t,distance:n})=>new ke({name:"w:lnNumType",attributes:{countBy:{key:"w:countBy",value:r===void 0?void 0:vt(r)},start:{key:"w:start",value:e===void 0?void 0:vt(e)},restart:{key:"w:restart",value:t},distance:{key:"w:distance",value:n===void 0?void 0:lt(n)}}}),BY={ALL_PAGES:"allPages",FIRST_PAGE:"firstPage",NOT_FIRST_PAGE:"notFirstPage"},UY={PAGE:"page",TEXT:"text"},HY={BACK:"back",FRONT:"front"},wh=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}},bh=class extends cr{constructor(e){if(super("w:pgBorders"),!e)return this;e.pageBorders?this.root.push(new wh({display:e.pageBorders.display,offsetFrom:e.pageBorders.offsetFrom,zOrder:e.pageBorders.zOrder})):this.root.push(new wh({})),e.pageBorderTop&&this.root.push(new Be("w:top",e.pageBorderTop)),e.pageBorderLeft&&this.root.push(new Be("w:left",e.pageBorderLeft)),e.pageBorderBottom&&this.root.push(new Be("w:bottom",e.pageBorderBottom)),e.pageBorderRight&&this.root.push(new Be("w:right",e.pageBorderRight))}},_h=class extends ue{constructor(e,t,n,i,s,a,o){super("w:pgMar"),this.root.push(new Xt({top:{key:"w:top",value:en(e)},right:{key:"w:right",value:lt(t)},bottom:{key:"w:bottom",value:en(n)},left:{key:"w:left",value:lt(i)},header:{key:"w:header",value:lt(s)},footer:{key:"w:footer",value:lt(a)},gutter:{key:"w:gutter",value:lt(o)}}))}},zY={HYPHEN:"hyphen",PERIOD:"period",COLON:"colon",EM_DASH:"emDash",EN_DASH:"endash"},xh=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}},Eh=class extends ue{constructor({start:e,formatType:t,separator:n}){super("w:pgNumType"),this.root.push(new xh({start:e===void 0?void 0:vt(e),formatType:t,separator:n}))}},Sh={PORTRAIT:"portrait",LANDSCAPE:"landscape"},Q3=({width:r,height:e,orientation:t,code:n})=>{let i=lt(r),s=lt(e);return new ke({name:"w:pgSz",attributes:{width:{key:"w:w",value:t===Sh.LANDSCAPE?s:i},height:{key:"w:h",value:t===Sh.LANDSCAPE?i:s},orientation:{key:"w:orient",value:t},code:{key:"w:code",value:n}}})},jY={LEFT_TO_RIGHT_TOP_TO_BOTTOM:"lrTb",TOP_TO_BOTTOM_RIGHT_TO_LEFT:"tbRl"},aS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{val:"w:val"})}},kh=class extends ue{constructor(e){super("w:textDirection"),this.root.push(new aS({val:e}))}},WY={NEXT_PAGE:"nextPage",NEXT_COLUMN:"nextColumn",CONTINUOUS:"continuous",EVEN_PAGE:"evenPage",ODD_PAGE:"oddPage"},Th=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{val:"w:val"})}},Ah=class extends ue{constructor(e){super("w:type"),this.root.push(new Th({val:e}))}},ri={TOP:1440,RIGHT:1440,BOTTOM:1440,LEFT:1440,HEADER:708,FOOTER:708,GUTTER:0},Ff={WIDTH:11906,HEIGHT:16838,ORIENTATION:Sh.PORTRAIT},Oh=class extends ue{constructor({page:{size:{width:e=Ff.WIDTH,height:t=Ff.HEIGHT,orientation:n=Ff.ORIENTATION}={},margin:{top:i=ri.TOP,right:s=ri.RIGHT,bottom:a=ri.BOTTOM,left:o=ri.LEFT,header:l=ri.HEADER,footer:u=ri.FOOTER,gutter:c=ri.GUTTER}={},pageNumbers:f={},borders:d,textDirection:h}={},grid:{linePitch:y=360,charSpace:v,type:x}={},headerWrapperGroup:m={},footerWrapperGroup:_={},lineNumbers:b,titlePage:w,verticalAlign:T,column:P,type:M}={}){super("w:sectPr"),this.addHeaderFooterGroup(oS.HEADER,m),this.addHeaderFooterGroup(oS.FOOTER,_),M&&this.root.push(new Ah(M)),this.root.push(Q3({width:e,height:t,orientation:n})),this.root.push(new _h(i,s,a,o,l,u,c)),d&&this.root.push(new bh(d)),b&&this.root.push(Z3(b)),this.root.push(new Eh(f)),P&&this.root.push(new yh(P)),T&&this.root.push(new gl(T)),w!==void 0&&this.root.push(new me("w:titlePg",w)),h&&this.root.push(new kh(h)),this.root.push(Y3({linePitch:y,charSpace:v,type:x}))}addHeaderFooterGroup(e,t){t.default&&this.root.push(new lo(e,{type:Vi.DEFAULT,id:t.default.View.ReferenceId})),t.first&&this.root.push(new lo(e,{type:Vi.FIRST,id:t.first.View.ReferenceId})),t.even&&this.root.push(new lo(e,{type:Vi.EVEN,id:t.even.View.ReferenceId}))}},Nh=class extends ue{constructor(){super("w:body"),ce(this,"sections",[])}addSection(e){let t=this.sections.pop();this.root.push(this.createSectionParagraph(t)),this.sections.push(new Oh(e))}prepForXml(e){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(e)}push(e){this.root.push(e)}createSectionParagraph(e){let t=new nn({}),n=new rn({});return n.push(e),t.addChildElement(n),t}},lS=class extends ue{constructor({width:e,space:t}){super("w:col"),this.root.push(new Xt({width:{key:"w:w",value:lt(e)},space:{key:"w:space",value:t===void 0?void 0:lt(t)}}))}},Rh={wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Yi=class extends we{constructor(e,t){super(Te({Ignorable:t},Object.fromEntries(e.map(n=>[n,Rh[n]])))),ce(this,"xmlKeys",Te({Ignorable:"mc:Ignorable"},Object.fromEntries(Object.keys(Rh).map(n=>[n,`xmlns:${n}`]))))}},Ch=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}},Ih=class extends ue{constructor(e){super("w:background"),this.root.push(new Ch({color:e.color===void 0?void 0:Gi(e.color),themeColor:e.themeColor,themeShade:e.themeShade===void 0?void 0:_x(e.themeShade),themeTint:e.themeTint===void 0?void 0:_x(e.themeTint)}))}},uS=class extends ue{constructor(e){super("w:document"),ce(this,"body"),this.root.push(new Yi(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps","cx","cx1","cx2","cx3","cx4","cx5","cx6","cx7","cx8","aink","am3d","w16cex","w16cid","w16","w16sdtdh","w16se"],"w14 w15 wp14")),this.body=new Nh,e.background&&this.root.push(new Ih(e.background)),this.root.push(this.body)}add(e){return this.body.push(e),this}get Body(){return this.body}},Ph=class{constructor(e){ce(this,"document"),ce(this,"relationships"),this.document=new uS(e),this.relationships=new Dn}get View(){return this.document}get Relationships(){return this.relationships}},cS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{val:"w:val"})}},fS=class extends ue{constructor(){super("w:wordWrap"),this.root.push(new cS({val:0}))}},qY={NONE:"none",DROP:"drop",MARGIN:"margin"},VY={MARGIN:"margin",PAGE:"page",TEXT:"text"},KY={AROUND:"around",AUTO:"auto",NONE:"none",NOT_BESIDE:"notBeside",THROUGH:"through",TIGHT:"tight"},e4=r=>{var e,t;return new ke({name:"w:framePr",attributes:{anchorLock:{key:"w:anchorLock",value:r.anchorLock},dropCap:{key:"w:dropCap",value:r.dropCap},width:{key:"w:w",value:r.width},height:{key:"w:h",value:r.height},x:{key:"w:x",value:r.position?r.position.x:void 0},y:{key:"w:y",value:r.position?r.position.y:void 0},anchorHorizontal:{key:"w:hAnchor",value:r.anchor.horizontal},anchorVertical:{key:"w:vAnchor",value:r.anchor.vertical},spaceHorizontal:{key:"w:hSpace",value:(e=r.space)==null?void 0:e.horizontal},spaceVertical:{key:"w:vSpace",value:(t=r.space)==null?void 0:t.vertical},rule:{key:"w:hRule",value:r.rule},alignmentX:{key:"w:xAlign",value:r.alignment?r.alignment.x:void 0},alignmentY:{key:"w:yAlign",value:r.alignment?r.alignment.y:void 0},lines:{key:"w:lines",value:r.lines},wrap:{key:"w:wrap",value:r.wrap}}})},rn=class extends cr{constructor(e){var t,n;if(super("w:pPr"),ce(this,"numberingReferences",[]),!e)return this;e.heading&&this.push(new sl(e.heading)),e.bullet&&this.push(new sl("ListParagraph")),e.numbering&&!e.style&&!e.heading&&(e.numbering.custom||this.push(new sl("ListParagraph"))),e.style&&this.push(new sl(e.style)),e.keepNext!==void 0&&this.push(new me("w:keepNext",e.keepNext)),e.keepLines!==void 0&&this.push(new me("w:keepLines",e.keepLines)),e.pageBreakBefore&&this.push(new ah),e.frame&&this.push(e4(e.frame)),e.widowControl!==void 0&&this.push(new me("w:widowControl",e.widowControl)),e.bullet&&this.push(new ao(1,e.bullet.level)),e.numbering?(this.numberingReferences.push({reference:e.numbering.reference,instance:(t=e.numbering.instance)!=null?t:0}),this.push(new ao(`${e.numbering.reference}-${(n=e.numbering.instance)!=null?n:0}`,e.numbering.level))):e.numbering===!1&&this.push(new ao(0,0)),e.border&&this.push(new Wf(e.border)),e.thematicBreak&&this.push(new qf),e.shading&&this.push(new $i(e.shading)),e.wordWrap&&this.push(new fS),e.overflowPunctuation&&this.push(new me("w:overflowPunct",e.overflowPunctuation));let i=[...e.rightTabStop!==void 0?[{type:XE.RIGHT,position:e.rightTabStop}]:[],...e.tabStops?e.tabStops:[],...e.leftTabStop!==void 0?[{type:XE.LEFT,position:e.leftTabStop}]:[]];i.length>0&&this.push(new ch(i)),e.bidirectional!==void 0&&this.push(new me("w:bidi",e.bidirectional)),e.spacing&&this.push(new uh(e.spacing)),e.indent&&this.push(new Vf(e.indent)),e.contextualSpacing!==void 0&&this.push(new me("w:contextualSpacing",e.contextualSpacing)),e.alignment&&this.push(new ll(e.alignment)),e.outlineLevel!==void 0&&this.push(new gh(e.outlineLevel)),e.suppressLineNumbers!==void 0&&this.push(new me("w:suppressLineNumbers",e.suppressLineNumbers)),e.autoSpaceEastAsianText!==void 0&&this.push(new me("w:autoSpaceDN",e.autoSpaceEastAsianText)),e.run&&this.push(new Ar(e.run))}push(e){this.root.push(e)}prepForXml(e){if(e.viewWrapper instanceof Ph)for(let t of this.numberingReferences)e.file.Numbering.createConcreteNumberingInstance(t.reference,t.instance);return super.prepForXml(e)}},nn=class extends Xi{constructor(e){if(super("w:p"),ce(this,"properties"),typeof e=="string")return this.properties=new rn({}),this.root.push(this.properties),this.root.push(new Ji(e)),this;if(this.properties=new rn(e),this.root.push(this.properties),e.text&&this.root.push(new Ji(e.text)),e.children)for(let t of e.children){if(t instanceof dh){this.root.push(t.start);for(let n of t.children)this.root.push(n);this.root.push(t.end);continue}this.root.push(t)}}prepForXml(e){for(let t of this.root)if(t instanceof ml){let n=this.root.indexOf(t),i=new si(t.options.children,Dl());e.viewWrapper.Relationships.createRelationship(i.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",t.options.link,G3.EXTERNAL),this.root[n]=i}return super.prepForXml(e)}addRunToFront(e){return this.root.splice(1,0,e),this}},GY=class extends ue{constructor(e){super("m:oMath");for(let t of e.children)this.root.push(t)}},hS=class extends ue{constructor(e){super("m:t"),this.root.push(e)}},dS=class extends ue{constructor(e){super("m:r"),this.root.push(new hS(e))}},Dh=class extends ue{constructor(e){super("m:den");for(let t of e)this.root.push(t)}},Mh=class extends ue{constructor(e){super("m:num");for(let t of e)this.root.push(t)}},pS=class extends ue{constructor(e){super("m:f"),this.root.push(new Mh(e.numerator)),this.root.push(new Dh(e.denominator))}},t4=({accent:r})=>new ke({name:"m:chr",attributes:{accent:{key:"m:val",value:r}}}),zt=({children:r})=>new ke({name:"m:e",children:r}),r4=({value:r})=>new ke({name:"m:limLoc",attributes:{value:{key:"m:val",value:r||"undOvr"}}}),$Y=()=>new ke({name:"m:subHide",attributes:{hide:{key:"m:val",value:1}}}),JY=()=>new ke({name:"m:supHide",attributes:{hide:{key:"m:val",value:1}}}),kT=({accent:r,hasSuperScript:e,hasSubScript:t,limitLocationVal:n})=>new ke({name:"m:naryPr",children:[...r?[t4({accent:r})]:[],r4({value:n}),...e?[]:[JY()],...t?[]:[$Y()]]}),mo=({children:r})=>new ke({name:"m:sub",children:r}),go=({children:r})=>new ke({name:"m:sup",children:r}),mS=class extends ue{constructor(e){super("m:nary"),this.root.push(kT({accent:"\u2211",hasSuperScript:!!e.superScript,hasSubScript:!!e.subScript})),e.subScript&&this.root.push(mo({children:e.subScript})),e.superScript&&this.root.push(go({children:e.superScript})),this.root.push(zt({children:e.children}))}},gS=class extends ue{constructor(e){super("m:nary"),this.root.push(kT({accent:"",hasSuperScript:!!e.superScript,hasSubScript:!!e.subScript,limitLocationVal:"subSup"})),e.subScript&&this.root.push(mo({children:e.subScript})),e.superScript&&this.root.push(go({children:e.superScript})),this.root.push(zt({children:e.children}))}},vl=class extends ue{constructor(e){super("m:lim");for(let t of e)this.root.push(t)}},vS=class extends ue{constructor(e){super("m:limUpp"),this.root.push(zt({children:e.children})),this.root.push(new vl(e.limit))}},yS=class extends ue{constructor(e){super("m:limLow"),this.root.push(zt({children:e.children})),this.root.push(new vl(e.limit))}},n4=()=>new ke({name:"m:sSupPr"}),wS=class extends ue{constructor(e){super("m:sSup"),this.root.push(n4()),this.root.push(zt({children:e.children})),this.root.push(go({children:e.superScript}))}},i4=()=>new ke({name:"m:sSubPr"}),bS=class extends ue{constructor(e){super("m:sSub"),this.root.push(i4()),this.root.push(zt({children:e.children})),this.root.push(mo({children:e.subScript}))}},s4=()=>new ke({name:"m:sSubSupPr"}),_S=class extends ue{constructor(e){super("m:sSubSup"),this.root.push(s4()),this.root.push(zt({children:e.children})),this.root.push(mo({children:e.subScript})),this.root.push(go({children:e.superScript}))}},o4=()=>new ke({name:"m:sPrePr"}),xS=class extends ke{constructor({children:e,subScript:t,superScript:n}){super({name:"m:sPre",children:[o4(),zt({children:e}),mo({children:t}),go({children:n})]})}},XY="",Lh=class extends ue{constructor(e){if(super("m:deg"),e)for(let t of e)this.root.push(t)}},ES=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{hide:"m:val"})}},SS=class extends ue{constructor(){super("m:degHide"),this.root.push(new ES({hide:1}))}},Fh=class extends ue{constructor(e){super("m:radPr"),e||this.root.push(new SS)}},kS=class extends ue{constructor(e){super("m:rad"),this.root.push(new Fh(!!e.degree)),this.root.push(new Lh(e.degree)),this.root.push(zt({children:e.children}))}},Bh=class extends ue{constructor(e){super("m:fName");for(let t of e)this.root.push(t)}},Uh=class extends ue{constructor(){super("m:funcPr")}},TS=class extends ue{constructor(e){super("m:func"),this.root.push(new Uh),this.root.push(new Bh(e.name)),this.root.push(zt({children:e.children}))}},YY=({character:r})=>new ke({name:"m:begChr",attributes:{character:{key:"m:val",value:r}}}),ZY=({character:r})=>new ke({name:"m:endChr",attributes:{character:{key:"m:val",value:r}}}),Td=({characters:r})=>new ke({name:"m:dPr",children:r?[YY({character:r.beginningCharacter}),ZY({character:r.endingCharacter})]:[]}),AS=class extends ue{constructor(e){super("m:d"),this.root.push(Td({})),this.root.push(zt({children:e.children}))}},OS=class extends ue{constructor(e){super("m:d"),this.root.push(Td({characters:{beginningCharacter:"[",endingCharacter:"]"}})),this.root.push(zt({children:e.children}))}},NS=class extends ue{constructor(e){super("m:d"),this.root.push(Td({characters:{beginningCharacter:"{",endingCharacter:"}"}})),this.root.push(zt({children:e.children}))}},RS=class extends ue{constructor(e){super("m:d"),this.root.push(Td({characters:{beginningCharacter:"\u2329",endingCharacter:"\u232A"}})),this.root.push(zt({children:e.children}))}},CS=class extends ue{constructor(e){super("w:tblGrid");for(let t of e)this.root.push(new IS(t))}},IS=class extends ue{constructor(e){super("w:gridCol"),e!==void 0&&this.root.push(new Xt({width:{key:"w:w",value:lt(e)}}))}},a4={TABLE:"w:tblCellMar",TABLE_CELL:"w:tcMar"},Hh=class extends cr{constructor(e,{marginUnitType:t=zh.DXA,top:n,left:i,bottom:s,right:a}){super(e),n!==void 0&&this.root.push(new tn("w:top",{type:t,size:n})),i!==void 0&&this.root.push(new tn("w:left",{type:t,size:i})),s!==void 0&&this.root.push(new tn("w:bottom",{type:t,size:s})),a!==void 0&&this.root.push(new tn("w:right",{type:t,size:a}))}},zh={AUTO:"auto",DXA:"dxa",NIL:"nil",PERCENTAGE:"pct"},tn=class extends ue{constructor(e,{type:t=zh.AUTO,size:n}){super(e);let i=n;t===zh.PERCENTAGE&&typeof n=="number"&&(i=`${n}%`),this.root.push(new Xt({type:{key:"w:type",value:t},size:{key:"w:w",value:_T(i)}}))}},jh=class extends cr{constructor(e){super("w:tcBorders"),e.top&&this.root.push(new Be("w:top",e.top)),e.start&&this.root.push(new Be("w:start",e.start)),e.left&&this.root.push(new Be("w:left",e.left)),e.bottom&&this.root.push(new Be("w:bottom",e.bottom)),e.end&&this.root.push(new Be("w:end",e.end)),e.right&&this.root.push(new Be("w:right",e.right))}},PS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{val:"w:val"})}},Wh=class extends ue{constructor(e){super("w:gridSpan"),this.root.push(new PS({val:vt(e)}))}},TT={CONTINUE:"continue",RESTART:"restart"},DS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{val:"w:val"})}},yl=class extends ue{constructor(e){super("w:vMerge"),this.root.push(new DS({val:e}))}},QY={BOTTOM_TO_TOP_LEFT_TO_RIGHT:"btLr",LEFT_TO_RIGHT_TOP_TO_BOTTOM:"lrTb",TOP_TO_BOTTOM_RIGHT_TO_LEFT:"tbRl"},MS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{val:"w:val"})}},qh=class extends ue{constructor(e){super("w:textDirection"),this.root.push(new MS({val:e}))}},LS=class extends cr{constructor(e){super("w:tcPr"),e.width&&this.root.push(new tn("w:tcW",e.width)),e.columnSpan&&this.root.push(new Wh(e.columnSpan)),e.verticalMerge?this.root.push(new yl(e.verticalMerge)):e.rowSpan&&e.rowSpan>1&&this.root.push(new yl(TT.RESTART)),e.borders&&this.root.push(new jh(e.borders)),e.shading&&this.root.push(new $i(e.shading)),e.margins&&this.root.push(new Hh(a4.TABLE_CELL,e.margins)),e.textDirection&&this.root.push(new qh(e.textDirection)),e.verticalAlign&&this.root.push(new gl(e.verticalAlign))}},wl=class extends ue{constructor(e){super("w:tc"),this.options=e,this.root.push(new LS(e));for(let t of e.children)this.root.push(t)}prepForXml(e){return this.root[this.root.length-1]instanceof nn||this.root.push(new nn({})),super.prepForXml(e)}},Qs={style:kd.NONE,size:0,color:"auto"},eo={style:kd.SINGLE,size:4,color:"auto"},bl=class extends ue{constructor(e){super("w:tblBorders"),e.top?this.root.push(new Be("w:top",e.top)):this.root.push(new Be("w:top",eo)),e.left?this.root.push(new Be("w:left",e.left)):this.root.push(new Be("w:left",eo)),e.bottom?this.root.push(new Be("w:bottom",e.bottom)):this.root.push(new Be("w:bottom",eo)),e.right?this.root.push(new Be("w:right",e.right)):this.root.push(new Be("w:right",eo)),e.insideHorizontal?this.root.push(new Be("w:insideH",e.insideHorizontal)):this.root.push(new Be("w:insideH",eo)),e.insideVertical?this.root.push(new Be("w:insideV",e.insideVertical)):this.root.push(new Be("w:insideV",eo))}};ce(bl,"NONE",{top:Qs,bottom:Qs,left:Qs,right:Qs,insideHorizontal:Qs,insideVertical:Qs});var eZ={MARGIN:"margin",PAGE:"page",TEXT:"text"},tZ={CENTER:"center",INSIDE:"inside",LEFT:"left",OUTSIDE:"outside",RIGHT:"right"},rZ={CENTER:"center",INSIDE:"inside",BOTTOM:"bottom",OUTSIDE:"outside",INLINE:"inline",TOP:"top"},nZ={NEVER:"never",OVERLAP:"overlap"},Vh=class extends ue{constructor({horizontalAnchor:e,verticalAnchor:t,absoluteHorizontalPosition:n,relativeHorizontalPosition:i,absoluteVerticalPosition:s,relativeVerticalPosition:a,bottomFromText:o,topFromText:l,leftFromText:u,rightFromText:c,overlap:f}){super("w:tblpPr"),this.root.push(new Xt({leftFromText:{key:"w:leftFromText",value:u===void 0?void 0:lt(u)},rightFromText:{key:"w:rightFromText",value:c===void 0?void 0:lt(c)},topFromText:{key:"w:topFromText",value:l===void 0?void 0:lt(l)},bottomFromText:{key:"w:bottomFromText",value:o===void 0?void 0:lt(o)},absoluteHorizontalPosition:{key:"w:tblpX",value:n===void 0?void 0:en(n)},absoluteVerticalPosition:{key:"w:tblpY",value:s===void 0?void 0:en(s)},horizontalAnchor:{key:"w:horzAnchor",value:e===void 0?void 0:e},relativeHorizontalPosition:{key:"w:tblpXSpec",value:i},relativeVerticalPosition:{key:"w:tblpYSpec",value:a},verticalAnchor:{key:"w:vertAnchor",value:t}})),f&&this.root.push(new zf("w:tblOverlap",f))}},iZ={AUTOFIT:"autofit",FIXED:"fixed"},FS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{type:"w:type"})}},Kh=class extends ue{constructor(e){super("w:tblLayout"),this.root.push(new FS({type:e}))}},sZ={DXA:"dxa"},Gh=class extends ue{constructor({type:e=sZ.DXA,value:t}){super("w:tblCellSpacing"),this.root.push(new Xt({type:{key:"w:type",value:e},value:{key:"w:w",value:_T(t)}}))}},$h=class extends cr{constructor(e){super("w:tblPr"),e.style&&this.root.push(new Tr("w:tblStyle",e.style)),e.float&&this.root.push(new Vh(e.float)),e.visuallyRightToLeft!==void 0&&this.root.push(new me("w:bidiVisual",e.visuallyRightToLeft)),e.width&&this.root.push(new tn("w:tblW",e.width)),e.alignment&&this.root.push(new ll(e.alignment)),e.indent&&this.root.push(new tn("w:tblInd",e.indent)),e.borders&&this.root.push(new bl(e.borders)),e.shading&&this.root.push(new $i(e.shading)),e.layout&&this.root.push(new Kh(e.layout)),e.cellMargin&&this.root.push(new Hh(a4.TABLE,e.cellMargin)),e.cellSpacing&&this.root.push(new Gh(e.cellSpacing))}},BS=class extends Xi{constructor({rows:e,width:t,columnWidths:n=Array(Math.max(...e.map(h=>h.CellCount))).fill(100),margins:i,indent:s,float:a,layout:o,style:l,borders:u,alignment:c,visuallyRightToLeft:f,cellSpacing:d}){super("w:tbl"),this.root.push(new $h({borders:u??{},width:t??{size:100},indent:s,float:a,layout:o,style:l,alignment:c,cellMargin:i,visuallyRightToLeft:f,cellSpacing:d})),this.root.push(new CS(n));for(let h of e)this.root.push(h);e.forEach((h,y)=>{if(y===e.length-1)return;let v=0;h.cells.forEach(x=>{if(x.options.rowSpan&&x.options.rowSpan>1){let m=new wl({rowSpan:x.options.rowSpan-1,columnSpan:x.options.columnSpan,borders:x.options.borders,children:[],verticalMerge:TT.CONTINUE});e[y+1].addCellToColumnIndex(m,v)}v+=x.options.columnSpan||1})})}},oZ={AUTO:"auto",ATLEAST:"atLeast",EXACT:"exact"},Jh=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{value:"w:val",rule:"w:hRule"})}},Xh=class extends ue{constructor(e,t){super("w:trHeight"),this.root.push(new Jh({value:lt(e),rule:t}))}},Yh=class extends cr{constructor(e){super("w:trPr"),e.cantSplit!==void 0&&this.root.push(new me("w:cantSplit",e.cantSplit)),e.tableHeader!==void 0&&this.root.push(new me("w:tblHeader",e.tableHeader)),e.height&&this.root.push(new Xh(e.height.value,e.height.rule)),e.cellSpacing&&this.root.push(new Gh(e.cellSpacing))}},US=class extends ue{constructor(e){super("w:tr"),this.options=e,this.root.push(new Yh(e));for(let t of e.children)this.root.push(t)}get CellCount(){return this.options.children.length}get cells(){return this.root.filter(e=>e instanceof wl)}addCellToIndex(e,t){this.root.splice(t+1,0,e)}addCellToColumnIndex(e,t){let n=this.columnIndexToRootIndex(t,!0);this.addCellToIndex(e,n-1)}rootIndexToColumnIndex(e){if(e<1||e>=this.root.length)throw new Error(`cell 'rootIndex' should between 1 to ${this.root.length-1}`);let t=0;for(let n=1;n<e;n++){let i=this.root[n];t+=i.options.columnSpan||1}return t}columnIndexToRootIndex(e,t=!1){if(e<0)throw new Error("cell 'columnIndex' should not less than zero");let n=0,i=1;for(;n<=e;){if(i>=this.root.length){if(t)return this.root.length;throw new Error(`cell 'columnIndex' should not great than ${n-1}`)}let s=this.root[i];i+=1,n+=s&&s.options.columnSpan||1}return i-1}},HS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}},zS=class extends ue{constructor(){super("Properties"),this.root.push(new HS({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}},jS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{xmlns:"xmlns"})}},WS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}},Sr=class extends ue{constructor(e,t){super("Default"),this.root.push(new WS({contentType:e,extension:t}))}},qS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}},Jt=class extends ue{constructor(e,t){super("Override"),this.root.push(new qS({contentType:e,partName:t}))}},VS=class extends ue{constructor(){super("Types"),this.root.push(new jS({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new Sr("image/png","png")),this.root.push(new Sr("image/jpeg","jpeg")),this.root.push(new Sr("image/jpeg","jpg")),this.root.push(new Sr("image/bmp","bmp")),this.root.push(new Sr("image/gif","gif")),this.root.push(new Sr("image/svg+xml","svg")),this.root.push(new Sr("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new Sr("application/xml","xml")),this.root.push(new Sr("application/vnd.openxmlformats-officedocument.obfuscatedFont","odttf")),this.root.push(new Jt("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new Jt("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new Jt("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new Jt("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new Jt("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new Jt("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new Jt("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new Jt("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new Jt("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),this.root.push(new Jt("application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml","/word/fontTable.xml"))}addFooter(e){this.root.push(new Jt("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${e}.xml`))}addHeader(e){this.root.push(new Jt("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${e}.xml`))}},KS=class extends ue{constructor(e){super("cp:coreProperties"),this.root.push(new Yi(["cp","dc","dcterms","dcmitype","xsi"])),e.title&&this.root.push(new Zr("dc:title",e.title)),e.subject&&this.root.push(new Zr("dc:subject",e.subject)),e.creator&&this.root.push(new Zr("dc:creator",e.creator)),e.keywords&&this.root.push(new Zr("cp:keywords",e.keywords)),e.description&&this.root.push(new Zr("dc:description",e.description)),e.lastModifiedBy&&this.root.push(new Zr("cp:lastModifiedBy",e.lastModifiedBy)),e.revision&&this.root.push(new Zr("cp:revision",String(e.revision))),this.root.push(new Zh("dcterms:created")),this.root.push(new Zh("dcterms:modified"))}},GS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{type:"xsi:type"})}},Zh=class extends ue{constructor(e){super(e),this.root.push(new GS({type:"dcterms:W3CDTF"})),this.root.push(E3(new Date))}},$S=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}},JS=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{fmtid:"fmtid",pid:"pid",name:"name"})}},XS=class extends ue{constructor(e,t){super("property"),this.root.push(new JS({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e.toString(),name:t.name})),this.root.push(new YS(t.value))}},YS=class extends ue{constructor(e){super("vt:lpwstr"),this.root.push(e)}},ZS=class extends ue{constructor(e){super("Properties"),ce(this,"nextId"),ce(this,"properties",[]),this.root.push(new $S({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(let t of e)this.addCustomProperty(t)}prepForXml(e){return this.properties.forEach(t=>this.root.push(t)),super.prepForXml(e)}addCustomProperty(e){this.properties.push(new XS(this.nextId++,e))}},aZ={ANSI:"00",DEFAULT:"01",SYMBOL:"02",MAC:"4D",JIS:"80",HANGUL:"81",JOHAB:"82",GB_2312:"86",CHINESEBIG5:"88",GREEK:"A1",TURKISH:"A2",VIETNAMESE:"A3",HEBREW:"B1",ARABIC:"B2",BALTIC:"BA",RUSSIAN:"CC",THAI:"DE",EASTEUROPE:"EE",OEM:"FF"},Df=({id:r,fontKey:e,subsetted:t},n)=>new ke({name:n,attributes:Te({id:{key:"r:id",value:r}},e?{fontKey:{key:"w:fontKey",value:`{${e}}`}}:{}),children:[...t?[new me("w:subsetted",t)]:[]]}),lZ=({name:r,altName:e,panose1:t,charset:n,family:i,notTrueType:s,pitch:a,sig:o,embedRegular:l,embedBold:u,embedItalic:c,embedBoldItalic:f})=>new ke({name:"w:font",attributes:{name:{key:"w:name",value:r}},children:[...e?[ro("w:altName",e)]:[],...t?[ro("w:panose1",t)]:[],...n?[ro("w:charset",n)]:[],ro("w:family",i),...s?[new me("w:notTrueType",s)]:[],ro("w:pitch",a),...o?[new ke({name:"w:sig",attributes:{usb0:{key:"w:usb0",value:o.usb0},usb1:{key:"w:usb1",value:o.usb1},usb2:{key:"w:usb2",value:o.usb2},usb3:{key:"w:usb3",value:o.usb3},csb0:{key:"w:csb0",value:o.csb0},csb1:{key:"w:csb1",value:o.csb1}}})]:[],...l?[Df(l,"w:embedRegular")]:[],...u?[Df(u,"w:embedBold")]:[],...c?[Df(c,"w:embedItalic")]:[],...f?[Df(f,"w:embedBoldItalic")]:[]]}),uZ=({name:r,index:e,fontKey:t,characterSet:n})=>lZ({name:r,sig:{usb0:"E0002AFF",usb1:"C000247B",usb2:"00000009",usb3:"00000000",csb0:"000001FF",csb1:"00000000"},charset:n,family:"auto",pitch:"variable",embedRegular:{fontKey:t,id:`rId${e}`}}),cZ=r=>new ke({name:"w:fonts",attributes:{mc:{key:"xmlns:mc",value:"http://schemas.openxmlformats.org/markup-compatibility/2006"},r:{key:"xmlns:r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"},w:{key:"xmlns:w",value:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},w14:{key:"xmlns:w14",value:"http://schemas.microsoft.com/office/word/2010/wordml"},w15:{key:"xmlns:w15",value:"http://schemas.microsoft.com/office/word/2012/wordml"},w16cex:{key:"xmlns:w16cex",value:"http://schemas.microsoft.com/office/word/2018/wordml/cex"},w16cid:{key:"xmlns:w16cid",value:"http://schemas.microsoft.com/office/word/2016/wordml/cid"},w16:{key:"xmlns:w16",value:"http://schemas.microsoft.com/office/word/2018/wordml"},w16sdtdh:{key:"xmlns:w16sdtdh",value:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash"},w16se:{key:"xmlns:w16se",value:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ignorable:{key:"mc:Ignorable",value:"w14 w15 w16se w16cid w16 w16cex w16sdtdh"}},children:r.map((e,t)=>uZ({name:e.name,index:t+1,fontKey:e.fontKey}))}),QS=class{constructor(e){ce(this,"fontTable"),ce(this,"relationships"),ce(this,"fontOptionsWithKey",[]),this.options=e,this.fontOptionsWithKey=e.map(t=>It(Te({},t),{fontKey:P3()})),this.fontTable=cZ(this.fontOptionsWithKey),this.relationships=new Dn;for(let t=0;t<e.length;t++)this.relationships.createRelationship(t+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",`fonts/${e[t].name}.odttf`)}get View(){return this.fontTable}get Relationships(){return this.relationships}},ek=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}},fZ=class extends al{constructor(e,t){super("w:ftr",t),ce(this,"refId"),this.refId=e,t||this.root.push(new ek({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}},Qh=class{constructor(e,t,n){ce(this,"footer"),ce(this,"relationships"),this.media=e,this.footer=new fZ(t,n),this.relationships=new Dn}add(e){this.footer.add(e)}addChildElement(e){this.footer.addChildElement(e)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}},tk=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{type:"w:type",id:"w:id"})}},rk=class extends ue{constructor(){super("w:footnoteRef")}},nk=class extends Pt{constructor(){super({style:"FootnoteReference"}),this.root.push(new rk)}},FL={SEPERATOR:"separator",CONTINUATION_SEPERATOR:"continuationSeparator"},ol=class extends ue{constructor(e){super("w:footnote"),this.root.push(new tk({type:e.type,id:e.id}));for(let t=0;t<e.children.length;t++){let n=e.children[t];t===0&&n.addRunToFront(new nk),this.root.push(n)}}},ik=class extends ue{constructor(){super("w:continuationSeparator")}},sk=class extends Pt{constructor(){super({}),this.root.push(new ik)}},ok=class extends ue{constructor(){super("w:separator")}},ak=class extends Pt{constructor(){super({}),this.root.push(new ok)}},lk=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}},ed=class extends ue{constructor(){super("w:footnotes"),this.root.push(new lk({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));let e=new ol({id:-1,type:FL.SEPERATOR,children:[new nn({spacing:{after:0,line:240,lineRule:lh.AUTO},children:[new ak]})]});this.root.push(e);let t=new ol({id:0,type:FL.CONTINUATION_SEPERATOR,children:[new nn({spacing:{after:0,line:240,lineRule:lh.AUTO},children:[new sk]})]});this.root.push(t)}createFootNote(e,t){let n=new ol({id:e,children:t});this.root.push(n)}},uk=class{constructor(){ce(this,"footnotess"),ce(this,"relationships"),this.footnotess=new ed,this.relationships=new Dn}get View(){return this.footnotess}get Relationships(){return this.relationships}},ck=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}},hZ=class extends al{constructor(e,t){super("w:hdr",t),ce(this,"refId"),this.refId=e,t||this.root.push(new ck({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}},td=class{constructor(e,t,n){ce(this,"header"),ce(this,"relationships"),this.media=e,this.header=new hZ(t,n),this.relationships=new Dn}add(e){return this.header.add(e),this}addChildElement(e){this.header.addChildElement(e)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}},_l=class{constructor(){ce(this,"map"),this.map=new Map}addImage(e,t){this.map.set(e,t)}get Array(){return Array.from(this.map.values())}},dZ="",Jr={DECIMAL:"decimal",UPPER_ROMAN:"upperRoman",LOWER_ROMAN:"lowerRoman",UPPER_LETTER:"upperLetter",LOWER_LETTER:"lowerLetter",ORDINAL:"ordinal",CARDINAL_TEXT:"cardinalText",ORDINAL_TEXT:"ordinalText",HEX:"hex",CHICAGO:"chicago",IDEOGRAPH__DIGITAL:"ideographDigital",JAPANESE_COUNTING:"japaneseCounting",AIUEO:"aiueo",IROHA:"iroha",DECIMAL_FULL_WIDTH:"decimalFullWidth",DECIMAL_HALF_WIDTH:"decimalHalfWidth",JAPANESE_LEGAL:"japaneseLegal",JAPANESE_DIGITAL_TEN_THOUSAND:"japaneseDigitalTenThousand",DECIMAL_ENCLOSED_CIRCLE:"decimalEnclosedCircle",DECIMAL_FULL_WIDTH2:"decimalFullWidth2",AIUEO_FULL_WIDTH:"aiueoFullWidth",IROHA_FULL_WIDTH:"irohaFullWidth",DECIMAL_ZERO:"decimalZero",BULLET:"bullet",GANADA:"ganada",CHOSUNG:"chosung",DECIMAL_ENCLOSED_FULLSTOP:"decimalEnclosedFullstop",DECIMAL_ENCLOSED_PARENTHESES:"decimalEnclosedParen",DECIMAL_ENCLOSED_CIRCLE_CHINESE:"decimalEnclosedCircleChinese",IDEOGRAPH_ENCLOSED_CIRCLE:"ideographEnclosedCircle",IDEOGRAPH_TRADITIONAL:"ideographTraditional",IDEOGRAPH_ZODIAC:"ideographZodiac",IDEOGRAPH_ZODIAC_TRADITIONAL:"ideographZodiacTraditional",TAIWANESE_COUNTING:"taiwaneseCounting",IDEOGRAPH_LEGAL_TRADITIONAL:"ideographLegalTraditional",TAIWANESE_COUNTING_THOUSAND:"taiwaneseCountingThousand",TAIWANESE_DIGITAL:"taiwaneseDigital",CHINESE_COUNTING:"chineseCounting",CHINESE_LEGAL_SIMPLIFIED:"chineseLegalSimplified",CHINESE_COUNTING_THOUSAND:"chineseCountingThousand",KOREAN_DIGITAL:"koreanDigital",KOREAN_COUNTING:"koreanCounting",KOREAN_LEGAL:"koreanLegal",KOREAN_DIGITAL2:"koreanDigital2",VIETNAMESE_COUNTING:"vietnameseCounting",RUSSIAN_LOWER:"russianLower",RUSSIAN_UPPER:"russianUpper",NONE:"none",NUMBER_IN_DASH:"numberInDash",HEBREW1:"hebrew1",HEBREW2:"hebrew2",ARABIC_ALPHA:"arabicAlpha",ARABIC_ABJAD:"arabicAbjad",HINDI_VOWELS:"hindiVowels",HINDI_CONSONANTS:"hindiConsonants",HINDI_NUMBERS:"hindiNumbers",HINDI_COUNTING:"hindiCounting",THAI_LETTERS:"thaiLetters",THAI_NUMBERS:"thaiNumbers",THAI_COUNTING:"thaiCounting",BAHT_TEXT:"bahtText",DOLLAR_TEXT:"dollarText",CUSTOM:"custom"},fk=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}},hk=class extends ue{constructor(e){super("w:numFmt"),this.root.push(new Ve({val:e}))}},dk=class extends ue{constructor(e){super("w:lvlText"),this.root.push(new Ve({val:e}))}},pk=class extends ue{constructor(e){super("w:lvlJc"),this.root.push(new Ve({val:e}))}},pZ={NOTHING:"nothing",SPACE:"space",TAB:"tab"},mk=class extends ue{constructor(e){super("w:suff"),this.root.push(new Ve({val:e}))}},gk=class extends ue{constructor(){super("w:isLgl")}},xl=class extends ue{constructor({level:e,format:t,text:n,alignment:i=Er.START,start:s=1,style:a,suffix:o,isLegalNumberingStyle:l}){if(super("w:lvl"),ce(this,"paragraphProperties"),ce(this,"runProperties"),this.root.push(new ii("w:start",vt(s))),t&&this.root.push(new hk(t)),o&&this.root.push(new mk(o)),l&&this.root.push(new gk),n&&this.root.push(new dk(n)),this.root.push(new pk(i)),this.paragraphProperties=new rn(a&&a.paragraph),this.runProperties=new Ar(a&&a.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new fk({ilvl:vt(e),tentative:1}))}},rd=class extends xl{},vk=class extends xl{},yk=class extends ue{constructor(e){super("w:multiLevelType"),this.root.push(new Ve({val:e}))}},wk=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}},El=class extends ue{constructor(e,t){super("w:abstractNum"),ce(this,"id"),this.root.push(new wk({abstractNumId:vt(e),restartNumberingAfterBreak:0})),this.root.push(new yk("hybridMultilevel")),this.id=e;for(let n of t)this.root.push(new rd(n))}},bk=class extends ue{constructor(e){super("w:abstractNumId"),this.root.push(new Ve({val:e}))}},_k=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{numId:"w:numId"})}},Sl=class extends ue{constructor(e){if(super("w:num"),ce(this,"numId"),ce(this,"reference"),ce(this,"instance"),this.numId=e.numId,this.reference=e.reference,this.instance=e.instance,this.root.push(new _k({numId:vt(e.numId)})),this.root.push(new bk(vt(e.abstractNumId))),e.overrideLevels&&e.overrideLevels.length)for(let t of e.overrideLevels)this.root.push(new nd(t.num,t.start))}},xk=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{ilvl:"w:ilvl"})}},nd=class extends ue{constructor(e,t){super("w:lvlOverride"),this.root.push(new xk({ilvl:e})),t!==void 0&&this.root.push(new Sk(t))}},Ek=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{val:"w:val"})}},Sk=class extends ue{constructor(e){super("w:startOverride"),this.root.push(new Ek({val:e}))}},id=class extends ue{constructor(e){super("w:numbering"),ce(this,"abstractNumberingMap",new Map),ce(this,"concreteNumberingMap",new Map),ce(this,"referenceConfigMap",new Map),ce(this,"abstractNumUniqueNumericId",N3()),ce(this,"concreteNumUniqueNumericId",R3()),this.root.push(new Yi(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps"],"w14 w15 wp14"));let t=new El(this.abstractNumUniqueNumericId(),[{level:0,format:Jr.BULLET,text:"\u25CF",alignment:Er.LEFT,style:{paragraph:{indent:{left:ar(.5),hanging:ar(.25)}}}},{level:1,format:Jr.BULLET,text:"\u25CB",alignment:Er.LEFT,style:{paragraph:{indent:{left:ar(1),hanging:ar(.25)}}}},{level:2,format:Jr.BULLET,text:"\u25A0",alignment:Er.LEFT,style:{paragraph:{indent:{left:2160,hanging:ar(.25)}}}},{level:3,format:Jr.BULLET,text:"\u25CF",alignment:Er.LEFT,style:{paragraph:{indent:{left:2880,hanging:ar(.25)}}}},{level:4,format:Jr.BULLET,text:"\u25CB",alignment:Er.LEFT,style:{paragraph:{indent:{left:3600,hanging:ar(.25)}}}},{level:5,format:Jr.BULLET,text:"\u25A0",alignment:Er.LEFT,style:{paragraph:{indent:{left:4320,hanging:ar(.25)}}}},{level:6,format:Jr.BULLET,text:"\u25CF",alignment:Er.LEFT,style:{paragraph:{indent:{left:5040,hanging:ar(.25)}}}},{level:7,format:Jr.BULLET,text:"\u25CF",alignment:Er.LEFT,style:{paragraph:{indent:{left:5760,hanging:ar(.25)}}}},{level:8,format:Jr.BULLET,text:"\u25CF",alignment:Er.LEFT,style:{paragraph:{indent:{left:6480,hanging:ar(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new Sl({numId:1,abstractNumId:t.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",t);for(let n of e.config)this.abstractNumberingMap.set(n.reference,new El(this.abstractNumUniqueNumericId(),n.levels)),this.referenceConfigMap.set(n.reference,n.levels)}prepForXml(e){for(let t of this.abstractNumberingMap.values())this.root.push(t);for(let t of this.concreteNumberingMap.values())this.root.push(t);return super.prepForXml(e)}createConcreteNumberingInstance(e,t){let n=this.abstractNumberingMap.get(e);if(!n)return;let i=`${e}-${t}`;if(this.concreteNumberingMap.has(i))return;let s=this.referenceConfigMap.get(e),a=s&&s[0].start,o={numId:this.concreteNumUniqueNumericId(),abstractNumId:n.id,reference:e,instance:t,overrideLevels:[a&&Number.isInteger(a)?{num:0,start:a}:{num:0,start:1}]};this.concreteNumberingMap.set(i,new Sl(o))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}},kk=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}},Tk=class extends ue{constructor(e){super("w:compatSetting"),this.root.push(new kk({version:e,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}},Ak=class extends ue{constructor(e){super("w:compat"),e.version&&this.root.push(new Tk(e.version)),e.useSingleBorderforContiguousCells&&this.root.push(new me("w:useSingleBorderforContiguousCells",e.useSingleBorderforContiguousCells)),e.wordPerfectJustification&&this.root.push(new me("w:wpJustification",e.wordPerfectJustification)),e.noTabStopForHangingIndent&&this.root.push(new me("w:noTabHangInd",e.noTabStopForHangingIndent)),e.noLeading&&this.root.push(new me("w:noLeading",e.noLeading)),e.spaceForUnderline&&this.root.push(new me("w:spaceForUL",e.spaceForUnderline)),e.noColumnBalance&&this.root.push(new me("w:noColumnBalance",e.noColumnBalance)),e.balanceSingleByteDoubleByteWidth&&this.root.push(new me("w:balanceSingleByteDoubleByteWidth",e.balanceSingleByteDoubleByteWidth)),e.noExtraLineSpacing&&this.root.push(new me("w:noExtraLineSpacing",e.noExtraLineSpacing)),e.doNotLeaveBackslashAlone&&this.root.push(new me("w:doNotLeaveBackslashAlone",e.doNotLeaveBackslashAlone)),e.underlineTrailingSpaces&&this.root.push(new me("w:ulTrailSpace",e.underlineTrailingSpaces)),e.doNotExpandShiftReturn&&this.root.push(new me("w:doNotExpandShiftReturn",e.doNotExpandShiftReturn)),e.spacingInWholePoints&&this.root.push(new me("w:spacingInWholePoints",e.spacingInWholePoints)),e.lineWrapLikeWord6&&this.root.push(new me("w:lineWrapLikeWord6",e.lineWrapLikeWord6)),e.printBodyTextBeforeHeader&&this.root.push(new me("w:printBodyTextBeforeHeader",e.printBodyTextBeforeHeader)),e.printColorsBlack&&this.root.push(new me("w:printColBlack",e.printColorsBlack)),e.spaceWidth&&this.root.push(new me("w:wpSpaceWidth",e.spaceWidth)),e.showBreaksInFrames&&this.root.push(new me("w:showBreaksInFrames",e.showBreaksInFrames)),e.subFontBySize&&this.root.push(new me("w:subFontBySize",e.subFontBySize)),e.suppressBottomSpacing&&this.root.push(new me("w:suppressBottomSpacing",e.suppressBottomSpacing)),e.suppressTopSpacing&&this.root.push(new me("w:suppressTopSpacing",e.suppressTopSpacing)),e.suppressSpacingAtTopOfPage&&this.root.push(new me("w:suppressSpacingAtTopOfPage",e.suppressSpacingAtTopOfPage)),e.suppressTopSpacingWP&&this.root.push(new me("w:suppressTopSpacingWP",e.suppressTopSpacingWP)),e.suppressSpBfAfterPgBrk&&this.root.push(new me("w:suppressSpBfAfterPgBrk",e.suppressSpBfAfterPgBrk)),e.swapBordersFacingPages&&this.root.push(new me("w:swapBordersFacingPages",e.swapBordersFacingPages)),e.convertMailMergeEsc&&this.root.push(new me("w:convMailMergeEsc",e.convertMailMergeEsc)),e.truncateFontHeightsLikeWP6&&this.root.push(new me("w:truncateFontHeightsLikeWP6",e.truncateFontHeightsLikeWP6)),e.macWordSmallCaps&&this.root.push(new me("w:mwSmallCaps",e.macWordSmallCaps)),e.usePrinterMetrics&&this.root.push(new me("w:usePrinterMetrics",e.usePrinterMetrics)),e.doNotSuppressParagraphBorders&&this.root.push(new me("w:doNotSuppressParagraphBorders",e.doNotSuppressParagraphBorders)),e.wrapTrailSpaces&&this.root.push(new me("w:wrapTrailSpaces",e.wrapTrailSpaces)),e.footnoteLayoutLikeWW8&&this.root.push(new me("w:footnoteLayoutLikeWW8",e.footnoteLayoutLikeWW8)),e.shapeLayoutLikeWW8&&this.root.push(new me("w:shapeLayoutLikeWW8",e.shapeLayoutLikeWW8)),e.alignTablesRowByRow&&this.root.push(new me("w:alignTablesRowByRow",e.alignTablesRowByRow)),e.forgetLastTabAlignment&&this.root.push(new me("w:forgetLastTabAlignment",e.forgetLastTabAlignment)),e.adjustLineHeightInTable&&this.root.push(new me("w:adjustLineHeightInTable",e.adjustLineHeightInTable)),e.autoSpaceLikeWord95&&this.root.push(new me("w:autoSpaceLikeWord95",e.autoSpaceLikeWord95)),e.noSpaceRaiseLower&&this.root.push(new me("w:noSpaceRaiseLower",e.noSpaceRaiseLower)),e.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new me("w:doNotUseHTMLParagraphAutoSpacing",e.doNotUseHTMLParagraphAutoSpacing)),e.layoutRawTableWidth&&this.root.push(new me("w:layoutRawTableWidth",e.layoutRawTableWidth)),e.layoutTableRowsApart&&this.root.push(new me("w:layoutTableRowsApart",e.layoutTableRowsApart)),e.useWord97LineBreakRules&&this.root.push(new me("w:useWord97LineBreakRules",e.useWord97LineBreakRules)),e.doNotBreakWrappedTables&&this.root.push(new me("w:doNotBreakWrappedTables",e.doNotBreakWrappedTables)),e.doNotSnapToGridInCell&&this.root.push(new me("w:doNotSnapToGridInCell",e.doNotSnapToGridInCell)),e.selectFieldWithFirstOrLastCharacter&&this.root.push(new me("w:selectFldWithFirstOrLastChar",e.selectFieldWithFirstOrLastCharacter)),e.applyBreakingRules&&this.root.push(new me("w:applyBreakingRules",e.applyBreakingRules)),e.doNotWrapTextWithPunctuation&&this.root.push(new me("w:doNotWrapTextWithPunct",e.doNotWrapTextWithPunctuation)),e.doNotUseEastAsianBreakRules&&this.root.push(new me("w:doNotUseEastAsianBreakRules",e.doNotUseEastAsianBreakRules)),e.useWord2002TableStyleRules&&this.root.push(new me("w:useWord2002TableStyleRules",e.useWord2002TableStyleRules)),e.growAutofit&&this.root.push(new me("w:growAutofit",e.growAutofit)),e.useFELayout&&this.root.push(new me("w:useFELayout",e.useFELayout)),e.useNormalStyleForList&&this.root.push(new me("w:useNormalStyleForList",e.useNormalStyleForList)),e.doNotUseIndentAsNumberingTabStop&&this.root.push(new me("w:doNotUseIndentAsNumberingTabStop",e.doNotUseIndentAsNumberingTabStop)),e.useAlternateEastAsianLineBreakRules&&this.root.push(new me("w:useAltKinsokuLineBreakRules",e.useAlternateEastAsianLineBreakRules)),e.allowSpaceOfSameStyleInTable&&this.root.push(new me("w:allowSpaceOfSameStyleInTable",e.allowSpaceOfSameStyleInTable)),e.doNotSuppressIndentation&&this.root.push(new me("w:doNotSuppressIndentation",e.doNotSuppressIndentation)),e.doNotAutofitConstrainedTables&&this.root.push(new me("w:doNotAutofitConstrainedTables",e.doNotAutofitConstrainedTables)),e.autofitToFirstFixedWidthCell&&this.root.push(new me("w:autofitToFirstFixedWidthCell",e.autofitToFirstFixedWidthCell)),e.underlineTabInNumberingList&&this.root.push(new me("w:underlineTabInNumList",e.underlineTabInNumberingList)),e.displayHangulFixedWidth&&this.root.push(new me("w:displayHangulFixedWidth",e.displayHangulFixedWidth)),e.splitPgBreakAndParaMark&&this.root.push(new me("w:splitPgBreakAndParaMark",e.splitPgBreakAndParaMark)),e.doNotVerticallyAlignCellWithSp&&this.root.push(new me("w:doNotVertAlignCellWithSp",e.doNotVerticallyAlignCellWithSp)),e.doNotBreakConstrainedForcedTable&&this.root.push(new me("w:doNotBreakConstrainedForcedTable",e.doNotBreakConstrainedForcedTable)),e.ignoreVerticalAlignmentInTextboxes&&this.root.push(new me("w:doNotVertAlignInTxbx",e.ignoreVerticalAlignmentInTextboxes)),e.useAnsiKerningPairs&&this.root.push(new me("w:useAnsiKerningPairs",e.useAnsiKerningPairs)),e.cachedColumnBalance&&this.root.push(new me("w:cachedColBalance",e.cachedColumnBalance))}},Ok=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}},Nk=class extends ue{constructor(e){var t,n,i,s,a,o,l,u;super("w:settings"),this.root.push(new Ok({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new me("w:displayBackgroundShape",!0)),e.trackRevisions!==void 0&&this.root.push(new me("w:trackRevisions",e.trackRevisions)),e.evenAndOddHeaders!==void 0&&this.root.push(new me("w:evenAndOddHeaders",e.evenAndOddHeaders)),e.updateFields!==void 0&&this.root.push(new me("w:updateFields",e.updateFields)),e.defaultTabStop!==void 0&&this.root.push(new ii("w:defaultTabStop",e.defaultTabStop)),((t=e.hyphenation)==null?void 0:t.autoHyphenation)!==void 0&&this.root.push(new me("w:autoHyphenation",e.hyphenation.autoHyphenation)),((n=e.hyphenation)==null?void 0:n.hyphenationZone)!==void 0&&this.root.push(new ii("w:hyphenationZone",e.hyphenation.hyphenationZone)),((i=e.hyphenation)==null?void 0:i.consecutiveHyphenLimit)!==void 0&&this.root.push(new ii("w:consecutiveHyphenLimit",e.hyphenation.consecutiveHyphenLimit)),((s=e.hyphenation)==null?void 0:s.doNotHyphenateCaps)!==void 0&&this.root.push(new me("w:doNotHyphenateCaps",e.hyphenation.doNotHyphenateCaps)),this.root.push(new Ak(It(Te({},(a=e.compatibility)!=null?a:{}),{version:(u=(l=(o=e.compatibility)==null?void 0:o.version)!=null?l:e.compatibilityModeVersion)!=null?u:15})))}},sd=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{val:"w:val"})}},Rk=class extends ue{constructor(e){super("w:name"),this.root.push(new sd({val:e}))}},Ck=class extends ue{constructor(e){super("w:uiPriority"),this.root.push(new sd({val:vt(e)}))}},Ik=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}},od=class extends ue{constructor(e,t){super("w:style"),this.root.push(new Ik(e)),t.name&&this.root.push(new Rk(t.name)),t.basedOn&&this.root.push(new Tr("w:basedOn",t.basedOn)),t.next&&this.root.push(new Tr("w:next",t.next)),t.link&&this.root.push(new Tr("w:link",t.link)),t.uiPriority!==void 0&&this.root.push(new Ck(t.uiPriority)),t.semiHidden!==void 0&&this.root.push(new me("w:semiHidden",t.semiHidden)),t.unhideWhenUsed!==void 0&&this.root.push(new me("w:unhideWhenUsed",t.unhideWhenUsed)),t.quickFormat!==void 0&&this.root.push(new me("w:qFormat",t.quickFormat))}},Zi=class extends od{constructor(e){super({type:"paragraph",styleId:e.id},e),ce(this,"paragraphProperties"),ce(this,"runProperties"),this.paragraphProperties=new rn(e.paragraph),this.runProperties=new Ar(e.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}},Qi=class extends od{constructor(e){super({type:"character",styleId:e.id},Te({uiPriority:99,unhideWhenUsed:!0},e)),ce(this,"runProperties"),this.runProperties=new Ar(e.run),this.root.push(this.runProperties)}},sn=class extends Zi{constructor(e){super(Te({basedOn:"Normal",next:"Normal",quickFormat:!0},e))}},Pk=class extends sn{constructor(e){super(Te({id:"Title",name:"Title"},e))}},Dk=class extends sn{constructor(e){super(Te({id:"Heading1",name:"Heading 1"},e))}},Mk=class extends sn{constructor(e){super(Te({id:"Heading2",name:"Heading 2"},e))}},Lk=class extends sn{constructor(e){super(Te({id:"Heading3",name:"Heading 3"},e))}},Fk=class extends sn{constructor(e){super(Te({id:"Heading4",name:"Heading 4"},e))}},Bk=class extends sn{constructor(e){super(Te({id:"Heading5",name:"Heading 5"},e))}},Uk=class extends sn{constructor(e){super(Te({id:"Heading6",name:"Heading 6"},e))}},Hk=class extends sn{constructor(e){super(Te({id:"Strong",name:"Strong"},e))}},zk=class extends Zi{constructor(e){super(Te({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0},e))}},jk=class extends Zi{constructor(e){super(Te({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:lh.AUTO}},run:{size:20}},e))}},Wk=class extends Qi{constructor(e){super(Te({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}},e))}},qk=class extends Qi{constructor(e){super(Te({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}},e))}},Vk=class extends Qi{constructor(e){super(Te({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:ST.SINGLE}}},e))}},ho=class extends ue{constructor(e){if(super("w:styles"),e.initialStyles&&this.root.push(e.initialStyles),e.importedStyles)for(let t of e.importedStyles)this.root.push(t);if(e.paragraphStyles)for(let t of e.paragraphStyles)this.root.push(new Zi(t));if(e.characterStyles)for(let t of e.characterStyles)this.root.push(new Qi(t))}},ad=class extends ue{constructor(e){super("w:pPrDefault"),this.root.push(new rn(e))}},ld=class extends ue{constructor(e){super("w:rPrDefault"),this.root.push(new Ar(e))}},ud=class extends ue{constructor(e){super("w:docDefaults"),ce(this,"runPropertiesDefaults"),ce(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new ld(e.run),this.paragraphPropertiesDefaults=new ad(e.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}},Kk=class{newInstance(e){let t=xd.xml2js(e,{compact:!1}),n;for(let a of t.elements||[])a.name==="w:styles"&&(n=a);if(n===void 0)throw new Error("can not find styles element");let i=n.elements||[];return new ho({initialStyles:new Hf(n.attributes),importedStyles:i.map(a=>Ed(a))})}},cd=class{newInstance(e={}){var t;return{initialStyles:new Yi(["mc","r","w","w14","w15"],"w14 w15"),importedStyles:[new ud((t=e.document)!=null?t:{}),new Pk(Te({run:{size:56}},e.title)),new Dk(Te({run:{color:"2E74B5",size:32}},e.heading1)),new Mk(Te({run:{color:"2E74B5",size:26}},e.heading2)),new Lk(Te({run:{color:"1F4D78",size:24}},e.heading3)),new Fk(Te({run:{color:"2E74B5",italics:!0}},e.heading4)),new Bk(Te({run:{color:"2E74B5"}},e.heading5)),new Uk(Te({run:{color:"1F4D78"}},e.heading6)),new Hk(Te({run:{bold:!0}},e.strong)),new zk(e.listParagraph||{}),new Vk(e.hyperlink||{}),new Wk(e.footnoteReference||{}),new jk(e.footnoteText||{}),new qk(e.footnoteTextChar||{})]}}},fd=class{constructor(e){ce(this,"currentRelationshipId",1),ce(this,"documentWrapper"),ce(this,"headers",[]),ce(this,"footers",[]),ce(this,"coreProperties"),ce(this,"numbering"),ce(this,"media"),ce(this,"fileRelationships"),ce(this,"footnotesWrapper"),ce(this,"settings"),ce(this,"contentTypes"),ce(this,"customProperties"),ce(this,"appProperties"),ce(this,"styles"),ce(this,"comments"),ce(this,"fontWrapper");var t,n,i,s,a,o,l,u,c,f,d,h;if(this.coreProperties=new KS(It(Te({},e),{creator:(t=e.creator)!=null?t:"Un-named",revision:(n=e.revision)!=null?n:1,lastModifiedBy:(i=e.lastModifiedBy)!=null?i:"Un-named"})),this.numbering=new id(e.numbering?e.numbering:{config:[]}),this.comments=new sh((s=e.comments)!=null?s:{children:[]}),this.fileRelationships=new Dn,this.customProperties=new ZS((a=e.customProperties)!=null?a:[]),this.appProperties=new zS,this.footnotesWrapper=new uk,this.contentTypes=new VS,this.documentWrapper=new Ph({background:e.background}),this.settings=new Nk({compatibilityModeVersion:e.compatabilityModeVersion,compatibility:e.compatibility,evenAndOddHeaders:!!e.evenAndOddHeaderAndFooters,trackRevisions:(o=e.features)==null?void 0:o.trackRevisions,updateFields:(l=e.features)==null?void 0:l.updateFields,defaultTabStop:e.defaultTabStop,hyphenation:{autoHyphenation:(u=e.hyphenation)==null?void 0:u.autoHyphenation,hyphenationZone:(c=e.hyphenation)==null?void 0:c.hyphenationZone,consecutiveHyphenLimit:(f=e.hyphenation)==null?void 0:f.consecutiveHyphenLimit,doNotHyphenateCaps:(d=e.hyphenation)==null?void 0:d.doNotHyphenateCaps}}),this.media=new _l,e.externalStyles!==void 0){let y=new Kk;this.styles=y.newInstance(e.externalStyles)}else if(e.styles){let v=new cd().newInstance(e.styles.default);this.styles=new ho(Te(Te({},v),e.styles))}else{let y=new cd;this.styles=new ho(y.newInstance())}this.addDefaultRelationships();for(let y of e.sections)this.addSection(y);if(e.footnotes)for(let y in e.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(y),e.footnotes[y].children);this.fontWrapper=new QS((h=e.fonts)!=null?h:[])}addSection({headers:e={},footers:t={},children:n,properties:i}){this.documentWrapper.View.Body.addSection(It(Te({},i),{headerWrapperGroup:{default:e.default?this.createHeader(e.default):void 0,first:e.first?this.createHeader(e.first):void 0,even:e.even?this.createHeader(e.even):void 0},footerWrapperGroup:{default:t.default?this.createFooter(t.default):void 0,first:t.first?this.createFooter(t.first):void 0,even:t.even?this.createFooter(t.even):void 0}}));for(let s of n)this.documentWrapper.View.add(s)}createHeader(e){let t=new td(this.media,this.currentRelationshipId++);for(let n of e.options.children)t.add(n);return this.addHeaderToDocument(t),t}createFooter(e){let t=new Qh(this.media,this.currentRelationshipId++);for(let n of e.options.children)t.add(n);return this.addFooterToDocument(t),t}addHeaderToDocument(e,t=Vi.DEFAULT){this.headers.push({header:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(e,t=Vi.DEFAULT){this.footers.push({footer:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(e=>e.header)}get Footers(){return this.footers.map(e=>e.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}get FontTable(){return this.fontWrapper}},Gk=class extends ue{constructor(e={}){super("w:instrText"),ce(this,"properties"),this.properties=e,this.root.push(new Ht({space:Yt.PRESERVE}));let t="TOC";if(this.properties.captionLabel&&(t=`${t} \\a "${this.properties.captionLabel}"`),this.properties.entriesFromBookmark&&(t=`${t} \\b "${this.properties.entriesFromBookmark}"`),this.properties.captionLabelIncludingNumbers&&(t=`${t} \\c "${this.properties.captionLabelIncludingNumbers}"`),this.properties.sequenceAndPageNumbersSeparator&&(t=`${t} \\d "${this.properties.sequenceAndPageNumbersSeparator}"`),this.properties.tcFieldIdentifier&&(t=`${t} \\f "${this.properties.tcFieldIdentifier}"`),this.properties.hyperlink&&(t=`${t} \\h`),this.properties.tcFieldLevelRange&&(t=`${t} \\l "${this.properties.tcFieldLevelRange}"`),this.properties.pageNumbersEntryLevelsRange&&(t=`${t} \\n "${this.properties.pageNumbersEntryLevelsRange}"`),this.properties.headingStyleRange&&(t=`${t} \\o "${this.properties.headingStyleRange}"`),this.properties.entryAndPageNumberSeparator&&(t=`${t} \\p "${this.properties.entryAndPageNumberSeparator}"`),this.properties.seqFieldIdentifierForPrefix&&(t=`${t} \\s "${this.properties.seqFieldIdentifierForPrefix}"`),this.properties.stylesWithLevels&&this.properties.stylesWithLevels.length){let n=this.properties.stylesWithLevels.map(i=>`${i.styleName},${i.level}`).join(",");t=`${t} \\t "${n}"`}this.properties.useAppliedParagraphOutlineLevel&&(t=`${t} \\u`),this.properties.preserveTabInEntries&&(t=`${t} \\w`),this.properties.preserveNewLineInEntries&&(t=`${t} \\x`),this.properties.hideTabAndPageNumbersInWebView&&(t=`${t} \\z`),this.root.push(t)}},hd=class extends ue{constructor(){super("w:sdtContent")}},dd=class extends ue{constructor(e){super("w:sdtPr"),e&&this.root.push(new Tr("w:alias",e))}},$k=class extends Xi{constructor(e="Table of Contents",t){super("w:sdt"),this.root.push(new dd(e));let n=new hd,i=new nn({children:[new Pt({children:[new lr(!0),new Gk(t),new kr]})]});n.addChildElement(i);let s=new nn({children:[new Pt({children:[new ur]})]});n.addChildElement(s),this.root.push(n)}},Jk=class{constructor(e,t){ce(this,"styleName"),ce(this,"level"),this.styleName=e,this.level=t}},Xk=class{constructor(e={children:[]}){ce(this,"options"),this.options=e}},Yk=class{constructor(e={children:[]}){ce(this,"options"),this.options=e}},pd=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{id:"w:id"})}},md=class extends ue{constructor(e){super("w:footnoteReference"),this.root.push(new pd({id:e}))}},Zk=class extends Pt{constructor(e){super({style:"FootnoteReference"}),this.root.push(new md(e))}},Qk=class extends ue{constructor(e){super("w:ins"),this.root.push(new cl({id:e.id,author:e.author,date:e.date})),this.addChildElement(new Ji(e))}},eT=class extends ue{constructor(){super("w:delInstrText"),this.root.push(new Ht({space:Yt.PRESERVE})),this.root.push("PAGE")}},tT=class extends ue{constructor(){super("w:delInstrText"),this.root.push(new Ht({space:Yt.PRESERVE})),this.root.push("NUMPAGES")}},rT=class extends ue{constructor(){super("w:delInstrText"),this.root.push(new Ht({space:Yt.PRESERVE})),this.root.push("SECTIONPAGES")}},gd=class extends ue{constructor(e){super("w:delText"),this.root.push(new Ht({space:Yt.PRESERVE})),this.root.push(e)}},nT=class extends ue{constructor(e){super("w:del"),ce(this,"deletedTextRunWrapper"),this.root.push(new cl({id:e.id,author:e.author,date:e.date})),this.deletedTextRunWrapper=new iT(e),this.addChildElement(this.deletedTextRunWrapper)}},iT=class extends ue{constructor(e){if(super("w:r"),this.root.push(new Ar(e)),e.children)for(let t of e.children){if(typeof t=="string"){switch(t){case ni.CURRENT:this.root.push(new lr),this.root.push(new eT),this.root.push(new kr),this.root.push(new ur);break;case ni.TOTAL_PAGES:this.root.push(new lr),this.root.push(new tT),this.root.push(new kr),this.root.push(new ur);break;case ni.TOTAL_PAGES_IN_SECTION:this.root.push(new lr),this.root.push(new rT),this.root.push(new kr),this.root.push(new ur);break;default:this.root.push(new gd(t));break}continue}this.root.push(t)}else e.text&&this.root.push(new gd(e.text));if(e.break)for(let t=0;t<e.break;t++)this.root.splice(1,0,new S3)}},vd=class extends we{constructor(){super(...arguments),ce(this,"xmlKeys",{val:"w14:val",symbolfont:"w14:font"})}},uo=class extends ue{constructor(e,t,n){super(e),n?this.root.push(new vd({val:y3(t),symbolfont:n})):this.root.push(new vd({val:t}))}},yd=class extends ue{constructor(e){var t,n,i,s,a,o,l,u;super("w14:checkbox"),ce(this,"DEFAULT_UNCHECKED_SYMBOL","2610"),ce(this,"DEFAULT_CHECKED_SYMBOL","2612"),ce(this,"DEFAULT_FONT","MS Gothic");let c=e?.checked?"1":"0",f,d;this.root.push(new uo("w14:checked",c)),f=(t=e?.checkedState)!=null&&t.value?(n=e?.checkedState)==null?void 0:n.value:this.DEFAULT_CHECKED_SYMBOL,d=(i=e?.checkedState)!=null&&i.font?(s=e?.checkedState)==null?void 0:s.font:this.DEFAULT_FONT,this.root.push(new uo("w14:checkedState",f,d)),f=(a=e?.uncheckedState)!=null&&a.value?(o=e?.uncheckedState)==null?void 0:o.value:this.DEFAULT_UNCHECKED_SYMBOL,d=(l=e?.uncheckedState)!=null&&l.font?(u=e?.uncheckedState)==null?void 0:u.font:this.DEFAULT_FONT,this.root.push(new uo("w14:uncheckedState",f,d))}},sT=class extends ue{constructor(e){var t,n,i,s;super("w:sdt"),ce(this,"DEFAULT_UNCHECKED_SYMBOL","2610"),ce(this,"DEFAULT_CHECKED_SYMBOL","2612"),ce(this,"DEFAULT_FONT","MS Gothic");let a=new dd(e?.alias);a.addChildElement(new yd(e)),this.root.push(a);let o=new hd,l=(t=e?.checkedState)==null?void 0:t.font,u=(n=e?.checkedState)==null?void 0:n.value,c=(i=e?.uncheckedState)==null?void 0:i.font,f=(s=e?.uncheckedState)==null?void 0:s.value,d,h;e?.checked?(d=l||this.DEFAULT_FONT,h=u||this.DEFAULT_CHECKED_SYMBOL):(d=c||this.DEFAULT_FONT,h=f||this.DEFAULT_UNCHECKED_SYMBOL);let y=new Xf({char:h,symbolfont:d});o.addChildElement(y),this.root.push(o)}},mZ=({shape:r})=>new ke({name:"w:pict",children:[r]}),gZ=({children:r=[]})=>new ke({name:"w:txbxContent",children:r}),vZ=({style:r,children:e,inset:t})=>new ke({name:"v:textbox",attributes:{style:{key:"style",value:r},insetMode:{key:"insetmode",value:t?"custom":"auto"},inset:{key:"inset",value:t?`${t.left}, ${t.top}, ${t.right}, ${t.bottom}`:void 0}},children:[gZ({children:e})]}),yZ="#_x0000_t202",wZ={flip:"flip",height:"height",left:"left",marginBottom:"margin-bottom",marginLeft:"margin-left",marginRight:"margin-right",marginTop:"margin-top",positionHorizontal:"mso-position-horizontal",positionHorizontalRelative:"mso-position-horizontal-relative",positionVertical:"mso-position-vertical",positionVerticalRelative:"mso-position-vertical-relative",wrapDistanceBottom:"mso-wrap-distance-bottom",wrapDistanceLeft:"mso-wrap-distance-left",wrapDistanceRight:"mso-wrap-distance-right",wrapDistanceTop:"mso-wrap-distance-top",wrapEdited:"mso-wrap-edited",wrapStyle:"mso-wrap-style",position:"position",rotation:"rotation",top:"top",visibility:"visibility",width:"width",zIndex:"z-index"},bZ=r=>r?Object.entries(r).map(([e,t])=>`${wZ[e]}:${t}`).join(";"):void 0,_Z=({id:r,children:e,type:t=yZ,style:n})=>new ke({name:"v:shape",attributes:{id:{key:"id",value:r},type:{key:"type",value:t},style:{key:"style",value:bZ(n)}},children:[vZ({style:"mso-fit-shape-to-text:t;",children:e})]}),oT=class extends Xi{constructor(e){var t=e,{style:n,children:i}=t,s=YJ(t,["style","children"]);super("w:p"),this.root.push(new rn(s)),this.root.push(mZ({shape:_Z({children:i,id:Dl(),style:n})}))}},xZ=vT();function Mf(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fx={exports:{}},BL;function EZ(){return BL||(BL=1,(function(r,e){(function(t){r.exports=t()})(function(){return(function t(n,i,s){function a(u,c){if(!i[u]){if(!n[u]){var f=typeof Mf=="function"&&Mf;if(!c&&f)return f(u,!0);if(o)return o(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var h=i[u]={exports:{}};n[u][0].call(h.exports,function(y){var v=n[u][1][y];return a(v||y)},h,h.exports,t,n,i,s)}return i[u].exports}for(var o=typeof Mf=="function"&&Mf,l=0;l<s.length;l++)a(s[l]);return a})({1:[function(t,n,i){var s=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var u,c,f,d,h,y,v,x=[],m=0,_=l.length,b=_,w=s.getTypeOf(l)!=="string";m<l.length;)b=_-m,f=w?(u=l[m++],c=m<_?l[m++]:0,m<_?l[m++]:0):(u=l.charCodeAt(m++),c=m<_?l.charCodeAt(m++):0,m<_?l.charCodeAt(m++):0),d=u>>2,h=(3&u)<<4|c>>4,y=1<b?(15&c)<<2|f>>6:64,v=2<b?63&f:64,x.push(o.charAt(d)+o.charAt(h)+o.charAt(y)+o.charAt(v));return x.join("")},i.decode=function(l){var u,c,f,d,h,y,v=0,x=0,m="data:";if(l.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");var _,b=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&b--,l.charAt(l.length-2)===o.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=a.uint8array?new Uint8Array(0|b):new Array(0|b);v<l.length;)u=o.indexOf(l.charAt(v++))<<2|(d=o.indexOf(l.charAt(v++)))>>4,c=(15&d)<<4|(h=o.indexOf(l.charAt(v++)))>>2,f=(3&h)<<6|(y=o.indexOf(l.charAt(v++))),_[x++]=u,h!==64&&(_[x++]=c),y!==64&&(_[x++]=f);return _}},{"./support":30,"./utils":32}],2:[function(t,n,i){var s=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function u(c,f,d,h,y){this.compressedSize=c,this.uncompressedSize=f,this.crc32=d,this.compression=h,this.compressedContent=y}u.prototype={getContentWorker:function(){var c=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return c.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(c,f,d){return c.pipe(new o).pipe(new l("uncompressedSize")).pipe(f.compressWorker(d)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},n.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,n,i){var s=t("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,n,i){var s=t("./utils"),a=(function(){for(var o,l=[],u=0;u<256;u++){o=u;for(var c=0;c<8;c++)o=1&o?3988292384^o>>>1:o>>>1;l[u]=o}return l})();n.exports=function(o,l){return o!==void 0&&o.length?s.getTypeOf(o)!=="string"?(function(u,c,f,d){var h=a,y=d+f;u^=-1;for(var v=d;v<y;v++)u=u>>>8^h[255&(u^c[v])];return-1^u})(0|l,o,o.length,0):(function(u,c,f,d){var h=a,y=d+f;u^=-1;for(var v=d;v<y;v++)u=u>>>8^h[255&(u^c.charCodeAt(v))];return-1^u})(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(t,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(t,n,i){var s=null;s=typeof Promise<"u"?Promise:t("lie"),n.exports={Promise:s}},{lie:37}],7:[function(t,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=t("pako"),o=t("./utils"),l=t("./stream/GenericWorker"),u=s?"uint8array":"array";function c(f,d){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=d,this.meta={}}i.magic="\b\0",o.inherits(c,l),c.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(u,f.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(d){f.push({data:d,meta:f.meta})}},i.compressWorker=function(f){return new c("Deflate",f)},i.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,n,i){function s(h,y){var v,x="";for(v=0;v<y;v++)x+=String.fromCharCode(255&h),h>>>=8;return x}function a(h,y,v,x,m,_){var b,w,T=h.file,P=h.compression,M=_!==u.utf8encode,U=o.transformTo("string",_(T.name)),R=o.transformTo("string",u.utf8encode(T.name)),J=T.comment,oe=o.transformTo("string",_(J)),C=o.transformTo("string",u.utf8encode(J)),H=R.length!==T.name.length,k=C.length!==J.length,V="",Q="",j="",ie=T.dir,ee=T.date,le={crc32:0,compressedSize:0,uncompressedSize:0};y&&!v||(le.crc32=h.crc32,le.compressedSize=h.compressedSize,le.uncompressedSize=h.uncompressedSize);var G=0;y&&(G|=8),M||!H&&!k||(G|=2048);var D=0,$=0;ie&&(D|=16),m==="UNIX"?($=798,D|=(function(re,K){var O=re;return re||(O=K?16893:33204),(65535&O)<<16})(T.unixPermissions,ie)):($=20,D|=(function(re){return 63&(re||0)})(T.dosPermissions)),b=ee.getUTCHours(),b<<=6,b|=ee.getUTCMinutes(),b<<=5,b|=ee.getUTCSeconds()/2,w=ee.getUTCFullYear()-1980,w<<=4,w|=ee.getUTCMonth()+1,w<<=5,w|=ee.getUTCDate(),H&&(Q=s(1,1)+s(c(U),4)+R,V+="up"+s(Q.length,2)+Q),k&&(j=s(1,1)+s(c(oe),4)+C,V+="uc"+s(j.length,2)+j);var X="";return X+=`
\0`,X+=s(G,2),X+=P.magic,X+=s(b,2),X+=s(w,2),X+=s(le.crc32,4),X+=s(le.compressedSize,4),X+=s(le.uncompressedSize,4),X+=s(U.length,2),X+=s(V.length,2),{fileRecord:f.LOCAL_FILE_HEADER+X+U+V,dirRecord:f.CENTRAL_FILE_HEADER+s($,2)+X+s(oe.length,2)+"\0\0\0\0"+s(D,4)+s(x,4)+U+V+oe}}var o=t("../utils"),l=t("../stream/GenericWorker"),u=t("../utf8"),c=t("../crc32"),f=t("../signature");function d(h,y,v,x){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=v,this.encodeFileName=x,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(d,l),d.prototype.push=function(h){var y=h.meta.percent||0,v=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,l.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:v?(y+100*(v-x-1))/v:100}}))},d.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var y=this.streamFiles&&!h.file.dir;if(y){var v=a(h,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(h){this.accumulate=!1;var y=this.streamFiles&&!h.file.dir,v=a(h,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),y)this.push({data:(function(x){return f.DATA_DESCRIPTOR+s(x.crc32,4)+s(x.compressedSize,4)+s(x.uncompressedSize,4)})(h),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var h=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var v=this.bytesWritten-h,x=(function(m,_,b,w,T){var P=o.transformTo("string",T(w));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(m,2)+s(m,2)+s(_,4)+s(b,4)+s(P.length,2)+P})(this.dirRecords.length,v,h,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(h){this._sources.push(h);var y=this;return h.on("data",function(v){y.processChunk(v)}),h.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),h.on("error",function(v){y.error(v)}),this},d.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(h){var y=this._sources;if(!l.prototype.error.call(this,h))return!1;for(var v=0;v<y.length;v++)try{y[v].error(h)}catch{}return!0},d.prototype.lock=function(){l.prototype.lock.call(this);for(var h=this._sources,y=0;y<h.length;y++)h[y].lock()},n.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,n,i){var s=t("../compressions"),a=t("./ZipFileWorker");i.generateWorker=function(o,l,u){var c=new a(l.streamFiles,u,l.platform,l.encodeFileName),f=0;try{o.forEach(function(d,h){f++;var y=(function(_,b){var w=_||b,T=s[w];if(!T)throw new Error(w+" is not a valid compression method !");return T})(h.options.compression,l.compression),v=h.options.compressionOptions||l.compressionOptions||{},x=h.dir,m=h.date;h._compressWorker(y,v).withStreamInfo("file",{name:d,dir:x,date:m,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(c)}),c.entriesCount=f}catch(d){c.error(d)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,n,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(s.prototype=t("./object")).loadAsync=t("./load"),s.support=t("./support"),s.defaults=t("./defaults"),s.version="3.10.1",s.loadAsync=function(a,o){return new s().loadAsync(a,o)},s.external=t("./external"),n.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,n,i){var s=t("./utils"),a=t("./external"),o=t("./utf8"),l=t("./zipEntries"),u=t("./stream/Crc32Probe"),c=t("./nodejsUtils");function f(d){return new a.Promise(function(h,y){var v=d.decompressed.getContentWorker().pipe(new u);v.on("error",function(x){y(x)}).on("end",function(){v.streamInfo.crc32!==d.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}n.exports=function(d,h){var y=this;return h=s.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),c.isNode&&c.isStream(d)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",d,!0,h.optimizedBinaryString,h.base64).then(function(v){var x=new l(h);return x.load(v),x}).then(function(v){var x=[a.Promise.resolve(v)],m=v.files;if(h.checkCRC32)for(var _=0;_<m.length;_++)x.push(f(m[_]));return a.Promise.all(x)}).then(function(v){for(var x=v.shift(),m=x.files,_=0;_<m.length;_++){var b=m[_],w=b.fileNameStr,T=s.resolve(b.fileNameStr);y.file(T,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:h.createFolders}),b.dir||(y.file(T).unsafeOriginalName=w)}return x.zipComment.length&&(y.comment=x.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,n,i){var s=t("../utils"),a=t("../stream/GenericWorker");function o(l,u){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}s.inherits(o,a),o.prototype._bindStream=function(l){var u=this;(this._stream=l).pause(),l.on("data",function(c){u.push({data:c,meta:{percent:0}})}).on("error",function(c){u.isPaused?this.generatedError=c:u.error(c)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,n,i){var s=t("readable-stream").Readable;function a(o,l,u){s.call(this,l),this._helper=o;var c=this;o.on("data",function(f,d){c.push(f)||c._helper.pause(),u&&u(d)}).on("error",function(f){c.emit("error",f)}).on("end",function(){c.push(null)})}t("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},n.exports=a},{"../utils":32,"readable-stream":16}],14:[function(t,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(t,n,i){function s(T,P,M){var U,R=o.getTypeOf(P),J=o.extend(M||{},c);J.date=J.date||new Date,J.compression!==null&&(J.compression=J.compression.toUpperCase()),typeof J.unixPermissions=="string"&&(J.unixPermissions=parseInt(J.unixPermissions,8)),J.unixPermissions&&16384&J.unixPermissions&&(J.dir=!0),J.dosPermissions&&16&J.dosPermissions&&(J.dir=!0),J.dir&&(T=m(T)),J.createFolders&&(U=x(T))&&_.call(this,U,!0);var oe=R==="string"&&J.binary===!1&&J.base64===!1;M&&M.binary!==void 0||(J.binary=!oe),(P instanceof f&&P.uncompressedSize===0||J.dir||!P||P.length===0)&&(J.base64=!1,J.binary=!0,P="",J.compression="STORE",R="string");var C=null;C=P instanceof f||P instanceof l?P:y.isNode&&y.isStream(P)?new v(T,P):o.prepareContent(T,P,J.binary,J.optimizedBinaryString,J.base64);var H=new d(T,C,J);this.files[T]=H}var a=t("./utf8"),o=t("./utils"),l=t("./stream/GenericWorker"),u=t("./stream/StreamHelper"),c=t("./defaults"),f=t("./compressedObject"),d=t("./zipObject"),h=t("./generate"),y=t("./nodejsUtils"),v=t("./nodejs/NodejsStreamInputAdapter"),x=function(T){T.slice(-1)==="/"&&(T=T.substring(0,T.length-1));var P=T.lastIndexOf("/");return 0<P?T.substring(0,P):""},m=function(T){return T.slice(-1)!=="/"&&(T+="/"),T},_=function(T,P){return P=P!==void 0?P:c.createFolders,T=m(T),this.files[T]||s.call(this,T,null,{dir:!0,createFolders:P}),this.files[T]};function b(T){return Object.prototype.toString.call(T)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(T){var P,M,U;for(P in this.files)U=this.files[P],(M=P.slice(this.root.length,P.length))&&P.slice(0,this.root.length)===this.root&&T(M,U)},filter:function(T){var P=[];return this.forEach(function(M,U){T(M,U)&&P.push(U)}),P},file:function(T,P,M){if(arguments.length!==1)return T=this.root+T,s.call(this,T,P,M),this;if(b(T)){var U=T;return this.filter(function(J,oe){return!oe.dir&&U.test(J)})}var R=this.files[this.root+T];return R&&!R.dir?R:null},folder:function(T){if(!T)return this;if(b(T))return this.filter(function(R,J){return J.dir&&T.test(R)});var P=this.root+T,M=_.call(this,P),U=this.clone();return U.root=M.name,U},remove:function(T){T=this.root+T;var P=this.files[T];if(P||(T.slice(-1)!=="/"&&(T+="/"),P=this.files[T]),P&&!P.dir)delete this.files[T];else for(var M=this.filter(function(R,J){return J.name.slice(0,T.length)===T}),U=0;U<M.length;U++)delete this.files[M[U].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(T){var P,M={};try{if((M=o.extend(T||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=M.type.toLowerCase(),M.compression=M.compression.toUpperCase(),M.type==="binarystring"&&(M.type="string"),!M.type)throw new Error("No output type specified.");o.checkSupport(M.type),M.platform!=="darwin"&&M.platform!=="freebsd"&&M.platform!=="linux"&&M.platform!=="sunos"||(M.platform="UNIX"),M.platform==="win32"&&(M.platform="DOS");var U=M.comment||this.comment||"";P=h.generateWorker(this,M,U)}catch(R){(P=new l("error")).error(R)}return new u(P,M.type||"string",M.mimeType)},generateAsync:function(T,P){return this.generateInternalStream(T).accumulate(P)},generateNodeStream:function(T,P){return(T=T||{}).type||(T.type="nodebuffer"),this.generateInternalStream(T).toNodejsStream(P)}};n.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,n,i){n.exports=t("stream")},{stream:void 0}],17:[function(t,n,i){var s=t("./DataReader");function a(o){s.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}t("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),u=o.charCodeAt(1),c=o.charCodeAt(2),f=o.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===l&&this.data[d+1]===u&&this.data[d+2]===c&&this.data[d+3]===f)return d-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),u=o.charCodeAt(1),c=o.charCodeAt(2),f=o.charCodeAt(3),d=this.readData(4);return l===d[0]&&u===d[1]&&c===d[2]&&f===d[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=a},{"../utils":32,"./DataReader":18}],18:[function(t,n,i){var s=t("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,u=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)u=(u<<8)+this.byteAt(l);return this.index+=o,u},readString:function(o){return s.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},n.exports=a},{"../utils":32}],19:[function(t,n,i){var s=t("./Uint8ArrayReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,n,i){var s=t("./DataReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=a},{"../utils":32,"./DataReader":18}],21:[function(t,n,i){var s=t("./ArrayReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(t,n,i){var s=t("../utils"),a=t("../support"),o=t("./ArrayReader"),l=t("./StringReader"),u=t("./NodeBufferReader"),c=t("./Uint8ArrayReader");n.exports=function(f){var d=s.getTypeOf(f);return s.checkSupport(d),d!=="string"||a.uint8array?d==="nodebuffer"?new u(f):a.uint8array?new c(s.transformTo("uint8array",f)):new o(s.transformTo("array",f)):new l(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,n,i){var s=t("./GenericWorker"),a=t("../utils");function o(l){s.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,s),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},n.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,n,i){var s=t("./GenericWorker"),a=t("../crc32");function o(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,s),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,n,i){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(o,a),o.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}a.prototype.processChunk.call(this,l)},n.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,n,i){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(c){u.dataIsReady=!0,u.data=c,u.max=c&&c.length||0,u.type=s.getTypeOf(c),u.isPaused||u._tickAndRepeat()},function(c){u.error(c)})}s.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,u);break;case"uint8array":l=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":l=this.data.slice(this.index,u)}return this.index=u,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,n,i){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},n.exports=s},{}],29:[function(t,n,i){var s=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),l=t("../base64"),u=t("../support"),c=t("../external"),f=null;if(u.nodestream)try{f=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(y,v){return new c.Promise(function(x,m){var _=[],b=y._internalType,w=y._outputType,T=y._mimeType;y.on("data",function(P,M){_.push(P),v&&v(M)}).on("error",function(P){_=[],m(P)}).on("end",function(){try{var P=(function(M,U,R){switch(M){case"blob":return s.newBlob(s.transformTo("arraybuffer",U),R);case"base64":return l.encode(U);default:return s.transformTo(M,U)}})(w,(function(M,U){var R,J=0,oe=null,C=0;for(R=0;R<U.length;R++)C+=U[R].length;switch(M){case"string":return U.join("");case"array":return Array.prototype.concat.apply([],U);case"uint8array":for(oe=new Uint8Array(C),R=0;R<U.length;R++)oe.set(U[R],J),J+=U[R].length;return oe;case"nodebuffer":return Buffer.concat(U);default:throw new Error("concat : unsupported type '"+M+"'")}})(b,_),T);x(P)}catch(M){m(M)}_=[]}).resume()})}function h(y,v,x){var m=v;switch(v){case"blob":case"arraybuffer":m="uint8array";break;case"base64":m="string"}try{this._internalType=m,this._outputType=v,this._mimeType=x,s.checkSupport(m),this._worker=y.pipe(new a(m)),y.lock()}catch(_){this._worker=new o("error"),this._worker.error(_)}}h.prototype={accumulate:function(y){return d(this,y)},on:function(y,v){var x=this;return y==="data"?this._worker.on(y,function(m){v.call(x,m.data,m.meta)}):this._worker.on(y,function(){s.delay(v,arguments,x)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},y)}},n.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!t("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(t,n,i){for(var s=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),l=t("./stream/GenericWorker"),u=new Array(256),c=0;c<256;c++)u[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;u[254]=u[254]=1;function f(){l.call(this,"utf-8 decode"),this.leftOver=null}function d(){l.call(this,"utf-8 encode")}i.utf8encode=function(h){return a.nodebuffer?o.newBufferFrom(h,"utf-8"):(function(y){var v,x,m,_,b,w=y.length,T=0;for(_=0;_<w;_++)(64512&(x=y.charCodeAt(_)))==55296&&_+1<w&&(64512&(m=y.charCodeAt(_+1)))==56320&&(x=65536+(x-55296<<10)+(m-56320),_++),T+=x<128?1:x<2048?2:x<65536?3:4;for(v=a.uint8array?new Uint8Array(T):new Array(T),_=b=0;b<T;_++)(64512&(x=y.charCodeAt(_)))==55296&&_+1<w&&(64512&(m=y.charCodeAt(_+1)))==56320&&(x=65536+(x-55296<<10)+(m-56320),_++),x<128?v[b++]=x:(x<2048?v[b++]=192|x>>>6:(x<65536?v[b++]=224|x>>>12:(v[b++]=240|x>>>18,v[b++]=128|x>>>12&63),v[b++]=128|x>>>6&63),v[b++]=128|63&x);return v})(h)},i.utf8decode=function(h){return a.nodebuffer?s.transformTo("nodebuffer",h).toString("utf-8"):(function(y){var v,x,m,_,b=y.length,w=new Array(2*b);for(v=x=0;v<b;)if((m=y[v++])<128)w[x++]=m;else if(4<(_=u[m]))w[x++]=65533,v+=_-1;else{for(m&=_===2?31:_===3?15:7;1<_&&v<b;)m=m<<6|63&y[v++],_--;1<_?w[x++]=65533:m<65536?w[x++]=m:(m-=65536,w[x++]=55296|m>>10&1023,w[x++]=56320|1023&m)}return w.length!==x&&(w.subarray?w=w.subarray(0,x):w.length=x),s.applyFromCharCode(w)})(h=s.transformTo(a.uint8array?"uint8array":"array",h))},s.inherits(f,l),f.prototype.processChunk=function(h){var y=s.transformTo(a.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var v=y;(y=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),y.set(v,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var x=(function(_,b){var w;for((b=b||_.length)>_.length&&(b=_.length),w=b-1;0<=w&&(192&_[w])==128;)w--;return w<0||w===0?b:w+u[_[w]]>b?w:b})(y),m=y;x!==y.length&&(a.uint8array?(m=y.subarray(0,x),this.leftOver=y.subarray(x,y.length)):(m=y.slice(0,x),this.leftOver=y.slice(x,y.length))),this.push({data:i.utf8decode(m),meta:h.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=f,s.inherits(d,l),d.prototype.processChunk=function(h){this.push({data:i.utf8encode(h.data),meta:h.meta})},i.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,n,i){var s=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),l=t("./external");function u(v){return v}function c(v,x){for(var m=0;m<v.length;++m)x[m]=255&v.charCodeAt(m);return x}t("setimmediate"),i.newBlob=function(v,x){i.checkSupport("blob");try{return new Blob([v],{type:x})}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return m.append(v),m.getBlob(x)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(v,x,m){var _=[],b=0,w=v.length;if(w<=m)return String.fromCharCode.apply(null,v);for(;b<w;)x==="array"||x==="nodebuffer"?_.push(String.fromCharCode.apply(null,v.slice(b,Math.min(b+m,w)))):_.push(String.fromCharCode.apply(null,v.subarray(b,Math.min(b+m,w)))),b+=m;return _.join("")},stringifyByChar:function(v){for(var x="",m=0;m<v.length;m++)x+=String.fromCharCode(v[m]);return x},applyCanBeUsed:{uint8array:(function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}})()}};function d(v){var x=65536,m=i.getTypeOf(v),_=!0;if(m==="uint8array"?_=f.applyCanBeUsed.uint8array:m==="nodebuffer"&&(_=f.applyCanBeUsed.nodebuffer),_)for(;1<x;)try{return f.stringifyByChunk(v,m,x)}catch{x=Math.floor(x/2)}return f.stringifyByChar(v)}function h(v,x){for(var m=0;m<v.length;m++)x[m]=v[m];return x}i.applyFromCharCode=d;var y={};y.string={string:u,array:function(v){return c(v,new Array(v.length))},arraybuffer:function(v){return y.string.uint8array(v).buffer},uint8array:function(v){return c(v,new Uint8Array(v.length))},nodebuffer:function(v){return c(v,o.allocBuffer(v.length))}},y.array={string:d,array:u,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return o.newBufferFrom(v)}},y.arraybuffer={string:function(v){return d(new Uint8Array(v))},array:function(v){return h(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:u,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return o.newBufferFrom(new Uint8Array(v))}},y.uint8array={string:d,array:function(v){return h(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:u,nodebuffer:function(v){return o.newBufferFrom(v)}},y.nodebuffer={string:d,array:function(v){return h(v,new Array(v.length))},arraybuffer:function(v){return y.nodebuffer.uint8array(v).buffer},uint8array:function(v){return h(v,new Uint8Array(v.length))},nodebuffer:u},i.transformTo=function(v,x){if(x=x||"",!v)return x;i.checkSupport(v);var m=i.getTypeOf(x);return y[m][v](x)},i.resolve=function(v){for(var x=v.split("/"),m=[],_=0;_<x.length;_++){var b=x[_];b==="."||b===""&&_!==0&&_!==x.length-1||(b===".."?m.pop():m.push(b))}return m.join("/")},i.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":s.nodebuffer&&o.isBuffer(v)?"nodebuffer":s.uint8array&&v instanceof Uint8Array?"uint8array":s.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(v){if(!s[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(v){var x,m,_="";for(m=0;m<(v||"").length;m++)_+="\\x"+((x=v.charCodeAt(m))<16?"0":"")+x.toString(16).toUpperCase();return _},i.delay=function(v,x,m){setImmediate(function(){v.apply(m||null,x||[])})},i.inherits=function(v,x){function m(){}m.prototype=x.prototype,v.prototype=new m},i.extend=function(){var v,x,m={};for(v=0;v<arguments.length;v++)for(x in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],x)&&m[x]===void 0&&(m[x]=arguments[v][x]);return m},i.prepareContent=function(v,x,m,_,b){return l.Promise.resolve(x).then(function(w){return s.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1)&&typeof FileReader<"u"?new l.Promise(function(T,P){var M=new FileReader;M.onload=function(U){T(U.target.result)},M.onerror=function(U){P(U.target.error)},M.readAsArrayBuffer(w)}):w}).then(function(w){var T=i.getTypeOf(w);return T?(T==="arraybuffer"?w=i.transformTo("uint8array",w):T==="string"&&(b?w=a.decode(w):m&&_!==!0&&(w=(function(P){return c(P,s.uint8array?new Uint8Array(P.length):new Array(P.length))})(w))),w):l.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,n,i){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),l=t("./zipEntry"),u=t("./support");function c(f){this.files=[],this.loadOptions=f}c.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(d)+", expected "+a.pretty(f)+")")}},isSignature:function(f,d){var h=this.reader.index;this.reader.setIndex(f);var y=this.reader.readString(4)===d;return this.reader.setIndex(h),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),d=u.uint8array?"uint8array":"array",h=a.transformTo(d,f);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,d,h,y=this.zip64EndOfCentralSize-44;0<y;)f=this.reader.readInt(2),d=this.reader.readInt(4),h=this.reader.readData(d),this.zip64ExtensibleData[f]={id:f,length:d,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,d;for(f=0;f<this.files.length;f++)d=this.files[f],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(f=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var d=f;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var y=d-h;if(0<y)this.isSignature(d,o.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,n,i){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),l=t("./crc32"),u=t("./utf8"),c=t("./compressions"),f=t("./support");function d(h,y){this.options=h,this.loadOptions=y}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var y,v;if(h.skip(22),this.fileNameLength=h.readInt(2),v=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=(function(x){for(var m in c)if(Object.prototype.hasOwnProperty.call(c,m)&&c[m].magic===x)return c[m];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,y,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var y=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(y),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var y,v,x,m=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<m;)y=h.readInt(2),v=h.readInt(2),x=h.readData(v),this.extraFields[y]={id:y,length:v,value:x};h.setIndex(m)},handleUTF8:function(){var h=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var v=a.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var x=this.findExtraFieldUnicodeComment();if(x!==null)this.fileCommentStr=x;else{var m=a.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(m)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var y=s(h.value);return y.readInt(1)!==1||l(this.fileName)!==y.readInt(4)?null:u.utf8decode(y.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var y=s(h.value);return y.readInt(1)!==1||l(this.fileComment)!==y.readInt(4)?null:u.utf8decode(y.readData(h.length-5))}return null}},n.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,n,i){function s(y,v,x){this.name=y,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=v,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}}var a=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),l=t("./utf8"),u=t("./compressedObject"),c=t("./stream/GenericWorker");s.prototype={internalStream:function(y){var v=null,x="string";try{if(!y)throw new Error("No output type specified.");var m=(x=y.toLowerCase())==="string"||x==="text";x!=="binarystring"&&x!=="text"||(x="string"),v=this._decompressWorker();var _=!this._dataBinary;_&&!m&&(v=v.pipe(new l.Utf8EncodeWorker)),!_&&m&&(v=v.pipe(new l.Utf8DecodeWorker))}catch(b){(v=new c("error")).error(b)}return new a(v,x,"")},async:function(y,v){return this.internalStream(y).accumulate(v)},nodeStream:function(y,v){return this.internalStream(y||"nodebuffer").toNodejsStream(v)},_compressWorker:function(y,v){if(this._data instanceof u&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new l.Utf8EncodeWorker)),u.createWorkerFrom(x,y,v)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof c?this._data:new o(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<f.length;h++)s.prototype[f[h]]=d;n.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,n,i){(function(s){var a,o,l=s.MutationObserver||s.WebKitMutationObserver;if(l){var u=0,c=new l(y),f=s.document.createTextNode("");c.observe(f,{characterData:!0}),a=function(){f.data=u=++u%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var v=s.document.createElement("script");v.onreadystatechange=function(){y(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},s.document.documentElement.appendChild(v)}:function(){setTimeout(y,0)};else{var d=new s.MessageChannel;d.port1.onmessage=y,a=function(){d.port2.postMessage(0)}}var h=[];function y(){var v,x;o=!0;for(var m=h.length;m;){for(x=h,h=[],v=-1;++v<m;)x[v]();m=h.length}o=!1}n.exports=function(v){h.push(v)!==1||o||a()}}).call(this,typeof Qr<"u"?Qr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,n,i){var s=t("immediate");function a(){}var o={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];function f(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,m!==a&&v(this,m)}function d(m,_,b){this.promise=m,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function h(m,_,b){s(function(){var w;try{w=_(b)}catch(T){return o.reject(m,T)}w===m?o.reject(m,new TypeError("Cannot resolve promise with itself")):o.resolve(m,w)})}function y(m){var _=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof _=="function")return function(){_.apply(m,arguments)}}function v(m,_){var b=!1;function w(M){b||(b=!0,o.reject(m,M))}function T(M){b||(b=!0,o.resolve(m,M))}var P=x(function(){_(T,w)});P.status==="error"&&w(P.value)}function x(m,_){var b={};try{b.value=m(_),b.status="success"}catch(w){b.status="error",b.value=w}return b}(n.exports=f).prototype.finally=function(m){if(typeof m!="function")return this;var _=this.constructor;return this.then(function(b){return _.resolve(m()).then(function(){return b})},function(b){return _.resolve(m()).then(function(){throw b})})},f.prototype.catch=function(m){return this.then(null,m)},f.prototype.then=function(m,_){if(typeof m!="function"&&this.state===u||typeof _!="function"&&this.state===l)return this;var b=new this.constructor(a);return this.state!==c?h(b,this.state===u?m:_,this.outcome):this.queue.push(new d(b,m,_)),b},d.prototype.callFulfilled=function(m){o.resolve(this.promise,m)},d.prototype.otherCallFulfilled=function(m){h(this.promise,this.onFulfilled,m)},d.prototype.callRejected=function(m){o.reject(this.promise,m)},d.prototype.otherCallRejected=function(m){h(this.promise,this.onRejected,m)},o.resolve=function(m,_){var b=x(y,_);if(b.status==="error")return o.reject(m,b.value);var w=b.value;if(w)v(m,w);else{m.state=u,m.outcome=_;for(var T=-1,P=m.queue.length;++T<P;)m.queue[T].callFulfilled(_)}return m},o.reject=function(m,_){m.state=l,m.outcome=_;for(var b=-1,w=m.queue.length;++b<w;)m.queue[b].callRejected(_);return m},f.resolve=function(m){return m instanceof this?m:o.resolve(new this(a),m)},f.reject=function(m){var _=new this(a);return o.reject(_,m)},f.all=function(m){var _=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=m.length,w=!1;if(!b)return this.resolve([]);for(var T=new Array(b),P=0,M=-1,U=new this(a);++M<b;)R(m[M],M);return U;function R(J,oe){_.resolve(J).then(function(C){T[oe]=C,++P!==b||w||(w=!0,o.resolve(U,T))},function(C){w||(w=!0,o.reject(U,C))})}},f.race=function(m){var _=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=m.length,w=!1;if(!b)return this.resolve([]);for(var T=-1,P=new this(a);++T<b;)M=m[T],_.resolve(M).then(function(U){w||(w=!0,o.resolve(P,U))},function(U){w||(w=!0,o.reject(P,U))});var M;return P}},{immediate:36}],38:[function(t,n,i){var s={};(0,t("./lib/utils/common").assign)(s,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),n.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,n,i){var s=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/messages"),u=t("./zlib/zstream"),c=Object.prototype.toString,f=0,d=-1,h=0,y=8;function v(m){if(!(this instanceof v))return new v(m);this.options=a.assign({level:d,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},m||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var b=s.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(b!==f)throw new Error(l[b]);if(_.header&&s.deflateSetHeader(this.strm,_.header),_.dictionary){var w;if(w=typeof _.dictionary=="string"?o.string2buf(_.dictionary):c.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(b=s.deflateSetDictionary(this.strm,w))!==f)throw new Error(l[b]);this._dict_set=!0}}function x(m,_){var b=new v(_);if(b.push(m,!0),b.err)throw b.msg||l[b.err];return b.result}v.prototype.push=function(m,_){var b,w,T=this.strm,P=this.options.chunkSize;if(this.ended)return!1;w=_===~~_?_:_===!0?4:0,typeof m=="string"?T.input=o.string2buf(m):c.call(m)==="[object ArrayBuffer]"?T.input=new Uint8Array(m):T.input=m,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new a.Buf8(P),T.next_out=0,T.avail_out=P),(b=s.deflate(T,w))!==1&&b!==f)return this.onEnd(b),!(this.ended=!0);T.avail_out!==0&&(T.avail_in!==0||w!==4&&w!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(T.output,T.next_out))):this.onData(a.shrinkBuf(T.output,T.next_out)))}while((0<T.avail_in||T.avail_out===0)&&b!==1);return w===4?(b=s.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===f):w!==2||(this.onEnd(f),!(T.avail_out=0))},v.prototype.onData=function(m){this.chunks.push(m)},v.prototype.onEnd=function(m){m===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},i.Deflate=v,i.deflate=x,i.deflateRaw=function(m,_){return(_=_||{}).raw=!0,x(m,_)},i.gzip=function(m,_){return(_=_||{}).gzip=!0,x(m,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,n,i){var s=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/constants"),u=t("./zlib/messages"),c=t("./zlib/zstream"),f=t("./zlib/gzheader"),d=Object.prototype.toString;function h(v){if(!(this instanceof h))return new h(v);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},v||{});var x=this.options;x.raw&&0<=x.windowBits&&x.windowBits<16&&(x.windowBits=-x.windowBits,x.windowBits===0&&(x.windowBits=-15)),!(0<=x.windowBits&&x.windowBits<16)||v&&v.windowBits||(x.windowBits+=32),15<x.windowBits&&x.windowBits<48&&(15&x.windowBits)==0&&(x.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var m=s.inflateInit2(this.strm,x.windowBits);if(m!==l.Z_OK)throw new Error(u[m]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}function y(v,x){var m=new h(x);if(m.push(v,!0),m.err)throw m.msg||u[m.err];return m.result}h.prototype.push=function(v,x){var m,_,b,w,T,P,M=this.strm,U=this.options.chunkSize,R=this.options.dictionary,J=!1;if(this.ended)return!1;_=x===~~x?x:x===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof v=="string"?M.input=o.binstring2buf(v):d.call(v)==="[object ArrayBuffer]"?M.input=new Uint8Array(v):M.input=v,M.next_in=0,M.avail_in=M.input.length;do{if(M.avail_out===0&&(M.output=new a.Buf8(U),M.next_out=0,M.avail_out=U),(m=s.inflate(M,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&R&&(P=typeof R=="string"?o.string2buf(R):d.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,m=s.inflateSetDictionary(this.strm,P)),m===l.Z_BUF_ERROR&&J===!0&&(m=l.Z_OK,J=!1),m!==l.Z_STREAM_END&&m!==l.Z_OK)return this.onEnd(m),!(this.ended=!0);M.next_out&&(M.avail_out!==0&&m!==l.Z_STREAM_END&&(M.avail_in!==0||_!==l.Z_FINISH&&_!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=o.utf8border(M.output,M.next_out),w=M.next_out-b,T=o.buf2string(M.output,b),M.next_out=w,M.avail_out=U-w,w&&a.arraySet(M.output,M.output,b,w,0),this.onData(T)):this.onData(a.shrinkBuf(M.output,M.next_out)))),M.avail_in===0&&M.avail_out===0&&(J=!0)}while((0<M.avail_in||M.avail_out===0)&&m!==l.Z_STREAM_END);return m===l.Z_STREAM_END&&(_=l.Z_FINISH),_===l.Z_FINISH?(m=s.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===l.Z_OK):_!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(M.avail_out=0))},h.prototype.onData=function(v){this.chunks.push(v)},h.prototype.onEnd=function(v){v===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},i.Inflate=h,i.inflate=y,i.inflateRaw=function(v,x){return(x=x||{}).raw=!0,y(v,x)},i.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var c=u.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var f in c)c.hasOwnProperty(f)&&(l[f]=c[f])}}return l},i.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var a={arraySet:function(l,u,c,f,d){if(u.subarray&&l.subarray)l.set(u.subarray(c,c+f),d);else for(var h=0;h<f;h++)l[d+h]=u[c+h]},flattenChunks:function(l){var u,c,f,d,h,y;for(u=f=0,c=l.length;u<c;u++)f+=l[u].length;for(y=new Uint8Array(f),u=d=0,c=l.length;u<c;u++)h=l[u],y.set(h,d),d+=h.length;return y}},o={arraySet:function(l,u,c,f,d){for(var h=0;h<f;h++)l[d+h]=u[c+h]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(s)},{}],42:[function(t,n,i){var s=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new s.Buf8(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function c(f,d){if(d<65537&&(f.subarray&&o||!f.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(f,d));for(var h="",y=0;y<d;y++)h+=String.fromCharCode(f[y]);return h}l[254]=l[254]=1,i.string2buf=function(f){var d,h,y,v,x,m=f.length,_=0;for(v=0;v<m;v++)(64512&(h=f.charCodeAt(v)))==55296&&v+1<m&&(64512&(y=f.charCodeAt(v+1)))==56320&&(h=65536+(h-55296<<10)+(y-56320),v++),_+=h<128?1:h<2048?2:h<65536?3:4;for(d=new s.Buf8(_),v=x=0;x<_;v++)(64512&(h=f.charCodeAt(v)))==55296&&v+1<m&&(64512&(y=f.charCodeAt(v+1)))==56320&&(h=65536+(h-55296<<10)+(y-56320),v++),h<128?d[x++]=h:(h<2048?d[x++]=192|h>>>6:(h<65536?d[x++]=224|h>>>12:(d[x++]=240|h>>>18,d[x++]=128|h>>>12&63),d[x++]=128|h>>>6&63),d[x++]=128|63&h);return d},i.buf2binstring=function(f){return c(f,f.length)},i.binstring2buf=function(f){for(var d=new s.Buf8(f.length),h=0,y=d.length;h<y;h++)d[h]=f.charCodeAt(h);return d},i.buf2string=function(f,d){var h,y,v,x,m=d||f.length,_=new Array(2*m);for(h=y=0;h<m;)if((v=f[h++])<128)_[y++]=v;else if(4<(x=l[v]))_[y++]=65533,h+=x-1;else{for(v&=x===2?31:x===3?15:7;1<x&&h<m;)v=v<<6|63&f[h++],x--;1<x?_[y++]=65533:v<65536?_[y++]=v:(v-=65536,_[y++]=55296|v>>10&1023,_[y++]=56320|1023&v)}return c(_,y)},i.utf8border=function(f,d){var h;for((d=d||f.length)>f.length&&(d=f.length),h=d-1;0<=h&&(192&f[h])==128;)h--;return h<0||h===0?d:h+l[f[h]]>d?h:d}},{"./common":41}],43:[function(t,n,i){n.exports=function(s,a,o,l){for(var u=65535&s|0,c=s>>>16&65535|0,f=0;o!==0;){for(o-=f=2e3<o?2e3:o;c=c+(u=u+a[l++]|0)|0,--f;);u%=65521,c%=65521}return u|c<<16|0}},{}],44:[function(t,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,n,i){var s=(function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o})();n.exports=function(a,o,l,u){var c=s,f=u+l;a^=-1;for(var d=u;d<f;d++)a=a>>>8^c[255&(a^o[d])];return-1^a}},{}],46:[function(t,n,i){var s,a=t("../utils/common"),o=t("./trees"),l=t("./adler32"),u=t("./crc32"),c=t("./messages"),f=0,d=4,h=0,y=-2,v=-1,x=4,m=2,_=8,b=9,w=286,T=30,P=19,M=2*w+1,U=15,R=3,J=258,oe=J+R+1,C=42,H=113,k=1,V=2,Q=3,j=4;function ie(E,Y){return E.msg=c[Y],Y}function ee(E){return(E<<1)-(4<E?9:0)}function le(E){for(var Y=E.length;0<=--Y;)E[Y]=0}function G(E){var Y=E.state,N=Y.pending;N>E.avail_out&&(N=E.avail_out),N!==0&&(a.arraySet(E.output,Y.pending_buf,Y.pending_out,N,E.next_out),E.next_out+=N,Y.pending_out+=N,E.total_out+=N,E.avail_out-=N,Y.pending-=N,Y.pending===0&&(Y.pending_out=0))}function D(E,Y){o._tr_flush_block(E,0<=E.block_start?E.block_start:-1,E.strstart-E.block_start,Y),E.block_start=E.strstart,G(E.strm)}function $(E,Y){E.pending_buf[E.pending++]=Y}function X(E,Y){E.pending_buf[E.pending++]=Y>>>8&255,E.pending_buf[E.pending++]=255&Y}function re(E,Y){var N,p,g=E.max_chain_length,S=E.strstart,F=E.prev_length,q=E.nice_match,z=E.strstart>E.w_size-oe?E.strstart-(E.w_size-oe):0,ne=E.window,ae=E.w_mask,se=E.prev,fe=E.strstart+J,pe=ne[S+F-1],ve=ne[S+F];E.prev_length>=E.good_match&&(g>>=2),q>E.lookahead&&(q=E.lookahead);do if(ne[(N=Y)+F]===ve&&ne[N+F-1]===pe&&ne[N]===ne[S]&&ne[++N]===ne[S+1]){S+=2,N++;do;while(ne[++S]===ne[++N]&&ne[++S]===ne[++N]&&ne[++S]===ne[++N]&&ne[++S]===ne[++N]&&ne[++S]===ne[++N]&&ne[++S]===ne[++N]&&ne[++S]===ne[++N]&&ne[++S]===ne[++N]&&S<fe);if(p=J-(fe-S),S=fe-J,F<p){if(E.match_start=Y,q<=(F=p))break;pe=ne[S+F-1],ve=ne[S+F]}}while((Y=se[Y&ae])>z&&--g!=0);return F<=E.lookahead?F:E.lookahead}function K(E){var Y,N,p,g,S,F,q,z,ne,ae,se=E.w_size;do{if(g=E.window_size-E.lookahead-E.strstart,E.strstart>=se+(se-oe)){for(a.arraySet(E.window,E.window,se,se,0),E.match_start-=se,E.strstart-=se,E.block_start-=se,Y=N=E.hash_size;p=E.head[--Y],E.head[Y]=se<=p?p-se:0,--N;);for(Y=N=se;p=E.prev[--Y],E.prev[Y]=se<=p?p-se:0,--N;);g+=se}if(E.strm.avail_in===0)break;if(F=E.strm,q=E.window,z=E.strstart+E.lookahead,ne=g,ae=void 0,ae=F.avail_in,ne<ae&&(ae=ne),N=ae===0?0:(F.avail_in-=ae,a.arraySet(q,F.input,F.next_in,ae,z),F.state.wrap===1?F.adler=l(F.adler,q,ae,z):F.state.wrap===2&&(F.adler=u(F.adler,q,ae,z)),F.next_in+=ae,F.total_in+=ae,ae),E.lookahead+=N,E.lookahead+E.insert>=R)for(S=E.strstart-E.insert,E.ins_h=E.window[S],E.ins_h=(E.ins_h<<E.hash_shift^E.window[S+1])&E.hash_mask;E.insert&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[S+R-1])&E.hash_mask,E.prev[S&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=S,S++,E.insert--,!(E.lookahead+E.insert<R)););}while(E.lookahead<oe&&E.strm.avail_in!==0)}function O(E,Y){for(var N,p;;){if(E.lookahead<oe){if(K(E),E.lookahead<oe&&Y===f)return k;if(E.lookahead===0)break}if(N=0,E.lookahead>=R&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+R-1])&E.hash_mask,N=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),N!==0&&E.strstart-N<=E.w_size-oe&&(E.match_length=re(E,N)),E.match_length>=R)if(p=o._tr_tally(E,E.strstart-E.match_start,E.match_length-R),E.lookahead-=E.match_length,E.match_length<=E.max_lazy_match&&E.lookahead>=R){for(E.match_length--;E.strstart++,E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+R-1])&E.hash_mask,N=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart,--E.match_length!=0;);E.strstart++}else E.strstart+=E.match_length,E.match_length=0,E.ins_h=E.window[E.strstart],E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+1])&E.hash_mask;else p=o._tr_tally(E,0,E.window[E.strstart]),E.lookahead--,E.strstart++;if(p&&(D(E,!1),E.strm.avail_out===0))return k}return E.insert=E.strstart<R-1?E.strstart:R-1,Y===d?(D(E,!0),E.strm.avail_out===0?Q:j):E.last_lit&&(D(E,!1),E.strm.avail_out===0)?k:V}function A(E,Y){for(var N,p,g;;){if(E.lookahead<oe){if(K(E),E.lookahead<oe&&Y===f)return k;if(E.lookahead===0)break}if(N=0,E.lookahead>=R&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+R-1])&E.hash_mask,N=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),E.prev_length=E.match_length,E.prev_match=E.match_start,E.match_length=R-1,N!==0&&E.prev_length<E.max_lazy_match&&E.strstart-N<=E.w_size-oe&&(E.match_length=re(E,N),E.match_length<=5&&(E.strategy===1||E.match_length===R&&4096<E.strstart-E.match_start)&&(E.match_length=R-1)),E.prev_length>=R&&E.match_length<=E.prev_length){for(g=E.strstart+E.lookahead-R,p=o._tr_tally(E,E.strstart-1-E.prev_match,E.prev_length-R),E.lookahead-=E.prev_length-1,E.prev_length-=2;++E.strstart<=g&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+R-1])&E.hash_mask,N=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),--E.prev_length!=0;);if(E.match_available=0,E.match_length=R-1,E.strstart++,p&&(D(E,!1),E.strm.avail_out===0))return k}else if(E.match_available){if((p=o._tr_tally(E,0,E.window[E.strstart-1]))&&D(E,!1),E.strstart++,E.lookahead--,E.strm.avail_out===0)return k}else E.match_available=1,E.strstart++,E.lookahead--}return E.match_available&&(p=o._tr_tally(E,0,E.window[E.strstart-1]),E.match_available=0),E.insert=E.strstart<R-1?E.strstart:R-1,Y===d?(D(E,!0),E.strm.avail_out===0?Q:j):E.last_lit&&(D(E,!1),E.strm.avail_out===0)?k:V}function W(E,Y,N,p,g){this.good_length=E,this.max_lazy=Y,this.nice_length=N,this.max_chain=p,this.func=g}function B(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*M),this.dyn_dtree=new a.Buf16(2*(2*T+1)),this.bl_tree=new a.Buf16(2*(2*P+1)),le(this.dyn_ltree),le(this.dyn_dtree),le(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(U+1),this.heap=new a.Buf16(2*w+1),le(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*w+1),le(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function I(E){var Y;return E&&E.state?(E.total_in=E.total_out=0,E.data_type=m,(Y=E.state).pending=0,Y.pending_out=0,Y.wrap<0&&(Y.wrap=-Y.wrap),Y.status=Y.wrap?C:H,E.adler=Y.wrap===2?0:1,Y.last_flush=f,o._tr_init(Y),h):ie(E,y)}function L(E){var Y=I(E);return Y===h&&(function(N){N.window_size=2*N.w_size,le(N.head),N.max_lazy_match=s[N.level].max_lazy,N.good_match=s[N.level].good_length,N.nice_match=s[N.level].nice_length,N.max_chain_length=s[N.level].max_chain,N.strstart=0,N.block_start=0,N.lookahead=0,N.insert=0,N.match_length=N.prev_length=R-1,N.match_available=0,N.ins_h=0})(E.state),Y}function Z(E,Y,N,p,g,S){if(!E)return y;var F=1;if(Y===v&&(Y=6),p<0?(F=0,p=-p):15<p&&(F=2,p-=16),g<1||b<g||N!==_||p<8||15<p||Y<0||9<Y||S<0||x<S)return ie(E,y);p===8&&(p=9);var q=new B;return(E.state=q).strm=E,q.wrap=F,q.gzhead=null,q.w_bits=p,q.w_size=1<<q.w_bits,q.w_mask=q.w_size-1,q.hash_bits=g+7,q.hash_size=1<<q.hash_bits,q.hash_mask=q.hash_size-1,q.hash_shift=~~((q.hash_bits+R-1)/R),q.window=new a.Buf8(2*q.w_size),q.head=new a.Buf16(q.hash_size),q.prev=new a.Buf16(q.w_size),q.lit_bufsize=1<<g+6,q.pending_buf_size=4*q.lit_bufsize,q.pending_buf=new a.Buf8(q.pending_buf_size),q.d_buf=1*q.lit_bufsize,q.l_buf=3*q.lit_bufsize,q.level=Y,q.strategy=S,q.method=N,L(E)}s=[new W(0,0,0,0,function(E,Y){var N=65535;for(N>E.pending_buf_size-5&&(N=E.pending_buf_size-5);;){if(E.lookahead<=1){if(K(E),E.lookahead===0&&Y===f)return k;if(E.lookahead===0)break}E.strstart+=E.lookahead,E.lookahead=0;var p=E.block_start+N;if((E.strstart===0||E.strstart>=p)&&(E.lookahead=E.strstart-p,E.strstart=p,D(E,!1),E.strm.avail_out===0)||E.strstart-E.block_start>=E.w_size-oe&&(D(E,!1),E.strm.avail_out===0))return k}return E.insert=0,Y===d?(D(E,!0),E.strm.avail_out===0?Q:j):(E.strstart>E.block_start&&(D(E,!1),E.strm.avail_out),k)}),new W(4,4,8,4,O),new W(4,5,16,8,O),new W(4,6,32,32,O),new W(4,4,16,16,A),new W(8,16,32,32,A),new W(8,16,128,128,A),new W(8,32,128,256,A),new W(32,128,258,1024,A),new W(32,258,258,4096,A)],i.deflateInit=function(E,Y){return Z(E,Y,_,15,8,0)},i.deflateInit2=Z,i.deflateReset=L,i.deflateResetKeep=I,i.deflateSetHeader=function(E,Y){return E&&E.state?E.state.wrap!==2?y:(E.state.gzhead=Y,h):y},i.deflate=function(E,Y){var N,p,g,S;if(!E||!E.state||5<Y||Y<0)return E?ie(E,y):y;if(p=E.state,!E.output||!E.input&&E.avail_in!==0||p.status===666&&Y!==d)return ie(E,E.avail_out===0?-5:y);if(p.strm=E,N=p.last_flush,p.last_flush=Y,p.status===C)if(p.wrap===2)E.adler=0,$(p,31),$(p,139),$(p,8),p.gzhead?($(p,(p.gzhead.text?1:0)+(p.gzhead.hcrc?2:0)+(p.gzhead.extra?4:0)+(p.gzhead.name?8:0)+(p.gzhead.comment?16:0)),$(p,255&p.gzhead.time),$(p,p.gzhead.time>>8&255),$(p,p.gzhead.time>>16&255),$(p,p.gzhead.time>>24&255),$(p,p.level===9?2:2<=p.strategy||p.level<2?4:0),$(p,255&p.gzhead.os),p.gzhead.extra&&p.gzhead.extra.length&&($(p,255&p.gzhead.extra.length),$(p,p.gzhead.extra.length>>8&255)),p.gzhead.hcrc&&(E.adler=u(E.adler,p.pending_buf,p.pending,0)),p.gzindex=0,p.status=69):($(p,0),$(p,0),$(p,0),$(p,0),$(p,0),$(p,p.level===9?2:2<=p.strategy||p.level<2?4:0),$(p,3),p.status=H);else{var F=_+(p.w_bits-8<<4)<<8;F|=(2<=p.strategy||p.level<2?0:p.level<6?1:p.level===6?2:3)<<6,p.strstart!==0&&(F|=32),F+=31-F%31,p.status=H,X(p,F),p.strstart!==0&&(X(p,E.adler>>>16),X(p,65535&E.adler)),E.adler=1}if(p.status===69)if(p.gzhead.extra){for(g=p.pending;p.gzindex<(65535&p.gzhead.extra.length)&&(p.pending!==p.pending_buf_size||(p.gzhead.hcrc&&p.pending>g&&(E.adler=u(E.adler,p.pending_buf,p.pending-g,g)),G(E),g=p.pending,p.pending!==p.pending_buf_size));)$(p,255&p.gzhead.extra[p.gzindex]),p.gzindex++;p.gzhead.hcrc&&p.pending>g&&(E.adler=u(E.adler,p.pending_buf,p.pending-g,g)),p.gzindex===p.gzhead.extra.length&&(p.gzindex=0,p.status=73)}else p.status=73;if(p.status===73)if(p.gzhead.name){g=p.pending;do{if(p.pending===p.pending_buf_size&&(p.gzhead.hcrc&&p.pending>g&&(E.adler=u(E.adler,p.pending_buf,p.pending-g,g)),G(E),g=p.pending,p.pending===p.pending_buf_size)){S=1;break}S=p.gzindex<p.gzhead.name.length?255&p.gzhead.name.charCodeAt(p.gzindex++):0,$(p,S)}while(S!==0);p.gzhead.hcrc&&p.pending>g&&(E.adler=u(E.adler,p.pending_buf,p.pending-g,g)),S===0&&(p.gzindex=0,p.status=91)}else p.status=91;if(p.status===91)if(p.gzhead.comment){g=p.pending;do{if(p.pending===p.pending_buf_size&&(p.gzhead.hcrc&&p.pending>g&&(E.adler=u(E.adler,p.pending_buf,p.pending-g,g)),G(E),g=p.pending,p.pending===p.pending_buf_size)){S=1;break}S=p.gzindex<p.gzhead.comment.length?255&p.gzhead.comment.charCodeAt(p.gzindex++):0,$(p,S)}while(S!==0);p.gzhead.hcrc&&p.pending>g&&(E.adler=u(E.adler,p.pending_buf,p.pending-g,g)),S===0&&(p.status=103)}else p.status=103;if(p.status===103&&(p.gzhead.hcrc?(p.pending+2>p.pending_buf_size&&G(E),p.pending+2<=p.pending_buf_size&&($(p,255&E.adler),$(p,E.adler>>8&255),E.adler=0,p.status=H)):p.status=H),p.pending!==0){if(G(E),E.avail_out===0)return p.last_flush=-1,h}else if(E.avail_in===0&&ee(Y)<=ee(N)&&Y!==d)return ie(E,-5);if(p.status===666&&E.avail_in!==0)return ie(E,-5);if(E.avail_in!==0||p.lookahead!==0||Y!==f&&p.status!==666){var q=p.strategy===2?(function(z,ne){for(var ae;;){if(z.lookahead===0&&(K(z),z.lookahead===0)){if(ne===f)return k;break}if(z.match_length=0,ae=o._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,ae&&(D(z,!1),z.strm.avail_out===0))return k}return z.insert=0,ne===d?(D(z,!0),z.strm.avail_out===0?Q:j):z.last_lit&&(D(z,!1),z.strm.avail_out===0)?k:V})(p,Y):p.strategy===3?(function(z,ne){for(var ae,se,fe,pe,ve=z.window;;){if(z.lookahead<=J){if(K(z),z.lookahead<=J&&ne===f)return k;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=R&&0<z.strstart&&(se=ve[fe=z.strstart-1])===ve[++fe]&&se===ve[++fe]&&se===ve[++fe]){pe=z.strstart+J;do;while(se===ve[++fe]&&se===ve[++fe]&&se===ve[++fe]&&se===ve[++fe]&&se===ve[++fe]&&se===ve[++fe]&&se===ve[++fe]&&se===ve[++fe]&&fe<pe);z.match_length=J-(pe-fe),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=R?(ae=o._tr_tally(z,1,z.match_length-R),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(ae=o._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),ae&&(D(z,!1),z.strm.avail_out===0))return k}return z.insert=0,ne===d?(D(z,!0),z.strm.avail_out===0?Q:j):z.last_lit&&(D(z,!1),z.strm.avail_out===0)?k:V})(p,Y):s[p.level].func(p,Y);if(q!==Q&&q!==j||(p.status=666),q===k||q===Q)return E.avail_out===0&&(p.last_flush=-1),h;if(q===V&&(Y===1?o._tr_align(p):Y!==5&&(o._tr_stored_block(p,0,0,!1),Y===3&&(le(p.head),p.lookahead===0&&(p.strstart=0,p.block_start=0,p.insert=0))),G(E),E.avail_out===0))return p.last_flush=-1,h}return Y!==d?h:p.wrap<=0?1:(p.wrap===2?($(p,255&E.adler),$(p,E.adler>>8&255),$(p,E.adler>>16&255),$(p,E.adler>>24&255),$(p,255&E.total_in),$(p,E.total_in>>8&255),$(p,E.total_in>>16&255),$(p,E.total_in>>24&255)):(X(p,E.adler>>>16),X(p,65535&E.adler)),G(E),0<p.wrap&&(p.wrap=-p.wrap),p.pending!==0?h:1)},i.deflateEnd=function(E){var Y;return E&&E.state?(Y=E.state.status)!==C&&Y!==69&&Y!==73&&Y!==91&&Y!==103&&Y!==H&&Y!==666?ie(E,y):(E.state=null,Y===H?ie(E,-3):h):y},i.deflateSetDictionary=function(E,Y){var N,p,g,S,F,q,z,ne,ae=Y.length;if(!E||!E.state||(S=(N=E.state).wrap)===2||S===1&&N.status!==C||N.lookahead)return y;for(S===1&&(E.adler=l(E.adler,Y,ae,0)),N.wrap=0,ae>=N.w_size&&(S===0&&(le(N.head),N.strstart=0,N.block_start=0,N.insert=0),ne=new a.Buf8(N.w_size),a.arraySet(ne,Y,ae-N.w_size,N.w_size,0),Y=ne,ae=N.w_size),F=E.avail_in,q=E.next_in,z=E.input,E.avail_in=ae,E.next_in=0,E.input=Y,K(N);N.lookahead>=R;){for(p=N.strstart,g=N.lookahead-(R-1);N.ins_h=(N.ins_h<<N.hash_shift^N.window[p+R-1])&N.hash_mask,N.prev[p&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=p,p++,--g;);N.strstart=p,N.lookahead=R-1,K(N)}return N.strstart+=N.lookahead,N.block_start=N.strstart,N.insert=N.lookahead,N.lookahead=0,N.match_length=N.prev_length=R-1,N.match_available=0,E.next_in=q,E.input=z,E.avail_in=F,N.wrap=S,h},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,n,i){n.exports=function(s,a){var o,l,u,c,f,d,h,y,v,x,m,_,b,w,T,P,M,U,R,J,oe,C,H,k,V;o=s.state,l=s.next_in,k=s.input,u=l+(s.avail_in-5),c=s.next_out,V=s.output,f=c-(a-s.avail_out),d=c+(s.avail_out-257),h=o.dmax,y=o.wsize,v=o.whave,x=o.wnext,m=o.window,_=o.hold,b=o.bits,w=o.lencode,T=o.distcode,P=(1<<o.lenbits)-1,M=(1<<o.distbits)-1;e:do{b<15&&(_+=k[l++]<<b,b+=8,_+=k[l++]<<b,b+=8),U=w[_&P];t:for(;;){if(_>>>=R=U>>>24,b-=R,(R=U>>>16&255)===0)V[c++]=65535&U;else{if(!(16&R)){if((64&R)==0){U=w[(65535&U)+(_&(1<<R)-1)];continue t}if(32&R){o.mode=12;break e}s.msg="invalid literal/length code",o.mode=30;break e}J=65535&U,(R&=15)&&(b<R&&(_+=k[l++]<<b,b+=8),J+=_&(1<<R)-1,_>>>=R,b-=R),b<15&&(_+=k[l++]<<b,b+=8,_+=k[l++]<<b,b+=8),U=T[_&M];r:for(;;){if(_>>>=R=U>>>24,b-=R,!(16&(R=U>>>16&255))){if((64&R)==0){U=T[(65535&U)+(_&(1<<R)-1)];continue r}s.msg="invalid distance code",o.mode=30;break e}if(oe=65535&U,b<(R&=15)&&(_+=k[l++]<<b,(b+=8)<R&&(_+=k[l++]<<b,b+=8)),h<(oe+=_&(1<<R)-1)){s.msg="invalid distance too far back",o.mode=30;break e}if(_>>>=R,b-=R,(R=c-f)<oe){if(v<(R=oe-R)&&o.sane){s.msg="invalid distance too far back",o.mode=30;break e}if(H=m,(C=0)===x){if(C+=y-R,R<J){for(J-=R;V[c++]=m[C++],--R;);C=c-oe,H=V}}else if(x<R){if(C+=y+x-R,(R-=x)<J){for(J-=R;V[c++]=m[C++],--R;);if(C=0,x<J){for(J-=R=x;V[c++]=m[C++],--R;);C=c-oe,H=V}}}else if(C+=x-R,R<J){for(J-=R;V[c++]=m[C++],--R;);C=c-oe,H=V}for(;2<J;)V[c++]=H[C++],V[c++]=H[C++],V[c++]=H[C++],J-=3;J&&(V[c++]=H[C++],1<J&&(V[c++]=H[C++]))}else{for(C=c-oe;V[c++]=V[C++],V[c++]=V[C++],V[c++]=V[C++],2<(J-=3););J&&(V[c++]=V[C++],1<J&&(V[c++]=V[C++]))}break}}break}}while(l<u&&c<d);l-=J=b>>3,_&=(1<<(b-=J<<3))-1,s.next_in=l,s.next_out=c,s.avail_in=l<u?u-l+5:5-(l-u),s.avail_out=c<d?d-c+257:257-(c-d),o.hold=_,o.bits=b}},{}],49:[function(t,n,i){var s=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),l=t("./inffast"),u=t("./inftrees"),c=1,f=2,d=0,h=-2,y=1,v=852,x=592;function m(C){return(C>>>24&255)+(C>>>8&65280)+((65280&C)<<8)+((255&C)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(C){var H;return C&&C.state?(H=C.state,C.total_in=C.total_out=H.total=0,C.msg="",H.wrap&&(C.adler=1&H.wrap),H.mode=y,H.last=0,H.havedict=0,H.dmax=32768,H.head=null,H.hold=0,H.bits=0,H.lencode=H.lendyn=new s.Buf32(v),H.distcode=H.distdyn=new s.Buf32(x),H.sane=1,H.back=-1,d):h}function w(C){var H;return C&&C.state?((H=C.state).wsize=0,H.whave=0,H.wnext=0,b(C)):h}function T(C,H){var k,V;return C&&C.state?(V=C.state,H<0?(k=0,H=-H):(k=1+(H>>4),H<48&&(H&=15)),H&&(H<8||15<H)?h:(V.window!==null&&V.wbits!==H&&(V.window=null),V.wrap=k,V.wbits=H,w(C))):h}function P(C,H){var k,V;return C?(V=new _,(C.state=V).window=null,(k=T(C,H))!==d&&(C.state=null),k):h}var M,U,R=!0;function J(C){if(R){var H;for(M=new s.Buf32(512),U=new s.Buf32(32),H=0;H<144;)C.lens[H++]=8;for(;H<256;)C.lens[H++]=9;for(;H<280;)C.lens[H++]=7;for(;H<288;)C.lens[H++]=8;for(u(c,C.lens,0,288,M,0,C.work,{bits:9}),H=0;H<32;)C.lens[H++]=5;u(f,C.lens,0,32,U,0,C.work,{bits:5}),R=!1}C.lencode=M,C.lenbits=9,C.distcode=U,C.distbits=5}function oe(C,H,k,V){var Q,j=C.state;return j.window===null&&(j.wsize=1<<j.wbits,j.wnext=0,j.whave=0,j.window=new s.Buf8(j.wsize)),V>=j.wsize?(s.arraySet(j.window,H,k-j.wsize,j.wsize,0),j.wnext=0,j.whave=j.wsize):(V<(Q=j.wsize-j.wnext)&&(Q=V),s.arraySet(j.window,H,k-V,Q,j.wnext),(V-=Q)?(s.arraySet(j.window,H,k-V,V,0),j.wnext=V,j.whave=j.wsize):(j.wnext+=Q,j.wnext===j.wsize&&(j.wnext=0),j.whave<j.wsize&&(j.whave+=Q))),0}i.inflateReset=w,i.inflateReset2=T,i.inflateResetKeep=b,i.inflateInit=function(C){return P(C,15)},i.inflateInit2=P,i.inflate=function(C,H){var k,V,Q,j,ie,ee,le,G,D,$,X,re,K,O,A,W,B,I,L,Z,E,Y,N,p,g=0,S=new s.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!C||!C.state||!C.output||!C.input&&C.avail_in!==0)return h;(k=C.state).mode===12&&(k.mode=13),ie=C.next_out,Q=C.output,le=C.avail_out,j=C.next_in,V=C.input,ee=C.avail_in,G=k.hold,D=k.bits,$=ee,X=le,Y=d;e:for(;;)switch(k.mode){case y:if(k.wrap===0){k.mode=13;break}for(;D<16;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(2&k.wrap&&G===35615){S[k.check=0]=255&G,S[1]=G>>>8&255,k.check=o(k.check,S,2,0),D=G=0,k.mode=2;break}if(k.flags=0,k.head&&(k.head.done=!1),!(1&k.wrap)||(((255&G)<<8)+(G>>8))%31){C.msg="incorrect header check",k.mode=30;break}if((15&G)!=8){C.msg="unknown compression method",k.mode=30;break}if(D-=4,E=8+(15&(G>>>=4)),k.wbits===0)k.wbits=E;else if(E>k.wbits){C.msg="invalid window size",k.mode=30;break}k.dmax=1<<E,C.adler=k.check=1,k.mode=512&G?10:12,D=G=0;break;case 2:for(;D<16;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(k.flags=G,(255&k.flags)!=8){C.msg="unknown compression method",k.mode=30;break}if(57344&k.flags){C.msg="unknown header flags set",k.mode=30;break}k.head&&(k.head.text=G>>8&1),512&k.flags&&(S[0]=255&G,S[1]=G>>>8&255,k.check=o(k.check,S,2,0)),D=G=0,k.mode=3;case 3:for(;D<32;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}k.head&&(k.head.time=G),512&k.flags&&(S[0]=255&G,S[1]=G>>>8&255,S[2]=G>>>16&255,S[3]=G>>>24&255,k.check=o(k.check,S,4,0)),D=G=0,k.mode=4;case 4:for(;D<16;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}k.head&&(k.head.xflags=255&G,k.head.os=G>>8),512&k.flags&&(S[0]=255&G,S[1]=G>>>8&255,k.check=o(k.check,S,2,0)),D=G=0,k.mode=5;case 5:if(1024&k.flags){for(;D<16;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}k.length=G,k.head&&(k.head.extra_len=G),512&k.flags&&(S[0]=255&G,S[1]=G>>>8&255,k.check=o(k.check,S,2,0)),D=G=0}else k.head&&(k.head.extra=null);k.mode=6;case 6:if(1024&k.flags&&(ee<(re=k.length)&&(re=ee),re&&(k.head&&(E=k.head.extra_len-k.length,k.head.extra||(k.head.extra=new Array(k.head.extra_len)),s.arraySet(k.head.extra,V,j,re,E)),512&k.flags&&(k.check=o(k.check,V,re,j)),ee-=re,j+=re,k.length-=re),k.length))break e;k.length=0,k.mode=7;case 7:if(2048&k.flags){if(ee===0)break e;for(re=0;E=V[j+re++],k.head&&E&&k.length<65536&&(k.head.name+=String.fromCharCode(E)),E&&re<ee;);if(512&k.flags&&(k.check=o(k.check,V,re,j)),ee-=re,j+=re,E)break e}else k.head&&(k.head.name=null);k.length=0,k.mode=8;case 8:if(4096&k.flags){if(ee===0)break e;for(re=0;E=V[j+re++],k.head&&E&&k.length<65536&&(k.head.comment+=String.fromCharCode(E)),E&&re<ee;);if(512&k.flags&&(k.check=o(k.check,V,re,j)),ee-=re,j+=re,E)break e}else k.head&&(k.head.comment=null);k.mode=9;case 9:if(512&k.flags){for(;D<16;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(G!==(65535&k.check)){C.msg="header crc mismatch",k.mode=30;break}D=G=0}k.head&&(k.head.hcrc=k.flags>>9&1,k.head.done=!0),C.adler=k.check=0,k.mode=12;break;case 10:for(;D<32;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}C.adler=k.check=m(G),D=G=0,k.mode=11;case 11:if(k.havedict===0)return C.next_out=ie,C.avail_out=le,C.next_in=j,C.avail_in=ee,k.hold=G,k.bits=D,2;C.adler=k.check=1,k.mode=12;case 12:if(H===5||H===6)break e;case 13:if(k.last){G>>>=7&D,D-=7&D,k.mode=27;break}for(;D<3;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}switch(k.last=1&G,D-=1,3&(G>>>=1)){case 0:k.mode=14;break;case 1:if(J(k),k.mode=20,H!==6)break;G>>>=2,D-=2;break e;case 2:k.mode=17;break;case 3:C.msg="invalid block type",k.mode=30}G>>>=2,D-=2;break;case 14:for(G>>>=7&D,D-=7&D;D<32;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if((65535&G)!=(G>>>16^65535)){C.msg="invalid stored block lengths",k.mode=30;break}if(k.length=65535&G,D=G=0,k.mode=15,H===6)break e;case 15:k.mode=16;case 16:if(re=k.length){if(ee<re&&(re=ee),le<re&&(re=le),re===0)break e;s.arraySet(Q,V,j,re,ie),ee-=re,j+=re,le-=re,ie+=re,k.length-=re;break}k.mode=12;break;case 17:for(;D<14;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(k.nlen=257+(31&G),G>>>=5,D-=5,k.ndist=1+(31&G),G>>>=5,D-=5,k.ncode=4+(15&G),G>>>=4,D-=4,286<k.nlen||30<k.ndist){C.msg="too many length or distance symbols",k.mode=30;break}k.have=0,k.mode=18;case 18:for(;k.have<k.ncode;){for(;D<3;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}k.lens[F[k.have++]]=7&G,G>>>=3,D-=3}for(;k.have<19;)k.lens[F[k.have++]]=0;if(k.lencode=k.lendyn,k.lenbits=7,N={bits:k.lenbits},Y=u(0,k.lens,0,19,k.lencode,0,k.work,N),k.lenbits=N.bits,Y){C.msg="invalid code lengths set",k.mode=30;break}k.have=0,k.mode=19;case 19:for(;k.have<k.nlen+k.ndist;){for(;W=(g=k.lencode[G&(1<<k.lenbits)-1])>>>16&255,B=65535&g,!((A=g>>>24)<=D);){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(B<16)G>>>=A,D-=A,k.lens[k.have++]=B;else{if(B===16){for(p=A+2;D<p;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(G>>>=A,D-=A,k.have===0){C.msg="invalid bit length repeat",k.mode=30;break}E=k.lens[k.have-1],re=3+(3&G),G>>>=2,D-=2}else if(B===17){for(p=A+3;D<p;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}D-=A,E=0,re=3+(7&(G>>>=A)),G>>>=3,D-=3}else{for(p=A+7;D<p;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}D-=A,E=0,re=11+(127&(G>>>=A)),G>>>=7,D-=7}if(k.have+re>k.nlen+k.ndist){C.msg="invalid bit length repeat",k.mode=30;break}for(;re--;)k.lens[k.have++]=E}}if(k.mode===30)break;if(k.lens[256]===0){C.msg="invalid code -- missing end-of-block",k.mode=30;break}if(k.lenbits=9,N={bits:k.lenbits},Y=u(c,k.lens,0,k.nlen,k.lencode,0,k.work,N),k.lenbits=N.bits,Y){C.msg="invalid literal/lengths set",k.mode=30;break}if(k.distbits=6,k.distcode=k.distdyn,N={bits:k.distbits},Y=u(f,k.lens,k.nlen,k.ndist,k.distcode,0,k.work,N),k.distbits=N.bits,Y){C.msg="invalid distances set",k.mode=30;break}if(k.mode=20,H===6)break e;case 20:k.mode=21;case 21:if(6<=ee&&258<=le){C.next_out=ie,C.avail_out=le,C.next_in=j,C.avail_in=ee,k.hold=G,k.bits=D,l(C,X),ie=C.next_out,Q=C.output,le=C.avail_out,j=C.next_in,V=C.input,ee=C.avail_in,G=k.hold,D=k.bits,k.mode===12&&(k.back=-1);break}for(k.back=0;W=(g=k.lencode[G&(1<<k.lenbits)-1])>>>16&255,B=65535&g,!((A=g>>>24)<=D);){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(W&&(240&W)==0){for(I=A,L=W,Z=B;W=(g=k.lencode[Z+((G&(1<<I+L)-1)>>I)])>>>16&255,B=65535&g,!(I+(A=g>>>24)<=D);){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}G>>>=I,D-=I,k.back+=I}if(G>>>=A,D-=A,k.back+=A,k.length=B,W===0){k.mode=26;break}if(32&W){k.back=-1,k.mode=12;break}if(64&W){C.msg="invalid literal/length code",k.mode=30;break}k.extra=15&W,k.mode=22;case 22:if(k.extra){for(p=k.extra;D<p;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}k.length+=G&(1<<k.extra)-1,G>>>=k.extra,D-=k.extra,k.back+=k.extra}k.was=k.length,k.mode=23;case 23:for(;W=(g=k.distcode[G&(1<<k.distbits)-1])>>>16&255,B=65535&g,!((A=g>>>24)<=D);){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if((240&W)==0){for(I=A,L=W,Z=B;W=(g=k.distcode[Z+((G&(1<<I+L)-1)>>I)])>>>16&255,B=65535&g,!(I+(A=g>>>24)<=D);){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}G>>>=I,D-=I,k.back+=I}if(G>>>=A,D-=A,k.back+=A,64&W){C.msg="invalid distance code",k.mode=30;break}k.offset=B,k.extra=15&W,k.mode=24;case 24:if(k.extra){for(p=k.extra;D<p;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}k.offset+=G&(1<<k.extra)-1,G>>>=k.extra,D-=k.extra,k.back+=k.extra}if(k.offset>k.dmax){C.msg="invalid distance too far back",k.mode=30;break}k.mode=25;case 25:if(le===0)break e;if(re=X-le,k.offset>re){if((re=k.offset-re)>k.whave&&k.sane){C.msg="invalid distance too far back",k.mode=30;break}K=re>k.wnext?(re-=k.wnext,k.wsize-re):k.wnext-re,re>k.length&&(re=k.length),O=k.window}else O=Q,K=ie-k.offset,re=k.length;for(le<re&&(re=le),le-=re,k.length-=re;Q[ie++]=O[K++],--re;);k.length===0&&(k.mode=21);break;case 26:if(le===0)break e;Q[ie++]=k.length,le--,k.mode=21;break;case 27:if(k.wrap){for(;D<32;){if(ee===0)break e;ee--,G|=V[j++]<<D,D+=8}if(X-=le,C.total_out+=X,k.total+=X,X&&(C.adler=k.check=k.flags?o(k.check,Q,X,ie-X):a(k.check,Q,X,ie-X)),X=le,(k.flags?G:m(G))!==k.check){C.msg="incorrect data check",k.mode=30;break}D=G=0}k.mode=28;case 28:if(k.wrap&&k.flags){for(;D<32;){if(ee===0)break e;ee--,G+=V[j++]<<D,D+=8}if(G!==(4294967295&k.total)){C.msg="incorrect length check",k.mode=30;break}D=G=0}k.mode=29;case 29:Y=1;break e;case 30:Y=-3;break e;case 31:return-4;case 32:default:return h}return C.next_out=ie,C.avail_out=le,C.next_in=j,C.avail_in=ee,k.hold=G,k.bits=D,(k.wsize||X!==C.avail_out&&k.mode<30&&(k.mode<27||H!==4))&&oe(C,C.output,C.next_out,X-C.avail_out)?(k.mode=31,-4):($-=C.avail_in,X-=C.avail_out,C.total_in+=$,C.total_out+=X,k.total+=X,k.wrap&&X&&(C.adler=k.check=k.flags?o(k.check,Q,X,C.next_out-X):a(k.check,Q,X,C.next_out-X)),C.data_type=k.bits+(k.last?64:0)+(k.mode===12?128:0)+(k.mode===20||k.mode===15?256:0),($==0&&X===0||H===4)&&Y===d&&(Y=-5),Y)},i.inflateEnd=function(C){if(!C||!C.state)return h;var H=C.state;return H.window&&(H.window=null),C.state=null,d},i.inflateGetHeader=function(C,H){var k;return C&&C.state?(2&(k=C.state).wrap)==0?h:((k.head=H).done=!1,d):h},i.inflateSetDictionary=function(C,H){var k,V=H.length;return C&&C.state?(k=C.state).wrap!==0&&k.mode!==11?h:k.mode===11&&a(1,H,V,0)!==k.check?-3:oe(C,H,V,V)?(k.mode=31,-4):(k.havedict=1,d):h},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,n,i){var s=t("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(c,f,d,h,y,v,x,m){var _,b,w,T,P,M,U,R,J,oe=m.bits,C=0,H=0,k=0,V=0,Q=0,j=0,ie=0,ee=0,le=0,G=0,D=null,$=0,X=new s.Buf16(16),re=new s.Buf16(16),K=null,O=0;for(C=0;C<=15;C++)X[C]=0;for(H=0;H<h;H++)X[f[d+H]]++;for(Q=oe,V=15;1<=V&&X[V]===0;V--);if(V<Q&&(Q=V),V===0)return y[v++]=20971520,y[v++]=20971520,m.bits=1,0;for(k=1;k<V&&X[k]===0;k++);for(Q<k&&(Q=k),C=ee=1;C<=15;C++)if(ee<<=1,(ee-=X[C])<0)return-1;if(0<ee&&(c===0||V!==1))return-1;for(re[1]=0,C=1;C<15;C++)re[C+1]=re[C]+X[C];for(H=0;H<h;H++)f[d+H]!==0&&(x[re[f[d+H]]++]=H);if(M=c===0?(D=K=x,19):c===1?(D=a,$-=257,K=o,O-=257,256):(D=l,K=u,-1),C=k,P=v,ie=H=G=0,w=-1,T=(le=1<<(j=Q))-1,c===1&&852<le||c===2&&592<le)return 1;for(;;){for(U=C-ie,J=x[H]<M?(R=0,x[H]):x[H]>M?(R=K[O+x[H]],D[$+x[H]]):(R=96,0),_=1<<C-ie,k=b=1<<j;y[P+(G>>ie)+(b-=_)]=U<<24|R<<16|J|0,b!==0;);for(_=1<<C-1;G&_;)_>>=1;if(_!==0?(G&=_-1,G+=_):G=0,H++,--X[C]==0){if(C===V)break;C=f[d+x[H]]}if(Q<C&&(G&T)!==w){for(ie===0&&(ie=Q),P+=k,ee=1<<(j=C-ie);j+ie<V&&!((ee-=X[j+ie])<=0);)j++,ee<<=1;if(le+=1<<j,c===1&&852<le||c===2&&592<le)return 1;y[w=G&T]=Q<<24|j<<16|P-v|0}}return G!==0&&(y[P+G]=C-ie<<24|64<<16|0),m.bits=Q,0}},{"../utils/common":41}],51:[function(t,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,n,i){var s=t("../utils/common"),a=0,o=1;function l(g){for(var S=g.length;0<=--S;)g[S]=0}var u=0,c=29,f=256,d=f+1+c,h=30,y=19,v=2*d+1,x=15,m=16,_=7,b=256,w=16,T=17,P=18,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],U=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=new Array(2*(d+2));l(oe);var C=new Array(2*h);l(C);var H=new Array(512);l(H);var k=new Array(256);l(k);var V=new Array(c);l(V);var Q,j,ie,ee=new Array(h);function le(g,S,F,q,z){this.static_tree=g,this.extra_bits=S,this.extra_base=F,this.elems=q,this.max_length=z,this.has_stree=g&&g.length}function G(g,S){this.dyn_tree=g,this.max_code=0,this.stat_desc=S}function D(g){return g<256?H[g]:H[256+(g>>>7)]}function $(g,S){g.pending_buf[g.pending++]=255&S,g.pending_buf[g.pending++]=S>>>8&255}function X(g,S,F){g.bi_valid>m-F?(g.bi_buf|=S<<g.bi_valid&65535,$(g,g.bi_buf),g.bi_buf=S>>m-g.bi_valid,g.bi_valid+=F-m):(g.bi_buf|=S<<g.bi_valid&65535,g.bi_valid+=F)}function re(g,S,F){X(g,F[2*S],F[2*S+1])}function K(g,S){for(var F=0;F|=1&g,g>>>=1,F<<=1,0<--S;);return F>>>1}function O(g,S,F){var q,z,ne=new Array(x+1),ae=0;for(q=1;q<=x;q++)ne[q]=ae=ae+F[q-1]<<1;for(z=0;z<=S;z++){var se=g[2*z+1];se!==0&&(g[2*z]=K(ne[se]++,se))}}function A(g){var S;for(S=0;S<d;S++)g.dyn_ltree[2*S]=0;for(S=0;S<h;S++)g.dyn_dtree[2*S]=0;for(S=0;S<y;S++)g.bl_tree[2*S]=0;g.dyn_ltree[2*b]=1,g.opt_len=g.static_len=0,g.last_lit=g.matches=0}function W(g){8<g.bi_valid?$(g,g.bi_buf):0<g.bi_valid&&(g.pending_buf[g.pending++]=g.bi_buf),g.bi_buf=0,g.bi_valid=0}function B(g,S,F,q){var z=2*S,ne=2*F;return g[z]<g[ne]||g[z]===g[ne]&&q[S]<=q[F]}function I(g,S,F){for(var q=g.heap[F],z=F<<1;z<=g.heap_len&&(z<g.heap_len&&B(S,g.heap[z+1],g.heap[z],g.depth)&&z++,!B(S,q,g.heap[z],g.depth));)g.heap[F]=g.heap[z],F=z,z<<=1;g.heap[F]=q}function L(g,S,F){var q,z,ne,ae,se=0;if(g.last_lit!==0)for(;q=g.pending_buf[g.d_buf+2*se]<<8|g.pending_buf[g.d_buf+2*se+1],z=g.pending_buf[g.l_buf+se],se++,q===0?re(g,z,S):(re(g,(ne=k[z])+f+1,S),(ae=M[ne])!==0&&X(g,z-=V[ne],ae),re(g,ne=D(--q),F),(ae=U[ne])!==0&&X(g,q-=ee[ne],ae)),se<g.last_lit;);re(g,b,S)}function Z(g,S){var F,q,z,ne=S.dyn_tree,ae=S.stat_desc.static_tree,se=S.stat_desc.has_stree,fe=S.stat_desc.elems,pe=-1;for(g.heap_len=0,g.heap_max=v,F=0;F<fe;F++)ne[2*F]!==0?(g.heap[++g.heap_len]=pe=F,g.depth[F]=0):ne[2*F+1]=0;for(;g.heap_len<2;)ne[2*(z=g.heap[++g.heap_len]=pe<2?++pe:0)]=1,g.depth[z]=0,g.opt_len--,se&&(g.static_len-=ae[2*z+1]);for(S.max_code=pe,F=g.heap_len>>1;1<=F;F--)I(g,ne,F);for(z=fe;F=g.heap[1],g.heap[1]=g.heap[g.heap_len--],I(g,ne,1),q=g.heap[1],g.heap[--g.heap_max]=F,g.heap[--g.heap_max]=q,ne[2*z]=ne[2*F]+ne[2*q],g.depth[z]=(g.depth[F]>=g.depth[q]?g.depth[F]:g.depth[q])+1,ne[2*F+1]=ne[2*q+1]=z,g.heap[1]=z++,I(g,ne,1),2<=g.heap_len;);g.heap[--g.heap_max]=g.heap[1],(function(ve,Me){var yt,tt,fr,Oe,ln,li,ct=Me.dyn_tree,wo=Me.max_code,Nd=Me.stat_desc.static_tree,Rd=Me.stat_desc.has_stree,Cd=Me.stat_desc.extra_bits,bo=Me.stat_desc.extra_base,hr=Me.stat_desc.max_length,un=0;for(Oe=0;Oe<=x;Oe++)ve.bl_count[Oe]=0;for(ct[2*ve.heap[ve.heap_max]+1]=0,yt=ve.heap_max+1;yt<v;yt++)hr<(Oe=ct[2*ct[2*(tt=ve.heap[yt])+1]+1]+1)&&(Oe=hr,un++),ct[2*tt+1]=Oe,wo<tt||(ve.bl_count[Oe]++,ln=0,bo<=tt&&(ln=Cd[tt-bo]),li=ct[2*tt],ve.opt_len+=li*(Oe+ln),Rd&&(ve.static_len+=li*(Nd[2*tt+1]+ln)));if(un!==0){do{for(Oe=hr-1;ve.bl_count[Oe]===0;)Oe--;ve.bl_count[Oe]--,ve.bl_count[Oe+1]+=2,ve.bl_count[hr]--,un-=2}while(0<un);for(Oe=hr;Oe!==0;Oe--)for(tt=ve.bl_count[Oe];tt!==0;)wo<(fr=ve.heap[--yt])||(ct[2*fr+1]!==Oe&&(ve.opt_len+=(Oe-ct[2*fr+1])*ct[2*fr],ct[2*fr+1]=Oe),tt--)}})(g,S),O(ne,pe,g.bl_count)}function E(g,S,F){var q,z,ne=-1,ae=S[1],se=0,fe=7,pe=4;for(ae===0&&(fe=138,pe=3),S[2*(F+1)+1]=65535,q=0;q<=F;q++)z=ae,ae=S[2*(q+1)+1],++se<fe&&z===ae||(se<pe?g.bl_tree[2*z]+=se:z!==0?(z!==ne&&g.bl_tree[2*z]++,g.bl_tree[2*w]++):se<=10?g.bl_tree[2*T]++:g.bl_tree[2*P]++,ne=z,pe=(se=0)===ae?(fe=138,3):z===ae?(fe=6,3):(fe=7,4))}function Y(g,S,F){var q,z,ne=-1,ae=S[1],se=0,fe=7,pe=4;for(ae===0&&(fe=138,pe=3),q=0;q<=F;q++)if(z=ae,ae=S[2*(q+1)+1],!(++se<fe&&z===ae)){if(se<pe)for(;re(g,z,g.bl_tree),--se!=0;);else z!==0?(z!==ne&&(re(g,z,g.bl_tree),se--),re(g,w,g.bl_tree),X(g,se-3,2)):se<=10?(re(g,T,g.bl_tree),X(g,se-3,3)):(re(g,P,g.bl_tree),X(g,se-11,7));ne=z,pe=(se=0)===ae?(fe=138,3):z===ae?(fe=6,3):(fe=7,4)}}l(ee);var N=!1;function p(g,S,F,q){X(g,(u<<1)+(q?1:0),3),(function(z,ne,ae,se){W(z),$(z,ae),$(z,~ae),s.arraySet(z.pending_buf,z.window,ne,ae,z.pending),z.pending+=ae})(g,S,F)}i._tr_init=function(g){N||((function(){var S,F,q,z,ne,ae=new Array(x+1);for(z=q=0;z<c-1;z++)for(V[z]=q,S=0;S<1<<M[z];S++)k[q++]=z;for(k[q-1]=z,z=ne=0;z<16;z++)for(ee[z]=ne,S=0;S<1<<U[z];S++)H[ne++]=z;for(ne>>=7;z<h;z++)for(ee[z]=ne<<7,S=0;S<1<<U[z]-7;S++)H[256+ne++]=z;for(F=0;F<=x;F++)ae[F]=0;for(S=0;S<=143;)oe[2*S+1]=8,S++,ae[8]++;for(;S<=255;)oe[2*S+1]=9,S++,ae[9]++;for(;S<=279;)oe[2*S+1]=7,S++,ae[7]++;for(;S<=287;)oe[2*S+1]=8,S++,ae[8]++;for(O(oe,d+1,ae),S=0;S<h;S++)C[2*S+1]=5,C[2*S]=K(S,5);Q=new le(oe,M,f+1,d,x),j=new le(C,U,0,h,x),ie=new le(new Array(0),R,0,y,_)})(),N=!0),g.l_desc=new G(g.dyn_ltree,Q),g.d_desc=new G(g.dyn_dtree,j),g.bl_desc=new G(g.bl_tree,ie),g.bi_buf=0,g.bi_valid=0,A(g)},i._tr_stored_block=p,i._tr_flush_block=function(g,S,F,q){var z,ne,ae=0;0<g.level?(g.strm.data_type===2&&(g.strm.data_type=(function(se){var fe,pe=4093624447;for(fe=0;fe<=31;fe++,pe>>>=1)if(1&pe&&se.dyn_ltree[2*fe]!==0)return a;if(se.dyn_ltree[18]!==0||se.dyn_ltree[20]!==0||se.dyn_ltree[26]!==0)return o;for(fe=32;fe<f;fe++)if(se.dyn_ltree[2*fe]!==0)return o;return a})(g)),Z(g,g.l_desc),Z(g,g.d_desc),ae=(function(se){var fe;for(E(se,se.dyn_ltree,se.l_desc.max_code),E(se,se.dyn_dtree,se.d_desc.max_code),Z(se,se.bl_desc),fe=y-1;3<=fe&&se.bl_tree[2*J[fe]+1]===0;fe--);return se.opt_len+=3*(fe+1)+5+5+4,fe})(g),z=g.opt_len+3+7>>>3,(ne=g.static_len+3+7>>>3)<=z&&(z=ne)):z=ne=F+5,F+4<=z&&S!==-1?p(g,S,F,q):g.strategy===4||ne===z?(X(g,2+(q?1:0),3),L(g,oe,C)):(X(g,4+(q?1:0),3),(function(se,fe,pe,ve){var Me;for(X(se,fe-257,5),X(se,pe-1,5),X(se,ve-4,4),Me=0;Me<ve;Me++)X(se,se.bl_tree[2*J[Me]+1],3);Y(se,se.dyn_ltree,fe-1),Y(se,se.dyn_dtree,pe-1)})(g,g.l_desc.max_code+1,g.d_desc.max_code+1,ae+1),L(g,g.dyn_ltree,g.dyn_dtree)),A(g),q&&W(g)},i._tr_tally=function(g,S,F){return g.pending_buf[g.d_buf+2*g.last_lit]=S>>>8&255,g.pending_buf[g.d_buf+2*g.last_lit+1]=255&S,g.pending_buf[g.l_buf+g.last_lit]=255&F,g.last_lit++,S===0?g.dyn_ltree[2*F]++:(g.matches++,S--,g.dyn_ltree[2*(k[F]+f+1)]++,g.dyn_dtree[2*D(S)]++),g.last_lit===g.lit_bufsize-1},i._tr_align=function(g){X(g,2,3),re(g,b,oe),(function(S){S.bi_valid===16?($(S,S.bi_buf),S.bi_buf=0,S.bi_valid=0):8<=S.bi_valid&&(S.pending_buf[S.pending++]=255&S.bi_buf,S.bi_buf>>=8,S.bi_valid-=8)})(g)}},{"../utils/common":41}],53:[function(t,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,n,i){(function(s){(function(a,o){if(!a.setImmediate){var l,u,c,f,d=1,h={},y=!1,v=a.document,x=Object.getPrototypeOf&&Object.getPrototypeOf(a);x=x&&x.setTimeout?x:a,l={}.toString.call(a.process)==="[object process]"?function(w){Ie.nextTick(function(){_(w)})}:(function(){if(a.postMessage&&!a.importScripts){var w=!0,T=a.onmessage;return a.onmessage=function(){w=!1},a.postMessage("","*"),a.onmessage=T,w}})()?(f="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",b,!1):a.attachEvent("onmessage",b),function(w){a.postMessage(f+w,"*")}):a.MessageChannel?((c=new MessageChannel).port1.onmessage=function(w){_(w.data)},function(w){c.port2.postMessage(w)}):v&&"onreadystatechange"in v.createElement("script")?(u=v.documentElement,function(w){var T=v.createElement("script");T.onreadystatechange=function(){_(w),T.onreadystatechange=null,u.removeChild(T),T=null},u.appendChild(T)}):function(w){setTimeout(_,0,w)},x.setImmediate=function(w){typeof w!="function"&&(w=new Function(""+w));for(var T=new Array(arguments.length-1),P=0;P<T.length;P++)T[P]=arguments[P+1];var M={callback:w,args:T};return h[d]=M,l(d),d++},x.clearImmediate=m}function m(w){delete h[w]}function _(w){if(y)setTimeout(_,0,w);else{var T=h[w];if(T){y=!0;try{(function(P){var M=P.callback,U=P.args;switch(U.length){case 0:M();break;case 1:M(U[0]);break;case 2:M(U[0],U[1]);break;case 3:M(U[0],U[1],U[2]);break;default:M.apply(o,U)}})(T)}finally{m(w),y=!1}}}}function b(w){w.source===a&&typeof w.data=="string"&&w.data.indexOf(f)===0&&_(+w.data.slice(f.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Qr<"u"?Qr:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(fx)),fx.exports}var SZ=EZ(),co=fT(SZ),tl={exports:{}},hx,UL;function kZ(){if(UL)return hx;UL=1;var r={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function e(t){return t&&t.replace?t.replace(/([&"<>'])/g,function(n,i){return r[i]}):t}return hx=e,hx}var HL;function TZ(){if(HL)return tl.exports;HL=1;var r=kZ(),e=vT().Stream,t="    ";function n(u,c){typeof c!="object"&&(c={indent:c});var f=c.stream?new e:null,d="",h=!1,y=c.indent?c.indent===!0?t:c.indent:"",v=!0;function x(T){v?Ie.nextTick(T):T()}function m(T,P){if(P!==void 0&&(d+=P),T&&!h&&(f=f||new e,h=!0),T&&h){var M=d;x(function(){f.emit("data",M)}),d=""}}function _(T,P){o(m,a(T,y,y?1:0),P)}function b(){if(f){var T=d;x(function(){f.emit("data",T),f.emit("end"),f.readable=!1,f.emit("close")})}}function w(T){var P=T.encoding||"UTF-8",M={version:"1.0",encoding:P};T.standalone&&(M.standalone=T.standalone),_({"?xml":{_attr:M}}),d=d.replace("/>","?>")}return x(function(){v=!1}),c.declaration&&w(c.declaration),u&&u.forEach?u.forEach(function(T,P){var M;P+1===u.length&&(M=b),_(T,M)}):_(u,b),f?(f.readable=!0,f):d}function i(){var u=Array.prototype.slice.call(arguments),c={_elem:a(u)};return c.push=function(f){if(!this.append)throw new Error("not assigned to a parent!");var d=this,h=this._elem.indent;o(this.append,a(f,h,this._elem.icount+(h?1:0)),function(){d.append(!0)})},c.close=function(f){f!==void 0&&this.push(f),this.end&&this.end()},c}function s(u,c){return new Array(c||0).join(u||"")}function a(u,c,f){f=f||0;var d=s(c,f),h,y=u,v=!1;if(typeof u=="object"){var x=Object.keys(u);if(h=x[0],y=u[h],y&&y._elem)return y._elem.name=h,y._elem.icount=f,y._elem.indent=c,y._elem.indents=d,y._elem.interrupt=y,y._elem}var m=[],_=[],b;function w(T){var P=Object.keys(T);P.forEach(function(M){m.push(l(M,T[M]))})}switch(typeof y){case"object":if(y===null)break;y._attr&&w(y._attr),y._cdata&&_.push(("<![CDATA["+y._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),y.forEach&&(b=!1,_.push(""),y.forEach(function(T){if(typeof T=="object"){var P=Object.keys(T)[0];P=="_attr"?w(T._attr):_.push(a(T,c,f+1))}else _.pop(),b=!0,_.push(r(T))}),b||_.push(""));break;default:_.push(r(y))}return{name:h,interrupt:v,attributes:m,content:_,icount:f,indents:d,indent:c}}function o(u,c,f){if(typeof c!="object")return u(!1,c);var d=c.interrupt?1:c.content.length;function h(){for(;c.content.length;){var v=c.content.shift();if(v!==void 0){if(y(v))return;o(u,v)}}u(!1,(d>1?c.indents:"")+(c.name?"</"+c.name+">":"")+(c.indent&&!f?`
`:"")),f&&f()}function y(v){return v.interrupt?(v.interrupt.append=u,v.interrupt.end=h,v.interrupt=!1,u(!0),!0):!1}if(u(!1,c.indents+(c.name?"<"+c.name:"")+(c.attributes.length?" "+c.attributes.join(" "):"")+(d?c.name?">":"":c.name?"/>":"")+(c.indent&&d>1?`
`:"")),!d)return u(!1,c.indent?`
`:"");y(c)||h()}function l(u,c){return u+'="'+r(c)+'"'}return tl.exports=n,tl.exports.element=tl.exports.Element=i,tl.exports}var AZ=TZ(),Je=fT(AZ),rl=0,dx=32,OZ=32,NZ=(r,e)=>{let t=e.replace(/-/g,"");if(t.length!==OZ)throw new Error(`Error: Cannot extract GUID from font filename: ${e}`);let i=t.replace(/(..)/g,"$1 ").trim().split(" ").map(l=>parseInt(l,16));i.reverse();let a=r.slice(rl,dx).map((l,u)=>l^i[u%i.length]),o=new Uint8Array(rl+a.length+Math.max(0,r.length-dx));return o.set(r.slice(0,rl)),o.set(a,rl),o.set(r.slice(dx),rl+a.length),o},kl=class{format(e,t={stack:[]}){let n=e.prepForXml(t);if(n)return n;throw Error("XMLComponent did not format correctly")}},wd=class{replace(e,t,n){let i=e;return t.forEach((s,a)=>{i=i.replace(new RegExp(`{${s.fileName}}`,"g"),(n+a).toString())}),i}getMediaData(e,t){return t.Array.filter(n=>e.search(`{${n.fileName}}`)>0)}},aT=class{replace(e,t){let n=e;for(let i of t)n=n.replace(new RegExp(`{${i.reference}-${i.instance}}`,"g"),i.numId.toString());return n}},lT=class{constructor(){ce(this,"formatter"),ce(this,"imageReplacer"),ce(this,"numberingReplacer"),this.formatter=new kl,this.imageReplacer=new wd,this.numberingReplacer=new aT}compile(e,t,n=[]){let i=new co,s=this.xmlifyFile(e,t),a=new Map(Object.entries(s));for(let[,o]of a)if(Array.isArray(o))for(let l of o)i.file(l.path,l.data);else i.file(o.path,o.data);for(let o of n)i.file(o.path,o.data);for(let o of e.Media.Array)o.type!=="svg"?i.file(`word/media/${o.fileName}`,o.data):(i.file(`word/media/${o.fileName}`,o.data),i.file(`word/media/${o.fallback.fileName}`,o.fallback.data));for(let{data:o,name:l,fontKey:u}of e.FontTable.fontOptionsWithKey){let[c]=l.split(".");i.file(`word/fonts/${c}.odttf`,NZ(o,u))}return i}xmlifyFile(e,t){let n=e.Document.Relationships.RelationshipCount+1,i=Je(this.formatter.format(e.Document.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),s=e.Comments.Relationships.RelationshipCount+1,a=Je(this.formatter.format(e.Comments,{viewWrapper:{View:e.Comments,Relationships:e.Comments.Relationships},file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),o=this.imageReplacer.getMediaData(i,e.Media),l=this.imageReplacer.getMediaData(a,e.Media);return{Relationships:{data:(o.forEach((u,c)=>{e.Document.Relationships.createRelationship(n+c,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${u.fileName}`)}),e.Document.Relationships.createRelationship(e.Document.Relationships.RelationshipCount+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable","fontTable.xml"),Je(this.formatter.format(e.Document.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{let u=this.imageReplacer.replace(i,o,n);return this.numberingReplacer.replace(u,e.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{let u=Je(this.formatter.format(e.Styles,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(u,e.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:Je(this.formatter.format(e.CoreProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:Je(this.formatter.format(e.Numbering,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:Je(this.formatter.format(e.FileRelationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:e.Headers.map((u,c)=>{let f=Je(this.formatter.format(u.View,{viewWrapper:u,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(f,e.Media).forEach((h,y)=>{u.Relationships.createRelationship(y,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${h.fileName}`)}),{data:Je(this.formatter.format(u.Relationships,{viewWrapper:u,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${c+1}.xml.rels`}}),FooterRelationships:e.Footers.map((u,c)=>{let f=Je(this.formatter.format(u.View,{viewWrapper:u,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(f,e.Media).forEach((h,y)=>{u.Relationships.createRelationship(y,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${h.fileName}`)}),{data:Je(this.formatter.format(u.Relationships,{viewWrapper:u,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${c+1}.xml.rels`}}),Headers:e.Headers.map((u,c)=>{let f=Je(this.formatter.format(u.View,{viewWrapper:u,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),d=this.imageReplacer.getMediaData(f,e.Media),h=this.imageReplacer.replace(f,d,0);return{data:this.numberingReplacer.replace(h,e.Numbering.ConcreteNumbering),path:`word/header${c+1}.xml`}}),Footers:e.Footers.map((u,c)=>{let f=Je(this.formatter.format(u.View,{viewWrapper:u,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),d=this.imageReplacer.getMediaData(f,e.Media),h=this.imageReplacer.replace(f,d,0);return{data:this.numberingReplacer.replace(h,e.Numbering.ConcreteNumbering),path:`word/footer${c+1}.xml`}}),ContentTypes:{data:Je(this.formatter.format(e.ContentTypes,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:Je(this.formatter.format(e.CustomProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:Je(this.formatter.format(e.AppProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:Je(this.formatter.format(e.FootNotes.View,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:Je(this.formatter.format(e.FootNotes.Relationships,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:Je(this.formatter.format(e.Settings,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:(()=>{let u=this.imageReplacer.replace(a,l,s);return this.numberingReplacer.replace(u,e.Numbering.ConcreteNumbering)})(),path:"word/comments.xml"},CommentsRelationships:{data:(l.forEach((u,c)=>{e.Comments.Relationships.createRelationship(s+c,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${u.fileName}`)}),Je(this.formatter.format(e.Comments.Relationships,{viewWrapper:{View:e.Comments,Relationships:e.Comments.Relationships},file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}})),path:"word/_rels/comments.xml.rels"},FontTable:{data:Je(this.formatter.format(e.FontTable.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/fontTable.xml"},FontTableRelationships:{data:Je(this.formatter.format(e.FontTable.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/fontTable.xml.rels"}}}},l4={NONE:"",WITH_2_BLANKS:"  ",WITH_4_BLANKS:"    ",WITH_TAB:"	"},zL=r=>r===!0?l4.WITH_2_BLANKS:r===!1?void 0:r,u4=class no{static pack(e,t,n){return cT(this,arguments,function*(i,s,a,o=[]){return this.compiler.compile(i,zL(a),o).generateAsync({type:s,mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toString(e,t,n=[]){return no.pack(e,"string",t,n)}static toBuffer(e,t,n=[]){return no.pack(e,"nodebuffer",t,n)}static toBase64String(e,t,n=[]){return no.pack(e,"base64",t,n)}static toBlob(e,t,n=[]){return no.pack(e,"blob",t,n)}static toArrayBuffer(e,t,n=[]){return no.pack(e,"arraybuffer",t,n)}static toStream(e,t,n=[]){let i=new xZ.Stream;return this.compiler.compile(e,zL(t),n).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(a=>{i.emit("data",a),i.emit("end")}),i}};ce(u4,"compiler",new lT);var RZ=u4,CZ=new kl,Ad=r=>xd.xml2js(r,{compact:!1,captureSpacesBetweenElements:!0}),c4=r=>{var e;return(e=Ad(Je(CZ.format(new hl({text:r})))).elements[0].elements)!=null?e:[]},f4=r=>It(Te({},r),{attributes:{"xml:space":"preserve"}}),AT=(r,e)=>{var t,n;return(n=(t=r.elements)==null?void 0:t.filter(i=>i.name===e)[0].elements)!=null?n:[]},to=(r,e,t)=>{let n=AT(r,"Types");n.some(s=>{var a,o;return s.type==="element"&&s.name==="Default"&&((a=s?.attributes)==null?void 0:a.ContentType)===e&&((o=s?.attributes)==null?void 0:o.Extension)===t})||n.push({attributes:{ContentType:e,Extension:t},name:"Default",type:"element"})},IZ=r=>{let e=parseInt(r.substring(3),10);return isNaN(e)?0:e},PZ=r=>AT(r,"Relationships").map(t=>{var n,i,s;return IZ((s=(i=(n=t.attributes)==null?void 0:n.Id)==null?void 0:i.toString())!=null?s:"")}).reduce((t,n)=>Math.max(t,n),0)+1,jL=(r,e,t,n,i)=>{let s=AT(r,"Relationships");return s.push({attributes:{Id:`rId${e}`,Type:t,Target:n,TargetMode:i},name:"Relationship",type:"element"}),s},DZ=(r,e)=>{var t,n,i,s;for(let a=0;a<((t=r.elements)!=null?t:[]).length;a++){let o=r.elements[a];if(o.type==="element"&&o.name==="w:r"){let l=((n=o.elements)!=null?n:[]).filter(u=>u.type==="element"&&u.name==="w:t");for(let u of l)if((i=u.elements)!=null&&i[0]&&(s=u.elements[0].text)!=null&&s.includes(e))return a}}throw new Error("Token not found")},MZ=(r,e)=>{var t,n;let i=0,s=(n=(t=r.elements)==null?void 0:t.map((l,u)=>{var c,f,d;if(l.type==="element"&&l.name==="w:t"){let v=((d=(f=(c=l.elements)==null?void 0:c[0])==null?void 0:f.text)!=null?d:"").split(e).map(x=>It(Te(Te({},l),f4(l)),{elements:c4(x)}));return i=u,v}else return l}).flat())!=null?n:[],a=It(Te({},JSON.parse(JSON.stringify(r))),{elements:s.slice(0,i+1)}),o=It(Te({},JSON.parse(JSON.stringify(r))),{elements:s.slice(i+1)});return{left:a,right:o}},nl={START:0,MIDDLE:1,END:2},LZ=({paragraphElement:r,renderedParagraph:e,originalText:t,replacementText:n})=>{let i=e.text.indexOf(t),s=i+t.length-1,a=nl.START;for(let o of e.runs)for(let{text:l,index:u,start:c,end:f}of o.parts)switch(a){case nl.START:if(i>=c){let d=i-c,h=Math.min(s,f)-c,y=o.text.substring(d,h+1);if(y==="")continue;let v=l.replace(y,n);px(r.elements[o.index].elements[u],v),a=nl.MIDDLE;continue}break;case nl.MIDDLE:if(s<=f){let d=l.substring(s-c+1);px(r.elements[o.index].elements[u],d);let h=r.elements[o.index].elements[u];r.elements[o.index].elements[u]=f4(h),a=nl.END}else px(r.elements[o.index].elements[u],"");break}return r},px=(r,e)=>(r.elements=c4(e),r),FZ=r=>{if(r.element.name!=="w:p")throw new Error(`Invalid node type: ${r.element.name}`);if(!r.element.elements)return{text:"",runs:[],index:-1,pathToParagraph:[]};let e=0,t=r.element.elements.map((i,s)=>({element:i,i:s})).filter(({element:i})=>i.name==="w:r").map(({element:i,i:s})=>{let a=BZ(i,s,e);return e+=a.text.length,a}).filter(i=>!!i);return{text:t.reduce((i,s)=>i+s.text,""),runs:t,index:r.index,pathToParagraph:h4(r)}},BZ=(r,e,t)=>{if(!r.elements)return{text:"",parts:[],index:-1,start:t,end:t};let n=t,i=r.elements.map((a,o)=>{var l,u;return a.name==="w:t"&&a.elements&&a.elements.length>0?{text:(u=(l=a.elements[0].text)==null?void 0:l.toString())!=null?u:"",index:o,start:n,end:(()=>{var c,f;return n+=((f=(c=a.elements[0].text)==null?void 0:c.toString())!=null?f:"").length-1,n})()}:void 0}).filter(a=>!!a).map(a=>a);return{text:i.reduce((a,o)=>a+o.text,""),parts:i,index:e,start:t,end:n}},h4=r=>r.parent?[...h4(r.parent),r.index]:[r.index],WL=r=>{var e,t;return(t=(e=r.element.elements)==null?void 0:e.map((n,i)=>({element:n,index:i,parent:r})))!=null?t:[]},d4=r=>{let e=[],t=[...WL({element:r,index:0,parent:void 0})],n;for(;t.length>0;)n=t.shift(),n.element.name==="w:p"&&(e=[...e,FZ(n)]),t.push(...WL(n));return e},UZ=(r,e)=>d4(r).filter(t=>t.text.includes(e)),HZ=new kl,mx="\u0275",zZ=({json:r,patch:e,patchText:t,context:n,keepOriginalStyles:i=!0})=>{let s=UZ(r,t);if(s.length===0)return{element:r,didFindOccurrence:!1};for(let a of s){let o=e.children.map(l=>Ad(Je(HZ.format(l,n)))).map(l=>l.elements[0]);switch(e.type){case uT.DOCUMENT:{let l=jZ(r,a.pathToParagraph),u=WZ(a.pathToParagraph);l.elements.splice(u,1,...o);break}case uT.PARAGRAPH:default:{let l=p4(r,a.pathToParagraph);LZ({paragraphElement:l,renderedParagraph:a,originalText:t,replacementText:mx});let u=DZ(l,mx),c=l.elements[u],{left:f,right:d}=MZ(c,mx),h=o,y=d;if(i){let v=c.elements.filter(x=>x.type==="element"&&x.name==="w:rPr");h=o.map(x=>{var m;return It(Te({},x),{elements:[...v,...(m=x.elements)!=null?m:[]]})}),y=It(Te({},d),{elements:[...v,...d.elements]})}l.elements.splice(u,1,f,...h,y);break}}}return{element:r,didFindOccurrence:!0}},p4=(r,e)=>{let t=r;for(let n=1;n<e.length;n++){let i=e[n];t=t.elements[i]}return t},jZ=(r,e)=>p4(r,e.slice(0,e.length-1)),WZ=r=>r[r.length-1],uT={DOCUMENT:"file",PARAGRAPH:"paragraph"},qL=new wd,qZ=new Uint8Array([255,254]),VZ=new Uint8Array([254,255]),VL=(r,e)=>{if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0},KZ=r=>cT(te,[r],function*({outputType:e,data:t,patches:n,keepOriginalStyles:i,placeholderDelimiters:s={start:"{{",end:"}}"},recursive:a=!0}){var o,l,u;let c=t instanceof co?t:yield co.loadAsync(t),f=new Map,d={Media:new _l},h=new Map,y=[],v=[],x=!1,m=new Map;for(let[b,w]of Object.entries(c.files)){let T=yield w.async("uint8array"),P=T.slice(0,2);if(VL(P,qZ)||VL(P,VZ)){m.set(b,T);continue}if(!b.endsWith(".xml")&&!b.endsWith(".rels")){m.set(b,T);continue}let M=Ad(yield w.async("text"));if(b==="word/document.xml"){let U=(o=M.elements)==null?void 0:o.find(R=>R.name==="w:document");if(U&&U.attributes){for(let R of["mc","wp","r","w15","m"])U.attributes[`xmlns:${R}`]=Rh[R];U.attributes["mc:Ignorable"]=`${U.attributes["mc:Ignorable"]||""} w15`.trim()}}if(b.startsWith("word/")&&!b.endsWith(".xml.rels")){let U={file:d,viewWrapper:{Relationships:{createRelationship:(C,H,k,V)=>{v.push({key:b,hyperlink:{id:C,link:k}})}}},stack:[]};if(f.set(b,U),!s?.start.trim()||!s?.end.trim())throw new Error("Both start and end delimiters must be non-empty strings.");let{start:R,end:J}=s;for(let[C,H]of Object.entries(n)){let k=`${R}${C}${J}`;for(;;){let{didFindOccurrence:V}=zZ({json:M,patch:It(Te({},H),{children:H.children.map(Q=>{if(Q instanceof ml){let j=new si(Q.options.children,Dl());return v.push({key:b,hyperlink:{id:j.linkId,link:Q.options.link}}),j}else return Q})}),patchText:k,context:U,keepOriginalStyles:i});if(!a||!V)break}}let oe=qL.getMediaData(JSON.stringify(M),U.file.Media);oe.length>0&&(x=!0,y.push({key:b,mediaDatas:oe}))}h.set(b,M)}for(let{key:b,mediaDatas:w}of y){let T=`word/_rels/${b.split("/").pop()}.rels`,P=(l=h.get(T))!=null?l:KL();h.set(T,P);let M=PZ(P),U=qL.replace(JSON.stringify(h.get(b)),w,M);h.set(b,JSON.parse(U));for(let R=0;R<w.length;R++){let{fileName:J}=w[R];jL(P,M+R,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${J}`)}}for(let{key:b,hyperlink:w}of v){let T=`word/_rels/${b.split("/").pop()}.rels`,P=(u=h.get(T))!=null?u:KL();h.set(T,P),jL(P,w.id,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",w.link,G3.EXTERNAL)}if(x){let b=h.get("[Content_Types].xml");if(!b)throw new Error("Could not find content types file");to(b,"image/png","png"),to(b,"image/jpeg","jpeg"),to(b,"image/jpeg","jpg"),to(b,"image/bmp","bmp"),to(b,"image/gif","gif"),to(b,"image/svg+xml","svg")}let _=new co;for(let[b,w]of h){let T=GZ(w);_.file(b,T)}for(let[b,w]of m)_.file(b,w);for(let{data:b,fileName:w}of d.Media.Array)_.file(`word/media/${w}`,b);return _.generateAsync({type:e,mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})}),GZ=r=>xd.js2xml(r,{attributeValueFn:t=>String(t).replace(/&(?!amp;|lt;|gt;|quot;|apos;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}),KL=()=>({declaration:{attributes:{version:"1.0",encoding:"UTF-8",standalone:"yes"}},elements:[{type:"element",name:"Relationships",attributes:{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},elements:[]}]}),$Z=r=>cT(te,[r],function*({data:e}){let t=e instanceof co?e:yield co.loadAsync(e),n=new Set;for(let[i,s]of Object.entries(t.files))if(!(!i.endsWith(".xml")&&!i.endsWith(".rels"))&&i.startsWith("word/")&&!i.endsWith(".xml.rels")){let a=Ad(yield s.async("text"));d4(a).forEach(o=>JZ(o.text).forEach(l=>n.add(l)))}return Array.from(n)}),JZ=r=>{var e;let t=new RegExp("(?<=\\{\\{).+?(?=\\}\\})","gs");return(e=r.match(t))!=null?e:[]};te.AbstractNumbering=El;te.Alignment=ll;te.AlignmentAttributes=jf;te.AlignmentType=Er;te.AnnotationReference=FE;te.Attributes=Ve;te.BaseEmphasisMark=fl;te.BaseXmlComponent=Ki;te.Body=Nh;te.Bookmark=dh;te.BookmarkEnd=mh;te.BookmarkStart=ph;te.Border=Wf;te.BorderElement=Be;te.BorderStyle=kd;te.BuilderElement=ke;te.CarriageReturn=WE;te.CharacterSet=aZ;te.CheckBox=sT;te.CheckBoxSymbolElement=uo;te.CheckBoxUtil=yd;te.Column=lS;te.ColumnBreak=$E;te.Columns=yh;te.Comment=ih;te.CommentRangeEnd=AE;te.CommentRangeStart=TE;te.CommentReference=OE;te.Comments=sh;te.ConcreteHyperlink=si;te.ConcreteNumbering=Sl;te.ContinuationSeparator=zE;te.DayLong=DE;te.DayShort=CE;te.DeletedTextRun=nT;te.Document=fd;te.DocumentAttributeNamespaces=Rh;te.DocumentAttributes=Yi;te.DocumentBackground=Ih;te.DocumentBackgroundAttributes=Ch;te.DocumentDefaults=ud;te.DocumentGridType=LY;te.DotEmphasisMark=Ox;te.Drawing=rh;te.DropCapType=qY;te.EMPTY_OBJECT=JL;te.EmphasisMark=Kf;te.EmphasisMarkType=ET;te.EmptyElement=ut;te.EndnoteReference=UE;te.ExternalHyperlink=ml;te.File=fd;te.FileChild=Xi;te.FootNoteReferenceRunAttributes=pd;te.FootNotes=ed;te.Footer=Yk;te.FooterWrapper=Qh;te.FootnoteReference=md;te.FootnoteReferenceElement=BE;te.FootnoteReferenceRun=Zk;te.FrameAnchorType=VY;te.FrameWrap=KY;te.GridSpan=Wh;te.Header=Xk;te.HeaderFooterReference=lo;te.HeaderFooterReferenceType=Vi;te.HeaderFooterType=oS;te.HeaderWrapper=td;te.HeadingLevel=CY;te.HeightRule=oZ;te.HighlightColor=iY;te.HorizontalPositionAlign=ZX;te.HorizontalPositionRelativeFrom=D3;te.HpsMeasureElement=so;te.HyperlinkType=DY;te.IgnoreIfEmptyXmlComponent=cr;te.ImageRun=gE;te.ImportedRootElementAttributes=Hf;te.ImportedXmlComponent=Uf;te.Indent=Vf;te.InitializableXmlComponent=al;te.InsertedTextRun=Qk;te.InternalHyperlink=eS;te.LastRenderedPageBreak=VE;te.LeaderType=IY;te.Level=rd;te.LevelBase=xl;te.LevelForOverride=vk;te.LevelFormat=Jr;te.LevelOverride=nd;te.LevelSuffix=pZ;te.LineNumberRestartFormat=FY;te.LineRuleType=lh;te.Math=GY;te.MathAngledBrackets=RS;te.MathCurlyBrackets=NS;te.MathDegree=Lh;te.MathDenominator=Dh;te.MathFraction=pS;te.MathFunction=TS;te.MathFunctionName=Bh;te.MathFunctionProperties=Uh;te.MathIntegral=gS;te.MathLimit=vl;te.MathLimitLower=yS;te.MathLimitUpper=vS;te.MathNumerator=Mh;te.MathPreSubSuperScript=xS;te.MathRadical=kS;te.MathRadicalProperties=Fh;te.MathRoundBrackets=AS;te.MathRun=dS;te.MathSquareBrackets=OS;te.MathSubScript=bS;te.MathSubSuperScript=_S;te.MathSum=mS;te.MathSuperScript=wS;te.Media=_l;te.MonthLong=ME;te.MonthShort=IE;te.NextAttributeComponent=Xt;te.NoBreakHyphen=NE;te.NumberFormat=eY;te.NumberProperties=ao;te.NumberValueElement=ii;te.Numbering=id;te.OnOffElement=me;te.OutlineLevel=gh;te.OverlapType=nZ;te.Packer=RZ;te.PageBorderDisplay=BY;te.PageBorderOffsetFrom=UY;te.PageBorderZOrder=HY;te.PageBorders=bh;te.PageBreak=GE;te.PageBreakBefore=ah;te.PageMargin=_h;te.PageNumber=ni;te.PageNumberElement=jE;te.PageNumberSeparator=zY;te.PageNumberType=Eh;te.PageNumberTypeAttributes=xh;te.PageOrientation=Sh;te.PageReference=iS;te.PageTextDirection=kh;te.PageTextDirectionType=jY;te.Paragraph=nn;te.ParagraphProperties=rn;te.ParagraphPropertiesDefaults=ad;te.PatchType=uT;te.PositionalTab=KE;te.PositionalTabAlignment=OY;te.PositionalTabLeader=RY;te.PositionalTabRelativeTo=NY;te.PrettifyType=l4;te.RelativeHorizontalPosition=tZ;te.RelativeVerticalPosition=rZ;te.Run=Pt;te.RunFonts=oo;te.RunProperties=Ar;te.RunPropertiesChange=Jf;te.RunPropertiesDefaults=ld;te.SectionProperties=Oh;te.SectionType=WY;te.SectionTypeAttributes=Th;te.Separator=HE;te.SequentialIdentifier=yE;te.Shading=$i;te.ShadingType=tY;te.SimpleField=nh;te.SimpleMailMergeField=bE;te.SoftHyphen=RE;te.SpaceType=Yt;te.Spacing=uh;te.StringContainer=Zr;te.StringEnumValueElement=zf;te.StringValueElement=Tr;te.Style=sl;te.StyleForCharacter=Qi;te.StyleForParagraph=Zi;te.StyleLevel=Jk;te.Styles=ho;te.SymbolRun=Xf;te.TDirection=qh;te.Tab=qE;te.TabAttributes=fh;te.TabStop=ch;te.TabStopItem=hh;te.TabStopPosition=PY;te.TabStopType=XE;te.Table=BS;te.TableAnchorType=eZ;te.TableBorders=bl;te.TableCell=wl;te.TableCellBorders=jh;te.TableFloatProperties=Vh;te.TableLayout=Kh;te.TableLayoutType=iZ;te.TableOfContents=$k;te.TableProperties=$h;te.TableRow=US;te.TableRowHeight=Xh;te.TableRowHeightAttributes=Jh;te.TableRowProperties=Yh;te.TableWidthElement=tn;te.TextDirection=QY;te.TextEffect=nY;te.TextRun=Ji;te.TextWrappingSide=W3;te.TextWrappingType=il;te.Textbox=oT;te.ThematicBreak=qf;te.Type=Ah;te.Underline=$f;te.UnderlineType=ST;te.VerticalAlign=MY;te.VerticalAlignAttributes=vh;te.VerticalAlignElement=gl;te.VerticalAlignSection=X3;te.VerticalAlignTable=J3;te.VerticalMerge=yl;te.VerticalMergeType=TT;te.VerticalPositionAlign=QX;te.VerticalPositionRelativeFrom=M3;te.WORKAROUND2=dZ;te.WORKAROUND3=JX;te.WORKAROUND4=XY;te.WidthType=zh;te.WrapNone=dl;te.WrapSquare=Zf;te.WrapTight=Qf;te.WrapTopAndBottom=eh;te.XmlAttributeComponent=we;te.XmlComponent=ue;te.YearLong=LE;te.YearShort=PE;te.abstractNumUniqueNumericIdGen=N3;te.bookmarkUniqueNumericIdGen=I3;te.concreteNumUniqueNumericIdGen=R3;te.convertInchesToTwip=ar;te.convertMillimetersToTwip=vY;te.convertToXmlComponent=Ed;te.createDocumentGrid=Y3;te.createFrameProperties=e4;te.createHorizontalPosition=U3;te.createLineNumberType=Z3;te.createMathAccentCharacter=t4;te.createMathBase=zt;te.createMathLimitLocation=r4;te.createMathNAryProperties=kT;te.createMathPreSubSuperScriptProperties=o4;te.createMathSubScriptElement=mo;te.createMathSubScriptProperties=i4;te.createMathSubSuperScriptProperties=s4;te.createMathSuperScriptElement=go;te.createMathSuperScriptProperties=n4;te.createPageSize=Q3;te.createSimplePos=L3;te.createStringElement=ro;te.createVerticalPosition=H3;te.dateTimeValue=E3;te.decimalNumber=vt;te.docPropertiesUniqueNumericIdGen=C3;te.eighthPointMeasureValue=_3;te.hashedId=Lx;te.hexColorValue=Gi;te.hpsMeasureValue=w3;te.longHexNumber=XX;te.measurementOrPercentValue=_T;te.patchDetector=$Z;te.patchDocument=KZ;te.percentageValue=b3;te.pointMeasureValue=x3;te.positiveUniversalMeasureValue=bT;te.sectionMarginDefaults=ri;te.sectionPageSizeDefaults=Ff;te.shortHexNumber=y3;te.signedHpsMeasureValue=YX;te.signedTwipsMeasureValue=en;te.twipsMeasureValue=lt;te.uCharHexNumber=_x;te.uniqueId=Dl;te.uniqueNumericIdCreator=Pl;te.uniqueUuid=P3;te.universalMeasureValue=Rl;te.unsignedDecimalNumber=Nl});var{Plugin:XZ,TFolder:YZ,Notice:es,normalizePath:ZZ,WorkspaceLeaf:OT,PluginSettingTab:QZ,Setting:an}=require("obsidian"),{ColophonView:ai,VIEW_TYPE:ts}=UD(),{FootnoteView:Od,FOOTNOTE_VIEW_TYPE:vo}=jD(),eQ={textColumnWidth:1080,fixedFeedPosition:!1,feedPadding:50,smartQuotes:!0,smartDashes:!0,doubleQuoteStyle:"\u201C|\u201D",singleQuoteStyle:"\u2018|\u2019",stylesFolder:"snippets",enabledStyles:[],showWordCount:!1},{DocxSerializer:tQ}=(G5(),x4(K5)),{Packer:rQ,HeadingLevel:yo,Paragraph:nQ,TextRun:iQ,FootnoteReferenceRun:sQ,StyleLevel:Bte}=m4(),oQ=require("fs"),g4=require("electron");module.exports=class extends XZ{async onload(){await this.loadSettings(),this.registerView(ts,t=>new ai(t,this.settings,this));let e=this.app.vault.getConfig("spellcheck");this.registerView(vo,t=>new Od(t,this.settings,e)),this.addSettingTab(new NT(this.app,this)),this.patchOpenFile(),this.registerEvent(this.app.workspace.on("file-open",this.handleFileOpen.bind(this))),this.registerEvent(this.app.workspace.on("active-leaf-change",this.handleActiveLeafChange.bind(this))),this.addRibbonIcon("feather","New manuscript",async()=>{await this.createNewManuscript()}),this.registerEvent(this.app.workspace.on("file-menu",(t,n)=>{let s=n instanceof YZ?n.path:n.parent.path;t.addItem(a=>{a.setTitle("New manuscript").setIcon("feather").onClick(async()=>{await this.createNewManuscript(s)})})})),this.addCommand({id:"create-new-colophon-manuscript",name:"New manuscript",callback:()=>this.createNewManuscript()}),this.addCommand({id:"export-to-docx",name:"Export to DOCX",callback:()=>this.exportToDocx()}),this.addCommand({id:"open-colophon-footnotes",name:"Open Footnotes Sidebar",callback:async()=>{this.activateFootnoteView()}}),this.addCommand({id:"insert-colophon-footnote",name:"Insert Footnote",checkCallback:t=>{let n=this.app.workspace.getActiveViewOfType(ai);return n?(t||n.insertFootnote(),!0):!1}}),this.app.workspace.onLayoutReady(()=>{let t=(n,i)=>{let s=this.app.commands.commands[n];if(s){let a=s.checkCallback;s.checkCallback=o=>{let l=this.app.workspace.getLeavesOfType(ts),u=l.length>0?l[0].view:null;if(u){let c=this.app.workspace.getLeavesOfType(vo)[0]?.view,f=null,d=this.app.workspace.activeLeaf;if(c&&c instanceof Od&&d.view===c){let h=c.getFocusedEditor();h&&(f=h)}if(!f&&u.adapter&&u.adapter.editor&&u.adapter.editor.isFocused&&(f=u.adapter.editor),f)return o||i(f),!0}return a?a(o):!1}}};t("editor:insert-footnote",n=>{let i=this.app.workspace.getActiveViewOfType(ai);i&&i.insertFootnote()}),t("editor:toggle-bold",n=>n.chain().focus().toggleBold().run()),t("editor:toggle-italics",n=>n.chain().focus().toggleItalic().run()),t("editor:toggle-strikethrough",n=>n.chain().focus().toggleStrike().run())})}async exportToDocx(e){if(e||(e=this.app.workspace.getActiveViewOfType(ai)),!e||!(e instanceof ai)||!e.adapter.editor){new es("No active Colophon editor found.");return}let n=e.adapter.editor.state.doc,i=(e.file?.basename||"Untitled")+".docx";try{let s={paragraph(f,d){f.renderInline(d),f.closeBlock(d)},heading(f,d){f.renderInline(d);let h=[yo.HEADING_1,yo.HEADING_2,yo.HEADING_3,yo.HEADING_4,yo.HEADING_5,yo.HEADING_6][d.attrs.level-1];f.closeBlock(d,{heading:h})},text(f,d){f.text(d.text)},hard_break(f){f.addRunOptions({break:1})},footnote(f,d){let h=d.attrs.id,v=(e.adapter?e.adapter.footnotes:[]).find(_=>_.id===h),x=v?v.content:"";f.$footnoteCounter=(f.$footnoteCounter||0)+1;let m=f.$footnoteCounter;f.footnotes[m]={children:[new nQ({children:[new iQ(x)]})]},f.current.push(new sQ(m))}},a={bold(){return{bold:!0}},italic(){return{italics:!0}},underline(){return{underline:{}}},strike(){return{strike:!0}},superscript(){return{superScript:!0}},subscript(){return{subScript:!0}},internallink(){return{}},smallCaps(){return{smallCaps:!0}}},l=new tQ(s,a).serialize(n,{sections:[{properties:{},children:[]}],styles:{default:{document:{run:{font:"Minion 3",size:24},paragraph:{spacing:{line:360}}}},paragraphStyles:[{id:"Normal",name:"Normal",basedOn:"Normal",next:"Normal",quickFormat:!0,run:{font:"Minion 3",size:24},paragraph:{spacing:{line:360},indent:{firstLine:720}}},{id:"Heading1",name:"Heading 1",basedOn:"Normal",next:"Normal",quickFormat:!0,run:{font:"Minion 3",size:36,italics:!0},paragraph:{spacing:{before:480,after:240}}},{id:"Heading2",name:"Heading 2",basedOn:"Normal",next:"Normal",quickFormat:!0,run:{font:"Minion 3",size:28,smallCaps:!0,tracking:100},paragraph:{spacing:{before:360,after:240}}},{id:"Heading3",name:"Heading 3",basedOn:"Normal",next:"Normal",quickFormat:!0,run:{font:"Minion 3",size:24,italics:!0},paragraph:{alignment:"center",spacing:{before:360,after:240}}}]}}),u=await rQ.toBuffer(l),c=await g4.remote.dialog.showSaveDialog({title:"Export to DOCX",defaultPath:i,filters:[{name:"Word Document",extensions:["docx"]}]});if(c.canceled||!c.filePath){new es("Export cancelled.");return}oQ.writeFile(c.filePath,u,f=>{f?(console.error("Colophon: Failed to save DOCX file.",f),new es("Failed to save file. See console for details.")):new es("File saved successfully!")})}catch(s){console.error("Colophon: Error exporting to DOCX.",s),new es("An error occurred during DOCX export. See console for details.")}}async activateFootnoteView(){let{workspace:e}=this.app,t=null,n=e.getLeavesOfType(vo);n.length>0?t=n[0]:(t=e.getRightLeaf(!1),await t.setViewState({type:vo,active:!0})),e.revealLeaf(t)}async loadSettings(){this.settings=Object.assign({},eQ,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.app.workspace.getLeavesOfType(ts).forEach(e=>{e.view instanceof ai&&e.view.updateSettings(this.settings)}),this.app.workspace.getLeavesOfType(vo).forEach(e=>{e.view instanceof Od&&e.view.updateSettings(this.settings)})}patchOpenFile(){let e=this,t=OT.prototype.openFile;OT.prototype.openFile=async function(n,i){let a=(this.app||e.app).metadataCache.getFileCache(n);if(a?.frontmatter&&a.frontmatter["colophon-plugin"]==="manuscript"&&(this.view.getViewType()!==ts&&await this.setViewState({type:ts,state:i,active:!0}),this.view instanceof ai)){await this.view.loadFile(n),i&&i.eState&&this.view.setEphemeralState(i.eState);return}return t.call(this,n,i)},this.register(()=>{OT.prototype.openFile=t})}async handleActiveLeafChange(e){if(!e)return;this.updateFootnoteView(e.view);let t=e.view.file;t&&await this.ensureCorrectView(e,t)}async handleFileOpen(e){if(!e)return;let t=this.app.workspace.activeLeaf;t&&(this.updateFootnoteView(t.view),await this.ensureCorrectView(t,e))}updateFootnoteView(e){let t=this.app.workspace.getLeavesOfType(vo);if(t.length===0)return;let n=t[0].view;if(typeof n.setAdapter!="function"){console.error("Colophon: FootnoteView instance does not have setAdapter method."),console.log("FootnoteView keys:",Object.keys(n)),console.log("FootnoteView prototype keys:",Object.getOwnPropertyNames(Object.getPrototypeOf(n))),console.log("FootnoteView constructor:",n.constructor.name);return}e instanceof Od||(e instanceof ai&&e.adapter?n.setAdapter(e.adapter):n.setAdapter(null))}async ensureCorrectView(e,t){let n=this.app.metadataCache.getFileCache(t),i=n?.frontmatter&&n.frontmatter["colophon-plugin"]==="manuscript",s=e.view.getViewType();if(i&&s==="markdown"){let a=e.view.getState();await e.setViewState({type:ts,state:a,active:!0})}else if(!i&&s===ts){let a=e.view.getState();await e.setViewState({type:"markdown",state:a,active:!0})}}async createNewManuscript(e){let t;if(e?t=typeof e=="string"?this.app.vault.getAbstractFileByPath(e):e:t=this.app.fileManager.getNewFileParent(this.app.workspace.getActiveFile()?.path||""),!t||!t.path){new es("Invalid folder location");return}let n=`---
colophon-plugin: manuscript
---
`,i=await this.getUniqueFilePath(t);try{let s=await this.app.vault.create(i,n);await this.app.workspace.getLeaf(!1).openFile(s)}catch(s){new es(`Failed to create manuscript: ${s.toString()}`)}}async getUniqueFilePath(e){let t=0;for(;;){let i=`Untitled${t===0?"":` ${t}`}.md`,s=ZZ(`${e.path}/${i}`);if(!await this.app.vault.exists(s))return s;t++}}onunload(){}};var NT=class extends QZ{constructor(e,t){super(e,t),this.plugin=t}display(){let{containerEl:e}=this;e.empty(),new an(e).setName("Text column width").setDesc("Adjust the width of the writing canvas (500px - 1240px).").addSlider(t=>t.setLimits(500,1240,10).setValue(this.plugin.settings.textColumnWidth).setDynamicTooltip().onChange(async n=>{this.plugin.settings.textColumnWidth=n,await this.plugin.saveSettings()})),new an(e).setName("Fixed feed position").setDesc("Enforce a typewriter-style fixed active line position.").addToggle(t=>t.setValue(this.plugin.settings.fixedFeedPosition).onChange(async n=>{this.plugin.settings.fixedFeedPosition=n,await this.plugin.saveSettings(),this.display()})),this.plugin.settings.fixedFeedPosition&&new an(e).setName("Feed padding").setDesc("Vertical position of the active line (0% = bottom, 75% = top quarter).").addSlider(t=>t.setLimits(0,75,1).setValue(this.plugin.settings.feedPadding).setDynamicTooltip().onChange(async n=>{this.plugin.settings.feedPadding=n,await this.plugin.saveSettings()})),new an(e).setName("Smart quotes").setDesc("Automatically replace straight quotes with smart quotes.").addToggle(t=>t.setValue(this.plugin.settings.smartQuotes).onChange(async n=>{this.plugin.settings.smartQuotes=n,await this.plugin.saveSettings(),this.display()})),this.plugin.settings.smartQuotes&&(new an(e).setName("Double quote style").setDesc("Choose the style for double quotes.").addDropdown(t=>t.addOption("\u201C|\u201D","\u201Cabc\u201D").addOption("\u201E|\u201C","\u201Eabc\u201C").addOption("\u201E|\u201D","\u201Eabc\u201D").addOption("\u201D|\u201D","\u201Dabc\u201D").addOption("\xAB|\xBB","\xABabc\xBB").addOption("\xBB|\xAB","\xBBabc\xAB").addOption('"|"','"abc"').setValue(this.plugin.settings.doubleQuoteStyle).onChange(async n=>{this.plugin.settings.doubleQuoteStyle=n,await this.plugin.saveSettings()})),new an(e).setName("Single quote style").setDesc("Choose the style for single quotes.").addDropdown(t=>t.addOption("\u2018|\u2019","\u2018abc\u2019").addOption("\u201A|\u2018","\u201Aabc\u2018").addOption("\u201A|\u2019","\u201Aabc\u2019").addOption("\u2019|\u2019","\u2019abc\u2019").addOption("\u2039|\u203A","\u2039abc\u203A").addOption("\u203A|\u2039","\u203Aabc\u2039").addOption("'|'","'abc'").setValue(this.plugin.settings.singleQuoteStyle).onChange(async n=>{this.plugin.settings.singleQuoteStyle=n,await this.plugin.saveSettings()}))),new an(e).setName("Smart dashes").setDesc("Replace -- with em-dash (\u2014) and --- with en-dash (\u2013).").addToggle(t=>t.setValue(this.plugin.settings.smartDashes).onChange(async n=>{this.plugin.settings.smartDashes=n,await this.plugin.saveSettings()})),new an(e).setName("Styles folder").setDesc("Folder containing YAML style definitions (relative to vault config directory).").addText(t=>t.setPlaceholder("snippets").setValue(this.plugin.settings.stylesFolder).onChange(async n=>{this.plugin.settings.stylesFolder=n,await this.plugin.saveSettings(),this.display()})).addExtraButton(t=>t.setIcon("folder-open").setTooltip("Open folder").onClick(()=>{let n=this.plugin.app.vault.adapter.getBasePath()+"/"+this.plugin.app.vault.configDir+"/"+this.plugin.settings.stylesFolder;g4.shell.openPath(n)})),this.displayStyleFiles(e)}async displayStyleFiles(e){let{app:t,settings:n}=this.plugin,i=t.vault.adapter,s=t.vault.configDir,a=n.stylesFolder||"snippets",o=`${s}/${a}`;if(!await i.exists(o)){new an(e).setName("Folder not found").setDesc(`The folder "${o}" does not exist.`).addButton(f=>f.setButtonText("Create folder").onClick(async()=>{await i.mkdir(o),this.display()}));return}let u=(await i.list(o)).files.filter(f=>f.endsWith(".yaml")||f.endsWith(".yml"));if(u.length===0){e.createDiv({text:"No YAML files found in this folder.",cls:"setting-item-description"});return}let c=e.createDiv();c.style.marginTop="20px",c.style.marginBottom="10px",c.createEl("strong",{text:"Enabled Styles"});for(let f of u){let d=f.split("/").pop(),h=n.enabledStyles.includes(d);new an(e).setName(d).addToggle(y=>y.setValue(h).onChange(async v=>{v?n.enabledStyles.includes(d)||n.enabledStyles.push(d):n.enabledStyles=n.enabledStyles.filter(x=>x!==d),await this.plugin.saveSettings()}))}}};
/*! Bundled license information:

docx/dist/index.mjs:
  (*! http://mths.be/fromcodepoint v0.1.0 by @mathias *)
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)

docx/dist/index.cjs:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
  (*! http://mths.be/fromcodepoint v0.1.0 by @mathias *)
*/
